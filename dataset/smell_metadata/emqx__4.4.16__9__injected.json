{"seed":10065,"processedDockerfileHash":"f5972aaedaf376a452adb79c8e351be2","fixedSmells":[],"successfullyFixedSmells":[],"processedDockerfile":"FROM debian:11-slim\nSHELL [\"/bin/bash\", \"-o\", \"pipefail\", \"-c\"]\nRUN apt-get update\nRUN set -eu ; : ; apt-get install --no-install-recommends curl=7.74.0-1.3+deb11u7 unzip=6.0-26+deb11u1 ca-certificates=20210119 -y ; rm -rf /var/lib/apt/lists/*\nRUN set -eu ; groupadd -r -g 1000 emqx ; useradd -r -m -u 1000 -g emqx emqx\nENV EMQX_VERSION=\"4.4.16\"\nENV OTP=\"otp24.3.4.2-1\"\nRUN set -eu ; arch=$( dpkg --print-architecture ;) ; if [ ${arch} = \"amd64\" ] ; then sha256=\"901b76ea2bee68729b75280740ca31b1af5b358d331422d1653dc342ee830324\" ; fi ; if [ ${arch} = \"arm64\" ] ; then sha256=\"1224f53d0ee98390c286f3bbd9af2f294c2fa4ccb79342343d803fa234165c6e\" ; fi ; ID=\"$( sed -n '/^ID=/p' /etc/os-release | sed -r 's/ID=(.*)/\\1/g' | sed 's/\\\"//g' ;)\" ; VERSION_ID=\"$( sed -n '/^VERSION_ID=/p' /etc/os-release | sed -r 's/VERSION_ID=(.*)/\\1/g' | sed 's/\\\"//g' ;)\" ; pkg=\"emqx-${EMQX_VERSION}-${OTP}-${ID}${VERSION_ID}-${arch}.zip\" ; curl -f -O -L https://www.emqx.com/en/downloads/broker/${EMQX_VERSION}/${pkg} ; echo \"$sha256 *$pkg\" | sha256sum -c || exit 1 ; unzip -q -d /opt $pkg ; chgrp -Rf emqx /opt/emqx ; chmod -Rf g+w /opt/emqx ; chown -Rf emqx /opt/emqx ; ln -s /opt/emqx/bin/* /usr/local/bin/ ; rm -rf $pkg\nWORKDIR /opt/emqx\nUSER emqx\nVOLUME [\"/opt/emqx/log\", \"/opt/emqx/data\"]\n#  emqx will occupy these port:\n#  - 1883 port for MQTT\n#  - 8081 for mgmt API\n#  - 8083 for WebSocket/HTTP\n#  - 8084 for WSS/HTTPS\n#  - 8883 port for MQTT(SSL)\n#  - 11883 port for internal MQTT/TCP\n#  - 18083 for dashboard\n#  - 4369 epmd (Erlang-distrbution port mapper daemon) listener (deprecated)\n#  - 4370 default Erlang distrbution port\n#  - 5369 for gen_rpc port mapping\n#  - 6369 6370 for distributed node\nEXPOSE 1883/tcp 8081/tcp 8083/tcp 8084/tcp 8883/tcp 11883/tcp 18083/tcp 4369/tcp 4370/tcp 5369/tcp 6369/tcp 6370/tcp\nCOPY docker-entrypoint.sh /usr/bin/\nENTRYPOINT [\"/usr/bin/docker-entrypoint.sh\"]\nHEALTHCHECK CMD curl --fail http://127.0.0.1:8081 || exit 1\nCMD [\"emqx\", \"foreground\"]\n","originalDockerfile":"FROM debian:11-slim\n\nSHELL [\"/bin/bash\", \"-o\", \"pipefail\", \"-c\"]\n\nRUN set -eu; \\\n    apt-get update; \\\n    apt-get install -y --no-install-recommends curl=7.74.0-1.3+deb11u7 unzip=6.0-26+deb11u1 ca-certificates=20210119; \\\n    rm -rf /var/lib/apt/lists/*\n\nRUN set -eu; \\\n    groupadd -r -g 1000 emqx; \\\n    useradd -r -m -u 1000 -g emqx emqx\n\nENV EMQX_VERSION=4.4.16\nENV OTP=otp24.3.4.2-1\n\nRUN set -eu; \\\n    arch=$(dpkg --print-architecture); \\\n    if [ ${arch} = \"amd64\" ]; then sha256=\"901b76ea2bee68729b75280740ca31b1af5b358d331422d1653dc342ee830324\"; fi; \\\n    if [ ${arch} = \"arm64\" ]; then sha256=\"1224f53d0ee98390c286f3bbd9af2f294c2fa4ccb79342343d803fa234165c6e\"; fi; \\\n    ID=\"$(sed -n '/^ID=/p' /etc/os-release | sed -r 's/ID=(.*)/\\1/g' | sed 's/\\\"//g')\"; \\\n    VERSION_ID=\"$(sed -n '/^VERSION_ID=/p' /etc/os-release | sed -r 's/VERSION_ID=(.*)/\\1/g' | sed 's/\\\"//g')\"; \\\n    pkg=\"emqx-${EMQX_VERSION}-${OTP}-${ID}${VERSION_ID}-${arch}.zip\"; \\\n    curl -f -O -L https://www.emqx.com/en/downloads/broker/${EMQX_VERSION}/${pkg}; \\\n    echo \"$sha256 *$pkg\" | sha256sum -c || exit 1; \\\n    unzip -q -d /opt $pkg; \\\n    chgrp -Rf emqx /opt/emqx; \\\n    chmod -Rf g+w /opt/emqx; \\\n    chown -Rf emqx /opt/emqx; \\\n    ln -s /opt/emqx/bin/* /usr/local/bin/; \\\n    rm -rf $pkg\n\nWORKDIR /opt/emqx\n\nUSER emqx\n\nVOLUME [\"/opt/emqx/log\", \"/opt/emqx/data\"]\n\n# emqx will occupy these port:\n# - 1883 port for MQTT\n# - 8081 for mgmt API\n# - 8083 for WebSocket/HTTP\n# - 8084 for WSS/HTTPS\n# - 8883 port for MQTT(SSL)\n# - 11883 port for internal MQTT/TCP\n# - 18083 for dashboard\n# - 4369 epmd (Erlang-distrbution port mapper daemon) listener (deprecated)\n# - 4370 default Erlang distrbution port\n# - 5369 for gen_rpc port mapping\n# - 6369 6370 for distributed node\nEXPOSE 1883 8081 8083 8084 8883 11883 18083 4369 4370 5369 6369 6370\n\nCOPY docker-entrypoint.sh /usr/bin/\n\nENTRYPOINT [\"/usr/bin/docker-entrypoint.sh\"]\n\nHEALTHCHECK CMD curl --fail http://127.0.0.1:8081 || exit 1\n\nCMD [\"emqx\", \"foreground\"]\n","injectedSmells":["do-not-use-apt-get-update-alone","pin-package-manager-versions-pip","pin-package-manager-versions-gem","use-wget-instead-of-add"],"originalDockerfileHash":"d841842180bc7e36033bb1abb101103c","successfullyInjectedSmells":["do-not-use-apt-get-update-alone"],"originalDockerfileUglified":"FROM debian:11-slim\nSHELL [\"/bin/bash\", \"-o\", \"pipefail\", \"-c\"]\nRUN set -eu ; apt-get update ; apt-get install --no-install-recommends curl=7.74.0-1.3+deb11u7 unzip=6.0-26+deb11u1 ca-certificates=20210119 -y ; rm -rf /var/lib/apt/lists/*\nRUN set -eu ; groupadd -r -g 1000 emqx ; useradd -r -m -u 1000 -g emqx emqx\nENV EMQX_VERSION=\"4.4.16\"\nENV OTP=\"otp24.3.4.2-1\"\nRUN set -eu ; arch=$( dpkg --print-architecture ;) ; if [ ${arch} = \"amd64\" ] ; then sha256=\"901b76ea2bee68729b75280740ca31b1af5b358d331422d1653dc342ee830324\" ; fi ; if [ ${arch} = \"arm64\" ] ; then sha256=\"1224f53d0ee98390c286f3bbd9af2f294c2fa4ccb79342343d803fa234165c6e\" ; fi ; ID=\"$( sed -n '/^ID=/p' /etc/os-release | sed -r 's/ID=(.*)/\\1/g' | sed 's/\\\"//g' ;)\" ; VERSION_ID=\"$( sed -n '/^VERSION_ID=/p' /etc/os-release | sed -r 's/VERSION_ID=(.*)/\\1/g' | sed 's/\\\"//g' ;)\" ; pkg=\"emqx-${EMQX_VERSION}-${OTP}-${ID}${VERSION_ID}-${arch}.zip\" ; curl -f -O -L https://www.emqx.com/en/downloads/broker/${EMQX_VERSION}/${pkg} ; echo \"$sha256 *$pkg\" | sha256sum -c || exit 1 ; unzip -q -d /opt $pkg ; chgrp -Rf emqx /opt/emqx ; chmod -Rf g+w /opt/emqx ; chown -Rf emqx /opt/emqx ; ln -s /opt/emqx/bin/* /usr/local/bin/ ; rm -rf $pkg\nWORKDIR /opt/emqx\nUSER emqx\nVOLUME [\"/opt/emqx/log\", \"/opt/emqx/data\"]\n#  emqx will occupy these port:\n#  - 1883 port for MQTT\n#  - 8081 for mgmt API\n#  - 8083 for WebSocket/HTTP\n#  - 8084 for WSS/HTTPS\n#  - 8883 port for MQTT(SSL)\n#  - 11883 port for internal MQTT/TCP\n#  - 18083 for dashboard\n#  - 4369 epmd (Erlang-distrbution port mapper daemon) listener (deprecated)\n#  - 4370 default Erlang distrbution port\n#  - 5369 for gen_rpc port mapping\n#  - 6369 6370 for distributed node\nEXPOSE 1883/tcp 8081/tcp 8083/tcp 8084/tcp 8883/tcp 11883/tcp 18083/tcp 4369/tcp 4370/tcp 5369/tcp 6369/tcp 6370/tcp\nCOPY docker-entrypoint.sh /usr/bin/\nENTRYPOINT [\"/usr/bin/docker-entrypoint.sh\"]\nHEALTHCHECK CMD curl --fail http://127.0.0.1:8081 || exit 1\nCMD [\"emqx\", \"foreground\"]\n","originalDockerfileUglifiedHash":"95d9f01b7e3e7fcd959ca984e7188386","fileName":"/ICSME-replicationpackage/dataset/smellfree_dockerfiles/emqx__4.4.16.dockerfile"}