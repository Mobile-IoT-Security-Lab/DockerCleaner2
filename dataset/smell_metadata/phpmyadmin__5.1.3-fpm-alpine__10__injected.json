{"seed":6427,"processedDockerfileHash":"9915c11c0aed31658426cc8c0bd12074","fixedSmells":[],"successfullyFixedSmells":[],"processedDockerfile":"FROM php:8.0-fpm-alpine\nSHELL [\"/bin/ash\", \"-o\", \"pipefail\", \"-c\"]\n#  docker-entrypoint.sh dependencies\nRUN apk add bash tzdata --no-cache\n#  Install dependencies\nRUN set -ex ; apk add bzip2-dev freetype-dev libjpeg-turbo-dev libpng-dev libwebp-dev libxpm-dev libzip-dev --no-cache --virtual .build-deps ; docker-php-ext-configure gd --with-freetype --with-jpeg --with-webp --with-xpm ; docker-php-ext-install -j \"$( nproc ;)\" bz2 gd mysqli opcache zip\n#  hadolint ignore=DL3018\nRUN runDeps=\"$( scanelf --needed --nobanner --format '%n#p' --recursive /usr/local/lib/php/extensions | tr ',' '\\n' | sort -u | awk 'system(\"[ -e /usr/local/lib/\" $1 \" ]\") == 0 { next } { print \"so:\" $1 }' ;)\" ; apk add $runDeps --no-cache --virtual .phpmyadmin-phpexts-rundeps ; apk del --no-network .build-deps\n#  set recommended PHP.ini settings\n#  see https://secure.php.net/manual/en/opcache.installation.php\nENV MAX_EXECUTION_TIME=\"600\"\nENV MEMORY_LIMIT=\"512M\"\nENV UPLOAD_LIMIT=\"2048K\"\nRUN set -ex ; { echo 'opcache.memory_consumption=128' ;echo 'opcache.interned_strings_buffer=8' ;echo 'opcache.max_accelerated_files=4000' ;echo 'opcache.revalidate_freq=2' ;echo 'opcache.fast_shutdown=1' ; } > $PHP_INI_DIR/conf.d/opcache-recommended.ini; { echo 'session.cookie_httponly=1' ;echo 'session.use_strict_mode=1' ; } > $PHP_INI_DIR/conf.d/session-strict.ini; { echo 'allow_url_fopen=Off' ;echo 'max_execution_time=${MAX_EXECUTION_TIME}' ;echo 'max_input_vars=10000' ;echo 'memory_limit=${MEMORY_LIMIT}' ;echo 'post_max_size=${UPLOAD_LIMIT}' ;echo 'upload_max_filesize=${UPLOAD_LIMIT}' ; } > $PHP_INI_DIR/conf.d/phpmyadmin-misc.ini\n#  Calculate download URL\nENV VERSION=\"5.1.3\"\nENV SHA256=\"c562feddc0f8ff5e69629113f273a0d024a65fb928c48e89ce614744d478296f\"\nENV URL=\"https://files.phpmyadmin.net/phpMyAdmin/${VERSION}/phpMyAdmin-${VERSION}-all-languages.tar.xz\"\nLABEL org.opencontainers.image.title=\"Official phpMyAdmin Docker image\" \\\n      org.opencontainers.image.description=\"Run phpMyAdmin with Alpine, Apache and PHP FPM.\" \\\n      org.opencontainers.image.authors=\"The phpMyAdmin Team <developers@phpmyadmin.net>\" \\\n      org.opencontainers.image.vendor=\"phpMyAdmin\" \\\n      org.opencontainers.image.documentation=\"https://github.com/phpmyadmin/docker#readme\" \\\n      org.opencontainers.image.licenses=\"GPL-2.0-only\" \\\n      org.opencontainers.image.version=\"${VERSION}\" \\\n      org.opencontainers.image.url=\"https://github.com/phpmyadmin/docker#readme\" \\\n      org.opencontainers.image.source=\"https://github.com/phpmyadmin/docker.git\"\n#  Download tarball, verify it using gpg and extract\nRUN set -ex ; apk add gnupg --no-cache --virtual .fetch-deps ; export GNUPGHOME=\"$( mktemp -d ;)\" ; export GPGKEY=\"3D06A59ECE730EB71B511C17CE752F178259BD92\" ; curl -fsSL -o phpMyAdmin.tar.xz $URL ; curl -fsSL -o phpMyAdmin.tar.xz.asc $URL.asc ; echo \"$SHA256 *phpMyAdmin.tar.xz\" | sha256sum -c - ; gpg --batch --keyserver keyserver.ubuntu.com --recv-keys \"$GPGKEY\" || gpg --batch --keyserver pgp.mit.edu --recv-keys \"$GPGKEY\" || gpg --batch --keyserver keyserver.pgp.com --recv-keys \"$GPGKEY\" || gpg --batch --keyserver keys.openpgp.org --recv-keys \"$GPGKEY\" ; gpg --batch --verify phpMyAdmin.tar.xz.asc phpMyAdmin.tar.xz ; tar -xf phpMyAdmin.tar.xz -C /var/www/html --strip-components=1 ; mkdir -p /var/www/html/tmp ; chown www-data:www-data /var/www/html/tmp ; gpgconf --kill all ; rm -r \"$GNUPGHOME\" phpMyAdmin.tar.xz phpMyAdmin.tar.xz.asc ; rm -r -v /var/www/html/setup/ /var/www/html/examples/ /var/www/html/js/src/ /var/www/html/templates/test/ /var/www/html/babel.config.json /var/www/html/doc/html/_sources/ /var/www/html/RELEASE-DATE-$VERSION /var/www/html/CONTRIBUTING.md ; sed -i \"s@define('CONFIG_DIR'.*@define('CONFIG_DIR', '/etc/phpmyadmin/');@\" /var/www/html/libraries/vendor_config.php ; apk del --no-network .fetch-deps\n#  Copy configuration\nCOPY config.inc.php /etc/phpmyadmin/config.inc.php\n#  Copy main script\nCOPY docker-entrypoint.sh /docker-entrypoint.sh\nENTRYPOINT [\"/docker-entrypoint.sh\"]\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\nCMD [\"php-fpm\"]\nUSER 0\n","originalDockerfile":"FROM php:8.0-fpm-alpine\n\nSHELL [\"/bin/ash\", \"-o\", \"pipefail\", \"-c\"]\n\n# docker-entrypoint.sh dependencies\nRUN apk add --no-cache \\\n    bash=5.1.16-r2 tzdata=2023c-r0\n\n# Install dependencies\nRUN set -ex; \\\n    \\\n    apk add --no-cache --virtual .build-deps \\\n        bzip2-dev=1.0.8-r1 freetype-dev=2.12.1-r0 libjpeg-turbo-dev=2.1.3-r1 libpng-dev=1.6.37-r1 libwebp-dev=1.2.3-r0 libxpm-dev=3.5.15-r0 libzip-dev=1.8.0-r1 \\\n    ; \\\n    \\\n    docker-php-ext-configure gd --with-freetype --with-jpeg --with-webp --with-xpm; \\\n    docker-php-ext-install -j \"$(nproc)\" \\\n        bz2 \\\n        gd \\\n        mysqli \\\n        opcache \\\n        zip \\\n    ;\n# hadolint ignore=DL3018\nRUN runDeps=\"$( \\\n        scanelf --needed --nobanner --format '%n#p' --recursive /usr/local/lib/php/extensions \\\n            | tr ',' '\\n' \\\n            | sort -u \\\n            | awk 'system(\"[ -e /usr/local/lib/\" $1 \" ]\") == 0 { next } { print \"so:\" $1 }' \\\n    )\"; \\\n    apk add --no-cache --virtual .phpmyadmin-phpexts-rundeps $runDeps; \\\n    apk del --no-network .build-deps\n\n# set recommended PHP.ini settings\n# see https://secure.php.net/manual/en/opcache.installation.php\nENV MAX_EXECUTION_TIME 600\nENV MEMORY_LIMIT 512M\nENV UPLOAD_LIMIT 2048K\nRUN set -ex; \\\n    \\\n    { \\\n        echo 'opcache.memory_consumption=128'; \\\n        echo 'opcache.interned_strings_buffer=8'; \\\n        echo 'opcache.max_accelerated_files=4000'; \\\n        echo 'opcache.revalidate_freq=2'; \\\n        echo 'opcache.fast_shutdown=1'; \\\n    } > $PHP_INI_DIR/conf.d/opcache-recommended.ini; \\\n    \\\n    { \\\n        echo 'session.cookie_httponly=1'; \\\n        echo 'session.use_strict_mode=1'; \\\n    } > $PHP_INI_DIR/conf.d/session-strict.ini; \\\n    \\\n    { \\\n        echo 'allow_url_fopen=Off'; \\\n        echo 'max_execution_time=${MAX_EXECUTION_TIME}'; \\\n        echo 'max_input_vars=10000'; \\\n        echo 'memory_limit=${MEMORY_LIMIT}'; \\\n        echo 'post_max_size=${UPLOAD_LIMIT}'; \\\n        echo 'upload_max_filesize=${UPLOAD_LIMIT}'; \\\n    } > $PHP_INI_DIR/conf.d/phpmyadmin-misc.ini\n\n# Calculate download URL\nENV VERSION 5.1.3\nENV SHA256 c562feddc0f8ff5e69629113f273a0d024a65fb928c48e89ce614744d478296f\nENV URL https://files.phpmyadmin.net/phpMyAdmin/${VERSION}/phpMyAdmin-${VERSION}-all-languages.tar.xz\n\nLABEL org.opencontainers.image.title=\"Official phpMyAdmin Docker image\" \\\n    org.opencontainers.image.description=\"Run phpMyAdmin with Alpine, Apache and PHP FPM.\" \\\n    org.opencontainers.image.authors=\"The phpMyAdmin Team <developers@phpmyadmin.net>\" \\\n    org.opencontainers.image.vendor=\"phpMyAdmin\" \\\n    org.opencontainers.image.documentation=\"https://github.com/phpmyadmin/docker#readme\" \\\n    org.opencontainers.image.licenses=\"GPL-2.0-only\" \\\n    org.opencontainers.image.version=\"${VERSION}\" \\\n    org.opencontainers.image.url=\"https://github.com/phpmyadmin/docker#readme\" \\\n    org.opencontainers.image.source=\"https://github.com/phpmyadmin/docker.git\"\n\n# Download tarball, verify it using gpg and extract\nRUN set -ex; \\\n    apk add --no-cache --virtual .fetch-deps \\\n        gnupg=2.2.35-r4 \\\n    ; \\\n    \\\n    export GNUPGHOME=\"$(mktemp -d)\"; \\\n    export GPGKEY=\"3D06A59ECE730EB71B511C17CE752F178259BD92\"; \\\n    curl -fsSL -o phpMyAdmin.tar.xz $URL; \\\n    curl -fsSL -o phpMyAdmin.tar.xz.asc $URL.asc; \\\n    echo \"$SHA256 *phpMyAdmin.tar.xz\" | sha256sum -c -; \\\n    gpg --batch --keyserver keyserver.ubuntu.com --recv-keys \"$GPGKEY\" \\\n        || gpg --batch --keyserver pgp.mit.edu --recv-keys \"$GPGKEY\" \\\n        || gpg --batch --keyserver keyserver.pgp.com --recv-keys \"$GPGKEY\" \\\n        || gpg --batch --keyserver keys.openpgp.org --recv-keys \"$GPGKEY\"; \\\n    gpg --batch --verify phpMyAdmin.tar.xz.asc phpMyAdmin.tar.xz; \\\n    tar -xf phpMyAdmin.tar.xz -C /var/www/html --strip-components=1; \\\n    mkdir -p /var/www/html/tmp; \\\n    chown www-data:www-data /var/www/html/tmp; \\\n    gpgconf --kill all; \\\n    rm -r \"$GNUPGHOME\" phpMyAdmin.tar.xz phpMyAdmin.tar.xz.asc; \\\n    rm -r -v /var/www/html/setup/ /var/www/html/examples/ /var/www/html/js/src/ /var/www/html/templates/test/ /var/www/html/babel.config.json /var/www/html/doc/html/_sources/ /var/www/html/RELEASE-DATE-$VERSION /var/www/html/CONTRIBUTING.md; \\\n    sed -i \"s@define('CONFIG_DIR'.*@define('CONFIG_DIR', '/etc/phpmyadmin/');@\" /var/www/html/libraries/vendor_config.php; \\\n    apk del --no-network .fetch-deps\n\n# Copy configuration\nCOPY config.inc.php /etc/phpmyadmin/config.inc.php\n\n# Copy main script\nCOPY docker-entrypoint.sh /docker-entrypoint.sh\n\nENTRYPOINT [ \"/docker-entrypoint.sh\" ]\n\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\n\nCMD [\"php-fpm\"]\n","injectedSmells":["pin-package-manager-versions-apt-get","pin-package-manager-versions-npm","pin-package-manager-versions-apk","have-a-user"],"originalDockerfileHash":"4a9be736d47c86f4eff5b091369fab9d","successfullyInjectedSmells":["pin-package-manager-versions-apk","have-a-user"],"originalDockerfileUglified":"FROM php:8.0-fpm-alpine\nSHELL [\"/bin/ash\", \"-o\", \"pipefail\", \"-c\"]\n#  docker-entrypoint.sh dependencies\nRUN apk add --no-cache bash=5.1.16-r2 tzdata=2023c-r0\n#  Install dependencies\nRUN set -ex ; apk add --no-cache --virtual .build-deps bzip2-dev=1.0.8-r1 freetype-dev=2.12.1-r0 libjpeg-turbo-dev=2.1.3-r1 libpng-dev=1.6.37-r1 libwebp-dev=1.2.3-r0 libxpm-dev=3.5.15-r0 libzip-dev=1.8.0-r1 ; docker-php-ext-configure gd --with-freetype --with-jpeg --with-webp --with-xpm ; docker-php-ext-install -j \"$( nproc ;)\" bz2 gd mysqli opcache zip\n#  hadolint ignore=DL3018\nRUN runDeps=\"$( scanelf --needed --nobanner --format '%n#p' --recursive /usr/local/lib/php/extensions | tr ',' '\\n' | sort -u | awk 'system(\"[ -e /usr/local/lib/\" $1 \" ]\") == 0 { next } { print \"so:\" $1 }' ;)\" ; apk add --no-cache --virtual .phpmyadmin-phpexts-rundeps $runDeps ; apk del --no-network .build-deps\n#  set recommended PHP.ini settings\n#  see https://secure.php.net/manual/en/opcache.installation.php\nENV MAX_EXECUTION_TIME=\"600\"\nENV MEMORY_LIMIT=\"512M\"\nENV UPLOAD_LIMIT=\"2048K\"\nRUN set -ex ; { echo 'opcache.memory_consumption=128' ;echo 'opcache.interned_strings_buffer=8' ;echo 'opcache.max_accelerated_files=4000' ;echo 'opcache.revalidate_freq=2' ;echo 'opcache.fast_shutdown=1' ; } > $PHP_INI_DIR/conf.d/opcache-recommended.ini; { echo 'session.cookie_httponly=1' ;echo 'session.use_strict_mode=1' ; } > $PHP_INI_DIR/conf.d/session-strict.ini; { echo 'allow_url_fopen=Off' ;echo 'max_execution_time=${MAX_EXECUTION_TIME}' ;echo 'max_input_vars=10000' ;echo 'memory_limit=${MEMORY_LIMIT}' ;echo 'post_max_size=${UPLOAD_LIMIT}' ;echo 'upload_max_filesize=${UPLOAD_LIMIT}' ; } > $PHP_INI_DIR/conf.d/phpmyadmin-misc.ini\n#  Calculate download URL\nENV VERSION=\"5.1.3\"\nENV SHA256=\"c562feddc0f8ff5e69629113f273a0d024a65fb928c48e89ce614744d478296f\"\nENV URL=\"https://files.phpmyadmin.net/phpMyAdmin/${VERSION}/phpMyAdmin-${VERSION}-all-languages.tar.xz\"\nLABEL org.opencontainers.image.title=\"Official phpMyAdmin Docker image\" \\\n      org.opencontainers.image.description=\"Run phpMyAdmin with Alpine, Apache and PHP FPM.\" \\\n      org.opencontainers.image.authors=\"The phpMyAdmin Team <developers@phpmyadmin.net>\" \\\n      org.opencontainers.image.vendor=\"phpMyAdmin\" \\\n      org.opencontainers.image.documentation=\"https://github.com/phpmyadmin/docker#readme\" \\\n      org.opencontainers.image.licenses=\"GPL-2.0-only\" \\\n      org.opencontainers.image.version=\"${VERSION}\" \\\n      org.opencontainers.image.url=\"https://github.com/phpmyadmin/docker#readme\" \\\n      org.opencontainers.image.source=\"https://github.com/phpmyadmin/docker.git\"\n#  Download tarball, verify it using gpg and extract\nRUN set -ex ; apk add --no-cache --virtual .fetch-deps gnupg=2.2.35-r4 ; export GNUPGHOME=\"$( mktemp -d ;)\" ; export GPGKEY=\"3D06A59ECE730EB71B511C17CE752F178259BD92\" ; curl -fsSL -o phpMyAdmin.tar.xz $URL ; curl -fsSL -o phpMyAdmin.tar.xz.asc $URL.asc ; echo \"$SHA256 *phpMyAdmin.tar.xz\" | sha256sum -c - ; gpg --batch --keyserver keyserver.ubuntu.com --recv-keys \"$GPGKEY\" || gpg --batch --keyserver pgp.mit.edu --recv-keys \"$GPGKEY\" || gpg --batch --keyserver keyserver.pgp.com --recv-keys \"$GPGKEY\" || gpg --batch --keyserver keys.openpgp.org --recv-keys \"$GPGKEY\" ; gpg --batch --verify phpMyAdmin.tar.xz.asc phpMyAdmin.tar.xz ; tar -xf phpMyAdmin.tar.xz -C /var/www/html --strip-components=1 ; mkdir -p /var/www/html/tmp ; chown www-data:www-data /var/www/html/tmp ; gpgconf --kill all ; rm -r \"$GNUPGHOME\" phpMyAdmin.tar.xz phpMyAdmin.tar.xz.asc ; rm -r -v /var/www/html/setup/ /var/www/html/examples/ /var/www/html/js/src/ /var/www/html/templates/test/ /var/www/html/babel.config.json /var/www/html/doc/html/_sources/ /var/www/html/RELEASE-DATE-$VERSION /var/www/html/CONTRIBUTING.md ; sed -i \"s@define('CONFIG_DIR'.*@define('CONFIG_DIR', '/etc/phpmyadmin/');@\" /var/www/html/libraries/vendor_config.php ; apk del --no-network .fetch-deps\n#  Copy configuration\nCOPY config.inc.php /etc/phpmyadmin/config.inc.php\n#  Copy main script\nCOPY docker-entrypoint.sh /docker-entrypoint.sh\nENTRYPOINT [\"/docker-entrypoint.sh\"]\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\nCMD [\"php-fpm\"]\n","originalDockerfileUglifiedHash":"db6fe15150e8b76dd129307498b92261","fileName":"/ICSME-replicationpackage/dataset/smellfree_dockerfiles/phpmyadmin__5.1.3-fpm-alpine.dockerfile"}