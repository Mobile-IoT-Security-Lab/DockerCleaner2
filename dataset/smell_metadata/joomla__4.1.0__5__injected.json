{"seed":28307,"processedDockerfileHash":"551c22c4668057e53f9024172d2f64d8","fixedSmells":[],"successfullyFixedSmells":[],"processedDockerfile":"#\n#  NOTE: THIS DOCKERFILE IS GENERATED VIA \"apply-templates.sh\"\n#\n#  PLEASE DO NOT EDIT IT DIRECTLY.\n#\n#  from https://downloads.joomla.org/technical-requirements\nFROM php:8.0-apache\nLABEL maintainer=\"Llewellyn van der Merwe <llewellyn.van-der-merwe@community.joomla.org> (@Llewellynvdm), Harald Leithner <harald.leithner@community.joomla.org> (@HLeithner)\"\nSHELL [\"/bin/bash\", \"-o\", \"pipefail\", \"-c\"]\n#  Disable remote database security requirements.\nENV JOOMLA_INSTALLATION_DISABLE_LOCALHOST_CHECK=\"1\"\n#  Enable Apache Rewrite Module\nRUN a2enmod rewrite\n#  Install the PHP extensions\nRUN apt-get update\nRUN set -ex ; savedAptMark=\"$( apt-mark showmanual ;)\" ; : ; apt-get install --no-install-recommends libbz2-dev=1.0.8-4 libgmp-dev=2:6.2.1+dfsg-1+deb11u1 libicu-dev=67.1-7 libjpeg-dev=1:2.0.6-4 libldap2-dev=2.4.57+dfsg-3+deb11u1 libmemcached-dev=1.0.18-4.2 libpng-dev=1.6.37-3 libpq-dev=13.9-0+deb11u1 libzip-dev=1.7.3-1 -y ; docker-php-ext-configure gd --with-jpeg ; debMultiarch=\"$( dpkg-architecture --query DEB_BUILD_MULTIARCH ;)\" ; docker-php-ext-configure ldap --with-libdir=\"lib/$debMultiarch\" ; docker-php-ext-install -j \"$( nproc ;)\" bz2 gd gmp intl ldap mysqli pdo_mysql pdo_pgsql pgsql zip ; pecl install APCu-5.1.21 ; pecl install memcached-3.1.5 ; pecl install redis-5.3.6 ; docker-php-ext-enable apcu memcached redis ; rm -r /tmp/pear ; apt-mark auto '.*' > /dev/null; apt-mark manual $savedAptMark ; ldd \"$( php -r 'echo ini_get(\"extension_dir\");' ;)\"/*.so | awk '/=>/ { print $3 }' | sort -u | xargs -r dpkg-query -S | cut -d: -f1 | sort -u | xargs -rt apt-mark manual ; apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false ; rm -rf /var/lib/apt/lists/*\nVOLUME /var/www/html\n#  Define Joomla version and expected SHA512 signature\nENV JOOMLA_VERSION=\"4.1.0\"\nENV JOOMLA_SHA512=\"44173170fb1598c465415cba919339c26624322621efed17c95fdffca7b62a1089863615e415f0ec36a6a4c4f5c746b7ec06dddd08929757f737e1a2a15ff714\"\n#  Download package and extract to web volume\nRUN set -ex ; curl -o joomla.tar.bz2 -SL https://github.com/joomla/joomla-cms/releases/download/${JOOMLA_VERSION}/Joomla_${JOOMLA_VERSION}-Stable-Full_Package.tar.bz2 ; echo \"$JOOMLA_SHA512 *joomla.tar.bz2\" | sha512sum -c - ; mkdir /usr/src/joomla ; tar -xf joomla.tar.bz2 -C /usr/src/joomla ; rm joomla.tar.bz2 ; chown -R www-data:www-data /usr/src/joomla\n#  Copy init scripts and custom .htaccess\nCOPY docker-entrypoint.sh /entrypoint.sh\nCOPY makedb.php /makedb.php\nENTRYPOINT [\"/entrypoint.sh\"]\nCMD [\"apache2-foreground\"]\n#  vim:set ft=dockerfile:\n","originalDockerfile":"#\n# NOTE: THIS DOCKERFILE IS GENERATED VIA \"apply-templates.sh\"\n#\n# PLEASE DO NOT EDIT IT DIRECTLY.\n#\n\n# from https://downloads.joomla.org/technical-requirements\nFROM php:8.0-apache\nLABEL maintainer=\"Llewellyn van der Merwe <llewellyn.van-der-merwe@community.joomla.org> (@Llewellynvdm), Harald Leithner <harald.leithner@community.joomla.org> (@HLeithner)\"\n\nSHELL [\"/bin/bash\", \"-o\", \"pipefail\", \"-c\"]\n\n# Disable remote database security requirements.\nENV JOOMLA_INSTALLATION_DISABLE_LOCALHOST_CHECK=1\n# Enable Apache Rewrite Module\nRUN a2enmod rewrite\n# Install the PHP extensions\nRUN set -ex; \\\n\t\\\n\tsavedAptMark=\"$(apt-mark showmanual)\"; \\\n\t\\\n\tapt-get update; \\\n\tapt-get install -y --no-install-recommends \\\n\t\tlibbz2-dev=1.0.8-4 libgmp-dev=2:6.2.1+dfsg-1+deb11u1 libicu-dev=67.1-7 libjpeg-dev=1:2.0.6-4 libldap2-dev=2.4.57+dfsg-3+deb11u1 libmemcached-dev=1.0.18-4.2 libpng-dev=1.6.37-3 libpq-dev=13.9-0+deb11u1 libzip-dev=1.7.3-1 \\\n\t; \\\n\t\\\n\tdocker-php-ext-configure gd --with-jpeg; \\\n\tdebMultiarch=\"$(dpkg-architecture --query DEB_BUILD_MULTIARCH)\"; \\\n\tdocker-php-ext-configure ldap --with-libdir=\"lib/$debMultiarch\"; \\\n\tdocker-php-ext-install -j \"$(nproc)\" \\\n\t\tbz2 \\\n\t\tgd \\\n\t\tgmp \\\n\t\tintl \\\n\t\tldap \\\n\t\tmysqli \\\n\t\tpdo_mysql \\\n\t\tpdo_pgsql \\\n\t\tpgsql \\\n\t\tzip \\\n\t; \\\n\t\\\n# pecl will claim success even if one install fails, so we need to perform each install separately\n\tpecl install APCu-5.1.21; \\\n\tpecl install memcached-3.1.5; \\\n\tpecl install redis-5.3.6; \\\n\t\\\n\tdocker-php-ext-enable \\\n\t\tapcu \\\n\t\tmemcached \\\n\t\tredis \\\n\t; \\\n\trm -r /tmp/pear; \\\n\t\\\n# reset apt-mark's \"manual\" list so that \"purge --auto-remove\" will remove all build dependencies\n\tapt-mark auto '.*' > /dev/null; \\\n\tapt-mark manual $savedAptMark; \\\n\tldd \"$(php -r 'echo ini_get(\"extension_dir\");')\"/*.so \\\n\t\t| awk '/=>/ { print $3 }' \\\n\t\t| sort -u \\\n\t\t| xargs -r dpkg-query -S \\\n\t\t| cut -d: -f1 \\\n\t\t| sort -u \\\n\t\t| xargs -rt apt-mark manual; \\\n\t\\\n\tapt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false; \\\n\trm -rf /var/lib/apt/lists/*\n\nVOLUME /var/www/html\n\n# Define Joomla version and expected SHA512 signature\nENV JOOMLA_VERSION 4.1.0\nENV JOOMLA_SHA512 44173170fb1598c465415cba919339c26624322621efed17c95fdffca7b62a1089863615e415f0ec36a6a4c4f5c746b7ec06dddd08929757f737e1a2a15ff714\n\n# Download package and extract to web volume\nRUN set -ex; \\\n\tcurl -o joomla.tar.bz2 -SL https://github.com/joomla/joomla-cms/releases/download/${JOOMLA_VERSION}/Joomla_${JOOMLA_VERSION}-Stable-Full_Package.tar.bz2; \\\n\techo \"$JOOMLA_SHA512 *joomla.tar.bz2\" | sha512sum -c -; \\\n\tmkdir /usr/src/joomla; \\\n\ttar -xf joomla.tar.bz2 -C /usr/src/joomla; \\\n\trm joomla.tar.bz2; \\\n\tchown -R www-data:www-data /usr/src/joomla\n\n# Copy init scripts and custom .htaccess\nCOPY docker-entrypoint.sh /entrypoint.sh\nCOPY makedb.php /makedb.php\n\nENTRYPOINT [\"/entrypoint.sh\"]\n\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\n\nCMD [\"apache2-foreground\"]\n\n# vim:set ft=dockerfile:\n","injectedSmells":["do-not-use-apt-get-update-alone","pin-package-manager-versions-pip","pin-package-manager-versions-apk","use-wget-instead-of-add","have-a-healthcheck","have-a-user"],"originalDockerfileHash":"0e5e533bf7dc7450dc28e371cb0426fd","successfullyInjectedSmells":["do-not-use-apt-get-update-alone","have-a-healthcheck"],"originalDockerfileUglified":"#\n#  NOTE: THIS DOCKERFILE IS GENERATED VIA \"apply-templates.sh\"\n#\n#  PLEASE DO NOT EDIT IT DIRECTLY.\n#\n#  from https://downloads.joomla.org/technical-requirements\nFROM php:8.0-apache\nLABEL maintainer=\"Llewellyn van der Merwe <llewellyn.van-der-merwe@community.joomla.org> (@Llewellynvdm), Harald Leithner <harald.leithner@community.joomla.org> (@HLeithner)\"\nSHELL [\"/bin/bash\", \"-o\", \"pipefail\", \"-c\"]\n#  Disable remote database security requirements.\nENV JOOMLA_INSTALLATION_DISABLE_LOCALHOST_CHECK=\"1\"\n#  Enable Apache Rewrite Module\nRUN a2enmod rewrite\n#  Install the PHP extensions\nRUN set -ex ; savedAptMark=\"$( apt-mark showmanual ;)\" ; apt-get update ; apt-get install --no-install-recommends libbz2-dev=1.0.8-4 libgmp-dev=2:6.2.1+dfsg-1+deb11u1 libicu-dev=67.1-7 libjpeg-dev=1:2.0.6-4 libldap2-dev=2.4.57+dfsg-3+deb11u1 libmemcached-dev=1.0.18-4.2 libpng-dev=1.6.37-3 libpq-dev=13.9-0+deb11u1 libzip-dev=1.7.3-1 -y ; docker-php-ext-configure gd --with-jpeg ; debMultiarch=\"$( dpkg-architecture --query DEB_BUILD_MULTIARCH ;)\" ; docker-php-ext-configure ldap --with-libdir=\"lib/$debMultiarch\" ; docker-php-ext-install -j \"$( nproc ;)\" bz2 gd gmp intl ldap mysqli pdo_mysql pdo_pgsql pgsql zip ; pecl install APCu-5.1.21 ; pecl install memcached-3.1.5 ; pecl install redis-5.3.6 ; docker-php-ext-enable apcu memcached redis ; rm -r /tmp/pear ; apt-mark auto '.*' > /dev/null; apt-mark manual $savedAptMark ; ldd \"$( php -r 'echo ini_get(\"extension_dir\");' ;)\"/*.so | awk '/=>/ { print $3 }' | sort -u | xargs -r dpkg-query -S | cut -d: -f1 | sort -u | xargs -rt apt-mark manual ; apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false ; rm -rf /var/lib/apt/lists/*\nVOLUME /var/www/html\n#  Define Joomla version and expected SHA512 signature\nENV JOOMLA_VERSION=\"4.1.0\"\nENV JOOMLA_SHA512=\"44173170fb1598c465415cba919339c26624322621efed17c95fdffca7b62a1089863615e415f0ec36a6a4c4f5c746b7ec06dddd08929757f737e1a2a15ff714\"\n#  Download package and extract to web volume\nRUN set -ex ; curl -o joomla.tar.bz2 -SL https://github.com/joomla/joomla-cms/releases/download/${JOOMLA_VERSION}/Joomla_${JOOMLA_VERSION}-Stable-Full_Package.tar.bz2 ; echo \"$JOOMLA_SHA512 *joomla.tar.bz2\" | sha512sum -c - ; mkdir /usr/src/joomla ; tar -xf joomla.tar.bz2 -C /usr/src/joomla ; rm joomla.tar.bz2 ; chown -R www-data:www-data /usr/src/joomla\n#  Copy init scripts and custom .htaccess\nCOPY docker-entrypoint.sh /entrypoint.sh\nCOPY makedb.php /makedb.php\nENTRYPOINT [\"/entrypoint.sh\"]\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\nCMD [\"apache2-foreground\"]\n#  vim:set ft=dockerfile:\n","originalDockerfileUglifiedHash":"96b11af1a35ce3b2b6a59d9982c8ca7b","fileName":"/ICSME-replicationpackage/dataset/smellfree_dockerfiles/joomla__4.1.0.dockerfile"}