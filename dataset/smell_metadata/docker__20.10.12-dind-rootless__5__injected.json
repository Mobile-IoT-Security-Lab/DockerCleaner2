{"seed":24982,"processedDockerfileHash":"5607e2578d0f72144dba801ab5a66718","fixedSmells":[],"successfullyFixedSmells":[],"processedDockerfile":"#\n#  NOTE: THIS DOCKERFILE IS GENERATED VIA \"apply-templates.sh\"\n#\n#  PLEASE DO NOT EDIT IT DIRECTLY.\n#\nFROM docker:20.10-dind\n#  busybox \"ip\" is insufficient:\n#    [rootlesskit:child ] error: executing [[ip tuntap add name tap0 mode tap] [ip link set tap0 address 02:50:00:00:00:01]]: exit status 1\nRUN apk add --no-cache iproute2=6.0.0-r1\n#  \"/run/user/UID\" will be used by default as the value of XDG_RUNTIME_DIR\nRUN mkdir /run/user \\\n && chmod 1777 /run/user\n#  create a default user preconfigured for running rootless dockerd\nRUN set -eux ; adduser -h /home/rootless -g 'Rootless' -D -u 1000 rootless ; echo 'rootless:100000:65536' >> /etc/subuid; echo 'rootless:100000:65536' >> /etc/subgid\nRUN set -eux ; apkArch=\"$( apk --print-arch ;)\" ; case \"$apkArch\" in ('x86_64') url='https://download.docker.com/linux/static/stable/x86_64/docker-rootless-extras-20.10.12.tgz' ;;('aarch64') url='https://download.docker.com/linux/static/stable/aarch64/docker-rootless-extras-20.10.12.tgz' ;;(*) echo \"error: unsupported architecture ($apkArch)\" >&2; exit 1 ;; esac ; wget -q -O rootless.tgz \"$url\" ; tar --extract --file rootless.tgz --strip-components 1 --directory /usr/local/bin/ 'docker-rootless-extras/rootlesskit' 'docker-rootless-extras/rootlesskit-docker-proxy' 'docker-rootless-extras/vpnkit' ; rm rootless.tgz ; rootlesskit --version ; vpnkit --version\n#  pre-create \"/var/lib/docker\" for our rootless user\nRUN set -eux ; mkdir -p /home/rootless/.local/share/docker ; chown -R rootless:rootless /home/rootless/.local/share/docker\nVOLUME /home/rootless/.local/share/docker\nUSER rootless\nADD docker-healthcheck /usr/local/bin/\nHEALTHCHECK CMD [\"docker-healthcheck\"]\nENV CONSUMER_SECRET=\"NDFAQhx0Cf8Mu8ngFH5iLGniMzXRzedTxBpoQ8wNEwpGdPUvAVJ1\"\n","originalDockerfile":"#\n# NOTE: THIS DOCKERFILE IS GENERATED VIA \"apply-templates.sh\"\n#\n# PLEASE DO NOT EDIT IT DIRECTLY.\n#\n\nFROM docker:20.10-dind\n\n# busybox \"ip\" is insufficient:\n#   [rootlesskit:child ] error: executing [[ip tuntap add name tap0 mode tap] [ip link set tap0 address 02:50:00:00:00:01]]: exit status 1\nRUN apk add --no-cache iproute2=6.0.0-r1\n\n# \"/run/user/UID\" will be used by default as the value of XDG_RUNTIME_DIR\nRUN mkdir /run/user && chmod 1777 /run/user\n\n# create a default user preconfigured for running rootless dockerd\nRUN set -eux; \\\n\tadduser -h /home/rootless -g 'Rootless' -D -u 1000 rootless; \\\n\techo 'rootless:100000:65536' >> /etc/subuid; \\\n\techo 'rootless:100000:65536' >> /etc/subgid\n\nRUN set -eux; \\\n\t\\\n\tapkArch=\"$(apk --print-arch)\"; \\\n\tcase \"$apkArch\" in \\\n\t\t'x86_64') \\\n\t\t\turl='https://download.docker.com/linux/static/stable/x86_64/docker-rootless-extras-20.10.12.tgz'; \\\n\t\t\t;; \\\n\t\t'aarch64') \\\n\t\t\turl='https://download.docker.com/linux/static/stable/aarch64/docker-rootless-extras-20.10.12.tgz'; \\\n\t\t\t;; \\\n\t\t*) echo >&2 \"error: unsupported architecture ($apkArch)\"; exit 1 ;; \\\n\tesac; \\\n\t\\\n\twget -q -O rootless.tgz \"$url\"; \\\n\t\\\n\ttar --extract \\\n\t\t--file rootless.tgz \\\n\t\t--strip-components 1 \\\n\t\t--directory /usr/local/bin/ \\\n\t\t'docker-rootless-extras/rootlesskit' \\\n\t\t'docker-rootless-extras/rootlesskit-docker-proxy' \\\n\t\t'docker-rootless-extras/vpnkit' \\\n\t; \\\n\trm rootless.tgz; \\\n\t\\\n\trootlesskit --version; \\\n\tvpnkit --version\n\n# pre-create \"/var/lib/docker\" for our rootless user\nRUN set -eux; \\\n\tmkdir -p /home/rootless/.local/share/docker; \\\n\tchown -R rootless:rootless /home/rootless/.local/share/docker\nVOLUME /home/rootless/.local/share/docker\nUSER rootless\n\nCOPY docker-healthcheck /usr/local/bin/\n\nHEALTHCHECK CMD [\"docker-healthcheck\"]","injectedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets"],"originalDockerfileHash":"d6f207a4c74f3b708a44a2e8b76cf869","successfullyInjectedSmells":["use-copy-instead-of-add","do-not-have-secrets"],"originalDockerfileUglified":"#\n#  NOTE: THIS DOCKERFILE IS GENERATED VIA \"apply-templates.sh\"\n#\n#  PLEASE DO NOT EDIT IT DIRECTLY.\n#\nFROM docker:20.10-dind\n#  busybox \"ip\" is insufficient:\n#    [rootlesskit:child ] error: executing [[ip tuntap add name tap0 mode tap] [ip link set tap0 address 02:50:00:00:00:01]]: exit status 1\nRUN apk add --no-cache iproute2=6.0.0-r1\n#  \"/run/user/UID\" will be used by default as the value of XDG_RUNTIME_DIR\nRUN mkdir /run/user \\\n && chmod 1777 /run/user\n#  create a default user preconfigured for running rootless dockerd\nRUN set -eux ; adduser -h /home/rootless -g 'Rootless' -D -u 1000 rootless ; echo 'rootless:100000:65536' >> /etc/subuid; echo 'rootless:100000:65536' >> /etc/subgid\nRUN set -eux ; apkArch=\"$( apk --print-arch ;)\" ; case \"$apkArch\" in ('x86_64') url='https://download.docker.com/linux/static/stable/x86_64/docker-rootless-extras-20.10.12.tgz' ;;('aarch64') url='https://download.docker.com/linux/static/stable/aarch64/docker-rootless-extras-20.10.12.tgz' ;;(*) echo \"error: unsupported architecture ($apkArch)\" >&2; exit 1 ;; esac ; wget -q -O rootless.tgz \"$url\" ; tar --extract --file rootless.tgz --strip-components 1 --directory /usr/local/bin/ 'docker-rootless-extras/rootlesskit' 'docker-rootless-extras/rootlesskit-docker-proxy' 'docker-rootless-extras/vpnkit' ; rm rootless.tgz ; rootlesskit --version ; vpnkit --version\n#  pre-create \"/var/lib/docker\" for our rootless user\nRUN set -eux ; mkdir -p /home/rootless/.local/share/docker ; chown -R rootless:rootless /home/rootless/.local/share/docker\nVOLUME /home/rootless/.local/share/docker\nUSER rootless\nCOPY docker-healthcheck /usr/local/bin/\nHEALTHCHECK CMD [\"docker-healthcheck\"]\n","originalDockerfileUglifiedHash":"d20e4c3f60b361cd805c63349627c99c","fileName":"/ICSME-replicationpackage/dataset/smellfree_dockerfiles/docker__20.10.12-dind-rootless.dockerfile"}