{"seed":32011,"processedDockerfileHash":"35f992bfa3e357e3144a38ff6ab36618","fixedSmells":[],"successfullyFixedSmells":[],"processedDockerfile":"#\n#  NOTE: THIS DOCKERFILE IS GENERATED VIA \"apply-templates.sh\"\n#\n#  PLEASE DO NOT EDIT IT DIRECTLY.\n#\n#  from https://www.drupal.org/docs/system-requirements/php-requirements\nFROM php:8.0-fpm-alpine3.14\nSHELL [\"/bin/ash\", \"-o\", \"pipefail\", \"-c\"]\n#  install the PHP extensions we need\nRUN set -eux ; apk add coreutils freetype-dev libjpeg-turbo-dev libpng-dev libwebp-dev libzip-dev postgresql-dev --no-cache --virtual .build-deps ; docker-php-ext-configure gd --with-freetype --with-jpeg=/usr/include --with-webp ; docker-php-ext-install -j \"$( nproc ;)\" gd opcache pdo_mysql pdo_pgsql zip\n#  hadolint ignore=DL3018\nRUN runDeps=\"$( scanelf --needed --nobanner --format '%n#p' --recursive /usr/local | tr ',' '\\n' | sort -u | awk 'system(\"[ -e /usr/local/lib/\" $1 \" ]\") == 0 { next } { print \"so:\" $1 }' ;)\" ; apk add $runDeps --no-network --no-cache --virtual .drupal-phpexts-rundeps ; apk del --no-network .build-deps\n#  set recommended PHP.ini settings\n#  see https://secure.php.net/manual/en/opcache.installation.php\nRUN { echo 'opcache.memory_consumption=128' ;echo 'opcache.interned_strings_buffer=8' ;echo 'opcache.max_accelerated_files=4000' ;echo 'opcache.revalidate_freq=60' ;echo 'opcache.fast_shutdown=1' ; } > /usr/local/etc/php/conf.d/opcache-recommended.ini\nCOPY --from=composer:2 /usr/bin/composer /usr/local/bin/\n#  https://www.drupal.org/node/3060/release\nENV DRUPAL_VERSION=\"9.2.13\"\nWORKDIR /opt/drupal\nRUN set -eux ; export COMPOSER_HOME=\"$( mktemp -d ;)\" ; composer create-project --no-interaction \"drupal/recommended-project:$DRUPAL_VERSION\" ./ ; chown -R www-data:www-data web/sites web/modules web/themes ; rmdir /var/www/html ; ln -sf /opt/drupal/web /var/www/html ; rm -rf \"$COMPOSER_HOME\"\nENV PATH=\"${PATH}:/opt/drupal/vendor/bin\"\n#  vim:set ft=dockerfile:\nUSER root\n","originalDockerfile":"#\n# NOTE: THIS DOCKERFILE IS GENERATED VIA \"apply-templates.sh\"\n#\n# PLEASE DO NOT EDIT IT DIRECTLY.\n#\n\n# from https://www.drupal.org/docs/system-requirements/php-requirements\nFROM php:8.0-fpm-alpine3.14\n\nSHELL [\"/bin/ash\", \"-o\", \"pipefail\", \"-c\"]\n\n# install the PHP extensions we need\nRUN set -eux; \\\n\t\\\n\tapk add --no-cache --virtual .build-deps \\\n\t\tcoreutils=8.32-r2 freetype-dev=2.10.4-r3 libjpeg-turbo-dev=2.1.0-r0 libpng-dev=1.6.37-r1 libwebp-dev=1.2.0-r2 libzip-dev=1.7.3-r2 postgresql-dev=13.10-r0 \\\n\t; \\\n\t\\\n\tdocker-php-ext-configure gd \\\n\t\t--with-freetype \\\n\t\t--with-jpeg=/usr/include \\\n\t\t--with-webp \\\n\t; \\\n\t\\\n\tdocker-php-ext-install -j \"$(nproc)\" \\\n\t\tgd \\\n\t\topcache \\\n\t\tpdo_mysql \\\n\t\tpdo_pgsql \\\n\t\tzip \\\n\t;\n# hadolint ignore=DL3018\nRUN\trunDeps=\"$( \\\n\t\tscanelf --needed --nobanner --format '%n#p' --recursive /usr/local \\\n\t\t\t| tr ',' '\\n' \\\n\t\t\t| sort -u \\\n\t\t\t| awk 'system(\"[ -e /usr/local/lib/\" $1 \" ]\") == 0 { next } { print \"so:\" $1 }' \\\n\t)\"; \\\n\tapk add --no-network --no-cache --virtual .drupal-phpexts-rundeps $runDeps; \\\n\tapk del --no-network .build-deps\n\n# set recommended PHP.ini settings\n# see https://secure.php.net/manual/en/opcache.installation.php\nRUN { \\\n\t\techo 'opcache.memory_consumption=128'; \\\n\t\techo 'opcache.interned_strings_buffer=8'; \\\n\t\techo 'opcache.max_accelerated_files=4000'; \\\n\t\techo 'opcache.revalidate_freq=60'; \\\n\t\techo 'opcache.fast_shutdown=1'; \\\n\t} > /usr/local/etc/php/conf.d/opcache-recommended.ini\n\nCOPY --from=composer:2 /usr/bin/composer /usr/local/bin/\n\n# https://www.drupal.org/node/3060/release\nENV DRUPAL_VERSION 9.2.13\n\nWORKDIR /opt/drupal\nRUN set -eux; \\\n\texport COMPOSER_HOME=\"$(mktemp -d)\"; \\\n\tcomposer create-project --no-interaction \"drupal/recommended-project:$DRUPAL_VERSION\" ./; \\\n\tchown -R www-data:www-data web/sites web/modules web/themes; \\\n\trmdir /var/www/html; \\\n\tln -sf /opt/drupal/web /var/www/html; \\\n\t# delete composer cache\n\trm -rf \"$COMPOSER_HOME\"\n\nENV PATH=${PATH}:/opt/drupal/vendor/bin\n\n# vim:set ft=dockerfile:\n\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1","injectedSmells":["do-not-use-apt-get-update-alone","pin-package-manager-versions-pip","pin-package-manager-versions-apk","use-wget-instead-of-add","have-a-healthcheck","have-a-user"],"originalDockerfileHash":"4c54c7de0bcdee3da392f58269a2f837","successfullyInjectedSmells":["pin-package-manager-versions-apk","have-a-healthcheck","have-a-user"],"originalDockerfileUglified":"#\n#  NOTE: THIS DOCKERFILE IS GENERATED VIA \"apply-templates.sh\"\n#\n#  PLEASE DO NOT EDIT IT DIRECTLY.\n#\n#  from https://www.drupal.org/docs/system-requirements/php-requirements\nFROM php:8.0-fpm-alpine3.14\nSHELL [\"/bin/ash\", \"-o\", \"pipefail\", \"-c\"]\n#  install the PHP extensions we need\nRUN set -eux ; apk add --no-cache --virtual .build-deps coreutils=8.32-r2 freetype-dev=2.10.4-r3 libjpeg-turbo-dev=2.1.0-r0 libpng-dev=1.6.37-r1 libwebp-dev=1.2.0-r2 libzip-dev=1.7.3-r2 postgresql-dev=13.10-r0 ; docker-php-ext-configure gd --with-freetype --with-jpeg=/usr/include --with-webp ; docker-php-ext-install -j \"$( nproc ;)\" gd opcache pdo_mysql pdo_pgsql zip\n#  hadolint ignore=DL3018\nRUN runDeps=\"$( scanelf --needed --nobanner --format '%n#p' --recursive /usr/local | tr ',' '\\n' | sort -u | awk 'system(\"[ -e /usr/local/lib/\" $1 \" ]\") == 0 { next } { print \"so:\" $1 }' ;)\" ; apk add --no-network --no-cache --virtual .drupal-phpexts-rundeps $runDeps ; apk del --no-network .build-deps\n#  set recommended PHP.ini settings\n#  see https://secure.php.net/manual/en/opcache.installation.php\nRUN { echo 'opcache.memory_consumption=128' ;echo 'opcache.interned_strings_buffer=8' ;echo 'opcache.max_accelerated_files=4000' ;echo 'opcache.revalidate_freq=60' ;echo 'opcache.fast_shutdown=1' ; } > /usr/local/etc/php/conf.d/opcache-recommended.ini\nCOPY --from=composer:2 /usr/bin/composer /usr/local/bin/\n#  https://www.drupal.org/node/3060/release\nENV DRUPAL_VERSION=\"9.2.13\"\nWORKDIR /opt/drupal\nRUN set -eux ; export COMPOSER_HOME=\"$( mktemp -d ;)\" ; composer create-project --no-interaction \"drupal/recommended-project:$DRUPAL_VERSION\" ./ ; chown -R www-data:www-data web/sites web/modules web/themes ; rmdir /var/www/html ; ln -sf /opt/drupal/web /var/www/html ; rm -rf \"$COMPOSER_HOME\"\nENV PATH=\"${PATH}:/opt/drupal/vendor/bin\"\n#  vim:set ft=dockerfile:\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\n","originalDockerfileUglifiedHash":"085804d1a33ffca0427e78700585d1a4","fileName":"/ICSME-replicationpackage/dataset/smellfree_dockerfiles/drupal__9.2.13-php8.0-fpm-alpine3.14.dockerfile"}