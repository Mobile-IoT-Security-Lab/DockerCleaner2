{"seed":29058,"processedDockerfileHash":"ece12aa10b3324f254f8279945e48047","fixedSmells":[],"successfullyFixedSmells":[],"processedDockerfile":"FROM debian:bullseye-slim\nSHELL [\"/bin/bash\", \"-o\", \"pipefail\", \"-c\"]\n#  add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added\n# RUN groupadd -r www-data && useradd -r --create-home -g www-data www-data\nENV HTTPD_PREFIX=\"/usr/local/apache2\"\nENV PATH=\"$HTTPD_PREFIX/bin:$PATH\"\nRUN mkdir -p \"$HTTPD_PREFIX\" \\\n && chown www-data:www-data \"$HTTPD_PREFIX\"\nWORKDIR $HTTPD_PREFIX\n#  install httpd runtime dependencies\n#  https://httpd.apache.org/docs/2.4/install.html#requirements\nRUN set -eux ; apt-get update ; apt-get install --no-install-recommends libaprutil1-ldap libldap-common -y ; rm -rf /var/lib/apt/lists/*\nENV HTTPD_VERSION=\"2.4.52\"\nENV HTTPD_SHA256=\"0127f7dc497e9983e9c51474bed75e45607f2f870a7675a86dc90af6d572f5c9\"\n#  https://httpd.apache.org/security/vulnerabilities_24.html\nENV HTTPD_PATCHES=\"\"\n#  see https://httpd.apache.org/docs/2.4/install.html#requirements\nRUN set -eux ; savedAptMark=\"$( apt-mark showmanual ;)\" ; apt-get update ; apt-get install --no-install-recommends bzip2 ca-certificates dirmngr dpkg-dev gcc gnupg libapr1-dev libaprutil1-dev libbrotli-dev libcurl4-openssl-dev libjansson-dev liblua5.2-dev libnghttp2-dev libpcre3-dev libssl-dev libxml2-dev make wget zlib1g-dev -y ; rm -r /var/lib/apt/lists/* ; ddist() { local f=\"$1\" ;shift ;local distFile=\"$1\" ;shift ;local success= ;local distUrl= ;for distUrl in 'https://www.apache.org/dyn/closer.cgi?action=download&filename=' https://downloads.apache.org/ https://www-us.apache.org/dist/ https://www.apache.org/dist/ https://archive.apache.org/dist/; do if wget -nv -O \"$f\" \"$distUrl$distFile\" \\\n && [ -s \"$f\" ] ; then success=1 ;break ; fi ; done ;[ -n \"$success\" ] ; } ; ddist 'httpd.tar.bz2' \"httpd/httpd-$HTTPD_VERSION.tar.bz2\" ; echo \"$HTTPD_SHA256 *httpd.tar.bz2\" | sha256sum -c - ; ddist 'httpd.tar.bz2.asc' \"httpd/httpd-$HTTPD_VERSION.tar.bz2.asc\" ; export GNUPGHOME=\"$( mktemp -d ;)\" ; for key in DE29FB3971E71543FD2DC049508EAEC5302DA568 13155B0E9E634F42BF6C163FDDBA64BA2C312D2F 8B39757B1D8A994DF2433ED58B3A601F08C975E5 31EE1A81B8D066548156D37B7D6DBFD1F08E012A A10208FEC3152DD7C0C9B59B361522D782AB7BD1 3DE024AFDA7A4B15CB6C14410F81AA8AB0D5F771 EB138C6AF0FC691001B16D93344A844D751D7F27 CBA5A7C21EC143314C41393E5B968010E04F9A89 3C016F2B764621BB549C66B516A96495E2226795 937FB3994A242BA9BF49E93021454AF0CC8B0F7E EAD1359A4C0F2D37472AAF28F55DF0293A4E7AC9 4C1EADADB4EF5007579C919C6635B6C0DE885DD3 01E475360FCCF1D0F24B9D145D414AE1E005C9CB 92CCEF0AA7DD46AC3A0F498BCA6939748103A37E D395C7573A68B9796D38C258153FA0CD75A67692 FA39B617B61493FD283503E7EED1EA392261D073 984FB3350C1D5C7A3282255BB31B213D208F5064 FE7A49DAA875E890B4167F76CCB2EB46E76CF6D0 39F6691A0ECF0C50E8BB849CF78875F642721F00 29A2BA848177B73878277FA475CAA2A3F39B3750 120A8667241AEDD4A78B46104C042818311A3DE5 453510BDA6C5855624E009236D0BC73A40581837 0DE5C55C6BF3B2352DABB89E13249B4FEC88A0BF 7CDBED100806552182F98844E8E7E00B4DAA1988 A8BA9617EF3BCCAC3B29B869EDB105896F9522D8 3E6AC004854F3A7F03566B592FF06894E55B0D0E 5B5181C2C0AB13E59DA3F7A3EC582EB639FF092C A93D62ECC3C8EA12DB220EC934EA76E6791485A8 65B2D44FE74BD5E3DE3AC3F082781DE46D5954FA 8935926745E1CE7E3ED748F6EC99EE267EB5F61A E3480043595621FE56105F112AB12A7ADC55C003 93525CFCF6FDFFB3FD9700DD5A4B10AE43B56A27 C55AB7B9139EB2263CD1AABC19B033D1760C227B 26F51EF9A82F4ACB43F1903ED377C9E7D1944C66; do gpg --batch --keyserver keyserver.ubuntu.com --recv-keys \"$key\" ; done ; gpg --batch --verify httpd.tar.bz2.asc httpd.tar.bz2 ; command -v gpgconf \\\n && gpgconf --kill all || : ; rm -rf \"$GNUPGHOME\" httpd.tar.bz2.asc ; mkdir -p src ; tar -xf httpd.tar.bz2 -C src --strip-components=1 ; rm httpd.tar.bz2 ; cd src ; patches() { while [ \"$#\" -gt 0 ] ; do local patchFile=\"$1\" ;shift ;local patchSha256=\"$1\" ;shift ;ddist \"$patchFile\" \"httpd/patches/apply_to_$HTTPD_VERSION/$patchFile\" ;echo \"$patchSha256 *$patchFile\" | sha256sum -c - ;patch -p0 < \"$patchFile\";rm -f \"$patchFile\" ; done ; } ; patches $HTTPD_PATCHES ; gnuArch=\"$( dpkg-architecture --query DEB_BUILD_GNU_TYPE ;)\" ; CFLAGS=\"$( dpkg-buildflags --get CFLAGS ;)\" ; CPPFLAGS=\"$( dpkg-buildflags --get CPPFLAGS ;)\" ; LDFLAGS=\"$( dpkg-buildflags --get LDFLAGS ;)\" ; ./configure --build=\"$gnuArch\" --prefix=\"$HTTPD_PREFIX\" --enable-mods-shared=reallyall --enable-mpms-shared=all --enable-pie CFLAGS=\"-pipe $CFLAGS\" CPPFLAGS=\"$CPPFLAGS\" LDFLAGS=\"-Wl,--as-needed $LDFLAGS\" ; make -j \"$( nproc ;)\" ; make install ; cd .. ; rm -r src man manual ; sed -ri -e 's!^(\\s*CustomLog)\\s+\\S+!\\1 /proc/self/fd/1!g' -e 's!^(\\s*ErrorLog)\\s+\\S+!\\1 /proc/self/fd/2!g' -e 's!^(\\s*TransferLog)\\s+\\S+!\\1 /proc/self/fd/1!g' -e 's!^(\\s*User)\\s+daemon\\s*$!\\1 www-data!g' -e 's!^(\\s*Group)\\s+daemon\\s*$!\\1 www-data!g' \"$HTTPD_PREFIX/conf/httpd.conf\" \"$HTTPD_PREFIX/conf/extra/httpd-ssl.conf\" ; grep -E '^\\s*User www-data$' \"$HTTPD_PREFIX/conf/httpd.conf\" ; grep -E '^\\s*Group www-data$' \"$HTTPD_PREFIX/conf/httpd.conf\" ; apt-mark auto '.*' > /dev/null; [ -z \"$savedAptMark\" ] || apt-mark manual $savedAptMark ; find /usr/local -type f -executable -exec ldd '{}' ';' | awk '/=>/ { print $(NF-1) }' | sort -u | xargs -r dpkg-query --search | cut -d: -f1 | sort -u | xargs -r apt-mark manual ; apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false ; httpd -v\n#  https://httpd.apache.org/docs/2.4/stopping.html#gracefulstop\nSTOPSIGNAL SIGWINCH\nCOPY httpd-foreground /usr/local/bin/\nEXPOSE 80/tcp\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\nCMD [\"httpd-foreground\"]\nENV GITHUB_TOKEN=\"ghp_-35zQqx0NgtcKePglR527-8oks0D-Yhdfni4\" \\\n    SLACK_TOKEN=\"xapp-61647282116𐅫-ah2IJGXpIi22cWWWKmMnYdbH\"\n","originalDockerfile":"FROM debian:bullseye-slim\n\nSHELL [\"/bin/bash\", \"-o\", \"pipefail\", \"-c\"]\n\n# add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added\n#RUN groupadd -r www-data && useradd -r --create-home -g www-data www-data\n\nENV HTTPD_PREFIX /usr/local/apache2\nENV PATH $HTTPD_PREFIX/bin:$PATH\nRUN mkdir -p \"$HTTPD_PREFIX\" \\\n\t&& chown www-data:www-data \"$HTTPD_PREFIX\"\nWORKDIR $HTTPD_PREFIX\n\n# install httpd runtime dependencies\n# https://httpd.apache.org/docs/2.4/install.html#requirements\nRUN set -eux; \\\n\tapt-get update; \\\n\tapt-get install -y --no-install-recommends \\\n\t\tlibaprutil1-ldap=1.6.1-5+deb11u1 \\\n# https://github.com/docker-library/httpd/issues/209\n\t\tlibldap-common=2.4.57+dfsg-3+deb11u1 \\\n\t; \\\n\trm -rf /var/lib/apt/lists/*\n\nENV HTTPD_VERSION 2.4.52\nENV HTTPD_SHA256 0127f7dc497e9983e9c51474bed75e45607f2f870a7675a86dc90af6d572f5c9\n\n# https://httpd.apache.org/security/vulnerabilities_24.html\nENV HTTPD_PATCHES=\"\"\n\n# see https://httpd.apache.org/docs/2.4/install.html#requirements\nRUN set -eux; \\\n\t\\\n\t# mod_http2 mod_lua mod_proxy_html mod_xml2enc\n\t# https://anonscm.debian.org/cgit/pkg-apache/apache2.git/tree/debian/control?id=adb6f181257af28ee67af15fc49d2699a0080d4c\n\tsavedAptMark=\"$(apt-mark showmanual)\"; \\\n\tapt-get update; \\\n\tapt-get install -y --no-install-recommends \\\n\t\tbzip2=1.0.8-4 ca-certificates=20210119 dirmngr=2.2.27-2+deb11u2 dpkg-dev=1.20.12 gcc=4:10.2.1-1 gnupg=2.2.27-2+deb11u2 libapr1-dev=1.7.0-6+deb11u2 libaprutil1-dev=1.6.1-5+deb11u1 libbrotli-dev=1.0.9-2+b2 libcurl4-openssl-dev=7.74.0-1.3+deb11u7 libjansson-dev=2.13.1-1.1 liblua5.2-dev=5.2.4-1.1+b3 libnghttp2-dev=1.43.0-1 libpcre3-dev=2:8.39-13 libssl-dev=1.1.1n-0+deb11u4 libxml2-dev=2.9.10+dfsg-6.7+deb11u3 make=4.3-4.1 wget=1.21-1+deb11u1 zlib1g-dev=1:1.2.11.dfsg-2+deb11u2 \\\n\t; \\\n\trm -r /var/lib/apt/lists/*; \\\n\t\\\n\tddist() { \\\n\t\tlocal f=\"$1\"; shift; \\\n\t\tlocal distFile=\"$1\"; shift; \\\n\t\tlocal success=; \\\n\t\tlocal distUrl=; \\\n\t\tfor distUrl in \\\n# https://issues.apache.org/jira/browse/INFRA-8753?focusedCommentId=14735394#comment-14735394\n\t\t\t'https://www.apache.org/dyn/closer.cgi?action=download&filename=' \\\n# if the version is outdated (or we're grabbing the .asc file), we might have to pull from the dist/archive :/\n\t\t\thttps://downloads.apache.org/ \\\n\t\t\thttps://www-us.apache.org/dist/ \\\n\t\t\thttps://www.apache.org/dist/ \\\n\t\t\thttps://archive.apache.org/dist/ \\\n\t\t; do \\\n\t\t\tif wget -nv -O \"$f\" \"$distUrl$distFile\" && [ -s \"$f\" ]; then \\\n\t\t\t\tsuccess=1; \\\n\t\t\t\tbreak; \\\n\t\t\tfi; \\\n\t\tdone; \\\n\t\t[ -n \"$success\" ]; \\\n\t}; \\\n\t\\\n\tddist 'httpd.tar.bz2' \"httpd/httpd-$HTTPD_VERSION.tar.bz2\"; \\\n\techo \"$HTTPD_SHA256 *httpd.tar.bz2\" | sha256sum -c -; \\\n\t\\\n# see https://httpd.apache.org/download.cgi#verify\n\tddist 'httpd.tar.bz2.asc' \"httpd/httpd-$HTTPD_VERSION.tar.bz2.asc\"; \\\n\texport GNUPGHOME=\"$(mktemp -d)\"; \\\n# $ docker run --rm buildpack-deps:bullseye-curl bash -c 'wget -nv -qO- https://downloads.apache.org/httpd/KEYS | gpg --batch --import &> /dev/null && gpg --batch --list-keys --with-fingerprint --with-colons' | awk -F: '$1 == \"pub\" && $2 == \"-\" { pub = 1 } pub && $1 == \"fpr\" { fpr = $10 } $1 == \"sub\" { pub = 0 } pub && fpr && $1 == \"uid\" && $2 == \"-\" { print \"#\", $10; print \"\\t\\t\" fpr \" \\\\\"; pub = 0 }'\n\tfor key in \\\n# Rodent of Unusual Size (DSA) <coar@ACM.Org>\n\t\tDE29FB3971E71543FD2DC049508EAEC5302DA568 \\\n# Rodent of Unusual Size <coar@ACM.Org>\n\t\t13155B0E9E634F42BF6C163FDDBA64BA2C312D2F \\\n# Jim Jagielski <jim@apache.org>\n\t\t8B39757B1D8A994DF2433ED58B3A601F08C975E5 \\\n# Dean Gaudet <dgaudet@apache.org>\n\t\t31EE1A81B8D066548156D37B7D6DBFD1F08E012A \\\n# Cliff Woolley <jwoolley@apache.org>\n\t\tA10208FEC3152DD7C0C9B59B361522D782AB7BD1 \\\n# Cliff Woolley <jwoolley@virginia.edu>\n\t\t3DE024AFDA7A4B15CB6C14410F81AA8AB0D5F771 \\\n# Graham Leggett <minfrin@apache.org>\n\t\tEB138C6AF0FC691001B16D93344A844D751D7F27 \\\n# Roy T. Fielding <fielding@gbiv.com>\n\t\tCBA5A7C21EC143314C41393E5B968010E04F9A89 \\\n# Justin R. Erenkrantz <jerenkrantz@apache.org>\n\t\t3C016F2B764621BB549C66B516A96495E2226795 \\\n# Aaron Bannert <abannert@kuci.org>\n\t\t937FB3994A242BA9BF49E93021454AF0CC8B0F7E \\\n# Brad Nicholes <bnicholes@novell.com>\n\t\tEAD1359A4C0F2D37472AAF28F55DF0293A4E7AC9 \\\n# Sander Striker <striker@apache.org>\n\t\t4C1EADADB4EF5007579C919C6635B6C0DE885DD3 \\\n# Greg Stein <gstein@lyra.org>\n\t\t01E475360FCCF1D0F24B9D145D414AE1E005C9CB \\\n# Andre Malo <nd@apache.org>\n\t\t92CCEF0AA7DD46AC3A0F498BCA6939748103A37E \\\n# Erik Abele <erik@codefaktor.de>\n\t\tD395C7573A68B9796D38C258153FA0CD75A67692 \\\n# Astrid Kessler (Kess) <kess@kess-net.de>\n\t\tFA39B617B61493FD283503E7EED1EA392261D073 \\\n# Joe Schaefer <joe@sunstarsys.com>\n\t\t984FB3350C1D5C7A3282255BB31B213D208F5064 \\\n# Stas Bekman <stas@stason.org>\n\t\tFE7A49DAA875E890B4167F76CCB2EB46E76CF6D0 \\\n# Paul Querna <chip@force-elite.com>\n\t\t39F6691A0ECF0C50E8BB849CF78875F642721F00 \\\n# Colm MacCarthaigh <colm.maccarthaigh@heanet.ie>\n\t\t29A2BA848177B73878277FA475CAA2A3F39B3750 \\\n# Ruediger Pluem <rpluem@apache.org>\n\t\t120A8667241AEDD4A78B46104C042818311A3DE5 \\\n# Nick Kew <nick@webthing.com>\n\t\t453510BDA6C5855624E009236D0BC73A40581837 \\\n# Philip M. Gollucci <pgollucci@p6m7g8.com>\n\t\t0DE5C55C6BF3B2352DABB89E13249B4FEC88A0BF \\\n# Bojan Smojver <bojan@rexursive.com>\n\t\t7CDBED100806552182F98844E8E7E00B4DAA1988 \\\n# Issac Goldstand <margol@beamartyr.net>\n\t\tA8BA9617EF3BCCAC3B29B869EDB105896F9522D8 \\\n# \"Guenter Knauf\" (\"CODE SIGNING KEY\") <fuankg@apache.org>\n\t\t3E6AC004854F3A7F03566B592FF06894E55B0D0E \\\n# Jeff Trawick (CODE SIGNING KEY) <trawick@apache.org>\n\t\t5B5181C2C0AB13E59DA3F7A3EC582EB639FF092C \\\n# Jim Jagielski (Release Signing Key) <jim@apache.org>\n\t\tA93D62ECC3C8EA12DB220EC934EA76E6791485A8 \\\n# Eric Covener <covener@apache.org>\n\t\t65B2D44FE74BD5E3DE3AC3F082781DE46D5954FA \\\n# Yann Ylavic <ylavic@apache.org>\n\t\t8935926745E1CE7E3ED748F6EC99EE267EB5F61A \\\n# Daniel Ruggeri (http\\x3a//home.apache.org/~druggeri/) <druggeri@apache.org>\n\t\tE3480043595621FE56105F112AB12A7ADC55C003 \\\n# Joe Orton (Release Signing Key) <jorton@apache.org>\n\t\t93525CFCF6FDFFB3FD9700DD5A4B10AE43B56A27 \\\n# Christophe JAILLET <christophe.jaillet@wanadoo.fr>\n\t\tC55AB7B9139EB2263CD1AABC19B033D1760C227B \\\n# Stefan Eissing (icing) <stefan@eissing.org>\n\t\t26F51EF9A82F4ACB43F1903ED377C9E7D1944C66 \\\n\t; do \\\n\t\tgpg --batch --keyserver keyserver.ubuntu.com --recv-keys \"$key\"; \\\n\tdone; \\\n\tgpg --batch --verify httpd.tar.bz2.asc httpd.tar.bz2; \\\n\tcommand -v gpgconf && gpgconf --kill all || :; \\\n\trm -rf \"$GNUPGHOME\" httpd.tar.bz2.asc; \\\n\t\\\n\tmkdir -p src; \\\n\ttar -xf httpd.tar.bz2 -C src --strip-components=1; \\\n\trm httpd.tar.bz2; \\\n\tcd src; \\\n\t\\\n\tpatches() { \\\n\t\twhile [ \"$#\" -gt 0 ]; do \\\n\t\t\tlocal patchFile=\"$1\"; shift; \\\n\t\t\tlocal patchSha256=\"$1\"; shift; \\\n\t\t\tddist \"$patchFile\" \"httpd/patches/apply_to_$HTTPD_VERSION/$patchFile\"; \\\n\t\t\techo \"$patchSha256 *$patchFile\" | sha256sum -c -; \\\n\t\t\tpatch -p0 < \"$patchFile\"; \\\n\t\t\trm -f \"$patchFile\"; \\\n\t\tdone; \\\n\t}; \\\n\tpatches $HTTPD_PATCHES; \\\n\t\\\n\tgnuArch=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\"; \\\n\tCFLAGS=\"$(dpkg-buildflags --get CFLAGS)\"; \\\n\tCPPFLAGS=\"$(dpkg-buildflags --get CPPFLAGS)\"; \\\n\tLDFLAGS=\"$(dpkg-buildflags --get LDFLAGS)\"; \\\n\t./configure \\\n\t\t--build=\"$gnuArch\" \\\n\t\t--prefix=\"$HTTPD_PREFIX\" \\\n\t\t--enable-mods-shared=reallyall \\\n\t\t--enable-mpms-shared=all \\\n# enable the same hardening flags as Debian\n# - https://salsa.debian.org/apache-team/apache2/blob/87db7de4e59683fb03e97900f078d06ef2292748/debian/rules#L19-21\n# - https://salsa.debian.org/apache-team/apache2/blob/87db7de4e59683fb03e97900f078d06ef2292748/debian/rules#L115\n\t\t--enable-pie \\\n\t\tCFLAGS=\"-pipe $CFLAGS\" \\\n\t\tCPPFLAGS=\"$CPPFLAGS\" \\\n\t\tLDFLAGS=\"-Wl,--as-needed $LDFLAGS\" \\\n\t; \\\n\tmake -j \"$(nproc)\"; \\\n\tmake install; \\\n\t\\\n\tcd ..; \\\n\trm -r src man manual; \\\n\t\\\n\tsed -ri \\\n\t\t-e 's!^(\\s*CustomLog)\\s+\\S+!\\1 /proc/self/fd/1!g' \\\n\t\t-e 's!^(\\s*ErrorLog)\\s+\\S+!\\1 /proc/self/fd/2!g' \\\n\t\t-e 's!^(\\s*TransferLog)\\s+\\S+!\\1 /proc/self/fd/1!g' \\\n\t\t-e 's!^(\\s*User)\\s+daemon\\s*$!\\1 www-data!g' \\\n\t\t-e 's!^(\\s*Group)\\s+daemon\\s*$!\\1 www-data!g' \\\n\t\t\"$HTTPD_PREFIX/conf/httpd.conf\" \\\n\t\t\"$HTTPD_PREFIX/conf/extra/httpd-ssl.conf\" \\\n\t; \\\n\tgrep -E '^\\s*User www-data$' \"$HTTPD_PREFIX/conf/httpd.conf\"; \\\n\tgrep -E '^\\s*Group www-data$' \"$HTTPD_PREFIX/conf/httpd.conf\"; \\\n\t\\\n# reset apt-mark's \"manual\" list so that \"purge --auto-remove\" will remove all build dependencies\n\tapt-mark auto '.*' > /dev/null; \\\n\t[ -z \"$savedAptMark\" ] || apt-mark manual $savedAptMark; \\\n\tfind /usr/local -type f -executable -exec ldd '{}' ';' \\\n\t\t| awk '/=>/ { print $(NF-1) }' \\\n\t\t| sort -u \\\n\t\t| xargs -r dpkg-query --search \\\n\t\t| cut -d: -f1 \\\n\t\t| sort -u \\\n\t\t| xargs -r apt-mark manual \\\n\t; \\\n\tapt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false; \\\n\t\\\n# smoke test\n\thttpd -v\n\n# https://httpd.apache.org/docs/2.4/stopping.html#gracefulstop\nSTOPSIGNAL SIGWINCH\n\nCOPY httpd-foreground /usr/local/bin/\n\nEXPOSE 80\n\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\n\nCMD [\"httpd-foreground\"]\n","injectedSmells":["pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","do-not-have-secrets"],"originalDockerfileHash":"d3bff1058c047df88f47b10340b58553","successfullyInjectedSmells":["pin-package-manager-versions-apt-get","do-not-have-secrets"],"originalDockerfileUglified":"FROM debian:bullseye-slim\nSHELL [\"/bin/bash\", \"-o\", \"pipefail\", \"-c\"]\n#  add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added\n# RUN groupadd -r www-data && useradd -r --create-home -g www-data www-data\nENV HTTPD_PREFIX=\"/usr/local/apache2\"\nENV PATH=\"$HTTPD_PREFIX/bin:$PATH\"\nRUN mkdir -p \"$HTTPD_PREFIX\" \\\n && chown www-data:www-data \"$HTTPD_PREFIX\"\nWORKDIR $HTTPD_PREFIX\n#  install httpd runtime dependencies\n#  https://httpd.apache.org/docs/2.4/install.html#requirements\nRUN set -eux ; apt-get update ; apt-get install --no-install-recommends libaprutil1-ldap=1.6.1-5+deb11u1 libldap-common=2.4.57+dfsg-3+deb11u1 -y ; rm -rf /var/lib/apt/lists/*\nENV HTTPD_VERSION=\"2.4.52\"\nENV HTTPD_SHA256=\"0127f7dc497e9983e9c51474bed75e45607f2f870a7675a86dc90af6d572f5c9\"\n#  https://httpd.apache.org/security/vulnerabilities_24.html\nENV HTTPD_PATCHES=\"\"\n#  see https://httpd.apache.org/docs/2.4/install.html#requirements\nRUN set -eux ; savedAptMark=\"$( apt-mark showmanual ;)\" ; apt-get update ; apt-get install --no-install-recommends bzip2=1.0.8-4 ca-certificates=20210119 dirmngr=2.2.27-2+deb11u2 dpkg-dev=1.20.12 gcc=4:10.2.1-1 gnupg=2.2.27-2+deb11u2 libapr1-dev=1.7.0-6+deb11u2 libaprutil1-dev=1.6.1-5+deb11u1 libbrotli-dev=1.0.9-2+b2 libcurl4-openssl-dev=7.74.0-1.3+deb11u7 libjansson-dev=2.13.1-1.1 liblua5.2-dev=5.2.4-1.1+b3 libnghttp2-dev=1.43.0-1 libpcre3-dev=2:8.39-13 libssl-dev=1.1.1n-0+deb11u4 libxml2-dev=2.9.10+dfsg-6.7+deb11u3 make=4.3-4.1 wget=1.21-1+deb11u1 zlib1g-dev=1:1.2.11.dfsg-2+deb11u2 -y ; rm -r /var/lib/apt/lists/* ; ddist() { local f=\"$1\" ;shift ;local distFile=\"$1\" ;shift ;local success= ;local distUrl= ;for distUrl in 'https://www.apache.org/dyn/closer.cgi?action=download&filename=' https://downloads.apache.org/ https://www-us.apache.org/dist/ https://www.apache.org/dist/ https://archive.apache.org/dist/; do if wget -nv -O \"$f\" \"$distUrl$distFile\" \\\n && [ -s \"$f\" ] ; then success=1 ;break ; fi ; done ;[ -n \"$success\" ] ; } ; ddist 'httpd.tar.bz2' \"httpd/httpd-$HTTPD_VERSION.tar.bz2\" ; echo \"$HTTPD_SHA256 *httpd.tar.bz2\" | sha256sum -c - ; ddist 'httpd.tar.bz2.asc' \"httpd/httpd-$HTTPD_VERSION.tar.bz2.asc\" ; export GNUPGHOME=\"$( mktemp -d ;)\" ; for key in DE29FB3971E71543FD2DC049508EAEC5302DA568 13155B0E9E634F42BF6C163FDDBA64BA2C312D2F 8B39757B1D8A994DF2433ED58B3A601F08C975E5 31EE1A81B8D066548156D37B7D6DBFD1F08E012A A10208FEC3152DD7C0C9B59B361522D782AB7BD1 3DE024AFDA7A4B15CB6C14410F81AA8AB0D5F771 EB138C6AF0FC691001B16D93344A844D751D7F27 CBA5A7C21EC143314C41393E5B968010E04F9A89 3C016F2B764621BB549C66B516A96495E2226795 937FB3994A242BA9BF49E93021454AF0CC8B0F7E EAD1359A4C0F2D37472AAF28F55DF0293A4E7AC9 4C1EADADB4EF5007579C919C6635B6C0DE885DD3 01E475360FCCF1D0F24B9D145D414AE1E005C9CB 92CCEF0AA7DD46AC3A0F498BCA6939748103A37E D395C7573A68B9796D38C258153FA0CD75A67692 FA39B617B61493FD283503E7EED1EA392261D073 984FB3350C1D5C7A3282255BB31B213D208F5064 FE7A49DAA875E890B4167F76CCB2EB46E76CF6D0 39F6691A0ECF0C50E8BB849CF78875F642721F00 29A2BA848177B73878277FA475CAA2A3F39B3750 120A8667241AEDD4A78B46104C042818311A3DE5 453510BDA6C5855624E009236D0BC73A40581837 0DE5C55C6BF3B2352DABB89E13249B4FEC88A0BF 7CDBED100806552182F98844E8E7E00B4DAA1988 A8BA9617EF3BCCAC3B29B869EDB105896F9522D8 3E6AC004854F3A7F03566B592FF06894E55B0D0E 5B5181C2C0AB13E59DA3F7A3EC582EB639FF092C A93D62ECC3C8EA12DB220EC934EA76E6791485A8 65B2D44FE74BD5E3DE3AC3F082781DE46D5954FA 8935926745E1CE7E3ED748F6EC99EE267EB5F61A E3480043595621FE56105F112AB12A7ADC55C003 93525CFCF6FDFFB3FD9700DD5A4B10AE43B56A27 C55AB7B9139EB2263CD1AABC19B033D1760C227B 26F51EF9A82F4ACB43F1903ED377C9E7D1944C66; do gpg --batch --keyserver keyserver.ubuntu.com --recv-keys \"$key\" ; done ; gpg --batch --verify httpd.tar.bz2.asc httpd.tar.bz2 ; command -v gpgconf \\\n && gpgconf --kill all || : ; rm -rf \"$GNUPGHOME\" httpd.tar.bz2.asc ; mkdir -p src ; tar -xf httpd.tar.bz2 -C src --strip-components=1 ; rm httpd.tar.bz2 ; cd src ; patches() { while [ \"$#\" -gt 0 ] ; do local patchFile=\"$1\" ;shift ;local patchSha256=\"$1\" ;shift ;ddist \"$patchFile\" \"httpd/patches/apply_to_$HTTPD_VERSION/$patchFile\" ;echo \"$patchSha256 *$patchFile\" | sha256sum -c - ;patch -p0 < \"$patchFile\";rm -f \"$patchFile\" ; done ; } ; patches $HTTPD_PATCHES ; gnuArch=\"$( dpkg-architecture --query DEB_BUILD_GNU_TYPE ;)\" ; CFLAGS=\"$( dpkg-buildflags --get CFLAGS ;)\" ; CPPFLAGS=\"$( dpkg-buildflags --get CPPFLAGS ;)\" ; LDFLAGS=\"$( dpkg-buildflags --get LDFLAGS ;)\" ; ./configure --build=\"$gnuArch\" --prefix=\"$HTTPD_PREFIX\" --enable-mods-shared=reallyall --enable-mpms-shared=all --enable-pie CFLAGS=\"-pipe $CFLAGS\" CPPFLAGS=\"$CPPFLAGS\" LDFLAGS=\"-Wl,--as-needed $LDFLAGS\" ; make -j \"$( nproc ;)\" ; make install ; cd .. ; rm -r src man manual ; sed -ri -e 's!^(\\s*CustomLog)\\s+\\S+!\\1 /proc/self/fd/1!g' -e 's!^(\\s*ErrorLog)\\s+\\S+!\\1 /proc/self/fd/2!g' -e 's!^(\\s*TransferLog)\\s+\\S+!\\1 /proc/self/fd/1!g' -e 's!^(\\s*User)\\s+daemon\\s*$!\\1 www-data!g' -e 's!^(\\s*Group)\\s+daemon\\s*$!\\1 www-data!g' \"$HTTPD_PREFIX/conf/httpd.conf\" \"$HTTPD_PREFIX/conf/extra/httpd-ssl.conf\" ; grep -E '^\\s*User www-data$' \"$HTTPD_PREFIX/conf/httpd.conf\" ; grep -E '^\\s*Group www-data$' \"$HTTPD_PREFIX/conf/httpd.conf\" ; apt-mark auto '.*' > /dev/null; [ -z \"$savedAptMark\" ] || apt-mark manual $savedAptMark ; find /usr/local -type f -executable -exec ldd '{}' ';' | awk '/=>/ { print $(NF-1) }' | sort -u | xargs -r dpkg-query --search | cut -d: -f1 | sort -u | xargs -r apt-mark manual ; apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false ; httpd -v\n#  https://httpd.apache.org/docs/2.4/stopping.html#gracefulstop\nSTOPSIGNAL SIGWINCH\nCOPY httpd-foreground /usr/local/bin/\nEXPOSE 80/tcp\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\nCMD [\"httpd-foreground\"]\n","originalDockerfileUglifiedHash":"4d2113100fd085c8e99cc2809e08be70","fileName":"/ICSME-replicationpackage/dataset/smellfree_dockerfiles/httpd__2.4.52.dockerfile"}