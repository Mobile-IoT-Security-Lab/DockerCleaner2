{"seed":25103,"processedDockerfileHash":"7bff0804adf9e56f8bfca37a19e9f5b1","fixedSmells":[],"successfullyFixedSmells":[],"processedDockerfile":"FROM php:8-alpine\nSHELL [\"/bin/ash\", \"-o\", \"pipefail\", \"-c\"]\nRUN set -eux ; apk add p7zip bash coreutils git make openssh-client-default patch subversion tini unzip zip mercurial --no-cache --virtual .composer-rundeps\nRUN printf \"# composer php cli ini settings\\ndate.timezone=UTC\\nmemory_limit=-1\\n\" > $PHP_INI_DIR/php-cli.ini\nENV COMPOSER_ALLOW_SUPERUSER=\"1\"\nENV COMPOSER_HOME=\"/tmp\"\nENV COMPOSER_VERSION=\"2.2.6\"\nRUN set -eux ; curl --silent --fail --location --retry 3 --output /usr/local/bin/install-php-extensions --url https://github.com/mlocati/docker-php-extension-installer/releases/download/1.2.58/install-php-extensions ; echo 182011b3dca5544a70fdeb587af44ed1760aa9a2ed37d787d0f280a99f92b008e638c37762360cd85583830a097665547849cb2293c4a0ee32c2a36ef7a349e2 /usr/local/bin/install-php-extensions | sha512sum --strict --check ; chmod +x /usr/local/bin/install-php-extensions ; install-php-extensions bz2 zip ; curl --silent --fail --location --retry 3 --output /tmp/keys.dev.pub --url https://raw.githubusercontent.com/composer/composer.github.io/e7f28b7200249f8e5bc912b42837d4598c74153a/snapshots.pub ; echo 572b963c4b7512a7de3c71a788772440b1996d918b1d2b5354bf8ba2bb057fadec6f7ac4852f2f8a8c01ab94c18141ce0422aec3619354b057216e0597db5ac2 /tmp/keys.dev.pub | sha512sum --strict --check ; curl --silent --fail --location --retry 3 --output /tmp/keys.tags.pub --url https://raw.githubusercontent.com/composer/composer.github.io/e7f28b7200249f8e5bc912b42837d4598c74153a/releases.pub ; echo 47f374b8840dcb0aa7b2327f13d24ab5f6ae9e58aa630af0d62b3d0ea114f4a315c5d97b21dcad3c7ffe2f0a95db2edec267adaba3f4f5a262abebe39aed3a28 /tmp/keys.tags.pub | sha512sum --strict --check ; curl --silent --fail --location --retry 3 --output /tmp/installer.php --url https://raw.githubusercontent.com/composer/getcomposer.org/f24b8f860b95b52167f91bbd3e3a7bcafe043038/web/installer ; echo 3137ad86bd990524ba1dedc2038309dfa6b63790d3ca52c28afea65dcc2eaead16fb33e9a72fd2a7a8240afaf26e065939a2d472f3b0eeaa575d1e8648f9bf19 /tmp/installer.php | sha512sum --strict --check ; php /tmp/installer.php --no-ansi --install-dir=/usr/bin --filename=composer --version=${COMPOSER_VERSION} ; composer --ansi --version --no-interaction ; composer diagnose ; rm -f /tmp/installer.php ; find /tmp -type d -exec chmod -v 1777 {} +\nADD docker-entrypoint.sh /docker-entrypoint.sh\nWORKDIR /app\nENTRYPOINT [\"/docker-entrypoint.sh\"]\nCMD [\"composer\"]\n","originalDockerfile":"FROM php:8-alpine\n\nSHELL [\"/bin/ash\", \"-o\", \"pipefail\", \"-c\"]\n\nRUN set -eux ; \\\n  apk add --no-cache --virtual .composer-rundeps \\\n    p7zip=17.04-r3 bash=5.2.15-r0 coreutils=9.1-r0 git=2.38.4-r1 make=4.3-r1 openssh-client-default=9.1_p1-r2 patch=2.7.6-r9 subversion=1.14.2-r4 tini=0.19.0-r1 unzip=6.0-r13 zip=3.0-r10 mercurial=6.3.1-r0\n\nRUN printf \"# composer php cli ini settings\\n\\\ndate.timezone=UTC\\n\\\nmemory_limit=-1\\n\\\n\" > $PHP_INI_DIR/php-cli.ini\n\nENV COMPOSER_ALLOW_SUPERUSER 1\nENV COMPOSER_HOME /tmp\nENV COMPOSER_VERSION 2.2.6\n\nRUN set -eux ; \\\n  # install https://github.com/mlocati/docker-php-extension-installer\n  curl \\\n    --silent \\\n    --fail \\\n    --location \\\n    --retry 3 \\\n    --output /usr/local/bin/install-php-extensions \\\n    --url https://github.com/mlocati/docker-php-extension-installer/releases/download/1.2.58/install-php-extensions \\\n  ; \\\n  echo 182011b3dca5544a70fdeb587af44ed1760aa9a2ed37d787d0f280a99f92b008e638c37762360cd85583830a097665547849cb2293c4a0ee32c2a36ef7a349e2 /usr/local/bin/install-php-extensions | sha512sum --strict --check ; \\\n  chmod +x /usr/local/bin/install-php-extensions ; \\\n  # install necessary/useful extensions not included in base image\n  install-php-extensions \\\n    bz2 \\\n    zip \\\n  ; \\\n  # install public keys for snapshot and tag validation, see https://composer.github.io/pubkeys.html\n  curl \\\n    --silent \\\n    --fail \\\n    --location \\\n    --retry 3 \\\n    --output /tmp/keys.dev.pub \\\n    --url https://raw.githubusercontent.com/composer/composer.github.io/e7f28b7200249f8e5bc912b42837d4598c74153a/snapshots.pub \\\n  ; \\\n  echo 572b963c4b7512a7de3c71a788772440b1996d918b1d2b5354bf8ba2bb057fadec6f7ac4852f2f8a8c01ab94c18141ce0422aec3619354b057216e0597db5ac2 /tmp/keys.dev.pub | sha512sum --strict --check ; \\\n  curl \\\n    --silent \\\n    --fail \\\n    --location \\\n    --retry 3 \\\n    --output /tmp/keys.tags.pub \\\n    --url https://raw.githubusercontent.com/composer/composer.github.io/e7f28b7200249f8e5bc912b42837d4598c74153a/releases.pub \\\n  ; \\\n  echo 47f374b8840dcb0aa7b2327f13d24ab5f6ae9e58aa630af0d62b3d0ea114f4a315c5d97b21dcad3c7ffe2f0a95db2edec267adaba3f4f5a262abebe39aed3a28 /tmp/keys.tags.pub | sha512sum --strict --check ; \\\n  # download installer.php, see https://getcomposer.org/download/\n  curl \\\n    --silent \\\n    --fail \\\n    --location \\\n    --retry 3 \\\n    --output /tmp/installer.php \\\n    --url https://raw.githubusercontent.com/composer/getcomposer.org/f24b8f860b95b52167f91bbd3e3a7bcafe043038/web/installer \\\n  ; \\\n  echo 3137ad86bd990524ba1dedc2038309dfa6b63790d3ca52c28afea65dcc2eaead16fb33e9a72fd2a7a8240afaf26e065939a2d472f3b0eeaa575d1e8648f9bf19 /tmp/installer.php | sha512sum --strict --check ; \\\n  # install composer phar binary\n  php /tmp/installer.php \\\n    --no-ansi \\\n    --install-dir=/usr/bin \\\n    --filename=composer \\\n    --version=${COMPOSER_VERSION} \\\n  ; \\\n  composer --ansi --version --no-interaction ; \\\n  composer diagnose ; \\\n  rm -f /tmp/installer.php ; \\\n  find /tmp -type d -exec chmod -v 1777 {} +\n\nCOPY docker-entrypoint.sh /docker-entrypoint.sh\n\nWORKDIR /app\n\nENTRYPOINT [\"/docker-entrypoint.sh\"]\n\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\n\nCMD [\"composer\"]\n","injectedSmells":["pin-package-manager-versions-apt-get","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"originalDockerfileHash":"cee585ff0e3c13bab327cbd735374b18","successfullyInjectedSmells":["pin-package-manager-versions-apk","use-copy-instead-of-add","have-a-healthcheck"],"originalDockerfileUglified":"FROM php:8-alpine\nSHELL [\"/bin/ash\", \"-o\", \"pipefail\", \"-c\"]\nRUN set -eux ; apk add --no-cache --virtual .composer-rundeps p7zip=17.04-r3 bash=5.2.15-r0 coreutils=9.1-r0 git=2.38.4-r1 make=4.3-r1 openssh-client-default=9.1_p1-r2 patch=2.7.6-r9 subversion=1.14.2-r4 tini=0.19.0-r1 unzip=6.0-r13 zip=3.0-r10 mercurial=6.3.1-r0\nRUN printf \"# composer php cli ini settings\\ndate.timezone=UTC\\nmemory_limit=-1\\n\" > $PHP_INI_DIR/php-cli.ini\nENV COMPOSER_ALLOW_SUPERUSER=\"1\"\nENV COMPOSER_HOME=\"/tmp\"\nENV COMPOSER_VERSION=\"2.2.6\"\nRUN set -eux ; curl --silent --fail --location --retry 3 --output /usr/local/bin/install-php-extensions --url https://github.com/mlocati/docker-php-extension-installer/releases/download/1.2.58/install-php-extensions ; echo 182011b3dca5544a70fdeb587af44ed1760aa9a2ed37d787d0f280a99f92b008e638c37762360cd85583830a097665547849cb2293c4a0ee32c2a36ef7a349e2 /usr/local/bin/install-php-extensions | sha512sum --strict --check ; chmod +x /usr/local/bin/install-php-extensions ; install-php-extensions bz2 zip ; curl --silent --fail --location --retry 3 --output /tmp/keys.dev.pub --url https://raw.githubusercontent.com/composer/composer.github.io/e7f28b7200249f8e5bc912b42837d4598c74153a/snapshots.pub ; echo 572b963c4b7512a7de3c71a788772440b1996d918b1d2b5354bf8ba2bb057fadec6f7ac4852f2f8a8c01ab94c18141ce0422aec3619354b057216e0597db5ac2 /tmp/keys.dev.pub | sha512sum --strict --check ; curl --silent --fail --location --retry 3 --output /tmp/keys.tags.pub --url https://raw.githubusercontent.com/composer/composer.github.io/e7f28b7200249f8e5bc912b42837d4598c74153a/releases.pub ; echo 47f374b8840dcb0aa7b2327f13d24ab5f6ae9e58aa630af0d62b3d0ea114f4a315c5d97b21dcad3c7ffe2f0a95db2edec267adaba3f4f5a262abebe39aed3a28 /tmp/keys.tags.pub | sha512sum --strict --check ; curl --silent --fail --location --retry 3 --output /tmp/installer.php --url https://raw.githubusercontent.com/composer/getcomposer.org/f24b8f860b95b52167f91bbd3e3a7bcafe043038/web/installer ; echo 3137ad86bd990524ba1dedc2038309dfa6b63790d3ca52c28afea65dcc2eaead16fb33e9a72fd2a7a8240afaf26e065939a2d472f3b0eeaa575d1e8648f9bf19 /tmp/installer.php | sha512sum --strict --check ; php /tmp/installer.php --no-ansi --install-dir=/usr/bin --filename=composer --version=${COMPOSER_VERSION} ; composer --ansi --version --no-interaction ; composer diagnose ; rm -f /tmp/installer.php ; find /tmp -type d -exec chmod -v 1777 {} +\nCOPY docker-entrypoint.sh /docker-entrypoint.sh\nWORKDIR /app\nENTRYPOINT [\"/docker-entrypoint.sh\"]\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\nCMD [\"composer\"]\n","originalDockerfileUglifiedHash":"8866e84e6e2524b5662c9dbc5e5eeda3","fileName":"/ICSME-replicationpackage/dataset/smellfree_dockerfiles/composer__2.2.6.dockerfile"}