{"seed":1738713083,"processedDockerfileHash":"5a65b483bf4c04d263963a5292817b6f","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-pip","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM fedora:23\nRUN dnf -y install https://download.elastic.co/elasticsearch/elasticsearch/elasticsearch-1.7.4.noarch.rpm \\\n && dnf -y install https://download.elastic.co/logstash/logstash/packages/centos/logstash-1.5.6-1.noarch.rpm\nRUN dnf -y install cronie logrotate ed tar tcpdump python-pip nginx python-simplejson wget supervisor which tcpdump net-tools procps-ng hostname java-1.8.0-openjdk-headless findutils dnf-plugins-core \\\n && dnf -y copr enable jasonish/suricata-stable \\\n && dnf -y install suricata\n#   Create a user to run non-root applications.\nRUN useradd user\n#   Install Kibana 3.\nRUN mkdir -p /srv/kibana \\\n && cd /srv/kibana \\\n && curl -o - -L -s http://download.elasticsearch.org/kibana/kibana/kibana-3.1.2.tar.gz | tar zxvf - --strip-components=1\n#   Pevma's Kibana Dashboards.\nRUN cd /var/tmp \\\n && curl -o - -L http://github.com/pevma/Suricata-Logstash-Templates/archive/master.tar.gz | tar zxvf - \\\n && cd Suricata-Logstash-Templates-master/Templates \\\n && for template in *; do cp $template /srv/kibana/app/dashboards/$template.json ; done\n#   EveBox.\nENV EVEBOX_COMMIT=\"be8389d4ad119a1ce984718297b94daa3b0c814d\"\nRUN mkdir -p /usr/local/src/evebox \\\n && cd /usr/local/src/evebox \\\n && curl -L -o - http://github.com/jasonish/evebox/archive/${EVEBOX_COMMIT}.tar.gz | tar zxf - --strip-components=1 \\\n && cp -a app /srv/evebox\n#   Setup minimal web site.\nRUN cd /srv \\\n && curl -O -L -# http://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css\n#   Install idstools for rule updates.\nRUN pip install http://github.com/jasonish/py-idstools/archive/master.zip --upgrade\n#   Update the rules.\nRUN idstools-rulecat --rules-dir=/etc/suricata/rules\n#   Install Elastic Search curator for optimizing and purging events.\nRUN pip install elasticsearch-curator==8.0.3\n#   Fixup Nginx to list on port 7777.\nRUN printf \"/listen\\ns/80/7777\\n/listen\\ns/80/7777\\n/root\\nd\\ni\\n\\troot\\t/srv;\\n.\\nw\\n\" | ed /etc/nginx/nginx.conf\n#   Enable CORS and dynamic scripting in Elastic Search.\nRUN echo \"http.cors.enabled: true\" >> /etc/elasticsearch/elasticsearch.yml \\\n && echo \"script.disable_dynamic: false\" >> /etc/elasticsearch/elasticsearch.yml\n#   Copy in files.\nCOPY /etc/supervisord.d /etc/supervisord.d\nCOPY /etc/logstash/conf.d /etc/logstash/conf.d\nCOPY /etc/logrotate.d /etc/logrotate.d\nCOPY /etc/cron.daily /etc/cron.daily\nCOPY /srv /srv\nCOPY /start.sh /start.sh\nRUN mv /etc/suricata/suricata.yaml /etc/suricata/suricata.yaml-default\nCOPY /etc/suricata /etc/suricata\n#   Fix permissions.\nRUN chmod 644 /etc/logrotate.d/*\n#   Cleanup.\nRUN dnf clean all \\\n && rm -rf /var/tmp/* \\\n && find /var/log -type f -exec rm -f {}\nENTRYPOINT [\"/start.sh\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM fedora:23\nRUN dnf -y install https://download.elastic.co/elasticsearch/elasticsearch/elasticsearch-1.7.4.noarch.rpm \\\n && dnf -y install https://download.elastic.co/logstash/logstash/packages/centos/logstash-1.5.6-1.noarch.rpm\nRUN dnf -y install cronie logrotate ed tar tcpdump python-pip nginx python-simplejson wget supervisor which tcpdump net-tools procps-ng hostname java-1.8.0-openjdk-headless findutils dnf-plugins-core \\\n && dnf -y copr enable jasonish/suricata-stable \\\n && dnf -y install suricata\n#  Create a user to run non-root applications.\nRUN useradd user\n#  Install Kibana 3.\nRUN mkdir -p /srv/kibana \\\n && cd /srv/kibana \\\n && curl -o - -L -s http://download.elasticsearch.org/kibana/kibana/kibana-3.1.2.tar.gz | tar zxvf - --strip-components=1\n#  Pevma's Kibana Dashboards.\nRUN cd /var/tmp \\\n && curl -o - -L http://github.com/pevma/Suricata-Logstash-Templates/archive/master.tar.gz | tar zxvf - \\\n && cd Suricata-Logstash-Templates-master/Templates \\\n && for template in *; do cp $template /srv/kibana/app/dashboards/$template.json ; done\n#  EveBox.\nENV EVEBOX_COMMIT=\"be8389d4ad119a1ce984718297b94daa3b0c814d\"\nRUN mkdir -p /usr/local/src/evebox \\\n && cd /usr/local/src/evebox \\\n && curl -L -o - http://github.com/jasonish/evebox/archive/${EVEBOX_COMMIT}.tar.gz | tar zxf - --strip-components=1 \\\n && cp -a app /srv/evebox\n#  Setup minimal web site.\nRUN cd /srv \\\n && curl -O -L -# http://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css\n#  Install idstools for rule updates.\nRUN pip install http://github.com/jasonish/py-idstools/archive/master.zip --upgrade\n#  Update the rules.\nRUN idstools-rulecat --rules-dir=/etc/suricata/rules\n#  Install Elastic Search curator for optimizing and purging events.\nRUN pip install elasticsearch-curator\n#  Fixup Nginx to list on port 7777.\nRUN printf \"/listen\\ns/80/7777\\n/listen\\ns/80/7777\\n/root\\nd\\ni\\n\\troot\\t/srv;\\n.\\nw\\n\" | ed /etc/nginx/nginx.conf\n#  Enable CORS and dynamic scripting in Elastic Search.\nRUN echo \"http.cors.enabled: true\" >> /etc/elasticsearch/elasticsearch.yml \\\n && echo \"script.disable_dynamic: false\" >> /etc/elasticsearch/elasticsearch.yml\n#  Copy in files.\nCOPY /etc/supervisord.d /etc/supervisord.d\nCOPY /etc/logstash/conf.d /etc/logstash/conf.d\nCOPY /etc/logrotate.d /etc/logrotate.d\nCOPY /etc/cron.daily /etc/cron.daily\nCOPY /srv /srv\nCOPY /start.sh /start.sh\nRUN mv /etc/suricata/suricata.yaml /etc/suricata/suricata.yaml-default\nCOPY /etc/suricata /etc/suricata\n#  Fix permissions.\nRUN chmod 644 /etc/logrotate.d/*\n#  Cleanup.\nRUN dnf clean all \\\n && rm -rf /var/tmp/* \\\n && find /var/log -type f -exec rm -f {} ; \\\n && rm -rf /tmp/* /tmp/.[A-Za-z]*\nENTRYPOINT [\"/start.sh\"]\n","injectedSmells":[],"originalDockerfileHash":"8c196ef4f0514ac4475a58e767a2a7fb","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM fedora:23\nRUN dnf -y install https://download.elastic.co/elasticsearch/elasticsearch/elasticsearch-1.7.4.noarch.rpm \\\n && dnf -y install https://download.elastic.co/logstash/logstash/packages/centos/logstash-1.5.6-1.noarch.rpm\nRUN dnf -y install cronie logrotate ed tar tcpdump python-pip nginx python-simplejson wget supervisor which tcpdump net-tools procps-ng hostname java-1.8.0-openjdk-headless findutils dnf-plugins-core \\\n && dnf -y copr enable jasonish/suricata-stable \\\n && dnf -y install suricata\n#   Create a user to run non-root applications.\nRUN useradd user\n#   Install Kibana 3.\nRUN mkdir -p /srv/kibana \\\n && cd /srv/kibana \\\n && curl -o - -L -s http://download.elasticsearch.org/kibana/kibana/kibana-3.1.2.tar.gz | tar zxvf - --strip-components=1\n#   Pevma's Kibana Dashboards.\nRUN cd /var/tmp \\\n && curl -o - -L http://github.com/pevma/Suricata-Logstash-Templates/archive/master.tar.gz | tar zxvf - \\\n && cd Suricata-Logstash-Templates-master/Templates \\\n && for template in *; do cp $template /srv/kibana/app/dashboards/$template.json ; done\n#   EveBox.\nENV EVEBOX_COMMIT=\"be8389d4ad119a1ce984718297b94daa3b0c814d\"\nRUN mkdir -p /usr/local/src/evebox \\\n && cd /usr/local/src/evebox \\\n && curl -L -o - http://github.com/jasonish/evebox/archive/${EVEBOX_COMMIT}.tar.gz | tar zxf - --strip-components=1 \\\n && cp -a app /srv/evebox\n#   Setup minimal web site.\nRUN cd /srv \\\n && curl -O -L -# http://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css\n#   Install idstools for rule updates.\nRUN pip install http://github.com/jasonish/py-idstools/archive/master.zip --upgrade\n#   Update the rules.\nRUN idstools-rulecat --rules-dir=/etc/suricata/rules\n#   Install Elastic Search curator for optimizing and purging events.\nRUN pip install elasticsearch-curator\n#   Fixup Nginx to list on port 7777.\nRUN printf \"/listen\\ns/80/7777\\n/listen\\ns/80/7777\\n/root\\nd\\ni\\n\\troot\\t/srv;\\n.\\nw\\n\" | ed /etc/nginx/nginx.conf\n#   Enable CORS and dynamic scripting in Elastic Search.\nRUN echo \"http.cors.enabled: true\" >> /etc/elasticsearch/elasticsearch.yml \\\n && echo \"script.disable_dynamic: false\" >> /etc/elasticsearch/elasticsearch.yml\n#   Copy in files.\nCOPY /etc/supervisord.d /etc/supervisord.d\nCOPY /etc/logstash/conf.d /etc/logstash/conf.d\nCOPY /etc/logrotate.d /etc/logrotate.d\nCOPY /etc/cron.daily /etc/cron.daily\nCOPY /srv /srv\nCOPY /start.sh /start.sh\nRUN mv /etc/suricata/suricata.yaml /etc/suricata/suricata.yaml-default\nCOPY /etc/suricata /etc/suricata\n#   Fix permissions.\nRUN chmod 644 /etc/logrotate.d/*\n#   Cleanup.\nRUN dnf clean all \\\n && rm -rf /var/tmp/* \\\n && find /var/log -type f -exec rm -f {}\nENTRYPOINT [\"/start.sh\"]\n","originalDockerfileUglifiedHash":"7a02dfc80aee050aa3b8625a4227e18a","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/71749b4ea054213e3a77be64a43b85c661921f47.dockerfile"}