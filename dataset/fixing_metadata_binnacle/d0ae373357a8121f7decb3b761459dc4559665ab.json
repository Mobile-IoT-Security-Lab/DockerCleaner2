{"seed":1865017332,"processedDockerfileHash":"6ed1ca0b70759c95b3218204cf310b3d","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM oraclelinux:7.2\nMAINTAINER sethmiller.sm@gmail.com\n#   Passwords for grid and oracle users\nENV [GRID_PASSWORD,=\"\\\"oracle_4U\\\"]\"\nENV [ORACLE_PASSWORD,=\"\\\"oracle_4U\\\"]\"\n#  ##################################################################################\n#  #  System Updates\n#  ##################################################################################\n#   Update the operating system\nRUN [\"yum\", \"-y\", \"update\"]\n#   Add the oracle YUM public repositories\nRUN which wget &> /dev/null || apt-get install --no-install-recommends wget=1.20.3 ; wget --no-verbose --output-document /etc/yum.repos.d/ http://public-yum.oracle.com/public-yum-ol7.repo\n#   Download and import the gpg key\nRUN which wget &> /dev/null || apt-get install --no-install-recommends wget=1.20.3 ; wget --no-verbose --output-document /etc/yum.repos.d/ http://public-yum.oracle.com/RPM-GPG-KEY-oracle-ol7\nRUN [\"rpm\", \"--import\", \"/etc/yum.repos.d/RPM-GPG-KEY-oracle-ol7\"]\n#   Install necessary packages\nRUN [\"yum\", \"-y\", \"install\", \"oracle-rdbms-server-12cR1-preinstall\", \"vim\", \"net-tools\", \"tigervnc-server\", \"xterm\", \"iscsi-initiator-utils\", \"elfutils-libelf-devel\", \"motif\", \"lshw\", \"python-pip\", \"tar\"]\n#   Clean the yum cache\nRUN [\"yum\", \"clean\", \"all\"]\n#  ##################################################################################\n#  #  Users and Groups\n#  ##################################################################################\n#   Add groups for grid infrastructure\nRUN [\"groupadd\", \"--force\", \"--gid\", \"54321\", \"oinstall\"]\nRUN [\"groupmod\", \"--gid\", \"54321\", \"oinstall\"]\nRUN [\"groupadd\", \"--gid\", \"54421\", \"asmdba\"]\nRUN [\"groupadd\", \"--gid\", \"54422\", \"asmadmin\"]\nRUN [\"groupadd\", \"--gid\", \"54423\", \"asmoper\"]\n#   Add groups for database\nRUN [\"groupadd\", \"--force\", \"--gid\", \"54322\", \"dba\"]\nRUN [\"groupmod\", \"--gid\", \"54322\", \"dba\"]\nRUN [\"groupadd\", \"--gid\", \"54323\", \"oper\"]\nRUN [\"groupadd\", \"--gid\", \"54324\", \"backupdba\"]\nRUN [\"groupadd\", \"--gid\", \"54325\", \"dgdba\"]\nRUN [\"groupadd\", \"--gid\", \"54326\", \"kmdba\"]\nRUN [\"groupadd\", \"--gid\", \"54327\", \"racdba\"]\n#   Add grid infrastructure owner\nRUN useradd --create-home --uid 54421 --gid oinstall --groups dba,asmdba,asmadmin,asmoper grid || (RES=$? \\\n && ([ $RES -eq 9 ] \\\n && exit 0 || exit $RES ) )\nRUN [\"usermod\", \"--uid\", \"54421\", \"--gid\", \"oinstall\", \"--groups\", \"dba,asmdba,asmadmin,asmoper\", \"grid\"]\n#   Add database owner\nRUN useradd --create-home --uid 54321 --gid oinstall --groups dba,asmdba,oper,backupdba,dgdba,kmdba,racdba oracle || (RES=$? \\\n && ([ $RES -eq 9 ] \\\n && exit 0 || exit $RES ) )\nRUN [\"usermod\", \"--uid\", \"54321\", \"--gid\", \"oinstall\", \"--groups\", \"dba,asmdba,oper,backupdba,dgdba,kmdba,racdba\", \"oracle\"]\n#   Give grid and oracle users passwords\nRUN echo \"grid:${GRID_PASSWORD}\" | chpasswd\nRUN echo \"oracle:${ORACLE_PASSWORD}\" | chpasswd\n#   Add ulimits configuration file for grid user\n#   oracle user ulimits configuration file already added by oracle-rdbms-server-12cR1-preinstall\nCOPY grid_security_limits.conf /etc/security/limits.d/\n#  ##################################################################################\n#  #  SSH Shared Keys\n#  ##################################################################################\n#   Create SSH shared key directory for the oracle user\nRUN [\"mkdir\", \"-p\", \"-m\", \"0700\", \"/home/oracle/.ssh/\"]\n#   Generate SSH shared keys for the oracle user\nRUN ssh-keygen -q -C '' -N '' -f /home/oracle/.ssh/id_rsa\n#   Create the authorized_keys file for the oracle user\nRUN cat /home/oracle/.ssh/id_rsa.pub > /home/oracle/.ssh/authorized_keys\n#   Change ownership of the SSH shared key files for the oracle user\nRUN chown -R oracle:oinstall /home/oracle/.ssh\n#   Change permissions of the authorized_keys file for the oracle user\nRUN [\"chmod\", \"0640\", \"/home/oracle/.ssh/authorized_keys\"]\n#   Create SSH shared key directory for the grid user\nRUN [\"mkdir\", \"-p\", \"-m\", \"0700\", \"/home/grid/.ssh/\"]\n#   Generate SSH shared keys for the grid user\nRUN ssh-keygen -q -C '' -N '' -f /home/grid/.ssh/id_rsa\n#   Create the authorized_keys file for the grid user\nRUN cat /home/grid/.ssh/id_rsa.pub > /home/grid/.ssh/authorized_keys\n#   Change ownership of the SSH shared key files for the grid user\nRUN chown -R grid:oinstall /home/grid/.ssh\n#   Change permissions of the authorized_keys file for the grid user\nRUN [\"chmod\", \"0640\", \"/home/grid/.ssh/authorized_keys\"]\n#   Generate SSH host ECDSA shared keys\nRUN ssh-keygen -q -C '' -N '' -t ecdsa -f /etc/ssh/ssh_host_ecdsa_key\n#   Create the ssh_known_hosts file\nRUN for NODE in rac1 rac2; do (echo -n \"$NODE \" \\\n && cat /etc/ssh/ssh_host_ecdsa_key.pub ) >> /etc/ssh/ssh_known_hosts; done\n#  ##################################################################################\n#  #  Files and Directories\n#  ##################################################################################\n#   Create installation root directory\nRUN [\"mkdir\", \"-p\", \"/u01\"]\nRUN [\"chgrp\", \"oinstall\", \"/u01\"]\nRUN [\"chmod\", \"0775\", \"/u01\"]\n#  ##################################################################################\n#  #  Misc\n#  ##################################################################################\n#   Allow non-privileged users the ability to execute the ping command\nRUN [\"chmod\", \"4755\", \"/bin/ping\"]\n#   SELinux bug fix\nRUN [\"mkdir\", \"-p\", \"/etc/selinux/targeted/contexts/\"]\nCOPY dbus_contexts /etc/selinux/targeted/contexts/\n#   Hide/disable the ttyS0 serial console service\nRUN [\"systemctl\", \"mask\", \"serial-getty@ttyS0.service\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM oraclelinux:7.2\nMAINTAINER sethmiller.sm@gmail.com\n#  Passwords for grid and oracle users\nENV [GRID_PASSWORD,=\"\\\"oracle_4U\\\"]\"\nENV [ORACLE_PASSWORD,=\"\\\"oracle_4U\\\"]\"\n# ##################################################################################\n# #  System Updates\n# ##################################################################################\n#  Update the operating system\nRUN [\"yum\", \"-y\", \"update\"]\n#  Add the oracle YUM public repositories\nADD http://public-yum.oracle.com/public-yum-ol7.repo /etc/yum.repos.d/\n#  Download and import the gpg key\nADD http://public-yum.oracle.com/RPM-GPG-KEY-oracle-ol7 /etc/yum.repos.d/\nRUN [\"rpm\", \"--import\", \"/etc/yum.repos.d/RPM-GPG-KEY-oracle-ol7\"]\n#  Install necessary packages\nRUN [\"yum\", \"-y\", \"install\", \"oracle-rdbms-server-12cR1-preinstall\", \"vim\", \"net-tools\", \"tigervnc-server\", \"xterm\", \"iscsi-initiator-utils\", \"elfutils-libelf-devel\", \"motif\", \"lshw\", \"python-pip\", \"tar\"]\n#  Clean the yum cache\nRUN [\"yum\", \"clean\", \"all\"]\n# ##################################################################################\n# #  Users and Groups\n# ##################################################################################\n#  Add groups for grid infrastructure\nRUN [\"groupadd\", \"--force\", \"--gid\", \"54321\", \"oinstall\"]\nRUN [\"groupmod\", \"--gid\", \"54321\", \"oinstall\"]\nRUN [\"groupadd\", \"--gid\", \"54421\", \"asmdba\"]\nRUN [\"groupadd\", \"--gid\", \"54422\", \"asmadmin\"]\nRUN [\"groupadd\", \"--gid\", \"54423\", \"asmoper\"]\n#  Add groups for database\nRUN [\"groupadd\", \"--force\", \"--gid\", \"54322\", \"dba\"]\nRUN [\"groupmod\", \"--gid\", \"54322\", \"dba\"]\nRUN [\"groupadd\", \"--gid\", \"54323\", \"oper\"]\nRUN [\"groupadd\", \"--gid\", \"54324\", \"backupdba\"]\nRUN [\"groupadd\", \"--gid\", \"54325\", \"dgdba\"]\nRUN [\"groupadd\", \"--gid\", \"54326\", \"kmdba\"]\nRUN [\"groupadd\", \"--gid\", \"54327\", \"racdba\"]\n#  Add grid infrastructure owner\nRUN useradd --create-home --uid 54421 --gid oinstall --groups dba,asmdba,asmadmin,asmoper grid || (RES=$? \\\n && ([ $RES -eq 9 ] \\\n && exit 0 || exit $RES ) )\nRUN [\"usermod\", \"--uid\", \"54421\", \"--gid\", \"oinstall\", \"--groups\", \"dba,asmdba,asmadmin,asmoper\", \"grid\"]\n#  Add database owner\nRUN useradd --create-home --uid 54321 --gid oinstall --groups dba,asmdba,oper,backupdba,dgdba,kmdba,racdba oracle || (RES=$? \\\n && ([ $RES -eq 9 ] \\\n && exit 0 || exit $RES ) )\nRUN [\"usermod\", \"--uid\", \"54321\", \"--gid\", \"oinstall\", \"--groups\", \"dba,asmdba,oper,backupdba,dgdba,kmdba,racdba\", \"oracle\"]\n#  Give grid and oracle users passwords\nRUN echo \"grid:${GRID_PASSWORD}\" | chpasswd\nRUN echo \"oracle:${ORACLE_PASSWORD}\" | chpasswd\n#  Add ulimits configuration file for grid user\n#  oracle user ulimits configuration file already added by oracle-rdbms-server-12cR1-preinstall\nADD grid_security_limits.conf /etc/security/limits.d/\n# ##################################################################################\n# #  SSH Shared Keys\n# ##################################################################################\n#  Create SSH shared key directory for the oracle user\nRUN [\"mkdir\", \"-p\", \"-m\", \"0700\", \"/home/oracle/.ssh/\"]\n#  Generate SSH shared keys for the oracle user\nRUN ssh-keygen -q -C '' -N '' -f /home/oracle/.ssh/id_rsa\n#  Create the authorized_keys file for the oracle user\nRUN cat /home/oracle/.ssh/id_rsa.pub > /home/oracle/.ssh/authorized_keys\n#  Change ownership of the SSH shared key files for the oracle user\nRUN chown -R oracle:oinstall /home/oracle/.ssh\n#  Change permissions of the authorized_keys file for the oracle user\nRUN [\"chmod\", \"0640\", \"/home/oracle/.ssh/authorized_keys\"]\n#  Create SSH shared key directory for the grid user\nRUN [\"mkdir\", \"-p\", \"-m\", \"0700\", \"/home/grid/.ssh/\"]\n#  Generate SSH shared keys for the grid user\nRUN ssh-keygen -q -C '' -N '' -f /home/grid/.ssh/id_rsa\n#  Create the authorized_keys file for the grid user\nRUN cat /home/grid/.ssh/id_rsa.pub > /home/grid/.ssh/authorized_keys\n#  Change ownership of the SSH shared key files for the grid user\nRUN chown -R grid:oinstall /home/grid/.ssh\n#  Change permissions of the authorized_keys file for the grid user\nRUN [\"chmod\", \"0640\", \"/home/grid/.ssh/authorized_keys\"]\n#  Generate SSH host ECDSA shared keys\nRUN ssh-keygen -q -C '' -N '' -t ecdsa -f /etc/ssh/ssh_host_ecdsa_key\n#  Create the ssh_known_hosts file\nRUN for NODE in rac1 rac2; do (echo -n \"$NODE \" \\\n && cat /etc/ssh/ssh_host_ecdsa_key.pub ) >> /etc/ssh/ssh_known_hosts; done\n# ##################################################################################\n# #  Files and Directories\n# ##################################################################################\n#  Create installation root directory\nRUN [\"mkdir\", \"-p\", \"/u01\"]\nRUN [\"chgrp\", \"oinstall\", \"/u01\"]\nRUN [\"chmod\", \"0775\", \"/u01\"]\n# ##################################################################################\n# #  Misc\n# ##################################################################################\n#  Allow non-privileged users the ability to execute the ping command\nRUN [\"chmod\", \"4755\", \"/bin/ping\"]\n#  SELinux bug fix\nRUN [\"mkdir\", \"-p\", \"/etc/selinux/targeted/contexts/\"]\nADD dbus_contexts /etc/selinux/targeted/contexts/\n#  Hide/disable the ttyS0 serial console service\nRUN [\"systemctl\", \"mask\", \"serial-getty@ttyS0.service\"]\n","injectedSmells":[],"originalDockerfileHash":"22175a452287cd285755b9b16f29e7f4","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM oraclelinux:7.2\nMAINTAINER sethmiller.sm@gmail.com\n#   Passwords for grid and oracle users\nENV [GRID_PASSWORD,=\"\\\"oracle_4U\\\"]\"\nENV [ORACLE_PASSWORD,=\"\\\"oracle_4U\\\"]\"\n#  ##################################################################################\n#  #  System Updates\n#  ##################################################################################\n#   Update the operating system\nRUN [\"yum\", \"-y\", \"update\"]\n#   Add the oracle YUM public repositories\nADD http://public-yum.oracle.com/public-yum-ol7.repo /etc/yum.repos.d/\n#   Download and import the gpg key\nADD http://public-yum.oracle.com/RPM-GPG-KEY-oracle-ol7 /etc/yum.repos.d/\nRUN [\"rpm\", \"--import\", \"/etc/yum.repos.d/RPM-GPG-KEY-oracle-ol7\"]\n#   Install necessary packages\nRUN [\"yum\", \"-y\", \"install\", \"oracle-rdbms-server-12cR1-preinstall\", \"vim\", \"net-tools\", \"tigervnc-server\", \"xterm\", \"iscsi-initiator-utils\", \"elfutils-libelf-devel\", \"motif\", \"lshw\", \"python-pip\", \"tar\"]\n#   Clean the yum cache\nRUN [\"yum\", \"clean\", \"all\"]\n#  ##################################################################################\n#  #  Users and Groups\n#  ##################################################################################\n#   Add groups for grid infrastructure\nRUN [\"groupadd\", \"--force\", \"--gid\", \"54321\", \"oinstall\"]\nRUN [\"groupmod\", \"--gid\", \"54321\", \"oinstall\"]\nRUN [\"groupadd\", \"--gid\", \"54421\", \"asmdba\"]\nRUN [\"groupadd\", \"--gid\", \"54422\", \"asmadmin\"]\nRUN [\"groupadd\", \"--gid\", \"54423\", \"asmoper\"]\n#   Add groups for database\nRUN [\"groupadd\", \"--force\", \"--gid\", \"54322\", \"dba\"]\nRUN [\"groupmod\", \"--gid\", \"54322\", \"dba\"]\nRUN [\"groupadd\", \"--gid\", \"54323\", \"oper\"]\nRUN [\"groupadd\", \"--gid\", \"54324\", \"backupdba\"]\nRUN [\"groupadd\", \"--gid\", \"54325\", \"dgdba\"]\nRUN [\"groupadd\", \"--gid\", \"54326\", \"kmdba\"]\nRUN [\"groupadd\", \"--gid\", \"54327\", \"racdba\"]\n#   Add grid infrastructure owner\nRUN useradd --create-home --uid 54421 --gid oinstall --groups dba,asmdba,asmadmin,asmoper grid || (RES=$? \\\n && ([ $RES -eq 9 ] \\\n && exit 0 || exit $RES ) )\nRUN [\"usermod\", \"--uid\", \"54421\", \"--gid\", \"oinstall\", \"--groups\", \"dba,asmdba,asmadmin,asmoper\", \"grid\"]\n#   Add database owner\nRUN useradd --create-home --uid 54321 --gid oinstall --groups dba,asmdba,oper,backupdba,dgdba,kmdba,racdba oracle || (RES=$? \\\n && ([ $RES -eq 9 ] \\\n && exit 0 || exit $RES ) )\nRUN [\"usermod\", \"--uid\", \"54321\", \"--gid\", \"oinstall\", \"--groups\", \"dba,asmdba,oper,backupdba,dgdba,kmdba,racdba\", \"oracle\"]\n#   Give grid and oracle users passwords\nRUN echo \"grid:${GRID_PASSWORD}\" | chpasswd\nRUN echo \"oracle:${ORACLE_PASSWORD}\" | chpasswd\n#   Add ulimits configuration file for grid user\n#   oracle user ulimits configuration file already added by oracle-rdbms-server-12cR1-preinstall\nADD grid_security_limits.conf /etc/security/limits.d/\n#  ##################################################################################\n#  #  SSH Shared Keys\n#  ##################################################################################\n#   Create SSH shared key directory for the oracle user\nRUN [\"mkdir\", \"-p\", \"-m\", \"0700\", \"/home/oracle/.ssh/\"]\n#   Generate SSH shared keys for the oracle user\nRUN ssh-keygen -q -C '' -N '' -f /home/oracle/.ssh/id_rsa\n#   Create the authorized_keys file for the oracle user\nRUN cat /home/oracle/.ssh/id_rsa.pub > /home/oracle/.ssh/authorized_keys\n#   Change ownership of the SSH shared key files for the oracle user\nRUN chown -R oracle:oinstall /home/oracle/.ssh\n#   Change permissions of the authorized_keys file for the oracle user\nRUN [\"chmod\", \"0640\", \"/home/oracle/.ssh/authorized_keys\"]\n#   Create SSH shared key directory for the grid user\nRUN [\"mkdir\", \"-p\", \"-m\", \"0700\", \"/home/grid/.ssh/\"]\n#   Generate SSH shared keys for the grid user\nRUN ssh-keygen -q -C '' -N '' -f /home/grid/.ssh/id_rsa\n#   Create the authorized_keys file for the grid user\nRUN cat /home/grid/.ssh/id_rsa.pub > /home/grid/.ssh/authorized_keys\n#   Change ownership of the SSH shared key files for the grid user\nRUN chown -R grid:oinstall /home/grid/.ssh\n#   Change permissions of the authorized_keys file for the grid user\nRUN [\"chmod\", \"0640\", \"/home/grid/.ssh/authorized_keys\"]\n#   Generate SSH host ECDSA shared keys\nRUN ssh-keygen -q -C '' -N '' -t ecdsa -f /etc/ssh/ssh_host_ecdsa_key\n#   Create the ssh_known_hosts file\nRUN for NODE in rac1 rac2; do (echo -n \"$NODE \" \\\n && cat /etc/ssh/ssh_host_ecdsa_key.pub ) >> /etc/ssh/ssh_known_hosts; done\n#  ##################################################################################\n#  #  Files and Directories\n#  ##################################################################################\n#   Create installation root directory\nRUN [\"mkdir\", \"-p\", \"/u01\"]\nRUN [\"chgrp\", \"oinstall\", \"/u01\"]\nRUN [\"chmod\", \"0775\", \"/u01\"]\n#  ##################################################################################\n#  #  Misc\n#  ##################################################################################\n#   Allow non-privileged users the ability to execute the ping command\nRUN [\"chmod\", \"4755\", \"/bin/ping\"]\n#   SELinux bug fix\nRUN [\"mkdir\", \"-p\", \"/etc/selinux/targeted/contexts/\"]\nADD dbus_contexts /etc/selinux/targeted/contexts/\n#   Hide/disable the ttyS0 serial console service\nRUN [\"systemctl\", \"mask\", \"serial-getty@ttyS0.service\"]\n","originalDockerfileUglifiedHash":"37608d4b37d32bd8b21da78303bfc689","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/d0ae373357a8121f7decb3b761459dc4559665ab.dockerfile"}