{"seed":1814778512,"processedDockerfileHash":"35999c3f839c3f3b590e1315969521f8","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM php:%%PHP_VERSION%%-%%VARIANT%%\nLABEL maintainer=\"Monogramm Maintainers <opensource at monogramm dot io>\"\n#   Build time env var\nENV DOLI_VERSION=\"%%VERSION%%\"\n#   Get Dolibarr\nRUN which wget &> /dev/null || apt-get install --no-install-recommends wget=1.20.3 ; wget --no-verbose --output-document /tmp/dolibarr.zip https://github.com/Dolibarr/dolibarr/archive/${DOLI_VERSION}.zip\n#   Install the packages we need\n#   Install the PHP extensions we need\n#   see https://wiki.dolibarr.org/index.php/Dependencies_and_external_libraries\n#   Prepare folders\n#   Install Dolibarr from tag archive\nRUN set -ex ; apt-get update -q ; apt-get install --no-install-recommends mysql-client rsync sendmail -y ; apt-get install --no-install-recommends libcurl4-openssl-dev libfreetype6-dev libjpeg-dev libldap2-dev libmagickcore-dev libmagickwand-dev libmcrypt-dev libpng-dev libpq-dev libxml2-dev unzip -y ; rm -rf /var/lib/apt/lists/* ; debMultiarch=\"$( dpkg-architecture --query DEB_BUILD_MULTIARCH ;)\" ; docker-php-ext-configure ldap --with-libdir=\"lib/$debMultiarch\" ; docker-php-ext-configure gd --with-freetype-dir=/usr --with-png-dir=/usr --with-jpeg-dir=/usr ; docker-php-ext-install calendar gd ldap mbstring mysqli pdo pdo_mysql pdo_pgsql pgsql soap zip ; pecl install imagick ; docker-php-ext-enable imagick ; mkdir -p /var/www/documents ; chown -R www-data:root /var/www ; chmod -R g=u /var/www ; mkdir -p /tmp/dolibarr ; unzip -q /tmp/dolibarr.zip -d /tmp/dolibarr ; rm /tmp/dolibarr.zip ; mkdir -p /usr/src/dolibarr ; cp -r /tmp/dolibarr/dolibarr-${DOLI_VERSION}/* /usr/src/dolibarr ; rm -rf /tmp/dolibarr ; chmod +x /usr/src/dolibarr/scripts/*\n#   Runtime env var\nENV DOLI_AUTO_CONFIGURE=\"1\" \\\n    DOLI_DB_TYPE=\"mysqli\" \\\n    DOLI_DB_HOST=\"\" \\\n    DOLI_DB_PORT=\"3306\" \\\n    DOLI_DB_USER=\"dolibarr\" \\\n    DOLI_DB_PASSWORD=\"\" \\\n    DOLI_DB_NAME=\"dolibarr\" \\\n    DOLI_DB_PREFIX=\"llx_\" \\\n    DOLI_DB_CHARACTER_SET=\"utf8\" \\\n    DOLI_DB_COLLATION=\"utf8_unicode_ci\" \\\n    DOLI_DB_ROOT_LOGIN=\"\" \\\n    DOLI_DB_ROOT_PASSWORD=\"\" \\\n    DOLI_ADMIN_LOGIN=\"admin\" \\\n    DOLI_MODULES=\"\" \\\n    DOLI_URL_ROOT=\"http://localhost\" \\\n    DOLI_AUTH=\"dolibarr\" \\\n    DOLI_LDAP_HOST=\"\" \\\n    DOLI_LDAP_PORT=\"389\" \\\n    DOLI_LDAP_VERSION=\"3\" \\\n    DOLI_LDAP_SERVERTYPE=\"openldap\" \\\n    DOLI_LDAP_LOGIN_ATTRIBUTE=\"uid\" \\\n    DOLI_LDAP_DN=\"\" \\\n    DOLI_LDAP_FILTER=\"\" \\\n    DOLI_LDAP_ADMIN_LOGIN=\"\" \\\n    DOLI_LDAP_ADMIN_PASS=\"\" \\\n    DOLI_LDAP_DEBUG=\"false\" \\\n    DOLI_HTTPS=\"0\" \\\n    DOLI_PROD=\"0\" \\\n    DOLI_NO_CSRF_CHECK=\"0\" \\\n    WWW_USER_ID=\"33\" \\\n    WWW_GROUP_ID=\"33\" \\\n    PHP_INI_DATE_TIMEZONE=\"UTC\" \\\n    PHP_MEMORY_LIMIT=\"256M\" \\\n    PHP_MAX_UPLOAD=\"20M\" \\\n    PHP_MAX_EXECUTION_TIME=\"300\"\nVOLUME /var/www/html /var/www/documents /var/www/scripts\nCOPY entrypoint.sh /\nRUN set -ex ; chmod 755 /entrypoint.sh\nENTRYPOINT [\"/entrypoint.sh\"]\nCMD [\"%%CMD%%\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\n","originalDockerfile":"FROM php:%%PHP_VERSION%%-%%VARIANT%%\nLABEL maintainer=\"Monogramm Maintainers <opensource at monogramm dot io>\"\n#  Build time env var\nENV DOLI_VERSION=\"%%VERSION%%\"\n#  Get Dolibarr\nADD https://github.com/Dolibarr/dolibarr/archive/${DOLI_VERSION}.zip /tmp/dolibarr.zip\n#  Install the packages we need\n#  Install the PHP extensions we need\n#  see https://wiki.dolibarr.org/index.php/Dependencies_and_external_libraries\n#  Prepare folders\n#  Install Dolibarr from tag archive\nRUN set -ex ; apt-get update -q ; apt-get install --no-install-recommends mysql-client rsync sendmail -y ; apt-get install --no-install-recommends libcurl4-openssl-dev libfreetype6-dev libjpeg-dev libldap2-dev libmagickcore-dev libmagickwand-dev libmcrypt-dev libpng-dev libpq-dev libxml2-dev unzip -y ; rm -rf /var/lib/apt/lists/* ; debMultiarch=\"$( dpkg-architecture --query DEB_BUILD_MULTIARCH ;)\" ; docker-php-ext-configure ldap --with-libdir=\"lib/$debMultiarch\" ; docker-php-ext-configure gd --with-freetype-dir=/usr --with-png-dir=/usr --with-jpeg-dir=/usr ; docker-php-ext-install calendar gd ldap mbstring mysqli pdo pdo_mysql pdo_pgsql pgsql soap zip ; pecl install imagick ; docker-php-ext-enable imagick ; mkdir -p /var/www/documents ; chown -R www-data:root /var/www ; chmod -R g=u /var/www ; mkdir -p /tmp/dolibarr ; unzip -q /tmp/dolibarr.zip -d /tmp/dolibarr ; rm /tmp/dolibarr.zip ; mkdir -p /usr/src/dolibarr ; cp -r /tmp/dolibarr/dolibarr-${DOLI_VERSION}/* /usr/src/dolibarr ; rm -rf /tmp/dolibarr ; chmod +x /usr/src/dolibarr/scripts/*\n#  Runtime env var\nENV DOLI_AUTO_CONFIGURE=\"1\" \\\n    DOLI_DB_TYPE=\"mysqli\" \\\n    DOLI_DB_HOST=\"\" \\\n    DOLI_DB_PORT=\"3306\" \\\n    DOLI_DB_USER=\"dolibarr\" \\\n    DOLI_DB_PASSWORD=\"\" \\\n    DOLI_DB_NAME=\"dolibarr\" \\\n    DOLI_DB_PREFIX=\"llx_\" \\\n    DOLI_DB_CHARACTER_SET=\"utf8\" \\\n    DOLI_DB_COLLATION=\"utf8_unicode_ci\" \\\n    DOLI_DB_ROOT_LOGIN=\"\" \\\n    DOLI_DB_ROOT_PASSWORD=\"\" \\\n    DOLI_ADMIN_LOGIN=\"admin\" \\\n    DOLI_MODULES=\"\" \\\n    DOLI_URL_ROOT=\"http://localhost\" \\\n    DOLI_AUTH=\"dolibarr\" \\\n    DOLI_LDAP_HOST=\"\" \\\n    DOLI_LDAP_PORT=\"389\" \\\n    DOLI_LDAP_VERSION=\"3\" \\\n    DOLI_LDAP_SERVERTYPE=\"openldap\" \\\n    DOLI_LDAP_LOGIN_ATTRIBUTE=\"uid\" \\\n    DOLI_LDAP_DN=\"\" \\\n    DOLI_LDAP_FILTER=\"\" \\\n    DOLI_LDAP_ADMIN_LOGIN=\"\" \\\n    DOLI_LDAP_ADMIN_PASS=\"\" \\\n    DOLI_LDAP_DEBUG=\"false\" \\\n    DOLI_HTTPS=\"0\" \\\n    DOLI_PROD=\"0\" \\\n    DOLI_NO_CSRF_CHECK=\"0\" \\\n    WWW_USER_ID=\"33\" \\\n    WWW_GROUP_ID=\"33\" \\\n    PHP_INI_DATE_TIMEZONE=\"UTC\" \\\n    PHP_MEMORY_LIMIT=\"256M\" \\\n    PHP_MAX_UPLOAD=\"20M\" \\\n    PHP_MAX_EXECUTION_TIME=\"300\"\nVOLUME /var/www/html /var/www/documents /var/www/scripts\nCOPY entrypoint.sh /\nRUN set -ex ; chmod 755 /entrypoint.sh\nENTRYPOINT [\"/entrypoint.sh\"]\nCMD [\"%%CMD%%\"]\n","injectedSmells":[],"originalDockerfileHash":"dd04666c39ae9c9ae90090e66c2b5290","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM php:%%PHP_VERSION%%-%%VARIANT%%\nLABEL maintainer=\"Monogramm Maintainers <opensource at monogramm dot io>\"\n#   Build time env var\nENV DOLI_VERSION=\"%%VERSION%%\"\n#   Get Dolibarr\nADD https://github.com/Dolibarr/dolibarr/archive/${DOLI_VERSION}.zip /tmp/dolibarr.zip\n#   Install the packages we need\n#   Install the PHP extensions we need\n#   see https://wiki.dolibarr.org/index.php/Dependencies_and_external_libraries\n#   Prepare folders\n#   Install Dolibarr from tag archive\nRUN set -ex ; apt-get update -q ; apt-get install --no-install-recommends mysql-client rsync sendmail -y ; apt-get install --no-install-recommends libcurl4-openssl-dev libfreetype6-dev libjpeg-dev libldap2-dev libmagickcore-dev libmagickwand-dev libmcrypt-dev libpng-dev libpq-dev libxml2-dev unzip -y ; rm -rf /var/lib/apt/lists/* ; debMultiarch=\"$( dpkg-architecture --query DEB_BUILD_MULTIARCH ;)\" ; docker-php-ext-configure ldap --with-libdir=\"lib/$debMultiarch\" ; docker-php-ext-configure gd --with-freetype-dir=/usr --with-png-dir=/usr --with-jpeg-dir=/usr ; docker-php-ext-install calendar gd ldap mbstring mysqli pdo pdo_mysql pdo_pgsql pgsql soap zip ; pecl install imagick ; docker-php-ext-enable imagick ; mkdir -p /var/www/documents ; chown -R www-data:root /var/www ; chmod -R g=u /var/www ; mkdir -p /tmp/dolibarr ; unzip -q /tmp/dolibarr.zip -d /tmp/dolibarr ; rm /tmp/dolibarr.zip ; mkdir -p /usr/src/dolibarr ; cp -r /tmp/dolibarr/dolibarr-${DOLI_VERSION}/* /usr/src/dolibarr ; rm -rf /tmp/dolibarr ; chmod +x /usr/src/dolibarr/scripts/*\n#   Runtime env var\nENV DOLI_AUTO_CONFIGURE=\"1\" \\\n    DOLI_DB_TYPE=\"mysqli\" \\\n    DOLI_DB_HOST=\"\" \\\n    DOLI_DB_PORT=\"3306\" \\\n    DOLI_DB_USER=\"dolibarr\" \\\n    DOLI_DB_PASSWORD=\"\" \\\n    DOLI_DB_NAME=\"dolibarr\" \\\n    DOLI_DB_PREFIX=\"llx_\" \\\n    DOLI_DB_CHARACTER_SET=\"utf8\" \\\n    DOLI_DB_COLLATION=\"utf8_unicode_ci\" \\\n    DOLI_DB_ROOT_LOGIN=\"\" \\\n    DOLI_DB_ROOT_PASSWORD=\"\" \\\n    DOLI_ADMIN_LOGIN=\"admin\" \\\n    DOLI_MODULES=\"\" \\\n    DOLI_URL_ROOT=\"http://localhost\" \\\n    DOLI_AUTH=\"dolibarr\" \\\n    DOLI_LDAP_HOST=\"\" \\\n    DOLI_LDAP_PORT=\"389\" \\\n    DOLI_LDAP_VERSION=\"3\" \\\n    DOLI_LDAP_SERVERTYPE=\"openldap\" \\\n    DOLI_LDAP_LOGIN_ATTRIBUTE=\"uid\" \\\n    DOLI_LDAP_DN=\"\" \\\n    DOLI_LDAP_FILTER=\"\" \\\n    DOLI_LDAP_ADMIN_LOGIN=\"\" \\\n    DOLI_LDAP_ADMIN_PASS=\"\" \\\n    DOLI_LDAP_DEBUG=\"false\" \\\n    DOLI_HTTPS=\"0\" \\\n    DOLI_PROD=\"0\" \\\n    DOLI_NO_CSRF_CHECK=\"0\" \\\n    WWW_USER_ID=\"33\" \\\n    WWW_GROUP_ID=\"33\" \\\n    PHP_INI_DATE_TIMEZONE=\"UTC\" \\\n    PHP_MEMORY_LIMIT=\"256M\" \\\n    PHP_MAX_UPLOAD=\"20M\" \\\n    PHP_MAX_EXECUTION_TIME=\"300\"\nVOLUME /var/www/html /var/www/documents /var/www/scripts\nCOPY entrypoint.sh /\nRUN set -ex ; chmod 755 /entrypoint.sh\nENTRYPOINT [\"/entrypoint.sh\"]\nCMD [\"%%CMD%%\"]\n","originalDockerfileUglifiedHash":"6741450dc741fbbd2550b6a30b5d702c","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/f7c118b5b2602a10cfdeff3dda4e04b19eba93f9.dockerfile"}