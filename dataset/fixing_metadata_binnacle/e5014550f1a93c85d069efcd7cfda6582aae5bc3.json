{"seed":3470366589,"processedDockerfileHash":"f558a3c4689f29b4144e0f4f0b1044fb","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","have-a-healthcheck","have-a-user"],"processedDockerfile":"#   Build target: lablup/common-tensorflow:1.0-py36\nFROM ubuntu:16.04\nLABEL maintainer=\"Mario Cho <m.cho@lablup.com>\"\n#   The TensorFlow version\nENV TF_VERSION=\"1.0\"\nENV BAZEL_VERSION=\"0.4.2\"\nENV PYTHON_BIN_PATH=\"/usr/bin/python\"\nENV PYTHON_LIB_PATH=\"/usr/local/lib/python3.6/site-packages \"\nENV GCC_HOST_COMPILER_PATH=\"/usr/bin/gcc \"\nENV CC_OPT_FLAGS=\"\\\"-march=x86-64 -mavx -mavx2 -mfma -mfpmath=both -msse4.1 -msse4.2\\\" \"\nENV TF_MKL_ROOT=\"/opt/intel/mkl\"\nENV TF_NEED_JEMALLOC=\"1\"\nENV TF_NEED_GCP=\"1\"\nENV TF_NEED_HDFS=\"1\"\nENV TF_ENABLE_XLA=\"1\"\nENV TF_NEED_VERBS=\"0\"\nENV TF_NEED_MPI=\"0\"\nENV TF_NEED_GDR=\"0\"\nENV TF_NEED_S3=\"1\"\nENV TF_NEED_KAFKA=\"0\"\nENV GCC_HOST_COMPILER_PATH=\"/usr/bin/gcc\"\n#   Install system package dependencies\n#   NOTE: running bazel requires JDK, not JRE!\nRUN apt-get update \\\n && apt-get install --no-install-recommends openjdk-8-jdk-headless=8u292-b10-0ubuntu1~16.04.1 -y \\\n && apt-get install --no-install-recommends gcc=4:5.3.1-1ubuntu1 g++=4:5.3.1-1ubuntu1 make=4.1-6 libssl-dev=1.0.2g-1ubuntu4.20 libfreetype6-dev=2.6.1-0.1ubuntu2.5 libhdf5-serial-dev=1.8.16+docs-4ubuntu1.1 libpng12-dev=1.2.54-1ubuntu1.1 libzmq3-dev=4.1.4-7ubuntu0.1 pkg-config=0.29.1-0ubuntu1 rsync=3.1.1-3ubuntu1.3 software-properties-common=0.96.20.10 zip=3.0-11 unzip=6.0-20ubuntu1.1 zlib1g-dev=1:1.2.8.dfsg-2ubuntu4.3 wget=1.17.1-1ubuntu1.5 imagemagick=8:6.8.9.9-7ubuntu5.16 graphviz=2.38.0-12ubuntu2.1 cmake=3.5.1-1ubuntu3 curl=7.47.0-1ubuntu2.19 wget=1.17.1-1ubuntu1.5 rsync=3.1.1-3ubuntu1.3 sed=4.2.2-7 swig=3.0.8-0ubuntu3 git-core=1:2.7.4-0ubuntu1.10 libcurl3-dev zip=3.0-11 -y \\\n && rm -rf /var/lib/apt/lists/*\n#  install Python 3\nRUN curl https://www.python.org/ftp/python/3.6.8/Python-3.6.8.tar.xz -o /opt/python.tar.xz \\\n && cd /opt \\\n && tar xvf python.tar.xz \\\n && cd /opt/*/ \\\n && ./configure \\\n && make \\\n && make install \\\n && ln -s -f /usr/local/bin/python3.6 /usr/bin/python\nRUN curl -fSsL -O https://bootstrap.pypa.io/get-pip.py \\\n && python get-pip.py \\\n && rm get-pip.py\nRUN mkdir /bazel \\\n && cd /bazel \\\n && curl -H \"User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.2987.133 Safari/537.36\" -fSsL -O https://github.com/bazelbuild/bazel/releases/download/$BAZEL_VERSION/bazel-$BAZEL_VERSION-installer-linux-x86_64.sh \\\n && curl -H \"User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.2987.133 Safari/537.36\" -fSsL -o /bazel/LICENSE.txt https://raw.githubusercontent.com/bazelbuild/bazel/master/LICENSE \\\n && chmod +x bazel-*.sh \\\n && ./bazel-$BAZEL_VERSION-installer-linux-x86_64.sh \\\n && cd / \\\n && rm -f /bazel/bazel-$BAZEL_VERSION-installer-linux-x86_64.sh\n#   Check Bazel/Python is runnable.\nRUN bazel version ; python -c \"import sys; print(sys.prefix); print(sys.version_info)\"\n#   Also install TensorFlow build dependencies (ensure we have proper numpy)\nRUN pip install wheel==0.40.0 numpy==1.24.2 scipy==1.10.1 --no-cache-dir \\\n && rm -f /tmp/*.whl\n#   NOTE: python should be linked to python3\nRUN : build TensorFlow pip package \\\n && cd /tmp \\\n && curl -SL https://github.com/tensorflow/tensorflow/archive/r${TF_VERSION}.tar.gz | tar xzf - \\\n && ldconfig\nRUN cd /tmp/tensorflow-r${TF_VERSION} \\\n && CC_OPT_FLAGS=\"-march=x86-64 -mavx -mavx2 -mfma -mfpmath=both -msse4.1 -msse4.2\" tensorflow/tools/ci_build/builds/configured CPU bazel build --config=opt --config=mkl --cxxopt=\"-D_GLIBCXX_USE_CXX11_ABI=0\" //tensorflow/tools/pip_package:build_pip_package \\\n && ./bazel-bin/tensorflow/tools/pip_package/build_pip_package /tmp/tensorflow_pkg\nRUN ls -l /tmp/tensorflow_pkg\n#   vim: ft=dockerfile sts=4 sw=4 et tw=0\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  Build target: lablup/common-tensorflow:1.0-py36\nFROM ubuntu:16.04\nLABEL maintainer=\"Mario Cho <m.cho@lablup.com>\"\n#  The TensorFlow version\nENV TF_VERSION=\"1.0\"\nENV BAZEL_VERSION=\"0.4.2\"\nENV PYTHON_BIN_PATH=\"/usr/bin/python\"\nENV PYTHON_LIB_PATH=\"/usr/local/lib/python3.6/site-packages \"\nENV GCC_HOST_COMPILER_PATH=\"/usr/bin/gcc \"\nENV CC_OPT_FLAGS=\"\\\"-march=x86-64 -mavx -mavx2 -mfma -mfpmath=both -msse4.1 -msse4.2\\\" \"\nENV TF_MKL_ROOT=\"/opt/intel/mkl\"\nENV TF_NEED_JEMALLOC=\"1\"\nENV TF_NEED_GCP=\"1\"\nENV TF_NEED_HDFS=\"1\"\nENV TF_ENABLE_XLA=\"1\"\nENV TF_NEED_VERBS=\"0\"\nENV TF_NEED_MPI=\"0\"\nENV TF_NEED_GDR=\"0\"\nENV TF_NEED_S3=\"1\"\nENV TF_NEED_KAFKA=\"0\"\nENV GCC_HOST_COMPILER_PATH=\"/usr/bin/gcc\"\n#  Install system package dependencies\n#  NOTE: running bazel requires JDK, not JRE!\nRUN apt-get update \\\n && apt-get install --no-install-recommends openjdk-8-jdk-headless -y \\\n && apt-get install --no-install-recommends gcc g++ make libssl-dev libfreetype6-dev libhdf5-serial-dev libpng12-dev libzmq3-dev pkg-config rsync software-properties-common zip unzip zlib1g-dev wget imagemagick graphviz cmake curl wget rsync sed swig git-core libcurl3-dev zip -y \\\n && rm -rf /var/lib/apt/lists/*\n# install Python 3\nRUN curl https://www.python.org/ftp/python/3.6.8/Python-3.6.8.tar.xz -o /opt/python.tar.xz \\\n && cd /opt \\\n && tar xvf python.tar.xz \\\n && cd /opt/*/ \\\n && ./configure \\\n && make \\\n && make install \\\n && ln -s -f /usr/local/bin/python3.6 /usr/bin/python\nRUN curl -fSsL -O https://bootstrap.pypa.io/get-pip.py \\\n && python get-pip.py \\\n && rm get-pip.py\nRUN mkdir /bazel \\\n && cd /bazel \\\n && curl -H \"User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.2987.133 Safari/537.36\" -fSsL -O https://github.com/bazelbuild/bazel/releases/download/$BAZEL_VERSION/bazel-$BAZEL_VERSION-installer-linux-x86_64.sh \\\n && curl -H \"User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.2987.133 Safari/537.36\" -fSsL -o /bazel/LICENSE.txt https://raw.githubusercontent.com/bazelbuild/bazel/master/LICENSE \\\n && chmod +x bazel-*.sh \\\n && ./bazel-$BAZEL_VERSION-installer-linux-x86_64.sh \\\n && cd / \\\n && rm -f /bazel/bazel-$BAZEL_VERSION-installer-linux-x86_64.sh\n#  Check Bazel/Python is runnable.\nRUN bazel version ; python -c \"import sys; print(sys.prefix); print(sys.version_info)\"\n#  Also install TensorFlow build dependencies (ensure we have proper numpy)\nRUN pip install wheel numpy scipy --no-cache-dir \\\n && rm -f /tmp/*.whl\n#  NOTE: python should be linked to python3\nRUN : build TensorFlow pip package \\\n && cd /tmp \\\n && curl -SL https://github.com/tensorflow/tensorflow/archive/r${TF_VERSION}.tar.gz | tar xzf - \\\n && ldconfig\nRUN cd /tmp/tensorflow-r${TF_VERSION} \\\n && CC_OPT_FLAGS=\"-march=x86-64 -mavx -mavx2 -mfma -mfpmath=both -msse4.1 -msse4.2\" tensorflow/tools/ci_build/builds/configured CPU bazel build --config=opt --config=mkl --cxxopt=\"-D_GLIBCXX_USE_CXX11_ABI=0\" //tensorflow/tools/pip_package:build_pip_package \\\n && ./bazel-bin/tensorflow/tools/pip_package/build_pip_package /tmp/tensorflow_pkg\nRUN ls -l /tmp/tensorflow_pkg\n#  vim: ft=dockerfile sts=4 sw=4 et tw=0\n","injectedSmells":[],"originalDockerfileHash":"e2715b5283cc311be8742848ced9977d","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   Build target: lablup/common-tensorflow:1.0-py36\nFROM ubuntu:16.04\nLABEL maintainer=\"Mario Cho <m.cho@lablup.com>\"\n#   The TensorFlow version\nENV TF_VERSION=\"1.0\"\nENV BAZEL_VERSION=\"0.4.2\"\nENV PYTHON_BIN_PATH=\"/usr/bin/python\"\nENV PYTHON_LIB_PATH=\"/usr/local/lib/python3.6/site-packages \"\nENV GCC_HOST_COMPILER_PATH=\"/usr/bin/gcc \"\nENV CC_OPT_FLAGS=\"\\\"-march=x86-64 -mavx -mavx2 -mfma -mfpmath=both -msse4.1 -msse4.2\\\" \"\nENV TF_MKL_ROOT=\"/opt/intel/mkl\"\nENV TF_NEED_JEMALLOC=\"1\"\nENV TF_NEED_GCP=\"1\"\nENV TF_NEED_HDFS=\"1\"\nENV TF_ENABLE_XLA=\"1\"\nENV TF_NEED_VERBS=\"0\"\nENV TF_NEED_MPI=\"0\"\nENV TF_NEED_GDR=\"0\"\nENV TF_NEED_S3=\"1\"\nENV TF_NEED_KAFKA=\"0\"\nENV GCC_HOST_COMPILER_PATH=\"/usr/bin/gcc\"\n#   Install system package dependencies\n#   NOTE: running bazel requires JDK, not JRE!\nRUN apt-get update \\\n && apt-get install --no-install-recommends openjdk-8-jdk-headless -y \\\n && apt-get install --no-install-recommends gcc g++ make libssl-dev libfreetype6-dev libhdf5-serial-dev libpng12-dev libzmq3-dev pkg-config rsync software-properties-common zip unzip zlib1g-dev wget imagemagick graphviz cmake curl wget rsync sed swig git-core libcurl3-dev zip -y \\\n && rm -rf /var/lib/apt/lists/*\n#  install Python 3\nRUN curl https://www.python.org/ftp/python/3.6.8/Python-3.6.8.tar.xz -o /opt/python.tar.xz \\\n && cd /opt \\\n && tar xvf python.tar.xz \\\n && cd /opt/*/ \\\n && ./configure \\\n && make \\\n && make install \\\n && ln -s -f /usr/local/bin/python3.6 /usr/bin/python\nRUN curl -fSsL -O https://bootstrap.pypa.io/get-pip.py \\\n && python get-pip.py \\\n && rm get-pip.py\nRUN mkdir /bazel \\\n && cd /bazel \\\n && curl -H \"User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.2987.133 Safari/537.36\" -fSsL -O https://github.com/bazelbuild/bazel/releases/download/$BAZEL_VERSION/bazel-$BAZEL_VERSION-installer-linux-x86_64.sh \\\n && curl -H \"User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.2987.133 Safari/537.36\" -fSsL -o /bazel/LICENSE.txt https://raw.githubusercontent.com/bazelbuild/bazel/master/LICENSE \\\n && chmod +x bazel-*.sh \\\n && ./bazel-$BAZEL_VERSION-installer-linux-x86_64.sh \\\n && cd / \\\n && rm -f /bazel/bazel-$BAZEL_VERSION-installer-linux-x86_64.sh\n#   Check Bazel/Python is runnable.\nRUN bazel version ; python -c \"import sys; print(sys.prefix); print(sys.version_info)\"\n#   Also install TensorFlow build dependencies (ensure we have proper numpy)\nRUN pip install wheel numpy scipy --no-cache-dir \\\n && rm -f /tmp/*.whl\n#   NOTE: python should be linked to python3\nRUN : build TensorFlow pip package \\\n && cd /tmp \\\n && curl -SL https://github.com/tensorflow/tensorflow/archive/r${TF_VERSION}.tar.gz | tar xzf - \\\n && ldconfig\nRUN cd /tmp/tensorflow-r${TF_VERSION} \\\n && CC_OPT_FLAGS=\"-march=x86-64 -mavx -mavx2 -mfma -mfpmath=both -msse4.1 -msse4.2\" tensorflow/tools/ci_build/builds/configured CPU bazel build --config=opt --config=mkl --cxxopt=\"-D_GLIBCXX_USE_CXX11_ABI=0\" //tensorflow/tools/pip_package:build_pip_package \\\n && ./bazel-bin/tensorflow/tools/pip_package/build_pip_package /tmp/tensorflow_pkg\nRUN ls -l /tmp/tensorflow_pkg\n#   vim: ft=dockerfile sts=4 sw=4 et tw=0\n","originalDockerfileUglifiedHash":"0ba0fdeb004f0c978f377bad49497d82","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/e5014550f1a93c85d069efcd7cfda6582aae5bc3.dockerfile"}