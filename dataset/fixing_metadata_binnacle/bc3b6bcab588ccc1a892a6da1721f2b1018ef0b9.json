{"seed":2258557484,"processedDockerfileHash":"a87f0a7d5a460f1b44c3ff314d67367e","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-pip","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"#  ###############################################################################\n#   Dockerfile for appserver.io main Docker distribution\n#  ###############################################################################\n#   base image\nFROM debian:jessie\n#   author\nMAINTAINER Tim Wagner <tw@appserver.io>\n#  ###############################################################################\n#   define versions\nENV APPSERVER_RUNTIME_BUILD_VERSION=\"1.1.9-46\"\n#   update the sources list\nRUN : \\\n && DEBIAN_FRONTEND=noninteractive apt-get install supervisor wget git vim -y python-pip \\\n && pip install supervisor-stdout==0.1.1\n#  ###############################################################################\n#   download runtime in specific version\nRUN wget -O /tmp/appserver-runtime.deb http://builds.appserver.io/linux/debian/8/appserver-runtime_${APPSERVER_RUNTIME_BUILD_VERSION}~deb8_amd64.deb \\\n && dpkg -i /tmp/appserver-runtime.deb ; exit 0\n#   install missing runtime dependencies\nRUN (apt-get update ;apt-get install --no-install-recommends -yf ) \\\n && rm -f /tmp/appserver-runtime.deb \\\n && ln -s /opt/appserver/bin/php /usr/local/bin/php\n#  ###############################################################################\n#   copy the appserver sources\nCOPY . /opt/appserver\n#  ###############################################################################\n#   define working directory\nWORKDIR /opt/appserver\n#  ###############################################################################\n#   create a symlink for the appserver.io Composer binary\nRUN ln -s /opt/appserver/bin/composer.phar /usr/local/bin/composer \\\n && composer install --prefer-dist --no-dev --no-interaction --optimize-autoloader \\\n && sed -i \"s/www-data/root/g\" etc/appserver/appserver.xml \\\n && sed -i \"s/user = www-data/user = root/g\" etc/php-fpm.conf \\\n && sed -i \"s/group = www-data/group = root/g\" etc/php-fpm.conf \\\n && sed -i \"s/var\\/log\\/appserver-errors.log/php:\\/\\/stderr/g\" etc/appserver/appserver.xml \\\n && sed -i \"s/var\\/log\\/appserver-access.log/php:\\/\\/stdout/g\" etc/appserver/appserver.xml \\\n && sed -i \"s/9080/80/g\" etc/appserver/appserver.xml \\\n && sed -i \"s/9443/443/g\" etc/appserver/appserver.xml \\\n && sed -i \"s/DeploymentScanner/SupervisorDeploymentScanner/g\" etc/appserver/appserver.xml \\\n && sed -i \"s/;error_log = log\\/php-fpm.log/error_log = \\/proc\\/self\\/fd\\/2/g\" etc/php-fpm.conf \\\n && sed -i \"s/\\/opt\\/appserver\\/var\\/log\\/php_errors.log/\\/proc\\/self\\/fd\\/2/g\" etc/php.ini \\\n && sed -i \"s/\\/opt\\/appserver\\/var\\/log\\/php-fpm-fcgi_errors.log/\\/proc\\/self\\/fd\\/2/g\" etc/php-fpm-fcgi.ini \\\n && sed -i \"s/;always_populate_raw_post_data = On/always_populate_raw_post_data = -1/g\" etc/php-fpm-fcgi.ini \\\n && ln -s /opt/appserver/etc/supervisor/conf.d/supervisord.conf /etc/supervisor/conf.d/supervisord.conf\n#  ###############################################################################\n#   expose ports\nEXPOSE 80/tcp 443/tcp\n#   supervisord needs this\nCMD []\n#   define default command\nENTRYPOINT [\"/usr/bin/supervisord\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"# ###############################################################################\n#  Dockerfile for appserver.io main Docker distribution\n# ###############################################################################\n#  base image\nFROM debian:jessie\n#  author\nMAINTAINER Tim Wagner <tw@appserver.io>\n# ###############################################################################\n#  define versions\nENV APPSERVER_RUNTIME_BUILD_VERSION=\"1.1.9-46\"\n#  update the sources list\nRUN apt-get update \\\n && DEBIAN_FRONTEND=noninteractive apt-get install supervisor wget git vim -y python-pip \\\n && pip install supervisor-stdout\n# ###############################################################################\n#  download runtime in specific version\nRUN wget -O /tmp/appserver-runtime.deb http://builds.appserver.io/linux/debian/8/appserver-runtime_${APPSERVER_RUNTIME_BUILD_VERSION}~deb8_amd64.deb \\\n && dpkg -i /tmp/appserver-runtime.deb ; exit 0\n#  install missing runtime dependencies\nRUN apt-get install -yf \\\n && rm -f /tmp/appserver-runtime.deb \\\n && ln -s /opt/appserver/bin/php /usr/local/bin/php\n# ###############################################################################\n#  copy the appserver sources\nADD . /opt/appserver\n# ###############################################################################\n#  define working directory\nWORKDIR /opt/appserver\n# ###############################################################################\n#  create a symlink for the appserver.io Composer binary\nRUN ln -s /opt/appserver/bin/composer.phar /usr/local/bin/composer \\\n && composer install --prefer-dist --no-dev --no-interaction --optimize-autoloader \\\n && sed -i \"s/www-data/root/g\" etc/appserver/appserver.xml \\\n && sed -i \"s/user = www-data/user = root/g\" etc/php-fpm.conf \\\n && sed -i \"s/group = www-data/group = root/g\" etc/php-fpm.conf \\\n && sed -i \"s/var\\/log\\/appserver-errors.log/php:\\/\\/stderr/g\" etc/appserver/appserver.xml \\\n && sed -i \"s/var\\/log\\/appserver-access.log/php:\\/\\/stdout/g\" etc/appserver/appserver.xml \\\n && sed -i \"s/9080/80/g\" etc/appserver/appserver.xml \\\n && sed -i \"s/9443/443/g\" etc/appserver/appserver.xml \\\n && sed -i \"s/DeploymentScanner/SupervisorDeploymentScanner/g\" etc/appserver/appserver.xml \\\n && sed -i \"s/;error_log = log\\/php-fpm.log/error_log = \\/proc\\/self\\/fd\\/2/g\" etc/php-fpm.conf \\\n && sed -i \"s/\\/opt\\/appserver\\/var\\/log\\/php_errors.log/\\/proc\\/self\\/fd\\/2/g\" etc/php.ini \\\n && sed -i \"s/\\/opt\\/appserver\\/var\\/log\\/php-fpm-fcgi_errors.log/\\/proc\\/self\\/fd\\/2/g\" etc/php-fpm-fcgi.ini \\\n && sed -i \"s/;always_populate_raw_post_data = On/always_populate_raw_post_data = -1/g\" etc/php-fpm-fcgi.ini \\\n && ln -s /opt/appserver/etc/supervisor/conf.d/supervisord.conf /etc/supervisor/conf.d/supervisord.conf\n# ###############################################################################\n#  expose ports\nEXPOSE 80/tcp 443/tcp\n#  supervisord needs this\nCMD []\n#  define default command\nENTRYPOINT [\"/usr/bin/supervisord\"]\n","injectedSmells":[],"originalDockerfileHash":"b1343375e1d479e8c081f63d869eda2c","successfullyInjectedSmells":[],"originalDockerfileUglified":"#  ###############################################################################\n#   Dockerfile for appserver.io main Docker distribution\n#  ###############################################################################\n#   base image\nFROM debian:jessie\n#   author\nMAINTAINER Tim Wagner <tw@appserver.io>\n#  ###############################################################################\n#   define versions\nENV APPSERVER_RUNTIME_BUILD_VERSION=\"1.1.9-46\"\n#   update the sources list\nRUN apt-get update \\\n && DEBIAN_FRONTEND=noninteractive apt-get install supervisor wget git vim -y python-pip \\\n && pip install supervisor-stdout\n#  ###############################################################################\n#   download runtime in specific version\nRUN wget -O /tmp/appserver-runtime.deb http://builds.appserver.io/linux/debian/8/appserver-runtime_${APPSERVER_RUNTIME_BUILD_VERSION}~deb8_amd64.deb \\\n && dpkg -i /tmp/appserver-runtime.deb ; exit 0\n#   install missing runtime dependencies\nRUN apt-get install -yf \\\n && rm -f /tmp/appserver-runtime.deb \\\n && ln -s /opt/appserver/bin/php /usr/local/bin/php\n#  ###############################################################################\n#   copy the appserver sources\nADD . /opt/appserver\n#  ###############################################################################\n#   define working directory\nWORKDIR /opt/appserver\n#  ###############################################################################\n#   create a symlink for the appserver.io Composer binary\nRUN ln -s /opt/appserver/bin/composer.phar /usr/local/bin/composer \\\n && composer install --prefer-dist --no-dev --no-interaction --optimize-autoloader \\\n && sed -i \"s/www-data/root/g\" etc/appserver/appserver.xml \\\n && sed -i \"s/user = www-data/user = root/g\" etc/php-fpm.conf \\\n && sed -i \"s/group = www-data/group = root/g\" etc/php-fpm.conf \\\n && sed -i \"s/var\\/log\\/appserver-errors.log/php:\\/\\/stderr/g\" etc/appserver/appserver.xml \\\n && sed -i \"s/var\\/log\\/appserver-access.log/php:\\/\\/stdout/g\" etc/appserver/appserver.xml \\\n && sed -i \"s/9080/80/g\" etc/appserver/appserver.xml \\\n && sed -i \"s/9443/443/g\" etc/appserver/appserver.xml \\\n && sed -i \"s/DeploymentScanner/SupervisorDeploymentScanner/g\" etc/appserver/appserver.xml \\\n && sed -i \"s/;error_log = log\\/php-fpm.log/error_log = \\/proc\\/self\\/fd\\/2/g\" etc/php-fpm.conf \\\n && sed -i \"s/\\/opt\\/appserver\\/var\\/log\\/php_errors.log/\\/proc\\/self\\/fd\\/2/g\" etc/php.ini \\\n && sed -i \"s/\\/opt\\/appserver\\/var\\/log\\/php-fpm-fcgi_errors.log/\\/proc\\/self\\/fd\\/2/g\" etc/php-fpm-fcgi.ini \\\n && sed -i \"s/;always_populate_raw_post_data = On/always_populate_raw_post_data = -1/g\" etc/php-fpm-fcgi.ini \\\n && ln -s /opt/appserver/etc/supervisor/conf.d/supervisord.conf /etc/supervisor/conf.d/supervisord.conf\n#  ###############################################################################\n#   expose ports\nEXPOSE 80/tcp 443/tcp\n#   supervisord needs this\nCMD []\n#   define default command\nENTRYPOINT [\"/usr/bin/supervisord\"]\n","originalDockerfileUglifiedHash":"accfffa57f7095857a633f454ec39f7c","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/bc3b6bcab588ccc1a892a6da1721f2b1018ef0b9.dockerfile"}