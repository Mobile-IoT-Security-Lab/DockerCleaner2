{"seed":468440024,"processedDockerfileHash":"19e36487557bb21c579b2ab115921113","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["do-not-use-apt-get-update-alone","pin-package-manager-versions-pip","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM ubuntu:16.04\nMAINTAINER dreamcat4 <dreamcat4@gmail.com>\nENV _clean=\"rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*\"\nENV _apt_clean=\"eval apt-get clean && $_clean\"\n#   apt-get clean -y && apt-get autoclean -y && apt-get autoremove -y\n#   Install s6-overlay\nENV s6_overlay_version=\"1.17.1.1\"\nRUN which wget &> /dev/null || (apt-get update ;apt-get install --no-install-recommends wget=1.20.3 ) ; wget --no-verbose --output-document /tmp/ https://github.com/just-containers/s6-overlay/releases/download/v${s6_overlay_version}/s6-overlay-amd64.tar.gz\nRUN tar zxf /tmp/s6-overlay-amd64.tar.gz -C / \\\n && $_clean\nENV S6_LOGGING=\"1\"\n#   ENV S6_KILL_GRACETIME=\"3000\"\n#   Install pipework\nRUN which wget &> /dev/null || (apt-get update ;apt-get install --no-install-recommends wget=1.20.3 ) ; wget --no-verbose --output-document /tmp/pipework-master.tar.gz https://github.com/jpetazzo/pipework/archive/master.tar.gz\nRUN tar -zxf /tmp/pipework-master.tar.gz -C /tmp \\\n && cp /tmp/pipework-master/pipework /sbin/ \\\n && $_clean\n#   Install support pkgs\nRUN : \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y wget apt-transport-https ca-certificates nano less man git sudo \\\n && $_apt_clean\n#   Install ngircd\nRUN : \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y ngircd \\\n && $_apt_clean\n#   Setup ngircd user\nRUN groupadd -o -g 5914 ngircd \\\n && useradd -o -u 5914 -g ngircd --shell /bin/bash -d /config/ngircd ngircd \\\n && install -o ngircd -g ngircd -d /config/ngircd\n#   Install atheme\nRUN wget -O /tmp/atheme.tar.gz https://dl.bintray.com/dreamcat4/linux/atheme/atheme-latest_linux-x86_64.tar.gz \\\n && tar zxf /tmp/atheme.tar.gz -C / --skip-old-files \\\n && $_clean\n#   Setup atheme user\nRUN groupadd -o -g 8153 atheme \\\n && useradd -o -u 8153 -g atheme --shell /bin/bash -d /config/atheme atheme \\\n && install -o atheme -g atheme -d /config/atheme\n#   Install znc\nRUN : \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y znc \\\n && $_apt_clean\n#   Install external znc-modules\nRUN wget -O /tmp/znc-modules.tar.gz https://dl.bintray.com/dreamcat4/linux/znc-modules/znc-modules-latest_linux-x86_64.tar.gz \\\n && tar zxf /tmp/znc-modules.tar.gz -C /usr/lib/znc/ --skip-old-files \\\n && $_clean\n#   Install 'search' helper script, to search znc logs\nCOPY znc-shell-search /usr/local/bin/search\nRUN chmod +x /usr/local/bin/search\n#   Setup znc user\nRUN groupadd -o -g 6697 znc \\\n && useradd -o -u 6697 -g znc --shell /bin/bash -d /config/znc znc \\\n && install -o znc -g znc -d /config/znc\n#   Install bitlbee\n#   Hack, install older version of libgnutls to meet bitlbee-libpurple dependancy on wily 15.10 - old bitlebee repo target\nRUN wget -O /tmp/libgnutls-deb0-28_amd64.deb http://launchpadlibrarian.net/234823129/libgnutls-deb0-28_3.3.20-1ubuntu1_amd64.deb \\\n && dpkg -i /tmp/libgnutls-deb0-28_amd64.deb \\\n && $_apt_clean\nRUN wget -O- https://code.bitlbee.org/debian/release.key | apt-key add - \\\n && echo \"deb http://code.bitlbee.org/debian/master/wily/amd64/ ./\" >> /etc/apt/sources.list \\\n && wget -O- https://jgeboski.github.io/obs.key | apt-key add - \\\n && echo \"deb http://download.opensuse.org/repositories/home:/jgeboski/xUbuntu_16.04 ./\" >> /etc/apt/sources.list \\\n && apt-key adv --keyserver keyserver.ubuntu.com --recv-keys C03AA79CFFEBD240 \\\n && echo \"deb http://ppa.launchpad.net/aap/pidgin/ubuntu xenial main\" >> /etc/apt/sources.list \\\n && apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 531EE72F4C9D234C \\\n && echo \"deb http://ppa.launchpad.net/nilarimogard/webupd8/ubuntu xenial main\" >> /etc/apt/sources.list \\\n && : \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y rsyslog bitlbee-libpurple bitlbee-plugin-otr bitlbee-steam bitlbee-facebook pidgin-sipe pidgin-skypeweb telegram-purple \\\n && $_apt_clean\n#   Hack, install older version of libprotobuf to meet dependancies\n#   This whatsapp-purple PPA needs newer ubuntu version as trusty 14.04 too old now\nRUN wget -O /tmp/libprotobuf8_amd64.deb http://security.ubuntu.com/ubuntu/pool/main/p/protobuf/libprotobuf8_2.5.0-9ubuntu1_amd64.deb \\\n && dpkg -i /tmp/libprotobuf8_amd64.deb \\\n && apt-key adv --keyserver keyserver.ubuntu.com --recv-keys C777F0E392FAE28B \\\n && echo \"deb http://ppa.launchpad.net/whatsapp-purple/ppa/ubuntu trusty main\" >> /etc/apt/sources.list \\\n && : \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y pidgin-whatsapp \\\n && $_apt_clean\n#   Bitlbee - libpurpletorchat\nENV _torchat_ver=\"2.0-alpha-14\"\nRUN : \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y tor bzip2 \\\n && wget -O /tmp/libpurpletorchat.tar.bz2 https://github.com/downloads/prof7bit/TorChat/libpurpletorchat-${_torchat_ver}-linux-x86-64.tar.bz2 \\\n && tar -C /usr/lib/purple-2 --strip-components=1 -jxvf /tmp/libpurpletorchat.tar.bz2 libpurpletorchat/libpurpletorchat.so \\\n && $_apt_clean\n#   TODO: Future (not ready yet) - tox-prpl - https://github.com/jin-eld/tox-prpl/issues/54\n#   Setup bitlbee user\nRUN groupmod -o -g 6111 bitlbee \\\n && usermod -o -u 6111 -g bitlbee --shell /bin/bash -d /config/bitlbee bitlbee \\\n && install -o bitlbee -g bitlbee -d /config/bitlbee\n#   Install limnoria (aka supybot)\nRUN : \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y python-dev python-pip pkg-config graphviz graphviz-dev libxml2-dev libxslt1-dev python-cobe \\\n && pip install pip==23.1 setuptools==67.6.1 --upgrade \\\n && pip install -r https://raw.githubusercontent.com/ProgVal/Limnoria/master/requirements.txt --upgrade \\\n && pip install limnoria==2023.1.28 --upgrade \\\n && chmod +x /usr/local/bin/supybot* \\\n && pip install -r https://raw.githubusercontent.com/ProgVal/Supybot-plugins/master/requirements.txt --upgrade \\\n && wget -q -O- https://raw.githubusercontent.com/GLolol/SupyPlugins/master/requirements.txt | grep -v \"Limnoria.git\" > /tmp/glol.reqs.txt \\\n && pip install -r /tmp/glol.reqs.txt --upgrade \\\n && rm /tmp/glol.reqs.txt \\\n && $_apt_clean\n#   NOTE: overlayfs bug causes pip dependancies install failure below ^^;\n#     https://github.com/docker/docker/issues/12327#issuecomment-171496303\n#     https://gist.github.com/amercader/4432ed33a73d510b4a08\n#\n#   Using patch / feature branch with Frog's rejected PIP pr ! didnt work\n#   RUN apt-get update && apt-get install -y python-dev python-pip && pip install --upgrade pip \\\n#    && pip install git+https://github.com/FragLegs/pip@patch-for-issue-2953 && $_apt_clean\n#   Spline plugins with broken deps: \"Stock Tweety WebHooks WorldTime\"\n#   ENV _spline_plugins=\"GitPull LogTail Series Stock Supybot-Pastebin Travis Tweety UrbanDictionary Weather WebHooks WolframAlpha WorldTime ZNC\"\nENV _spline_plugins=\"GitPull LogTail Series Supybot-Pastebin Travis UrbanDictionary Weather WebHooks WolframAlpha ZNC\"\nRUN mkdir -p limnoria-plugins/spline \\\n && for _spline_plugin in $_spline_plugins; do wget -q -O- https://raw.githubusercontent.com/reticulatingspline/${_spline_plugin}/master/requirements.txt | grep -v \"Limnoria.git\" > /tmp/spline.reqs.txt || break ;echo \"processing deps for \\\"reticulatingspline/${_spline_plugin}\\\":\" \\\n && cat /tmp/spline.reqs.txt \\\n && echo \\\n && pip install -r /tmp/spline.reqs.txt --upgrade \\\n && rm /tmp/spline.reqs.txt \\\n && echo ; done \\\n && for _spline_plugin in $_spline_plugins; do git clone https://github.com/reticulatingspline/${_spline_plugin} limnoria-plugins/spline/${_spline_plugin} ; done \\\n && $_apt_clean\nRUN mkdir -p limnoria-plugins \\\n && git clone https://github.com/ProgVal/Supybot-plugins limnoria-plugins/progval \\\n && git clone https://github.com/GLolol/SupyPlugins limnoria-plugins/glolol\nRUN echo Checking limnoria was installed \\\n && ls -lsa /usr/local/bin/supybot\n#   Setup limnoria user\nRUN groupadd -o -g 1135 limnoria \\\n && useradd -o -u 1135 -g limnoria --shell /bin/bash -d /config/limnoria limnoria \\\n && install -o limnoria -g limnoria -d /config/limnoria\n#   Install irssi from nei's irssi-test repo, on opensuse\nRUN wget -O- http://download.opensuse.org/repositories/home:ailin_nemui:irssi-test/xUbuntu_16.04/Release.key | apt-key add - \\\n && echo \"deb http://download.opensuse.org/repositories/home:/ailin_nemui:/irssi-test/xUbuntu_16.04/ /\" >> /etc/apt/sources.list \\\n && : \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y libtime-duration-perl libwww-perl libnotify-bin libmime-base64-urlsafe-perl irssi make cpanminus irssi-scripts irssi-plugin-otr irssi-plugin-xmpp \\\n && cpanm WebService::HipChat Algorithm::Diff \\\n && $_apt_clean\n#   # Install irssi from official ubuntu apt repo\n#   RUN apt-get update -qqy && DEBIAN_FRONTEND=noninteractive apt-get install -y \\\n#       libtime-duration-perl libwww-perl libnotify-bin libmime-base64-urlsafe-perl \\\n#       irssi make cpanminus irssi-scripts irssi-plugin-otr irssi-plugin-xmpp \\\n#    && cpanm WebService::HipChat Algorithm::Diff \\\n#    && $_apt_clean\n#   For irssi / adv_windowlist.pl:\n#   && cpanm Text::CharWidth \\\n#   Irssi - Download scripts and themes\nRUN git clone https://github.com/irssi/scripts.irssi.org.git \\\n && git clone https://github.com/irssi-import/themes.git \\\n && git clone https://github.com/huyz/irssi-colors-solarized\n#   Setup irssi user\nRUN groupadd -o -g 1455 irssi \\\n && useradd -o -u 1455 -g irssi --shell /bin/bash -d /config/irssi irssi \\\n && install -o irssi -g irssi -d /config/irssi\n#   Install weechat\nRUN apt-key adv --keyserver keyserver.ubuntu.com --recv-keys D1820DB22A11534E \\\n && echo \"deb https://weechat.org/ubuntu xenial main\" >> /etc/apt/sources.list \\\n && : \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y weechat weechat-plugins \\\n && $_apt_clean\n#   Setup weechat user\nRUN groupadd -o -g 3333 weechat \\\n && useradd -o -u 3333 -g weechat --shell /bin/bash -d /config/weechat weechat \\\n && install -o weechat -g weechat -d /config/weechat\n#   Install tmux, sshd and other supportive pkgs\nRUN : \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y tmux openssh-server socat nmap \\\n && $_apt_clean\n#   Set default TERM and EDITOR\nENV TERM=\"tmux-256color\" \\\n    TERMINFO=\"/etc/terminfo\" \\\n    EDITOR=\"nano\"\n#   Setup sshd for irssi\nENV tmux_socket_irssi=\"/tmp/tmux.irssi.sock\" \\\n    tmux_session_irssi=\"irssi\"\nENV tmux_socket_weechat=\"/tmp/tmux.weechat.sock\" \\\n    tmux_session_weechat=\"weechat\"\nRUN mkdir -p /var/run/sshd \\\n && echo \"\\n\\nPasswordAuthentication no\\n\\nMatch User irssi\\n ForceCommand tmux -S $tmux_socket_irssi -u attach-session -t $tmux_session_irssi\\nMatch User weechat\\n ForceCommand tmux -S $tmux_socket_weechat -u attach-session -t $tmux_session_weechat\\n\\n\" >> /etc/ssh/sshd_config\n#   Copy configuration files\nCOPY config.default /etc/config.preseed\nCOPY config.custom /etc/config.preseed\n#   Start scripts\nENV S6_LOGGING=\"0\"\nCOPY services.d /etc/services.d\n#   let irssi and weechat users sudo without password\nRUN echo \"irssi ALL=(ALL) NOPASSWD: ALL\" >> /etc/sudoers\nRUN echo \"weechat ALL=(ALL) NOPASSWD: ALL\" >> /etc/sudoers\n#   Default container settings\nRUN echo Regenerating apt cache \\\n && :\nVOLUME /config /irc\nEXPOSE 6697/tcp 22/tcp 9001/tcp\nENTRYPOINT [\"/init\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM ubuntu:16.04\nMAINTAINER dreamcat4 <dreamcat4@gmail.com>\nENV _clean=\"rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*\"\nENV _apt_clean=\"eval apt-get clean && $_clean\"\n#  apt-get clean -y && apt-get autoclean -y && apt-get autoremove -y\n#  Install s6-overlay\nENV s6_overlay_version=\"1.17.1.1\"\nADD https://github.com/just-containers/s6-overlay/releases/download/v${s6_overlay_version}/s6-overlay-amd64.tar.gz /tmp/\nRUN tar zxf /tmp/s6-overlay-amd64.tar.gz -C / \\\n && $_clean\nENV S6_LOGGING=\"1\"\n#  ENV S6_KILL_GRACETIME=\"3000\"\n#  Install pipework\nADD https://github.com/jpetazzo/pipework/archive/master.tar.gz /tmp/pipework-master.tar.gz\nRUN tar -zxf /tmp/pipework-master.tar.gz -C /tmp \\\n && cp /tmp/pipework-master/pipework /sbin/ \\\n && $_clean\n#  Install support pkgs\nRUN apt-get update -qqy \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y wget apt-transport-https ca-certificates nano less man git sudo \\\n && $_apt_clean\n#  Install ngircd\nRUN apt-get update -qqy \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y ngircd \\\n && $_apt_clean\n#  Setup ngircd user\nRUN groupadd -o -g 5914 ngircd \\\n && useradd -o -u 5914 -g ngircd --shell /bin/bash -d /config/ngircd ngircd \\\n && install -o ngircd -g ngircd -d /config/ngircd\n#  Install atheme\nRUN wget -O /tmp/atheme.tar.gz https://dl.bintray.com/dreamcat4/linux/atheme/atheme-latest_linux-x86_64.tar.gz \\\n && tar zxf /tmp/atheme.tar.gz -C / --skip-old-files \\\n && $_clean\n#  Setup atheme user\nRUN groupadd -o -g 8153 atheme \\\n && useradd -o -u 8153 -g atheme --shell /bin/bash -d /config/atheme atheme \\\n && install -o atheme -g atheme -d /config/atheme\n#  Install znc\nRUN apt-get update -qqy \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y znc \\\n && $_apt_clean\n#  Install external znc-modules\nRUN wget -O /tmp/znc-modules.tar.gz https://dl.bintray.com/dreamcat4/linux/znc-modules/znc-modules-latest_linux-x86_64.tar.gz \\\n && tar zxf /tmp/znc-modules.tar.gz -C /usr/lib/znc/ --skip-old-files \\\n && $_clean\n#  Install 'search' helper script, to search znc logs\nADD znc-shell-search /usr/local/bin/search\nRUN chmod +x /usr/local/bin/search\n#  Setup znc user\nRUN groupadd -o -g 6697 znc \\\n && useradd -o -u 6697 -g znc --shell /bin/bash -d /config/znc znc \\\n && install -o znc -g znc -d /config/znc\n#  Install bitlbee\n#  Hack, install older version of libgnutls to meet bitlbee-libpurple dependancy on wily 15.10 - old bitlebee repo target\nRUN wget -O /tmp/libgnutls-deb0-28_amd64.deb http://launchpadlibrarian.net/234823129/libgnutls-deb0-28_3.3.20-1ubuntu1_amd64.deb \\\n && dpkg -i /tmp/libgnutls-deb0-28_amd64.deb \\\n && $_apt_clean\nRUN wget -O- https://code.bitlbee.org/debian/release.key | apt-key add - \\\n && echo \"deb http://code.bitlbee.org/debian/master/wily/amd64/ ./\" >> /etc/apt/sources.list \\\n && wget -O- https://jgeboski.github.io/obs.key | apt-key add - \\\n && echo \"deb http://download.opensuse.org/repositories/home:/jgeboski/xUbuntu_16.04 ./\" >> /etc/apt/sources.list \\\n && apt-key adv --keyserver keyserver.ubuntu.com --recv-keys C03AA79CFFEBD240 \\\n && echo \"deb http://ppa.launchpad.net/aap/pidgin/ubuntu xenial main\" >> /etc/apt/sources.list \\\n && apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 531EE72F4C9D234C \\\n && echo \"deb http://ppa.launchpad.net/nilarimogard/webupd8/ubuntu xenial main\" >> /etc/apt/sources.list \\\n && apt-get update -qqy \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y rsyslog bitlbee-libpurple bitlbee-plugin-otr bitlbee-steam bitlbee-facebook pidgin-sipe pidgin-skypeweb telegram-purple \\\n && $_apt_clean\n#  Hack, install older version of libprotobuf to meet dependancies\n#  This whatsapp-purple PPA needs newer ubuntu version as trusty 14.04 too old now\nRUN wget -O /tmp/libprotobuf8_amd64.deb http://security.ubuntu.com/ubuntu/pool/main/p/protobuf/libprotobuf8_2.5.0-9ubuntu1_amd64.deb \\\n && dpkg -i /tmp/libprotobuf8_amd64.deb \\\n && apt-key adv --keyserver keyserver.ubuntu.com --recv-keys C777F0E392FAE28B \\\n && echo \"deb http://ppa.launchpad.net/whatsapp-purple/ppa/ubuntu trusty main\" >> /etc/apt/sources.list \\\n && apt-get update -qqy \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y pidgin-whatsapp \\\n && $_apt_clean\n#  Bitlbee - libpurpletorchat\nENV _torchat_ver=\"2.0-alpha-14\"\nRUN apt-get update -qqy \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y tor bzip2 \\\n && wget -O /tmp/libpurpletorchat.tar.bz2 https://github.com/downloads/prof7bit/TorChat/libpurpletorchat-${_torchat_ver}-linux-x86-64.tar.bz2 \\\n && tar -C /usr/lib/purple-2 --strip-components=1 -jxvf /tmp/libpurpletorchat.tar.bz2 libpurpletorchat/libpurpletorchat.so \\\n && $_apt_clean\n#  TODO: Future (not ready yet) - tox-prpl - https://github.com/jin-eld/tox-prpl/issues/54\n#  Setup bitlbee user\nRUN groupmod -o -g 6111 bitlbee \\\n && usermod -o -u 6111 -g bitlbee --shell /bin/bash -d /config/bitlbee bitlbee \\\n && install -o bitlbee -g bitlbee -d /config/bitlbee\n#  Install limnoria (aka supybot)\nRUN apt-get update -qqy \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y python-dev python-pip pkg-config graphviz graphviz-dev libxml2-dev libxslt1-dev python-cobe \\\n && pip install pip setuptools --upgrade \\\n && pip install -r https://raw.githubusercontent.com/ProgVal/Limnoria/master/requirements.txt --upgrade \\\n && pip install limnoria --upgrade \\\n && chmod +x /usr/local/bin/supybot* \\\n && pip install -r https://raw.githubusercontent.com/ProgVal/Supybot-plugins/master/requirements.txt --upgrade \\\n && wget -q -O- https://raw.githubusercontent.com/GLolol/SupyPlugins/master/requirements.txt | grep -v \"Limnoria.git\" > /tmp/glol.reqs.txt \\\n && pip install -r /tmp/glol.reqs.txt --upgrade \\\n && rm /tmp/glol.reqs.txt \\\n && $_apt_clean\n#  NOTE: overlayfs bug causes pip dependancies install failure below ^^;\n#    https://github.com/docker/docker/issues/12327#issuecomment-171496303\n#    https://gist.github.com/amercader/4432ed33a73d510b4a08\n#\n#  Using patch / feature branch with Frog's rejected PIP pr ! didnt work\n#  RUN apt-get update && apt-get install -y python-dev python-pip && pip install --upgrade pip \\\n#   && pip install git+https://github.com/FragLegs/pip@patch-for-issue-2953 && $_apt_clean\n#  Spline plugins with broken deps: \"Stock Tweety WebHooks WorldTime\"\n#  ENV _spline_plugins=\"GitPull LogTail Series Stock Supybot-Pastebin Travis Tweety UrbanDictionary Weather WebHooks WolframAlpha WorldTime ZNC\"\nENV _spline_plugins=\"GitPull LogTail Series Supybot-Pastebin Travis UrbanDictionary Weather WebHooks WolframAlpha ZNC\"\nRUN mkdir -p limnoria-plugins/spline \\\n && for _spline_plugin in $_spline_plugins; do wget -q -O- https://raw.githubusercontent.com/reticulatingspline/${_spline_plugin}/master/requirements.txt | grep -v \"Limnoria.git\" > /tmp/spline.reqs.txt || break ;echo \"processing deps for \\\"reticulatingspline/${_spline_plugin}\\\":\" \\\n && cat /tmp/spline.reqs.txt \\\n && echo \\\n && pip install -r /tmp/spline.reqs.txt --upgrade \\\n && rm /tmp/spline.reqs.txt \\\n && echo ; done \\\n && for _spline_plugin in $_spline_plugins; do git clone https://github.com/reticulatingspline/${_spline_plugin} limnoria-plugins/spline/${_spline_plugin} ; done \\\n && $_apt_clean\nRUN mkdir -p limnoria-plugins \\\n && git clone https://github.com/ProgVal/Supybot-plugins limnoria-plugins/progval \\\n && git clone https://github.com/GLolol/SupyPlugins limnoria-plugins/glolol\nRUN echo Checking limnoria was installed \\\n && ls -lsa /usr/local/bin/supybot\n#  Setup limnoria user\nRUN groupadd -o -g 1135 limnoria \\\n && useradd -o -u 1135 -g limnoria --shell /bin/bash -d /config/limnoria limnoria \\\n && install -o limnoria -g limnoria -d /config/limnoria\n#  Install irssi from nei's irssi-test repo, on opensuse\nRUN wget -O- http://download.opensuse.org/repositories/home:ailin_nemui:irssi-test/xUbuntu_16.04/Release.key | apt-key add - \\\n && echo \"deb http://download.opensuse.org/repositories/home:/ailin_nemui:/irssi-test/xUbuntu_16.04/ /\" >> /etc/apt/sources.list \\\n && apt-get update -qqy \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y libtime-duration-perl libwww-perl libnotify-bin libmime-base64-urlsafe-perl irssi make cpanminus irssi-scripts irssi-plugin-otr irssi-plugin-xmpp \\\n && cpanm WebService::HipChat Algorithm::Diff \\\n && $_apt_clean\n#  # Install irssi from official ubuntu apt repo\n#  RUN apt-get update -qqy && DEBIAN_FRONTEND=noninteractive apt-get install -y \\\n#      libtime-duration-perl libwww-perl libnotify-bin libmime-base64-urlsafe-perl \\\n#      irssi make cpanminus irssi-scripts irssi-plugin-otr irssi-plugin-xmpp \\\n#   && cpanm WebService::HipChat Algorithm::Diff \\\n#   && $_apt_clean\n#  For irssi / adv_windowlist.pl:\n#  && cpanm Text::CharWidth \\\n#  Irssi - Download scripts and themes\nRUN git clone https://github.com/irssi/scripts.irssi.org.git \\\n && git clone https://github.com/irssi-import/themes.git \\\n && git clone https://github.com/huyz/irssi-colors-solarized\n#  Setup irssi user\nRUN groupadd -o -g 1455 irssi \\\n && useradd -o -u 1455 -g irssi --shell /bin/bash -d /config/irssi irssi \\\n && install -o irssi -g irssi -d /config/irssi\n#  Install weechat\nRUN apt-key adv --keyserver keyserver.ubuntu.com --recv-keys D1820DB22A11534E \\\n && echo \"deb https://weechat.org/ubuntu xenial main\" >> /etc/apt/sources.list \\\n && apt-get update -qqy \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y weechat weechat-plugins \\\n && $_apt_clean\n#  Setup weechat user\nRUN groupadd -o -g 3333 weechat \\\n && useradd -o -u 3333 -g weechat --shell /bin/bash -d /config/weechat weechat \\\n && install -o weechat -g weechat -d /config/weechat\n#  Install tmux, sshd and other supportive pkgs\nRUN apt-get update -qqy \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y tmux openssh-server socat nmap \\\n && $_apt_clean\n#  Set default TERM and EDITOR\nENV TERM=\"tmux-256color\" \\\n    TERMINFO=\"/etc/terminfo\" \\\n    EDITOR=\"nano\"\n#  Setup sshd for irssi\nENV tmux_socket_irssi=\"/tmp/tmux.irssi.sock\" \\\n    tmux_session_irssi=\"irssi\"\nENV tmux_socket_weechat=\"/tmp/tmux.weechat.sock\" \\\n    tmux_session_weechat=\"weechat\"\nRUN mkdir -p /var/run/sshd \\\n && echo \"\\n\\nPasswordAuthentication no\\n\\nMatch User irssi\\n ForceCommand tmux -S $tmux_socket_irssi -u attach-session -t $tmux_session_irssi\\nMatch User weechat\\n ForceCommand tmux -S $tmux_socket_weechat -u attach-session -t $tmux_session_weechat\\n\\n\" >> /etc/ssh/sshd_config\n#  Copy configuration files\nADD config.default /etc/config.preseed\nADD config.custom /etc/config.preseed\n#  Start scripts\nENV S6_LOGGING=\"0\"\nADD services.d /etc/services.d\n#  let irssi and weechat users sudo without password\nRUN echo \"irssi ALL=(ALL) NOPASSWD: ALL\" >> /etc/sudoers\nRUN echo \"weechat ALL=(ALL) NOPASSWD: ALL\" >> /etc/sudoers\n#  Default container settings\nRUN echo Regenerating apt cache \\\n && apt-get update -qqy\nVOLUME /config /irc\nEXPOSE 6697/tcp 22/tcp 9001/tcp\nENTRYPOINT [\"/init\"]\n","injectedSmells":[],"originalDockerfileHash":"716a5433eb3ced4a0ee2c6281bebd3d8","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM ubuntu:16.04\nMAINTAINER dreamcat4 <dreamcat4@gmail.com>\nENV _clean=\"rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*\"\nENV _apt_clean=\"eval apt-get clean && $_clean\"\n#   apt-get clean -y && apt-get autoclean -y && apt-get autoremove -y\n#   Install s6-overlay\nENV s6_overlay_version=\"1.17.1.1\"\nADD https://github.com/just-containers/s6-overlay/releases/download/v${s6_overlay_version}/s6-overlay-amd64.tar.gz /tmp/\nRUN tar zxf /tmp/s6-overlay-amd64.tar.gz -C / \\\n && $_clean\nENV S6_LOGGING=\"1\"\n#   ENV S6_KILL_GRACETIME=\"3000\"\n#   Install pipework\nADD https://github.com/jpetazzo/pipework/archive/master.tar.gz /tmp/pipework-master.tar.gz\nRUN tar -zxf /tmp/pipework-master.tar.gz -C /tmp \\\n && cp /tmp/pipework-master/pipework /sbin/ \\\n && $_clean\n#   Install support pkgs\nRUN apt-get update -qqy \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y wget apt-transport-https ca-certificates nano less man git sudo \\\n && $_apt_clean\n#   Install ngircd\nRUN apt-get update -qqy \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y ngircd \\\n && $_apt_clean\n#   Setup ngircd user\nRUN groupadd -o -g 5914 ngircd \\\n && useradd -o -u 5914 -g ngircd --shell /bin/bash -d /config/ngircd ngircd \\\n && install -o ngircd -g ngircd -d /config/ngircd\n#   Install atheme\nRUN wget -O /tmp/atheme.tar.gz https://dl.bintray.com/dreamcat4/linux/atheme/atheme-latest_linux-x86_64.tar.gz \\\n && tar zxf /tmp/atheme.tar.gz -C / --skip-old-files \\\n && $_clean\n#   Setup atheme user\nRUN groupadd -o -g 8153 atheme \\\n && useradd -o -u 8153 -g atheme --shell /bin/bash -d /config/atheme atheme \\\n && install -o atheme -g atheme -d /config/atheme\n#   Install znc\nRUN apt-get update -qqy \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y znc \\\n && $_apt_clean\n#   Install external znc-modules\nRUN wget -O /tmp/znc-modules.tar.gz https://dl.bintray.com/dreamcat4/linux/znc-modules/znc-modules-latest_linux-x86_64.tar.gz \\\n && tar zxf /tmp/znc-modules.tar.gz -C /usr/lib/znc/ --skip-old-files \\\n && $_clean\n#   Install 'search' helper script, to search znc logs\nADD znc-shell-search /usr/local/bin/search\nRUN chmod +x /usr/local/bin/search\n#   Setup znc user\nRUN groupadd -o -g 6697 znc \\\n && useradd -o -u 6697 -g znc --shell /bin/bash -d /config/znc znc \\\n && install -o znc -g znc -d /config/znc\n#   Install bitlbee\n#   Hack, install older version of libgnutls to meet bitlbee-libpurple dependancy on wily 15.10 - old bitlebee repo target\nRUN wget -O /tmp/libgnutls-deb0-28_amd64.deb http://launchpadlibrarian.net/234823129/libgnutls-deb0-28_3.3.20-1ubuntu1_amd64.deb \\\n && dpkg -i /tmp/libgnutls-deb0-28_amd64.deb \\\n && $_apt_clean\nRUN wget -O- https://code.bitlbee.org/debian/release.key | apt-key add - \\\n && echo \"deb http://code.bitlbee.org/debian/master/wily/amd64/ ./\" >> /etc/apt/sources.list \\\n && wget -O- https://jgeboski.github.io/obs.key | apt-key add - \\\n && echo \"deb http://download.opensuse.org/repositories/home:/jgeboski/xUbuntu_16.04 ./\" >> /etc/apt/sources.list \\\n && apt-key adv --keyserver keyserver.ubuntu.com --recv-keys C03AA79CFFEBD240 \\\n && echo \"deb http://ppa.launchpad.net/aap/pidgin/ubuntu xenial main\" >> /etc/apt/sources.list \\\n && apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 531EE72F4C9D234C \\\n && echo \"deb http://ppa.launchpad.net/nilarimogard/webupd8/ubuntu xenial main\" >> /etc/apt/sources.list \\\n && apt-get update -qqy \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y rsyslog bitlbee-libpurple bitlbee-plugin-otr bitlbee-steam bitlbee-facebook pidgin-sipe pidgin-skypeweb telegram-purple \\\n && $_apt_clean\n#   Hack, install older version of libprotobuf to meet dependancies\n#   This whatsapp-purple PPA needs newer ubuntu version as trusty 14.04 too old now\nRUN wget -O /tmp/libprotobuf8_amd64.deb http://security.ubuntu.com/ubuntu/pool/main/p/protobuf/libprotobuf8_2.5.0-9ubuntu1_amd64.deb \\\n && dpkg -i /tmp/libprotobuf8_amd64.deb \\\n && apt-key adv --keyserver keyserver.ubuntu.com --recv-keys C777F0E392FAE28B \\\n && echo \"deb http://ppa.launchpad.net/whatsapp-purple/ppa/ubuntu trusty main\" >> /etc/apt/sources.list \\\n && apt-get update -qqy \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y pidgin-whatsapp \\\n && $_apt_clean\n#   Bitlbee - libpurpletorchat\nENV _torchat_ver=\"2.0-alpha-14\"\nRUN apt-get update -qqy \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y tor bzip2 \\\n && wget -O /tmp/libpurpletorchat.tar.bz2 https://github.com/downloads/prof7bit/TorChat/libpurpletorchat-${_torchat_ver}-linux-x86-64.tar.bz2 \\\n && tar -C /usr/lib/purple-2 --strip-components=1 -jxvf /tmp/libpurpletorchat.tar.bz2 libpurpletorchat/libpurpletorchat.so \\\n && $_apt_clean\n#   TODO: Future (not ready yet) - tox-prpl - https://github.com/jin-eld/tox-prpl/issues/54\n#   Setup bitlbee user\nRUN groupmod -o -g 6111 bitlbee \\\n && usermod -o -u 6111 -g bitlbee --shell /bin/bash -d /config/bitlbee bitlbee \\\n && install -o bitlbee -g bitlbee -d /config/bitlbee\n#   Install limnoria (aka supybot)\nRUN apt-get update -qqy \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y python-dev python-pip pkg-config graphviz graphviz-dev libxml2-dev libxslt1-dev python-cobe \\\n && pip install pip setuptools --upgrade \\\n && pip install -r https://raw.githubusercontent.com/ProgVal/Limnoria/master/requirements.txt --upgrade \\\n && pip install limnoria --upgrade \\\n && chmod +x /usr/local/bin/supybot* \\\n && pip install -r https://raw.githubusercontent.com/ProgVal/Supybot-plugins/master/requirements.txt --upgrade \\\n && wget -q -O- https://raw.githubusercontent.com/GLolol/SupyPlugins/master/requirements.txt | grep -v \"Limnoria.git\" > /tmp/glol.reqs.txt \\\n && pip install -r /tmp/glol.reqs.txt --upgrade \\\n && rm /tmp/glol.reqs.txt \\\n && $_apt_clean\n#   NOTE: overlayfs bug causes pip dependancies install failure below ^^;\n#     https://github.com/docker/docker/issues/12327#issuecomment-171496303\n#     https://gist.github.com/amercader/4432ed33a73d510b4a08\n#\n#   Using patch / feature branch with Frog's rejected PIP pr ! didnt work\n#   RUN apt-get update && apt-get install -y python-dev python-pip && pip install --upgrade pip \\\n#    && pip install git+https://github.com/FragLegs/pip@patch-for-issue-2953 && $_apt_clean\n#   Spline plugins with broken deps: \"Stock Tweety WebHooks WorldTime\"\n#   ENV _spline_plugins=\"GitPull LogTail Series Stock Supybot-Pastebin Travis Tweety UrbanDictionary Weather WebHooks WolframAlpha WorldTime ZNC\"\nENV _spline_plugins=\"GitPull LogTail Series Supybot-Pastebin Travis UrbanDictionary Weather WebHooks WolframAlpha ZNC\"\nRUN mkdir -p limnoria-plugins/spline \\\n && for _spline_plugin in $_spline_plugins; do wget -q -O- https://raw.githubusercontent.com/reticulatingspline/${_spline_plugin}/master/requirements.txt | grep -v \"Limnoria.git\" > /tmp/spline.reqs.txt || break ;echo \"processing deps for \\\"reticulatingspline/${_spline_plugin}\\\":\" \\\n && cat /tmp/spline.reqs.txt \\\n && echo \\\n && pip install -r /tmp/spline.reqs.txt --upgrade \\\n && rm /tmp/spline.reqs.txt \\\n && echo ; done \\\n && for _spline_plugin in $_spline_plugins; do git clone https://github.com/reticulatingspline/${_spline_plugin} limnoria-plugins/spline/${_spline_plugin} ; done \\\n && $_apt_clean\nRUN mkdir -p limnoria-plugins \\\n && git clone https://github.com/ProgVal/Supybot-plugins limnoria-plugins/progval \\\n && git clone https://github.com/GLolol/SupyPlugins limnoria-plugins/glolol\nRUN echo Checking limnoria was installed \\\n && ls -lsa /usr/local/bin/supybot\n#   Setup limnoria user\nRUN groupadd -o -g 1135 limnoria \\\n && useradd -o -u 1135 -g limnoria --shell /bin/bash -d /config/limnoria limnoria \\\n && install -o limnoria -g limnoria -d /config/limnoria\n#   Install irssi from nei's irssi-test repo, on opensuse\nRUN wget -O- http://download.opensuse.org/repositories/home:ailin_nemui:irssi-test/xUbuntu_16.04/Release.key | apt-key add - \\\n && echo \"deb http://download.opensuse.org/repositories/home:/ailin_nemui:/irssi-test/xUbuntu_16.04/ /\" >> /etc/apt/sources.list \\\n && apt-get update -qqy \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y libtime-duration-perl libwww-perl libnotify-bin libmime-base64-urlsafe-perl irssi make cpanminus irssi-scripts irssi-plugin-otr irssi-plugin-xmpp \\\n && cpanm WebService::HipChat Algorithm::Diff \\\n && $_apt_clean\n#   # Install irssi from official ubuntu apt repo\n#   RUN apt-get update -qqy && DEBIAN_FRONTEND=noninteractive apt-get install -y \\\n#       libtime-duration-perl libwww-perl libnotify-bin libmime-base64-urlsafe-perl \\\n#       irssi make cpanminus irssi-scripts irssi-plugin-otr irssi-plugin-xmpp \\\n#    && cpanm WebService::HipChat Algorithm::Diff \\\n#    && $_apt_clean\n#   For irssi / adv_windowlist.pl:\n#   && cpanm Text::CharWidth \\\n#   Irssi - Download scripts and themes\nRUN git clone https://github.com/irssi/scripts.irssi.org.git \\\n && git clone https://github.com/irssi-import/themes.git \\\n && git clone https://github.com/huyz/irssi-colors-solarized\n#   Setup irssi user\nRUN groupadd -o -g 1455 irssi \\\n && useradd -o -u 1455 -g irssi --shell /bin/bash -d /config/irssi irssi \\\n && install -o irssi -g irssi -d /config/irssi\n#   Install weechat\nRUN apt-key adv --keyserver keyserver.ubuntu.com --recv-keys D1820DB22A11534E \\\n && echo \"deb https://weechat.org/ubuntu xenial main\" >> /etc/apt/sources.list \\\n && apt-get update -qqy \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y weechat weechat-plugins \\\n && $_apt_clean\n#   Setup weechat user\nRUN groupadd -o -g 3333 weechat \\\n && useradd -o -u 3333 -g weechat --shell /bin/bash -d /config/weechat weechat \\\n && install -o weechat -g weechat -d /config/weechat\n#   Install tmux, sshd and other supportive pkgs\nRUN apt-get update -qqy \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y tmux openssh-server socat nmap \\\n && $_apt_clean\n#   Set default TERM and EDITOR\nENV TERM=\"tmux-256color\" \\\n    TERMINFO=\"/etc/terminfo\" \\\n    EDITOR=\"nano\"\n#   Setup sshd for irssi\nENV tmux_socket_irssi=\"/tmp/tmux.irssi.sock\" \\\n    tmux_session_irssi=\"irssi\"\nENV tmux_socket_weechat=\"/tmp/tmux.weechat.sock\" \\\n    tmux_session_weechat=\"weechat\"\nRUN mkdir -p /var/run/sshd \\\n && echo \"\\n\\nPasswordAuthentication no\\n\\nMatch User irssi\\n ForceCommand tmux -S $tmux_socket_irssi -u attach-session -t $tmux_session_irssi\\nMatch User weechat\\n ForceCommand tmux -S $tmux_socket_weechat -u attach-session -t $tmux_session_weechat\\n\\n\" >> /etc/ssh/sshd_config\n#   Copy configuration files\nADD config.default /etc/config.preseed\nADD config.custom /etc/config.preseed\n#   Start scripts\nENV S6_LOGGING=\"0\"\nADD services.d /etc/services.d\n#   let irssi and weechat users sudo without password\nRUN echo \"irssi ALL=(ALL) NOPASSWD: ALL\" >> /etc/sudoers\nRUN echo \"weechat ALL=(ALL) NOPASSWD: ALL\" >> /etc/sudoers\n#   Default container settings\nRUN echo Regenerating apt cache \\\n && apt-get update -qqy\nVOLUME /config /irc\nEXPOSE 6697/tcp 22/tcp 9001/tcp\nENTRYPOINT [\"/init\"]\n","originalDockerfileUglifiedHash":"aad0ea6b86e1324b841c28be5fb976cd","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/812a7604d999f15c5716b75f7a7c02a2d3d1b9f1.dockerfile"}