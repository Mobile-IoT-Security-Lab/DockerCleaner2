{"seed":3117252787,"processedDockerfileHash":"c48cb7d8fcfd8b876ace19c931ace1ce","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM centos:7\nMAINTAINER Skiychan <dev@skiy.net>\nENV NGINX_VERSION=\"1.17.0\"\nENV PHP_VERSION=\"7.2.19\"\nRUN set -x \\\n && yum install -y gcc gcc-c++ autoconf automake libtool make cmake \\\n && rpm -ivh http://dl.fedoraproject.org/pub/epel/6/i386/epel-release-6-8.noarch.rpm \\\n && yum install -y zlib zlib-devel openssl openssl-devel pcre-devel libxml2 libxml2-devel libcurl libcurl-devel libpng-devel libjpeg-devel freetype-devel libmcrypt-devel openssh-server python-setuptools \\\n && mkdir -p /data/{www,phpextini,phpextfile} \\\n && useradd -r -s /sbin/nologin -d /data/www -m -k no www \\\n && mkdir -p /home/nginx-php \\\n && cd $_ \\\n && curl -Lk http://nginx.org/download/nginx-$NGINX_VERSION.tar.gz | gunzip | tar x -C /home/nginx-php \\\n && curl -Lk http://php.net/distributions/php-$PHP_VERSION.tar.gz | gunzip | tar x -C /home/nginx-php \\\n && cd /home/nginx-php/nginx-$NGINX_VERSION \\\n && ./configure --prefix=/usr/local/nginx --user=www --group=www --error-log-path=/var/log/nginx_error.log --http-log-path=/var/log/nginx_access.log --pid-path=/var/run/nginx.pid --with-pcre --with-http_ssl_module --without-mail_pop3_module --without-mail_imap_module --with-http_gzip_static_module \\\n && make \\\n && make install \\\n && cd /home/nginx-php/php-$PHP_VERSION \\\n && ./configure --prefix=/usr/local/php --with-config-file-path=/usr/local/php/etc --with-config-file-scan-dir=/data/phpextini --with-fpm-user=www --with-fpm-group=www --with-mysqli --with-pdo-mysql --with-openssl --with-gd --with-iconv --with-zlib --with-gettext --with-curl --with-png-dir --with-jpeg-dir --with-freetype-dir --with-xmlrpc --with-mhash --enable-fpm --enable-xml --enable-shmop --enable-sysvsem --enable-inline-optimization --enable-mbregex --enable-mbstring --enable-ftp --enable-mysqlnd --enable-pcntl --enable-sockets --enable-zip --enable-soap --enable-session --enable-opcache --enable-bcmath --enable-exif --enable-fileinfo --disable-rpath --enable-ipv6 --disable-debug --without-pear \\\n && make \\\n && make install \\\n && cd /home/nginx-php/php-$PHP_VERSION \\\n && cp php.ini-production /usr/local/php/etc/php.ini \\\n && cp /usr/local/php/etc/php-fpm.conf.default /usr/local/php/etc/php-fpm.conf \\\n && cp /usr/local/php/etc/php-fpm.d/www.conf.default /usr/local/php/etc/php-fpm.d/www.conf \\\n && easy_install supervisor \\\n && mkdir -p /var/{log/supervisor,run/{sshd,supervisord}} \\\n && yum remove -y gcc gcc-c++ autoconf automake libtool make cmake \\\n && yum clean all \\\n && rm -rf /tmp/* /var/cache/{yum,ldconfig} /etc/my.cnf{,.d} \\\n && mkdir -p --mode=0755 /var/cache/{yum,ldconfig} \\\n && find /var/log -type f -delete \\\n && rm -rf /home/nginx-php \\\n && chown -R www:www /data/www\n#  Add supervisord conf\nCOPY supervisord.conf /etc/\n#  Create web folder\n#   WEB Folder: /data/www\n#   SSL Folder: /usr/local/nginx/conf/ssl\n#   Vhost Folder: /usr/local/nginx/conf/vhost\n#   php extfile ini Folder: /usr/local/php/etc/conf.d\n#   php extfile Folder: /data/phpextfile\nVOLUME [\"/data/www\", \"/usr/local/nginx/conf/ssl\", \"/usr/local/nginx/conf/vhost\", \"/data/phpextini\", \"/data/phpextfile\"]\nCOPY index.php /data/www/\n#  Add ext setting to image\n#  ADD extini/ /data/phpextini/\n#  ADD extfile/ /data/phpextfile/\n#  Update nginx config\nCOPY nginx.conf /usr/local/nginx/conf/\n#  Start\nCOPY start.sh /\nRUN chmod +x /start.sh\n#  Set port\nEXPOSE 80/tcp 443/tcp\n#  Start it\nENTRYPOINT [\"/start.sh\"]\n#  Start web server\n#  CMD [\"/bin/bash\", \"/start.sh\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM centos:7\nMAINTAINER Skiychan <dev@skiy.net>\nENV NGINX_VERSION=\"1.17.0\"\nENV PHP_VERSION=\"7.2.19\"\nRUN set -x \\\n && yum install -y gcc gcc-c++ autoconf automake libtool make cmake \\\n && rpm -ivh http://dl.fedoraproject.org/pub/epel/6/i386/epel-release-6-8.noarch.rpm \\\n && yum install -y zlib zlib-devel openssl openssl-devel pcre-devel libxml2 libxml2-devel libcurl libcurl-devel libpng-devel libjpeg-devel freetype-devel libmcrypt-devel openssh-server python-setuptools \\\n && mkdir -p /data/{www,phpextini,phpextfile} \\\n && useradd -r -s /sbin/nologin -d /data/www -m -k no www \\\n && mkdir -p /home/nginx-php \\\n && cd $_ \\\n && curl -Lk http://nginx.org/download/nginx-$NGINX_VERSION.tar.gz | gunzip | tar x -C /home/nginx-php \\\n && curl -Lk http://php.net/distributions/php-$PHP_VERSION.tar.gz | gunzip | tar x -C /home/nginx-php \\\n && cd /home/nginx-php/nginx-$NGINX_VERSION \\\n && ./configure --prefix=/usr/local/nginx --user=www --group=www --error-log-path=/var/log/nginx_error.log --http-log-path=/var/log/nginx_access.log --pid-path=/var/run/nginx.pid --with-pcre --with-http_ssl_module --without-mail_pop3_module --without-mail_imap_module --with-http_gzip_static_module \\\n && make \\\n && make install \\\n && cd /home/nginx-php/php-$PHP_VERSION \\\n && ./configure --prefix=/usr/local/php --with-config-file-path=/usr/local/php/etc --with-config-file-scan-dir=/data/phpextini --with-fpm-user=www --with-fpm-group=www --with-mysqli --with-pdo-mysql --with-openssl --with-gd --with-iconv --with-zlib --with-gettext --with-curl --with-png-dir --with-jpeg-dir --with-freetype-dir --with-xmlrpc --with-mhash --enable-fpm --enable-xml --enable-shmop --enable-sysvsem --enable-inline-optimization --enable-mbregex --enable-mbstring --enable-ftp --enable-mysqlnd --enable-pcntl --enable-sockets --enable-zip --enable-soap --enable-session --enable-opcache --enable-bcmath --enable-exif --enable-fileinfo --disable-rpath --enable-ipv6 --disable-debug --without-pear \\\n && make \\\n && make install \\\n && cd /home/nginx-php/php-$PHP_VERSION \\\n && cp php.ini-production /usr/local/php/etc/php.ini \\\n && cp /usr/local/php/etc/php-fpm.conf.default /usr/local/php/etc/php-fpm.conf \\\n && cp /usr/local/php/etc/php-fpm.d/www.conf.default /usr/local/php/etc/php-fpm.d/www.conf \\\n && easy_install supervisor \\\n && mkdir -p /var/{log/supervisor,run/{sshd,supervisord}} \\\n && yum remove -y gcc gcc-c++ autoconf automake libtool make cmake \\\n && yum clean all \\\n && rm -rf /tmp/* /var/cache/{yum,ldconfig} /etc/my.cnf{,.d} \\\n && mkdir -p --mode=0755 /var/cache/{yum,ldconfig} \\\n && find /var/log -type f -delete \\\n && rm -rf /home/nginx-php \\\n && chown -R www:www /data/www\n# Add supervisord conf\nADD supervisord.conf /etc/\n# Create web folder\n#  WEB Folder: /data/www\n#  SSL Folder: /usr/local/nginx/conf/ssl\n#  Vhost Folder: /usr/local/nginx/conf/vhost\n#  php extfile ini Folder: /usr/local/php/etc/conf.d\n#  php extfile Folder: /data/phpextfile\nVOLUME [\"/data/www\", \"/usr/local/nginx/conf/ssl\", \"/usr/local/nginx/conf/vhost\", \"/data/phpextini\", \"/data/phpextfile\"]\nADD index.php /data/www/\n# Add ext setting to image\n# ADD extini/ /data/phpextini/\n# ADD extfile/ /data/phpextfile/\n# Update nginx config\nADD nginx.conf /usr/local/nginx/conf/\n# Start\nADD start.sh /\nRUN chmod +x /start.sh\n# Set port\nEXPOSE 80/tcp 443/tcp\n# Start it\nENTRYPOINT [\"/start.sh\"]\n# Start web server\n# CMD [\"/bin/bash\", \"/start.sh\"]\n","injectedSmells":[],"originalDockerfileHash":"ef95f6b4430de3c34929e967b9cd80b3","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM centos:7\nMAINTAINER Skiychan <dev@skiy.net>\nENV NGINX_VERSION=\"1.17.0\"\nENV PHP_VERSION=\"7.2.19\"\nRUN set -x \\\n && yum install -y gcc gcc-c++ autoconf automake libtool make cmake \\\n && rpm -ivh http://dl.fedoraproject.org/pub/epel/6/i386/epel-release-6-8.noarch.rpm \\\n && yum install -y zlib zlib-devel openssl openssl-devel pcre-devel libxml2 libxml2-devel libcurl libcurl-devel libpng-devel libjpeg-devel freetype-devel libmcrypt-devel openssh-server python-setuptools \\\n && mkdir -p /data/{www,phpextini,phpextfile} \\\n && useradd -r -s /sbin/nologin -d /data/www -m -k no www \\\n && mkdir -p /home/nginx-php \\\n && cd $_ \\\n && curl -Lk http://nginx.org/download/nginx-$NGINX_VERSION.tar.gz | gunzip | tar x -C /home/nginx-php \\\n && curl -Lk http://php.net/distributions/php-$PHP_VERSION.tar.gz | gunzip | tar x -C /home/nginx-php \\\n && cd /home/nginx-php/nginx-$NGINX_VERSION \\\n && ./configure --prefix=/usr/local/nginx --user=www --group=www --error-log-path=/var/log/nginx_error.log --http-log-path=/var/log/nginx_access.log --pid-path=/var/run/nginx.pid --with-pcre --with-http_ssl_module --without-mail_pop3_module --without-mail_imap_module --with-http_gzip_static_module \\\n && make \\\n && make install \\\n && cd /home/nginx-php/php-$PHP_VERSION \\\n && ./configure --prefix=/usr/local/php --with-config-file-path=/usr/local/php/etc --with-config-file-scan-dir=/data/phpextini --with-fpm-user=www --with-fpm-group=www --with-mysqli --with-pdo-mysql --with-openssl --with-gd --with-iconv --with-zlib --with-gettext --with-curl --with-png-dir --with-jpeg-dir --with-freetype-dir --with-xmlrpc --with-mhash --enable-fpm --enable-xml --enable-shmop --enable-sysvsem --enable-inline-optimization --enable-mbregex --enable-mbstring --enable-ftp --enable-mysqlnd --enable-pcntl --enable-sockets --enable-zip --enable-soap --enable-session --enable-opcache --enable-bcmath --enable-exif --enable-fileinfo --disable-rpath --enable-ipv6 --disable-debug --without-pear \\\n && make \\\n && make install \\\n && cd /home/nginx-php/php-$PHP_VERSION \\\n && cp php.ini-production /usr/local/php/etc/php.ini \\\n && cp /usr/local/php/etc/php-fpm.conf.default /usr/local/php/etc/php-fpm.conf \\\n && cp /usr/local/php/etc/php-fpm.d/www.conf.default /usr/local/php/etc/php-fpm.d/www.conf \\\n && easy_install supervisor \\\n && mkdir -p /var/{log/supervisor,run/{sshd,supervisord}} \\\n && yum remove -y gcc gcc-c++ autoconf automake libtool make cmake \\\n && yum clean all \\\n && rm -rf /tmp/* /var/cache/{yum,ldconfig} /etc/my.cnf{,.d} \\\n && mkdir -p --mode=0755 /var/cache/{yum,ldconfig} \\\n && find /var/log -type f -delete \\\n && rm -rf /home/nginx-php \\\n && chown -R www:www /data/www\n#  Add supervisord conf\nADD supervisord.conf /etc/\n#  Create web folder\n#   WEB Folder: /data/www\n#   SSL Folder: /usr/local/nginx/conf/ssl\n#   Vhost Folder: /usr/local/nginx/conf/vhost\n#   php extfile ini Folder: /usr/local/php/etc/conf.d\n#   php extfile Folder: /data/phpextfile\nVOLUME [\"/data/www\", \"/usr/local/nginx/conf/ssl\", \"/usr/local/nginx/conf/vhost\", \"/data/phpextini\", \"/data/phpextfile\"]\nADD index.php /data/www/\n#  Add ext setting to image\n#  ADD extini/ /data/phpextini/\n#  ADD extfile/ /data/phpextfile/\n#  Update nginx config\nADD nginx.conf /usr/local/nginx/conf/\n#  Start\nADD start.sh /\nRUN chmod +x /start.sh\n#  Set port\nEXPOSE 80/tcp 443/tcp\n#  Start it\nENTRYPOINT [\"/start.sh\"]\n#  Start web server\n#  CMD [\"/bin/bash\", \"/start.sh\"]\n","originalDockerfileUglifiedHash":"fea3a098a0dcd8c62dd2a18319bd1683","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/ad750236e2b24d6080268df2588db15e4bfcd271.dockerfile"}