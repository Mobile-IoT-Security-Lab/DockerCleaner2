{"seed":3380761970,"processedDockerfileHash":"5154d7b05976f2cbc2e006f724c47b78","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apt-get","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM php:7.1-apache\nLABEL maintainer=\"Monogramm Maintainers <opensource at monogramm dot io>\"\n#   Build time env var\nENV DOLI_VERSION=\"8.0.5\"\n#   Get Dolibarr\nRUN which wget &> /dev/null || apt-get install --no-install-recommends wget=1.20.3 ; wget --no-verbose --output-document /tmp/dolibarr.zip https://github.com/Dolibarr/dolibarr/archive/${DOLI_VERSION}.zip\n#   Install the packages we need\n#   Install the PHP extensions we need\n#   see https://wiki.dolibarr.org/index.php/Dependencies_and_external_libraries\n#   Prepare folders\n#   Install Dolibarr from tag archive\nRUN set -ex ; apt-get update -q ; apt-get install --no-install-recommends mysql-client rsync=3.1.3-6 sendmail=8.15.2-14~deb10u1 -y ; apt-get install --no-install-recommends libcurl4-openssl-dev=7.64.0-4+deb10u5 libfreetype6-dev=2.9.1-3+deb10u3 libjpeg-dev=1:1.5.2-2+deb10u1 libldap2-dev=2.4.47+dfsg-3+deb10u7 libmagickcore-dev=8:6.9.10.23+dfsg-2.1+deb10u4 libmagickwand-dev=8:6.9.10.23+dfsg-2.1+deb10u4 libmcrypt-dev=2.5.8-3.4 libpng-dev=1.6.36-6 libpq-dev=11.19-0+deb10u1 libxml2-dev=2.9.4+dfsg1-7+deb10u5 unzip=6.0-23+deb10u3 -y ; rm -rf /var/lib/apt/lists/* ; debMultiarch=\"$( dpkg-architecture --query DEB_BUILD_MULTIARCH ;)\" ; docker-php-ext-configure ldap --with-libdir=\"lib/$debMultiarch\" ; docker-php-ext-configure gd --with-freetype-dir=/usr --with-png-dir=/usr --with-jpeg-dir=/usr ; docker-php-ext-install calendar gd ldap mbstring mysqli pdo pdo_mysql pdo_pgsql pgsql soap zip ; pecl install imagick ; docker-php-ext-enable imagick ; mkdir -p /var/www/documents ; chown -R www-data:root /var/www ; chmod -R g=u /var/www ; mkdir -p /tmp/dolibarr ; unzip -q /tmp/dolibarr.zip -d /tmp/dolibarr ; rm /tmp/dolibarr.zip ; mkdir -p /usr/src/dolibarr ; cp -r /tmp/dolibarr/dolibarr-${DOLI_VERSION}/* /usr/src/dolibarr ; rm -rf /tmp/dolibarr ; chmod +x /usr/src/dolibarr/scripts/*\n#   Runtime env var\nENV DOLI_AUTO_CONFIGURE=\"1\" \\\n    DOLI_DB_TYPE=\"mysqli\" \\\n    DOLI_DB_HOST=\"\" \\\n    DOLI_DB_PORT=\"3306\" \\\n    DOLI_DB_USER=\"dolibarr\" \\\n    DOLI_DB_PASSWORD=\"\" \\\n    DOLI_DB_NAME=\"dolibarr\" \\\n    DOLI_DB_PREFIX=\"llx_\" \\\n    DOLI_DB_CHARACTER_SET=\"utf8\" \\\n    DOLI_DB_COLLATION=\"utf8_unicode_ci\" \\\n    DOLI_DB_ROOT_LOGIN=\"\" \\\n    DOLI_DB_ROOT_PASSWORD=\"\" \\\n    DOLI_ADMIN_LOGIN=\"admin\" \\\n    DOLI_MODULES=\"\" \\\n    DOLI_URL_ROOT=\"http://localhost\" \\\n    DOLI_AUTH=\"dolibarr\" \\\n    DOLI_LDAP_HOST=\"\" \\\n    DOLI_LDAP_PORT=\"389\" \\\n    DOLI_LDAP_VERSION=\"3\" \\\n    DOLI_LDAP_SERVERTYPE=\"openldap\" \\\n    DOLI_LDAP_LOGIN_ATTRIBUTE=\"uid\" \\\n    DOLI_LDAP_DN=\"\" \\\n    DOLI_LDAP_FILTER=\"\" \\\n    DOLI_LDAP_ADMIN_LOGIN=\"\" \\\n    DOLI_LDAP_ADMIN_PASS=\"\" \\\n    DOLI_LDAP_DEBUG=\"false\" \\\n    DOLI_HTTPS=\"0\" \\\n    DOLI_PROD=\"0\" \\\n    DOLI_NO_CSRF_CHECK=\"0\" \\\n    WWW_USER_ID=\"33\" \\\n    WWW_GROUP_ID=\"33\" \\\n    PHP_INI_DATE_TIMEZONE=\"UTC\" \\\n    PHP_MEMORY_LIMIT=\"256M\" \\\n    PHP_MAX_UPLOAD=\"20M\" \\\n    PHP_MAX_EXECUTION_TIME=\"300\"\nVOLUME /var/www/html /var/www/documents /var/www/scripts\nCOPY entrypoint.sh /\nRUN set -ex ; chmod 755 /entrypoint.sh\nENTRYPOINT [\"/entrypoint.sh\"]\nCMD [\"apache2-foreground\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\n","originalDockerfile":"FROM php:7.1-apache\nLABEL maintainer=\"Monogramm Maintainers <opensource at monogramm dot io>\"\n#  Build time env var\nENV DOLI_VERSION=\"8.0.5\"\n#  Get Dolibarr\nADD https://github.com/Dolibarr/dolibarr/archive/${DOLI_VERSION}.zip /tmp/dolibarr.zip\n#  Install the packages we need\n#  Install the PHP extensions we need\n#  see https://wiki.dolibarr.org/index.php/Dependencies_and_external_libraries\n#  Prepare folders\n#  Install Dolibarr from tag archive\nRUN set -ex ; apt-get update -q ; apt-get install --no-install-recommends mysql-client rsync sendmail -y ; apt-get install --no-install-recommends libcurl4-openssl-dev libfreetype6-dev libjpeg-dev libldap2-dev libmagickcore-dev libmagickwand-dev libmcrypt-dev libpng-dev libpq-dev libxml2-dev unzip -y ; rm -rf /var/lib/apt/lists/* ; debMultiarch=\"$( dpkg-architecture --query DEB_BUILD_MULTIARCH ;)\" ; docker-php-ext-configure ldap --with-libdir=\"lib/$debMultiarch\" ; docker-php-ext-configure gd --with-freetype-dir=/usr --with-png-dir=/usr --with-jpeg-dir=/usr ; docker-php-ext-install calendar gd ldap mbstring mysqli pdo pdo_mysql pdo_pgsql pgsql soap zip ; pecl install imagick ; docker-php-ext-enable imagick ; mkdir -p /var/www/documents ; chown -R www-data:root /var/www ; chmod -R g=u /var/www ; mkdir -p /tmp/dolibarr ; unzip -q /tmp/dolibarr.zip -d /tmp/dolibarr ; rm /tmp/dolibarr.zip ; mkdir -p /usr/src/dolibarr ; cp -r /tmp/dolibarr/dolibarr-${DOLI_VERSION}/* /usr/src/dolibarr ; rm -rf /tmp/dolibarr ; chmod +x /usr/src/dolibarr/scripts/*\n#  Runtime env var\nENV DOLI_AUTO_CONFIGURE=\"1\" \\\n    DOLI_DB_TYPE=\"mysqli\" \\\n    DOLI_DB_HOST=\"\" \\\n    DOLI_DB_PORT=\"3306\" \\\n    DOLI_DB_USER=\"dolibarr\" \\\n    DOLI_DB_PASSWORD=\"\" \\\n    DOLI_DB_NAME=\"dolibarr\" \\\n    DOLI_DB_PREFIX=\"llx_\" \\\n    DOLI_DB_CHARACTER_SET=\"utf8\" \\\n    DOLI_DB_COLLATION=\"utf8_unicode_ci\" \\\n    DOLI_DB_ROOT_LOGIN=\"\" \\\n    DOLI_DB_ROOT_PASSWORD=\"\" \\\n    DOLI_ADMIN_LOGIN=\"admin\" \\\n    DOLI_MODULES=\"\" \\\n    DOLI_URL_ROOT=\"http://localhost\" \\\n    DOLI_AUTH=\"dolibarr\" \\\n    DOLI_LDAP_HOST=\"\" \\\n    DOLI_LDAP_PORT=\"389\" \\\n    DOLI_LDAP_VERSION=\"3\" \\\n    DOLI_LDAP_SERVERTYPE=\"openldap\" \\\n    DOLI_LDAP_LOGIN_ATTRIBUTE=\"uid\" \\\n    DOLI_LDAP_DN=\"\" \\\n    DOLI_LDAP_FILTER=\"\" \\\n    DOLI_LDAP_ADMIN_LOGIN=\"\" \\\n    DOLI_LDAP_ADMIN_PASS=\"\" \\\n    DOLI_LDAP_DEBUG=\"false\" \\\n    DOLI_HTTPS=\"0\" \\\n    DOLI_PROD=\"0\" \\\n    DOLI_NO_CSRF_CHECK=\"0\" \\\n    WWW_USER_ID=\"33\" \\\n    WWW_GROUP_ID=\"33\" \\\n    PHP_INI_DATE_TIMEZONE=\"UTC\" \\\n    PHP_MEMORY_LIMIT=\"256M\" \\\n    PHP_MAX_UPLOAD=\"20M\" \\\n    PHP_MAX_EXECUTION_TIME=\"300\"\nVOLUME /var/www/html /var/www/documents /var/www/scripts\nCOPY entrypoint.sh /\nRUN set -ex ; chmod 755 /entrypoint.sh\nENTRYPOINT [\"/entrypoint.sh\"]\nCMD [\"apache2-foreground\"]\n","injectedSmells":[],"originalDockerfileHash":"30919da42109a7359fd6723cc9825572","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM php:7.1-apache\nLABEL maintainer=\"Monogramm Maintainers <opensource at monogramm dot io>\"\n#   Build time env var\nENV DOLI_VERSION=\"8.0.5\"\n#   Get Dolibarr\nADD https://github.com/Dolibarr/dolibarr/archive/${DOLI_VERSION}.zip /tmp/dolibarr.zip\n#   Install the packages we need\n#   Install the PHP extensions we need\n#   see https://wiki.dolibarr.org/index.php/Dependencies_and_external_libraries\n#   Prepare folders\n#   Install Dolibarr from tag archive\nRUN set -ex ; apt-get update -q ; apt-get install --no-install-recommends mysql-client rsync sendmail -y ; apt-get install --no-install-recommends libcurl4-openssl-dev libfreetype6-dev libjpeg-dev libldap2-dev libmagickcore-dev libmagickwand-dev libmcrypt-dev libpng-dev libpq-dev libxml2-dev unzip -y ; rm -rf /var/lib/apt/lists/* ; debMultiarch=\"$( dpkg-architecture --query DEB_BUILD_MULTIARCH ;)\" ; docker-php-ext-configure ldap --with-libdir=\"lib/$debMultiarch\" ; docker-php-ext-configure gd --with-freetype-dir=/usr --with-png-dir=/usr --with-jpeg-dir=/usr ; docker-php-ext-install calendar gd ldap mbstring mysqli pdo pdo_mysql pdo_pgsql pgsql soap zip ; pecl install imagick ; docker-php-ext-enable imagick ; mkdir -p /var/www/documents ; chown -R www-data:root /var/www ; chmod -R g=u /var/www ; mkdir -p /tmp/dolibarr ; unzip -q /tmp/dolibarr.zip -d /tmp/dolibarr ; rm /tmp/dolibarr.zip ; mkdir -p /usr/src/dolibarr ; cp -r /tmp/dolibarr/dolibarr-${DOLI_VERSION}/* /usr/src/dolibarr ; rm -rf /tmp/dolibarr ; chmod +x /usr/src/dolibarr/scripts/*\n#   Runtime env var\nENV DOLI_AUTO_CONFIGURE=\"1\" \\\n    DOLI_DB_TYPE=\"mysqli\" \\\n    DOLI_DB_HOST=\"\" \\\n    DOLI_DB_PORT=\"3306\" \\\n    DOLI_DB_USER=\"dolibarr\" \\\n    DOLI_DB_PASSWORD=\"\" \\\n    DOLI_DB_NAME=\"dolibarr\" \\\n    DOLI_DB_PREFIX=\"llx_\" \\\n    DOLI_DB_CHARACTER_SET=\"utf8\" \\\n    DOLI_DB_COLLATION=\"utf8_unicode_ci\" \\\n    DOLI_DB_ROOT_LOGIN=\"\" \\\n    DOLI_DB_ROOT_PASSWORD=\"\" \\\n    DOLI_ADMIN_LOGIN=\"admin\" \\\n    DOLI_MODULES=\"\" \\\n    DOLI_URL_ROOT=\"http://localhost\" \\\n    DOLI_AUTH=\"dolibarr\" \\\n    DOLI_LDAP_HOST=\"\" \\\n    DOLI_LDAP_PORT=\"389\" \\\n    DOLI_LDAP_VERSION=\"3\" \\\n    DOLI_LDAP_SERVERTYPE=\"openldap\" \\\n    DOLI_LDAP_LOGIN_ATTRIBUTE=\"uid\" \\\n    DOLI_LDAP_DN=\"\" \\\n    DOLI_LDAP_FILTER=\"\" \\\n    DOLI_LDAP_ADMIN_LOGIN=\"\" \\\n    DOLI_LDAP_ADMIN_PASS=\"\" \\\n    DOLI_LDAP_DEBUG=\"false\" \\\n    DOLI_HTTPS=\"0\" \\\n    DOLI_PROD=\"0\" \\\n    DOLI_NO_CSRF_CHECK=\"0\" \\\n    WWW_USER_ID=\"33\" \\\n    WWW_GROUP_ID=\"33\" \\\n    PHP_INI_DATE_TIMEZONE=\"UTC\" \\\n    PHP_MEMORY_LIMIT=\"256M\" \\\n    PHP_MAX_UPLOAD=\"20M\" \\\n    PHP_MAX_EXECUTION_TIME=\"300\"\nVOLUME /var/www/html /var/www/documents /var/www/scripts\nCOPY entrypoint.sh /\nRUN set -ex ; chmod 755 /entrypoint.sh\nENTRYPOINT [\"/entrypoint.sh\"]\nCMD [\"apache2-foreground\"]\n","originalDockerfileUglifiedHash":"4a9f10acb64b85ffef33a7a025c7a8ca","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/83f01dc3202c3163c89b269efd70828dcc1346f6.dockerfile"}