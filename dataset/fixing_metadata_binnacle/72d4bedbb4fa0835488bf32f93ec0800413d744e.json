{"seed":334679119,"processedDockerfileHash":"2d8ed4b43a5bab6099d0e3d5a230923c","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["do-not-use-apt-get-update-alone","have-a-healthcheck","have-a-user"],"processedDockerfile":"#   base-image\nFROM nvidia/cuda:9.0-cudnn7-devel-ubuntu16.04\nMAINTAINER Hantao Zhang <zht1994@mail.ustc.edu.cn>\n#   install dependency packages\nRUN sed -i 's/archive.ubuntu.com/mirrors.ustc.edu.cn/g' /etc/apt/sources.list \\\n && APT_INSTALL=\"apt-get install -y --no-install-recommends\" \\\n && PIP_INSTALL=\"python -m pip --no-cache-dir install --upgrade\" \\\n && GIT_CLONE=\"git clone --depth 10\" \\\n && rm -rf /var/lib/apt/lists/* /etc/apt/sources.list.d/cuda.list /etc/apt/sources.list.d/nvidia-ml.list \\\n && : \\\n && DEBIAN_FRONTEND=noninteractive $APT_INSTALL autossh build-essential bzip2 ca-certificates cmake curl git graphviz htop libmysqlclient-dev liblapack-dev libopenblas-dev libopencv-dev locales openssh-client openssh-server tmux unzip vim wget zip\nRUN sed -i 's/archive.ubuntu.com/mirrors.ustc.edu.cn/g' /etc/apt/sources.list \\\n && APT_INSTALL=\"apt-get install -y --no-install-recommends\" \\\n && PIP_INSTALL=\"python -m pip --no-cache-dir install --upgrade\" \\\n && GIT_CLONE=\"git clone --depth 10\" \\\n && DEBIAN_FRONTEND=noninteractive $APT_INSTALL software-properties-common \\\n && add-apt-repository ppa:deadsnakes/ppa \\\n && : \\\n && DEBIAN_FRONTEND=noninteractive $APT_INSTALL python3.6 python3.6-dev \\\n && wget -O ~/get-pip.py https://bootstrap.pypa.io/get-pip.py \\\n && python3.6 ~/get-pip.py \\\n && ln -s /usr/bin/python3.6 /usr/local/bin/python3 \\\n && ln -s /usr/bin/python3.6 /usr/local/bin/python \\\n && pip3 install -i https://mirrors.ustc.edu.cn/pypi/web/simple setuptools \\\n && pip3 install -i https://mirrors.ustc.edu.cn/pypi/web/simple numpy scipy pandas scikit-learn matplotlib Cython\nRUN pip3 install -i https://mirrors.ustc.edu.cn/pypi/web/simple backcall certifi chardet cycler decorator easydict graphviz idna imageio ipython ipython-genutils jedi kiwisolver mock opencv-python parso pexpect pickleshare Pillow pipenv prompt-toolkit psutil ptyprocess pyarrow Pygments pyparsing python-dateutil pytz pyyaml pyzmq requests six tornado tqdm traitlets urllib3==1.24.2 virtualenv virtualenv-clone wcwidth wheel\n#   Install a patched cocotools for python3\nRUN pip3 install -i https://mirrors.ustc.edu.cn/pypi/web/simple 'git+https://github.com/RogerChern/cocoapi.git#subdirectory=PythonAPI'\n#   build mxnet from source\nCOPY ./mxnet /tmp/mxnet\nRUN cd /tmp/mxnet \\\n && echo \"USE_OPENCV = 0\" >> ./config.mk \\\n && echo \"USE_MKLDNN = 0\" >> ./config.mk \\\n && echo \"USE_BLAS = openblas\" >> ./config.mk \\\n && echo \"USE_CUDA = 1\" >> ./config.mk \\\n && echo \"USE_CUDA_PATH = /usr/local/cuda\" >> ./config.mk \\\n && echo \"USE_CUDNN = 1\" >> ./config.mk \\\n && echo \"USE_NCCL = 1\" >> ./config.mk \\\n && echo \"USE_DIST_KVSTORE = 1\" >> ./config.mk \\\n && echo \"CUDA_ARCH = -gencode arch=compute_50,code=sm_50 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_70,code=sm_70\" >> ./config.mk \\\n && make -j40 \\\n && cd python \\\n && python3 setup.py install \\\n && rm -rf /tmp/mxnet\n#   clean-up\nRUN ldconfig \\\n && apt-get clean \\\n && apt-get autoremove\n#  rm -rf mxnet\n#  rm -rf /var/lib/apt/lists/* /tmp/* ~/*\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  base-image\nFROM nvidia/cuda:9.0-cudnn7-devel-ubuntu16.04\nMAINTAINER Hantao Zhang <zht1994@mail.ustc.edu.cn>\n#  install dependency packages\nRUN sed -i 's/archive.ubuntu.com/mirrors.ustc.edu.cn/g' /etc/apt/sources.list \\\n && APT_INSTALL=\"apt-get install -y --no-install-recommends\" \\\n && PIP_INSTALL=\"python -m pip --no-cache-dir install --upgrade\" \\\n && GIT_CLONE=\"git clone --depth 10\" \\\n && rm -rf /var/lib/apt/lists/* /etc/apt/sources.list.d/cuda.list /etc/apt/sources.list.d/nvidia-ml.list \\\n && apt-get update \\\n && DEBIAN_FRONTEND=noninteractive $APT_INSTALL autossh build-essential bzip2 ca-certificates cmake curl git graphviz htop libmysqlclient-dev liblapack-dev libopenblas-dev libopencv-dev locales openssh-client openssh-server tmux unzip vim wget zip\nRUN sed -i 's/archive.ubuntu.com/mirrors.ustc.edu.cn/g' /etc/apt/sources.list \\\n && APT_INSTALL=\"apt-get install -y --no-install-recommends\" \\\n && PIP_INSTALL=\"python -m pip --no-cache-dir install --upgrade\" \\\n && GIT_CLONE=\"git clone --depth 10\" \\\n && DEBIAN_FRONTEND=noninteractive $APT_INSTALL software-properties-common \\\n && add-apt-repository ppa:deadsnakes/ppa \\\n && apt-get update \\\n && DEBIAN_FRONTEND=noninteractive $APT_INSTALL python3.6 python3.6-dev \\\n && wget -O ~/get-pip.py https://bootstrap.pypa.io/get-pip.py \\\n && python3.6 ~/get-pip.py \\\n && ln -s /usr/bin/python3.6 /usr/local/bin/python3 \\\n && ln -s /usr/bin/python3.6 /usr/local/bin/python \\\n && pip3 install -i https://mirrors.ustc.edu.cn/pypi/web/simple setuptools \\\n && pip3 install -i https://mirrors.ustc.edu.cn/pypi/web/simple numpy scipy pandas scikit-learn matplotlib Cython\nRUN pip3 install -i https://mirrors.ustc.edu.cn/pypi/web/simple backcall certifi chardet cycler decorator easydict graphviz idna imageio ipython ipython-genutils jedi kiwisolver mock opencv-python parso pexpect pickleshare Pillow pipenv prompt-toolkit psutil ptyprocess pyarrow Pygments pyparsing python-dateutil pytz pyyaml pyzmq requests six tornado tqdm traitlets urllib3==1.24.2 virtualenv virtualenv-clone wcwidth wheel\n#  Install a patched cocotools for python3\nRUN pip3 install -i https://mirrors.ustc.edu.cn/pypi/web/simple 'git+https://github.com/RogerChern/cocoapi.git#subdirectory=PythonAPI'\n#  build mxnet from source\nCOPY ./mxnet /tmp/mxnet\nRUN cd /tmp/mxnet \\\n && echo \"USE_OPENCV = 0\" >> ./config.mk \\\n && echo \"USE_MKLDNN = 0\" >> ./config.mk \\\n && echo \"USE_BLAS = openblas\" >> ./config.mk \\\n && echo \"USE_CUDA = 1\" >> ./config.mk \\\n && echo \"USE_CUDA_PATH = /usr/local/cuda\" >> ./config.mk \\\n && echo \"USE_CUDNN = 1\" >> ./config.mk \\\n && echo \"USE_NCCL = 1\" >> ./config.mk \\\n && echo \"USE_DIST_KVSTORE = 1\" >> ./config.mk \\\n && echo \"CUDA_ARCH = -gencode arch=compute_50,code=sm_50 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_70,code=sm_70\" >> ./config.mk \\\n && make -j40 \\\n && cd python \\\n && python3 setup.py install \\\n && rm -rf /tmp/mxnet\n#  clean-up\nRUN ldconfig \\\n && apt-get clean \\\n && apt-get autoremove\n# rm -rf mxnet\n# rm -rf /var/lib/apt/lists/* /tmp/* ~/*\n","injectedSmells":[],"originalDockerfileHash":"b8e129f587eef02f73a5eb6913f2cc4f","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   base-image\nFROM nvidia/cuda:9.0-cudnn7-devel-ubuntu16.04\nMAINTAINER Hantao Zhang <zht1994@mail.ustc.edu.cn>\n#   install dependency packages\nRUN sed -i 's/archive.ubuntu.com/mirrors.ustc.edu.cn/g' /etc/apt/sources.list \\\n && APT_INSTALL=\"apt-get install -y --no-install-recommends\" \\\n && PIP_INSTALL=\"python -m pip --no-cache-dir install --upgrade\" \\\n && GIT_CLONE=\"git clone --depth 10\" \\\n && rm -rf /var/lib/apt/lists/* /etc/apt/sources.list.d/cuda.list /etc/apt/sources.list.d/nvidia-ml.list \\\n && apt-get update \\\n && DEBIAN_FRONTEND=noninteractive $APT_INSTALL autossh build-essential bzip2 ca-certificates cmake curl git graphviz htop libmysqlclient-dev liblapack-dev libopenblas-dev libopencv-dev locales openssh-client openssh-server tmux unzip vim wget zip\nRUN sed -i 's/archive.ubuntu.com/mirrors.ustc.edu.cn/g' /etc/apt/sources.list \\\n && APT_INSTALL=\"apt-get install -y --no-install-recommends\" \\\n && PIP_INSTALL=\"python -m pip --no-cache-dir install --upgrade\" \\\n && GIT_CLONE=\"git clone --depth 10\" \\\n && DEBIAN_FRONTEND=noninteractive $APT_INSTALL software-properties-common \\\n && add-apt-repository ppa:deadsnakes/ppa \\\n && apt-get update \\\n && DEBIAN_FRONTEND=noninteractive $APT_INSTALL python3.6 python3.6-dev \\\n && wget -O ~/get-pip.py https://bootstrap.pypa.io/get-pip.py \\\n && python3.6 ~/get-pip.py \\\n && ln -s /usr/bin/python3.6 /usr/local/bin/python3 \\\n && ln -s /usr/bin/python3.6 /usr/local/bin/python \\\n && pip3 install -i https://mirrors.ustc.edu.cn/pypi/web/simple setuptools \\\n && pip3 install -i https://mirrors.ustc.edu.cn/pypi/web/simple numpy scipy pandas scikit-learn matplotlib Cython\nRUN pip3 install -i https://mirrors.ustc.edu.cn/pypi/web/simple backcall certifi chardet cycler decorator easydict graphviz idna imageio ipython ipython-genutils jedi kiwisolver mock opencv-python parso pexpect pickleshare Pillow pipenv prompt-toolkit psutil ptyprocess pyarrow Pygments pyparsing python-dateutil pytz pyyaml pyzmq requests six tornado tqdm traitlets urllib3==1.24.2 virtualenv virtualenv-clone wcwidth wheel\n#   Install a patched cocotools for python3\nRUN pip3 install -i https://mirrors.ustc.edu.cn/pypi/web/simple 'git+https://github.com/RogerChern/cocoapi.git#subdirectory=PythonAPI'\n#   build mxnet from source\nCOPY ./mxnet /tmp/mxnet\nRUN cd /tmp/mxnet \\\n && echo \"USE_OPENCV = 0\" >> ./config.mk \\\n && echo \"USE_MKLDNN = 0\" >> ./config.mk \\\n && echo \"USE_BLAS = openblas\" >> ./config.mk \\\n && echo \"USE_CUDA = 1\" >> ./config.mk \\\n && echo \"USE_CUDA_PATH = /usr/local/cuda\" >> ./config.mk \\\n && echo \"USE_CUDNN = 1\" >> ./config.mk \\\n && echo \"USE_NCCL = 1\" >> ./config.mk \\\n && echo \"USE_DIST_KVSTORE = 1\" >> ./config.mk \\\n && echo \"CUDA_ARCH = -gencode arch=compute_50,code=sm_50 -gencode arch=compute_60,code=sm_60 -gencode arch=compute_70,code=sm_70\" >> ./config.mk \\\n && make -j40 \\\n && cd python \\\n && python3 setup.py install \\\n && rm -rf /tmp/mxnet\n#   clean-up\nRUN ldconfig \\\n && apt-get clean \\\n && apt-get autoremove\n#  rm -rf mxnet\n#  rm -rf /var/lib/apt/lists/* /tmp/* ~/*\n","originalDockerfileUglifiedHash":"3ae08954238dc968fa22d9b8d281cc40","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/72d4bedbb4fa0835488bf32f93ec0800413d744e.dockerfile"}