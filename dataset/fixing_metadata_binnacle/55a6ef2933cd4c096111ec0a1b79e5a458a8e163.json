{"seed":3861674798,"processedDockerfileHash":"52a37a13b53eccfbc8ddf107fda3d57e","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-copy-instead-of-add","have-a-user"],"processedDockerfile":"FROM centos:7.6.1810\nARG RELEASE_VERSION=\"2.6.0\"\n#   ------------------------------------------------------------------------------\n#   - Import the RPM GPG keys for repositories\n#   - Base install of required packages\n#   - Install supervisord (used to run more than a single process)\n#   - Install supervisor-stdout to allow output of services started by\n#    supervisord to be easily inspected with \"docker logs\".\n#   ------------------------------------------------------------------------------\nRUN rpm --rebuilddb \\\n && rpm --import http://mirror.centos.org/centos/RPM-GPG-KEY-CentOS-7 \\\n && rpm --import https://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-7 \\\n && rpm --import https://dl.iuscommunity.org/pub/ius/IUS-COMMUNITY-GPG-KEY \\\n && yum -y install --setopt=tsflags=nodocs --disableplugin=fastestmirror centos-release-scl centos-release-scl-rh epel-release https://centos7.iuscommunity.org/ius-release.rpm \\\n && yum -y install --setopt=tsflags=nodocs --disableplugin=fastestmirror inotify-tools-3.14-8.el7 openssh-clients-7.4p1-16.el7 openssh-server-7.4p1-16.el7 openssl-1.0.2k-16.el7 python-setuptools-0.9.8-7.el7 sudo-1.8.23-3.el7 yum-plugin-versionlock-1.1.31-50.el7 \\\n && yum versionlock add inotify-tools openssh openssh-server openssh-clients python-setuptools sudo yum-plugin-versionlock \\\n && yum clean all \\\n && easy_install 'supervisor == 4.0.3' 'supervisor-stdout == 0.1.1' \\\n && mkdir -p /var/log/supervisor/ \\\n && rm -rf /etc/ld.so.cache \\\n && rm -rf /sbin/sln \\\n && rm -rf /usr/{{lib,share}/locale,share/{man,doc,info,cracklib,i18n},{lib,lib64}/gconv,bin/localedef,sbin/build-locale-archive} \\\n && rm -rf /{root,tmp,var/cache/{ldconfig,yum}}/* \\\n && > /etc/sysconfig/i18n\n#   ------------------------------------------------------------------------------\n#   Copy files into place\n#   ------------------------------------------------------------------------------\nCOPY src /\n#   ------------------------------------------------------------------------------\n#   Provisioning\n#   - UTC Timezone\n#   - Networking\n#   - Configure SSH defaults for non-root public key authentication\n#   - Enable the wheel sudoers group\n#   - Replace placeholders with values in systemd service unit template\n#   - Set permissions\n#   ------------------------------------------------------------------------------\nRUN ln -sf /usr/share/zoneinfo/UTC /etc/localtime \\\n && echo \"NETWORKING=yes\" > /etc/sysconfig/network \\\n && sed -i -e 's~^PasswordAuthentication yes~PasswordAuthentication no~g' -e 's~^#PermitRootLogin yes~PermitRootLogin no~g' -e 's~^#UseDNS yes~UseDNS no~g' -e 's~^\\(.*\\)/usr/libexec/openssh/sftp-server$~\\1internal-sftp~g' /etc/ssh/sshd_config \\\n && sed -i -e 's~^# %wheel\\tALL=(ALL)\\tALL~%wheel\\tALL=(ALL) ALL~g' -e 's~\\(.*\\) requiretty$~#\\1requiretty~' /etc/sudoers \\\n && sed -i -e \"s~{{RELEASE_VERSION}}~${RELEASE_VERSION}~g\" /etc/systemd/system/centos-ssh@.service \\\n && chmod 644 /etc/{supervisord.conf,supervisord.d/{20-sshd-bootstrap,50-sshd-wrapper}.conf} \\\n && chmod 700 /usr/{bin/healthcheck,sbin/{scmi,sshd-{bootstrap,wrapper},system-{timezone,timezone-wrapper}}}\nEXPOSE 22/tcp\n#   ------------------------------------------------------------------------------\n#   Set default environment variables\n#   ------------------------------------------------------------------------------\nENV ENABLE_SSHD_BOOTSTRAP=\"true\" \\\n    ENABLE_SSHD_WRAPPER=\"true\" \\\n    ENABLE_SUPERVISOR_STDOUT=\"false\" \\\n    SSH_AUTHORIZED_KEYS=\"\" \\\n    SSH_CHROOT_DIRECTORY=\"%h\" \\\n    SSH_INHERIT_ENVIRONMENT=\"false\" \\\n    SSH_PASSWORD_AUTHENTICATION=\"false\" \\\n    SSH_SUDO=\"ALL=(ALL) ALL\" \\\n    SSH_USER=\"app-admin\" \\\n    SSH_USER_FORCE_SFTP=\"false\" \\\n    SSH_USER_HOME=\"/home/%u\" \\\n    SSH_USER_ID=\"500:500\" \\\n    SSH_USER_PASSWORD=\"\" \\\n    SSH_USER_PASSWORD_HASHED=\"false\" \\\n    SSH_USER_PRIVATE_KEY=\"\" \\\n    SSH_USER_SHELL=\"/bin/bash\" \\\n    SYSTEM_TIMEZONE=\"UTC\"\n#   ------------------------------------------------------------------------------\n#   Set image metadata\n#   ------------------------------------------------------------------------------\nLABEL maintainer=\"James Deathe <james.deathe@gmail.com>\" \\\n      install=\"docker run --rm --privileged --volume /:/media/root jdeathe/centos-ssh:${RELEASE_VERSION} /usr/sbin/scmi install --chroot=/media/root --name=\\${NAME} --tag=${RELEASE_VERSION} --setopt='--volume {{NAME}}.config-ssh:/etc/ssh'\" \\\n      uninstall=\"docker run --rm --privileged --volume /:/media/root jdeathe/centos-ssh:${RELEASE_VERSION} /usr/sbin/scmi uninstall --chroot=/media/root --name=\\${NAME} --tag=${RELEASE_VERSION} --setopt='--volume {{NAME}}.config-ssh:/etc/ssh'\" \\\n      org.deathe.name=\"centos-ssh\" \\\n      org.deathe.version=\"${RELEASE_VERSION}\" \\\n      org.deathe.release=\"jdeathe/centos-ssh:${RELEASE_VERSION}\" \\\n      org.deathe.license=\"MIT\" \\\n      org.deathe.vendor=\"jdeathe\" \\\n      org.deathe.url=\"https://github.com/jdeathe/centos-ssh\" \\\n      org.deathe.description=\"CentOS-7 7.6.1810 x86_64 - SCL, EPEL and IUS Repositories / Supervisor / OpenSSH.\"\nHEALTHCHECK --interval=1s --timeout=1s --retries=5 CMD [\"/usr/bin/healthcheck\"]\nCMD [\"/usr/bin/supervisord\", \"--configuration=/etc/supervisord.conf\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n","originalDockerfile":"FROM centos:7.6.1810\nARG RELEASE_VERSION=\"2.6.0\"\n#  ------------------------------------------------------------------------------\n#  - Import the RPM GPG keys for repositories\n#  - Base install of required packages\n#  - Install supervisord (used to run more than a single process)\n#  - Install supervisor-stdout to allow output of services started by\n#   supervisord to be easily inspected with \"docker logs\".\n#  ------------------------------------------------------------------------------\nRUN rpm --rebuilddb \\\n && rpm --import http://mirror.centos.org/centos/RPM-GPG-KEY-CentOS-7 \\\n && rpm --import https://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-7 \\\n && rpm --import https://dl.iuscommunity.org/pub/ius/IUS-COMMUNITY-GPG-KEY \\\n && yum -y install --setopt=tsflags=nodocs --disableplugin=fastestmirror centos-release-scl centos-release-scl-rh epel-release https://centos7.iuscommunity.org/ius-release.rpm \\\n && yum -y install --setopt=tsflags=nodocs --disableplugin=fastestmirror inotify-tools-3.14-8.el7 openssh-clients-7.4p1-16.el7 openssh-server-7.4p1-16.el7 openssl-1.0.2k-16.el7 python-setuptools-0.9.8-7.el7 sudo-1.8.23-3.el7 yum-plugin-versionlock-1.1.31-50.el7 \\\n && yum versionlock add inotify-tools openssh openssh-server openssh-clients python-setuptools sudo yum-plugin-versionlock \\\n && yum clean all \\\n && easy_install 'supervisor == 4.0.3' 'supervisor-stdout == 0.1.1' \\\n && mkdir -p /var/log/supervisor/ \\\n && rm -rf /etc/ld.so.cache \\\n && rm -rf /sbin/sln \\\n && rm -rf /usr/{{lib,share}/locale,share/{man,doc,info,cracklib,i18n},{lib,lib64}/gconv,bin/localedef,sbin/build-locale-archive} \\\n && rm -rf /{root,tmp,var/cache/{ldconfig,yum}}/* \\\n && > /etc/sysconfig/i18n\n#  ------------------------------------------------------------------------------\n#  Copy files into place\n#  ------------------------------------------------------------------------------\nADD src /\n#  ------------------------------------------------------------------------------\n#  Provisioning\n#  - UTC Timezone\n#  - Networking\n#  - Configure SSH defaults for non-root public key authentication\n#  - Enable the wheel sudoers group\n#  - Replace placeholders with values in systemd service unit template\n#  - Set permissions\n#  ------------------------------------------------------------------------------\nRUN ln -sf /usr/share/zoneinfo/UTC /etc/localtime \\\n && echo \"NETWORKING=yes\" > /etc/sysconfig/network \\\n && sed -i -e 's~^PasswordAuthentication yes~PasswordAuthentication no~g' -e 's~^#PermitRootLogin yes~PermitRootLogin no~g' -e 's~^#UseDNS yes~UseDNS no~g' -e 's~^\\(.*\\)/usr/libexec/openssh/sftp-server$~\\1internal-sftp~g' /etc/ssh/sshd_config \\\n && sed -i -e 's~^# %wheel\\tALL=(ALL)\\tALL~%wheel\\tALL=(ALL) ALL~g' -e 's~\\(.*\\) requiretty$~#\\1requiretty~' /etc/sudoers \\\n && sed -i -e \"s~{{RELEASE_VERSION}}~${RELEASE_VERSION}~g\" /etc/systemd/system/centos-ssh@.service \\\n && chmod 644 /etc/{supervisord.conf,supervisord.d/{20-sshd-bootstrap,50-sshd-wrapper}.conf} \\\n && chmod 700 /usr/{bin/healthcheck,sbin/{scmi,sshd-{bootstrap,wrapper},system-{timezone,timezone-wrapper}}}\nEXPOSE 22/tcp\n#  ------------------------------------------------------------------------------\n#  Set default environment variables\n#  ------------------------------------------------------------------------------\nENV ENABLE_SSHD_BOOTSTRAP=\"true\" \\\n    ENABLE_SSHD_WRAPPER=\"true\" \\\n    ENABLE_SUPERVISOR_STDOUT=\"false\" \\\n    SSH_AUTHORIZED_KEYS=\"\" \\\n    SSH_CHROOT_DIRECTORY=\"%h\" \\\n    SSH_INHERIT_ENVIRONMENT=\"false\" \\\n    SSH_PASSWORD_AUTHENTICATION=\"false\" \\\n    SSH_SUDO=\"ALL=(ALL) ALL\" \\\n    SSH_USER=\"app-admin\" \\\n    SSH_USER_FORCE_SFTP=\"false\" \\\n    SSH_USER_HOME=\"/home/%u\" \\\n    SSH_USER_ID=\"500:500\" \\\n    SSH_USER_PASSWORD=\"\" \\\n    SSH_USER_PASSWORD_HASHED=\"false\" \\\n    SSH_USER_PRIVATE_KEY=\"\" \\\n    SSH_USER_SHELL=\"/bin/bash\" \\\n    SYSTEM_TIMEZONE=\"UTC\"\n#  ------------------------------------------------------------------------------\n#  Set image metadata\n#  ------------------------------------------------------------------------------\nLABEL maintainer=\"James Deathe <james.deathe@gmail.com>\" \\\n      install=\"docker run --rm --privileged --volume /:/media/root jdeathe/centos-ssh:${RELEASE_VERSION} /usr/sbin/scmi install --chroot=/media/root --name=\\${NAME} --tag=${RELEASE_VERSION} --setopt='--volume {{NAME}}.config-ssh:/etc/ssh'\" \\\n      uninstall=\"docker run --rm --privileged --volume /:/media/root jdeathe/centos-ssh:${RELEASE_VERSION} /usr/sbin/scmi uninstall --chroot=/media/root --name=\\${NAME} --tag=${RELEASE_VERSION} --setopt='--volume {{NAME}}.config-ssh:/etc/ssh'\" \\\n      org.deathe.name=\"centos-ssh\" \\\n      org.deathe.version=\"${RELEASE_VERSION}\" \\\n      org.deathe.release=\"jdeathe/centos-ssh:${RELEASE_VERSION}\" \\\n      org.deathe.license=\"MIT\" \\\n      org.deathe.vendor=\"jdeathe\" \\\n      org.deathe.url=\"https://github.com/jdeathe/centos-ssh\" \\\n      org.deathe.description=\"CentOS-7 7.6.1810 x86_64 - SCL, EPEL and IUS Repositories / Supervisor / OpenSSH.\"\nHEALTHCHECK --interval=1s --timeout=1s --retries=5 CMD [\"/usr/bin/healthcheck\"]\nCMD [\"/usr/bin/supervisord\", \"--configuration=/etc/supervisord.conf\"]\n","injectedSmells":[],"originalDockerfileHash":"161bcdbb41f9f32d86a2ea29e62c7b2e","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM centos:7.6.1810\nARG RELEASE_VERSION=\"2.6.0\"\n#   ------------------------------------------------------------------------------\n#   - Import the RPM GPG keys for repositories\n#   - Base install of required packages\n#   - Install supervisord (used to run more than a single process)\n#   - Install supervisor-stdout to allow output of services started by\n#    supervisord to be easily inspected with \"docker logs\".\n#   ------------------------------------------------------------------------------\nRUN rpm --rebuilddb \\\n && rpm --import http://mirror.centos.org/centos/RPM-GPG-KEY-CentOS-7 \\\n && rpm --import https://dl.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-7 \\\n && rpm --import https://dl.iuscommunity.org/pub/ius/IUS-COMMUNITY-GPG-KEY \\\n && yum -y install --setopt=tsflags=nodocs --disableplugin=fastestmirror centos-release-scl centos-release-scl-rh epel-release https://centos7.iuscommunity.org/ius-release.rpm \\\n && yum -y install --setopt=tsflags=nodocs --disableplugin=fastestmirror inotify-tools-3.14-8.el7 openssh-clients-7.4p1-16.el7 openssh-server-7.4p1-16.el7 openssl-1.0.2k-16.el7 python-setuptools-0.9.8-7.el7 sudo-1.8.23-3.el7 yum-plugin-versionlock-1.1.31-50.el7 \\\n && yum versionlock add inotify-tools openssh openssh-server openssh-clients python-setuptools sudo yum-plugin-versionlock \\\n && yum clean all \\\n && easy_install 'supervisor == 4.0.3' 'supervisor-stdout == 0.1.1' \\\n && mkdir -p /var/log/supervisor/ \\\n && rm -rf /etc/ld.so.cache \\\n && rm -rf /sbin/sln \\\n && rm -rf /usr/{{lib,share}/locale,share/{man,doc,info,cracklib,i18n},{lib,lib64}/gconv,bin/localedef,sbin/build-locale-archive} \\\n && rm -rf /{root,tmp,var/cache/{ldconfig,yum}}/* \\\n && > /etc/sysconfig/i18n\n#   ------------------------------------------------------------------------------\n#   Copy files into place\n#   ------------------------------------------------------------------------------\nADD src /\n#   ------------------------------------------------------------------------------\n#   Provisioning\n#   - UTC Timezone\n#   - Networking\n#   - Configure SSH defaults for non-root public key authentication\n#   - Enable the wheel sudoers group\n#   - Replace placeholders with values in systemd service unit template\n#   - Set permissions\n#   ------------------------------------------------------------------------------\nRUN ln -sf /usr/share/zoneinfo/UTC /etc/localtime \\\n && echo \"NETWORKING=yes\" > /etc/sysconfig/network \\\n && sed -i -e 's~^PasswordAuthentication yes~PasswordAuthentication no~g' -e 's~^#PermitRootLogin yes~PermitRootLogin no~g' -e 's~^#UseDNS yes~UseDNS no~g' -e 's~^\\(.*\\)/usr/libexec/openssh/sftp-server$~\\1internal-sftp~g' /etc/ssh/sshd_config \\\n && sed -i -e 's~^# %wheel\\tALL=(ALL)\\tALL~%wheel\\tALL=(ALL) ALL~g' -e 's~\\(.*\\) requiretty$~#\\1requiretty~' /etc/sudoers \\\n && sed -i -e \"s~{{RELEASE_VERSION}}~${RELEASE_VERSION}~g\" /etc/systemd/system/centos-ssh@.service \\\n && chmod 644 /etc/{supervisord.conf,supervisord.d/{20-sshd-bootstrap,50-sshd-wrapper}.conf} \\\n && chmod 700 /usr/{bin/healthcheck,sbin/{scmi,sshd-{bootstrap,wrapper},system-{timezone,timezone-wrapper}}}\nEXPOSE 22/tcp\n#   ------------------------------------------------------------------------------\n#   Set default environment variables\n#   ------------------------------------------------------------------------------\nENV ENABLE_SSHD_BOOTSTRAP=\"true\" \\\n    ENABLE_SSHD_WRAPPER=\"true\" \\\n    ENABLE_SUPERVISOR_STDOUT=\"false\" \\\n    SSH_AUTHORIZED_KEYS=\"\" \\\n    SSH_CHROOT_DIRECTORY=\"%h\" \\\n    SSH_INHERIT_ENVIRONMENT=\"false\" \\\n    SSH_PASSWORD_AUTHENTICATION=\"false\" \\\n    SSH_SUDO=\"ALL=(ALL) ALL\" \\\n    SSH_USER=\"app-admin\" \\\n    SSH_USER_FORCE_SFTP=\"false\" \\\n    SSH_USER_HOME=\"/home/%u\" \\\n    SSH_USER_ID=\"500:500\" \\\n    SSH_USER_PASSWORD=\"\" \\\n    SSH_USER_PASSWORD_HASHED=\"false\" \\\n    SSH_USER_PRIVATE_KEY=\"\" \\\n    SSH_USER_SHELL=\"/bin/bash\" \\\n    SYSTEM_TIMEZONE=\"UTC\"\n#   ------------------------------------------------------------------------------\n#   Set image metadata\n#   ------------------------------------------------------------------------------\nLABEL maintainer=\"James Deathe <james.deathe@gmail.com>\" \\\n      install=\"docker run --rm --privileged --volume /:/media/root jdeathe/centos-ssh:${RELEASE_VERSION} /usr/sbin/scmi install --chroot=/media/root --name=\\${NAME} --tag=${RELEASE_VERSION} --setopt='--volume {{NAME}}.config-ssh:/etc/ssh'\" \\\n      uninstall=\"docker run --rm --privileged --volume /:/media/root jdeathe/centos-ssh:${RELEASE_VERSION} /usr/sbin/scmi uninstall --chroot=/media/root --name=\\${NAME} --tag=${RELEASE_VERSION} --setopt='--volume {{NAME}}.config-ssh:/etc/ssh'\" \\\n      org.deathe.name=\"centos-ssh\" \\\n      org.deathe.version=\"${RELEASE_VERSION}\" \\\n      org.deathe.release=\"jdeathe/centos-ssh:${RELEASE_VERSION}\" \\\n      org.deathe.license=\"MIT\" \\\n      org.deathe.vendor=\"jdeathe\" \\\n      org.deathe.url=\"https://github.com/jdeathe/centos-ssh\" \\\n      org.deathe.description=\"CentOS-7 7.6.1810 x86_64 - SCL, EPEL and IUS Repositories / Supervisor / OpenSSH.\"\nHEALTHCHECK --interval=1s --timeout=1s --retries=5 CMD [\"/usr/bin/healthcheck\"]\nCMD [\"/usr/bin/supervisord\", \"--configuration=/etc/supervisord.conf\"]\n","originalDockerfileUglifiedHash":"3eafa81401c1e9b17d59a9e80c5f856d","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/55a6ef2933cd4c096111ec0a1b79e5a458a8e163.dockerfile"}