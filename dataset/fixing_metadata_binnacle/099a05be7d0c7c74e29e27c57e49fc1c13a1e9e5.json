{"seed":3434930070,"processedDockerfileHash":"67103ca742d34dc196ce6f88a6110674","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM nginx:stable-alpine\nARG BUILD_DATE\nARG VCS_REF\nARG VERSION\nLABEL maintainer=\"CrazyMax\" \\\n      org.label-schema.build-date=\"$BUILD_DATE\" \\\n      org.label-schema.name=\"matomo\" \\\n      org.label-schema.description=\"Matomo (formerly Piwik)\" \\\n      org.label-schema.version=\"$VERSION\" \\\n      org.label-schema.url=\"https://github.com/crazy-max/docker-matomo\" \\\n      org.label-schema.vcs-ref=\"$VCS_REF\" \\\n      org.label-schema.vcs-url=\"https://github.com/crazy-max/docker-matomo\" \\\n      org.label-schema.vendor=\"CrazyMax\" \\\n      org.label-schema.schema-version=\"1.0\"\nRUN apk add gcc=12.2.1_git20220924-r4 gd-dev=2.3.3-r3 geoip-dev=1.6.12-r3 git=2.38.4-r1 gnupg=2.2.40-r0 libc-dev=0.7.2-r3 libmaxminddb-dev=1.7.1-r0 libxslt-dev=1.1.37-r1 linux-headers=5.19.5-r0 make=4.3-r1 openssl-dev=3.0.8-r3 pcre-dev=8.45-r2 perl-dev=5.36.0-r0 zlib-dev=1.2.13-r0 --update --no-cache -t build-dependencies \\\n && mkdir -p /usr/src \\\n && cd /usr/src \\\n && wget http://nginx.org/download/nginx-$NGINX_VERSION.tar.gz \\\n && tar zxvf nginx-$NGINX_VERSION.tar.gz \\\n && git clone -b master --single-branch https://github.com/leev/ngx_http_geoip2_module.git \\\n && cd nginx-$NGINX_VERSION \\\n && ./configure --with-compat --add-dynamic-module=../ngx_http_geoip2_module \\\n && make modules \\\n && cp objs/ngx_http_geoip2_module.so /etc/nginx/modules \\\n && apk del build-dependencies \\\n && rm -rf /usr/src/nginx-* /usr/src/ngx_http_geoip2_module /var/cache/apk/* /var/www/* /tmp/*\nRUN apk add geoip=1.6.12-r3 inotify-tools=3.22.6.0-r0 libmaxminddb=1.7.1-r0 php7 php7-cli php7-ctype php7-curl php7-dom php7-iconv php7-fpm php7-gd php7-json php7-ldap php7-mbstring php7-opcache php7-openssl php7-pdo php7-pdo_mysql php7-redis php7-session php7-simplexml php7-xml php7-zlib ssmtp=2.64-r18 supervisor=4.2.4-r0 tzdata=2023c-r0 wget=1.21.3-r2 --update --no-cache \\\n && rm -rf /var/cache/apk/* /var/www/* /tmp/*\nRUN cd /tmp \\\n && mkdir -p /etc/nginx/geoip \\\n && wget -q http://geolite.maxmind.com/download/geoip/database/GeoLite2-City.tar.gz \\\n && wget -q http://geolite.maxmind.com/download/geoip/database/GeoLite2-Country.tar.gz \\\n && wget -q http://geolite.maxmind.com/download/geoip/database/GeoLite2-ASN.tar.gz \\\n && tar -xvzf GeoLite2-City.tar.gz --strip-components=1 \\\n && tar -xvzf GeoLite2-Country.tar.gz --strip-components=1 \\\n && tar -xvzf GeoLite2-ASN.tar.gz --strip-components=1 \\\n && mv *.mmdb /etc/nginx/geoip \\\n && rm -rf /tmp/*\nENV MATOMO_VERSION=\"3.9.1\" \\\n    CRONTAB_PATH=\"/var/spool/cron/crontabs\"\nRUN apk add ca-certificates=20220614-r4 gnupg=2.2.40-r0 libressl=3.6.2-r0 tar=1.34-r2 --update --no-cache -t build-dependencies \\\n && mkdir -p /var/www \\\n && cd /tmp \\\n && wget -q https://builds.matomo.org/piwik-${MATOMO_VERSION}.tar.gz \\\n && wget -q https://builds.matomo.org/piwik-${MATOMO_VERSION}.tar.gz.asc \\\n && wget -q https://builds.matomo.org/signature.asc \\\n && gpg --import signature.asc \\\n && gpg --verify --batch --no-tty piwik-${MATOMO_VERSION}.tar.gz.asc piwik-${MATOMO_VERSION}.tar.gz \\\n && tar -xzf piwik-${MATOMO_VERSION}.tar.gz --strip 1 -C /var/www \\\n && wget -q https://matomo.org/wp-content/uploads/unifont.ttf.zip \\\n && unzip unifont.ttf.zip -d /var/www/plugins/ImageGraph/fonts/ \\\n && rm unifont.ttf.zip \\\n && chown -R nginx. /etc/nginx /usr/lib/nginx /var/cache/nginx /var/log/nginx /var/log/php7 /var/www \\\n && apk del build-dependencies \\\n && rm -rf /root/.gnupg /tmp/* /var/cache/apk/*\nCOPY entrypoint.sh /entrypoint.sh\nCOPY assets /\nRUN chmod a+x /entrypoint.sh /usr/local/bin/* \\\n && chown nginx. /var/www/bootstrap.php\nEXPOSE 8000/tcp\nWORKDIR /var/www\nVOLUME [ \"/data\" ]\nENTRYPOINT [\"/entrypoint.sh\"]\nCMD [\"/usr/bin/supervisord\", \"-c\", \"/etc/supervisord.conf\"]\nRUN addgroup -S docker-user ; adduser -S -G docker-user docker-user\nUSER docker-user\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\n","originalDockerfile":"FROM nginx:stable-alpine\nARG BUILD_DATE\nARG VCS_REF\nARG VERSION\nLABEL maintainer=\"CrazyMax\" \\\n      org.label-schema.build-date=\"$BUILD_DATE\" \\\n      org.label-schema.name=\"matomo\" \\\n      org.label-schema.description=\"Matomo (formerly Piwik)\" \\\n      org.label-schema.version=\"$VERSION\" \\\n      org.label-schema.url=\"https://github.com/crazy-max/docker-matomo\" \\\n      org.label-schema.vcs-ref=\"$VCS_REF\" \\\n      org.label-schema.vcs-url=\"https://github.com/crazy-max/docker-matomo\" \\\n      org.label-schema.vendor=\"CrazyMax\" \\\n      org.label-schema.schema-version=\"1.0\"\nRUN apk --update --no-cache add -t build-dependencies gcc gd-dev geoip-dev git gnupg libc-dev libmaxminddb-dev libxslt-dev linux-headers make openssl-dev pcre-dev perl-dev zlib-dev \\\n && mkdir -p /usr/src \\\n && cd /usr/src \\\n && wget http://nginx.org/download/nginx-$NGINX_VERSION.tar.gz \\\n && tar zxvf nginx-$NGINX_VERSION.tar.gz \\\n && git clone -b master --single-branch https://github.com/leev/ngx_http_geoip2_module.git \\\n && cd nginx-$NGINX_VERSION \\\n && ./configure --with-compat --add-dynamic-module=../ngx_http_geoip2_module \\\n && make modules \\\n && cp objs/ngx_http_geoip2_module.so /etc/nginx/modules \\\n && apk del build-dependencies \\\n && rm -rf /usr/src/nginx-* /usr/src/ngx_http_geoip2_module /var/cache/apk/* /var/www/* /tmp/*\nRUN apk --update --no-cache add geoip inotify-tools libmaxminddb php7 php7-cli php7-ctype php7-curl php7-dom php7-iconv php7-fpm php7-gd php7-json php7-ldap php7-mbstring php7-opcache php7-openssl php7-pdo php7-pdo_mysql php7-redis php7-session php7-simplexml php7-xml php7-zlib ssmtp supervisor tzdata wget \\\n && rm -rf /var/cache/apk/* /var/www/* /tmp/*\nRUN cd /tmp \\\n && mkdir -p /etc/nginx/geoip \\\n && wget -q http://geolite.maxmind.com/download/geoip/database/GeoLite2-City.tar.gz \\\n && wget -q http://geolite.maxmind.com/download/geoip/database/GeoLite2-Country.tar.gz \\\n && wget -q http://geolite.maxmind.com/download/geoip/database/GeoLite2-ASN.tar.gz \\\n && tar -xvzf GeoLite2-City.tar.gz --strip-components=1 \\\n && tar -xvzf GeoLite2-Country.tar.gz --strip-components=1 \\\n && tar -xvzf GeoLite2-ASN.tar.gz --strip-components=1 \\\n && mv *.mmdb /etc/nginx/geoip \\\n && rm -rf /tmp/*\nENV MATOMO_VERSION=\"3.9.1\" \\\n    CRONTAB_PATH=\"/var/spool/cron/crontabs\"\nRUN apk --update --no-cache add -t build-dependencies ca-certificates gnupg libressl tar \\\n && mkdir -p /var/www \\\n && cd /tmp \\\n && wget -q https://builds.matomo.org/piwik-${MATOMO_VERSION}.tar.gz \\\n && wget -q https://builds.matomo.org/piwik-${MATOMO_VERSION}.tar.gz.asc \\\n && wget -q https://builds.matomo.org/signature.asc \\\n && gpg --import signature.asc \\\n && gpg --verify --batch --no-tty piwik-${MATOMO_VERSION}.tar.gz.asc piwik-${MATOMO_VERSION}.tar.gz \\\n && tar -xzf piwik-${MATOMO_VERSION}.tar.gz --strip 1 -C /var/www \\\n && wget -q https://matomo.org/wp-content/uploads/unifont.ttf.zip \\\n && unzip unifont.ttf.zip -d /var/www/plugins/ImageGraph/fonts/ \\\n && rm unifont.ttf.zip \\\n && chown -R nginx. /etc/nginx /usr/lib/nginx /var/cache/nginx /var/log/nginx /var/log/php7 /var/www \\\n && apk del build-dependencies \\\n && rm -rf /root/.gnupg /tmp/* /var/cache/apk/*\nCOPY entrypoint.sh /entrypoint.sh\nCOPY assets /\nRUN chmod a+x /entrypoint.sh /usr/local/bin/* \\\n && chown nginx. /var/www/bootstrap.php\nEXPOSE 8000/tcp\nWORKDIR /var/www\nVOLUME [ \"/data\" ]\nENTRYPOINT [\"/entrypoint.sh\"]\nCMD [\"/usr/bin/supervisord\", \"-c\", \"/etc/supervisord.conf\"]\n","injectedSmells":[],"originalDockerfileHash":"6796776d95b90a730ac7b9a2ccbcdf96","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM nginx:stable-alpine\nARG BUILD_DATE\nARG VCS_REF\nARG VERSION\nLABEL maintainer=\"CrazyMax\" \\\n      org.label-schema.build-date=\"$BUILD_DATE\" \\\n      org.label-schema.name=\"matomo\" \\\n      org.label-schema.description=\"Matomo (formerly Piwik)\" \\\n      org.label-schema.version=\"$VERSION\" \\\n      org.label-schema.url=\"https://github.com/crazy-max/docker-matomo\" \\\n      org.label-schema.vcs-ref=\"$VCS_REF\" \\\n      org.label-schema.vcs-url=\"https://github.com/crazy-max/docker-matomo\" \\\n      org.label-schema.vendor=\"CrazyMax\" \\\n      org.label-schema.schema-version=\"1.0\"\nRUN apk --update --no-cache add -t build-dependencies gcc gd-dev geoip-dev git gnupg libc-dev libmaxminddb-dev libxslt-dev linux-headers make openssl-dev pcre-dev perl-dev zlib-dev \\\n && mkdir -p /usr/src \\\n && cd /usr/src \\\n && wget http://nginx.org/download/nginx-$NGINX_VERSION.tar.gz \\\n && tar zxvf nginx-$NGINX_VERSION.tar.gz \\\n && git clone -b master --single-branch https://github.com/leev/ngx_http_geoip2_module.git \\\n && cd nginx-$NGINX_VERSION \\\n && ./configure --with-compat --add-dynamic-module=../ngx_http_geoip2_module \\\n && make modules \\\n && cp objs/ngx_http_geoip2_module.so /etc/nginx/modules \\\n && apk del build-dependencies \\\n && rm -rf /usr/src/nginx-* /usr/src/ngx_http_geoip2_module /var/cache/apk/* /var/www/* /tmp/*\nRUN apk --update --no-cache add geoip inotify-tools libmaxminddb php7 php7-cli php7-ctype php7-curl php7-dom php7-iconv php7-fpm php7-gd php7-json php7-ldap php7-mbstring php7-opcache php7-openssl php7-pdo php7-pdo_mysql php7-redis php7-session php7-simplexml php7-xml php7-zlib ssmtp supervisor tzdata wget \\\n && rm -rf /var/cache/apk/* /var/www/* /tmp/*\nRUN cd /tmp \\\n && mkdir -p /etc/nginx/geoip \\\n && wget -q http://geolite.maxmind.com/download/geoip/database/GeoLite2-City.tar.gz \\\n && wget -q http://geolite.maxmind.com/download/geoip/database/GeoLite2-Country.tar.gz \\\n && wget -q http://geolite.maxmind.com/download/geoip/database/GeoLite2-ASN.tar.gz \\\n && tar -xvzf GeoLite2-City.tar.gz --strip-components=1 \\\n && tar -xvzf GeoLite2-Country.tar.gz --strip-components=1 \\\n && tar -xvzf GeoLite2-ASN.tar.gz --strip-components=1 \\\n && mv *.mmdb /etc/nginx/geoip \\\n && rm -rf /tmp/*\nENV MATOMO_VERSION=\"3.9.1\" \\\n    CRONTAB_PATH=\"/var/spool/cron/crontabs\"\nRUN apk --update --no-cache add -t build-dependencies ca-certificates gnupg libressl tar \\\n && mkdir -p /var/www \\\n && cd /tmp \\\n && wget -q https://builds.matomo.org/piwik-${MATOMO_VERSION}.tar.gz \\\n && wget -q https://builds.matomo.org/piwik-${MATOMO_VERSION}.tar.gz.asc \\\n && wget -q https://builds.matomo.org/signature.asc \\\n && gpg --import signature.asc \\\n && gpg --verify --batch --no-tty piwik-${MATOMO_VERSION}.tar.gz.asc piwik-${MATOMO_VERSION}.tar.gz \\\n && tar -xzf piwik-${MATOMO_VERSION}.tar.gz --strip 1 -C /var/www \\\n && wget -q https://matomo.org/wp-content/uploads/unifont.ttf.zip \\\n && unzip unifont.ttf.zip -d /var/www/plugins/ImageGraph/fonts/ \\\n && rm unifont.ttf.zip \\\n && chown -R nginx. /etc/nginx /usr/lib/nginx /var/cache/nginx /var/log/nginx /var/log/php7 /var/www \\\n && apk del build-dependencies \\\n && rm -rf /root/.gnupg /tmp/* /var/cache/apk/*\nCOPY entrypoint.sh /entrypoint.sh\nCOPY assets /\nRUN chmod a+x /entrypoint.sh /usr/local/bin/* \\\n && chown nginx. /var/www/bootstrap.php\nEXPOSE 8000/tcp\nWORKDIR /var/www\nVOLUME [ \"/data\" ]\nENTRYPOINT [\"/entrypoint.sh\"]\nCMD [\"/usr/bin/supervisord\", \"-c\", \"/etc/supervisord.conf\"]\n","originalDockerfileUglifiedHash":"6796776d95b90a730ac7b9a2ccbcdf96","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/099a05be7d0c7c74e29e27c57e49fc1c13a1e9e5.dockerfile"}