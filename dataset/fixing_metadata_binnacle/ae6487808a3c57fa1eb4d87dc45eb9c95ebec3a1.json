{"seed":3299577078,"processedDockerfileHash":"9be55b9732f477099a8cb9e6ea7b78b1","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"#   Pull base image\nFROM daocloud.io/library/centos:latest\nMAINTAINER Cdoco <ocdoco@gmail.com>\nENV PHP_VERSION=\"7.0.14\"\n#   Update source\nRUN set -x \\\n && yum update -y \\\n && yum install -y wget gcc gcc-c++ make perl tar libjpeg libpng libjpeg-devel libpng-devel libjpeg-turbo freetype freetype-devel libcurl-devel libxml2-devel libjpeg-turbo-devel libXpm-devel libXpm libicu-devel libmcrypt libmcrypt-devel libxslt-devel libxslt openssl openssl-devel bzip2-devel \\\n && yum clean all \\\n && mkdir -p /data/deps \\\n && mkdir -p /data/server \\\n && cd /data/deps \\\n && wget http://jaist.dl.sourceforge.net/project/libpng/zlib/1.2.8/zlib-1.2.8.tar.gz \\\n && tar zxvf zlib-1.2.8.tar.gz \\\n && cd zlib-1.2.8 \\\n && ./configure --static --prefix=/data/server/libs/zlib \\\n && make \\\n && make install \\\n && cd /data/deps \\\n && wget http://www.openssl.org/source/openssl-0.9.8zb.tar.gz \\\n && tar zxvf openssl-0.9.8zb.tar.gz \\\n && cd openssl-0.9.8zb \\\n && ./config --prefix=/data/server/libs/openssl -L/data/server/libs/zlib/lib -I/data/server/libs/zlib/include threads zlib enable-static-engine \\\n && make \\\n && make install \\\n && cd /data/deps \\\n && wget http://jaist.dl.sourceforge.net/project/pcre/pcre/8.33/pcre-8.33.tar.gz \\\n && tar zxvf pcre-8.33.tar.gz \\\n && cd pcre-8.33 \\\n && ./configure --prefix=/data/server/libs/pcre \\\n && make \\\n && make install \\\n && cd /data/deps \\\n && wget http://nginx.org/download/nginx-1.9.9.tar.gz \\\n && tar zxvf nginx-1.9.9.tar.gz \\\n && cd nginx-1.9.9 \\\n && './configure' '--prefix=/data/server/nginx' '--with-debug' '--with-openssl=/data/deps/openssl-0.9.8zb' '--with-zlib=/data/deps/zlib-1.2.8' '--with-pcre=/data/deps/pcre-8.33' '--with-http_stub_status_module' '--with-http_gzip_static_module' \\\n && make \\\n && make install \\\n && cd /data/deps \\\n && wget ftp://mcrypt.hellug.gr/pub/crypto/mcrypt/libmcrypt/libmcrypt-2.5.6.tar.gz \\\n && tar zxvf libmcrypt-2.5.6.tar.gz \\\n && cd libmcrypt-2.5.6 \\\n && ./configure \\\n && make \\\n && make install \\\n && cd /data/deps \\\n && wget http://cn2.php.net/distributions/php-$PHP_VERSION.tar.gz \\\n && tar zxvf php-$PHP_VERSION.tar.gz \\\n && cd php-$PHP_VERSION \\\n && './configure' '--prefix=/data/server/php/' '--with-config-file-path=/data/server/php/etc/' '--with-config-file-scan-dir=/data/server/php/conf.d/' '--enable-fpm' '--enable-cgi' '--disable-phpdbg' '--enable-mbstring' '--enable-calendar' '--with-xsl' '--with-openssl' '--enable-soap' '--enable-zip' '--enable-shmop' '--enable-sockets' '--with-gd' '--with-jpeg-dir' '--with-png-dir' '--with-xpm-dir' '--with-xmlrpc' '--enable-pcntl' '--enable-intl' '--with-mcrypt' '--enable-sysvsem' '--enable-sysvshm' '--enable-sysvmsg' '--enable-opcache' '--with-iconv' '--with-bz2' '--with-curl' '--enable-mysqlnd' '--with-mysqli=mysqlnd' '--with-pdo-mysql=mysqlnd' '--with-zlib' '--with-gettext=' \\\n && make \\\n && make install \\\n && yum remove -y gcc* make* \\\n && rm -rf /data/deps ADD files/php/php.ini /data/server/php/etc/php.ini\nCOPY files/php/php-fpm.conf /data/server/php/etc/php-fpm.conf\nCOPY files/php/www.conf /data/server/php/etc/php-fpm.d/www.conf\n#   add nginx conf\nCOPY files/nginx/nginx.conf /data/server/nginx/conf/nginx.conf\nCOPY files/nginx/default.conf /data/server/nginx/conf/vhost/default.conf\nRUN set -x \\\n && mkdir -p /data/logs/nginx \\\n && touch /data/logs/nginx/access.log\n#   add run.sh\nCOPY files/run.sh /data/run.sh\nRUN set -x \\\n && chmod u+x /data/run.sh\nRUN set -x \\\n && mkdir -p /data/www \\\n && echo \"<?php phpinfo();?>\" > /data/www/index.php\n#   Start php-fpm And nginx\nCMD [\"/data/run.sh\"]\nEXPOSE 80/tcp\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  Pull base image\nFROM daocloud.io/library/centos:latest\nMAINTAINER Cdoco <ocdoco@gmail.com>\nENV PHP_VERSION=\"7.0.14\"\n#  Update source\nRUN set -x \\\n && yum update -y \\\n && yum install -y wget gcc gcc-c++ make perl tar libjpeg libpng libjpeg-devel libpng-devel libjpeg-turbo freetype freetype-devel libcurl-devel libxml2-devel libjpeg-turbo-devel libXpm-devel libXpm libicu-devel libmcrypt libmcrypt-devel libxslt-devel libxslt openssl openssl-devel bzip2-devel \\\n && yum clean all \\\n && mkdir -p /data/deps \\\n && mkdir -p /data/server \\\n && cd /data/deps \\\n && wget http://jaist.dl.sourceforge.net/project/libpng/zlib/1.2.8/zlib-1.2.8.tar.gz \\\n && tar zxvf zlib-1.2.8.tar.gz \\\n && cd zlib-1.2.8 \\\n && ./configure --static --prefix=/data/server/libs/zlib \\\n && make \\\n && make install \\\n && cd /data/deps \\\n && wget http://www.openssl.org/source/openssl-0.9.8zb.tar.gz \\\n && tar zxvf openssl-0.9.8zb.tar.gz \\\n && cd openssl-0.9.8zb \\\n && ./config --prefix=/data/server/libs/openssl -L/data/server/libs/zlib/lib -I/data/server/libs/zlib/include threads zlib enable-static-engine \\\n && make \\\n && make install \\\n && cd /data/deps \\\n && wget http://jaist.dl.sourceforge.net/project/pcre/pcre/8.33/pcre-8.33.tar.gz \\\n && tar zxvf pcre-8.33.tar.gz \\\n && cd pcre-8.33 \\\n && ./configure --prefix=/data/server/libs/pcre \\\n && make \\\n && make install \\\n && cd /data/deps \\\n && wget http://nginx.org/download/nginx-1.9.9.tar.gz \\\n && tar zxvf nginx-1.9.9.tar.gz \\\n && cd nginx-1.9.9 \\\n && './configure' '--prefix=/data/server/nginx' '--with-debug' '--with-openssl=/data/deps/openssl-0.9.8zb' '--with-zlib=/data/deps/zlib-1.2.8' '--with-pcre=/data/deps/pcre-8.33' '--with-http_stub_status_module' '--with-http_gzip_static_module' \\\n && make \\\n && make install \\\n && cd /data/deps \\\n && wget ftp://mcrypt.hellug.gr/pub/crypto/mcrypt/libmcrypt/libmcrypt-2.5.6.tar.gz \\\n && tar zxvf libmcrypt-2.5.6.tar.gz \\\n && cd libmcrypt-2.5.6 \\\n && ./configure \\\n && make \\\n && make install \\\n && cd /data/deps \\\n && wget http://cn2.php.net/distributions/php-$PHP_VERSION.tar.gz \\\n && tar zxvf php-$PHP_VERSION.tar.gz \\\n && cd php-$PHP_VERSION \\\n && './configure' '--prefix=/data/server/php/' '--with-config-file-path=/data/server/php/etc/' '--with-config-file-scan-dir=/data/server/php/conf.d/' '--enable-fpm' '--enable-cgi' '--disable-phpdbg' '--enable-mbstring' '--enable-calendar' '--with-xsl' '--with-openssl' '--enable-soap' '--enable-zip' '--enable-shmop' '--enable-sockets' '--with-gd' '--with-jpeg-dir' '--with-png-dir' '--with-xpm-dir' '--with-xmlrpc' '--enable-pcntl' '--enable-intl' '--with-mcrypt' '--enable-sysvsem' '--enable-sysvshm' '--enable-sysvmsg' '--enable-opcache' '--with-iconv' '--with-bz2' '--with-curl' '--enable-mysqlnd' '--with-mysqli=mysqlnd' '--with-pdo-mysql=mysqlnd' '--with-zlib' '--with-gettext=' \\\n && make \\\n && make install \\\n && yum remove -y gcc* make* \\\n && rm -rf /data/deps ADD files/php/php.ini /data/server/php/etc/php.ini\nADD files/php/php-fpm.conf /data/server/php/etc/php-fpm.conf\nADD files/php/www.conf /data/server/php/etc/php-fpm.d/www.conf\n#  add nginx conf\nADD files/nginx/nginx.conf /data/server/nginx/conf/nginx.conf\nADD files/nginx/default.conf /data/server/nginx/conf/vhost/default.conf\nRUN set -x \\\n && mkdir -p /data/logs/nginx \\\n && touch /data/logs/nginx/access.log\n#  add run.sh\nADD files/run.sh /data/run.sh\nRUN set -x \\\n && chmod u+x /data/run.sh\nRUN set -x \\\n && mkdir -p /data/www \\\n && echo \"<?php phpinfo();?>\" > /data/www/index.php\n#  Start php-fpm And nginx\nCMD [\"/data/run.sh\"]\nEXPOSE 80/tcp\n","injectedSmells":[],"originalDockerfileHash":"8381e4f3d66ad02901db2557c4ab8cf6","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   Pull base image\nFROM daocloud.io/library/centos:latest\nMAINTAINER Cdoco <ocdoco@gmail.com>\nENV PHP_VERSION=\"7.0.14\"\n#   Update source\nRUN set -x \\\n && yum update -y \\\n && yum install -y wget gcc gcc-c++ make perl tar libjpeg libpng libjpeg-devel libpng-devel libjpeg-turbo freetype freetype-devel libcurl-devel libxml2-devel libjpeg-turbo-devel libXpm-devel libXpm libicu-devel libmcrypt libmcrypt-devel libxslt-devel libxslt openssl openssl-devel bzip2-devel \\\n && yum clean all \\\n && mkdir -p /data/deps \\\n && mkdir -p /data/server \\\n && cd /data/deps \\\n && wget http://jaist.dl.sourceforge.net/project/libpng/zlib/1.2.8/zlib-1.2.8.tar.gz \\\n && tar zxvf zlib-1.2.8.tar.gz \\\n && cd zlib-1.2.8 \\\n && ./configure --static --prefix=/data/server/libs/zlib \\\n && make \\\n && make install \\\n && cd /data/deps \\\n && wget http://www.openssl.org/source/openssl-0.9.8zb.tar.gz \\\n && tar zxvf openssl-0.9.8zb.tar.gz \\\n && cd openssl-0.9.8zb \\\n && ./config --prefix=/data/server/libs/openssl -L/data/server/libs/zlib/lib -I/data/server/libs/zlib/include threads zlib enable-static-engine \\\n && make \\\n && make install \\\n && cd /data/deps \\\n && wget http://jaist.dl.sourceforge.net/project/pcre/pcre/8.33/pcre-8.33.tar.gz \\\n && tar zxvf pcre-8.33.tar.gz \\\n && cd pcre-8.33 \\\n && ./configure --prefix=/data/server/libs/pcre \\\n && make \\\n && make install \\\n && cd /data/deps \\\n && wget http://nginx.org/download/nginx-1.9.9.tar.gz \\\n && tar zxvf nginx-1.9.9.tar.gz \\\n && cd nginx-1.9.9 \\\n && './configure' '--prefix=/data/server/nginx' '--with-debug' '--with-openssl=/data/deps/openssl-0.9.8zb' '--with-zlib=/data/deps/zlib-1.2.8' '--with-pcre=/data/deps/pcre-8.33' '--with-http_stub_status_module' '--with-http_gzip_static_module' \\\n && make \\\n && make install \\\n && cd /data/deps \\\n && wget ftp://mcrypt.hellug.gr/pub/crypto/mcrypt/libmcrypt/libmcrypt-2.5.6.tar.gz \\\n && tar zxvf libmcrypt-2.5.6.tar.gz \\\n && cd libmcrypt-2.5.6 \\\n && ./configure \\\n && make \\\n && make install \\\n && cd /data/deps \\\n && wget http://cn2.php.net/distributions/php-$PHP_VERSION.tar.gz \\\n && tar zxvf php-$PHP_VERSION.tar.gz \\\n && cd php-$PHP_VERSION \\\n && './configure' '--prefix=/data/server/php/' '--with-config-file-path=/data/server/php/etc/' '--with-config-file-scan-dir=/data/server/php/conf.d/' '--enable-fpm' '--enable-cgi' '--disable-phpdbg' '--enable-mbstring' '--enable-calendar' '--with-xsl' '--with-openssl' '--enable-soap' '--enable-zip' '--enable-shmop' '--enable-sockets' '--with-gd' '--with-jpeg-dir' '--with-png-dir' '--with-xpm-dir' '--with-xmlrpc' '--enable-pcntl' '--enable-intl' '--with-mcrypt' '--enable-sysvsem' '--enable-sysvshm' '--enable-sysvmsg' '--enable-opcache' '--with-iconv' '--with-bz2' '--with-curl' '--enable-mysqlnd' '--with-mysqli=mysqlnd' '--with-pdo-mysql=mysqlnd' '--with-zlib' '--with-gettext=' \\\n && make \\\n && make install \\\n && yum remove -y gcc* make* \\\n && rm -rf /data/deps ADD files/php/php.ini /data/server/php/etc/php.ini\nADD files/php/php-fpm.conf /data/server/php/etc/php-fpm.conf\nADD files/php/www.conf /data/server/php/etc/php-fpm.d/www.conf\n#   add nginx conf\nADD files/nginx/nginx.conf /data/server/nginx/conf/nginx.conf\nADD files/nginx/default.conf /data/server/nginx/conf/vhost/default.conf\nRUN set -x \\\n && mkdir -p /data/logs/nginx \\\n && touch /data/logs/nginx/access.log\n#   add run.sh\nADD files/run.sh /data/run.sh\nRUN set -x \\\n && chmod u+x /data/run.sh\nRUN set -x \\\n && mkdir -p /data/www \\\n && echo \"<?php phpinfo();?>\" > /data/www/index.php\n#   Start php-fpm And nginx\nCMD [\"/data/run.sh\"]\nEXPOSE 80/tcp\n","originalDockerfileUglifiedHash":"73cbb1abf98f9a6684561881818abfcd","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/ae6487808a3c57fa1eb4d87dc45eb9c95ebec3a1.dockerfile"}