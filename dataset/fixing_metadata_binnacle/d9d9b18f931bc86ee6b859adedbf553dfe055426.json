{"seed":2833777872,"processedDockerfileHash":"6aa75dea013c78030a8b9b3d5273647a","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"#   This is a base Docker image used by Wikia's MediaWiki app. It uses base PHP image provided by Docker with additional\n#   production dependencies installed.\nFROM php:7.0.30-fpm-stretch\n#   set locale as required by MediaWiki / Perl\nENV LANG=\"C.UTF-8\"\nENV LC_ALL=\"C.UTF-8\"\n#   add jessie-backports repo (required to install libsass-dev package)\nRUN apt-get update \\\n && apt-get install --no-install-recommends autoconf automake libbz2-dev libfreetype6-dev libjpeg62-turbo-dev libmemcached-dev libpng-dev libxml2-dev libthai-dev libtool libyaml-dev locales ploticus wget libtidy-dev libicu-dev liblua5.1-0-dev default-mysql-client p7zip-full -y \\\n && apt-get install --no-install-recommends libsass-dev -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && cd /tmp \\\n && wget https://github.com/Wikia/sassphp/archive/0.5.10.tar.gz -O sassphp.tar.gz \\\n && mkdir -p /tmp/sassphp \\\n && tar -xf sassphp.tar.gz -C /tmp/sassphp --strip-components=1 \\\n && docker-php-ext-configure /tmp/sassphp \\\n && docker-php-ext-install /tmp/sassphp \\\n && cd /tmp \\\n && wget https://github.com/Wikia/libmustache/archive/v0.4.4.tar.gz -O libmustache.tar.gz \\\n && mkdir -p /tmp/libmustache \\\n && tar -xf libmustache.tar.gz -C /tmp/libmustache --strip-components=1 \\\n && cd /tmp/libmustache \\\n && autoreconf -fiv \\\n && ./configure --without-mustache-spec \\\n && make \\\n && make install \\\n && cd /tmp \\\n && wget https://github.com/Wikia/php-mustache/archive/v0.7.3.tar.gz -O mustache.tar.gz \\\n && mkdir -p /tmp/mustache \\\n && tar -xf mustache.tar.gz -C /tmp/mustache --strip-components=1 \\\n && docker-php-ext-configure /tmp/mustache \\\n && docker-php-ext-install /tmp/mustache \\\n && cd /tmp \\\n && wget https://github.com/Wikia/wikidiff2/archive/1.4.1.tar.gz -O wikidiff2.tar.gz \\\n && mkdir -p /tmp/wikidiff2 \\\n && tar -xf wikidiff2.tar.gz -C /tmp/wikidiff2 --strip-components=1 \\\n && docker-php-ext-configure /tmp/wikidiff2 \\\n && docker-php-ext-install /tmp/wikidiff2 \\\n && cd /tmp \\\n && wget https://github.com/Wikia/php-xhprof-extension/archive/v4.1.6.tar.gz -O php-xhprof-extension.tar.gz \\\n && mkdir -p /tmp/php-xhprof-extension \\\n && tar -xf php-xhprof-extension.tar.gz -C /tmp/php-xhprof-extension --strip-components=1 \\\n && docker-php-ext-configure /tmp/php-xhprof-extension \\\n && docker-php-ext-install /tmp/php-xhprof-extension \\\n && cd /tmp \\\n && wget https://github.com/Wikia/mediawiki-php-luasandbox/archive/3.0.1.tar.gz -O php-luasandbox-extension.tar.gz \\\n && mkdir -p /tmp/php-luasandbox-extension \\\n && tar -xf php-luasandbox-extension.tar.gz -C /tmp/php-luasandbox-extension --strip-components=1 \\\n && docker-php-ext-configure /tmp/php-luasandbox-extension \\\n && docker-php-ext-install /tmp/php-luasandbox-extension \\\n && pecl install --onlyreqdeps --force redis \\\n && docker-php-ext-enable redis \\\n && docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ \\\n && docker-php-ext-install bz2 gd mysqli opcache simplexml tidy bcmath sockets dba pcntl intl exif \\\n && apt-get remove -y automake wget \\\n && apt-get autoremove -y \\\n && rm -rf /tmp/*\n#   setup php.ini globally\nCOPY ./php.ini /usr/local/etc/php/php.ini\n#   add and validate PHP FPM configuration\nCOPY ./php-fpm.conf /usr/local/etc/php-fpm.d/zz-www.conf\nRUN php-fpm --test\n#   expose volumes for app and config repositories clones\nENV WIKIA_DOCROOT=\"/usr/wikia/slot1/current/src\"\nENV WIKIA_CONFIG_ROOT=\"/usr/wikia/slot1/current/config\"\n#   run \"sha1sum * | sha1sum\" to update this value when this file (or any other in this directory) changes\nENV WIKIA_BASE_IMAGE_HASH=\"225a68a\"\nWORKDIR /usr/wikia/slot1/current/src\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\n","originalDockerfile":"#  This is a base Docker image used by Wikia's MediaWiki app. It uses base PHP image provided by Docker with additional\n#  production dependencies installed.\nFROM php:7.0.30-fpm-stretch\n#  set locale as required by MediaWiki / Perl\nENV LANG=\"C.UTF-8\"\nENV LC_ALL=\"C.UTF-8\"\n#  add jessie-backports repo (required to install libsass-dev package)\nRUN apt-get update \\\n && apt-get install autoconf automake libbz2-dev libfreetype6-dev libjpeg62-turbo-dev libmemcached-dev libpng-dev libxml2-dev libthai-dev libtool libyaml-dev locales ploticus wget libtidy-dev libicu-dev liblua5.1-0-dev default-mysql-client p7zip-full -y \\\n && apt-get install libsass-dev -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && cd /tmp \\\n && wget https://github.com/Wikia/sassphp/archive/0.5.10.tar.gz -O sassphp.tar.gz \\\n && mkdir -p /tmp/sassphp \\\n && tar -xf sassphp.tar.gz -C /tmp/sassphp --strip-components=1 \\\n && docker-php-ext-configure /tmp/sassphp \\\n && docker-php-ext-install /tmp/sassphp \\\n && cd /tmp \\\n && wget https://github.com/Wikia/libmustache/archive/v0.4.4.tar.gz -O libmustache.tar.gz \\\n && mkdir -p /tmp/libmustache \\\n && tar -xf libmustache.tar.gz -C /tmp/libmustache --strip-components=1 \\\n && cd /tmp/libmustache \\\n && autoreconf -fiv \\\n && ./configure --without-mustache-spec \\\n && make \\\n && make install \\\n && cd /tmp \\\n && wget https://github.com/Wikia/php-mustache/archive/v0.7.3.tar.gz -O mustache.tar.gz \\\n && mkdir -p /tmp/mustache \\\n && tar -xf mustache.tar.gz -C /tmp/mustache --strip-components=1 \\\n && docker-php-ext-configure /tmp/mustache \\\n && docker-php-ext-install /tmp/mustache \\\n && cd /tmp \\\n && wget https://github.com/Wikia/wikidiff2/archive/1.4.1.tar.gz -O wikidiff2.tar.gz \\\n && mkdir -p /tmp/wikidiff2 \\\n && tar -xf wikidiff2.tar.gz -C /tmp/wikidiff2 --strip-components=1 \\\n && docker-php-ext-configure /tmp/wikidiff2 \\\n && docker-php-ext-install /tmp/wikidiff2 \\\n && cd /tmp \\\n && wget https://github.com/Wikia/php-xhprof-extension/archive/v4.1.6.tar.gz -O php-xhprof-extension.tar.gz \\\n && mkdir -p /tmp/php-xhprof-extension \\\n && tar -xf php-xhprof-extension.tar.gz -C /tmp/php-xhprof-extension --strip-components=1 \\\n && docker-php-ext-configure /tmp/php-xhprof-extension \\\n && docker-php-ext-install /tmp/php-xhprof-extension \\\n && cd /tmp \\\n && wget https://github.com/Wikia/mediawiki-php-luasandbox/archive/3.0.1.tar.gz -O php-luasandbox-extension.tar.gz \\\n && mkdir -p /tmp/php-luasandbox-extension \\\n && tar -xf php-luasandbox-extension.tar.gz -C /tmp/php-luasandbox-extension --strip-components=1 \\\n && docker-php-ext-configure /tmp/php-luasandbox-extension \\\n && docker-php-ext-install /tmp/php-luasandbox-extension \\\n && pecl install --onlyreqdeps --force redis \\\n && docker-php-ext-enable redis \\\n && docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ \\\n && docker-php-ext-install bz2 gd mysqli opcache simplexml tidy bcmath sockets dba pcntl intl exif \\\n && apt-get remove -y automake wget \\\n && apt-get autoremove -y \\\n && rm -rf /tmp/*\n#  setup php.ini globally\nADD ./php.ini /usr/local/etc/php/php.ini\n#  add and validate PHP FPM configuration\nADD ./php-fpm.conf /usr/local/etc/php-fpm.d/zz-www.conf\nRUN php-fpm --test\n#  expose volumes for app and config repositories clones\nENV WIKIA_DOCROOT=\"/usr/wikia/slot1/current/src\"\nENV WIKIA_CONFIG_ROOT=\"/usr/wikia/slot1/current/config\"\n#  run \"sha1sum * | sha1sum\" to update this value when this file (or any other in this directory) changes\nENV WIKIA_BASE_IMAGE_HASH=\"225a68a\"\nWORKDIR /usr/wikia/slot1/current/src\n","injectedSmells":[],"originalDockerfileHash":"254260c0bb28a3d5380f9a1da8e804d0","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   This is a base Docker image used by Wikia's MediaWiki app. It uses base PHP image provided by Docker with additional\n#   production dependencies installed.\nFROM php:7.0.30-fpm-stretch\n#   set locale as required by MediaWiki / Perl\nENV LANG=\"C.UTF-8\"\nENV LC_ALL=\"C.UTF-8\"\n#   add jessie-backports repo (required to install libsass-dev package)\nRUN apt-get update \\\n && apt-get install autoconf automake libbz2-dev libfreetype6-dev libjpeg62-turbo-dev libmemcached-dev libpng-dev libxml2-dev libthai-dev libtool libyaml-dev locales ploticus wget libtidy-dev libicu-dev liblua5.1-0-dev default-mysql-client p7zip-full -y \\\n && apt-get install libsass-dev -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && cd /tmp \\\n && wget https://github.com/Wikia/sassphp/archive/0.5.10.tar.gz -O sassphp.tar.gz \\\n && mkdir -p /tmp/sassphp \\\n && tar -xf sassphp.tar.gz -C /tmp/sassphp --strip-components=1 \\\n && docker-php-ext-configure /tmp/sassphp \\\n && docker-php-ext-install /tmp/sassphp \\\n && cd /tmp \\\n && wget https://github.com/Wikia/libmustache/archive/v0.4.4.tar.gz -O libmustache.tar.gz \\\n && mkdir -p /tmp/libmustache \\\n && tar -xf libmustache.tar.gz -C /tmp/libmustache --strip-components=1 \\\n && cd /tmp/libmustache \\\n && autoreconf -fiv \\\n && ./configure --without-mustache-spec \\\n && make \\\n && make install \\\n && cd /tmp \\\n && wget https://github.com/Wikia/php-mustache/archive/v0.7.3.tar.gz -O mustache.tar.gz \\\n && mkdir -p /tmp/mustache \\\n && tar -xf mustache.tar.gz -C /tmp/mustache --strip-components=1 \\\n && docker-php-ext-configure /tmp/mustache \\\n && docker-php-ext-install /tmp/mustache \\\n && cd /tmp \\\n && wget https://github.com/Wikia/wikidiff2/archive/1.4.1.tar.gz -O wikidiff2.tar.gz \\\n && mkdir -p /tmp/wikidiff2 \\\n && tar -xf wikidiff2.tar.gz -C /tmp/wikidiff2 --strip-components=1 \\\n && docker-php-ext-configure /tmp/wikidiff2 \\\n && docker-php-ext-install /tmp/wikidiff2 \\\n && cd /tmp \\\n && wget https://github.com/Wikia/php-xhprof-extension/archive/v4.1.6.tar.gz -O php-xhprof-extension.tar.gz \\\n && mkdir -p /tmp/php-xhprof-extension \\\n && tar -xf php-xhprof-extension.tar.gz -C /tmp/php-xhprof-extension --strip-components=1 \\\n && docker-php-ext-configure /tmp/php-xhprof-extension \\\n && docker-php-ext-install /tmp/php-xhprof-extension \\\n && cd /tmp \\\n && wget https://github.com/Wikia/mediawiki-php-luasandbox/archive/3.0.1.tar.gz -O php-luasandbox-extension.tar.gz \\\n && mkdir -p /tmp/php-luasandbox-extension \\\n && tar -xf php-luasandbox-extension.tar.gz -C /tmp/php-luasandbox-extension --strip-components=1 \\\n && docker-php-ext-configure /tmp/php-luasandbox-extension \\\n && docker-php-ext-install /tmp/php-luasandbox-extension \\\n && pecl install --onlyreqdeps --force redis \\\n && docker-php-ext-enable redis \\\n && docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ \\\n && docker-php-ext-install bz2 gd mysqli opcache simplexml tidy bcmath sockets dba pcntl intl exif \\\n && apt-get remove -y automake wget \\\n && apt-get autoremove -y \\\n && rm -rf /tmp/*\n#   setup php.ini globally\nADD ./php.ini /usr/local/etc/php/php.ini\n#   add and validate PHP FPM configuration\nADD ./php-fpm.conf /usr/local/etc/php-fpm.d/zz-www.conf\nRUN php-fpm --test\n#   expose volumes for app and config repositories clones\nENV WIKIA_DOCROOT=\"/usr/wikia/slot1/current/src\"\nENV WIKIA_CONFIG_ROOT=\"/usr/wikia/slot1/current/config\"\n#   run \"sha1sum * | sha1sum\" to update this value when this file (or any other in this directory) changes\nENV WIKIA_BASE_IMAGE_HASH=\"225a68a\"\nWORKDIR /usr/wikia/slot1/current/src\n","originalDockerfileUglifiedHash":"dce75a496903eafe531a46bbc5e91f42","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/d9d9b18f931bc86ee6b859adedbf553dfe055426.dockerfile"}