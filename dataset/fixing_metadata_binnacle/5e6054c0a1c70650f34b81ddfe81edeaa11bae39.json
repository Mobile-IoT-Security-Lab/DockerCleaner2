{"seed":2613225049,"processedDockerfileHash":"89878abb1e92705eaa94bc16969098ef","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["have-a-healthcheck","have-a-user"],"processedDockerfile":"#   Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n#   use this file except in compliance with the License. You may obtain a copy of\n#   the License at\n#\n#     http://www.apache.org/licenses/LICENSE-2.0\n#\n#   Unless required by applicable law or agreed to in writing, software\n#   distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n#   WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n#   License for the specific language governing permissions and limitations under\n#   the License.\nFROM debian:jessie\nMAINTAINER CouchDB Developers dev@couchdb.apache.org\n#   Install instructions from https://cwiki.apache.org/confluence/display/COUCHDB/Debian\nRUN groupadd -g 5984 -r couchdb \\\n && useradd -u 5984 -d /opt/couchdb -g couchdb couchdb\nRUN apt-get update -y \\\n && apt-get install --no-install-recommends ca-certificates curl erlang-nox libicu52 libmozjs185-1.0 libnspr4 libnspr4-0d -y \\\n && rm -rf /var/lib/apt/lists/*\nENV GOSU_VERSION=\"1.10\"\nENV TINI_VERSION=\"0.16.1\"\nRUN set -ex ; apt-get update ; apt-get install --no-install-recommends wget -y ; rm -rf /var/lib/apt/lists/* ; dpkgArch=\"$( dpkg --print-architecture | awk -F- '{ print $NF }' ;)\" ; wget -O /usr/local/bin/gosu \"https://github.com/tianon/gosu/releases/download/${GOSU_VERSION}/gosu-$dpkgArch\" ; wget -O /usr/local/bin/gosu.asc \"https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-$dpkgArch.asc\" ; export GNUPGHOME=\"$( mktemp -d ;)\" ; gpg --keyserver ha.pool.sks-keyservers.net --recv-keys B42F6819007F00F88E364FD4036A9C25BF357DD4 ; gpg --batch --verify /usr/local/bin/gosu.asc /usr/local/bin/gosu ; rm -r \"$GNUPGHOME\" /usr/local/bin/gosu.asc ; chmod +x /usr/local/bin/gosu ; gosu nobody true ; wget -O /usr/local/bin/tini \"https://github.com/krallin/tini/releases/download/v${TINI_VERSION}/tini-$dpkgArch\" ; wget -O /usr/local/bin/tini.asc \"https://github.com/krallin/tini/releases/download/v${TINI_VERSION}/tini-$dpkgArch.asc\" ; export GNUPGHOME=\"$( mktemp -d ;)\" ; gpg --keyserver ha.pool.sks-keyservers.net --recv-keys 595E85A6B1B4779EA4DAAEC70B588DFF0527A9B7 ; gpg --batch --verify /usr/local/bin/tini.asc /usr/local/bin/tini ; rm -r \"$GNUPGHOME\" /usr/local/bin/tini.asc ; chmod +x /usr/local/bin/tini ; tini --version ; apt-get purge -y --auto-remove wget\n#   https://www.apache.org/dist/couchdb/KEYS\nENV GPG_KEYS=\"15DD4F3B8AACA54740EB78C7B7B7C53943ECCEE1  1CFBFA43C19B6DF4A0CA3934669C02FFDF3CEBA3  25BBBAC113C1BFD5AA594A4C9F96B92930380381  4BFCA2B99BADC6F9F105BEC9C5E32E2D6B065BFB  5D680346FAA3E51B29DBCB681015F68F9DA248BC  7BCCEB868313DDA925DF1805ECA5BCB7BB9656B0  C3F4DFAEAD621E1C94523AEEC376457E61D50B88  D2B17F9DA23C0A10991AF2E3D9EE01E47852AEE4  E0AF0A194D55C84E4A19A801CDB0C0F904F4EE9B\"\nRUN set -xe \\\n && for key in $GPG_KEYS; do gpg --keyserver ha.pool.sks-keyservers.net --recv-keys \"$key\" ; done\nENV COUCHDB_VERSION=\"1.7.2\"\n#   download dependencies, compile and install couchdb,\n#   set correct permissions, expose couchdb to the outside and disable logging to disk\nRUN buildDeps=' gcc g++ erlang-dev libcurl4-openssl-dev libicu-dev libmozjs185-dev libnspr4-dev make ' \\\n && apt-get update \\\n && apt-get install --no-install-recommends $buildDeps -y \\\n && curl -fSL https://archive.apache.org/dist/couchdb/source/$COUCHDB_VERSION/apache-couchdb-$COUCHDB_VERSION.tar.gz -o couchdb.tar.gz \\\n && curl -fSL https://archive.apache.org/dist/couchdb/source/$COUCHDB_VERSION/apache-couchdb-$COUCHDB_VERSION.tar.gz.asc -o couchdb.tar.gz.asc \\\n && gpg --batch --verify couchdb.tar.gz.asc couchdb.tar.gz \\\n && mkdir -p /usr/src/couchdb \\\n && tar -xzf couchdb.tar.gz -C /usr/src/couchdb --strip-components=1 \\\n && cd /usr/src/couchdb \\\n && ./configure --with-js-lib=/usr/lib --with-js-include=/usr/include/mozjs \\\n && make \\\n && make install \\\n && apt-get purge -y --auto-remove $buildDeps \\\n && rm -rf /var/lib/apt/lists/* /usr/src/couchdb /couchdb.tar.gz* \\\n && chown -R couchdb:couchdb /usr/local/lib/couchdb /usr/local/etc/couchdb /usr/local/var/lib/couchdb /usr/local/var/log/couchdb /usr/local/var/run/couchdb \\\n && chmod -R g+rw /usr/local/lib/couchdb /usr/local/etc/couchdb /usr/local/var/lib/couchdb /usr/local/var/log/couchdb /usr/local/var/run/couchdb \\\n && mkdir -p /var/lib/couchdb \\\n && sed -e 's/^bind_address = .*$/bind_address = 0.0.0.0/' -i /usr/local/etc/couchdb/default.ini \\\n && sed -e 's!/usr/local/var/log/couchdb/couch.log$!/dev/null!' -i /usr/local/etc/couchdb/default.ini\nCOPY ./docker-entrypoint.sh /\n#   Define mountable directories.\nVOLUME [\"/usr/local/var/lib/couchdb\"]\nEXPOSE 5984/tcp\nWORKDIR /var/lib/couchdb\nENTRYPOINT [\"tini\", \"--\", \"/docker-entrypoint.sh\"]\nCMD [\"couchdb\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n#  use this file except in compliance with the License. You may obtain a copy of\n#  the License at\n#\n#    http://www.apache.org/licenses/LICENSE-2.0\n#\n#  Unless required by applicable law or agreed to in writing, software\n#  distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n#  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n#  License for the specific language governing permissions and limitations under\n#  the License.\nFROM debian:jessie\nMAINTAINER CouchDB Developers dev@couchdb.apache.org\n#  Install instructions from https://cwiki.apache.org/confluence/display/COUCHDB/Debian\nRUN groupadd -g 5984 -r couchdb \\\n && useradd -u 5984 -d /opt/couchdb -g couchdb couchdb\nRUN apt-get update -y \\\n && apt-get install --no-install-recommends ca-certificates curl erlang-nox libicu52 libmozjs185-1.0 libnspr4 libnspr4-0d -y \\\n && rm -rf /var/lib/apt/lists/*\nENV GOSU_VERSION=\"1.10\"\nENV TINI_VERSION=\"0.16.1\"\nRUN set -ex ; apt-get update ; apt-get install --no-install-recommends wget -y ; rm -rf /var/lib/apt/lists/* ; dpkgArch=\"$( dpkg --print-architecture | awk -F- '{ print $NF }' ;)\" ; wget -O /usr/local/bin/gosu \"https://github.com/tianon/gosu/releases/download/${GOSU_VERSION}/gosu-$dpkgArch\" ; wget -O /usr/local/bin/gosu.asc \"https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-$dpkgArch.asc\" ; export GNUPGHOME=\"$( mktemp -d ;)\" ; gpg --keyserver ha.pool.sks-keyservers.net --recv-keys B42F6819007F00F88E364FD4036A9C25BF357DD4 ; gpg --batch --verify /usr/local/bin/gosu.asc /usr/local/bin/gosu ; rm -r \"$GNUPGHOME\" /usr/local/bin/gosu.asc ; chmod +x /usr/local/bin/gosu ; gosu nobody true ; wget -O /usr/local/bin/tini \"https://github.com/krallin/tini/releases/download/v${TINI_VERSION}/tini-$dpkgArch\" ; wget -O /usr/local/bin/tini.asc \"https://github.com/krallin/tini/releases/download/v${TINI_VERSION}/tini-$dpkgArch.asc\" ; export GNUPGHOME=\"$( mktemp -d ;)\" ; gpg --keyserver ha.pool.sks-keyservers.net --recv-keys 595E85A6B1B4779EA4DAAEC70B588DFF0527A9B7 ; gpg --batch --verify /usr/local/bin/tini.asc /usr/local/bin/tini ; rm -r \"$GNUPGHOME\" /usr/local/bin/tini.asc ; chmod +x /usr/local/bin/tini ; tini --version ; apt-get purge -y --auto-remove wget\n#  https://www.apache.org/dist/couchdb/KEYS\nENV GPG_KEYS=\"15DD4F3B8AACA54740EB78C7B7B7C53943ECCEE1  1CFBFA43C19B6DF4A0CA3934669C02FFDF3CEBA3  25BBBAC113C1BFD5AA594A4C9F96B92930380381  4BFCA2B99BADC6F9F105BEC9C5E32E2D6B065BFB  5D680346FAA3E51B29DBCB681015F68F9DA248BC  7BCCEB868313DDA925DF1805ECA5BCB7BB9656B0  C3F4DFAEAD621E1C94523AEEC376457E61D50B88  D2B17F9DA23C0A10991AF2E3D9EE01E47852AEE4  E0AF0A194D55C84E4A19A801CDB0C0F904F4EE9B\"\nRUN set -xe \\\n && for key in $GPG_KEYS; do gpg --keyserver ha.pool.sks-keyservers.net --recv-keys \"$key\" ; done\nENV COUCHDB_VERSION=\"1.7.2\"\n#  download dependencies, compile and install couchdb,\n#  set correct permissions, expose couchdb to the outside and disable logging to disk\nRUN buildDeps=' gcc g++ erlang-dev libcurl4-openssl-dev libicu-dev libmozjs185-dev libnspr4-dev make ' \\\n && apt-get update \\\n && apt-get install --no-install-recommends $buildDeps -y \\\n && curl -fSL https://archive.apache.org/dist/couchdb/source/$COUCHDB_VERSION/apache-couchdb-$COUCHDB_VERSION.tar.gz -o couchdb.tar.gz \\\n && curl -fSL https://archive.apache.org/dist/couchdb/source/$COUCHDB_VERSION/apache-couchdb-$COUCHDB_VERSION.tar.gz.asc -o couchdb.tar.gz.asc \\\n && gpg --batch --verify couchdb.tar.gz.asc couchdb.tar.gz \\\n && mkdir -p /usr/src/couchdb \\\n && tar -xzf couchdb.tar.gz -C /usr/src/couchdb --strip-components=1 \\\n && cd /usr/src/couchdb \\\n && ./configure --with-js-lib=/usr/lib --with-js-include=/usr/include/mozjs \\\n && make \\\n && make install \\\n && apt-get purge -y --auto-remove $buildDeps \\\n && rm -rf /var/lib/apt/lists/* /usr/src/couchdb /couchdb.tar.gz* \\\n && chown -R couchdb:couchdb /usr/local/lib/couchdb /usr/local/etc/couchdb /usr/local/var/lib/couchdb /usr/local/var/log/couchdb /usr/local/var/run/couchdb \\\n && chmod -R g+rw /usr/local/lib/couchdb /usr/local/etc/couchdb /usr/local/var/lib/couchdb /usr/local/var/log/couchdb /usr/local/var/run/couchdb \\\n && mkdir -p /var/lib/couchdb \\\n && sed -e 's/^bind_address = .*$/bind_address = 0.0.0.0/' -i /usr/local/etc/couchdb/default.ini \\\n && sed -e 's!/usr/local/var/log/couchdb/couch.log$!/dev/null!' -i /usr/local/etc/couchdb/default.ini\nCOPY ./docker-entrypoint.sh /\n#  Define mountable directories.\nVOLUME [\"/usr/local/var/lib/couchdb\"]\nEXPOSE 5984/tcp\nWORKDIR /var/lib/couchdb\nENTRYPOINT [\"tini\", \"--\", \"/docker-entrypoint.sh\"]\nCMD [\"couchdb\"]\n","injectedSmells":[],"originalDockerfileHash":"c86ede1132317f42c87c16e69bc2a659","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   Licensed under the Apache License, Version 2.0 (the \"License\"); you may not\n#   use this file except in compliance with the License. You may obtain a copy of\n#   the License at\n#\n#     http://www.apache.org/licenses/LICENSE-2.0\n#\n#   Unless required by applicable law or agreed to in writing, software\n#   distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT\n#   WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the\n#   License for the specific language governing permissions and limitations under\n#   the License.\nFROM debian:jessie\nMAINTAINER CouchDB Developers dev@couchdb.apache.org\n#   Install instructions from https://cwiki.apache.org/confluence/display/COUCHDB/Debian\nRUN groupadd -g 5984 -r couchdb \\\n && useradd -u 5984 -d /opt/couchdb -g couchdb couchdb\nRUN apt-get update -y \\\n && apt-get install --no-install-recommends ca-certificates curl erlang-nox libicu52 libmozjs185-1.0 libnspr4 libnspr4-0d -y \\\n && rm -rf /var/lib/apt/lists/*\nENV GOSU_VERSION=\"1.10\"\nENV TINI_VERSION=\"0.16.1\"\nRUN set -ex ; apt-get update ; apt-get install --no-install-recommends wget -y ; rm -rf /var/lib/apt/lists/* ; dpkgArch=\"$( dpkg --print-architecture | awk -F- '{ print $NF }' ;)\" ; wget -O /usr/local/bin/gosu \"https://github.com/tianon/gosu/releases/download/${GOSU_VERSION}/gosu-$dpkgArch\" ; wget -O /usr/local/bin/gosu.asc \"https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-$dpkgArch.asc\" ; export GNUPGHOME=\"$( mktemp -d ;)\" ; gpg --keyserver ha.pool.sks-keyservers.net --recv-keys B42F6819007F00F88E364FD4036A9C25BF357DD4 ; gpg --batch --verify /usr/local/bin/gosu.asc /usr/local/bin/gosu ; rm -r \"$GNUPGHOME\" /usr/local/bin/gosu.asc ; chmod +x /usr/local/bin/gosu ; gosu nobody true ; wget -O /usr/local/bin/tini \"https://github.com/krallin/tini/releases/download/v${TINI_VERSION}/tini-$dpkgArch\" ; wget -O /usr/local/bin/tini.asc \"https://github.com/krallin/tini/releases/download/v${TINI_VERSION}/tini-$dpkgArch.asc\" ; export GNUPGHOME=\"$( mktemp -d ;)\" ; gpg --keyserver ha.pool.sks-keyservers.net --recv-keys 595E85A6B1B4779EA4DAAEC70B588DFF0527A9B7 ; gpg --batch --verify /usr/local/bin/tini.asc /usr/local/bin/tini ; rm -r \"$GNUPGHOME\" /usr/local/bin/tini.asc ; chmod +x /usr/local/bin/tini ; tini --version ; apt-get purge -y --auto-remove wget\n#   https://www.apache.org/dist/couchdb/KEYS\nENV GPG_KEYS=\"15DD4F3B8AACA54740EB78C7B7B7C53943ECCEE1  1CFBFA43C19B6DF4A0CA3934669C02FFDF3CEBA3  25BBBAC113C1BFD5AA594A4C9F96B92930380381  4BFCA2B99BADC6F9F105BEC9C5E32E2D6B065BFB  5D680346FAA3E51B29DBCB681015F68F9DA248BC  7BCCEB868313DDA925DF1805ECA5BCB7BB9656B0  C3F4DFAEAD621E1C94523AEEC376457E61D50B88  D2B17F9DA23C0A10991AF2E3D9EE01E47852AEE4  E0AF0A194D55C84E4A19A801CDB0C0F904F4EE9B\"\nRUN set -xe \\\n && for key in $GPG_KEYS; do gpg --keyserver ha.pool.sks-keyservers.net --recv-keys \"$key\" ; done\nENV COUCHDB_VERSION=\"1.7.2\"\n#   download dependencies, compile and install couchdb,\n#   set correct permissions, expose couchdb to the outside and disable logging to disk\nRUN buildDeps=' gcc g++ erlang-dev libcurl4-openssl-dev libicu-dev libmozjs185-dev libnspr4-dev make ' \\\n && apt-get update \\\n && apt-get install --no-install-recommends $buildDeps -y \\\n && curl -fSL https://archive.apache.org/dist/couchdb/source/$COUCHDB_VERSION/apache-couchdb-$COUCHDB_VERSION.tar.gz -o couchdb.tar.gz \\\n && curl -fSL https://archive.apache.org/dist/couchdb/source/$COUCHDB_VERSION/apache-couchdb-$COUCHDB_VERSION.tar.gz.asc -o couchdb.tar.gz.asc \\\n && gpg --batch --verify couchdb.tar.gz.asc couchdb.tar.gz \\\n && mkdir -p /usr/src/couchdb \\\n && tar -xzf couchdb.tar.gz -C /usr/src/couchdb --strip-components=1 \\\n && cd /usr/src/couchdb \\\n && ./configure --with-js-lib=/usr/lib --with-js-include=/usr/include/mozjs \\\n && make \\\n && make install \\\n && apt-get purge -y --auto-remove $buildDeps \\\n && rm -rf /var/lib/apt/lists/* /usr/src/couchdb /couchdb.tar.gz* \\\n && chown -R couchdb:couchdb /usr/local/lib/couchdb /usr/local/etc/couchdb /usr/local/var/lib/couchdb /usr/local/var/log/couchdb /usr/local/var/run/couchdb \\\n && chmod -R g+rw /usr/local/lib/couchdb /usr/local/etc/couchdb /usr/local/var/lib/couchdb /usr/local/var/log/couchdb /usr/local/var/run/couchdb \\\n && mkdir -p /var/lib/couchdb \\\n && sed -e 's/^bind_address = .*$/bind_address = 0.0.0.0/' -i /usr/local/etc/couchdb/default.ini \\\n && sed -e 's!/usr/local/var/log/couchdb/couch.log$!/dev/null!' -i /usr/local/etc/couchdb/default.ini\nCOPY ./docker-entrypoint.sh /\n#   Define mountable directories.\nVOLUME [\"/usr/local/var/lib/couchdb\"]\nEXPOSE 5984/tcp\nWORKDIR /var/lib/couchdb\nENTRYPOINT [\"tini\", \"--\", \"/docker-entrypoint.sh\"]\nCMD [\"couchdb\"]\n","originalDockerfileUglifiedHash":"e7e67a7a7d56d100577ceba39a345067","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/5e6054c0a1c70650f34b81ddfe81edeaa11bae39.dockerfile"}