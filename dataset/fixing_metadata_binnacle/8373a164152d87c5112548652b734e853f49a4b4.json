{"seed":1134056360,"processedDockerfileHash":"052c2478117b551d2d9f135fa50d6af1","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","have-a-healthcheck","have-a-user"],"processedDockerfile":"#  todo 中文环境支持\n#   Dockerfile - alpine\n#   https://github.com/openresty/docker-openresty\nFROM supermy/alpine\n#  FROM alpine:latest\nMAINTAINER JamesMo <springclick@gmail.com>\n#   Docker Build Arguments\nARG RESTY_VERSION=\"1.11.2.3\"\nARG RESTY_LUAROCKS_VERSION=\"2.4.2\"\nARG RESTY_OPENSSL_VERSION=\"1.0.2k\"\nARG RESTY_PCRE_VERSION=\"8.39\"\nARG RESTY_J=\"1\"\nARG RESTY_CONFIG_OPTIONS=\" --with-file-aio  --with-http_addition_module  --with-http_auth_request_module  --with-http_dav_module  --with-http_flv_module  --with-http_geoip_module=dynamic  --with-http_gunzip_module  --with-http_gzip_static_module  --with-http_image_filter_module=dynamic  --with-http_mp4_module  --with-http_random_index_module  --with-http_realip_module  --with-http_secure_link_module  --with-http_slice_module  --with-http_ssl_module  --with-http_stub_status_module  --with-http_sub_module  --with-http_v2_module  --with-http_xslt_module=dynamic  --with-ipv6  --with-mail  --with-mail_ssl_module  --with-md5-asm  --with-pcre-jit  --with-sha1-asm  --with-stream  --with-stream_ssl_module  --with-threads  \"\n#   These are not intended to be user-specified\nARG _RESTY_CONFIG_DEPS=\"--with-openssl=/tmp/openssl-${RESTY_OPENSSL_VERSION} --with-pcre=/tmp/pcre-${RESTY_PCRE_VERSION}\"\n#   1) Install apk dependencies\n#   2) Download and untar OpenSSL, PCRE, and OpenResty\n#   3) Build OpenResty\n#   4) Cleanup\nRUN apk add curl=7.88.1-r1 gd-dev=2.3.3-r3 geoip-dev=1.6.12-r3 libxslt-dev=1.1.37-r1 perl-dev=5.36.0-r0 readline-dev=8.2.0-r0 zlib-dev=1.2.13-r0 --no-cache --virtual .build-deps \\\n && apk add build-base=0.5-r3 curl=7.88.1-r1 gd=2.3.3-r3 geoip=1.6.12-r3 libgcc=12.2.1_git20220924-r4 libxslt=1.1.37-r1 linux-headers=5.19.5-r0 make=4.3-r1 perl=5.36.0-r0 unzip=6.0-r13 zlib=1.2.13-r0 --no-cache \\\n && cd /tmp \\\n && curl -k -fSL https://www.openssl.org/source/openssl-${RESTY_OPENSSL_VERSION}.tar.gz -o openssl-${RESTY_OPENSSL_VERSION}.tar.gz \\\n && tar xzf openssl-${RESTY_OPENSSL_VERSION}.tar.gz \\\n && curl -k -fSL https://ftp.pcre.org/pub/pcre/pcre-${RESTY_PCRE_VERSION}.tar.gz -o pcre-${RESTY_PCRE_VERSION}.tar.gz \\\n && tar xzf pcre-${RESTY_PCRE_VERSION}.tar.gz \\\n && curl -k -fSL https://openresty.org/download/openresty-${RESTY_VERSION}.tar.gz -o openresty-${RESTY_VERSION}.tar.gz \\\n && tar xzf openresty-${RESTY_VERSION}.tar.gz \\\n && cd /tmp/openresty-${RESTY_VERSION} \\\n && ./configure -j${RESTY_J} ${_RESTY_CONFIG_DEPS} ${RESTY_CONFIG_OPTIONS} \\\n && make -j${RESTY_J} \\\n && make -j${RESTY_J} install \\\n && cd /tmp \\\n && rm -rf openssl-${RESTY_OPENSSL_VERSION} openssl-${RESTY_OPENSSL_VERSION}.tar.gz openresty-${RESTY_VERSION}.tar.gz openresty-${RESTY_VERSION} pcre-${RESTY_PCRE_VERSION}.tar.gz pcre-${RESTY_PCRE_VERSION}\n#  安装 luarocks\nRUN apk add git=2.38.4-r1 --no-cache \\\n && cd /tmp \\\n && git clone https://github.com/keplerproject/luarocks.git \\\n && cd luarocks \\\n && sh ./configure --prefix=/usr/local/openresty/luajit --with-lua=/usr/local/openresty/luajit/ --lua-suffix=jit --with-lua-include=/usr/local/openresty/luajit/include/luajit-2.1 \\\n && make build install \\\n && cd \\\n && rm -rf /tmp/luarocks \\\n && cd /tmp \\\n && rm -rf luarocks-${RESTY_LUAROCKS_VERSION} luarocks-${RESTY_LUAROCKS_VERSION}.tar.gz \\\n && apk del .build-deps \\\n && ln -sf /dev/stdout /usr/local/openresty/nginx/logs/access.log \\\n && ln -sf /dev/stderr /usr/local/openresty/nginx/logs/error.log\n#  RUN curl  -fSL http://luarocks.org/releases/luarocks-${RESTY_LUAROCKS_VERSION}.tar.gz -o luarocks-${RESTY_LUAROCKS_VERSION}.tar.gz \\\n#      && tar xzf luarocks-${RESTY_LUAROCKS_VERSION}.tar.gz \\\n#      && cd luarocks-${RESTY_LUAROCKS_VERSION} \\\n#      && ./configure \\\n#          --prefix=/usr/local/openresty/luajit \\\n#          --with-lua=/usr/local/openresty/luajit \\\n#          --lua-suffix=jit-2.1.0-beta2 \\\n#          --with-lua-include=/usr/local/openresty/luajit/include/luajit-2.1 \\\n#      && make build \\\n#      && make install \\\n#\n#      && cd /tmp \\\n#      && rm -rf luarocks-${RESTY_LUAROCKS_VERSION} luarocks-${RESTY_LUAROCKS_VERSION}.tar.gz \\\n#      && apk del .build-deps \\\n#\n#      && ln -sf /dev/stdout /usr/local/openresty/nginx/logs/access.log \\\n#      && ln -sf /dev/stderr /usr/local/openresty/nginx/logs/error.log\n#   Add additional binaries into PATH for convenience\nENV PATH=\"$PATH:/usr/local/openresty/luajit/bin/:/usr/local/openresty/nginx/sbin/:/usr/local/openresty/bin/\"\nENTRYPOINT [\"/usr/local/openresty/bin/openresty\", \"-g\", \"daemon\", \"off\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"# todo 中文环境支持\n#  Dockerfile - alpine\n#  https://github.com/openresty/docker-openresty\nFROM supermy/alpine\n# FROM alpine:latest\nMAINTAINER JamesMo <springclick@gmail.com>\n#  Docker Build Arguments\nARG RESTY_VERSION=\"1.11.2.3\"\nARG RESTY_LUAROCKS_VERSION=\"2.4.2\"\nARG RESTY_OPENSSL_VERSION=\"1.0.2k\"\nARG RESTY_PCRE_VERSION=\"8.39\"\nARG RESTY_J=\"1\"\nARG RESTY_CONFIG_OPTIONS=\" --with-file-aio  --with-http_addition_module  --with-http_auth_request_module  --with-http_dav_module  --with-http_flv_module  --with-http_geoip_module=dynamic  --with-http_gunzip_module  --with-http_gzip_static_module  --with-http_image_filter_module=dynamic  --with-http_mp4_module  --with-http_random_index_module  --with-http_realip_module  --with-http_secure_link_module  --with-http_slice_module  --with-http_ssl_module  --with-http_stub_status_module  --with-http_sub_module  --with-http_v2_module  --with-http_xslt_module=dynamic  --with-ipv6  --with-mail  --with-mail_ssl_module  --with-md5-asm  --with-pcre-jit  --with-sha1-asm  --with-stream  --with-stream_ssl_module  --with-threads  \"\n#  These are not intended to be user-specified\nARG _RESTY_CONFIG_DEPS=\"--with-openssl=/tmp/openssl-${RESTY_OPENSSL_VERSION} --with-pcre=/tmp/pcre-${RESTY_PCRE_VERSION}\"\n#  1) Install apk dependencies\n#  2) Download and untar OpenSSL, PCRE, and OpenResty\n#  3) Build OpenResty\n#  4) Cleanup\nRUN apk add --no-cache --virtual .build-deps curl gd-dev geoip-dev libxslt-dev perl-dev readline-dev zlib-dev \\\n && apk add --no-cache build-base curl gd geoip libgcc libxslt linux-headers make perl unzip zlib \\\n && cd /tmp \\\n && curl -k -fSL https://www.openssl.org/source/openssl-${RESTY_OPENSSL_VERSION}.tar.gz -o openssl-${RESTY_OPENSSL_VERSION}.tar.gz \\\n && tar xzf openssl-${RESTY_OPENSSL_VERSION}.tar.gz \\\n && curl -k -fSL https://ftp.pcre.org/pub/pcre/pcre-${RESTY_PCRE_VERSION}.tar.gz -o pcre-${RESTY_PCRE_VERSION}.tar.gz \\\n && tar xzf pcre-${RESTY_PCRE_VERSION}.tar.gz \\\n && curl -k -fSL https://openresty.org/download/openresty-${RESTY_VERSION}.tar.gz -o openresty-${RESTY_VERSION}.tar.gz \\\n && tar xzf openresty-${RESTY_VERSION}.tar.gz \\\n && cd /tmp/openresty-${RESTY_VERSION} \\\n && ./configure -j${RESTY_J} ${_RESTY_CONFIG_DEPS} ${RESTY_CONFIG_OPTIONS} \\\n && make -j${RESTY_J} \\\n && make -j${RESTY_J} install \\\n && cd /tmp \\\n && rm -rf openssl-${RESTY_OPENSSL_VERSION} openssl-${RESTY_OPENSSL_VERSION}.tar.gz openresty-${RESTY_VERSION}.tar.gz openresty-${RESTY_VERSION} pcre-${RESTY_PCRE_VERSION}.tar.gz pcre-${RESTY_PCRE_VERSION}\n# 安装 luarocks\nRUN apk add --no-cache git \\\n && cd /tmp \\\n && git clone https://github.com/keplerproject/luarocks.git \\\n && cd luarocks \\\n && sh ./configure --prefix=/usr/local/openresty/luajit --with-lua=/usr/local/openresty/luajit/ --lua-suffix=jit --with-lua-include=/usr/local/openresty/luajit/include/luajit-2.1 \\\n && make build install \\\n && cd \\\n && rm -rf /tmp/luarocks \\\n && cd /tmp \\\n && rm -rf luarocks-${RESTY_LUAROCKS_VERSION} luarocks-${RESTY_LUAROCKS_VERSION}.tar.gz \\\n && apk del .build-deps \\\n && ln -sf /dev/stdout /usr/local/openresty/nginx/logs/access.log \\\n && ln -sf /dev/stderr /usr/local/openresty/nginx/logs/error.log\n# RUN curl  -fSL http://luarocks.org/releases/luarocks-${RESTY_LUAROCKS_VERSION}.tar.gz -o luarocks-${RESTY_LUAROCKS_VERSION}.tar.gz \\\n#     && tar xzf luarocks-${RESTY_LUAROCKS_VERSION}.tar.gz \\\n#     && cd luarocks-${RESTY_LUAROCKS_VERSION} \\\n#     && ./configure \\\n#         --prefix=/usr/local/openresty/luajit \\\n#         --with-lua=/usr/local/openresty/luajit \\\n#         --lua-suffix=jit-2.1.0-beta2 \\\n#         --with-lua-include=/usr/local/openresty/luajit/include/luajit-2.1 \\\n#     && make build \\\n#     && make install \\\n#\n#     && cd /tmp \\\n#     && rm -rf luarocks-${RESTY_LUAROCKS_VERSION} luarocks-${RESTY_LUAROCKS_VERSION}.tar.gz \\\n#     && apk del .build-deps \\\n#\n#     && ln -sf /dev/stdout /usr/local/openresty/nginx/logs/access.log \\\n#     && ln -sf /dev/stderr /usr/local/openresty/nginx/logs/error.log\n#  Add additional binaries into PATH for convenience\nENV PATH=\"$PATH:/usr/local/openresty/luajit/bin/:/usr/local/openresty/nginx/sbin/:/usr/local/openresty/bin/\"\nENTRYPOINT [\"/usr/local/openresty/bin/openresty\", \"-g\", \"daemon\", \"off\"]\n","injectedSmells":[],"originalDockerfileHash":"47c4fca3e20e7199a49c3adf439853a8","successfullyInjectedSmells":[],"originalDockerfileUglified":"#  todo 中文环境支持\n#   Dockerfile - alpine\n#   https://github.com/openresty/docker-openresty\nFROM supermy/alpine\n#  FROM alpine:latest\nMAINTAINER JamesMo <springclick@gmail.com>\n#   Docker Build Arguments\nARG RESTY_VERSION=\"1.11.2.3\"\nARG RESTY_LUAROCKS_VERSION=\"2.4.2\"\nARG RESTY_OPENSSL_VERSION=\"1.0.2k\"\nARG RESTY_PCRE_VERSION=\"8.39\"\nARG RESTY_J=\"1\"\nARG RESTY_CONFIG_OPTIONS=\" --with-file-aio  --with-http_addition_module  --with-http_auth_request_module  --with-http_dav_module  --with-http_flv_module  --with-http_geoip_module=dynamic  --with-http_gunzip_module  --with-http_gzip_static_module  --with-http_image_filter_module=dynamic  --with-http_mp4_module  --with-http_random_index_module  --with-http_realip_module  --with-http_secure_link_module  --with-http_slice_module  --with-http_ssl_module  --with-http_stub_status_module  --with-http_sub_module  --with-http_v2_module  --with-http_xslt_module=dynamic  --with-ipv6  --with-mail  --with-mail_ssl_module  --with-md5-asm  --with-pcre-jit  --with-sha1-asm  --with-stream  --with-stream_ssl_module  --with-threads  \"\n#   These are not intended to be user-specified\nARG _RESTY_CONFIG_DEPS=\"--with-openssl=/tmp/openssl-${RESTY_OPENSSL_VERSION} --with-pcre=/tmp/pcre-${RESTY_PCRE_VERSION}\"\n#   1) Install apk dependencies\n#   2) Download and untar OpenSSL, PCRE, and OpenResty\n#   3) Build OpenResty\n#   4) Cleanup\nRUN apk add --no-cache --virtual .build-deps curl gd-dev geoip-dev libxslt-dev perl-dev readline-dev zlib-dev \\\n && apk add --no-cache build-base curl gd geoip libgcc libxslt linux-headers make perl unzip zlib \\\n && cd /tmp \\\n && curl -k -fSL https://www.openssl.org/source/openssl-${RESTY_OPENSSL_VERSION}.tar.gz -o openssl-${RESTY_OPENSSL_VERSION}.tar.gz \\\n && tar xzf openssl-${RESTY_OPENSSL_VERSION}.tar.gz \\\n && curl -k -fSL https://ftp.pcre.org/pub/pcre/pcre-${RESTY_PCRE_VERSION}.tar.gz -o pcre-${RESTY_PCRE_VERSION}.tar.gz \\\n && tar xzf pcre-${RESTY_PCRE_VERSION}.tar.gz \\\n && curl -k -fSL https://openresty.org/download/openresty-${RESTY_VERSION}.tar.gz -o openresty-${RESTY_VERSION}.tar.gz \\\n && tar xzf openresty-${RESTY_VERSION}.tar.gz \\\n && cd /tmp/openresty-${RESTY_VERSION} \\\n && ./configure -j${RESTY_J} ${_RESTY_CONFIG_DEPS} ${RESTY_CONFIG_OPTIONS} \\\n && make -j${RESTY_J} \\\n && make -j${RESTY_J} install \\\n && cd /tmp \\\n && rm -rf openssl-${RESTY_OPENSSL_VERSION} openssl-${RESTY_OPENSSL_VERSION}.tar.gz openresty-${RESTY_VERSION}.tar.gz openresty-${RESTY_VERSION} pcre-${RESTY_PCRE_VERSION}.tar.gz pcre-${RESTY_PCRE_VERSION}\n#  安装 luarocks\nRUN apk add --no-cache git \\\n && cd /tmp \\\n && git clone https://github.com/keplerproject/luarocks.git \\\n && cd luarocks \\\n && sh ./configure --prefix=/usr/local/openresty/luajit --with-lua=/usr/local/openresty/luajit/ --lua-suffix=jit --with-lua-include=/usr/local/openresty/luajit/include/luajit-2.1 \\\n && make build install \\\n && cd \\\n && rm -rf /tmp/luarocks \\\n && cd /tmp \\\n && rm -rf luarocks-${RESTY_LUAROCKS_VERSION} luarocks-${RESTY_LUAROCKS_VERSION}.tar.gz \\\n && apk del .build-deps \\\n && ln -sf /dev/stdout /usr/local/openresty/nginx/logs/access.log \\\n && ln -sf /dev/stderr /usr/local/openresty/nginx/logs/error.log\n#  RUN curl  -fSL http://luarocks.org/releases/luarocks-${RESTY_LUAROCKS_VERSION}.tar.gz -o luarocks-${RESTY_LUAROCKS_VERSION}.tar.gz \\\n#      && tar xzf luarocks-${RESTY_LUAROCKS_VERSION}.tar.gz \\\n#      && cd luarocks-${RESTY_LUAROCKS_VERSION} \\\n#      && ./configure \\\n#          --prefix=/usr/local/openresty/luajit \\\n#          --with-lua=/usr/local/openresty/luajit \\\n#          --lua-suffix=jit-2.1.0-beta2 \\\n#          --with-lua-include=/usr/local/openresty/luajit/include/luajit-2.1 \\\n#      && make build \\\n#      && make install \\\n#\n#      && cd /tmp \\\n#      && rm -rf luarocks-${RESTY_LUAROCKS_VERSION} luarocks-${RESTY_LUAROCKS_VERSION}.tar.gz \\\n#      && apk del .build-deps \\\n#\n#      && ln -sf /dev/stdout /usr/local/openresty/nginx/logs/access.log \\\n#      && ln -sf /dev/stderr /usr/local/openresty/nginx/logs/error.log\n#   Add additional binaries into PATH for convenience\nENV PATH=\"$PATH:/usr/local/openresty/luajit/bin/:/usr/local/openresty/nginx/sbin/:/usr/local/openresty/bin/\"\nENTRYPOINT [\"/usr/local/openresty/bin/openresty\", \"-g\", \"daemon\", \"off\"]\n","originalDockerfileUglifiedHash":"6913381e5b3304dda1eebf6ce992e058","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/8373a164152d87c5112548652b734e853f49a4b4.dockerfile"}