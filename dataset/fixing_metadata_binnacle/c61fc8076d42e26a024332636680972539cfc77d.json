{"seed":1312342924,"processedDockerfileHash":"1d6455b905e539886ae115a0adbc2acc","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","pin-package-manager-versions-apt-get","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM xiaonanln/golang-jessie\n#   add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added\nRUN groupadd -r mongodb \\\n && useradd -r -g mongodb mongodb\nRUN apt-get update \\\n && apt-get install --no-install-recommends ca-certificates=20230311 jq=1.6-2.1ubuntu3 numactl=2.0.16-1 -y \\\n && rm -rf /var/lib/apt/lists/*\n#   grab gosu for easy step-down from root (https://github.com/tianon/gosu/releases)\nENV GOSU_VERSION=\"1.10\"\n#   grab \"js-yaml\" for parsing mongod's YAML config files (https://github.com/nodeca/js-yaml/releases)\nENV JSYAML_VERSION=\"3.10.0\"\nRUN set -ex ; apt-get update ; apt-get install --no-install-recommends wget=1.21.3-1ubuntu1 -y ; rm -rf /var/lib/apt/lists/* ; dpkgArch=\"$( dpkg --print-architecture | awk -F- '{ print $NF }' ;)\" ; wget -O /usr/local/bin/gosu \"https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-$dpkgArch\" ; wget -O /usr/local/bin/gosu.asc \"https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-$dpkgArch.asc\" ; export GNUPGHOME=\"$( mktemp -d ;)\" ; gpg --keyserver ha.pool.sks-keyservers.net --recv-keys B42F6819007F00F88E364FD4036A9C25BF357DD4 ; gpg --batch --verify /usr/local/bin/gosu.asc /usr/local/bin/gosu ; rm -r \"$GNUPGHOME\" /usr/local/bin/gosu.asc ; chmod +x /usr/local/bin/gosu ; gosu nobody true ; wget -O /js-yaml.js \"https://github.com/nodeca/js-yaml/raw/${JSYAML_VERSION}/dist/js-yaml.js\" ; apt-get purge -y --auto-remove wget\nRUN mkdir /docker-entrypoint-initdb.d\nENV GPG_KEYS=\"0C49F3730359A14518585931BC711F9BA15703C6\"\n#   https://docs.mongodb.com/manual/tutorial/verify-mongodb-packages/#download-then-import-the-key-file\nRUN set -ex ; export GNUPGHOME=\"$( mktemp -d ;)\" ; for key in $GPG_KEYS; do gpg --keyserver ha.pool.sks-keyservers.net --recv-keys \"$key\" ; done ; gpg --export $GPG_KEYS > /etc/apt/trusted.gpg.d/mongodb.gpg; rm -r \"$GNUPGHOME\" ; apt-key list\n#   Allow build-time overrides (eg. to build image with MongoDB Enterprise version)\n#   Options for MONGO_PACKAGE: mongodb-org OR mongodb-enterprise\n#   Options for MONGO_REPO: repo.mongodb.org OR repo.mongodb.com\n#   Example: docker build --build-arg MONGO_PACKAGE=mongodb-enterprise --build-arg MONGO_REPO=repo.mongodb.com .\nARG MONGO_PACKAGE=mongodb-org\nARG MONGO_REPO=repo.mongodb.org\nENV MONGO_PACKAGE=\"${MONGO_PACKAGE}\" \\\n    MONGO_REPO=\"${MONGO_REPO}\"\nENV MONGO_MAJOR=\"3.4\"\nENV MONGO_VERSION=\"3.4.15\"\nRUN echo \"deb http://$MONGO_REPO/apt/debian jessie/${MONGO_PACKAGE%-unstable}/$MONGO_MAJOR main\" | tee \"/etc/apt/sources.list.d/${MONGO_PACKAGE%-unstable}.list\"\nRUN set -x \\\n && apt-get update \\\n && apt-get install --no-install-recommends ${MONGO_PACKAGE}=$MONGO_VERSION ${MONGO_PACKAGE}-server=$MONGO_VERSION ${MONGO_PACKAGE}-shell=$MONGO_VERSION ${MONGO_PACKAGE}-mongos=$MONGO_VERSION ${MONGO_PACKAGE}-tools=$MONGO_VERSION -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && rm -rf /var/lib/mongodb \\\n && mv /etc/mongod.conf /etc/mongod.conf.orig\nRUN mkdir -p /data/db /data/configdb \\\n && chown -R mongodb:mongodb /data/db /data/configdb\nVOLUME /data/db /data/configdb\n#  COPY mongod-docker-entrypoint.sh /usr/local/bin/docker-entrypoint.sh\n#  RUN chmod a+x /usr/local/bin/docker-entrypoint.sh\n#  RUN ln -s usr/local/bin/docker-entrypoint.sh /entrypoint.sh # backwards compat\n#  # Install Useful Tools For Development\nRUN apt-get update \\\n && apt-get install --no-install-recommends vim=2:9.0.1000-4ubuntu2 less=590-1.2 git=1:2.39.2-1ubuntu1 -y \\\n && rm -rf /var/lib/apt/lists/*\nENV HOME=\"/root\"\nENV GOPATH=\"$HOME/go\" \\\n    PATH=\"$HOME/go/bin:$PATH\"\nRUN echo \"GOPATH: $GOPATH\"\nRUN echo \"PATH: $PATH\"\nWORKDIR $HOME\nRUN go get -u github.com/golang/dep/cmd/dep\nRUN go get -d github.com/xiaonanln/goworld\nWORKDIR $GOPATH/src/github.com/xiaonanln/goworld\nRUN dep ensure\nRUN go get ./cmd/...\nRUN make all\n#   RUN MongoDB Server\nCOPY start_mongod.sh .\nCMD ./start_mongod.sh \\\n && bash\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM xiaonanln/golang-jessie\n#  add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added\nRUN groupadd -r mongodb \\\n && useradd -r -g mongodb mongodb\nRUN apt-get update \\\n && apt-get install --no-install-recommends ca-certificates jq numactl -y \\\n && rm -rf /var/lib/apt/lists/*\n#  grab gosu for easy step-down from root (https://github.com/tianon/gosu/releases)\nENV GOSU_VERSION=\"1.10\"\n#  grab \"js-yaml\" for parsing mongod's YAML config files (https://github.com/nodeca/js-yaml/releases)\nENV JSYAML_VERSION=\"3.10.0\"\nRUN set -ex ; apt-get update ; apt-get install --no-install-recommends wget -y ; rm -rf /var/lib/apt/lists/* ; dpkgArch=\"$( dpkg --print-architecture | awk -F- '{ print $NF }' ;)\" ; wget -O /usr/local/bin/gosu \"https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-$dpkgArch\" ; wget -O /usr/local/bin/gosu.asc \"https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-$dpkgArch.asc\" ; export GNUPGHOME=\"$( mktemp -d ;)\" ; gpg --keyserver ha.pool.sks-keyservers.net --recv-keys B42F6819007F00F88E364FD4036A9C25BF357DD4 ; gpg --batch --verify /usr/local/bin/gosu.asc /usr/local/bin/gosu ; rm -r \"$GNUPGHOME\" /usr/local/bin/gosu.asc ; chmod +x /usr/local/bin/gosu ; gosu nobody true ; wget -O /js-yaml.js \"https://github.com/nodeca/js-yaml/raw/${JSYAML_VERSION}/dist/js-yaml.js\" ; apt-get purge -y --auto-remove wget\nRUN mkdir /docker-entrypoint-initdb.d\nENV GPG_KEYS=\"0C49F3730359A14518585931BC711F9BA15703C6\"\n#  https://docs.mongodb.com/manual/tutorial/verify-mongodb-packages/#download-then-import-the-key-file\nRUN set -ex ; export GNUPGHOME=\"$( mktemp -d ;)\" ; for key in $GPG_KEYS; do gpg --keyserver ha.pool.sks-keyservers.net --recv-keys \"$key\" ; done ; gpg --export $GPG_KEYS > /etc/apt/trusted.gpg.d/mongodb.gpg; rm -r \"$GNUPGHOME\" ; apt-key list\n#  Allow build-time overrides (eg. to build image with MongoDB Enterprise version)\n#  Options for MONGO_PACKAGE: mongodb-org OR mongodb-enterprise\n#  Options for MONGO_REPO: repo.mongodb.org OR repo.mongodb.com\n#  Example: docker build --build-arg MONGO_PACKAGE=mongodb-enterprise --build-arg MONGO_REPO=repo.mongodb.com .\nARG MONGO_PACKAGE=mongodb-org\nARG MONGO_REPO=repo.mongodb.org\nENV MONGO_PACKAGE=\"${MONGO_PACKAGE}\" \\\n    MONGO_REPO=\"${MONGO_REPO}\"\nENV MONGO_MAJOR=\"3.4\"\nENV MONGO_VERSION=\"3.4.15\"\nRUN echo \"deb http://$MONGO_REPO/apt/debian jessie/${MONGO_PACKAGE%-unstable}/$MONGO_MAJOR main\" | tee \"/etc/apt/sources.list.d/${MONGO_PACKAGE%-unstable}.list\"\nRUN set -x \\\n && apt-get update \\\n && apt-get install ${MONGO_PACKAGE}=$MONGO_VERSION ${MONGO_PACKAGE}-server=$MONGO_VERSION ${MONGO_PACKAGE}-shell=$MONGO_VERSION ${MONGO_PACKAGE}-mongos=$MONGO_VERSION ${MONGO_PACKAGE}-tools=$MONGO_VERSION -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && rm -rf /var/lib/mongodb \\\n && mv /etc/mongod.conf /etc/mongod.conf.orig\nRUN mkdir -p /data/db /data/configdb \\\n && chown -R mongodb:mongodb /data/db /data/configdb\nVOLUME /data/db /data/configdb\n# COPY mongod-docker-entrypoint.sh /usr/local/bin/docker-entrypoint.sh\n# RUN chmod a+x /usr/local/bin/docker-entrypoint.sh\n# RUN ln -s usr/local/bin/docker-entrypoint.sh /entrypoint.sh # backwards compat\n# # Install Useful Tools For Development\nRUN apt-get update \\\n && apt-get install --no-install-recommends vim less git -y \\\n && rm -rf /var/lib/apt/lists/*\nENV HOME=\"/root\"\nENV GOPATH=\"$HOME/go\" \\\n    PATH=\"$HOME/go/bin:$PATH\"\nRUN echo \"GOPATH: $GOPATH\"\nRUN echo \"PATH: $PATH\"\nWORKDIR $HOME\nRUN go get -u github.com/golang/dep/cmd/dep\nRUN go get -d github.com/xiaonanln/goworld\nWORKDIR $GOPATH/src/github.com/xiaonanln/goworld\nRUN dep ensure\nRUN go get ./cmd/...\nRUN make all\n#  RUN MongoDB Server\nADD start_mongod.sh .\nCMD ./start_mongod.sh \\\n && bash\n","injectedSmells":[],"originalDockerfileHash":"8c733451cd5e53fe921278034e38c38c","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM xiaonanln/golang-jessie\n#   add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added\nRUN groupadd -r mongodb \\\n && useradd -r -g mongodb mongodb\nRUN apt-get update \\\n && apt-get install --no-install-recommends ca-certificates jq numactl -y \\\n && rm -rf /var/lib/apt/lists/*\n#   grab gosu for easy step-down from root (https://github.com/tianon/gosu/releases)\nENV GOSU_VERSION=\"1.10\"\n#   grab \"js-yaml\" for parsing mongod's YAML config files (https://github.com/nodeca/js-yaml/releases)\nENV JSYAML_VERSION=\"3.10.0\"\nRUN set -ex ; apt-get update ; apt-get install --no-install-recommends wget -y ; rm -rf /var/lib/apt/lists/* ; dpkgArch=\"$( dpkg --print-architecture | awk -F- '{ print $NF }' ;)\" ; wget -O /usr/local/bin/gosu \"https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-$dpkgArch\" ; wget -O /usr/local/bin/gosu.asc \"https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-$dpkgArch.asc\" ; export GNUPGHOME=\"$( mktemp -d ;)\" ; gpg --keyserver ha.pool.sks-keyservers.net --recv-keys B42F6819007F00F88E364FD4036A9C25BF357DD4 ; gpg --batch --verify /usr/local/bin/gosu.asc /usr/local/bin/gosu ; rm -r \"$GNUPGHOME\" /usr/local/bin/gosu.asc ; chmod +x /usr/local/bin/gosu ; gosu nobody true ; wget -O /js-yaml.js \"https://github.com/nodeca/js-yaml/raw/${JSYAML_VERSION}/dist/js-yaml.js\" ; apt-get purge -y --auto-remove wget\nRUN mkdir /docker-entrypoint-initdb.d\nENV GPG_KEYS=\"0C49F3730359A14518585931BC711F9BA15703C6\"\n#   https://docs.mongodb.com/manual/tutorial/verify-mongodb-packages/#download-then-import-the-key-file\nRUN set -ex ; export GNUPGHOME=\"$( mktemp -d ;)\" ; for key in $GPG_KEYS; do gpg --keyserver ha.pool.sks-keyservers.net --recv-keys \"$key\" ; done ; gpg --export $GPG_KEYS > /etc/apt/trusted.gpg.d/mongodb.gpg; rm -r \"$GNUPGHOME\" ; apt-key list\n#   Allow build-time overrides (eg. to build image with MongoDB Enterprise version)\n#   Options for MONGO_PACKAGE: mongodb-org OR mongodb-enterprise\n#   Options for MONGO_REPO: repo.mongodb.org OR repo.mongodb.com\n#   Example: docker build --build-arg MONGO_PACKAGE=mongodb-enterprise --build-arg MONGO_REPO=repo.mongodb.com .\nARG MONGO_PACKAGE=mongodb-org\nARG MONGO_REPO=repo.mongodb.org\nENV MONGO_PACKAGE=\"${MONGO_PACKAGE}\" \\\n    MONGO_REPO=\"${MONGO_REPO}\"\nENV MONGO_MAJOR=\"3.4\"\nENV MONGO_VERSION=\"3.4.15\"\nRUN echo \"deb http://$MONGO_REPO/apt/debian jessie/${MONGO_PACKAGE%-unstable}/$MONGO_MAJOR main\" | tee \"/etc/apt/sources.list.d/${MONGO_PACKAGE%-unstable}.list\"\nRUN set -x \\\n && apt-get update \\\n && apt-get install ${MONGO_PACKAGE}=$MONGO_VERSION ${MONGO_PACKAGE}-server=$MONGO_VERSION ${MONGO_PACKAGE}-shell=$MONGO_VERSION ${MONGO_PACKAGE}-mongos=$MONGO_VERSION ${MONGO_PACKAGE}-tools=$MONGO_VERSION -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && rm -rf /var/lib/mongodb \\\n && mv /etc/mongod.conf /etc/mongod.conf.orig\nRUN mkdir -p /data/db /data/configdb \\\n && chown -R mongodb:mongodb /data/db /data/configdb\nVOLUME /data/db /data/configdb\n#  COPY mongod-docker-entrypoint.sh /usr/local/bin/docker-entrypoint.sh\n#  RUN chmod a+x /usr/local/bin/docker-entrypoint.sh\n#  RUN ln -s usr/local/bin/docker-entrypoint.sh /entrypoint.sh # backwards compat\n#  # Install Useful Tools For Development\nRUN apt-get update \\\n && apt-get install --no-install-recommends vim less git -y \\\n && rm -rf /var/lib/apt/lists/*\nENV HOME=\"/root\"\nENV GOPATH=\"$HOME/go\" \\\n    PATH=\"$HOME/go/bin:$PATH\"\nRUN echo \"GOPATH: $GOPATH\"\nRUN echo \"PATH: $PATH\"\nWORKDIR $HOME\nRUN go get -u github.com/golang/dep/cmd/dep\nRUN go get -d github.com/xiaonanln/goworld\nWORKDIR $GOPATH/src/github.com/xiaonanln/goworld\nRUN dep ensure\nRUN go get ./cmd/...\nRUN make all\n#   RUN MongoDB Server\nADD start_mongod.sh .\nCMD ./start_mongod.sh \\\n && bash\n","originalDockerfileUglifiedHash":"ea82a2274bf2418f3456e8b5e7e9adbf","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/c61fc8076d42e26a024332636680972539cfc77d.dockerfile"}