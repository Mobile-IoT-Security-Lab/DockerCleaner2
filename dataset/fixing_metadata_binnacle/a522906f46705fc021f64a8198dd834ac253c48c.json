{"seed":1884989711,"processedDockerfileHash":"12d69a5dbc0fd6c461a3bd81771fa992","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apt-get","have-a-healthcheck","have-a-user"],"processedDockerfile":"#   models_base\nFROM ubuntu:18.04\nWORKDIR /home\nRUN DEBIAN_FRONTEND=noninteractive apt-get update \\\n && apt-get install --no-install-recommends iputils-ping=3:20161105-1ubuntu3 git=1:2.17.1-1ubuntu0.17 -y -q\n#   Fetch python3 and Install python3\nRUN DEBIAN_FRONTEND=noninteractive apt-get update \\\n && apt-get install --no-install-recommends libprotobuf-dev=3.0.0-9.1ubuntu1.1 python3-dev=3.6.7-1~18.04 python3-pip=9.0.1-2.3~ubuntu1.18.04.8 virtualenv=15.1.0+ds-1.1 zlib1g-dev=1:1.2.11.dfsg-0ubuntu2.2 libssl-dev=1.1.1-1ubuntu2.1~18.04.21 libssl-doc=1.1.1-1ubuntu2.1~18.04.21 python3-setuptools=39.0.1-2ubuntu0.1 python3-wheel=0.30.0-0.2ubuntu0.1 -y -q\nRUN pip3 install numpy scipy -i https://pypi.tuna.tsinghua.edu.cn/simple/ --trusted-host pypi.tuna.tsinghua.edu.cn\n#   Install the MO in the DLDT\nARG DLDT_VER=2018_R4\nARG DLDT_REPO=https://github.com/opencv/dldt.git\nARG MO=/home/dldt/model-optimizer\nRUN git clone -b ${DLDT_VER} ${DLDT_REPO} ; cd dldt ; git submodule init ; git submodule update --recursive ; cd ${MO} ; pip3 install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple/ --trusted-host pypi.tuna.tsinghua.edu.cn\n#   Fetch the models\nARG MODEL_ZOO_VER=2018\nARG MODEL_ZOO_REPO=https://github.com/opencv/open_model_zoo.git\nRUN git clone -b ${MODEL_ZOO_VER} ${MODEL_ZOO_REPO}\nRUN pip3 install pyyaml requests\n#   Download and convert the Mobilenet-SSD model\nARG MO=/home/dldt/model-optimizer\nARG MODELS_DOWNLOAD_DIR=/home/tmp_models\nARG MODEL_ZOO_DIR=/home/video-analytics/models\nARG MODEL_NAME=mobilenet-ssd\nARG DEPLOY_MODEL_NAME=object_detection\nARG DEPLOY_MODEL_VERSION=1\nRUN cd /home/open_model_zoo/model_downloader ; python3 downloader.py --name ${MODEL_NAME} -o ${MODELS_DOWNLOAD_DIR} ; mkdir -p ${MODEL_ZOO_DIR}/${DEPLOY_MODEL_NAME}/${DEPLOY_MODEL_VERSION}/FP32 ; cd ${MODEL_ZOO_DIR}/${DEPLOY_MODEL_NAME}/${DEPLOY_MODEL_VERSION}/FP32 ; ${MO}/mo.py --framework caffe --data_type FP32 --input_shape [1,3,300,300] --input data --mean_values data[127.5,127.5,127.5] --scale_values data[127.50223128904757] --output detection_out --input_model ${MODELS_DOWNLOAD_DIR}/object_detection/common/mobilenet-ssd/caffe/${MODEL_NAME}.caffemodel --input_proto ${MODELS_DOWNLOAD_DIR}/object_detection/common/mobilenet-ssd/caffe/${MODEL_NAME}.prototxt\n#   Download and convert the face-detection-adas-0001 model\nARG MODEL_NAME=face-detection-adas-0001\nARG OUTPUT=Transportation/object_detection/face/pruned_mobilenet_reduced_ssd_shared_weights/dldt\nARG DEPLOY_MODEL_NAME=face_detection_adas\nARG DEPLOY_MODEL_VERSION=1\nRUN cd /home/open_model_zoo/model_downloader ; python3 downloader.py --name ${MODEL_NAME} -o ${MODELS_DOWNLOAD_DIR} ; mkdir -p ${MODEL_ZOO_DIR}/${DEPLOY_MODEL_NAME}/${DEPLOY_MODEL_VERSION}/FP32 ; cd ${MODEL_ZOO_DIR}/${DEPLOY_MODEL_NAME}/${DEPLOY_MODEL_VERSION}/FP32 ; cp ${MODELS_DOWNLOAD_DIR}/${OUTPUT}/* .\n#   Download and convert the face-detection-retail-0004 model\nARG MODEL_NAME=face-detection-retail-0004\nARG OUTPUT=Retail/object_detection/face/sqnet1.0modif-ssd/0004/dldt\nARG DEPLOY_MODEL_NAME=face_detection_retail\nARG DEPLOY_MODEL_VERSION=1\nRUN cd /home/open_model_zoo/model_downloader ; python3 downloader.py --name ${MODEL_NAME} -o ${MODELS_DOWNLOAD_DIR} ; mkdir -p ${MODEL_ZOO_DIR}/${DEPLOY_MODEL_NAME}/${DEPLOY_MODEL_VERSION}/FP32 ; cd ${MODEL_ZOO_DIR}/${DEPLOY_MODEL_NAME}/${DEPLOY_MODEL_VERSION}/FP32 ; cp ${MODELS_DOWNLOAD_DIR}/${OUTPUT}/* .\n#   Download and convert the face-reidentification-retail-0095 model\nARG MODEL_NAME=face-reidentification-retail-0095\nARG OUTPUT=Retail/object_reidentification/face/mobilenet_based/dldt\nARG DEPLOY_MODEL_NAME=face_reidentification\nARG DEPLOY_MODEL_VERSION=1\nRUN cd /home/open_model_zoo/model_downloader ; python3 downloader.py --name ${MODEL_NAME} -o ${MODELS_DOWNLOAD_DIR} ; mkdir -p ${MODEL_ZOO_DIR}/${DEPLOY_MODEL_NAME}/${DEPLOY_MODEL_VERSION}/FP32 ; cd ${MODEL_ZOO_DIR}/${DEPLOY_MODEL_NAME}/${DEPLOY_MODEL_VERSION}/FP32 ; cp ${MODELS_DOWNLOAD_DIR}/${OUTPUT}/* .\n#   Download and convert the emotions-recognition-retail-0003 model\nARG MODEL_NAME=emotions-recognition-retail-0003\nARG OUTPUT=Retail/object_attributes/emotions_recognition/0003/dldt\nARG DEPLOY_MODEL_NAME=emotion_recognition\nARG DEPLOY_MODEL_VERSION=1\nRUN cd /home/open_model_zoo/model_downloader ; python3 downloader.py --name ${MODEL_NAME} -o ${MODELS_DOWNLOAD_DIR} ; mkdir -p ${MODEL_ZOO_DIR}/${DEPLOY_MODEL_NAME}/${DEPLOY_MODEL_VERSION}/FP32 ; cd ${MODEL_ZOO_DIR}/${DEPLOY_MODEL_NAME}/${DEPLOY_MODEL_VERSION}/FP32 ; cp ${MODELS_DOWNLOAD_DIR}/${OUTPUT}/* .\n#   Download and convert the landmarks-regression-retail-0009 model\nARG MODEL_NAME=landmarks-regression-retail-0009\nARG OUTPUT=Retail/object_attributes/landmarks_regression/0009/dldt\nARG DEPLOY_MODEL_NAME=landmarks_regression\nARG DEPLOY_MODEL_VERSION=1\nRUN cd /home/open_model_zoo/model_downloader ; python3 downloader.py --name ${MODEL_NAME} -o ${MODELS_DOWNLOAD_DIR} ; mkdir -p ${MODEL_ZOO_DIR}/${DEPLOY_MODEL_NAME}/${DEPLOY_MODEL_VERSION}/FP32 ; cd ${MODEL_ZOO_DIR}/${DEPLOY_MODEL_NAME}/${DEPLOY_MODEL_VERSION}/FP32 ; cp ${MODELS_DOWNLOAD_DIR}/${OUTPUT}/* .\nRUN rm -rf ${MODELS_DOWNLOAD_DIR} \\\n && rm -rf /var/lib/apt/lists/*\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  models_base\nFROM ubuntu:18.04\nWORKDIR /home\nRUN DEBIAN_FRONTEND=noninteractive apt-get update \\\n && apt-get install --no-install-recommends iputils-ping git -y -q\n#  Fetch python3 and Install python3\nRUN DEBIAN_FRONTEND=noninteractive apt-get update \\\n && apt-get install --no-install-recommends libprotobuf-dev python3-dev python3-pip virtualenv zlib1g-dev libssl-dev libssl-doc python3-setuptools python3-wheel -y -q\nRUN pip3 install numpy scipy -i https://pypi.tuna.tsinghua.edu.cn/simple/ --trusted-host pypi.tuna.tsinghua.edu.cn\n#  Install the MO in the DLDT\nARG DLDT_VER=2018_R4\nARG DLDT_REPO=https://github.com/opencv/dldt.git\nARG MO=/home/dldt/model-optimizer\nRUN git clone -b ${DLDT_VER} ${DLDT_REPO} ; cd dldt ; git submodule init ; git submodule update --recursive ; cd ${MO} ; pip3 install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple/ --trusted-host pypi.tuna.tsinghua.edu.cn\n#  Fetch the models\nARG MODEL_ZOO_VER=2018\nARG MODEL_ZOO_REPO=https://github.com/opencv/open_model_zoo.git\nRUN git clone -b ${MODEL_ZOO_VER} ${MODEL_ZOO_REPO}\nRUN pip3 install pyyaml requests\n#  Download and convert the Mobilenet-SSD model\nARG MO=/home/dldt/model-optimizer\nARG MODELS_DOWNLOAD_DIR=/home/tmp_models\nARG MODEL_ZOO_DIR=/home/video-analytics/models\nARG MODEL_NAME=mobilenet-ssd\nARG DEPLOY_MODEL_NAME=object_detection\nARG DEPLOY_MODEL_VERSION=1\nRUN cd /home/open_model_zoo/model_downloader ; python3 downloader.py --name ${MODEL_NAME} -o ${MODELS_DOWNLOAD_DIR} ; mkdir -p ${MODEL_ZOO_DIR}/${DEPLOY_MODEL_NAME}/${DEPLOY_MODEL_VERSION}/FP32 ; cd ${MODEL_ZOO_DIR}/${DEPLOY_MODEL_NAME}/${DEPLOY_MODEL_VERSION}/FP32 ; ${MO}/mo.py --framework caffe --data_type FP32 --input_shape [1,3,300,300] --input data --mean_values data[127.5,127.5,127.5] --scale_values data[127.50223128904757] --output detection_out --input_model ${MODELS_DOWNLOAD_DIR}/object_detection/common/mobilenet-ssd/caffe/${MODEL_NAME}.caffemodel --input_proto ${MODELS_DOWNLOAD_DIR}/object_detection/common/mobilenet-ssd/caffe/${MODEL_NAME}.prototxt\n#  Download and convert the face-detection-adas-0001 model\nARG MODEL_NAME=face-detection-adas-0001\nARG OUTPUT=Transportation/object_detection/face/pruned_mobilenet_reduced_ssd_shared_weights/dldt\nARG DEPLOY_MODEL_NAME=face_detection_adas\nARG DEPLOY_MODEL_VERSION=1\nRUN cd /home/open_model_zoo/model_downloader ; python3 downloader.py --name ${MODEL_NAME} -o ${MODELS_DOWNLOAD_DIR} ; mkdir -p ${MODEL_ZOO_DIR}/${DEPLOY_MODEL_NAME}/${DEPLOY_MODEL_VERSION}/FP32 ; cd ${MODEL_ZOO_DIR}/${DEPLOY_MODEL_NAME}/${DEPLOY_MODEL_VERSION}/FP32 ; cp ${MODELS_DOWNLOAD_DIR}/${OUTPUT}/* .\n#  Download and convert the face-detection-retail-0004 model\nARG MODEL_NAME=face-detection-retail-0004\nARG OUTPUT=Retail/object_detection/face/sqnet1.0modif-ssd/0004/dldt\nARG DEPLOY_MODEL_NAME=face_detection_retail\nARG DEPLOY_MODEL_VERSION=1\nRUN cd /home/open_model_zoo/model_downloader ; python3 downloader.py --name ${MODEL_NAME} -o ${MODELS_DOWNLOAD_DIR} ; mkdir -p ${MODEL_ZOO_DIR}/${DEPLOY_MODEL_NAME}/${DEPLOY_MODEL_VERSION}/FP32 ; cd ${MODEL_ZOO_DIR}/${DEPLOY_MODEL_NAME}/${DEPLOY_MODEL_VERSION}/FP32 ; cp ${MODELS_DOWNLOAD_DIR}/${OUTPUT}/* .\n#  Download and convert the face-reidentification-retail-0095 model\nARG MODEL_NAME=face-reidentification-retail-0095\nARG OUTPUT=Retail/object_reidentification/face/mobilenet_based/dldt\nARG DEPLOY_MODEL_NAME=face_reidentification\nARG DEPLOY_MODEL_VERSION=1\nRUN cd /home/open_model_zoo/model_downloader ; python3 downloader.py --name ${MODEL_NAME} -o ${MODELS_DOWNLOAD_DIR} ; mkdir -p ${MODEL_ZOO_DIR}/${DEPLOY_MODEL_NAME}/${DEPLOY_MODEL_VERSION}/FP32 ; cd ${MODEL_ZOO_DIR}/${DEPLOY_MODEL_NAME}/${DEPLOY_MODEL_VERSION}/FP32 ; cp ${MODELS_DOWNLOAD_DIR}/${OUTPUT}/* .\n#  Download and convert the emotions-recognition-retail-0003 model\nARG MODEL_NAME=emotions-recognition-retail-0003\nARG OUTPUT=Retail/object_attributes/emotions_recognition/0003/dldt\nARG DEPLOY_MODEL_NAME=emotion_recognition\nARG DEPLOY_MODEL_VERSION=1\nRUN cd /home/open_model_zoo/model_downloader ; python3 downloader.py --name ${MODEL_NAME} -o ${MODELS_DOWNLOAD_DIR} ; mkdir -p ${MODEL_ZOO_DIR}/${DEPLOY_MODEL_NAME}/${DEPLOY_MODEL_VERSION}/FP32 ; cd ${MODEL_ZOO_DIR}/${DEPLOY_MODEL_NAME}/${DEPLOY_MODEL_VERSION}/FP32 ; cp ${MODELS_DOWNLOAD_DIR}/${OUTPUT}/* .\n#  Download and convert the landmarks-regression-retail-0009 model\nARG MODEL_NAME=landmarks-regression-retail-0009\nARG OUTPUT=Retail/object_attributes/landmarks_regression/0009/dldt\nARG DEPLOY_MODEL_NAME=landmarks_regression\nARG DEPLOY_MODEL_VERSION=1\nRUN cd /home/open_model_zoo/model_downloader ; python3 downloader.py --name ${MODEL_NAME} -o ${MODELS_DOWNLOAD_DIR} ; mkdir -p ${MODEL_ZOO_DIR}/${DEPLOY_MODEL_NAME}/${DEPLOY_MODEL_VERSION}/FP32 ; cd ${MODEL_ZOO_DIR}/${DEPLOY_MODEL_NAME}/${DEPLOY_MODEL_VERSION}/FP32 ; cp ${MODELS_DOWNLOAD_DIR}/${OUTPUT}/* .\nRUN rm -rf ${MODELS_DOWNLOAD_DIR} \\\n && rm -rf /var/lib/apt/lists/*\n","injectedSmells":[],"originalDockerfileHash":"c775e76f74f972ad8175fb52705aa90f","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   models_base\nFROM ubuntu:18.04\nWORKDIR /home\nRUN DEBIAN_FRONTEND=noninteractive apt-get update \\\n && apt-get install --no-install-recommends iputils-ping git -y -q\n#   Fetch python3 and Install python3\nRUN DEBIAN_FRONTEND=noninteractive apt-get update \\\n && apt-get install --no-install-recommends libprotobuf-dev python3-dev python3-pip virtualenv zlib1g-dev libssl-dev libssl-doc python3-setuptools python3-wheel -y -q\nRUN pip3 install numpy scipy -i https://pypi.tuna.tsinghua.edu.cn/simple/ --trusted-host pypi.tuna.tsinghua.edu.cn\n#   Install the MO in the DLDT\nARG DLDT_VER=2018_R4\nARG DLDT_REPO=https://github.com/opencv/dldt.git\nARG MO=/home/dldt/model-optimizer\nRUN git clone -b ${DLDT_VER} ${DLDT_REPO} ; cd dldt ; git submodule init ; git submodule update --recursive ; cd ${MO} ; pip3 install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple/ --trusted-host pypi.tuna.tsinghua.edu.cn\n#   Fetch the models\nARG MODEL_ZOO_VER=2018\nARG MODEL_ZOO_REPO=https://github.com/opencv/open_model_zoo.git\nRUN git clone -b ${MODEL_ZOO_VER} ${MODEL_ZOO_REPO}\nRUN pip3 install pyyaml requests\n#   Download and convert the Mobilenet-SSD model\nARG MO=/home/dldt/model-optimizer\nARG MODELS_DOWNLOAD_DIR=/home/tmp_models\nARG MODEL_ZOO_DIR=/home/video-analytics/models\nARG MODEL_NAME=mobilenet-ssd\nARG DEPLOY_MODEL_NAME=object_detection\nARG DEPLOY_MODEL_VERSION=1\nRUN cd /home/open_model_zoo/model_downloader ; python3 downloader.py --name ${MODEL_NAME} -o ${MODELS_DOWNLOAD_DIR} ; mkdir -p ${MODEL_ZOO_DIR}/${DEPLOY_MODEL_NAME}/${DEPLOY_MODEL_VERSION}/FP32 ; cd ${MODEL_ZOO_DIR}/${DEPLOY_MODEL_NAME}/${DEPLOY_MODEL_VERSION}/FP32 ; ${MO}/mo.py --framework caffe --data_type FP32 --input_shape [1,3,300,300] --input data --mean_values data[127.5,127.5,127.5] --scale_values data[127.50223128904757] --output detection_out --input_model ${MODELS_DOWNLOAD_DIR}/object_detection/common/mobilenet-ssd/caffe/${MODEL_NAME}.caffemodel --input_proto ${MODELS_DOWNLOAD_DIR}/object_detection/common/mobilenet-ssd/caffe/${MODEL_NAME}.prototxt\n#   Download and convert the face-detection-adas-0001 model\nARG MODEL_NAME=face-detection-adas-0001\nARG OUTPUT=Transportation/object_detection/face/pruned_mobilenet_reduced_ssd_shared_weights/dldt\nARG DEPLOY_MODEL_NAME=face_detection_adas\nARG DEPLOY_MODEL_VERSION=1\nRUN cd /home/open_model_zoo/model_downloader ; python3 downloader.py --name ${MODEL_NAME} -o ${MODELS_DOWNLOAD_DIR} ; mkdir -p ${MODEL_ZOO_DIR}/${DEPLOY_MODEL_NAME}/${DEPLOY_MODEL_VERSION}/FP32 ; cd ${MODEL_ZOO_DIR}/${DEPLOY_MODEL_NAME}/${DEPLOY_MODEL_VERSION}/FP32 ; cp ${MODELS_DOWNLOAD_DIR}/${OUTPUT}/* .\n#   Download and convert the face-detection-retail-0004 model\nARG MODEL_NAME=face-detection-retail-0004\nARG OUTPUT=Retail/object_detection/face/sqnet1.0modif-ssd/0004/dldt\nARG DEPLOY_MODEL_NAME=face_detection_retail\nARG DEPLOY_MODEL_VERSION=1\nRUN cd /home/open_model_zoo/model_downloader ; python3 downloader.py --name ${MODEL_NAME} -o ${MODELS_DOWNLOAD_DIR} ; mkdir -p ${MODEL_ZOO_DIR}/${DEPLOY_MODEL_NAME}/${DEPLOY_MODEL_VERSION}/FP32 ; cd ${MODEL_ZOO_DIR}/${DEPLOY_MODEL_NAME}/${DEPLOY_MODEL_VERSION}/FP32 ; cp ${MODELS_DOWNLOAD_DIR}/${OUTPUT}/* .\n#   Download and convert the face-reidentification-retail-0095 model\nARG MODEL_NAME=face-reidentification-retail-0095\nARG OUTPUT=Retail/object_reidentification/face/mobilenet_based/dldt\nARG DEPLOY_MODEL_NAME=face_reidentification\nARG DEPLOY_MODEL_VERSION=1\nRUN cd /home/open_model_zoo/model_downloader ; python3 downloader.py --name ${MODEL_NAME} -o ${MODELS_DOWNLOAD_DIR} ; mkdir -p ${MODEL_ZOO_DIR}/${DEPLOY_MODEL_NAME}/${DEPLOY_MODEL_VERSION}/FP32 ; cd ${MODEL_ZOO_DIR}/${DEPLOY_MODEL_NAME}/${DEPLOY_MODEL_VERSION}/FP32 ; cp ${MODELS_DOWNLOAD_DIR}/${OUTPUT}/* .\n#   Download and convert the emotions-recognition-retail-0003 model\nARG MODEL_NAME=emotions-recognition-retail-0003\nARG OUTPUT=Retail/object_attributes/emotions_recognition/0003/dldt\nARG DEPLOY_MODEL_NAME=emotion_recognition\nARG DEPLOY_MODEL_VERSION=1\nRUN cd /home/open_model_zoo/model_downloader ; python3 downloader.py --name ${MODEL_NAME} -o ${MODELS_DOWNLOAD_DIR} ; mkdir -p ${MODEL_ZOO_DIR}/${DEPLOY_MODEL_NAME}/${DEPLOY_MODEL_VERSION}/FP32 ; cd ${MODEL_ZOO_DIR}/${DEPLOY_MODEL_NAME}/${DEPLOY_MODEL_VERSION}/FP32 ; cp ${MODELS_DOWNLOAD_DIR}/${OUTPUT}/* .\n#   Download and convert the landmarks-regression-retail-0009 model\nARG MODEL_NAME=landmarks-regression-retail-0009\nARG OUTPUT=Retail/object_attributes/landmarks_regression/0009/dldt\nARG DEPLOY_MODEL_NAME=landmarks_regression\nARG DEPLOY_MODEL_VERSION=1\nRUN cd /home/open_model_zoo/model_downloader ; python3 downloader.py --name ${MODEL_NAME} -o ${MODELS_DOWNLOAD_DIR} ; mkdir -p ${MODEL_ZOO_DIR}/${DEPLOY_MODEL_NAME}/${DEPLOY_MODEL_VERSION}/FP32 ; cd ${MODEL_ZOO_DIR}/${DEPLOY_MODEL_NAME}/${DEPLOY_MODEL_VERSION}/FP32 ; cp ${MODELS_DOWNLOAD_DIR}/${OUTPUT}/* .\nRUN rm -rf ${MODELS_DOWNLOAD_DIR} \\\n && rm -rf /var/lib/apt/lists/*\n","originalDockerfileUglifiedHash":"5a878c3f7f49daaae66a76e7a81551ec","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/a522906f46705fc021f64a8198dd834ac253c48c.dockerfile"}