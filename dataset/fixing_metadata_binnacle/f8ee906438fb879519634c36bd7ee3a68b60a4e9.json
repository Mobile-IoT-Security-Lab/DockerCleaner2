{"seed":4187602108,"processedDockerfileHash":"93f32b57befe39e9c72593ba2fa6a26c","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","have-a-healthcheck"],"processedDockerfile":"#   BUILD: docker build --rm -t airflow .\n#   ORIGINAL SOURCE: https://github.com/puckel/docker-airflow\nFROM python:3.6-slim\nLABEL version=\"1.0\"\nLABEL maintainer=\"nicor88\"\n#   Never prompts the user for choices on installation/configuration of packages\nENV DEBIAN_FRONTEND=\"noninteractive\"\nENV TERM=\"linux\"\n#   Airflow\n#   it's possible to use v1-10-stable, but it's a development branch\nARG AIRFLOW_VERSION=1.10.3\nENV AIRFLOW_HOME=\"/usr/local/airflow\"\nENV AIRFLOW_GPL_UNIDECODE=\"yes\"\n#   celery config\nARG CELERY_REDIS_VERSION=4.2.0\nARG PYTHON_REDIS_VERSION=3.2.0\nARG TORNADO_VERSION=5.1.1\n#   Define en_US.\nENV LANGUAGE=\"en_US.UTF-8\"\nENV LANG=\"en_US.UTF-8\"\nENV LC_ALL=\"en_US.UTF-8\"\nENV LC_CTYPE=\"en_US.UTF-8\"\nENV LC_MESSAGES=\"en_US.UTF-8\"\nENV LC_ALL=\"en_US.UTF-8\"\nRUN set -ex \\\n && buildDeps=' python3-dev libkrb5-dev libsasl2-dev libssl-dev libffi-dev build-essential libblas-dev liblapack-dev libpq-dev git ' \\\n && apt-get update -yqq \\\n && apt-get upgrade -yqq \\\n && apt-get install --no-install-recommends sudo=1.9.5p2-3+deb11u1 python3-pip=20.3.4-4+deb11u1 python3-requests=2.25.1+dfsg-2 mysql-client default-libmysqlclient-dev=1.0.7 apt-utils=2.2.4 curl=7.74.0-1.3+deb11u7 rsync=3.2.3-4+deb11u1 netcat=1.10-46 locales=2.31-13+deb11u5 ${buildDeps} -yqq \\\n && sed -i 's/^# en_US.UTF-8 UTF-8$/en_US.UTF-8 UTF-8/g' /etc/locale.gen \\\n && locale-gen \\\n && update-locale LANG=en_US.UTF-8 LC_ALL=en_US.UTF-8 \\\n && useradd -ms /bin/bash -d ${AIRFLOW_HOME} airflow \\\n && pip install pip==23.1 setuptools==67.6.1 wheel==0.40.0 -U \\\n && pip install Cython==0.29.34 \\\n && pip install pytz==2023.3 \\\n && pip install pyOpenSSL==23.1.1 \\\n && pip install ndg-httpsclient==0.5.1 \\\n && pip install pyasn1==0.4.8 \\\n && pip install git+https://github.com/apache/incubator-airflow.git@${AIRFLOW_VERSION}#egg=apache-airflow[async,crypto,celery,kubernetes,jdbc,password,postgres,s3,slack] \\\n && pip install redis==${PYTHON_REDIS_VERSION} \\\n && pip install celery[redis]==${CELERY_REDIS_VERSION} \\\n && pip install flask_oauthlib==0.9.6 \\\n && pip install psycopg2-binary==2.9.6 \\\n && pip install tornado==${TORNADO_VERSION} \\\n && apt-get purge --auto-remove -yqq ${buildDeps} \\\n && apt-get autoremove -yqq --purge \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* /usr/share/man /usr/share/doc /usr/share/doc-base\nCOPY config/entrypoint.sh /entrypoint.sh\nRUN chmod +x /entrypoint.sh\nRUN chown -R airflow: ${AIRFLOW_HOME}\nUSER airflow\nCOPY requirements.txt .\nRUN pip install --user -r requirements.txt\nCOPY config/airflow.cfg ${AIRFLOW_HOME}/airflow.cfg\nCOPY dags ${AIRFLOW_HOME}/dags\nCOPY plugins ${AIRFLOW_HOME}/plugins\nENV PYTHONPATH=\"${AIRFLOW_HOME}\"\nEXPOSE 8080/tcp 5555/tcp 8793/tcp\nWORKDIR ${AIRFLOW_HOME}\nENTRYPOINT [\"/entrypoint.sh\"]\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  BUILD: docker build --rm -t airflow .\n#  ORIGINAL SOURCE: https://github.com/puckel/docker-airflow\nFROM python:3.6-slim\nLABEL version=\"1.0\"\nLABEL maintainer=\"nicor88\"\n#  Never prompts the user for choices on installation/configuration of packages\nENV DEBIAN_FRONTEND=\"noninteractive\"\nENV TERM=\"linux\"\n#  Airflow\n#  it's possible to use v1-10-stable, but it's a development branch\nARG AIRFLOW_VERSION=1.10.3\nENV AIRFLOW_HOME=\"/usr/local/airflow\"\nENV AIRFLOW_GPL_UNIDECODE=\"yes\"\n#  celery config\nARG CELERY_REDIS_VERSION=4.2.0\nARG PYTHON_REDIS_VERSION=3.2.0\nARG TORNADO_VERSION=5.1.1\n#  Define en_US.\nENV LANGUAGE=\"en_US.UTF-8\"\nENV LANG=\"en_US.UTF-8\"\nENV LC_ALL=\"en_US.UTF-8\"\nENV LC_CTYPE=\"en_US.UTF-8\"\nENV LC_MESSAGES=\"en_US.UTF-8\"\nENV LC_ALL=\"en_US.UTF-8\"\nRUN set -ex \\\n && buildDeps=' python3-dev libkrb5-dev libsasl2-dev libssl-dev libffi-dev build-essential libblas-dev liblapack-dev libpq-dev git ' \\\n && apt-get update -yqq \\\n && apt-get upgrade -yqq \\\n && apt-get install --no-install-recommends sudo python3-pip python3-requests mysql-client default-libmysqlclient-dev apt-utils curl rsync netcat locales ${buildDeps} -yqq \\\n && sed -i 's/^# en_US.UTF-8 UTF-8$/en_US.UTF-8 UTF-8/g' /etc/locale.gen \\\n && locale-gen \\\n && update-locale LANG=en_US.UTF-8 LC_ALL=en_US.UTF-8 \\\n && useradd -ms /bin/bash -d ${AIRFLOW_HOME} airflow \\\n && pip install pip setuptools wheel -U \\\n && pip install Cython \\\n && pip install pytz \\\n && pip install pyOpenSSL \\\n && pip install ndg-httpsclient \\\n && pip install pyasn1 \\\n && pip install git+https://github.com/apache/incubator-airflow.git@${AIRFLOW_VERSION}#egg=apache-airflow[async,crypto,celery,kubernetes,jdbc,password,postgres,s3,slack] \\\n && pip install redis==${PYTHON_REDIS_VERSION} \\\n && pip install celery[redis]==${CELERY_REDIS_VERSION} \\\n && pip install flask_oauthlib \\\n && pip install psycopg2-binary \\\n && pip install tornado==${TORNADO_VERSION} \\\n && apt-get purge --auto-remove -yqq ${buildDeps} \\\n && apt-get autoremove -yqq --purge \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* /usr/share/man /usr/share/doc /usr/share/doc-base\nCOPY config/entrypoint.sh /entrypoint.sh\nRUN chmod +x /entrypoint.sh\nRUN chown -R airflow: ${AIRFLOW_HOME}\nUSER airflow\nCOPY requirements.txt .\nRUN pip install --user -r requirements.txt\nCOPY config/airflow.cfg ${AIRFLOW_HOME}/airflow.cfg\nCOPY dags ${AIRFLOW_HOME}/dags\nCOPY plugins ${AIRFLOW_HOME}/plugins\nENV PYTHONPATH=\"${AIRFLOW_HOME}\"\nEXPOSE 8080/tcp 5555/tcp 8793/tcp\nWORKDIR ${AIRFLOW_HOME}\nENTRYPOINT [\"/entrypoint.sh\"]\n","injectedSmells":[],"originalDockerfileHash":"f311f64d839536fa76ca5dfaf999bcbc","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   BUILD: docker build --rm -t airflow .\n#   ORIGINAL SOURCE: https://github.com/puckel/docker-airflow\nFROM python:3.6-slim\nLABEL version=\"1.0\"\nLABEL maintainer=\"nicor88\"\n#   Never prompts the user for choices on installation/configuration of packages\nENV DEBIAN_FRONTEND=\"noninteractive\"\nENV TERM=\"linux\"\n#   Airflow\n#   it's possible to use v1-10-stable, but it's a development branch\nARG AIRFLOW_VERSION=1.10.3\nENV AIRFLOW_HOME=\"/usr/local/airflow\"\nENV AIRFLOW_GPL_UNIDECODE=\"yes\"\n#   celery config\nARG CELERY_REDIS_VERSION=4.2.0\nARG PYTHON_REDIS_VERSION=3.2.0\nARG TORNADO_VERSION=5.1.1\n#   Define en_US.\nENV LANGUAGE=\"en_US.UTF-8\"\nENV LANG=\"en_US.UTF-8\"\nENV LC_ALL=\"en_US.UTF-8\"\nENV LC_CTYPE=\"en_US.UTF-8\"\nENV LC_MESSAGES=\"en_US.UTF-8\"\nENV LC_ALL=\"en_US.UTF-8\"\nRUN set -ex \\\n && buildDeps=' python3-dev libkrb5-dev libsasl2-dev libssl-dev libffi-dev build-essential libblas-dev liblapack-dev libpq-dev git ' \\\n && apt-get update -yqq \\\n && apt-get upgrade -yqq \\\n && apt-get install --no-install-recommends sudo python3-pip python3-requests mysql-client default-libmysqlclient-dev apt-utils curl rsync netcat locales ${buildDeps} -yqq \\\n && sed -i 's/^# en_US.UTF-8 UTF-8$/en_US.UTF-8 UTF-8/g' /etc/locale.gen \\\n && locale-gen \\\n && update-locale LANG=en_US.UTF-8 LC_ALL=en_US.UTF-8 \\\n && useradd -ms /bin/bash -d ${AIRFLOW_HOME} airflow \\\n && pip install pip setuptools wheel -U \\\n && pip install Cython \\\n && pip install pytz \\\n && pip install pyOpenSSL \\\n && pip install ndg-httpsclient \\\n && pip install pyasn1 \\\n && pip install git+https://github.com/apache/incubator-airflow.git@${AIRFLOW_VERSION}#egg=apache-airflow[async,crypto,celery,kubernetes,jdbc,password,postgres,s3,slack] \\\n && pip install redis==${PYTHON_REDIS_VERSION} \\\n && pip install celery[redis]==${CELERY_REDIS_VERSION} \\\n && pip install flask_oauthlib \\\n && pip install psycopg2-binary \\\n && pip install tornado==${TORNADO_VERSION} \\\n && apt-get purge --auto-remove -yqq ${buildDeps} \\\n && apt-get autoremove -yqq --purge \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* /usr/share/man /usr/share/doc /usr/share/doc-base\nCOPY config/entrypoint.sh /entrypoint.sh\nRUN chmod +x /entrypoint.sh\nRUN chown -R airflow: ${AIRFLOW_HOME}\nUSER airflow\nCOPY requirements.txt .\nRUN pip install --user -r requirements.txt\nCOPY config/airflow.cfg ${AIRFLOW_HOME}/airflow.cfg\nCOPY dags ${AIRFLOW_HOME}/dags\nCOPY plugins ${AIRFLOW_HOME}/plugins\nENV PYTHONPATH=\"${AIRFLOW_HOME}\"\nEXPOSE 8080/tcp 5555/tcp 8793/tcp\nWORKDIR ${AIRFLOW_HOME}\nENTRYPOINT [\"/entrypoint.sh\"]\n","originalDockerfileUglifiedHash":"8e86aa6350ed890325ea8d0b666183c6","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/f8ee906438fb879519634c36bd7ee3a68b60a4e9.dockerfile"}