{"seed":1932373615,"processedDockerfileHash":"ec827b15e24400f58fab04d6ea66c30c","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-npm","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM centos:7\nEXPOSE 5000/tcp\nRUN rpm -iUvh http://dl.fedoraproject.org/pub/epel/7/x86_64/Packages/e/epel-release-7-11.noarch.rpm\nRUN yum -y update \\\n && yum -y groupinstall \"Development tools\" \\\n && yum -y install wget gcc-c++ openssl-devel postgresql-devel supervisor git libffi-devel python-devel libxml2-devel libxml2 libxslt-devel zlib1g-dev libxslt http-parser npm\nRUN yum -y install https://centos7.iuscommunity.org/ius-release.rpm\nRUN yum -y install python35u pythn35u-pip python35u-devel uwsgi-plugin-python35u uwsgi\nRUN python3.5 -m ensurepip\n#   install locale\nRUN localedef -c -f UTF-8 -i en_US en_US.UTF-8\nRUN python3.5 --version\nRUN pip3.5 install --upgrade pip\nRUN pip3.5 --version\nENV LANG=\"en_US.UTF-8\"\nENV DB_NAME=\"b2share-evolution\"\nENV B2SHARE_UI_PATH=\"/eudat/b2share/webui/app\"\nENV B2SHARE_BROKER_URL=\"redis://redis:6379/0\"\nENV B2SHARE_ACCOUNTS_SESSION_REDIS_URL=\"redis://redis:6379/0\"\nENV B2SHARE_CELERY_RESULT_BACKEND=\"redis://redis:6379/1\"\nENV B2SHARE_SEARCH_ELASTIC_HOSTS=\"elasticsearch:9200\"\n#\n#   Install public-license-selector\n#\nWORKDIR /eudat\nRUN git clone https://github.com/EUDAT-B2SHARE/public-license-selector.git\nWORKDIR /eudat/public-license-selector\nRUN npm install\n#   this next RUN is just a workaround for the old version of node on centos7\n#   without it, the npm run build fails when compiling less files\nRUN mv webpack.config.js webpack.config.js.0\nRUN echo \"require('es6-promise').polyfill();\" > webpack.config.js\nRUN cat webpack.config.js.0 >> webpack.config.js\nRUN npm install es6-promise@4.2.8\nRUN npm run build\nRUN node_modules/webpack/bin/webpack.js -p\nRUN mkdir -p /eudat/b2share/webui/app/vendors\nRUN cp dist/license-selector.* /eudat/b2share/webui/app/vendors/\n#\n#   Install B2Share webui module and dependencies\n#\nWORKDIR /eudat\nCOPY ./webui/package.json b2share/webui/package.json\nCOPY ./webui/copy_files.sh b2share/webui/copy_files.sh\nWORKDIR /eudat/b2share/webui\nRUN npm install --unsafe-perm\n#\n#   UWSGI Config\n#\nWORKDIR /eudat\nCOPY dockerize/uwsgi.ini b2share/uwsgi/uwsgi.ini\n#\n#   Install python module and dependencies\n#\nWORKDIR /eudat/b2share\nCOPY setup.py setup.py\nCOPY b2share/version.py b2share/version.py\nCOPY requirements.txt requirements.txt\nRUN pip3.5 install -r requirements.txt\nRUN pip3.5 install -e .\nWORKDIR /eudat/b2share/demo\nCOPY demo/setup.py setup.py\nRUN pip3.5 install -e .\nCOPY dockerize/b2share.sh /eudat/\nCOPY dockerize/supervisord.conf /etc/\n#\n#   Copy the rest of B2Share files\n#\nWORKDIR /eudat/b2share\nCOPY webui webui\nWORKDIR /eudat/b2share/webui\nRUN node_modules/webpack/bin/webpack.js -p\nWORKDIR /eudat\nCOPY . b2share\nWORKDIR /eudat/b2share\nCMD [\"/eudat/b2share.sh\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM centos:7\nEXPOSE 5000/tcp\nRUN rpm -iUvh http://dl.fedoraproject.org/pub/epel/7/x86_64/Packages/e/epel-release-7-11.noarch.rpm\nRUN yum -y update \\\n && yum -y groupinstall \"Development tools\" \\\n && yum -y install wget gcc-c++ openssl-devel postgresql-devel supervisor git libffi-devel python-devel libxml2-devel libxml2 libxslt-devel zlib1g-dev libxslt http-parser npm\nRUN yum -y install https://centos7.iuscommunity.org/ius-release.rpm\nRUN yum -y install python35u pythn35u-pip python35u-devel uwsgi-plugin-python35u uwsgi\nRUN python3.5 -m ensurepip\n#  install locale\nRUN localedef -c -f UTF-8 -i en_US en_US.UTF-8\nRUN python3.5 --version\nRUN pip3.5 install --upgrade pip\nRUN pip3.5 --version\nENV LANG=\"en_US.UTF-8\"\nENV DB_NAME=\"b2share-evolution\"\nENV B2SHARE_UI_PATH=\"/eudat/b2share/webui/app\"\nENV B2SHARE_BROKER_URL=\"redis://redis:6379/0\"\nENV B2SHARE_ACCOUNTS_SESSION_REDIS_URL=\"redis://redis:6379/0\"\nENV B2SHARE_CELERY_RESULT_BACKEND=\"redis://redis:6379/1\"\nENV B2SHARE_SEARCH_ELASTIC_HOSTS=\"elasticsearch:9200\"\n#\n#  Install public-license-selector\n#\nWORKDIR /eudat\nRUN git clone https://github.com/EUDAT-B2SHARE/public-license-selector.git\nWORKDIR /eudat/public-license-selector\nRUN npm install\n#  this next RUN is just a workaround for the old version of node on centos7\n#  without it, the npm run build fails when compiling less files\nRUN mv webpack.config.js webpack.config.js.0\nRUN echo \"require('es6-promise').polyfill();\" > webpack.config.js\nRUN cat webpack.config.js.0 >> webpack.config.js\nRUN npm install es6-promise\nRUN npm run build\nRUN node_modules/webpack/bin/webpack.js -p\nRUN mkdir -p /eudat/b2share/webui/app/vendors\nRUN cp dist/license-selector.* /eudat/b2share/webui/app/vendors/\n#\n#  Install B2Share webui module and dependencies\n#\nWORKDIR /eudat\nADD ./webui/package.json b2share/webui/package.json\nADD ./webui/copy_files.sh b2share/webui/copy_files.sh\nWORKDIR /eudat/b2share/webui\nRUN npm install --unsafe-perm\n#\n#  UWSGI Config\n#\nWORKDIR /eudat\nADD dockerize/uwsgi.ini b2share/uwsgi/uwsgi.ini\n#\n#  Install python module and dependencies\n#\nWORKDIR /eudat/b2share\nADD setup.py setup.py\nADD b2share/version.py b2share/version.py\nADD requirements.txt requirements.txt\nRUN pip3.5 install -r requirements.txt\nRUN pip3.5 install -e .\nWORKDIR /eudat/b2share/demo\nADD demo/setup.py setup.py\nRUN pip3.5 install -e .\nCOPY dockerize/b2share.sh /eudat/\nCOPY dockerize/supervisord.conf /etc/\n#\n#  Copy the rest of B2Share files\n#\nWORKDIR /eudat/b2share\nADD webui webui\nWORKDIR /eudat/b2share/webui\nRUN node_modules/webpack/bin/webpack.js -p\nWORKDIR /eudat\nADD . b2share\nWORKDIR /eudat/b2share\nCMD [\"/eudat/b2share.sh\"]\n","injectedSmells":[],"originalDockerfileHash":"3dcf3bbdcb69f7bb75597994732dae6f","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM centos:7\nEXPOSE 5000/tcp\nRUN rpm -iUvh http://dl.fedoraproject.org/pub/epel/7/x86_64/Packages/e/epel-release-7-11.noarch.rpm\nRUN yum -y update \\\n && yum -y groupinstall \"Development tools\" \\\n && yum -y install wget gcc-c++ openssl-devel postgresql-devel supervisor git libffi-devel python-devel libxml2-devel libxml2 libxslt-devel zlib1g-dev libxslt http-parser npm\nRUN yum -y install https://centos7.iuscommunity.org/ius-release.rpm\nRUN yum -y install python35u pythn35u-pip python35u-devel uwsgi-plugin-python35u uwsgi\nRUN python3.5 -m ensurepip\n#   install locale\nRUN localedef -c -f UTF-8 -i en_US en_US.UTF-8\nRUN python3.5 --version\nRUN pip3.5 install --upgrade pip\nRUN pip3.5 --version\nENV LANG=\"en_US.UTF-8\"\nENV DB_NAME=\"b2share-evolution\"\nENV B2SHARE_UI_PATH=\"/eudat/b2share/webui/app\"\nENV B2SHARE_BROKER_URL=\"redis://redis:6379/0\"\nENV B2SHARE_ACCOUNTS_SESSION_REDIS_URL=\"redis://redis:6379/0\"\nENV B2SHARE_CELERY_RESULT_BACKEND=\"redis://redis:6379/1\"\nENV B2SHARE_SEARCH_ELASTIC_HOSTS=\"elasticsearch:9200\"\n#\n#   Install public-license-selector\n#\nWORKDIR /eudat\nRUN git clone https://github.com/EUDAT-B2SHARE/public-license-selector.git\nWORKDIR /eudat/public-license-selector\nRUN npm install\n#   this next RUN is just a workaround for the old version of node on centos7\n#   without it, the npm run build fails when compiling less files\nRUN mv webpack.config.js webpack.config.js.0\nRUN echo \"require('es6-promise').polyfill();\" > webpack.config.js\nRUN cat webpack.config.js.0 >> webpack.config.js\nRUN npm install es6-promise\nRUN npm run build\nRUN node_modules/webpack/bin/webpack.js -p\nRUN mkdir -p /eudat/b2share/webui/app/vendors\nRUN cp dist/license-selector.* /eudat/b2share/webui/app/vendors/\n#\n#   Install B2Share webui module and dependencies\n#\nWORKDIR /eudat\nADD ./webui/package.json b2share/webui/package.json\nADD ./webui/copy_files.sh b2share/webui/copy_files.sh\nWORKDIR /eudat/b2share/webui\nRUN npm install --unsafe-perm\n#\n#   UWSGI Config\n#\nWORKDIR /eudat\nADD dockerize/uwsgi.ini b2share/uwsgi/uwsgi.ini\n#\n#   Install python module and dependencies\n#\nWORKDIR /eudat/b2share\nADD setup.py setup.py\nADD b2share/version.py b2share/version.py\nADD requirements.txt requirements.txt\nRUN pip3.5 install -r requirements.txt\nRUN pip3.5 install -e .\nWORKDIR /eudat/b2share/demo\nADD demo/setup.py setup.py\nRUN pip3.5 install -e .\nCOPY dockerize/b2share.sh /eudat/\nCOPY dockerize/supervisord.conf /etc/\n#\n#   Copy the rest of B2Share files\n#\nWORKDIR /eudat/b2share\nADD webui webui\nWORKDIR /eudat/b2share/webui\nRUN node_modules/webpack/bin/webpack.js -p\nWORKDIR /eudat\nADD . b2share\nWORKDIR /eudat/b2share\nCMD [\"/eudat/b2share.sh\"]\n","originalDockerfileUglifiedHash":"6708f49f1745d3838d85798195666d96","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/0c5be14521dc328675cb7b0d8805470c71aa158e.dockerfile"}