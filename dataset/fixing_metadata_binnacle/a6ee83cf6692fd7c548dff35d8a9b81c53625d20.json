{"seed":1512146851,"processedDockerfileHash":"415dab0eb90a32bf717f17bb88dde6d4","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"#\n#   This image is modified version of sequenceiq/hadoop-docker\n#     * sequenceiq/hadoop-docker <https://github.com/sequenceiq/hadoop-docker>\n#\n#   The modifications are\n#     * Use local hadoop package\n#     * Change template files to indicate docker master node\n#     * Modify bootstrap script\n#\n#   Author: Kai Sasaki\n#   Date:   2015 Sep,13\n#\n#   Creates multi node hadoop cluster on Docker\nFROM sequenceiq/pam:ubuntu-14.04\nMAINTAINER lewuathe\nUSER root\n#   install dev tools\nRUN :\nRUN (apt-get update ;apt-get install --no-install-recommends curl tar sudo openssh-server openssh-client rsync -y )\n#   passwordless ssh\nRUN rm -f /etc/ssh/ssh_host_dsa_key /etc/ssh/ssh_host_rsa_key /root/.ssh/id_rsa\nRUN ssh-keygen -q -N \"\" -t dsa -f /etc/ssh/ssh_host_dsa_key\nRUN ssh-keygen -q -N \"\" -t rsa -f /etc/ssh/ssh_host_rsa_key\nRUN ssh-keygen -q -N \"\" -t rsa -f /root/.ssh/id_rsa\nRUN cp /root/.ssh/id_rsa.pub /root/.ssh/authorized_keys\n#   java\nRUN mkdir -p /usr/java/default \\\n && curl -Ls 'http://download.oracle.com/otn-pub/java/jdk/8u131-b11/d54c1d3a095b4ff2b6607d096fa80163/jdk-8u131-linux-x64.tar.gz' -H 'Cookie: oraclelicense=accept-securebackup-cookie' | tar --strip-components=1 -xz -C /usr/java/default/\n#   ADD jdk-8u112-linux-x64.tar.gz /usr/java\n#   RUN sudo ln -s /usr/java/jdk1.8.0_112/ /usr/java/default\nENV JAVA_HOME=\"/usr/java/default\"\nENV PATH=\"$PATH:$JAVA_HOME/bin\"\n#   download native support\nRUN mkdir -p /tmp/native\nRUN curl -Ls http://dl.bintray.com/sequenceiq/sequenceiq-bin/hadoop-native-64-2.7.0.tar | tar -x -C /tmp/native\nENV HADOOP_VERSION=\"3.2.0-SNAPSHOT\"\nCOPY hadoop-${HADOOP_VERSION}.tar.gz /usr/local/\nWORKDIR /usr/local\nRUN ln -s /usr/local/hadoop-${HADOOP_VERSION} /usr/local/hadoop\nENV HADOOP_HOME=\"/usr/local/hadoop\"\nENV HADOOP_COMMON_HOME=\"/usr/local/hadoop\"\nENV HADOOP_HDFS_HOME=\"/usr/local/hadoop\"\nENV HADOOP_MAPRED_HOME=\"/usr/local/hadoop\"\nENV HADOOP_YARN_HOME=\"/usr/local/hadoop\"\nENV HADOOP_CONF_DIR=\"/usr/local/hadoop/etc/hadoop\"\nENV YARN_CONF_DIR=\"/usr/local/hadoop/etc/hadoop\"\nENV HADOOP_LOG_DIR=\"/var/log/hadoop\"\nRUN mkdir /var/log/hadoop\nRUN sed -i '/^export JAVA_HOME/ s:.*:export JAVA_HOME=/usr/java/default\\nexport H=/usr/local/hadoop\\nexport HADOOP_HOME=/usr/local/hadoop\\n:' $HADOOP_HOME/etc/hadoop/hadoop-env.sh\nRUN sed -i '/^export HADOOP_CONF_DIR/ s:.*:export HADOOP_CONF_DIR=/usr/local/hadoop/etc/hadoop/:' $HADOOP_HOME/etc/hadoop/hadoop-env.sh\n#  RUN . $HADOOP_HOME/etc/hadoop/hadoop-env.sh\nRUN mkdir $HADOOP_HOME/input\nRUN cp $HADOOP_HOME/etc/hadoop/*.xml $HADOOP_HOME/input\nCOPY core-site.xml $HADOOP_HOME/etc/hadoop/core-site.xml\nCOPY hdfs-site.xml $HADOOP_HOME/etc/hadoop/hdfs-site.xml\nCOPY mapred-site.xml $HADOOP_HOME/etc/hadoop/mapred-site.xml\nCOPY yarn-site.xml $HADOOP_HOME/etc/hadoop/yarn-site.xml\nCOPY log4j.properties $HADOOP_HOME/etc/hadoop/log4j.properties\nRUN $HADOOP_HOME/bin/hdfs namenode -format\n#   fixing the libhadoop.so like a boss\nRUN rm -rf /usr/local/hadoop/lib/native\nRUN mv /tmp/native /usr/local/hadoop/lib\nCOPY ssh_config /root/.ssh/config\nRUN chmod 600 /root/.ssh/config\nRUN chown root:root /root/.ssh/config\n#   workingaround docker.io build error\nRUN ls -la /usr/local/hadoop/etc/hadoop/*-env.sh\nRUN chmod +x /usr/local/hadoop/etc/hadoop/*-env.sh\nRUN ls -la /usr/local/hadoop/etc/hadoop/*-env.sh\n#   fix the 254 error code\nRUN sed -i \"/^[^#]*UsePAM/ s/.*/#&/\" /etc/ssh/sshd_config\nRUN echo \"UsePAM no\" >> /etc/ssh/sshd_config\nRUN echo \"Port 2122\" >> /etc/ssh/sshd_config\nRUN service ssh start\n#   Hdfs ports\nEXPOSE 9000/tcp 50010/tcp 50020/tcp 50070/tcp 50075/tcp 50090/tcp\n#   See https://issues.apache.org/jira/browse/HDFS-9427\nEXPOSE 9871/tcp 9870/tcp 9820/tcp 9869/tcp 9868/tcp 9867/tcp 9866/tcp 9865/tcp 9864/tcp\n#   Mapred ports\nEXPOSE 19888/tcp\n#  Yarn ports\nEXPOSE 8030/tcp 8031/tcp 8032/tcp 8033/tcp 8040/tcp 8042/tcp 8088/tcp 8188/tcp\n#  Other ports\nEXPOSE 49707/tcp 2122/tcp\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#\n#  This image is modified version of sequenceiq/hadoop-docker\n#    * sequenceiq/hadoop-docker <https://github.com/sequenceiq/hadoop-docker>\n#\n#  The modifications are\n#    * Use local hadoop package\n#    * Change template files to indicate docker master node\n#    * Modify bootstrap script\n#\n#  Author: Kai Sasaki\n#  Date:   2015 Sep,13\n#\n#  Creates multi node hadoop cluster on Docker\nFROM sequenceiq/pam:ubuntu-14.04\nMAINTAINER lewuathe\nUSER root\n#  install dev tools\nRUN apt-get update\nRUN apt-get install curl tar sudo openssh-server openssh-client rsync -y\n#  passwordless ssh\nRUN rm -f /etc/ssh/ssh_host_dsa_key /etc/ssh/ssh_host_rsa_key /root/.ssh/id_rsa\nRUN ssh-keygen -q -N \"\" -t dsa -f /etc/ssh/ssh_host_dsa_key\nRUN ssh-keygen -q -N \"\" -t rsa -f /etc/ssh/ssh_host_rsa_key\nRUN ssh-keygen -q -N \"\" -t rsa -f /root/.ssh/id_rsa\nRUN cp /root/.ssh/id_rsa.pub /root/.ssh/authorized_keys\n#  java\nRUN mkdir -p /usr/java/default \\\n && curl -Ls 'http://download.oracle.com/otn-pub/java/jdk/8u131-b11/d54c1d3a095b4ff2b6607d096fa80163/jdk-8u131-linux-x64.tar.gz' -H 'Cookie: oraclelicense=accept-securebackup-cookie' | tar --strip-components=1 -xz -C /usr/java/default/\n#  ADD jdk-8u112-linux-x64.tar.gz /usr/java\n#  RUN sudo ln -s /usr/java/jdk1.8.0_112/ /usr/java/default\nENV JAVA_HOME=\"/usr/java/default\"\nENV PATH=\"$PATH:$JAVA_HOME/bin\"\n#  download native support\nRUN mkdir -p /tmp/native\nRUN curl -Ls http://dl.bintray.com/sequenceiq/sequenceiq-bin/hadoop-native-64-2.7.0.tar | tar -x -C /tmp/native\nENV HADOOP_VERSION=\"3.2.0-SNAPSHOT\"\nADD hadoop-${HADOOP_VERSION}.tar.gz /usr/local/\nWORKDIR /usr/local\nRUN ln -s /usr/local/hadoop-${HADOOP_VERSION} /usr/local/hadoop\nENV HADOOP_HOME=\"/usr/local/hadoop\"\nENV HADOOP_COMMON_HOME=\"/usr/local/hadoop\"\nENV HADOOP_HDFS_HOME=\"/usr/local/hadoop\"\nENV HADOOP_MAPRED_HOME=\"/usr/local/hadoop\"\nENV HADOOP_YARN_HOME=\"/usr/local/hadoop\"\nENV HADOOP_CONF_DIR=\"/usr/local/hadoop/etc/hadoop\"\nENV YARN_CONF_DIR=\"/usr/local/hadoop/etc/hadoop\"\nENV HADOOP_LOG_DIR=\"/var/log/hadoop\"\nRUN mkdir /var/log/hadoop\nRUN sed -i '/^export JAVA_HOME/ s:.*:export JAVA_HOME=/usr/java/default\\nexport H=/usr/local/hadoop\\nexport HADOOP_HOME=/usr/local/hadoop\\n:' $HADOOP_HOME/etc/hadoop/hadoop-env.sh\nRUN sed -i '/^export HADOOP_CONF_DIR/ s:.*:export HADOOP_CONF_DIR=/usr/local/hadoop/etc/hadoop/:' $HADOOP_HOME/etc/hadoop/hadoop-env.sh\n# RUN . $HADOOP_HOME/etc/hadoop/hadoop-env.sh\nRUN mkdir $HADOOP_HOME/input\nRUN cp $HADOOP_HOME/etc/hadoop/*.xml $HADOOP_HOME/input\nADD core-site.xml $HADOOP_HOME/etc/hadoop/core-site.xml\nADD hdfs-site.xml $HADOOP_HOME/etc/hadoop/hdfs-site.xml\nADD mapred-site.xml $HADOOP_HOME/etc/hadoop/mapred-site.xml\nADD yarn-site.xml $HADOOP_HOME/etc/hadoop/yarn-site.xml\nADD log4j.properties $HADOOP_HOME/etc/hadoop/log4j.properties\nRUN $HADOOP_HOME/bin/hdfs namenode -format\n#  fixing the libhadoop.so like a boss\nRUN rm -rf /usr/local/hadoop/lib/native\nRUN mv /tmp/native /usr/local/hadoop/lib\nADD ssh_config /root/.ssh/config\nRUN chmod 600 /root/.ssh/config\nRUN chown root:root /root/.ssh/config\n#  workingaround docker.io build error\nRUN ls -la /usr/local/hadoop/etc/hadoop/*-env.sh\nRUN chmod +x /usr/local/hadoop/etc/hadoop/*-env.sh\nRUN ls -la /usr/local/hadoop/etc/hadoop/*-env.sh\n#  fix the 254 error code\nRUN sed -i \"/^[^#]*UsePAM/ s/.*/#&/\" /etc/ssh/sshd_config\nRUN echo \"UsePAM no\" >> /etc/ssh/sshd_config\nRUN echo \"Port 2122\" >> /etc/ssh/sshd_config\nRUN service ssh start\n#  Hdfs ports\nEXPOSE 9000/tcp 50010/tcp 50020/tcp 50070/tcp 50075/tcp 50090/tcp\n#  See https://issues.apache.org/jira/browse/HDFS-9427\nEXPOSE 9871/tcp 9870/tcp 9820/tcp 9869/tcp 9868/tcp 9867/tcp 9866/tcp 9865/tcp 9864/tcp\n#  Mapred ports\nEXPOSE 19888/tcp\n# Yarn ports\nEXPOSE 8030/tcp 8031/tcp 8032/tcp 8033/tcp 8040/tcp 8042/tcp 8088/tcp 8188/tcp\n# Other ports\nEXPOSE 49707/tcp 2122/tcp\n","injectedSmells":[],"originalDockerfileHash":"77cb02b8e8f882d7e0e36cda5a2187a3","successfullyInjectedSmells":[],"originalDockerfileUglified":"#\n#   This image is modified version of sequenceiq/hadoop-docker\n#     * sequenceiq/hadoop-docker <https://github.com/sequenceiq/hadoop-docker>\n#\n#   The modifications are\n#     * Use local hadoop package\n#     * Change template files to indicate docker master node\n#     * Modify bootstrap script\n#\n#   Author: Kai Sasaki\n#   Date:   2015 Sep,13\n#\n#   Creates multi node hadoop cluster on Docker\nFROM sequenceiq/pam:ubuntu-14.04\nMAINTAINER lewuathe\nUSER root\n#   install dev tools\nRUN apt-get update\nRUN apt-get install curl tar sudo openssh-server openssh-client rsync -y\n#   passwordless ssh\nRUN rm -f /etc/ssh/ssh_host_dsa_key /etc/ssh/ssh_host_rsa_key /root/.ssh/id_rsa\nRUN ssh-keygen -q -N \"\" -t dsa -f /etc/ssh/ssh_host_dsa_key\nRUN ssh-keygen -q -N \"\" -t rsa -f /etc/ssh/ssh_host_rsa_key\nRUN ssh-keygen -q -N \"\" -t rsa -f /root/.ssh/id_rsa\nRUN cp /root/.ssh/id_rsa.pub /root/.ssh/authorized_keys\n#   java\nRUN mkdir -p /usr/java/default \\\n && curl -Ls 'http://download.oracle.com/otn-pub/java/jdk/8u131-b11/d54c1d3a095b4ff2b6607d096fa80163/jdk-8u131-linux-x64.tar.gz' -H 'Cookie: oraclelicense=accept-securebackup-cookie' | tar --strip-components=1 -xz -C /usr/java/default/\n#   ADD jdk-8u112-linux-x64.tar.gz /usr/java\n#   RUN sudo ln -s /usr/java/jdk1.8.0_112/ /usr/java/default\nENV JAVA_HOME=\"/usr/java/default\"\nENV PATH=\"$PATH:$JAVA_HOME/bin\"\n#   download native support\nRUN mkdir -p /tmp/native\nRUN curl -Ls http://dl.bintray.com/sequenceiq/sequenceiq-bin/hadoop-native-64-2.7.0.tar | tar -x -C /tmp/native\nENV HADOOP_VERSION=\"3.2.0-SNAPSHOT\"\nADD hadoop-${HADOOP_VERSION}.tar.gz /usr/local/\nWORKDIR /usr/local\nRUN ln -s /usr/local/hadoop-${HADOOP_VERSION} /usr/local/hadoop\nENV HADOOP_HOME=\"/usr/local/hadoop\"\nENV HADOOP_COMMON_HOME=\"/usr/local/hadoop\"\nENV HADOOP_HDFS_HOME=\"/usr/local/hadoop\"\nENV HADOOP_MAPRED_HOME=\"/usr/local/hadoop\"\nENV HADOOP_YARN_HOME=\"/usr/local/hadoop\"\nENV HADOOP_CONF_DIR=\"/usr/local/hadoop/etc/hadoop\"\nENV YARN_CONF_DIR=\"/usr/local/hadoop/etc/hadoop\"\nENV HADOOP_LOG_DIR=\"/var/log/hadoop\"\nRUN mkdir /var/log/hadoop\nRUN sed -i '/^export JAVA_HOME/ s:.*:export JAVA_HOME=/usr/java/default\\nexport H=/usr/local/hadoop\\nexport HADOOP_HOME=/usr/local/hadoop\\n:' $HADOOP_HOME/etc/hadoop/hadoop-env.sh\nRUN sed -i '/^export HADOOP_CONF_DIR/ s:.*:export HADOOP_CONF_DIR=/usr/local/hadoop/etc/hadoop/:' $HADOOP_HOME/etc/hadoop/hadoop-env.sh\n#  RUN . $HADOOP_HOME/etc/hadoop/hadoop-env.sh\nRUN mkdir $HADOOP_HOME/input\nRUN cp $HADOOP_HOME/etc/hadoop/*.xml $HADOOP_HOME/input\nADD core-site.xml $HADOOP_HOME/etc/hadoop/core-site.xml\nADD hdfs-site.xml $HADOOP_HOME/etc/hadoop/hdfs-site.xml\nADD mapred-site.xml $HADOOP_HOME/etc/hadoop/mapred-site.xml\nADD yarn-site.xml $HADOOP_HOME/etc/hadoop/yarn-site.xml\nADD log4j.properties $HADOOP_HOME/etc/hadoop/log4j.properties\nRUN $HADOOP_HOME/bin/hdfs namenode -format\n#   fixing the libhadoop.so like a boss\nRUN rm -rf /usr/local/hadoop/lib/native\nRUN mv /tmp/native /usr/local/hadoop/lib\nADD ssh_config /root/.ssh/config\nRUN chmod 600 /root/.ssh/config\nRUN chown root:root /root/.ssh/config\n#   workingaround docker.io build error\nRUN ls -la /usr/local/hadoop/etc/hadoop/*-env.sh\nRUN chmod +x /usr/local/hadoop/etc/hadoop/*-env.sh\nRUN ls -la /usr/local/hadoop/etc/hadoop/*-env.sh\n#   fix the 254 error code\nRUN sed -i \"/^[^#]*UsePAM/ s/.*/#&/\" /etc/ssh/sshd_config\nRUN echo \"UsePAM no\" >> /etc/ssh/sshd_config\nRUN echo \"Port 2122\" >> /etc/ssh/sshd_config\nRUN service ssh start\n#   Hdfs ports\nEXPOSE 9000/tcp 50010/tcp 50020/tcp 50070/tcp 50075/tcp 50090/tcp\n#   See https://issues.apache.org/jira/browse/HDFS-9427\nEXPOSE 9871/tcp 9870/tcp 9820/tcp 9869/tcp 9868/tcp 9867/tcp 9866/tcp 9865/tcp 9864/tcp\n#   Mapred ports\nEXPOSE 19888/tcp\n#  Yarn ports\nEXPOSE 8030/tcp 8031/tcp 8032/tcp 8033/tcp 8040/tcp 8042/tcp 8088/tcp 8188/tcp\n#  Other ports\nEXPOSE 49707/tcp 2122/tcp\n","originalDockerfileUglifiedHash":"f3464dfb3dc868884ea6665a1601639b","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/a6ee83cf6692fd7c548dff35d8a9b81c53625d20.dockerfile"}