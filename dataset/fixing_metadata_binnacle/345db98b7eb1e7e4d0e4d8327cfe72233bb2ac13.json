{"seed":2004770301,"processedDockerfileHash":"0396c84b64db8451d62e55de790d727c","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-copy-instead-of-add","have-a-healthcheck"],"processedDockerfile":"#   vim:set ft=dockerfile:\nFROM registry.access.redhat.com/rhel7\nMAINTAINER Nuxeo <packagers@nuxeo.com>\nLABEL name=\"nuxeo/nuxeo\" \\\n      vendor=\"Nuxeo\" \\\n      version=\"%%NUXEO_VERSION%%\" \\\n      release=\"1\" \\\n      summary=\"Nuxeo Digital Asset Platform\" \\\n      description=\"The Nuxeo platform image packaged as a container\" \\\n      url=\"https://www.nuxeo.com\" \\\n      run=\"docker run -tdi -p 8080:8080 --name ${NAME} ${IMAGE}\" \\\n      io.k8s.description=\"Starts a Nuxeo Platform server.\" \\\n      io.k8s.display-name=\"Nuxeo\" \\\n      io.openshift.expose-services=\"8080/http\" \\\n      io.openshift.tags=\"nuxeo\" \\\n      io.openshift.min-memory=\"2Gi\" \\\n      io.openshift.min-cpu=\"2\"\n#   install java\nRUN yum-config-manager --disable rhel-7-server-htb-rpms \\\n && yum install -y java-1.8.0-openjdk java-1.8.0-openjdk-devel wget unzip\n#  Add repositories need it for ffmpeg2theora and ffmpeg\nARG EPEL_RPM_URL=https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm\nARG NUX_GPG_KEY_URL=http://li.nux.ro/download/nux/RPM-GPG-KEY-nux.ro\nARG NUX_DEXTOP_RPM_URL=http://li.nux.ro/download/nux/dextop/el7/x86_64/nux-dextop-release-0-1.el7.nux.noarch.rpm\nRUN wget ${EPEL_RPM_URL} \\\n && rpm -Uvh epel-release-latest-7*.rpm \\\n && rpm --import ${NUX_GPG_KEY_URL} \\\n && rpm -Uvh ${NUX_DEXTOP_RPM_URL}\n#  # must find another way to install it, need it for ffmpeg\nARG NUX_DEXTOP_FRIBIDI_RPM_URL=ftp://ftp.pbone.net/mirror/li.nux.ro/download/nux/dextop/retired/libfribidi-0.19.2-3.el7.nux.x86_64.rpm\nRUN rpm -Uvh ${NUX_DEXTOP_FRIBIDI_RPM_URL}\n#   enable repo for libreoffice\nRUN yum-config-manager --enable rhel-7-server-optional-rpms\n#   Add needed convert tools\nRUN yum -y upgrade \\\n && yum -y install perl ImageMagick ffmpeg ffmpeg2theora ufraw poppler-utils libreoffice-core libwpd-tools perl-Image-ExifTool ghostscript \\\n && yum clean all\nCOPY licenses /licenses\nCOPY help.1 /help.1\n#   Remove setuid/setgid binaries from images for security\nRUN find / -perm 6000 -type f -exec chmod a-s {}\nENV NUXEO_USER=\"nuxeo\"\nENV NUXEO_HOME=\"/opt/nuxeo/server\"\nENV HOME=\"/opt/nuxeo/server\"\nARG NUXEO_VERSION=8.10\nARG NUXEO_DIST_URL=http://community.nuxeo.com/static/releases/nuxeo-8.10/nuxeo-server-8.10-tomcat.zip\nARG NUXEO_MD5=29e67a19bba54099093b51d892926be1\n#   Create Nuxeo user\nRUN useradd -m -d /home/$NUXEO_USER -u 1000 -s /bin/bash $NUXEO_USER\n#   Add distribution\nRUN curl -fsSL \"${NUXEO_DIST_URL}\" -o /tmp/nuxeo-distribution-tomcat.zip \\\n && echo \"$NUXEO_MD5 /tmp/nuxeo-distribution-tomcat.zip\" | md5sum -c - \\\n && mkdir -p /tmp/nuxeo-distribution $( dirname $NUXEO_HOME ;) \\\n && unzip -q -d /tmp/nuxeo-distribution /tmp/nuxeo-distribution-tomcat.zip \\\n && DISTDIR=$( /bin/ls /tmp/nuxeo-distribution | head -n 1 ;) \\\n && mv /tmp/nuxeo-distribution/$DISTDIR $NUXEO_HOME \\\n && sed -i -e \"s/^org.nuxeo.distribution.package.*/org.nuxeo.distribution.package=docker/\" $NUXEO_HOME/templates/common/config/distribution.properties \\\n && rm -rf /tmp/nuxeo-distribution* \\\n && chmod +x $NUXEO_HOME/bin/*ctl $NUXEO_HOME/bin/*.sh \\\n && chmod g+rwX $NUXEO_HOME/bin/*ctl $NUXEO_HOME/bin/*.sh \\\n && chown -R 1000:0 $NUXEO_HOME \\\n && chmod -R g+rwX $NUXEO_HOME\n#   Protecting writeable directories to support arbitrary User IDs for OpenShift\n#   https://docs.openshift.com/container-platform/3.4/creating_images/guidelines.html\nRUN mkdir -p /var/lib/nuxeo/data \\\n && chown -R 1000:0 /var/lib/nuxeo/data \\\n && chmod -R g+rwX /var/lib/nuxeo/data \\\n && mkdir -p /var/log/nuxeo \\\n && chown -R 1000:0 /var/log/nuxeo \\\n && chmod -R g+rwX /var/log/nuxeo \\\n && mkdir -p /var/run/nuxeo \\\n && chown -R 1000:0 /var/run/nuxeo \\\n && chmod -R g+rwX /var/run/nuxeo \\\n && mkdir -p /docker-entrypoint-initnuxeo.d \\\n && chown -R 1000:0 /docker-entrypoint-initnuxeo.d \\\n && chmod -R g+rwX /docker-entrypoint-initnuxeo.d \\\n && chmod g=u /etc/passwd\nENV PATH=\"$NUXEO_HOME/bin:$PATH\"\nWORKDIR $NUXEO_HOME\nCOPY docker-entrypoint.sh /\nENTRYPOINT [\"/docker-entrypoint.sh\"]\nEXPOSE 8080/tcp\nCMD [\"nuxeoctl\", \"console\"]\nUSER 1000\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  vim:set ft=dockerfile:\nFROM registry.access.redhat.com/rhel7\nMAINTAINER Nuxeo <packagers@nuxeo.com>\nLABEL name=\"nuxeo/nuxeo\" \\\n      vendor=\"Nuxeo\" \\\n      version=\"%%NUXEO_VERSION%%\" \\\n      release=\"1\" \\\n      summary=\"Nuxeo Digital Asset Platform\" \\\n      description=\"The Nuxeo platform image packaged as a container\" \\\n      url=\"https://www.nuxeo.com\" \\\n      run=\"docker run -tdi -p 8080:8080 --name ${NAME} ${IMAGE}\" \\\n      io.k8s.description=\"Starts a Nuxeo Platform server.\" \\\n      io.k8s.display-name=\"Nuxeo\" \\\n      io.openshift.expose-services=\"8080/http\" \\\n      io.openshift.tags=\"nuxeo\" \\\n      io.openshift.min-memory=\"2Gi\" \\\n      io.openshift.min-cpu=\"2\"\n#  install java\nRUN yum-config-manager --disable rhel-7-server-htb-rpms \\\n && yum install -y java-1.8.0-openjdk java-1.8.0-openjdk-devel wget unzip\n# Add repositories need it for ffmpeg2theora and ffmpeg\nARG EPEL_RPM_URL=https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm\nARG NUX_GPG_KEY_URL=http://li.nux.ro/download/nux/RPM-GPG-KEY-nux.ro\nARG NUX_DEXTOP_RPM_URL=http://li.nux.ro/download/nux/dextop/el7/x86_64/nux-dextop-release-0-1.el7.nux.noarch.rpm\nRUN wget ${EPEL_RPM_URL} \\\n && rpm -Uvh epel-release-latest-7*.rpm \\\n && rpm --import ${NUX_GPG_KEY_URL} \\\n && rpm -Uvh ${NUX_DEXTOP_RPM_URL}\n# # must find another way to install it, need it for ffmpeg\nARG NUX_DEXTOP_FRIBIDI_RPM_URL=ftp://ftp.pbone.net/mirror/li.nux.ro/download/nux/dextop/retired/libfribidi-0.19.2-3.el7.nux.x86_64.rpm\nRUN rpm -Uvh ${NUX_DEXTOP_FRIBIDI_RPM_URL}\n#  enable repo for libreoffice\nRUN yum-config-manager --enable rhel-7-server-optional-rpms\n#  Add needed convert tools\nRUN yum -y upgrade \\\n && yum -y install perl ImageMagick ffmpeg ffmpeg2theora ufraw poppler-utils libreoffice-core libwpd-tools perl-Image-ExifTool ghostscript \\\n && yum clean all\nADD licenses /licenses\nADD help.1 /help.1\n#  Remove setuid/setgid binaries from images for security\nRUN find / -perm 6000 -type f -exec chmod a-s {} ; || true\nENV NUXEO_USER=\"nuxeo\"\nENV NUXEO_HOME=\"/opt/nuxeo/server\"\nENV HOME=\"/opt/nuxeo/server\"\nARG NUXEO_VERSION=8.10\nARG NUXEO_DIST_URL=http://community.nuxeo.com/static/releases/nuxeo-8.10/nuxeo-server-8.10-tomcat.zip\nARG NUXEO_MD5=29e67a19bba54099093b51d892926be1\n#  Create Nuxeo user\nRUN useradd -m -d /home/$NUXEO_USER -u 1000 -s /bin/bash $NUXEO_USER\n#  Add distribution\nRUN curl -fsSL \"${NUXEO_DIST_URL}\" -o /tmp/nuxeo-distribution-tomcat.zip \\\n && echo \"$NUXEO_MD5 /tmp/nuxeo-distribution-tomcat.zip\" | md5sum -c - \\\n && mkdir -p /tmp/nuxeo-distribution $( dirname $NUXEO_HOME ;) \\\n && unzip -q -d /tmp/nuxeo-distribution /tmp/nuxeo-distribution-tomcat.zip \\\n && DISTDIR=$( /bin/ls /tmp/nuxeo-distribution | head -n 1 ;) \\\n && mv /tmp/nuxeo-distribution/$DISTDIR $NUXEO_HOME \\\n && sed -i -e \"s/^org.nuxeo.distribution.package.*/org.nuxeo.distribution.package=docker/\" $NUXEO_HOME/templates/common/config/distribution.properties \\\n && rm -rf /tmp/nuxeo-distribution* \\\n && chmod +x $NUXEO_HOME/bin/*ctl $NUXEO_HOME/bin/*.sh \\\n && chmod g+rwX $NUXEO_HOME/bin/*ctl $NUXEO_HOME/bin/*.sh \\\n && chown -R 1000:0 $NUXEO_HOME \\\n && chmod -R g+rwX $NUXEO_HOME\n#  Protecting writeable directories to support arbitrary User IDs for OpenShift\n#  https://docs.openshift.com/container-platform/3.4/creating_images/guidelines.html\nRUN mkdir -p /var/lib/nuxeo/data \\\n && chown -R 1000:0 /var/lib/nuxeo/data \\\n && chmod -R g+rwX /var/lib/nuxeo/data \\\n && mkdir -p /var/log/nuxeo \\\n && chown -R 1000:0 /var/log/nuxeo \\\n && chmod -R g+rwX /var/log/nuxeo \\\n && mkdir -p /var/run/nuxeo \\\n && chown -R 1000:0 /var/run/nuxeo \\\n && chmod -R g+rwX /var/run/nuxeo \\\n && mkdir -p /docker-entrypoint-initnuxeo.d \\\n && chown -R 1000:0 /docker-entrypoint-initnuxeo.d \\\n && chmod -R g+rwX /docker-entrypoint-initnuxeo.d \\\n && chmod g=u /etc/passwd\nENV PATH=\"$NUXEO_HOME/bin:$PATH\"\nWORKDIR $NUXEO_HOME\nCOPY docker-entrypoint.sh /\nENTRYPOINT [\"/docker-entrypoint.sh\"]\nEXPOSE 8080/tcp\nCMD [\"nuxeoctl\", \"console\"]\nUSER 1000\n","injectedSmells":[],"originalDockerfileHash":"f43c751e78bfd9679acf9f00777e5dfd","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   vim:set ft=dockerfile:\nFROM registry.access.redhat.com/rhel7\nMAINTAINER Nuxeo <packagers@nuxeo.com>\nLABEL name=\"nuxeo/nuxeo\" \\\n      vendor=\"Nuxeo\" \\\n      version=\"%%NUXEO_VERSION%%\" \\\n      release=\"1\" \\\n      summary=\"Nuxeo Digital Asset Platform\" \\\n      description=\"The Nuxeo platform image packaged as a container\" \\\n      url=\"https://www.nuxeo.com\" \\\n      run=\"docker run -tdi -p 8080:8080 --name ${NAME} ${IMAGE}\" \\\n      io.k8s.description=\"Starts a Nuxeo Platform server.\" \\\n      io.k8s.display-name=\"Nuxeo\" \\\n      io.openshift.expose-services=\"8080/http\" \\\n      io.openshift.tags=\"nuxeo\" \\\n      io.openshift.min-memory=\"2Gi\" \\\n      io.openshift.min-cpu=\"2\"\n#   install java\nRUN yum-config-manager --disable rhel-7-server-htb-rpms \\\n && yum install -y java-1.8.0-openjdk java-1.8.0-openjdk-devel wget unzip\n#  Add repositories need it for ffmpeg2theora and ffmpeg\nARG EPEL_RPM_URL=https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm\nARG NUX_GPG_KEY_URL=http://li.nux.ro/download/nux/RPM-GPG-KEY-nux.ro\nARG NUX_DEXTOP_RPM_URL=http://li.nux.ro/download/nux/dextop/el7/x86_64/nux-dextop-release-0-1.el7.nux.noarch.rpm\nRUN wget ${EPEL_RPM_URL} \\\n && rpm -Uvh epel-release-latest-7*.rpm \\\n && rpm --import ${NUX_GPG_KEY_URL} \\\n && rpm -Uvh ${NUX_DEXTOP_RPM_URL}\n#  # must find another way to install it, need it for ffmpeg\nARG NUX_DEXTOP_FRIBIDI_RPM_URL=ftp://ftp.pbone.net/mirror/li.nux.ro/download/nux/dextop/retired/libfribidi-0.19.2-3.el7.nux.x86_64.rpm\nRUN rpm -Uvh ${NUX_DEXTOP_FRIBIDI_RPM_URL}\n#   enable repo for libreoffice\nRUN yum-config-manager --enable rhel-7-server-optional-rpms\n#   Add needed convert tools\nRUN yum -y upgrade \\\n && yum -y install perl ImageMagick ffmpeg ffmpeg2theora ufraw poppler-utils libreoffice-core libwpd-tools perl-Image-ExifTool ghostscript \\\n && yum clean all\nADD licenses /licenses\nADD help.1 /help.1\n#   Remove setuid/setgid binaries from images for security\nRUN find / -perm 6000 -type f -exec chmod a-s {}\nENV NUXEO_USER=\"nuxeo\"\nENV NUXEO_HOME=\"/opt/nuxeo/server\"\nENV HOME=\"/opt/nuxeo/server\"\nARG NUXEO_VERSION=8.10\nARG NUXEO_DIST_URL=http://community.nuxeo.com/static/releases/nuxeo-8.10/nuxeo-server-8.10-tomcat.zip\nARG NUXEO_MD5=29e67a19bba54099093b51d892926be1\n#   Create Nuxeo user\nRUN useradd -m -d /home/$NUXEO_USER -u 1000 -s /bin/bash $NUXEO_USER\n#   Add distribution\nRUN curl -fsSL \"${NUXEO_DIST_URL}\" -o /tmp/nuxeo-distribution-tomcat.zip \\\n && echo \"$NUXEO_MD5 /tmp/nuxeo-distribution-tomcat.zip\" | md5sum -c - \\\n && mkdir -p /tmp/nuxeo-distribution $( dirname $NUXEO_HOME ;) \\\n && unzip -q -d /tmp/nuxeo-distribution /tmp/nuxeo-distribution-tomcat.zip \\\n && DISTDIR=$( /bin/ls /tmp/nuxeo-distribution | head -n 1 ;) \\\n && mv /tmp/nuxeo-distribution/$DISTDIR $NUXEO_HOME \\\n && sed -i -e \"s/^org.nuxeo.distribution.package.*/org.nuxeo.distribution.package=docker/\" $NUXEO_HOME/templates/common/config/distribution.properties \\\n && rm -rf /tmp/nuxeo-distribution* \\\n && chmod +x $NUXEO_HOME/bin/*ctl $NUXEO_HOME/bin/*.sh \\\n && chmod g+rwX $NUXEO_HOME/bin/*ctl $NUXEO_HOME/bin/*.sh \\\n && chown -R 1000:0 $NUXEO_HOME \\\n && chmod -R g+rwX $NUXEO_HOME\n#   Protecting writeable directories to support arbitrary User IDs for OpenShift\n#   https://docs.openshift.com/container-platform/3.4/creating_images/guidelines.html\nRUN mkdir -p /var/lib/nuxeo/data \\\n && chown -R 1000:0 /var/lib/nuxeo/data \\\n && chmod -R g+rwX /var/lib/nuxeo/data \\\n && mkdir -p /var/log/nuxeo \\\n && chown -R 1000:0 /var/log/nuxeo \\\n && chmod -R g+rwX /var/log/nuxeo \\\n && mkdir -p /var/run/nuxeo \\\n && chown -R 1000:0 /var/run/nuxeo \\\n && chmod -R g+rwX /var/run/nuxeo \\\n && mkdir -p /docker-entrypoint-initnuxeo.d \\\n && chown -R 1000:0 /docker-entrypoint-initnuxeo.d \\\n && chmod -R g+rwX /docker-entrypoint-initnuxeo.d \\\n && chmod g=u /etc/passwd\nENV PATH=\"$NUXEO_HOME/bin:$PATH\"\nWORKDIR $NUXEO_HOME\nCOPY docker-entrypoint.sh /\nENTRYPOINT [\"/docker-entrypoint.sh\"]\nEXPOSE 8080/tcp\nCMD [\"nuxeoctl\", \"console\"]\nUSER 1000\n","originalDockerfileUglifiedHash":"b8ad29b479a5611bf290475ba985fe62","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/345db98b7eb1e7e4d0e4d8327cfe72233bb2ac13.dockerfile"}