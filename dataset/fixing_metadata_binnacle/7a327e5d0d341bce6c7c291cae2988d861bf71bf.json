{"seed":652669824,"processedDockerfileHash":"1e0f83551cb1643f56a132da51561333","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM nginx:stable\nMAINTAINER \"cytopia\" <cytopia@everythingcli.org>\nLABEL name=\"cytopia's nginx stable image\" \\\n      image=\"devilbox/nginx-stable\" \\\n      vendor=\"devilbox\" \\\n      license=\"MIT\"\n#  ##\n#  ## Build arguments\n#  ##\nARG VHOST_GEN_GIT_REF=0.15\nARG CERT_GEN_GIT_REF=0.2\nENV BUILD_DEPS=\"git  make  wget\"\nENV RUN_DEPS=\"ca-certificates  python-yaml  supervisor\"\n#  ##\n#  ## Runtime arguments\n#  ##\nENV MY_USER=\"nginx\"\nENV MY_GROUP=\"nginx\"\nENV HTTPD_START=\"/usr/sbin/nginx\"\nENV HTTPD_RELOAD=\"nginx -s stop\"\n#  ##\n#  ## Install required packages\n#  ##\nRUN set -x \\\n && apt-get update \\\n && apt-get install --no-install-recommends ${BUILD_DEPS} ${RUN_DEPS} --no-install-suggests -y \\\n && git clone https://github.com/devilbox/vhost-gen \\\n && cd vhost-gen \\\n && git checkout \"${VHOST_GEN_GIT_REF}\" \\\n && make install \\\n && cd .. \\\n && rm -rf vhost*gen* \\\n && wget --no-check-certificate -O /usr/bin/ca-gen https://raw.githubusercontent.com/devilbox/cert-gen/${CERT_GEN_GIT_REF}/bin/ca-gen \\\n && wget --no-check-certificate -O /usr/bin/cert-gen https://raw.githubusercontent.com/devilbox/cert-gen/${CERT_GEN_GIT_REF}/bin/cert-gen \\\n && chmod +x /usr/bin/ca-gen \\\n && chmod +x /usr/bin/cert-gen \\\n && wget --no-check-certificate -O /usr/bin/watcherd https://raw.githubusercontent.com/devilbox/watcherd/master/watcherd \\\n && chmod +x /usr/bin/watcherd \\\n && apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false $fetchDeps ${BUILD_DEPS} \\\n && rm -rf /var/lib/apt/lists/*\n#  ##\n#  ## Create directories\n#  ##\nRUN set -x \\\n && mkdir -p /etc/httpd-custom.d \\\n && mkdir -p /etc/httpd/conf.d \\\n && mkdir -p /etc/httpd/vhost.d \\\n && mkdir -p /var/www/default/htdocs \\\n && mkdir -p /shared/httpd \\\n && chmod 0775 /shared/httpd \\\n && chown ${MY_USER}:${MY_GROUP} /shared/httpd\nRUN chown www-data /var/www/default/htdocs/\n#  ##\n#  ## Copy files\n#  ##\nCOPY ./data/nginx/nginx.conf /etc/nginx/nginx.conf\nCOPY ./data/vhost-gen/main.yml /etc/vhost-gen/main.yml\nCOPY ./data/vhost-gen/mass.yml /etc/vhost-gen/mass.yml\nCOPY ./data/vhost-gen/templates-main /etc/vhost-gen/templates-main\nCOPY ./data/create-vhost.sh /usr/local/bin/create-vhost.sh\nCOPY ./data/docker-entrypoint.d /docker-entrypoint.d\nCOPY ./data/docker-entrypoint.sh /docker-entrypoint.sh\n#  ##\n#  ## Ports\n#  ##\nEXPOSE 80/tcp\nEXPOSE 443/tcp\n#  ##\n#  ## Volumes\n#  ##\nVOLUME /shared/httpd\nVOLUME /ca\n#  ##\n#  ## Signals\n#  ##\nSTOPSIGNAL SIGTERM\n#  ##\n#  ## Entrypoint\n#  ##\nENTRYPOINT [\"/docker-entrypoint.sh\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\n","originalDockerfile":"FROM nginx:stable\nMAINTAINER \"cytopia\" <cytopia@everythingcli.org>\nLABEL name=\"cytopia's nginx stable image\" \\\n      image=\"devilbox/nginx-stable\" \\\n      vendor=\"devilbox\" \\\n      license=\"MIT\"\n# ##\n# ## Build arguments\n# ##\nARG VHOST_GEN_GIT_REF=0.15\nARG CERT_GEN_GIT_REF=0.2\nENV BUILD_DEPS=\"git  make  wget\"\nENV RUN_DEPS=\"ca-certificates  python-yaml  supervisor\"\n# ##\n# ## Runtime arguments\n# ##\nENV MY_USER=\"nginx\"\nENV MY_GROUP=\"nginx\"\nENV HTTPD_START=\"/usr/sbin/nginx\"\nENV HTTPD_RELOAD=\"nginx -s stop\"\n# ##\n# ## Install required packages\n# ##\nRUN set -x \\\n && apt-get update \\\n && apt-get install --no-install-recommends ${BUILD_DEPS} ${RUN_DEPS} --no-install-suggests -y \\\n && git clone https://github.com/devilbox/vhost-gen \\\n && cd vhost-gen \\\n && git checkout \"${VHOST_GEN_GIT_REF}\" \\\n && make install \\\n && cd .. \\\n && rm -rf vhost*gen* \\\n && wget --no-check-certificate -O /usr/bin/ca-gen https://raw.githubusercontent.com/devilbox/cert-gen/${CERT_GEN_GIT_REF}/bin/ca-gen \\\n && wget --no-check-certificate -O /usr/bin/cert-gen https://raw.githubusercontent.com/devilbox/cert-gen/${CERT_GEN_GIT_REF}/bin/cert-gen \\\n && chmod +x /usr/bin/ca-gen \\\n && chmod +x /usr/bin/cert-gen \\\n && wget --no-check-certificate -O /usr/bin/watcherd https://raw.githubusercontent.com/devilbox/watcherd/master/watcherd \\\n && chmod +x /usr/bin/watcherd \\\n && apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false $fetchDeps ${BUILD_DEPS} \\\n && rm -rf /var/lib/apt/lists/*\n# ##\n# ## Create directories\n# ##\nRUN set -x \\\n && mkdir -p /etc/httpd-custom.d \\\n && mkdir -p /etc/httpd/conf.d \\\n && mkdir -p /etc/httpd/vhost.d \\\n && mkdir -p /var/www/default/htdocs \\\n && mkdir -p /shared/httpd \\\n && chmod 0775 /shared/httpd \\\n && chown ${MY_USER}:${MY_GROUP} /shared/httpd\nRUN chown www-data /var/www/default/htdocs/\n# ##\n# ## Copy files\n# ##\nCOPY ./data/nginx/nginx.conf /etc/nginx/nginx.conf\nCOPY ./data/vhost-gen/main.yml /etc/vhost-gen/main.yml\nCOPY ./data/vhost-gen/mass.yml /etc/vhost-gen/mass.yml\nCOPY ./data/vhost-gen/templates-main /etc/vhost-gen/templates-main\nCOPY ./data/create-vhost.sh /usr/local/bin/create-vhost.sh\nCOPY ./data/docker-entrypoint.d /docker-entrypoint.d\nCOPY ./data/docker-entrypoint.sh /docker-entrypoint.sh\n# ##\n# ## Ports\n# ##\nEXPOSE 80/tcp\nEXPOSE 443/tcp\n# ##\n# ## Volumes\n# ##\nVOLUME /shared/httpd\nVOLUME /ca\n# ##\n# ## Signals\n# ##\nSTOPSIGNAL SIGTERM\n# ##\n# ## Entrypoint\n# ##\nENTRYPOINT [\"/docker-entrypoint.sh\"]\n","injectedSmells":[],"originalDockerfileHash":"c408f1b80994e1807d52772b26e6f380","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM nginx:stable\nMAINTAINER \"cytopia\" <cytopia@everythingcli.org>\nLABEL name=\"cytopia's nginx stable image\" \\\n      image=\"devilbox/nginx-stable\" \\\n      vendor=\"devilbox\" \\\n      license=\"MIT\"\n#  ##\n#  ## Build arguments\n#  ##\nARG VHOST_GEN_GIT_REF=0.15\nARG CERT_GEN_GIT_REF=0.2\nENV BUILD_DEPS=\"git  make  wget\"\nENV RUN_DEPS=\"ca-certificates  python-yaml  supervisor\"\n#  ##\n#  ## Runtime arguments\n#  ##\nENV MY_USER=\"nginx\"\nENV MY_GROUP=\"nginx\"\nENV HTTPD_START=\"/usr/sbin/nginx\"\nENV HTTPD_RELOAD=\"nginx -s stop\"\n#  ##\n#  ## Install required packages\n#  ##\nRUN set -x \\\n && apt-get update \\\n && apt-get install --no-install-recommends ${BUILD_DEPS} ${RUN_DEPS} --no-install-suggests -y \\\n && git clone https://github.com/devilbox/vhost-gen \\\n && cd vhost-gen \\\n && git checkout \"${VHOST_GEN_GIT_REF}\" \\\n && make install \\\n && cd .. \\\n && rm -rf vhost*gen* \\\n && wget --no-check-certificate -O /usr/bin/ca-gen https://raw.githubusercontent.com/devilbox/cert-gen/${CERT_GEN_GIT_REF}/bin/ca-gen \\\n && wget --no-check-certificate -O /usr/bin/cert-gen https://raw.githubusercontent.com/devilbox/cert-gen/${CERT_GEN_GIT_REF}/bin/cert-gen \\\n && chmod +x /usr/bin/ca-gen \\\n && chmod +x /usr/bin/cert-gen \\\n && wget --no-check-certificate -O /usr/bin/watcherd https://raw.githubusercontent.com/devilbox/watcherd/master/watcherd \\\n && chmod +x /usr/bin/watcherd \\\n && apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false $fetchDeps ${BUILD_DEPS} \\\n && rm -rf /var/lib/apt/lists/*\n#  ##\n#  ## Create directories\n#  ##\nRUN set -x \\\n && mkdir -p /etc/httpd-custom.d \\\n && mkdir -p /etc/httpd/conf.d \\\n && mkdir -p /etc/httpd/vhost.d \\\n && mkdir -p /var/www/default/htdocs \\\n && mkdir -p /shared/httpd \\\n && chmod 0775 /shared/httpd \\\n && chown ${MY_USER}:${MY_GROUP} /shared/httpd\nRUN chown www-data /var/www/default/htdocs/\n#  ##\n#  ## Copy files\n#  ##\nCOPY ./data/nginx/nginx.conf /etc/nginx/nginx.conf\nCOPY ./data/vhost-gen/main.yml /etc/vhost-gen/main.yml\nCOPY ./data/vhost-gen/mass.yml /etc/vhost-gen/mass.yml\nCOPY ./data/vhost-gen/templates-main /etc/vhost-gen/templates-main\nCOPY ./data/create-vhost.sh /usr/local/bin/create-vhost.sh\nCOPY ./data/docker-entrypoint.d /docker-entrypoint.d\nCOPY ./data/docker-entrypoint.sh /docker-entrypoint.sh\n#  ##\n#  ## Ports\n#  ##\nEXPOSE 80/tcp\nEXPOSE 443/tcp\n#  ##\n#  ## Volumes\n#  ##\nVOLUME /shared/httpd\nVOLUME /ca\n#  ##\n#  ## Signals\n#  ##\nSTOPSIGNAL SIGTERM\n#  ##\n#  ## Entrypoint\n#  ##\nENTRYPOINT [\"/docker-entrypoint.sh\"]\n","originalDockerfileUglifiedHash":"1b6d40a176ba1afaa391ee13b797cc39","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/7a327e5d0d341bce6c7c291cae2988d861bf71bf.dockerfile"}