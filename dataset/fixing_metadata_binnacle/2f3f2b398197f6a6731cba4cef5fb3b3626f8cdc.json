{"seed":431820101,"processedDockerfileHash":"ad618057c6a6867dc13c4452db997a3e","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM alpine:3.7\nRUN apk add wget=1.20.3-r0 coreutils=8.28-r0 perl=5.26.3-r0 autoconf=2.69-r0 dpkg-dev=1.18.24-r0 dpkg=1.18.24-r0 file=5.32-r2 g++=6.4.0-r5 gcc=6.4.0-r5 libc-dev=0.7.1-r0 make=4.2.1-r0 pkgconf=1.3.10-r0 re2c=1.0.2-r0 linux-headers=4.4.6-r2 --no-cache --virtual .build-deps \\\n && mkdir -p /usr/local/src\n#   Build openssl\nARG OPENSSL_VERSION=1.1.0g\nARG OPENSSL_SHA256=\"de4d501267da39310905cb6dc8c6121f7a2cad45a7707f76df828fe1b85073af\"\nRUN cd /usr/local/src \\\n && wget \"https://www.openssl.org/source/openssl-${OPENSSL_VERSION}.tar.gz\" -O \"openssl-${OPENSSL_VERSION}.tar.gz\" \\\n && echo \"$OPENSSL_SHA256\" \"openssl-${OPENSSL_VERSION}.tar.gz\" | sha256sum -c - \\\n && tar -zxvf \"openssl-${OPENSSL_VERSION}.tar.gz\" \\\n && cd \"openssl-${OPENSSL_VERSION}\" \\\n && ./config no-async shared --prefix=/usr/local/ssl --openssldir=/usr/local/ssl -Wl,-rpath,/usr/local/ssl/lib \\\n && make \\\n && make install \\\n && cp /usr/local/ssl/bin/openssl /usr/bin/openssl \\\n && rm -rf \"/usr/local/src/openssl-${OPENSSL_VERSION}.tar.gz\" \"/usr/local/src/openssl-${OPENSSL_VERSION}\"\n#   Build GOST-engine for OpenSSL\nARG GOST_ENGINE_VERSION=3bd506dcbb835c644bd15a58f0073ae41f76cb06\nARG GOST_ENGINE_SHA256=\"4777b1dcb32f8d06abd5e04a9a2b5fe9877c018db0fc02f5f178f8a66b562025\"\nRUN apk add cmake=3.9.5-r0 unzip=6.0-r3 --no-cache --virtual .build-deps \\\n && cd /usr/local/src \\\n && wget \"https://github.com/gost-engine/engine/archive/${GOST_ENGINE_VERSION}.zip\" -O gost-engine.zip \\\n && echo \"$GOST_ENGINE_SHA256\" gost-engine.zip | sha256sum -c - \\\n && unzip gost-engine.zip -d ./ \\\n && cd \"engine-${GOST_ENGINE_VERSION}\" \\\n && sed -i 's|printf(\"GOST engine already loaded\\\\n\");|goto end;|' gost_eng.c \\\n && mkdir build \\\n && cd build \\\n && cmake -DCMAKE_BUILD_TYPE=Release -DCMAKE_C_FLAGS='-I/usr/local/ssl/include -L/usr/local/ssl/lib' -DOPENSSL_ROOT_DIR=/usr/local/ssl -DOPENSSL_INCLUDE_DIR=/usr/local/ssl/include -DOPENSSL_LIBRARIES=/usr/local/ssl/lib .. \\\n && cmake --build . --config Release \\\n && cd ../bin \\\n && cp gostsum gost12sum /usr/local/bin \\\n && cd .. \\\n && cp bin/gost.so /usr/local/ssl/lib/engines-1.1 \\\n && rm -rf \"/usr/local/src/gost-engine.zip\" \"/usr/local/src/engine-${GOST_ENGINE_VERSION}\"\n#   Enable engine\nRUN sed -i '6i openssl_conf=openssl_def' /usr/local/ssl/openssl.cnf \\\n && echo \"\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"# OpenSSL default section\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"[openssl_def]\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"engines = engine_section\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"# Engine scetion\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"[engine_section]\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"gost = gost_section\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"# Engine gost section\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"[gost_section]\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"engine_id = gost\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"dynamic_path = /usr/local/ssl/lib/engines-1.1/gost.so\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"default_algorithms = ALL\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"CRYPT_PARAMS = id-Gost28147-89-CryptoPro-A-ParamSet\" >> /usr/local/ssl/openssl.cnf\n#   Rebuild curl\nARG CURL_VERSION=7.59.0\nARG CURL_SHA256=\"099d9c32dc7b8958ca592597c9fabccdf4c08cfb7c114ff1afbbc4c6f13c9e9e\"\nRUN cd /usr/local/src \\\n && wget \"https://curl.haxx.se/download/curl-${CURL_VERSION}.tar.gz\" -O \"curl-${CURL_VERSION}.tar.gz\" \\\n && echo \"$CURL_SHA256\" \"curl-${CURL_VERSION}.tar.gz\" | sha256sum -c - \\\n && tar -zxvf \"curl-${CURL_VERSION}.tar.gz\" \\\n && cd \"curl-${CURL_VERSION}\" \\\n && CPPFLAGS=\"-I/usr/local/ssl/include\" LDFLAGS=\"-L/usr/local/ssl/lib -Wl,-rpath,/usr/local/ssl/lib\" LD_LIBRARY_PATH=/usr/local/ssl/lib ./configure --prefix=/usr/local/curl --with-ssl=/usr/local/ssl --with-libssl-prefix=/usr/local/ssl \\\n && make \\\n && make install \\\n && ln -s /usr/local/curl/bin/curl /usr/bin/curl \\\n && rm -rf \"/usr/local/src/curl-${CURL_VERSION}.tar.gz\" \"/usr/local/src/curl-${CURL_VERSION}\"\n#   Rebuild stunnel\nARG STUNNEL_VERSION=5.50\nARG STUNNEL_SHA256=\"951d92502908b852a297bd9308568f7c36598670b84286d3e05d4a3a550c0149\"\nRUN cd /usr/local/src \\\n && wget \"https://www.stunnel.org/downloads/stunnel-${STUNNEL_VERSION}.tar.gz\" -O \"stunnel-${STUNNEL_VERSION}.tar.gz\" \\\n && echo \"$STUNNEL_SHA256\" \"stunnel-${STUNNEL_VERSION}.tar.gz\" | sha256sum -c - \\\n && tar -zxvf \"stunnel-${STUNNEL_VERSION}.tar.gz\" \\\n && cd \"stunnel-${STUNNEL_VERSION}\" \\\n && CPPFLAGS=\"-I/usr/local/ssl/include\" LDFLAGS=\"-L/usr/local/ssl/lib -Wl,-rpath,/usr/local/ssl/lib\" LD_LIBRARY_PATH=/usr/local/ssl/lib ./configure --prefix=/usr/local/stunnel --with-ssl=/usr/local/ssl \\\n && make \\\n && make install \\\n && ln -s /usr/local/stunnel/bin/stunnel /usr/bin/stunnel \\\n && rm -rf \"/usr/local/src/stunnel-${STUNNEL_VERSION}.tar.gz\" \"/usr/local/src/stunnel-${STUNNEL_VERSION}\"\n#  Clean\nRUN apk del .build-deps\nRUN addgroup -S docker-user ; adduser -S -G docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM alpine:3.7\nRUN apk add --no-cache --virtual .build-deps wget coreutils perl autoconf dpkg-dev dpkg file g++ gcc libc-dev make pkgconf re2c linux-headers \\\n && mkdir -p /usr/local/src\n#  Build openssl\nARG OPENSSL_VERSION=1.1.0g\nARG OPENSSL_SHA256=\"de4d501267da39310905cb6dc8c6121f7a2cad45a7707f76df828fe1b85073af\"\nRUN cd /usr/local/src \\\n && wget \"https://www.openssl.org/source/openssl-${OPENSSL_VERSION}.tar.gz\" -O \"openssl-${OPENSSL_VERSION}.tar.gz\" \\\n && echo \"$OPENSSL_SHA256\" \"openssl-${OPENSSL_VERSION}.tar.gz\" | sha256sum -c - \\\n && tar -zxvf \"openssl-${OPENSSL_VERSION}.tar.gz\" \\\n && cd \"openssl-${OPENSSL_VERSION}\" \\\n && ./config no-async shared --prefix=/usr/local/ssl --openssldir=/usr/local/ssl -Wl,-rpath,/usr/local/ssl/lib \\\n && make \\\n && make install \\\n && cp /usr/local/ssl/bin/openssl /usr/bin/openssl \\\n && rm -rf \"/usr/local/src/openssl-${OPENSSL_VERSION}.tar.gz\" \"/usr/local/src/openssl-${OPENSSL_VERSION}\"\n#  Build GOST-engine for OpenSSL\nARG GOST_ENGINE_VERSION=3bd506dcbb835c644bd15a58f0073ae41f76cb06\nARG GOST_ENGINE_SHA256=\"4777b1dcb32f8d06abd5e04a9a2b5fe9877c018db0fc02f5f178f8a66b562025\"\nRUN apk add --no-cache --virtual .build-deps cmake unzip \\\n && cd /usr/local/src \\\n && wget \"https://github.com/gost-engine/engine/archive/${GOST_ENGINE_VERSION}.zip\" -O gost-engine.zip \\\n && echo \"$GOST_ENGINE_SHA256\" gost-engine.zip | sha256sum -c - \\\n && unzip gost-engine.zip -d ./ \\\n && cd \"engine-${GOST_ENGINE_VERSION}\" \\\n && sed -i 's|printf(\"GOST engine already loaded\\\\n\");|goto end;|' gost_eng.c \\\n && mkdir build \\\n && cd build \\\n && cmake -DCMAKE_BUILD_TYPE=Release -DCMAKE_C_FLAGS='-I/usr/local/ssl/include -L/usr/local/ssl/lib' -DOPENSSL_ROOT_DIR=/usr/local/ssl -DOPENSSL_INCLUDE_DIR=/usr/local/ssl/include -DOPENSSL_LIBRARIES=/usr/local/ssl/lib .. \\\n && cmake --build . --config Release \\\n && cd ../bin \\\n && cp gostsum gost12sum /usr/local/bin \\\n && cd .. \\\n && cp bin/gost.so /usr/local/ssl/lib/engines-1.1 \\\n && rm -rf \"/usr/local/src/gost-engine.zip\" \"/usr/local/src/engine-${GOST_ENGINE_VERSION}\"\n#  Enable engine\nRUN sed -i '6i openssl_conf=openssl_def' /usr/local/ssl/openssl.cnf \\\n && echo \"\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"# OpenSSL default section\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"[openssl_def]\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"engines = engine_section\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"# Engine scetion\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"[engine_section]\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"gost = gost_section\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"# Engine gost section\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"[gost_section]\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"engine_id = gost\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"dynamic_path = /usr/local/ssl/lib/engines-1.1/gost.so\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"default_algorithms = ALL\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"CRYPT_PARAMS = id-Gost28147-89-CryptoPro-A-ParamSet\" >> /usr/local/ssl/openssl.cnf\n#  Rebuild curl\nARG CURL_VERSION=7.59.0\nARG CURL_SHA256=\"099d9c32dc7b8958ca592597c9fabccdf4c08cfb7c114ff1afbbc4c6f13c9e9e\"\nRUN cd /usr/local/src \\\n && wget \"https://curl.haxx.se/download/curl-${CURL_VERSION}.tar.gz\" -O \"curl-${CURL_VERSION}.tar.gz\" \\\n && echo \"$CURL_SHA256\" \"curl-${CURL_VERSION}.tar.gz\" | sha256sum -c - \\\n && tar -zxvf \"curl-${CURL_VERSION}.tar.gz\" \\\n && cd \"curl-${CURL_VERSION}\" \\\n && CPPFLAGS=\"-I/usr/local/ssl/include\" LDFLAGS=\"-L/usr/local/ssl/lib -Wl,-rpath,/usr/local/ssl/lib\" LD_LIBRARY_PATH=/usr/local/ssl/lib ./configure --prefix=/usr/local/curl --with-ssl=/usr/local/ssl --with-libssl-prefix=/usr/local/ssl \\\n && make \\\n && make install \\\n && ln -s /usr/local/curl/bin/curl /usr/bin/curl \\\n && rm -rf \"/usr/local/src/curl-${CURL_VERSION}.tar.gz\" \"/usr/local/src/curl-${CURL_VERSION}\"\n#  Rebuild stunnel\nARG STUNNEL_VERSION=5.50\nARG STUNNEL_SHA256=\"951d92502908b852a297bd9308568f7c36598670b84286d3e05d4a3a550c0149\"\nRUN cd /usr/local/src \\\n && wget \"https://www.stunnel.org/downloads/stunnel-${STUNNEL_VERSION}.tar.gz\" -O \"stunnel-${STUNNEL_VERSION}.tar.gz\" \\\n && echo \"$STUNNEL_SHA256\" \"stunnel-${STUNNEL_VERSION}.tar.gz\" | sha256sum -c - \\\n && tar -zxvf \"stunnel-${STUNNEL_VERSION}.tar.gz\" \\\n && cd \"stunnel-${STUNNEL_VERSION}\" \\\n && CPPFLAGS=\"-I/usr/local/ssl/include\" LDFLAGS=\"-L/usr/local/ssl/lib -Wl,-rpath,/usr/local/ssl/lib\" LD_LIBRARY_PATH=/usr/local/ssl/lib ./configure --prefix=/usr/local/stunnel --with-ssl=/usr/local/ssl \\\n && make \\\n && make install \\\n && ln -s /usr/local/stunnel/bin/stunnel /usr/bin/stunnel \\\n && rm -rf \"/usr/local/src/stunnel-${STUNNEL_VERSION}.tar.gz\" \"/usr/local/src/stunnel-${STUNNEL_VERSION}\"\n# Clean\nRUN apk del .build-deps\n","injectedSmells":[],"originalDockerfileHash":"0c11bfab43f04d6f81f457e919bd0d45","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM alpine:3.7\nRUN apk add --no-cache --virtual .build-deps wget coreutils perl autoconf dpkg-dev dpkg file g++ gcc libc-dev make pkgconf re2c linux-headers \\\n && mkdir -p /usr/local/src\n#   Build openssl\nARG OPENSSL_VERSION=1.1.0g\nARG OPENSSL_SHA256=\"de4d501267da39310905cb6dc8c6121f7a2cad45a7707f76df828fe1b85073af\"\nRUN cd /usr/local/src \\\n && wget \"https://www.openssl.org/source/openssl-${OPENSSL_VERSION}.tar.gz\" -O \"openssl-${OPENSSL_VERSION}.tar.gz\" \\\n && echo \"$OPENSSL_SHA256\" \"openssl-${OPENSSL_VERSION}.tar.gz\" | sha256sum -c - \\\n && tar -zxvf \"openssl-${OPENSSL_VERSION}.tar.gz\" \\\n && cd \"openssl-${OPENSSL_VERSION}\" \\\n && ./config no-async shared --prefix=/usr/local/ssl --openssldir=/usr/local/ssl -Wl,-rpath,/usr/local/ssl/lib \\\n && make \\\n && make install \\\n && cp /usr/local/ssl/bin/openssl /usr/bin/openssl \\\n && rm -rf \"/usr/local/src/openssl-${OPENSSL_VERSION}.tar.gz\" \"/usr/local/src/openssl-${OPENSSL_VERSION}\"\n#   Build GOST-engine for OpenSSL\nARG GOST_ENGINE_VERSION=3bd506dcbb835c644bd15a58f0073ae41f76cb06\nARG GOST_ENGINE_SHA256=\"4777b1dcb32f8d06abd5e04a9a2b5fe9877c018db0fc02f5f178f8a66b562025\"\nRUN apk add --no-cache --virtual .build-deps cmake unzip \\\n && cd /usr/local/src \\\n && wget \"https://github.com/gost-engine/engine/archive/${GOST_ENGINE_VERSION}.zip\" -O gost-engine.zip \\\n && echo \"$GOST_ENGINE_SHA256\" gost-engine.zip | sha256sum -c - \\\n && unzip gost-engine.zip -d ./ \\\n && cd \"engine-${GOST_ENGINE_VERSION}\" \\\n && sed -i 's|printf(\"GOST engine already loaded\\\\n\");|goto end;|' gost_eng.c \\\n && mkdir build \\\n && cd build \\\n && cmake -DCMAKE_BUILD_TYPE=Release -DCMAKE_C_FLAGS='-I/usr/local/ssl/include -L/usr/local/ssl/lib' -DOPENSSL_ROOT_DIR=/usr/local/ssl -DOPENSSL_INCLUDE_DIR=/usr/local/ssl/include -DOPENSSL_LIBRARIES=/usr/local/ssl/lib .. \\\n && cmake --build . --config Release \\\n && cd ../bin \\\n && cp gostsum gost12sum /usr/local/bin \\\n && cd .. \\\n && cp bin/gost.so /usr/local/ssl/lib/engines-1.1 \\\n && rm -rf \"/usr/local/src/gost-engine.zip\" \"/usr/local/src/engine-${GOST_ENGINE_VERSION}\"\n#   Enable engine\nRUN sed -i '6i openssl_conf=openssl_def' /usr/local/ssl/openssl.cnf \\\n && echo \"\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"# OpenSSL default section\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"[openssl_def]\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"engines = engine_section\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"# Engine scetion\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"[engine_section]\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"gost = gost_section\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"# Engine gost section\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"[gost_section]\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"engine_id = gost\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"dynamic_path = /usr/local/ssl/lib/engines-1.1/gost.so\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"default_algorithms = ALL\" >> /usr/local/ssl/openssl.cnf \\\n && echo \"CRYPT_PARAMS = id-Gost28147-89-CryptoPro-A-ParamSet\" >> /usr/local/ssl/openssl.cnf\n#   Rebuild curl\nARG CURL_VERSION=7.59.0\nARG CURL_SHA256=\"099d9c32dc7b8958ca592597c9fabccdf4c08cfb7c114ff1afbbc4c6f13c9e9e\"\nRUN cd /usr/local/src \\\n && wget \"https://curl.haxx.se/download/curl-${CURL_VERSION}.tar.gz\" -O \"curl-${CURL_VERSION}.tar.gz\" \\\n && echo \"$CURL_SHA256\" \"curl-${CURL_VERSION}.tar.gz\" | sha256sum -c - \\\n && tar -zxvf \"curl-${CURL_VERSION}.tar.gz\" \\\n && cd \"curl-${CURL_VERSION}\" \\\n && CPPFLAGS=\"-I/usr/local/ssl/include\" LDFLAGS=\"-L/usr/local/ssl/lib -Wl,-rpath,/usr/local/ssl/lib\" LD_LIBRARY_PATH=/usr/local/ssl/lib ./configure --prefix=/usr/local/curl --with-ssl=/usr/local/ssl --with-libssl-prefix=/usr/local/ssl \\\n && make \\\n && make install \\\n && ln -s /usr/local/curl/bin/curl /usr/bin/curl \\\n && rm -rf \"/usr/local/src/curl-${CURL_VERSION}.tar.gz\" \"/usr/local/src/curl-${CURL_VERSION}\"\n#   Rebuild stunnel\nARG STUNNEL_VERSION=5.50\nARG STUNNEL_SHA256=\"951d92502908b852a297bd9308568f7c36598670b84286d3e05d4a3a550c0149\"\nRUN cd /usr/local/src \\\n && wget \"https://www.stunnel.org/downloads/stunnel-${STUNNEL_VERSION}.tar.gz\" -O \"stunnel-${STUNNEL_VERSION}.tar.gz\" \\\n && echo \"$STUNNEL_SHA256\" \"stunnel-${STUNNEL_VERSION}.tar.gz\" | sha256sum -c - \\\n && tar -zxvf \"stunnel-${STUNNEL_VERSION}.tar.gz\" \\\n && cd \"stunnel-${STUNNEL_VERSION}\" \\\n && CPPFLAGS=\"-I/usr/local/ssl/include\" LDFLAGS=\"-L/usr/local/ssl/lib -Wl,-rpath,/usr/local/ssl/lib\" LD_LIBRARY_PATH=/usr/local/ssl/lib ./configure --prefix=/usr/local/stunnel --with-ssl=/usr/local/ssl \\\n && make \\\n && make install \\\n && ln -s /usr/local/stunnel/bin/stunnel /usr/bin/stunnel \\\n && rm -rf \"/usr/local/src/stunnel-${STUNNEL_VERSION}.tar.gz\" \"/usr/local/src/stunnel-${STUNNEL_VERSION}\"\n#  Clean\nRUN apk del .build-deps\n","originalDockerfileUglifiedHash":"e5498c390d76db4921dc45b5b0ae6978","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/2f3f2b398197f6a6731cba4cef5fb3b3626f8cdc.dockerfile"}