{"seed":556912700,"processedDockerfileHash":"58087e9f707485ff3439201f383fcb8f","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM __REGISTRY_NAME__/confd:__VERSION_CONFD__\nRUN build_pkgs=\"build-base linux-headers openssl-dev pcre-dev wget zlib-dev\" \\\n && runtime_pkgs=\"ca-certificates openssl pcre zlib\" \\\n && php_pkgs=\"php5-fpm php5-mcrypt php5-soap php5-openssl php5-gmp php5-pdo_odbc php5-json php5-dom php5-pdo php5-zip php5-mysql php5-mysqli php5-sqlite3 php5-apcu php5-pdo_pgsql php5-bcmath php5-gd php5-xcache php5-odbc php5-pdo_mysql php5-pdo_sqlite php5-gettext php5-xmlreader php5-xmlrpc php5-bz2 php5-memcache php5-mssql php5-iconv php5-pdo_dblib php5-curl php5-ctype\" \\\n && apk add ${build_pkgs} ${runtime_pkgs} ${php_pkgs} --update \\\n && cd /tmp \\\n && mkdir unzip \\\n && wget https://bitbucket.org/nginx-goodies/nginx-sticky-module-ng/get/08a395c66e42.zip \\\n && unzip 08a395c66e42.zip -d unzip \\\n && wget http://nginx.org/download/nginx-1.10.1.tar.gz \\\n && tar xzf nginx-1.10.1.tar.gz \\\n && cd /tmp/nginx-1.10.1 \\\n && ./configure --prefix=/etc/nginx --sbin-path=/usr/sbin/nginx --conf-path=/etc/nginx/nginx.conf --error-log-path=/var/log/nginx/error.log --http-log-path=/var/log/nginx/access.log --pid-path=/var/run/nginx.pid --lock-path=/var/run/nginx.lock --user=nobody --with-http_ssl_module --with-http_realip_module --with-http_addition_module --with-http_sub_module --with-http_dav_module --with-http_flv_module --with-http_mp4_module --with-http_gunzip_module --with-http_gzip_static_module --with-http_random_index_module --with-http_secure_link_module --with-http_stub_status_module --with-http_auth_request_module --with-threads --with-stream --with-stream_ssl_module --with-http_slice_module --with-mail --with-mail_ssl_module --with-file-aio --with-http_v2_module --with-ipv6 --add-module=/tmp/unzip/nginx-goodies-nginx-sticky-module-ng-08a395c66e42 \\\n && make \\\n && make install\nRUN sed -i -e \"s/include/;include/g\" /etc/php5/php-fpm.conf\n#   Lay down the configuration templates\nCOPY confd-files/00-upstream.toml.toml /etc/confd/conf.d/00-upstream.toml.toml\nCOPY confd-files/00-upstream.toml.template /etc/confd/templates/00-upstream.toml.template\nCOPY confd-files/00-upstream.template.toml /etc/confd/conf.d/00-upstream.template.toml\nCOPY confd-files/00-upstream.template.template /etc/confd/templates/00-upstream.template.template\nCOPY nginx.conf /etc/nginx/nginx.conf\nCOPY promote-candidate.sh /promote-candidate.sh\nRUN mkdir -pv /etc/sv/nginx \\\n && chmod 2775 /etc/sv/nginx \\\n && ln -sv /etc/sv/nginx /service \\\n && mkdir -p /run/nginx /etc/nginx/sites-enabled \\\n && chmod +x /promote-candidate.sh\nCOPY nginx-files/99-app /etc/nginx/sites-enabled/99-app\nCOPY nginx-files/00-upstream-placeholder /etc/nginx/sites-enabled/00-upstream\nCOPY nginx.sh /etc/sv/nginx/run\nRUN chmod +x /etc/sv/nginx/run\nRUN mkdir -pv /etc/sv/php-fpm \\\n && chmod 2775 /etc/sv/php-fpm \\\n && ln -sv /etc/sv/php-fpm /service\nCOPY php-fpm.sh /tmp\nRUN chmod +x /tmp/php-fpm.sh\nCOPY php-fpm2.sh /etc/sv/php-fpm/run\nRUN chmod +x /etc/sv/php-fpm/run\nCOPY ui /etc/nginx/html\nCOPY mime.types /etc/nginx\n#   Override the confd start script\nCOPY confd.sh /etc/sv/confd/run\nRUN chmod +x /etc/sv/confd/run\n#   Cleanup unneeded files from upstream confd image\nRUN rm /etc/confd/conf.d/hello-world.toml.template /etc/confd/templates/hello-world.conf.template_orig\nENTRYPOINT [\"/sbin/runsvdir\", \"/service\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM __REGISTRY_NAME__/confd:__VERSION_CONFD__\nRUN build_pkgs=\"build-base linux-headers openssl-dev pcre-dev wget zlib-dev\" \\\n && runtime_pkgs=\"ca-certificates openssl pcre zlib\" \\\n && php_pkgs=\"php5-fpm php5-mcrypt php5-soap php5-openssl php5-gmp php5-pdo_odbc php5-json php5-dom php5-pdo php5-zip php5-mysql php5-mysqli php5-sqlite3 php5-apcu php5-pdo_pgsql php5-bcmath php5-gd php5-xcache php5-odbc php5-pdo_mysql php5-pdo_sqlite php5-gettext php5-xmlreader php5-xmlrpc php5-bz2 php5-memcache php5-mssql php5-iconv php5-pdo_dblib php5-curl php5-ctype\" \\\n && apk --update add ${build_pkgs} ${runtime_pkgs} ${php_pkgs} \\\n && cd /tmp \\\n && mkdir unzip \\\n && wget https://bitbucket.org/nginx-goodies/nginx-sticky-module-ng/get/08a395c66e42.zip \\\n && unzip 08a395c66e42.zip -d unzip \\\n && wget http://nginx.org/download/nginx-1.10.1.tar.gz \\\n && tar xzf nginx-1.10.1.tar.gz \\\n && cd /tmp/nginx-1.10.1 \\\n && ./configure --prefix=/etc/nginx --sbin-path=/usr/sbin/nginx --conf-path=/etc/nginx/nginx.conf --error-log-path=/var/log/nginx/error.log --http-log-path=/var/log/nginx/access.log --pid-path=/var/run/nginx.pid --lock-path=/var/run/nginx.lock --user=nobody --with-http_ssl_module --with-http_realip_module --with-http_addition_module --with-http_sub_module --with-http_dav_module --with-http_flv_module --with-http_mp4_module --with-http_gunzip_module --with-http_gzip_static_module --with-http_random_index_module --with-http_secure_link_module --with-http_stub_status_module --with-http_auth_request_module --with-threads --with-stream --with-stream_ssl_module --with-http_slice_module --with-mail --with-mail_ssl_module --with-file-aio --with-http_v2_module --with-ipv6 --add-module=/tmp/unzip/nginx-goodies-nginx-sticky-module-ng-08a395c66e42 \\\n && make \\\n && make install\nRUN sed -i -e \"s/include/;include/g\" /etc/php5/php-fpm.conf\n#  Lay down the configuration templates\nADD confd-files/00-upstream.toml.toml /etc/confd/conf.d/00-upstream.toml.toml\nADD confd-files/00-upstream.toml.template /etc/confd/templates/00-upstream.toml.template\nADD confd-files/00-upstream.template.toml /etc/confd/conf.d/00-upstream.template.toml\nADD confd-files/00-upstream.template.template /etc/confd/templates/00-upstream.template.template\nADD nginx.conf /etc/nginx/nginx.conf\nADD promote-candidate.sh /promote-candidate.sh\nRUN mkdir -pv /etc/sv/nginx \\\n && chmod 2775 /etc/sv/nginx \\\n && ln -sv /etc/sv/nginx /service \\\n && mkdir -p /run/nginx /etc/nginx/sites-enabled \\\n && chmod +x /promote-candidate.sh\nADD nginx-files/99-app /etc/nginx/sites-enabled/99-app\nADD nginx-files/00-upstream-placeholder /etc/nginx/sites-enabled/00-upstream\nADD nginx.sh /etc/sv/nginx/run\nRUN chmod +x /etc/sv/nginx/run\nRUN mkdir -pv /etc/sv/php-fpm \\\n && chmod 2775 /etc/sv/php-fpm \\\n && ln -sv /etc/sv/php-fpm /service\nADD php-fpm.sh /tmp\nRUN chmod +x /tmp/php-fpm.sh\nADD php-fpm2.sh /etc/sv/php-fpm/run\nRUN chmod +x /etc/sv/php-fpm/run\nADD ui /etc/nginx/html\nADD mime.types /etc/nginx\n#  Override the confd start script\nADD confd.sh /etc/sv/confd/run\nRUN chmod +x /etc/sv/confd/run\n#  Cleanup unneeded files from upstream confd image\nRUN rm /etc/confd/conf.d/hello-world.toml.template /etc/confd/templates/hello-world.conf.template_orig\nENTRYPOINT [\"/sbin/runsvdir\", \"/service\"]\n","injectedSmells":[],"originalDockerfileHash":"6463ac4ab84a28a7106894cc2131d03c","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM __REGISTRY_NAME__/confd:__VERSION_CONFD__\nRUN build_pkgs=\"build-base linux-headers openssl-dev pcre-dev wget zlib-dev\" \\\n && runtime_pkgs=\"ca-certificates openssl pcre zlib\" \\\n && php_pkgs=\"php5-fpm php5-mcrypt php5-soap php5-openssl php5-gmp php5-pdo_odbc php5-json php5-dom php5-pdo php5-zip php5-mysql php5-mysqli php5-sqlite3 php5-apcu php5-pdo_pgsql php5-bcmath php5-gd php5-xcache php5-odbc php5-pdo_mysql php5-pdo_sqlite php5-gettext php5-xmlreader php5-xmlrpc php5-bz2 php5-memcache php5-mssql php5-iconv php5-pdo_dblib php5-curl php5-ctype\" \\\n && apk --update add ${build_pkgs} ${runtime_pkgs} ${php_pkgs} \\\n && cd /tmp \\\n && mkdir unzip \\\n && wget https://bitbucket.org/nginx-goodies/nginx-sticky-module-ng/get/08a395c66e42.zip \\\n && unzip 08a395c66e42.zip -d unzip \\\n && wget http://nginx.org/download/nginx-1.10.1.tar.gz \\\n && tar xzf nginx-1.10.1.tar.gz \\\n && cd /tmp/nginx-1.10.1 \\\n && ./configure --prefix=/etc/nginx --sbin-path=/usr/sbin/nginx --conf-path=/etc/nginx/nginx.conf --error-log-path=/var/log/nginx/error.log --http-log-path=/var/log/nginx/access.log --pid-path=/var/run/nginx.pid --lock-path=/var/run/nginx.lock --user=nobody --with-http_ssl_module --with-http_realip_module --with-http_addition_module --with-http_sub_module --with-http_dav_module --with-http_flv_module --with-http_mp4_module --with-http_gunzip_module --with-http_gzip_static_module --with-http_random_index_module --with-http_secure_link_module --with-http_stub_status_module --with-http_auth_request_module --with-threads --with-stream --with-stream_ssl_module --with-http_slice_module --with-mail --with-mail_ssl_module --with-file-aio --with-http_v2_module --with-ipv6 --add-module=/tmp/unzip/nginx-goodies-nginx-sticky-module-ng-08a395c66e42 \\\n && make \\\n && make install\nRUN sed -i -e \"s/include/;include/g\" /etc/php5/php-fpm.conf\n#   Lay down the configuration templates\nADD confd-files/00-upstream.toml.toml /etc/confd/conf.d/00-upstream.toml.toml\nADD confd-files/00-upstream.toml.template /etc/confd/templates/00-upstream.toml.template\nADD confd-files/00-upstream.template.toml /etc/confd/conf.d/00-upstream.template.toml\nADD confd-files/00-upstream.template.template /etc/confd/templates/00-upstream.template.template\nADD nginx.conf /etc/nginx/nginx.conf\nADD promote-candidate.sh /promote-candidate.sh\nRUN mkdir -pv /etc/sv/nginx \\\n && chmod 2775 /etc/sv/nginx \\\n && ln -sv /etc/sv/nginx /service \\\n && mkdir -p /run/nginx /etc/nginx/sites-enabled \\\n && chmod +x /promote-candidate.sh\nADD nginx-files/99-app /etc/nginx/sites-enabled/99-app\nADD nginx-files/00-upstream-placeholder /etc/nginx/sites-enabled/00-upstream\nADD nginx.sh /etc/sv/nginx/run\nRUN chmod +x /etc/sv/nginx/run\nRUN mkdir -pv /etc/sv/php-fpm \\\n && chmod 2775 /etc/sv/php-fpm \\\n && ln -sv /etc/sv/php-fpm /service\nADD php-fpm.sh /tmp\nRUN chmod +x /tmp/php-fpm.sh\nADD php-fpm2.sh /etc/sv/php-fpm/run\nRUN chmod +x /etc/sv/php-fpm/run\nADD ui /etc/nginx/html\nADD mime.types /etc/nginx\n#   Override the confd start script\nADD confd.sh /etc/sv/confd/run\nRUN chmod +x /etc/sv/confd/run\n#   Cleanup unneeded files from upstream confd image\nRUN rm /etc/confd/conf.d/hello-world.toml.template /etc/confd/templates/hello-world.conf.template_orig\nENTRYPOINT [\"/sbin/runsvdir\", \"/service\"]\n","originalDockerfileUglifiedHash":"da31a0984fee7d8bf27bd28f5250ed98","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/3c3cb78bdf004d3495f15af9f32b6db39aed41eb.dockerfile"}