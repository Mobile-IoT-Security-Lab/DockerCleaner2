{"seed":1405573183,"processedDockerfileHash":"abc7222156f345835e95cc9158700638","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM nginx:stable-alpine\nARG BUILD_DATE\nARG VCS_REF\nARG VERSION\nLABEL maintainer=\"CrazyMax\" \\\n      org.label-schema.build-date=\"$BUILD_DATE\" \\\n      org.label-schema.name=\"rtorrent-rutorrent\" \\\n      org.label-schema.description=\"rTorrent and ruTorrent\" \\\n      org.label-schema.version=\"$VERSION\" \\\n      org.label-schema.url=\"https://github.com/crazy-max/docker-rtorrent-rutorrent\" \\\n      org.label-schema.vcs-ref=\"$VCS_REF\" \\\n      org.label-schema.vcs-url=\"https://github.com/crazy-max/docker-rtorrent-rutorrent\" \\\n      org.label-schema.vendor=\"CrazyMax\" \\\n      org.label-schema.schema-version=\"1.0\"\nENV RTORRENT_VERSION=\"0.9.7\" \\\n    LIBTORRENT_VERSION=\"0.13.7\" \\\n    XMLRPC_VERSION=\"01.54.00\" \\\n    LIBSIG_VERSION=\"2.10.1\" \\\n    CARES_VERSION=\"1.14.0\" \\\n    CURL_VERSION=\"7.63.0\" \\\n    MKTORRENT_VERSION=\"1.1\" \\\n    NGINX_DAV_VERSION=\"3.0.0\"\nRUN apk add autoconf=2.71-r1 automake=1.16.5-r1 binutils=2.39-r2 build-base=0.5-r3 cppunit-dev=1.15.1-r1 git=2.38.4-r1 libtool=2.4.7-r1 libressl-dev=3.6.2-r0 linux-headers=5.19.5-r0 ncurses-dev=6.3_p20221119-r0 subversion=1.14.2-r4 tar=1.34-r2 wget=1.21.3-r2 xz=5.2.9-r0 zlib-dev=1.2.13-r0 --update --no-cache -t build-dependencies \\\n && cd /tmp \\\n && svn checkout http://svn.code.sf.net/p/xmlrpc-c/code/release_number/${XMLRPC_VERSION}/ xmlrpc-c \\\n && cd xmlrpc-c \\\n && ./configure \\\n && make \\\n && make install \\\n && cd /tmp \\\n && wget http://ftp.gnome.org/pub/GNOME/sources/libsigc++/2.10/libsigc++-${LIBSIG_VERSION}.tar.xz \\\n && unxz libsigc++-${LIBSIG_VERSION}.tar.xz \\\n && tar -xf libsigc++-${LIBSIG_VERSION}.tar \\\n && cd libsigc++-${LIBSIG_VERSION} \\\n && ./configure \\\n && make \\\n && make install \\\n && cd /tmp \\\n && wget https://c-ares.haxx.se/download/c-ares-${CARES_VERSION}.tar.gz \\\n && tar zxf c-ares-${CARES_VERSION}.tar.gz \\\n && cd c-ares-${CARES_VERSION} \\\n && ./configure \\\n && make \\\n && make install \\\n && cd /tmp \\\n && wget https://curl.haxx.se/download/curl-${CURL_VERSION}.tar.gz \\\n && tar zxf curl-${CURL_VERSION}.tar.gz \\\n && cd curl-${CURL_VERSION} \\\n && ./configure --enable-ares --enable-tls-srp --enable-gnu-tls --with-ssl --with-zlib \\\n && make \\\n && make install \\\n && cd /tmp \\\n && git clone https://github.com/rakshasa/libtorrent.git \\\n && cd libtorrent \\\n && git checkout tags/v${LIBTORRENT_VERSION} \\\n && ./autogen.sh \\\n && ./configure --with-posix-fallocate \\\n && make \\\n && make install \\\n && cd /tmp \\\n && git clone https://github.com/rakshasa/rtorrent.git \\\n && cd rtorrent \\\n && git checkout tags/v${RTORRENT_VERSION} \\\n && ./autogen.sh \\\n && ./configure --with-xmlrpc-c --with-ncurses \\\n && make \\\n && make install \\\n && git clone https://github.com/esmil/mktorrent.git \\\n && cd mktorrent \\\n && git checkout tags/v${MKTORRENT_VERSION} \\\n && make \\\n && make install \\\n && apk del build-dependencies \\\n && rm -rf /tmp/* /var/cache/apk/*\nENV RUTORRENT_VERSION=\"3.9\" \\\n    RUTORRENT_REVISION=\"702afd3\"\nRUN apk add apache2-utils=2.4.57-r0 bind-tools=9.18.13-r0 binutils=2.39-r2 ca-certificates=20220614-r4 coreutils=9.1-r0 dhclient=4.4.3_p1-r1 ffmpeg=5.1.3-r0 geoip=1.6.12-r3 grep=3.8-r1 gzip=1.12-r0 libressl=3.6.2-r0 libstdc++=12.2.1_git20220924-r4 mediainfo=22.09-r0 ncurses=6.3_p20221119-r0 pcre=8.45-r2 php7 php7-cli php7-ctype php7-curl php7-fpm php7-json php7-mbstring php7-openssl php7-phar php7-session php7-sockets php7-xml php7-zip php7-zlib shadow=4.13-r0 sox=14.4.2-r9 supervisor=4.2.4-r0 tar=1.34-r2 tzdata=2023c-r0 unrar unzip=6.0-r13 util-linux=2.38.1-r1 wget=1.21.3-r2 zip=3.0-r10 zlib=1.2.13-r0 --update --no-cache \\\n && apk add build-base=0.5-r3 libxslt-dev=1.1.37-r1 libxml2-dev=2.10.4-r0 git=2.38.4-r1 linux-headers=5.19.5-r0 libressl-dev=3.6.2-r0 pcre-dev=8.45-r2 zlib-dev=1.2.13-r0 --update --no-cache -t build-dependencies \\\n && mkdir -p /usr/src \\\n && cd /usr/src \\\n && wget http://nginx.org/download/nginx-$NGINX_VERSION.tar.gz \\\n && tar zxvf nginx-$NGINX_VERSION.tar.gz \\\n && git clone -b v${NGINX_DAV_VERSION} --single-branch --depth 1 https://github.com/arut/nginx-dav-ext-module.git \\\n && cd nginx-$NGINX_VERSION \\\n && ./configure --with-compat --add-dynamic-module=../nginx-dav-ext-module \\\n && make modules \\\n && cp objs/ngx_http_dav_ext_module.so /etc/nginx/modules \\\n && mkdir -p /data /var/log/supervisord /var/www \\\n && cd /var/www \\\n && git clone https://github.com/Novik/ruTorrent.git rutorrent \\\n && cd rutorrent \\\n && git checkout ${RUTORRENT_REVISION} \\\n && git clone https://github.com/Micdu70/geoip2-rutorrent /var/www/rutorrent/plugins/geoip2 \\\n && cd /var/www/rutorrent/plugins/geoip2/database \\\n && wget -q http://geolite.maxmind.com/download/geoip/database/GeoLite2-City.tar.gz \\\n && wget -q http://geolite.maxmind.com/download/geoip/database/GeoLite2-Country.tar.gz \\\n && tar -xvzf GeoLite2-City.tar.gz --strip-components=1 \\\n && tar -xvzf GeoLite2-Country.tar.gz --strip-components=1 \\\n && rm -f *.gz \\\n && addgroup -g 1000 rtorrent \\\n && adduser -u 1000 -G rtorrent -h /home/rtorrent -s /sbin/nologin -D rtorrent \\\n && usermod -a -G rtorrent nginx \\\n && chown -R rtorrent. /data /var/log/php7 /var/www/rutorrent \\\n && apk del build-dependencies \\\n && rm -rf /etc/nginx/conf.d/* /usr/src/nginx* /tmp/* /var/cache/apk/* /var/www/rutorrent/.git* /var/www/rutorrent/conf/users /var/www/rutorrent/plugins/geoip /var/www/rutorrent/plugins/geoip2/.git /var/www/rutorrent/share\nCOPY entrypoint.sh /entrypoint.sh\nCOPY assets /\nRUN chmod a+x /entrypoint.sh \\\n && chown -R nginx. /etc/nginx/conf.d /var/log/nginx\nEXPOSE 6881/udp 8000/tcp 8080/tcp 9000/tcp 50000/tcp\nVOLUME [ \"/data\", \"/passwd\" ]\nENTRYPOINT [\"/entrypoint.sh\"]\nCMD [\"/usr/bin/supervisord\", \"-c\", \"/etc/supervisord.conf\"]\nRUN addgroup -S docker-user ; adduser -S -G docker-user docker-user\nUSER docker-user\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\n","originalDockerfile":"FROM nginx:stable-alpine\nARG BUILD_DATE\nARG VCS_REF\nARG VERSION\nLABEL maintainer=\"CrazyMax\" \\\n      org.label-schema.build-date=\"$BUILD_DATE\" \\\n      org.label-schema.name=\"rtorrent-rutorrent\" \\\n      org.label-schema.description=\"rTorrent and ruTorrent\" \\\n      org.label-schema.version=\"$VERSION\" \\\n      org.label-schema.url=\"https://github.com/crazy-max/docker-rtorrent-rutorrent\" \\\n      org.label-schema.vcs-ref=\"$VCS_REF\" \\\n      org.label-schema.vcs-url=\"https://github.com/crazy-max/docker-rtorrent-rutorrent\" \\\n      org.label-schema.vendor=\"CrazyMax\" \\\n      org.label-schema.schema-version=\"1.0\"\nENV RTORRENT_VERSION=\"0.9.7\" \\\n    LIBTORRENT_VERSION=\"0.13.7\" \\\n    XMLRPC_VERSION=\"01.54.00\" \\\n    LIBSIG_VERSION=\"2.10.1\" \\\n    CARES_VERSION=\"1.14.0\" \\\n    CURL_VERSION=\"7.63.0\" \\\n    MKTORRENT_VERSION=\"1.1\" \\\n    NGINX_DAV_VERSION=\"3.0.0\"\nRUN apk --update --no-cache add -t build-dependencies autoconf automake binutils build-base cppunit-dev git libtool libressl-dev linux-headers ncurses-dev subversion tar wget xz zlib-dev \\\n && cd /tmp \\\n && svn checkout http://svn.code.sf.net/p/xmlrpc-c/code/release_number/${XMLRPC_VERSION}/ xmlrpc-c \\\n && cd xmlrpc-c \\\n && ./configure \\\n && make \\\n && make install \\\n && cd /tmp \\\n && wget http://ftp.gnome.org/pub/GNOME/sources/libsigc++/2.10/libsigc++-${LIBSIG_VERSION}.tar.xz \\\n && unxz libsigc++-${LIBSIG_VERSION}.tar.xz \\\n && tar -xf libsigc++-${LIBSIG_VERSION}.tar \\\n && cd libsigc++-${LIBSIG_VERSION} \\\n && ./configure \\\n && make \\\n && make install \\\n && cd /tmp \\\n && wget https://c-ares.haxx.se/download/c-ares-${CARES_VERSION}.tar.gz \\\n && tar zxf c-ares-${CARES_VERSION}.tar.gz \\\n && cd c-ares-${CARES_VERSION} \\\n && ./configure \\\n && make \\\n && make install \\\n && cd /tmp \\\n && wget https://curl.haxx.se/download/curl-${CURL_VERSION}.tar.gz \\\n && tar zxf curl-${CURL_VERSION}.tar.gz \\\n && cd curl-${CURL_VERSION} \\\n && ./configure --enable-ares --enable-tls-srp --enable-gnu-tls --with-ssl --with-zlib \\\n && make \\\n && make install \\\n && cd /tmp \\\n && git clone https://github.com/rakshasa/libtorrent.git \\\n && cd libtorrent \\\n && git checkout tags/v${LIBTORRENT_VERSION} \\\n && ./autogen.sh \\\n && ./configure --with-posix-fallocate \\\n && make \\\n && make install \\\n && cd /tmp \\\n && git clone https://github.com/rakshasa/rtorrent.git \\\n && cd rtorrent \\\n && git checkout tags/v${RTORRENT_VERSION} \\\n && ./autogen.sh \\\n && ./configure --with-xmlrpc-c --with-ncurses \\\n && make \\\n && make install \\\n && git clone https://github.com/esmil/mktorrent.git \\\n && cd mktorrent \\\n && git checkout tags/v${MKTORRENT_VERSION} \\\n && make \\\n && make install \\\n && apk del build-dependencies \\\n && rm -rf /tmp/* /var/cache/apk/*\nENV RUTORRENT_VERSION=\"3.9\" \\\n    RUTORRENT_REVISION=\"702afd3\"\nRUN apk --update --no-cache add apache2-utils bind-tools binutils ca-certificates coreutils dhclient ffmpeg geoip grep gzip libressl libstdc++ mediainfo ncurses pcre php7 php7-cli php7-ctype php7-curl php7-fpm php7-json php7-mbstring php7-openssl php7-phar php7-session php7-sockets php7-xml php7-zip php7-zlib shadow sox supervisor tar tzdata unrar unzip util-linux wget zip zlib \\\n && apk --update --no-cache add -t build-dependencies build-base libxslt-dev libxml2-dev git linux-headers libressl-dev pcre-dev zlib-dev \\\n && mkdir -p /usr/src \\\n && cd /usr/src \\\n && wget http://nginx.org/download/nginx-$NGINX_VERSION.tar.gz \\\n && tar zxvf nginx-$NGINX_VERSION.tar.gz \\\n && git clone -b v${NGINX_DAV_VERSION} --single-branch --depth 1 https://github.com/arut/nginx-dav-ext-module.git \\\n && cd nginx-$NGINX_VERSION \\\n && ./configure --with-compat --add-dynamic-module=../nginx-dav-ext-module \\\n && make modules \\\n && cp objs/ngx_http_dav_ext_module.so /etc/nginx/modules \\\n && mkdir -p /data /var/log/supervisord /var/www \\\n && cd /var/www \\\n && git clone https://github.com/Novik/ruTorrent.git rutorrent \\\n && cd rutorrent \\\n && git checkout ${RUTORRENT_REVISION} \\\n && git clone https://github.com/Micdu70/geoip2-rutorrent /var/www/rutorrent/plugins/geoip2 \\\n && cd /var/www/rutorrent/plugins/geoip2/database \\\n && wget -q http://geolite.maxmind.com/download/geoip/database/GeoLite2-City.tar.gz \\\n && wget -q http://geolite.maxmind.com/download/geoip/database/GeoLite2-Country.tar.gz \\\n && tar -xvzf GeoLite2-City.tar.gz --strip-components=1 \\\n && tar -xvzf GeoLite2-Country.tar.gz --strip-components=1 \\\n && rm -f *.gz \\\n && addgroup -g 1000 rtorrent \\\n && adduser -u 1000 -G rtorrent -h /home/rtorrent -s /sbin/nologin -D rtorrent \\\n && usermod -a -G rtorrent nginx \\\n && chown -R rtorrent. /data /var/log/php7 /var/www/rutorrent \\\n && apk del build-dependencies \\\n && rm -rf /etc/nginx/conf.d/* /usr/src/nginx* /tmp/* /var/cache/apk/* /var/www/rutorrent/.git* /var/www/rutorrent/conf/users /var/www/rutorrent/plugins/geoip /var/www/rutorrent/plugins/geoip2/.git /var/www/rutorrent/share\nCOPY entrypoint.sh /entrypoint.sh\nCOPY assets /\nRUN chmod a+x /entrypoint.sh \\\n && chown -R nginx. /etc/nginx/conf.d /var/log/nginx\nEXPOSE 6881/udp 8000/tcp 8080/tcp 9000/tcp 50000/tcp\nVOLUME [ \"/data\", \"/passwd\" ]\nENTRYPOINT [\"/entrypoint.sh\"]\nCMD [\"/usr/bin/supervisord\", \"-c\", \"/etc/supervisord.conf\"]\n","injectedSmells":[],"originalDockerfileHash":"588589a80ce273e35647a36453c7583f","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM nginx:stable-alpine\nARG BUILD_DATE\nARG VCS_REF\nARG VERSION\nLABEL maintainer=\"CrazyMax\" \\\n      org.label-schema.build-date=\"$BUILD_DATE\" \\\n      org.label-schema.name=\"rtorrent-rutorrent\" \\\n      org.label-schema.description=\"rTorrent and ruTorrent\" \\\n      org.label-schema.version=\"$VERSION\" \\\n      org.label-schema.url=\"https://github.com/crazy-max/docker-rtorrent-rutorrent\" \\\n      org.label-schema.vcs-ref=\"$VCS_REF\" \\\n      org.label-schema.vcs-url=\"https://github.com/crazy-max/docker-rtorrent-rutorrent\" \\\n      org.label-schema.vendor=\"CrazyMax\" \\\n      org.label-schema.schema-version=\"1.0\"\nENV RTORRENT_VERSION=\"0.9.7\" \\\n    LIBTORRENT_VERSION=\"0.13.7\" \\\n    XMLRPC_VERSION=\"01.54.00\" \\\n    LIBSIG_VERSION=\"2.10.1\" \\\n    CARES_VERSION=\"1.14.0\" \\\n    CURL_VERSION=\"7.63.0\" \\\n    MKTORRENT_VERSION=\"1.1\" \\\n    NGINX_DAV_VERSION=\"3.0.0\"\nRUN apk --update --no-cache add -t build-dependencies autoconf automake binutils build-base cppunit-dev git libtool libressl-dev linux-headers ncurses-dev subversion tar wget xz zlib-dev \\\n && cd /tmp \\\n && svn checkout http://svn.code.sf.net/p/xmlrpc-c/code/release_number/${XMLRPC_VERSION}/ xmlrpc-c \\\n && cd xmlrpc-c \\\n && ./configure \\\n && make \\\n && make install \\\n && cd /tmp \\\n && wget http://ftp.gnome.org/pub/GNOME/sources/libsigc++/2.10/libsigc++-${LIBSIG_VERSION}.tar.xz \\\n && unxz libsigc++-${LIBSIG_VERSION}.tar.xz \\\n && tar -xf libsigc++-${LIBSIG_VERSION}.tar \\\n && cd libsigc++-${LIBSIG_VERSION} \\\n && ./configure \\\n && make \\\n && make install \\\n && cd /tmp \\\n && wget https://c-ares.haxx.se/download/c-ares-${CARES_VERSION}.tar.gz \\\n && tar zxf c-ares-${CARES_VERSION}.tar.gz \\\n && cd c-ares-${CARES_VERSION} \\\n && ./configure \\\n && make \\\n && make install \\\n && cd /tmp \\\n && wget https://curl.haxx.se/download/curl-${CURL_VERSION}.tar.gz \\\n && tar zxf curl-${CURL_VERSION}.tar.gz \\\n && cd curl-${CURL_VERSION} \\\n && ./configure --enable-ares --enable-tls-srp --enable-gnu-tls --with-ssl --with-zlib \\\n && make \\\n && make install \\\n && cd /tmp \\\n && git clone https://github.com/rakshasa/libtorrent.git \\\n && cd libtorrent \\\n && git checkout tags/v${LIBTORRENT_VERSION} \\\n && ./autogen.sh \\\n && ./configure --with-posix-fallocate \\\n && make \\\n && make install \\\n && cd /tmp \\\n && git clone https://github.com/rakshasa/rtorrent.git \\\n && cd rtorrent \\\n && git checkout tags/v${RTORRENT_VERSION} \\\n && ./autogen.sh \\\n && ./configure --with-xmlrpc-c --with-ncurses \\\n && make \\\n && make install \\\n && git clone https://github.com/esmil/mktorrent.git \\\n && cd mktorrent \\\n && git checkout tags/v${MKTORRENT_VERSION} \\\n && make \\\n && make install \\\n && apk del build-dependencies \\\n && rm -rf /tmp/* /var/cache/apk/*\nENV RUTORRENT_VERSION=\"3.9\" \\\n    RUTORRENT_REVISION=\"702afd3\"\nRUN apk --update --no-cache add apache2-utils bind-tools binutils ca-certificates coreutils dhclient ffmpeg geoip grep gzip libressl libstdc++ mediainfo ncurses pcre php7 php7-cli php7-ctype php7-curl php7-fpm php7-json php7-mbstring php7-openssl php7-phar php7-session php7-sockets php7-xml php7-zip php7-zlib shadow sox supervisor tar tzdata unrar unzip util-linux wget zip zlib \\\n && apk --update --no-cache add -t build-dependencies build-base libxslt-dev libxml2-dev git linux-headers libressl-dev pcre-dev zlib-dev \\\n && mkdir -p /usr/src \\\n && cd /usr/src \\\n && wget http://nginx.org/download/nginx-$NGINX_VERSION.tar.gz \\\n && tar zxvf nginx-$NGINX_VERSION.tar.gz \\\n && git clone -b v${NGINX_DAV_VERSION} --single-branch --depth 1 https://github.com/arut/nginx-dav-ext-module.git \\\n && cd nginx-$NGINX_VERSION \\\n && ./configure --with-compat --add-dynamic-module=../nginx-dav-ext-module \\\n && make modules \\\n && cp objs/ngx_http_dav_ext_module.so /etc/nginx/modules \\\n && mkdir -p /data /var/log/supervisord /var/www \\\n && cd /var/www \\\n && git clone https://github.com/Novik/ruTorrent.git rutorrent \\\n && cd rutorrent \\\n && git checkout ${RUTORRENT_REVISION} \\\n && git clone https://github.com/Micdu70/geoip2-rutorrent /var/www/rutorrent/plugins/geoip2 \\\n && cd /var/www/rutorrent/plugins/geoip2/database \\\n && wget -q http://geolite.maxmind.com/download/geoip/database/GeoLite2-City.tar.gz \\\n && wget -q http://geolite.maxmind.com/download/geoip/database/GeoLite2-Country.tar.gz \\\n && tar -xvzf GeoLite2-City.tar.gz --strip-components=1 \\\n && tar -xvzf GeoLite2-Country.tar.gz --strip-components=1 \\\n && rm -f *.gz \\\n && addgroup -g 1000 rtorrent \\\n && adduser -u 1000 -G rtorrent -h /home/rtorrent -s /sbin/nologin -D rtorrent \\\n && usermod -a -G rtorrent nginx \\\n && chown -R rtorrent. /data /var/log/php7 /var/www/rutorrent \\\n && apk del build-dependencies \\\n && rm -rf /etc/nginx/conf.d/* /usr/src/nginx* /tmp/* /var/cache/apk/* /var/www/rutorrent/.git* /var/www/rutorrent/conf/users /var/www/rutorrent/plugins/geoip /var/www/rutorrent/plugins/geoip2/.git /var/www/rutorrent/share\nCOPY entrypoint.sh /entrypoint.sh\nCOPY assets /\nRUN chmod a+x /entrypoint.sh \\\n && chown -R nginx. /etc/nginx/conf.d /var/log/nginx\nEXPOSE 6881/udp 8000/tcp 8080/tcp 9000/tcp 50000/tcp\nVOLUME [ \"/data\", \"/passwd\" ]\nENTRYPOINT [\"/entrypoint.sh\"]\nCMD [\"/usr/bin/supervisord\", \"-c\", \"/etc/supervisord.conf\"]\n","originalDockerfileUglifiedHash":"588589a80ce273e35647a36453c7583f","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/4044b033630087909bba3de0f9820f9acffe4fe1.dockerfile"}