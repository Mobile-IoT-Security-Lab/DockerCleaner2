{"seed":153268441,"processedDockerfileHash":"cadc637cf1149c3e19b7eac2e1aff5d3","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["have-a-healthcheck","have-a-user"],"processedDockerfile":"#   AUTOMATICALLY GENERATED\n#   DO NOT EDIT THIS FILE DIRECTLY, USE /Dockerfile.tmpl.php\n#   https://hub.docker.com/_/debian\nFROM debian:stretch-slim\nMAINTAINER Instrumentisto Team <developer@instrumentisto.com>\n#   Build and install Postfix\n#   https://git.launchpad.net/postfix/tree/debian/rules?id=94dfb9850484db5f47958eaa86f958857ab9834c\nRUN apt-get update \\\n && apt-get upgrade -y \\\n && apt-get install --no-install-recommends inetutils-syslogd ca-certificates -y --no-install-suggests \\\n && update-ca-certificates \\\n && apt-get install --no-install-recommends libpcre3 libicu57 libdb5.3 libpq5 libmariadbclient18 libsqlite3-0 libsasl2-2 libldap-2.4 -y --no-install-suggests \\\n && toolDeps=\" curl make gcc g++ libc-dev \" \\\n && apt-get install --no-install-recommends $toolDeps -y --no-install-suggests \\\n && buildDeps=\" libssl-dev libpcre3-dev libicu-dev libdb-dev libpq-dev libmariadbclient-dev libsqlite3-dev libsasl2-dev libldap2-dev \" \\\n && apt-get install --no-install-recommends $buildDeps -y --no-install-suggests \\\n && curl -fL -o /tmp/postfix.tar.gz http://cdn.postfix.johnriley.me/mirrors/postfix-release/official/postfix-3.1.3.tar.gz \\\n && (echo \"00e2b0974e59420cabfddc92597a99b42c8a8c9cd9a0c279c63ba6be9f40b15400f37dc16d0b1312130e72b5ba82b56fc7d579ee9ef975a957c0931b0401213c /tmp/postfix.tar.gz\" | sha512sum -c - ) \\\n && tar -xzf /tmp/postfix.tar.gz -C /tmp/ \\\n && cd /tmp/postfix-* \\\n && sed -i -e \"s:/usr/local/:/usr/:g\" conf/master.cf \\\n && make makefiles CCARGS=\"-DHAS_SHL_LOAD -DUSE_TLS -DHAS_PCRE $( pcre-config --cflags ;) -DHAS_PGSQL -I/usr/include/postgresql -DHAS_MYSQL $( mysql_config --include ;) -DHAS_SQLITE -I/usr/include -DHAS_LDAP -I/usr/include -DUSE_CYRUS_SASL -I/usr/include/sasl -DUSE_SASL_AUTH -DDEF_SASL_SERVER=\\\"dovecot\\\" -DUSE_LDAP_SASL\" AUXLIBS=\"-lssl -lcrypto -lsasl2\" AUXLIBS_PCRE=\"$( pcre-config --libs ;)\" AUXLIBS_PGSQL=\"-lpq\" AUXLIBS_MYSQL=\"$( mysql_config --libs ;)\" AUXLIBS_SQLITE=\"-lsqlite3 -lpthread\" AUXLIBS_LDAP=\"-lldap -llber\" shared=yes dynamicmaps=yes pie=yes daemon_directory=/usr/lib/postfix shlibs_directory=/usr/lib/postfix manpage_directory=/tmp/man readme_directory=/tmp/readme html_directory=/tmp/html \\\n && make \\\n && addgroup --system --gid 91 postfix \\\n && adduser --system --uid 90 --disabled-password --no-create-home --home /var/spool/postfix --ingroup postfix --gecos postfix postfix \\\n && adduser postfix mail \\\n && addgroup --system --gid 93 postdrop \\\n && adduser --system --uid 92 --disabled-password --shell /sbin/nologin --no-create-home --home /var/mail/domains --ingroup postdrop --gecos vmail vmail \\\n && make upgrade \\\n && chmod g+s /usr/sbin/postdrop /usr/sbin/postqueue \\\n && install -d -o postfix -g postfix /var/spool/postfix \\\n && sed -i -e 's,^manpage_directory =.*,manpage_directory = /dev/null,' -e 's,^readme_directory =.*,readme_directory = /dev/null,' -e 's,^html_directory =.*,html_directory = /dev/null,' /etc/postfix/main.cf \\\n && install -d /etc/postfix/main.cf.d \\\n && install -d /etc/postfix/master.cf.d \\\n && install -d /etc/ssl/postfix \\\n && openssl req -new -x509 -nodes -days 365 -subj \"/CN=smtp.example.com\" -out /etc/ssl/postfix/server.crt -keyout /etc/ssl/postfix/server.key \\\n && chmod 0600 /etc/ssl/postfix/server.key \\\n && openssl dhparam -out /etc/postfix/dh2048.pem 2048 \\\n && echo \"\\n \\n# TLS PARAMETERS \\n# \\ntls_ssl_options = NO_COMPRESSION \\ntls_high_cipherlist = ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256 \\n \\n# SMTP TLS PARAMETERS (outgoing connections) \\n# \\nsmtp_tls_security_level = may \\nsmtp_tls_CApath = /etc/ssl/certs \\n \\n# SMTPD TLS PARAMETERS (incoming connections) \\n# \\nsmtpd_tls_security_level = may \\nsmtpd_tls_ciphers = high \\nsmtpd_tls_mandatory_ciphers = high \\nsmtpd_tls_exclude_ciphers = aNULL, LOW, EXP, MEDIUM, ADH, AECDH, MD5, DSS, ECDSA, CAMELLIA128, 3DES, CAMELLIA256, RSA+AES, eNULL \\nsmtpd_tls_dh1024_param_file = /etc/postfix/dh2048.pem \\nsmtpd_tls_CApath = /etc/ssl/certs \\nsmtpd_tls_cert_file = /etc/ssl/postfix/server.crt \\nsmtpd_tls_key_file = /etc/ssl/postfix/server.key \" >> /etc/postfix/main.cf \\\n && apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false $toolDeps $buildDeps \\\n && rm -rf /var/lib/apt/lists/* /etc/*/inetutils-syslogd /tmp/*\n#   Install s6-overlay\nRUN apt-get update \\\n && apt-get install --no-install-recommends curl -y --no-install-suggests \\\n && curl -fL -o /tmp/s6-overlay.tar.gz https://github.com/just-containers/s6-overlay/releases/download/v1.21.2.2/s6-overlay-amd64.tar.gz \\\n && mkdir -p /tmp/s6-overlay \\\n && tar -xzf /tmp/s6-overlay.tar.gz -C /tmp/s6-overlay/ \\\n && cp -rf /tmp/s6-overlay/bin/* /bin/ \\\n && rm -rf /tmp/s6-overlay/bin /tmp/s6-overlay/usr/bin/execlineb \\\n && cp -rf /tmp/s6-overlay/* / \\\n && apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false curl \\\n && rm -rf /var/lib/apt/lists/* /tmp/*\nENV S6_BEHAVIOUR_IF_STAGE2_FAILS=\"2\" \\\n    S6_CMD_WAIT_FOR_SERVICES=\"1\"\nCOPY rootfs /\nRUN chmod +x /etc/services.d/*/run /etc/cont-init.d/*\nEXPOSE 25/tcp 465/tcp 587/tcp\nENTRYPOINT [\"/init\"]\nCMD [\"/usr/lib/postfix/master\", \"-d\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  AUTOMATICALLY GENERATED\n#  DO NOT EDIT THIS FILE DIRECTLY, USE /Dockerfile.tmpl.php\n#  https://hub.docker.com/_/debian\nFROM debian:stretch-slim\nMAINTAINER Instrumentisto Team <developer@instrumentisto.com>\n#  Build and install Postfix\n#  https://git.launchpad.net/postfix/tree/debian/rules?id=94dfb9850484db5f47958eaa86f958857ab9834c\nRUN apt-get update \\\n && apt-get upgrade -y \\\n && apt-get install --no-install-recommends inetutils-syslogd ca-certificates -y --no-install-suggests \\\n && update-ca-certificates \\\n && apt-get install --no-install-recommends libpcre3 libicu57 libdb5.3 libpq5 libmariadbclient18 libsqlite3-0 libsasl2-2 libldap-2.4 -y --no-install-suggests \\\n && toolDeps=\" curl make gcc g++ libc-dev \" \\\n && apt-get install --no-install-recommends $toolDeps -y --no-install-suggests \\\n && buildDeps=\" libssl-dev libpcre3-dev libicu-dev libdb-dev libpq-dev libmariadbclient-dev libsqlite3-dev libsasl2-dev libldap2-dev \" \\\n && apt-get install --no-install-recommends $buildDeps -y --no-install-suggests \\\n && curl -fL -o /tmp/postfix.tar.gz http://cdn.postfix.johnriley.me/mirrors/postfix-release/official/postfix-3.1.3.tar.gz \\\n && (echo \"00e2b0974e59420cabfddc92597a99b42c8a8c9cd9a0c279c63ba6be9f40b15400f37dc16d0b1312130e72b5ba82b56fc7d579ee9ef975a957c0931b0401213c /tmp/postfix.tar.gz\" | sha512sum -c - ) \\\n && tar -xzf /tmp/postfix.tar.gz -C /tmp/ \\\n && cd /tmp/postfix-* \\\n && sed -i -e \"s:/usr/local/:/usr/:g\" conf/master.cf \\\n && make makefiles CCARGS=\"-DHAS_SHL_LOAD -DUSE_TLS -DHAS_PCRE $( pcre-config --cflags ;) -DHAS_PGSQL -I/usr/include/postgresql -DHAS_MYSQL $( mysql_config --include ;) -DHAS_SQLITE -I/usr/include -DHAS_LDAP -I/usr/include -DUSE_CYRUS_SASL -I/usr/include/sasl -DUSE_SASL_AUTH -DDEF_SASL_SERVER=\\\\\"dovecot\\\\\" -DUSE_LDAP_SASL\" AUXLIBS=\"-lssl -lcrypto -lsasl2\" AUXLIBS_PCRE=\"$( pcre-config --libs ;)\" AUXLIBS_PGSQL=\"-lpq\" AUXLIBS_MYSQL=\"$( mysql_config --libs ;)\" AUXLIBS_SQLITE=\"-lsqlite3 -lpthread\" AUXLIBS_LDAP=\"-lldap -llber\" shared=yes dynamicmaps=yes pie=yes daemon_directory=/usr/lib/postfix shlibs_directory=/usr/lib/postfix manpage_directory=/tmp/man readme_directory=/tmp/readme html_directory=/tmp/html \\\n && make \\\n && addgroup --system --gid 91 postfix \\\n && adduser --system --uid 90 --disabled-password --no-create-home --home /var/spool/postfix --ingroup postfix --gecos postfix postfix \\\n && adduser postfix mail \\\n && addgroup --system --gid 93 postdrop \\\n && adduser --system --uid 92 --disabled-password --shell /sbin/nologin --no-create-home --home /var/mail/domains --ingroup postdrop --gecos vmail vmail \\\n && make upgrade \\\n && chmod g+s /usr/sbin/postdrop /usr/sbin/postqueue \\\n && install -d -o postfix -g postfix /var/spool/postfix \\\n && sed -i -e 's,^manpage_directory =.*,manpage_directory = /dev/null,' -e 's,^readme_directory =.*,readme_directory = /dev/null,' -e 's,^html_directory =.*,html_directory = /dev/null,' /etc/postfix/main.cf \\\n && install -d /etc/postfix/main.cf.d \\\n && install -d /etc/postfix/master.cf.d \\\n && install -d /etc/ssl/postfix \\\n && openssl req -new -x509 -nodes -days 365 -subj \"/CN=smtp.example.com\" -out /etc/ssl/postfix/server.crt -keyout /etc/ssl/postfix/server.key \\\n && chmod 0600 /etc/ssl/postfix/server.key \\\n && openssl dhparam -out /etc/postfix/dh2048.pem 2048 \\\n && echo \"\\n \\n# TLS PARAMETERS \\n# \\ntls_ssl_options = NO_COMPRESSION \\ntls_high_cipherlist = ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256 \\n \\n# SMTP TLS PARAMETERS (outgoing connections) \\n# \\nsmtp_tls_security_level = may \\nsmtp_tls_CApath = /etc/ssl/certs \\n \\n# SMTPD TLS PARAMETERS (incoming connections) \\n# \\nsmtpd_tls_security_level = may \\nsmtpd_tls_ciphers = high \\nsmtpd_tls_mandatory_ciphers = high \\nsmtpd_tls_exclude_ciphers = aNULL, LOW, EXP, MEDIUM, ADH, AECDH, MD5, DSS, ECDSA, CAMELLIA128, 3DES, CAMELLIA256, RSA+AES, eNULL \\nsmtpd_tls_dh1024_param_file = /etc/postfix/dh2048.pem \\nsmtpd_tls_CApath = /etc/ssl/certs \\nsmtpd_tls_cert_file = /etc/ssl/postfix/server.crt \\nsmtpd_tls_key_file = /etc/ssl/postfix/server.key \" >> /etc/postfix/main.cf \\\n && apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false $toolDeps $buildDeps \\\n && rm -rf /var/lib/apt/lists/* /etc/*/inetutils-syslogd /tmp/*\n#  Install s6-overlay\nRUN apt-get update \\\n && apt-get install --no-install-recommends curl -y --no-install-suggests \\\n && curl -fL -o /tmp/s6-overlay.tar.gz https://github.com/just-containers/s6-overlay/releases/download/v1.21.2.2/s6-overlay-amd64.tar.gz \\\n && mkdir -p /tmp/s6-overlay \\\n && tar -xzf /tmp/s6-overlay.tar.gz -C /tmp/s6-overlay/ \\\n && cp -rf /tmp/s6-overlay/bin/* /bin/ \\\n && rm -rf /tmp/s6-overlay/bin /tmp/s6-overlay/usr/bin/execlineb \\\n && cp -rf /tmp/s6-overlay/* / \\\n && apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false curl \\\n && rm -rf /var/lib/apt/lists/* /tmp/*\nENV S6_BEHAVIOUR_IF_STAGE2_FAILS=\"2\" \\\n    S6_CMD_WAIT_FOR_SERVICES=\"1\"\nCOPY rootfs /\nRUN chmod +x /etc/services.d/*/run /etc/cont-init.d/*\nEXPOSE 25/tcp 465/tcp 587/tcp\nENTRYPOINT [\"/init\"]\nCMD [\"/usr/lib/postfix/master\", \"-d\"]\n","injectedSmells":[],"originalDockerfileHash":"238eeab6a165dec18b6382bd0922b0d9","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   AUTOMATICALLY GENERATED\n#   DO NOT EDIT THIS FILE DIRECTLY, USE /Dockerfile.tmpl.php\n#   https://hub.docker.com/_/debian\nFROM debian:stretch-slim\nMAINTAINER Instrumentisto Team <developer@instrumentisto.com>\n#   Build and install Postfix\n#   https://git.launchpad.net/postfix/tree/debian/rules?id=94dfb9850484db5f47958eaa86f958857ab9834c\nRUN apt-get update \\\n && apt-get upgrade -y \\\n && apt-get install --no-install-recommends inetutils-syslogd ca-certificates -y --no-install-suggests \\\n && update-ca-certificates \\\n && apt-get install --no-install-recommends libpcre3 libicu57 libdb5.3 libpq5 libmariadbclient18 libsqlite3-0 libsasl2-2 libldap-2.4 -y --no-install-suggests \\\n && toolDeps=\" curl make gcc g++ libc-dev \" \\\n && apt-get install --no-install-recommends $toolDeps -y --no-install-suggests \\\n && buildDeps=\" libssl-dev libpcre3-dev libicu-dev libdb-dev libpq-dev libmariadbclient-dev libsqlite3-dev libsasl2-dev libldap2-dev \" \\\n && apt-get install --no-install-recommends $buildDeps -y --no-install-suggests \\\n && curl -fL -o /tmp/postfix.tar.gz http://cdn.postfix.johnriley.me/mirrors/postfix-release/official/postfix-3.1.3.tar.gz \\\n && (echo \"00e2b0974e59420cabfddc92597a99b42c8a8c9cd9a0c279c63ba6be9f40b15400f37dc16d0b1312130e72b5ba82b56fc7d579ee9ef975a957c0931b0401213c /tmp/postfix.tar.gz\" | sha512sum -c - ) \\\n && tar -xzf /tmp/postfix.tar.gz -C /tmp/ \\\n && cd /tmp/postfix-* \\\n && sed -i -e \"s:/usr/local/:/usr/:g\" conf/master.cf \\\n && make makefiles CCARGS=\"-DHAS_SHL_LOAD -DUSE_TLS -DHAS_PCRE $( pcre-config --cflags ;) -DHAS_PGSQL -I/usr/include/postgresql -DHAS_MYSQL $( mysql_config --include ;) -DHAS_SQLITE -I/usr/include -DHAS_LDAP -I/usr/include -DUSE_CYRUS_SASL -I/usr/include/sasl -DUSE_SASL_AUTH -DDEF_SASL_SERVER=\\\"dovecot\\\" -DUSE_LDAP_SASL\" AUXLIBS=\"-lssl -lcrypto -lsasl2\" AUXLIBS_PCRE=\"$( pcre-config --libs ;)\" AUXLIBS_PGSQL=\"-lpq\" AUXLIBS_MYSQL=\"$( mysql_config --libs ;)\" AUXLIBS_SQLITE=\"-lsqlite3 -lpthread\" AUXLIBS_LDAP=\"-lldap -llber\" shared=yes dynamicmaps=yes pie=yes daemon_directory=/usr/lib/postfix shlibs_directory=/usr/lib/postfix manpage_directory=/tmp/man readme_directory=/tmp/readme html_directory=/tmp/html \\\n && make \\\n && addgroup --system --gid 91 postfix \\\n && adduser --system --uid 90 --disabled-password --no-create-home --home /var/spool/postfix --ingroup postfix --gecos postfix postfix \\\n && adduser postfix mail \\\n && addgroup --system --gid 93 postdrop \\\n && adduser --system --uid 92 --disabled-password --shell /sbin/nologin --no-create-home --home /var/mail/domains --ingroup postdrop --gecos vmail vmail \\\n && make upgrade \\\n && chmod g+s /usr/sbin/postdrop /usr/sbin/postqueue \\\n && install -d -o postfix -g postfix /var/spool/postfix \\\n && sed -i -e 's,^manpage_directory =.*,manpage_directory = /dev/null,' -e 's,^readme_directory =.*,readme_directory = /dev/null,' -e 's,^html_directory =.*,html_directory = /dev/null,' /etc/postfix/main.cf \\\n && install -d /etc/postfix/main.cf.d \\\n && install -d /etc/postfix/master.cf.d \\\n && install -d /etc/ssl/postfix \\\n && openssl req -new -x509 -nodes -days 365 -subj \"/CN=smtp.example.com\" -out /etc/ssl/postfix/server.crt -keyout /etc/ssl/postfix/server.key \\\n && chmod 0600 /etc/ssl/postfix/server.key \\\n && openssl dhparam -out /etc/postfix/dh2048.pem 2048 \\\n && echo \"\\n \\n# TLS PARAMETERS \\n# \\ntls_ssl_options = NO_COMPRESSION \\ntls_high_cipherlist = ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256 \\n \\n# SMTP TLS PARAMETERS (outgoing connections) \\n# \\nsmtp_tls_security_level = may \\nsmtp_tls_CApath = /etc/ssl/certs \\n \\n# SMTPD TLS PARAMETERS (incoming connections) \\n# \\nsmtpd_tls_security_level = may \\nsmtpd_tls_ciphers = high \\nsmtpd_tls_mandatory_ciphers = high \\nsmtpd_tls_exclude_ciphers = aNULL, LOW, EXP, MEDIUM, ADH, AECDH, MD5, DSS, ECDSA, CAMELLIA128, 3DES, CAMELLIA256, RSA+AES, eNULL \\nsmtpd_tls_dh1024_param_file = /etc/postfix/dh2048.pem \\nsmtpd_tls_CApath = /etc/ssl/certs \\nsmtpd_tls_cert_file = /etc/ssl/postfix/server.crt \\nsmtpd_tls_key_file = /etc/ssl/postfix/server.key \" >> /etc/postfix/main.cf \\\n && apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false $toolDeps $buildDeps \\\n && rm -rf /var/lib/apt/lists/* /etc/*/inetutils-syslogd /tmp/*\n#   Install s6-overlay\nRUN apt-get update \\\n && apt-get install --no-install-recommends curl -y --no-install-suggests \\\n && curl -fL -o /tmp/s6-overlay.tar.gz https://github.com/just-containers/s6-overlay/releases/download/v1.21.2.2/s6-overlay-amd64.tar.gz \\\n && mkdir -p /tmp/s6-overlay \\\n && tar -xzf /tmp/s6-overlay.tar.gz -C /tmp/s6-overlay/ \\\n && cp -rf /tmp/s6-overlay/bin/* /bin/ \\\n && rm -rf /tmp/s6-overlay/bin /tmp/s6-overlay/usr/bin/execlineb \\\n && cp -rf /tmp/s6-overlay/* / \\\n && apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false curl \\\n && rm -rf /var/lib/apt/lists/* /tmp/*\nENV S6_BEHAVIOUR_IF_STAGE2_FAILS=\"2\" \\\n    S6_CMD_WAIT_FOR_SERVICES=\"1\"\nCOPY rootfs /\nRUN chmod +x /etc/services.d/*/run /etc/cont-init.d/*\nEXPOSE 25/tcp 465/tcp 587/tcp\nENTRYPOINT [\"/init\"]\nCMD [\"/usr/lib/postfix/master\", \"-d\"]\n","originalDockerfileUglifiedHash":"f7359aab6a4e2fde8ddae1d829ca6278","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/a9f9c0286ed8b3618ad4de20936e4bac82937775.dockerfile"}