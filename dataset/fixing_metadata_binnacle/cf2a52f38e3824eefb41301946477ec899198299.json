{"seed":780297913,"processedDockerfileHash":"ff41b4d6aec918d6a86a438058873986","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM phusion/baseimage:0.11\nRUN useradd --create-home --shell /bin/bash musicbrainz\nWORKDIR /home/musicbrainz\nCOPY docker/yarn_pubkey.txt .\nRUN apt-get update \\\n && apt-get install --no-install-recommends ca-certificates curl gnupg --no-install-suggests -y \\\n && apt-key add yarn_pubkey.txt \\\n && rm yarn_pubkey.txt \\\n && apt-key adv --keyserver keyserver.ubuntu.com --refresh-keys 'Yarn' \\\n && echo \"deb https://dl.yarnpkg.com/debian/ stable main\" | tee /etc/apt/sources.list.d/yarn.list \\\n && curl -sLO https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb \\\n && curl -sLO https://deb.nodesource.com/node_10.x/pool/main/n/nodejs/nodejs_10.10.0-1nodesource1_amd64.deb \\\n && apt-get update \\\n && apt-get install --no-install-recommends ./google-chrome-stable_current_amd64.deb ./nodejs_10.10.0-1nodesource1_amd64.deb build-essential bzip2 default-jre gcc gettext git language-pack-de language-pack-el language-pack-es language-pack-et language-pack-fi language-pack-fr language-pack-it language-pack-ja language-pack-nl libc6-dev libdb-dev libdb5.3 libexpat1 libexpat1-dev libicu-dev libicu60 libperl-dev libpq-dev libpq5 libssl-dev libssl1.0.0 libxml2 libxml2-dev locales make openssh-client perl postgresql postgresql-10-pgtap postgresql-contrib postgresql-server-dev-10 python-minimal redis-server runit runit-systemd sudo unzip yarn --no-install-suggests -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && rm google-chrome-stable_current_amd64.deb \\\n && rm nodejs_10.10.0-1nodesource1_amd64.deb\nRUN wget -q -O - https://cpanmin.us | perl - App::cpanminus \\\n && cpanm Carton JSON::XS\nRUN curl -sLO https://chromedriver.storage.googleapis.com/74.0.3729.6/chromedriver_linux64.zip \\\n && unzip chromedriver_linux64.zip -d /usr/local/bin \\\n && chmod +x /usr/local/bin/chromedriver \\\n && rm chromedriver_linux64.zip\nRUN curl -sLO https://github.com/validator/validator/releases/download/18.11.5/vnu.jar_18.11.5.zip \\\n && unzip -d vnu -j vnu.jar_18.11.5.zip \\\n && rm vnu.jar_18.11.5.zip\nRUN echo 'en_US.UTF-8 UTF-8' > /etc/locale.gen \\\n && locale-gen\nENV PGDATA=\"/home/musicbrainz/pgdata\"\nRUN pg_dropcluster --stop 10 main \\\n && pg_createcluster --datadir=\"$PGDATA\" --encoding=utf8 --locale=en_US.UTF-8 --user=postgres 10 main\nCOPY --chown=postgres:postgres docker/musicbrainz-tests/pg_hba.conf docker/musicbrainz-tests/postgresql.conf $PGDATA/\nRUN sudo -E -H -u postgres touch $PGDATA/pg_ident.conf\nCOPY docker/musicbrainz-tests/chrome.service /etc/service/chrome/run\nCOPY docker/musicbrainz-tests/postgresql.service /etc/service/postgresql/run\nCOPY docker/musicbrainz-tests/redis.service /etc/service/redis/run\nCOPY docker/scripts/start_template_renderer.sh /etc/service/template-renderer/run\nCOPY docker/musicbrainz-tests/vnu.service /etc/service/vnu/run\nCOPY docker/musicbrainz-tests/website.service /etc/service/website/run\nRUN chmod 755 /etc/service/chrome/run /etc/service/postgresql/run /etc/service/redis/run /etc/service/template-renderer/run /etc/service/vnu/run /etc/service/website/run\nRUN touch /etc/service/chrome/down /etc/service/postgresql/down /etc/service/redis/down /etc/service/template-renderer/down /etc/service/vnu/down /etc/service/website/down\nLABEL com.circleci.preserve-entrypoint=\"true\"\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM phusion/baseimage:0.11\nRUN useradd --create-home --shell /bin/bash musicbrainz\nWORKDIR /home/musicbrainz\nCOPY docker/yarn_pubkey.txt .\nRUN apt-get update \\\n && apt-get install --no-install-recommends ca-certificates curl gnupg --no-install-suggests -y \\\n && apt-key add yarn_pubkey.txt \\\n && rm yarn_pubkey.txt \\\n && apt-key adv --keyserver keyserver.ubuntu.com --refresh-keys 'Yarn' \\\n && echo \"deb https://dl.yarnpkg.com/debian/ stable main\" | tee /etc/apt/sources.list.d/yarn.list \\\n && curl -sLO https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb \\\n && curl -sLO https://deb.nodesource.com/node_10.x/pool/main/n/nodejs/nodejs_10.10.0-1nodesource1_amd64.deb \\\n && apt-get update \\\n && apt-get install --no-install-recommends ./google-chrome-stable_current_amd64.deb ./nodejs_10.10.0-1nodesource1_amd64.deb build-essential bzip2 default-jre gcc gettext git language-pack-de language-pack-el language-pack-es language-pack-et language-pack-fi language-pack-fr language-pack-it language-pack-ja language-pack-nl libc6-dev libdb-dev libdb5.3 libexpat1 libexpat1-dev libicu-dev libicu60 libperl-dev libpq-dev libpq5 libssl-dev libssl1.0.0 libxml2 libxml2-dev locales make openssh-client perl postgresql postgresql-10-pgtap postgresql-contrib postgresql-server-dev-10 python-minimal redis-server runit runit-systemd sudo unzip yarn --no-install-suggests -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && rm google-chrome-stable_current_amd64.deb \\\n && rm nodejs_10.10.0-1nodesource1_amd64.deb\nRUN wget -q -O - https://cpanmin.us | perl - App::cpanminus \\\n && cpanm Carton JSON::XS\nRUN curl -sLO https://chromedriver.storage.googleapis.com/74.0.3729.6/chromedriver_linux64.zip \\\n && unzip chromedriver_linux64.zip -d /usr/local/bin \\\n && chmod +x /usr/local/bin/chromedriver \\\n && rm chromedriver_linux64.zip\nRUN curl -sLO https://github.com/validator/validator/releases/download/18.11.5/vnu.jar_18.11.5.zip \\\n && unzip -d vnu -j vnu.jar_18.11.5.zip \\\n && rm vnu.jar_18.11.5.zip\nRUN echo 'en_US.UTF-8 UTF-8' > /etc/locale.gen \\\n && locale-gen\nENV PGDATA=\"/home/musicbrainz/pgdata\"\nRUN pg_dropcluster --stop 10 main \\\n && pg_createcluster --datadir=\"$PGDATA\" --encoding=utf8 --locale=en_US.UTF-8 --user=postgres 10 main\nCOPY --chown=postgres:postgres docker/musicbrainz-tests/pg_hba.conf docker/musicbrainz-tests/postgresql.conf $PGDATA/\nRUN sudo -E -H -u postgres touch $PGDATA/pg_ident.conf\nCOPY docker/musicbrainz-tests/chrome.service /etc/service/chrome/run\nCOPY docker/musicbrainz-tests/postgresql.service /etc/service/postgresql/run\nCOPY docker/musicbrainz-tests/redis.service /etc/service/redis/run\nCOPY docker/scripts/start_template_renderer.sh /etc/service/template-renderer/run\nCOPY docker/musicbrainz-tests/vnu.service /etc/service/vnu/run\nCOPY docker/musicbrainz-tests/website.service /etc/service/website/run\nRUN chmod 755 /etc/service/chrome/run /etc/service/postgresql/run /etc/service/redis/run /etc/service/template-renderer/run /etc/service/vnu/run /etc/service/website/run\nRUN touch /etc/service/chrome/down /etc/service/postgresql/down /etc/service/redis/down /etc/service/template-renderer/down /etc/service/vnu/down /etc/service/website/down\nLABEL com.circleci.preserve-entrypoint=\"true\"\n","injectedSmells":[],"originalDockerfileHash":"4401c0d0e59d14024ddaed872e8266b9","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM phusion/baseimage:0.11\nRUN useradd --create-home --shell /bin/bash musicbrainz\nWORKDIR /home/musicbrainz\nCOPY docker/yarn_pubkey.txt .\nRUN apt-get update \\\n && apt-get install --no-install-recommends ca-certificates curl gnupg --no-install-suggests -y \\\n && apt-key add yarn_pubkey.txt \\\n && rm yarn_pubkey.txt \\\n && apt-key adv --keyserver keyserver.ubuntu.com --refresh-keys 'Yarn' \\\n && echo \"deb https://dl.yarnpkg.com/debian/ stable main\" | tee /etc/apt/sources.list.d/yarn.list \\\n && curl -sLO https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb \\\n && curl -sLO https://deb.nodesource.com/node_10.x/pool/main/n/nodejs/nodejs_10.10.0-1nodesource1_amd64.deb \\\n && apt-get update \\\n && apt-get install --no-install-recommends ./google-chrome-stable_current_amd64.deb ./nodejs_10.10.0-1nodesource1_amd64.deb build-essential bzip2 default-jre gcc gettext git language-pack-de language-pack-el language-pack-es language-pack-et language-pack-fi language-pack-fr language-pack-it language-pack-ja language-pack-nl libc6-dev libdb-dev libdb5.3 libexpat1 libexpat1-dev libicu-dev libicu60 libperl-dev libpq-dev libpq5 libssl-dev libssl1.0.0 libxml2 libxml2-dev locales make openssh-client perl postgresql postgresql-10-pgtap postgresql-contrib postgresql-server-dev-10 python-minimal redis-server runit runit-systemd sudo unzip yarn --no-install-suggests -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && rm google-chrome-stable_current_amd64.deb \\\n && rm nodejs_10.10.0-1nodesource1_amd64.deb\nRUN wget -q -O - https://cpanmin.us | perl - App::cpanminus \\\n && cpanm Carton JSON::XS\nRUN curl -sLO https://chromedriver.storage.googleapis.com/74.0.3729.6/chromedriver_linux64.zip \\\n && unzip chromedriver_linux64.zip -d /usr/local/bin \\\n && chmod +x /usr/local/bin/chromedriver \\\n && rm chromedriver_linux64.zip\nRUN curl -sLO https://github.com/validator/validator/releases/download/18.11.5/vnu.jar_18.11.5.zip \\\n && unzip -d vnu -j vnu.jar_18.11.5.zip \\\n && rm vnu.jar_18.11.5.zip\nRUN echo 'en_US.UTF-8 UTF-8' > /etc/locale.gen \\\n && locale-gen\nENV PGDATA=\"/home/musicbrainz/pgdata\"\nRUN pg_dropcluster --stop 10 main \\\n && pg_createcluster --datadir=\"$PGDATA\" --encoding=utf8 --locale=en_US.UTF-8 --user=postgres 10 main\nCOPY --chown=postgres:postgres docker/musicbrainz-tests/pg_hba.conf docker/musicbrainz-tests/postgresql.conf $PGDATA/\nRUN sudo -E -H -u postgres touch $PGDATA/pg_ident.conf\nCOPY docker/musicbrainz-tests/chrome.service /etc/service/chrome/run\nCOPY docker/musicbrainz-tests/postgresql.service /etc/service/postgresql/run\nCOPY docker/musicbrainz-tests/redis.service /etc/service/redis/run\nCOPY docker/scripts/start_template_renderer.sh /etc/service/template-renderer/run\nCOPY docker/musicbrainz-tests/vnu.service /etc/service/vnu/run\nCOPY docker/musicbrainz-tests/website.service /etc/service/website/run\nRUN chmod 755 /etc/service/chrome/run /etc/service/postgresql/run /etc/service/redis/run /etc/service/template-renderer/run /etc/service/vnu/run /etc/service/website/run\nRUN touch /etc/service/chrome/down /etc/service/postgresql/down /etc/service/redis/down /etc/service/template-renderer/down /etc/service/vnu/down /etc/service/website/down\nLABEL com.circleci.preserve-entrypoint=\"true\"\n","originalDockerfileUglifiedHash":"4401c0d0e59d14024ddaed872e8266b9","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/cf2a52f38e3824eefb41301946477ec899198299.dockerfile"}