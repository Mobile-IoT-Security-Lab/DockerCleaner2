{"seed":3609727554,"processedDockerfileHash":"28516c904401af4db8ec00e39c805c74","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","have-a-healthcheck","have-a-user"],"processedDockerfile":"#   Licensed to the Apache Software Foundation (ASF) under one\n#   or more contributor license agreements.  See the NOTICE file\n#   distributed with this work for additional information\n#   regarding copyright ownership.  The ASF licenses this file\n#   to you under the Apache License, Version 2.0 (the\n#   \"License\"); you may not use this file except in compliance\n#   with the License.  You may obtain a copy of the License at\n#\n#     http://www.apache.org/licenses/LICENSE-2.0\n#\n#   Unless required by applicable law or agreed to in writing,\n#   software distributed under the License is distributed on an\n#   \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n#   KIND, either express or implied.  See the License for the\n#   specific language governing permissions and limitations\n#   under the License.\n#\n#   CloudStack-simulator build\nFROM ubuntu:16.04\nMAINTAINER \"Apache CloudStack\" <dev@cloudstack.apache.org>\nLABEL Vendor=\"Apache.org\" \\\n      License=\"ApacheV2\" \\\n      Version=\"4.12.0-SNAPSHOT\"\nRUN apt-get update -y \\\n && apt-get install --no-install-recommends genisoimage=9:1.1.11-3ubuntu1 libffi-dev=3.2.1-4 libssl-dev=1.0.2g-1ubuntu4.20 git=1:2.7.4-0ubuntu1.10 sudo=1.8.16-0ubuntu1.10 ipmitool=1.8.16-3ubuntu0.2 maven=3.3.9-3 openjdk-8-jdk=8u292-b10-0ubuntu1~16.04.1 python-dev=2.7.12-1~16.04 python-setuptools=20.7.0-1 python-pip=8.1.1-2ubuntu0.6 python-mysql.connector=2.0.4-1 supervisor=3.2.0-2ubuntu0.2 python-crypto=2.6.1-6ubuntu0.16.04.3 python-openssl=0.15.1-2ubuntu0.2 -y\nRUN echo 'mysql-server mysql-server/root_password password root' | debconf-set-selections ; echo 'mysql-server mysql-server/root_password_again password root' | debconf-set-selections\nRUN apt-get install --no-install-recommends mysql-server=5.7.33-0ubuntu0.16.04.1 -qqy \\\n && apt-get clean all \\\n && mkdir /var/run/mysqld ; chown mysql /var/run/mysqld\n#\n#   this package is needed if one wants to run marvin tests from\n#   inside the running simulator.\n#\nRUN pip install pyOpenSSL==23.1.1\nRUN echo '''sql_mode = \"STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION\"''' >> /etc/mysql/mysql.conf.d/mysqld.cnf\nRUN (/usr/bin/mysqld_safe &) ; sleep 5 ; mysqladmin -u root -proot password ''\nCOPY agent /root/agent\nCOPY api /root/api\nCOPY build /root/build\nCOPY client /root/client\nCOPY cloud-cli /root/cloud-cli\nCOPY cloudstack.iml /root/cloudstack.iml\nCOPY core /root/core\nCOPY debian /root/debian\nCOPY deps /root/deps\nCOPY developer /root/developer\nCOPY engine /root/engine\nCOPY framework /root/framework\nCOPY LICENSE.header /root/LICENSE.header\nCOPY LICENSE /root/LICENSE\nCOPY maven-standard /root/maven-standard\nCOPY NOTICE /root/NOTICE\nCOPY packaging /root/packaging\nCOPY plugins /root/plugins\nCOPY pom.xml /root/pom.xml\nCOPY python /root/python\nCOPY quickcloud /root/quickcloud\nCOPY requirements.txt /root/requirements.txt\nCOPY scripts /root/scripts\nCOPY server /root/server\nCOPY services /root/services\nCOPY setup /root/setup\nCOPY systemvm /root/systemvm\nCOPY target /root/target\nCOPY test/bindirbak /root/test/bindirbak\nCOPY test/conf /root/test/conf\nCOPY test/metadata /root/test/metadata\nCOPY test/pom.xml /root/test/pom.xml\nCOPY test/scripts /root/test/scripts\nCOPY test/selenium /root/test/selenium\nCOPY test/systemvm /root/test/systemvm\nCOPY test/target /root/test/target\nCOPY tools/pom.xml /root/tools/pom.xml\nCOPY tools/apidoc /root/tools/apidoc\nCOPY tools/checkstyle /root/tools/checkstyle\nCOPY tools/devcloud4/pom.xml /root/tools/devcloud4/pom.xml\nCOPY tools/devcloud-kvm/pom.xml /root/tools/devcloud-kvm/pom.xml\nCOPY tools/marvin/pom.xml /root/tools/marvin/pom.xml\nCOPY tools/pom.xml /root/tools/pom.xml\nCOPY ui /root/ui\nCOPY usage /root/usage\nCOPY utils /root/utils\nCOPY vmware-base /root/vmware-base\nRUN cd /root \\\n && mvn -Pdeveloper -Dsimulator -DskipTests -pl \"!:cloud-marvin\" install\nRUN (/usr/bin/mysqld_safe &) \\\n && sleep 5 \\\n && cd /root \\\n && mvn -Pdeveloper -pl developer -Ddeploydb \\\n && mvn -Pdeveloper -pl developer -Ddeploydb-simulator\nCOPY tools/marvin /root/tools/marvin\nCOPY tools/docker/supervisord.conf /etc/supervisor/conf.d/supervisord.conf\nCOPY tools/docker/docker_run_tests.sh /root\nRUN cd /root \\\n && mvn -Pdeveloper -Dsimulator -DskipTests -pl \":cloud-marvin\"\nRUN MARVIN_FILE=`find /root/tools/marvin/dist/ -name \"Marvin*.tar.gz\" ` \\\n && pip install $MARVIN_FILE\nCOPY test/integration /root/test/integration\nCOPY tools /root/tools\nRUN pip install pyOpenSSL==23.1.1 --upgrade\nEXPOSE 8080/tcp 8096/tcp\nWORKDIR /root\nCMD [\"/usr/bin/supervisord\"]\n#   --------------------------------\n#\n#   docker run -v ~/dev/tmp:/tmp -v ~/IdeaProjects/cloudstack/test/integration/smoke:/root/test/integration/smoke -it\n#   --name simulator -p 8080:8080 -p8096:8096 simulator:4.12\n#\n#   docker exec -it simulator bash\n#\n#   cat /root/docker_run_tests.sh\n#   for instructions\n#\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  Licensed to the Apache Software Foundation (ASF) under one\n#  or more contributor license agreements.  See the NOTICE file\n#  distributed with this work for additional information\n#  regarding copyright ownership.  The ASF licenses this file\n#  to you under the Apache License, Version 2.0 (the\n#  \"License\"); you may not use this file except in compliance\n#  with the License.  You may obtain a copy of the License at\n#\n#    http://www.apache.org/licenses/LICENSE-2.0\n#\n#  Unless required by applicable law or agreed to in writing,\n#  software distributed under the License is distributed on an\n#  \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n#  KIND, either express or implied.  See the License for the\n#  specific language governing permissions and limitations\n#  under the License.\n#\n#  CloudStack-simulator build\nFROM ubuntu:16.04\nMAINTAINER \"Apache CloudStack\" <dev@cloudstack.apache.org>\nLABEL Vendor=\"Apache.org\" \\\n      License=\"ApacheV2\" \\\n      Version=\"4.12.0-SNAPSHOT\"\nRUN apt-get update -y \\\n && apt-get install genisoimage libffi-dev libssl-dev git sudo ipmitool maven openjdk-8-jdk python-dev python-setuptools python-pip python-mysql.connector supervisor python-crypto python-openssl -y\nRUN echo 'mysql-server mysql-server/root_password password root' | debconf-set-selections ; echo 'mysql-server mysql-server/root_password_again password root' | debconf-set-selections\nRUN apt-get install mysql-server -qqy \\\n && apt-get clean all \\\n && mkdir /var/run/mysqld ; chown mysql /var/run/mysqld\n#\n#  this package is needed if one wants to run marvin tests from\n#  inside the running simulator.\n#\nRUN pip install pyOpenSSL\nRUN echo '''sql_mode = \"STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION\"''' >> /etc/mysql/mysql.conf.d/mysqld.cnf\nRUN (/usr/bin/mysqld_safe &) ; sleep 5 ; mysqladmin -u root -proot password ''\nCOPY agent /root/agent\nCOPY api /root/api\nCOPY build /root/build\nCOPY client /root/client\nCOPY cloud-cli /root/cloud-cli\nCOPY cloudstack.iml /root/cloudstack.iml\nCOPY core /root/core\nCOPY debian /root/debian\nCOPY deps /root/deps\nCOPY developer /root/developer\nCOPY engine /root/engine\nCOPY framework /root/framework\nCOPY LICENSE.header /root/LICENSE.header\nCOPY LICENSE /root/LICENSE\nCOPY maven-standard /root/maven-standard\nCOPY NOTICE /root/NOTICE\nCOPY packaging /root/packaging\nCOPY plugins /root/plugins\nCOPY pom.xml /root/pom.xml\nCOPY python /root/python\nCOPY quickcloud /root/quickcloud\nCOPY requirements.txt /root/requirements.txt\nCOPY scripts /root/scripts\nCOPY server /root/server\nCOPY services /root/services\nCOPY setup /root/setup\nCOPY systemvm /root/systemvm\nCOPY target /root/target\nCOPY test/bindirbak /root/test/bindirbak\nCOPY test/conf /root/test/conf\nCOPY test/metadata /root/test/metadata\nCOPY test/pom.xml /root/test/pom.xml\nCOPY test/scripts /root/test/scripts\nCOPY test/selenium /root/test/selenium\nCOPY test/systemvm /root/test/systemvm\nCOPY test/target /root/test/target\nCOPY tools/pom.xml /root/tools/pom.xml\nCOPY tools/apidoc /root/tools/apidoc\nCOPY tools/checkstyle /root/tools/checkstyle\nCOPY tools/devcloud4/pom.xml /root/tools/devcloud4/pom.xml\nCOPY tools/devcloud-kvm/pom.xml /root/tools/devcloud-kvm/pom.xml\nCOPY tools/marvin/pom.xml /root/tools/marvin/pom.xml\nCOPY tools/pom.xml /root/tools/pom.xml\nCOPY ui /root/ui\nCOPY usage /root/usage\nCOPY utils /root/utils\nCOPY vmware-base /root/vmware-base\nRUN cd /root \\\n && mvn -Pdeveloper -Dsimulator -DskipTests -pl \"!:cloud-marvin\" install\nRUN (/usr/bin/mysqld_safe &) \\\n && sleep 5 \\\n && cd /root \\\n && mvn -Pdeveloper -pl developer -Ddeploydb \\\n && mvn -Pdeveloper -pl developer -Ddeploydb-simulator\nCOPY tools/marvin /root/tools/marvin\nCOPY tools/docker/supervisord.conf /etc/supervisor/conf.d/supervisord.conf\nCOPY tools/docker/docker_run_tests.sh /root\nRUN cd /root \\\n && mvn -Pdeveloper -Dsimulator -DskipTests -pl \":cloud-marvin\"\nRUN MARVIN_FILE=`find /root/tools/marvin/dist/ -name \"Marvin*.tar.gz\" ` \\\n && pip install $MARVIN_FILE\nCOPY test/integration /root/test/integration\nCOPY tools /root/tools\nRUN pip install pyOpenSSL --upgrade\nEXPOSE 8080/tcp 8096/tcp\nWORKDIR /root\nCMD [\"/usr/bin/supervisord\"]\n#  --------------------------------\n#\n#  docker run -v ~/dev/tmp:/tmp -v ~/IdeaProjects/cloudstack/test/integration/smoke:/root/test/integration/smoke -it\n#  --name simulator -p 8080:8080 -p8096:8096 simulator:4.12\n#\n#  docker exec -it simulator bash\n#\n#  cat /root/docker_run_tests.sh\n#  for instructions\n#\n","injectedSmells":[],"originalDockerfileHash":"b0cad2f2e9ca69bd79eac587d7281242","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   Licensed to the Apache Software Foundation (ASF) under one\n#   or more contributor license agreements.  See the NOTICE file\n#   distributed with this work for additional information\n#   regarding copyright ownership.  The ASF licenses this file\n#   to you under the Apache License, Version 2.0 (the\n#   \"License\"); you may not use this file except in compliance\n#   with the License.  You may obtain a copy of the License at\n#\n#     http://www.apache.org/licenses/LICENSE-2.0\n#\n#   Unless required by applicable law or agreed to in writing,\n#   software distributed under the License is distributed on an\n#   \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n#   KIND, either express or implied.  See the License for the\n#   specific language governing permissions and limitations\n#   under the License.\n#\n#   CloudStack-simulator build\nFROM ubuntu:16.04\nMAINTAINER \"Apache CloudStack\" <dev@cloudstack.apache.org>\nLABEL Vendor=\"Apache.org\" \\\n      License=\"ApacheV2\" \\\n      Version=\"4.12.0-SNAPSHOT\"\nRUN apt-get update -y \\\n && apt-get install genisoimage libffi-dev libssl-dev git sudo ipmitool maven openjdk-8-jdk python-dev python-setuptools python-pip python-mysql.connector supervisor python-crypto python-openssl -y\nRUN echo 'mysql-server mysql-server/root_password password root' | debconf-set-selections ; echo 'mysql-server mysql-server/root_password_again password root' | debconf-set-selections\nRUN apt-get install mysql-server -qqy \\\n && apt-get clean all \\\n && mkdir /var/run/mysqld ; chown mysql /var/run/mysqld\n#\n#   this package is needed if one wants to run marvin tests from\n#   inside the running simulator.\n#\nRUN pip install pyOpenSSL\nRUN echo '''sql_mode = \"STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION\"''' >> /etc/mysql/mysql.conf.d/mysqld.cnf\nRUN (/usr/bin/mysqld_safe &) ; sleep 5 ; mysqladmin -u root -proot password ''\nCOPY agent /root/agent\nCOPY api /root/api\nCOPY build /root/build\nCOPY client /root/client\nCOPY cloud-cli /root/cloud-cli\nCOPY cloudstack.iml /root/cloudstack.iml\nCOPY core /root/core\nCOPY debian /root/debian\nCOPY deps /root/deps\nCOPY developer /root/developer\nCOPY engine /root/engine\nCOPY framework /root/framework\nCOPY LICENSE.header /root/LICENSE.header\nCOPY LICENSE /root/LICENSE\nCOPY maven-standard /root/maven-standard\nCOPY NOTICE /root/NOTICE\nCOPY packaging /root/packaging\nCOPY plugins /root/plugins\nCOPY pom.xml /root/pom.xml\nCOPY python /root/python\nCOPY quickcloud /root/quickcloud\nCOPY requirements.txt /root/requirements.txt\nCOPY scripts /root/scripts\nCOPY server /root/server\nCOPY services /root/services\nCOPY setup /root/setup\nCOPY systemvm /root/systemvm\nCOPY target /root/target\nCOPY test/bindirbak /root/test/bindirbak\nCOPY test/conf /root/test/conf\nCOPY test/metadata /root/test/metadata\nCOPY test/pom.xml /root/test/pom.xml\nCOPY test/scripts /root/test/scripts\nCOPY test/selenium /root/test/selenium\nCOPY test/systemvm /root/test/systemvm\nCOPY test/target /root/test/target\nCOPY tools/pom.xml /root/tools/pom.xml\nCOPY tools/apidoc /root/tools/apidoc\nCOPY tools/checkstyle /root/tools/checkstyle\nCOPY tools/devcloud4/pom.xml /root/tools/devcloud4/pom.xml\nCOPY tools/devcloud-kvm/pom.xml /root/tools/devcloud-kvm/pom.xml\nCOPY tools/marvin/pom.xml /root/tools/marvin/pom.xml\nCOPY tools/pom.xml /root/tools/pom.xml\nCOPY ui /root/ui\nCOPY usage /root/usage\nCOPY utils /root/utils\nCOPY vmware-base /root/vmware-base\nRUN cd /root \\\n && mvn -Pdeveloper -Dsimulator -DskipTests -pl \"!:cloud-marvin\" install\nRUN (/usr/bin/mysqld_safe &) \\\n && sleep 5 \\\n && cd /root \\\n && mvn -Pdeveloper -pl developer -Ddeploydb \\\n && mvn -Pdeveloper -pl developer -Ddeploydb-simulator\nCOPY tools/marvin /root/tools/marvin\nCOPY tools/docker/supervisord.conf /etc/supervisor/conf.d/supervisord.conf\nCOPY tools/docker/docker_run_tests.sh /root\nRUN cd /root \\\n && mvn -Pdeveloper -Dsimulator -DskipTests -pl \":cloud-marvin\"\nRUN MARVIN_FILE=`find /root/tools/marvin/dist/ -name \"Marvin*.tar.gz\" ` \\\n && pip install $MARVIN_FILE\nCOPY test/integration /root/test/integration\nCOPY tools /root/tools\nRUN pip install pyOpenSSL --upgrade\nEXPOSE 8080/tcp 8096/tcp\nWORKDIR /root\nCMD [\"/usr/bin/supervisord\"]\n#   --------------------------------\n#\n#   docker run -v ~/dev/tmp:/tmp -v ~/IdeaProjects/cloudstack/test/integration/smoke:/root/test/integration/smoke -it\n#   --name simulator -p 8080:8080 -p8096:8096 simulator:4.12\n#\n#   docker exec -it simulator bash\n#\n#   cat /root/docker_run_tests.sh\n#   for instructions\n#\n","originalDockerfileUglifiedHash":"c04912454831a33e8c7f4c9bf3030be8","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/2faf44b8015a7c8a53ffdaff5637ab31af9c64fe.dockerfile"}