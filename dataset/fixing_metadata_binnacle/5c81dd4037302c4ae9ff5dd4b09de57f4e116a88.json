{"seed":3296505826,"processedDockerfileHash":"ecb9ea2fb0f08d134551311989a9c416","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"#  ###\n#   Netflow collector and local processing container\n#   using NFSen and NFDump for processing. This can\n#   be run standalone or in conjunction with a analytics\n#   engine that will perform time based graphing and\n#   stats summarization.\n#  ##\nFROM debian:latest\nMAINTAINER Brent Salisbury <brent.salisbury@gmail.com\nRUN :\nRUN (apt-get update ;apt-get install --no-install-recommends gcc=4:12.2.0-3ubuntu1 flex=2.6.4-8.1 rrdtool=1.7.2-4ubuntu5 apache2=2.4.55-1ubuntu2 tcpdump=4.99.3-1ubuntu1 wget=1.21.3-1ubuntu1 php5 apache2=2.4.55-1ubuntu2 librrd-dev=1.7.2-4ubuntu5 libapache2-mod-php5 php5-common libio-socket-inet6-perl=2.73-1 libio-socket-ssl-perl=2.081-2 libmailtools-perl=2.21-2 librrds-perl=1.7.2-4ubuntu5 libwww-perl=6.67-1 libipc-run-perl=20220807.0-1 perl-base=5.36.0-7 libsys-syslog-perl supervisor=4.2.1-1ubuntu1 net-tools=2.10-0.1ubuntu3 -y )\n#   Cleanup apt-get cache\nRUN apt-get clean\n#   Apache\nEXPOSE 80/tcp\n#   NetFlow\nEXPOSE 2055/tcp\n#   IPFIX\nEXPOSE 4739/tcp\n#   sFlow\nEXPOSE 6343/tcp\n#   nfsen src ip src node mappings per example\nEXPOSE 9996/tcp\n#   mk some dirs\nRUN mkdir -p /var/lock/apache2 /var/run/apache2 /var/log/supervisor\n#   Example ENV variable injection if you want to add collector addresses\nENV NFSEN_VERSION=\"1.3.7\"\nENV NFDUMP_VERSION=\"1.6.13\"\n#   Install NFDump (note the random redirected DL server from sourceforge. Their redirects are awful\n#   so using the only 302 redirect that is the closest to almost working every time...\nRUN cd /usr/local/src \\\n && wget http://iweb.dl.sourceforge.net/project/nfdump/stable/nfdump-${NFDUMP_VERSION}/nfdump-${NFDUMP_VERSION}.tar.gz \\\n && tar xfz nfdump-${NFDUMP_VERSION}.tar.gz \\\n && cd nfdump-${NFDUMP_VERSION}/ \\\n && ./configure --enable-nfprofile --with-rrdpath=/usr/bin --enable-nftrack --enable-sflow \\\n && make \\\n && make install\n#   Configure php with the systems timezone, modifications are tagged with the word 'NFSEN_OPT' for future ref\n#   Recommended leaving the timezone as UTC as NFSen and NFCapd timestamps need to be in synch.\n#   Timing is also important for the agregates time series viewer for glabal visibility and analytics.\nRUN sed -i 's/^;date.timezone =/date.timezone \\= \\\"UTC\\\"/g' /etc/php5/apache2/php.ini\nRUN sed -i '/date.timezone = \"UTC\\\"/i ; NFSEN_OPT Adjust your timezone for nfsen' /etc/php5/apache2/php.ini\nRUN sed -i 's/^;date.timezone =/date.timezone \\= \\\"UTC\\\"/g' /etc/php5/cli/php.ini\nRUN sed -i '/date.timezone = \"UTC\\\"/i ; NFSEN_OPT Adjust your timezone for nfsen' /etc/php5/cli/php.ini\n#   Configure NFSen config files\nRUN mkdir -p /data/nfsen\nWORKDIR /data\nRUN wget http://iweb.dl.sourceforge.net/project/nfsen/stable/nfsen-${NFSEN_VERSION}/nfsen-${NFSEN_VERSION}.tar.gz\nRUN tar xfz nfsen-${NFSEN_VERSION}.tar.gz\nRUN sed -i 's/\"www\";/\"www-data\";/g' nfsen-${NFSEN_VERSION}/etc/nfsen-dist.conf\n#   Example how to fill in any flow source you want using | as a delimiter. Sort of long and gross though.\n#   Modify the pre-defined NetFlow v5/v9 line matching the regex 'upstream1'\nRUN sed -i \"s|'upstream1' => { 'port' => '9995', 'col' => '#0000ff', 'type' => 'netflow' },|'netflow-global' => { 'port' => '2055', 'col' => '#0000ff', 'type' => 'netflow' },|g\" nfsen-${NFSEN_VERSION}/etc/nfsen-dist.conf\n#   Bind port 6343 and an entry for  sFlow collection\nRUN sed -i \"/%sources/a \\ 'sflow-global' => { 'port' => '6343', 'col' => '#0000ff', 'type' => 'sflow' },\" nfsen-${NFSEN_VERSION}/etc/nfsen-dist.conf\n#   Bind port 4739 and an entry for IPFIX collection. E.g. NetFlow v10\nRUN sed -i \"/%sources/a \\ 'ipfix-global' => { 'port' => '4739', 'col' => '#0000ff', 'type' => 'netflow' },\" nfsen-${NFSEN_VERSION}/etc/nfsen-dist.conf\n#   Add an account for NFSen as a member of the apache group\nRUN useradd -d /var/netflow -G www-data -m -s /bin/false netflow\n#   Run the nfsen installer\nWORKDIR /data/nfsen-${NFSEN_VERSION}\nRUN perl ./install.pl etc/nfsen-dist.conf || true\nRUN sleep 3\nWORKDIR /\n#   Add startup script for nfsen profile init\nCOPY ./start.sh /data/start.sh\n#   flow-generator binary for testing\nCOPY ./flow-generator /data/flow-generator\nCOPY ./supervisord.conf /etc/supervisord.conf\nCMD bash -C '/data/start.sh' ; '/usr/bin/supervisord'\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"# ###\n#  Netflow collector and local processing container\n#  using NFSen and NFDump for processing. This can\n#  be run standalone or in conjunction with a analytics\n#  engine that will perform time based graphing and\n#  stats summarization.\n# ##\nFROM debian:latest\nMAINTAINER Brent Salisbury <brent.salisbury@gmail.com\nRUN apt-get update\nRUN apt-get install gcc flex rrdtool apache2 tcpdump wget php5 apache2 librrd-dev libapache2-mod-php5 php5-common libio-socket-inet6-perl libio-socket-ssl-perl libmailtools-perl librrds-perl libwww-perl libipc-run-perl perl-base libsys-syslog-perl supervisor net-tools -y\n#  Cleanup apt-get cache\nRUN apt-get clean\n#  Apache\nEXPOSE 80/tcp\n#  NetFlow\nEXPOSE 2055/tcp\n#  IPFIX\nEXPOSE 4739/tcp\n#  sFlow\nEXPOSE 6343/tcp\n#  nfsen src ip src node mappings per example\nEXPOSE 9996/tcp\n#  mk some dirs\nRUN mkdir -p /var/lock/apache2 /var/run/apache2 /var/log/supervisor\n#  Example ENV variable injection if you want to add collector addresses\nENV NFSEN_VERSION=\"1.3.7\"\nENV NFDUMP_VERSION=\"1.6.13\"\n#  Install NFDump (note the random redirected DL server from sourceforge. Their redirects are awful\n#  so using the only 302 redirect that is the closest to almost working every time...\nRUN cd /usr/local/src \\\n && wget http://iweb.dl.sourceforge.net/project/nfdump/stable/nfdump-${NFDUMP_VERSION}/nfdump-${NFDUMP_VERSION}.tar.gz \\\n && tar xfz nfdump-${NFDUMP_VERSION}.tar.gz \\\n && cd nfdump-${NFDUMP_VERSION}/ \\\n && ./configure --enable-nfprofile --with-rrdpath=/usr/bin --enable-nftrack --enable-sflow \\\n && make \\\n && make install\n#  Configure php with the systems timezone, modifications are tagged with the word 'NFSEN_OPT' for future ref\n#  Recommended leaving the timezone as UTC as NFSen and NFCapd timestamps need to be in synch.\n#  Timing is also important for the agregates time series viewer for glabal visibility and analytics.\nRUN sed -i 's/^;date.timezone =/date.timezone \\= \\\"UTC\\\"/g' /etc/php5/apache2/php.ini\nRUN sed -i '/date.timezone = \"UTC\\\"/i ; NFSEN_OPT Adjust your timezone for nfsen' /etc/php5/apache2/php.ini\nRUN sed -i 's/^;date.timezone =/date.timezone \\= \\\"UTC\\\"/g' /etc/php5/cli/php.ini\nRUN sed -i '/date.timezone = \"UTC\\\"/i ; NFSEN_OPT Adjust your timezone for nfsen' /etc/php5/cli/php.ini\n#  Configure NFSen config files\nRUN mkdir -p /data/nfsen\nWORKDIR /data\nRUN wget http://iweb.dl.sourceforge.net/project/nfsen/stable/nfsen-${NFSEN_VERSION}/nfsen-${NFSEN_VERSION}.tar.gz\nRUN tar xfz nfsen-${NFSEN_VERSION}.tar.gz\nRUN sed -i 's/\"www\";/\"www-data\";/g' nfsen-${NFSEN_VERSION}/etc/nfsen-dist.conf\n#  Example how to fill in any flow source you want using | as a delimiter. Sort of long and gross though.\n#  Modify the pre-defined NetFlow v5/v9 line matching the regex 'upstream1'\nRUN sed -i \"s|'upstream1' => { 'port' => '9995', 'col' => '#0000ff', 'type' => 'netflow' },|'netflow-global' => { 'port' => '2055', 'col' => '#0000ff', 'type' => 'netflow' },|g\" nfsen-${NFSEN_VERSION}/etc/nfsen-dist.conf\n#  Bind port 6343 and an entry for  sFlow collection\nRUN sed -i \"/%sources/a \\ 'sflow-global' => { 'port' => '6343', 'col' => '#0000ff', 'type' => 'sflow' },\" nfsen-${NFSEN_VERSION}/etc/nfsen-dist.conf\n#  Bind port 4739 and an entry for IPFIX collection. E.g. NetFlow v10\nRUN sed -i \"/%sources/a \\ 'ipfix-global' => { 'port' => '4739', 'col' => '#0000ff', 'type' => 'netflow' },\" nfsen-${NFSEN_VERSION}/etc/nfsen-dist.conf\n#  Add an account for NFSen as a member of the apache group\nRUN useradd -d /var/netflow -G www-data -m -s /bin/false netflow\n#  Run the nfsen installer\nWORKDIR /data/nfsen-${NFSEN_VERSION}\nRUN perl ./install.pl etc/nfsen-dist.conf || true\nRUN sleep 3\nWORKDIR /\n#  Add startup script for nfsen profile init\nADD ./start.sh /data/start.sh\n#  flow-generator binary for testing\nADD ./flow-generator /data/flow-generator\nADD ./supervisord.conf /etc/supervisord.conf\nCMD bash -C '/data/start.sh' ; '/usr/bin/supervisord'\n","injectedSmells":[],"originalDockerfileHash":"c68fbab1da079860d1c4f2a7c47cafe2","successfullyInjectedSmells":[],"originalDockerfileUglified":"#  ###\n#   Netflow collector and local processing container\n#   using NFSen and NFDump for processing. This can\n#   be run standalone or in conjunction with a analytics\n#   engine that will perform time based graphing and\n#   stats summarization.\n#  ##\nFROM debian:latest\nMAINTAINER Brent Salisbury <brent.salisbury@gmail.com\nRUN apt-get update\nRUN apt-get install gcc flex rrdtool apache2 tcpdump wget php5 apache2 librrd-dev libapache2-mod-php5 php5-common libio-socket-inet6-perl libio-socket-ssl-perl libmailtools-perl librrds-perl libwww-perl libipc-run-perl perl-base libsys-syslog-perl supervisor net-tools -y\n#   Cleanup apt-get cache\nRUN apt-get clean\n#   Apache\nEXPOSE 80/tcp\n#   NetFlow\nEXPOSE 2055/tcp\n#   IPFIX\nEXPOSE 4739/tcp\n#   sFlow\nEXPOSE 6343/tcp\n#   nfsen src ip src node mappings per example\nEXPOSE 9996/tcp\n#   mk some dirs\nRUN mkdir -p /var/lock/apache2 /var/run/apache2 /var/log/supervisor\n#   Example ENV variable injection if you want to add collector addresses\nENV NFSEN_VERSION=\"1.3.7\"\nENV NFDUMP_VERSION=\"1.6.13\"\n#   Install NFDump (note the random redirected DL server from sourceforge. Their redirects are awful\n#   so using the only 302 redirect that is the closest to almost working every time...\nRUN cd /usr/local/src \\\n && wget http://iweb.dl.sourceforge.net/project/nfdump/stable/nfdump-${NFDUMP_VERSION}/nfdump-${NFDUMP_VERSION}.tar.gz \\\n && tar xfz nfdump-${NFDUMP_VERSION}.tar.gz \\\n && cd nfdump-${NFDUMP_VERSION}/ \\\n && ./configure --enable-nfprofile --with-rrdpath=/usr/bin --enable-nftrack --enable-sflow \\\n && make \\\n && make install\n#   Configure php with the systems timezone, modifications are tagged with the word 'NFSEN_OPT' for future ref\n#   Recommended leaving the timezone as UTC as NFSen and NFCapd timestamps need to be in synch.\n#   Timing is also important for the agregates time series viewer for glabal visibility and analytics.\nRUN sed -i 's/^;date.timezone =/date.timezone \\= \\\"UTC\\\"/g' /etc/php5/apache2/php.ini\nRUN sed -i '/date.timezone = \"UTC\\\"/i ; NFSEN_OPT Adjust your timezone for nfsen' /etc/php5/apache2/php.ini\nRUN sed -i 's/^;date.timezone =/date.timezone \\= \\\"UTC\\\"/g' /etc/php5/cli/php.ini\nRUN sed -i '/date.timezone = \"UTC\\\"/i ; NFSEN_OPT Adjust your timezone for nfsen' /etc/php5/cli/php.ini\n#   Configure NFSen config files\nRUN mkdir -p /data/nfsen\nWORKDIR /data\nRUN wget http://iweb.dl.sourceforge.net/project/nfsen/stable/nfsen-${NFSEN_VERSION}/nfsen-${NFSEN_VERSION}.tar.gz\nRUN tar xfz nfsen-${NFSEN_VERSION}.tar.gz\nRUN sed -i 's/\"www\";/\"www-data\";/g' nfsen-${NFSEN_VERSION}/etc/nfsen-dist.conf\n#   Example how to fill in any flow source you want using | as a delimiter. Sort of long and gross though.\n#   Modify the pre-defined NetFlow v5/v9 line matching the regex 'upstream1'\nRUN sed -i \"s|'upstream1' => { 'port' => '9995', 'col' => '#0000ff', 'type' => 'netflow' },|'netflow-global' => { 'port' => '2055', 'col' => '#0000ff', 'type' => 'netflow' },|g\" nfsen-${NFSEN_VERSION}/etc/nfsen-dist.conf\n#   Bind port 6343 and an entry for  sFlow collection\nRUN sed -i \"/%sources/a \\ 'sflow-global' => { 'port' => '6343', 'col' => '#0000ff', 'type' => 'sflow' },\" nfsen-${NFSEN_VERSION}/etc/nfsen-dist.conf\n#   Bind port 4739 and an entry for IPFIX collection. E.g. NetFlow v10\nRUN sed -i \"/%sources/a \\ 'ipfix-global' => { 'port' => '4739', 'col' => '#0000ff', 'type' => 'netflow' },\" nfsen-${NFSEN_VERSION}/etc/nfsen-dist.conf\n#   Add an account for NFSen as a member of the apache group\nRUN useradd -d /var/netflow -G www-data -m -s /bin/false netflow\n#   Run the nfsen installer\nWORKDIR /data/nfsen-${NFSEN_VERSION}\nRUN perl ./install.pl etc/nfsen-dist.conf || true\nRUN sleep 3\nWORKDIR /\n#   Add startup script for nfsen profile init\nADD ./start.sh /data/start.sh\n#   flow-generator binary for testing\nADD ./flow-generator /data/flow-generator\nADD ./supervisord.conf /etc/supervisord.conf\nCMD bash -C '/data/start.sh' ; '/usr/bin/supervisord'\n","originalDockerfileUglifiedHash":"44f520f8da60affda4a8aeecd270c095","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/5c81dd4037302c4ae9ff5dd4b09de57f4e116a88.dockerfile"}