{"seed":1076402201,"processedDockerfileHash":"d41c56f217ceaa7e35d4e36d43f36ab7","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","have-a-healthcheck","have-a-user"],"processedDockerfile":"#   cf. http://www.linuxfromscratch.org/lfs/view/7.9-systemd/\nFROM debian:8\nARG LFS_TEST=1\nARG PROC=1\nMAINTAINER Perceval BRET\nLABEL com.ac.src.architecture=\"x86_64\" \\\n      com.ac.src.distribution=\"lfs\" \\\n      com.ac.src.version=\"7.9\" \\\n      com.ac.src.init=\"systemd\"\nCMD [\"/bin/bash\"]\n#   install required packages\nRUN apt-get update -q \\\n && apt-get install --no-install-recommends build-essential bison gawk texinfo wget file -q -y \\\n && apt-get -q -y autoremove \\\n && rm -rf /var/lib/apt/lists/*\n#   set bash as default shell\nWORKDIR /bin\nRUN rm sh \\\n && ln -s bash sh\n#   create directories\nENV LFS=\"/mnt/lfs\"\nRUN mkdir -pv $LFS/{usr,sources} \\\n && chmod -v a+wt $LFS/sources\nWORKDIR $LFS/sources\n#   check environment\nCOPY version-check.sh library-check.sh $LFS/sources/\nRUN chmod -v 755 *.sh \\\n && sync \\\n && ./version-check.sh \\\n && ./library-check.sh\n#   create tools directory\nRUN mkdir -pv $LFS/tools \\\n && ln -sv $LFS/tools /\n#   create lfs user (with lfs as password)\nRUN groupadd lfs \\\n && useradd -s /bin/bash -g lfs -m -k /dev/null lfs \\\n && echo \"lfs:lfs\" | chpasswd\n#   set directories accesses\nRUN chown -v lfs $LFS/tools \\\n && chown -v lfs $LFS/sources\n#   set lfs user environment\nUSER lfs\nCOPY .bash_profile .bashrc /home/lfs/\n#   @hint must be defined as ENV to be accessible by RUN commands\nENV LC_ALL=\"POSIX\" \\\n    LFS_TGT=\"x86_64-lfs-linux-gnu\" \\\n    PATH=\"/tools/bin:/bin:/usr/bin\" \\\n    MAKEFLAGS=\"-j $PROC\"\n#  ##########################\n#   compile binutils (pass 1)\n#  ##########################\nCOPY binutils-2.26.tar.bz2 $LFS/sources/\nRUN tar -xf binutils-2.26.tar.bz2 -C /tmp/ \\\n && pushd /tmp/binutils-2.26 \\\n && mkdir -v build \\\n && cd build \\\n && ../configure --prefix=/tools --with-sysroot=$LFS --with-lib-path=/tools/lib --target=$LFS_TGT --disable-nls --disable-werror \\\n && make \\\n && mkdir -pv /tools/lib \\\n && ln -sv lib /tools/lib64 \\\n && make install \\\n && popd \\\n && rm -rf /tmp/binutils-*\n#  #####################\n#   compile gcc (pass 1)\n#  #####################\nCOPY gcc-5.3.0.tar.bz2 mpfr-3.1.3.tar.xz gmp-6.1.0.tar.xz mpc-1.0.3.tar.gz $LFS/sources/\nRUN tar -xf gcc-5.3.0.tar.bz2 -C /tmp/ \\\n && pushd /tmp/gcc-5.3.0 \\\n && tar -xf $LFS/sources/mpfr-3.1.3.tar.xz \\\n && mv -v mpfr-3.1.3 mpfr \\\n && tar -xf $LFS/sources/gmp-6.1.0.tar.xz \\\n && mv -v gmp-6.1.0 gmp \\\n && tar -xf $LFS/sources/mpc-1.0.3.tar.gz \\\n && mv -v mpc-1.0.3 mpc \\\n && for file in $( find gcc/config -name linux64.h -o -name linux.h -o -name sysv4.h ;); do cp -uv $file{,.orig} ;sed -e 's@/lib\\(64\\)\\?\\(32\\)\\?/ld@/tools&@g' -e 's@/usr@/tools@g' $file.orig > $file;echo -e \"\\n#undef STANDARD_STARTFILE_PREFIX_1 \\n#undef STANDARD_STARTFILE_PREFIX_2 \\n#define STANDARD_STARTFILE_PREFIX_1 \\\"/tools/lib/\\\" \\n#define STANDARD_STARTFILE_PREFIX_2 \\\"\\\"\" >> $file;touch $file.orig ; done \\\n && mkdir -v build \\\n && cd build \\\n && ../configure --target=$LFS_TGT --prefix=/tools --with-glibc-version=2.11 --with-sysroot=$LFS --with-newlib --without-headers --with-local-prefix=/tools --with-native-system-header-dir=/tools/include --disable-nls --disable-shared --disable-multilib --disable-decimal-float --disable-threads --disable-libatomic --disable-libgomp --disable-libquadmath --disable-libssp --disable-libvtv --disable-libstdcxx --enable-languages=c,c++ \\\n && make \\\n && make install \\\n && popd \\\n && rm -rf /tmp/gcc-*\n#  ##########################\n#   compile Linux API headers\n#  ##########################\nCOPY linux-4.4.2.tar.xz $LFS/sources/\nRUN tar -xf linux-4.4.2.tar.xz -C /tmp/ \\\n && pushd /tmp/linux-4.4.2 \\\n && make mrproper \\\n && make INSTALL_HDR_PATH=dest headers_install \\\n && cp -rv dest/include/* /tools/include \\\n && popd \\\n && rm -rf /tmp/linux-*\n#  ##############\n#   compile glibc\n#  ##############\nCOPY glibc-2.23.tar.xz $LFS/sources/\nRUN tar -xf glibc-2.23.tar.xz -C /tmp/ \\\n && pushd /tmp/glibc-2.23 \\\n && mkdir -v build \\\n && cd build \\\n && ../configure --prefix=/tools --host=$LFS_TGT --build=$( ../scripts/config.guess ;) --disable-profile --enable-kernel=2.6.32 --enable-obsolete-rpc --with-headers=/tools/include libc_cv_forced_unwind=yes libc_cv_ctors_header=yes libc_cv_c_cleanup=yes \\\n && make \\\n && make install \\\n && popd \\\n && rm -rf /tmp/glibc-*\n#   run tests\nRUN echo 'int main(){}' > dummy.c \\\n && $LFS_TGT-gcc dummy.c \\\n && readelf -l a.out | grep ': /tools' \\\n && rm -v dummy.c a.out\n#  ##################\n#   compile libstdc++\n#  ##################\nCOPY gcc-5.3.0.tar.bz2 $LFS/sources/\nRUN tar -xf gcc-5.3.0.tar.bz2 -C /tmp/ \\\n && pushd /tmp/gcc-5.3.0 \\\n && mkdir -v build \\\n && cd build \\\n && ../libstdc++-v3/configure --host=$LFS_TGT --prefix=/tools --disable-multilib --disable-nls --disable-libstdcxx-threads --disable-libstdcxx-pch --with-gxx-include-dir=/tools/$LFS_TGT/include/c++/5.3.0 \\\n && make \\\n && make install \\\n && popd \\\n && rm -rf /tmp/gcc-*\n#  ##########################\n#   compile binutils (pass 2)\n#  ##########################\nCOPY binutils-2.26.tar.bz2 $LFS/sources/\nRUN tar -xf binutils-2.26.tar.bz2 -C /tmp/ \\\n && pushd /tmp/binutils-2.26 \\\n && mkdir -v build \\\n && cd build \\\n && CC=$LFS_TGT-gcc AR=$LFS_TGT-ar RANLIB=$LFS_TGT-ranlib ../configure --prefix=/tools --disable-nls --disable-werror --with-lib-path=/tools/lib --with-sysroot \\\n && make \\\n && make install \\\n && make -C ld clean \\\n && make -C ld LIB_PATH=/usr/lib:/lib \\\n && cp -v ld/ld-new /tools/bin \\\n && popd \\\n && rm -rf /tmp/binutils-*\n#  #####################\n#   compile gcc (pass 2)\n#  #####################\nCOPY gcc-5.3.0.tar.bz2 mpfr-3.1.3.tar.xz gmp-6.1.0.tar.xz mpc-1.0.3.tar.gz $LFS/sources/\nRUN tar -xf gcc-5.3.0.tar.bz2 -C /tmp/ \\\n && pushd /tmp/gcc-5.3.0 \\\n && cat gcc/limitx.h gcc/glimits.h gcc/limity.h > `dirname $( $LFS_TGT-gcc -print-libgcc-file-name ;) `/include-fixed/limits.h \\\n && for file in $( find gcc/config -name linux64.h -o -name linux.h -o -name sysv4.h ;); do cp -uv $file{,.orig} ;sed -e 's@/lib\\(64\\)\\?\\(32\\)\\?/ld@/tools&@g' -e 's@/usr@/tools@g' $file.orig > $file;echo -e \"\\n#undef STANDARD_STARTFILE_PREFIX_1 \\n#undef STANDARD_STARTFILE_PREFIX_2 \\n#define STANDARD_STARTFILE_PREFIX_1 \\\"/tools/lib/\\\" \\n#define STANDARD_STARTFILE_PREFIX_2 \\\"\\\"\" >> $file;touch $file.orig ; done \\\n && tar -xf $LFS/sources/mpfr-3.1.3.tar.xz \\\n && mv -v mpfr-3.1.3 mpfr \\\n && tar -xf $LFS/sources/gmp-6.1.0.tar.xz \\\n && mv -v gmp-6.1.0 gmp \\\n && tar -xf $LFS/sources/mpc-1.0.3.tar.gz \\\n && mv -v mpc-1.0.3 mpc \\\n && mkdir -v build \\\n && cd build \\\n && CC=$LFS_TGT-gcc CXX=$LFS_TGT-g++ AR=$LFS_TGT-ar RANLIB=$LFS_TGT-ranlib ../configure --prefix=/tools --with-local-prefix=/tools --with-native-system-header-dir=/tools/include --enable-languages=c,c++ --disable-libstdcxx-pch --disable-multilib --disable-bootstrap --disable-libgomp \\\n && make \\\n && make install \\\n && ln -sv gcc /tools/bin/cc \\\n && popd \\\n && rm -rf /tmp/gcc-*\n#   run tests\nRUN echo 'int main(){}' > dummy.c \\\n && cc dummy.c \\\n && readelf -l a.out | grep ': /tools' \\\n && rm -v dummy.c a.out\n#  #################\n#   compile tcl-core\n#  #################\nCOPY tcl-core8.6.4-src.tar.gz $LFS/sources/\nRUN tar -xf tcl-core8.6.4-src.tar.gz -C /tmp/ \\\n && pushd /tmp/tcl8.6.4 \\\n && cd unix \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then TZ=UTC make test ; fi \\\n && make install \\\n && chmod -v u+w /tools/lib/libtcl8.6.so \\\n && make install-private-headers \\\n && ln -sv tclsh8.6 /tools/bin/tclsh \\\n && popd \\\n && rm -rf /tmp/tcl*\n#  ###############\n#   compile expect\n#  ###############\nCOPY expect5.45.tar.gz $LFS/sources/\nRUN tar -xf expect5.45.tar.gz -C /tmp/ \\\n && pushd /tmp/expect5.45 \\\n && cp -v configure{,.orig} \\\n && sed 's:/usr/local/bin:/bin:' configure.orig > configure \\\n && ./configure --prefix=/tools --with-tcl=/tools/lib --with-tclinclude=/tools/include \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make test ; fi \\\n && make SCRIPTS=\"\" install \\\n && popd \\\n && rm -rf /tmp/expect*\n#  ################\n#   compile dejaGNU\n#  ################\nCOPY dejagnu-1.5.3.tar.gz $LFS/sources/\nRUN tar -xf dejagnu-1.5.3.tar.gz -C /tmp/ \\\n && pushd /tmp/dejagnu-1.5.3 \\\n && ./configure --prefix=/tools \\\n && make install \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && popd \\\n && rm -rf /tmp/dejagnu-*\n#  ##############\n#   compile check\n#  ##############\nCOPY check-0.10.0.tar.gz $LFS/sources/\nRUN tar -xf check-0.10.0.tar.gz -C /tmp/ \\\n && pushd /tmp/check-0.10.0 \\\n && PKG_CONFIG= ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/check-*\n#  ################\n#   compile ncurses\n#  ################\nCOPY ncurses-6.0.tar.gz $LFS/sources/\nRUN tar -xf ncurses-6.0.tar.gz -C /tmp/ \\\n && pushd /tmp/ncurses-6.0 \\\n && sed -i s/mawk// configure \\\n && ./configure --prefix=/tools --with-shared --without-debug --without-ada --enable-widec --enable-overwrite \\\n && make \\\n && make install \\\n && popd \\\n && rm -rf /tmp/ncurses-*\n#  #############\n#   compile bash\n#  #############\nCOPY bash-4.3.30.tar.gz $LFS/sources/\nRUN tar -xf bash-4.3.30.tar.gz -C /tmp/ \\\n && pushd /tmp/bash-4.3.30 \\\n && ./configure --prefix=/tools --without-bash-malloc \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make tests ; fi \\\n && make install \\\n && ln -sv bash /tools/bin/sh \\\n && popd \\\n && rm -rf /tmp/bash-*\n#  ##############\n#   compile bzip2\n#  ##############\nCOPY bzip2-1.0.6.tar.gz $LFS/sources/\nRUN tar -xf bzip2-1.0.6.tar.gz -C /tmp/ \\\n && pushd /tmp/bzip2-1.0.6 \\\n && make \\\n && make PREFIX=/tools install \\\n && popd \\\n && rm -rf /tmp/bzip2-*\n#  ##################\n#   compile coreutils\n#  ##################\n#   2 tests fail (dd/direct.sh, dd/sparse.sh). Similar issue reported on some file systems => may be linked to docker fs\nCOPY coreutils-8.25.tar.xz $LFS/sources/\nRUN tar -xf coreutils-8.25.tar.xz -C /tmp/ \\\n && pushd /tmp/coreutils-8.25 \\\n && ./configure --prefix=/tools --enable-install-program=hostname \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make RUN_EXPENSIVE_TESTS=yes check || true ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/coreutils-*\n#  ##################\n#   compile diffutils\n#  ##################\nCOPY diffutils-3.3.tar.xz $LFS/sources/\nRUN tar -xf diffutils-3.3.tar.xz -C /tmp/ \\\n && pushd /tmp/diffutils-3.3 \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/diffutils-*\n#  #############\n#   compile file\n#  #############\nCOPY file-5.25.tar.gz $LFS/sources/\nRUN tar -xf file-5.25.tar.gz -C /tmp/ \\\n && pushd /tmp/file-5.25 \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/file-*\n#  ##################\n#   compile findutils\n#  ##################\nCOPY findutils-4.6.0.tar.gz $LFS/sources/\nRUN tar -xf findutils-4.6.0.tar.gz -C /tmp/ \\\n && pushd /tmp/findutils-4.6.0 \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/findutils-*\n#  #############\n#   compile gawk\n#  #############\nCOPY gawk-4.1.3.tar.xz $LFS/sources/\nRUN tar -xf gawk-4.1.3.tar.xz -C /tmp/ \\\n && pushd /tmp/gawk-4.1.3 \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/gawk-*\n#  ################\n#   compile gettext\n#  ################\nCOPY gettext-0.19.7.tar.xz $LFS/sources/\nRUN tar -xf gettext-0.19.7.tar.xz -C /tmp/ \\\n && pushd /tmp/gettext-0.19.7 \\\n && cd gettext-tools \\\n && EMACS=\"no\" ./configure --prefix=/tools --disable-shared \\\n && make -C gnulib-lib \\\n && make -C intl pluralx.c \\\n && make -C src msgfmt \\\n && make -C src msgmerge \\\n && make -C src xgettext \\\n && cp -v src/{msgfmt,msgmerge,xgettext} /tools/bin \\\n && popd \\\n && rm -rf /tmp/gettext-*\n#  #############\n#   compile grep\n#  #############\nCOPY grep-2.23.tar.xz $LFS/sources/\nRUN tar -xf grep-2.23.tar.xz -C /tmp/ \\\n && pushd /tmp/grep-2.23 \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/grep-*\n#  #############\n#   compile gzip \n#  #############\n#   1 test fails (zless)\nCOPY gzip-1.6.tar.xz $LFS/sources/\nRUN tar -xf gzip-1.6.tar.xz -C /tmp/ \\\n && pushd /tmp/gzip-1.6 \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check || true ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/gzip-*\n#  ###########\n#   compile m4\n#  ###########\nCOPY m4-1.4.17.tar.xz $LFS/sources/\nRUN tar -xf m4-1.4.17.tar.xz -C /tmp/ \\\n && pushd /tmp/m4-1.4.17 \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/m4-*\n#  #############\n#   compile make\n#  #############\n#   1 test fails (misc/fopen-fail)\nCOPY make-4.1.tar.bz2 $LFS/sources/\nRUN tar -xf make-4.1.tar.bz2 -C /tmp/ \\\n && pushd /tmp/make-4.1 \\\n && ./configure --prefix=/tools --without-guile \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check || true ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/make-*\n#  ##############\n#   compile patch\n#  ##############\nCOPY patch-2.7.5.tar.xz $LFS/sources/\nRUN tar -xf patch-2.7.5.tar.xz -C /tmp/ \\\n && pushd /tmp/patch-2.7.5 \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/patch-*\n#  #############\n#   compile perl\n#  #############\nCOPY perl-5.22.1.tar.bz2 $LFS/sources/\nRUN tar -xf perl-5.22.1.tar.bz2 -C /tmp/ \\\n && pushd /tmp/perl-5.22.1 \\\n && sh Configure -des -Dprefix=/tools -Dlibs=-lm \\\n && make \\\n && cp -v perl cpan/podlators/pod2man /tools/bin \\\n && mkdir -pv /tools/lib/perl5/5.22.1 \\\n && cp -Rv lib/* /tools/lib/perl5/5.22.1 \\\n && popd \\\n && rm -rf /tmp/perl-*\n#  ############\n#   compile sed\n#  ############\nCOPY sed-4.2.2.tar.bz2 $LFS/sources/\nRUN tar -xf sed-4.2.2.tar.bz2 -C /tmp/ \\\n && pushd /tmp/sed-4.2.2 \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/sed-*\n#  ############\n#   compile tar\n#  ############\nCOPY tar-1.28.tar.xz $LFS/sources/\nRUN tar -xf tar-1.28.tar.xz -C /tmp/ \\\n && pushd /tmp/tar-1.28 \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/tar-*\n#  ################\n#   compile texinfo\n#  ################\nCOPY texinfo-6.1.tar.xz $LFS/sources/\nRUN tar -xf texinfo-6.1.tar.xz -C /tmp/ \\\n && pushd /tmp/texinfo-6.1 \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/texinfo-*\n#  ###################\n#   compile util-linux\n#  ###################\nCOPY util-linux-2.27.1.tar.xz $LFS/sources/\nRUN tar -xf util-linux-2.27.1.tar.xz -C /tmp/ \\\n && pushd /tmp/util-linux-2.27.1 \\\n && ./configure --prefix=/tools --without-python --disable-makeinstall-chown --without-systemdsystemunitdir PKG_CONFIG=\"\" \\\n && make \\\n && make install \\\n && popd \\\n && rm -rf /tmp/util-linux-*\n#  ###########\n#   compile xz\n#  ###########\nCOPY xz-5.2.2.tar.xz $LFS/sources/\nRUN tar -xf xz-5.2.2.tar.xz -C /tmp/ \\\n && pushd /tmp/xz-5.2.2 \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/xz-*\n#   stripping\nRUN strip --strip-debug /tools/lib/* || true\nRUN /usr/bin/strip --strip-unneeded /tools/{,s}bin/* || true\nRUN rm -rf /tools/{,share}/{info,man,doc}\nUSER root\nRUN chown -R root:root $LFS/tools\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  cf. http://www.linuxfromscratch.org/lfs/view/7.9-systemd/\nFROM debian:8\nARG LFS_TEST=1\nARG PROC=1\nMAINTAINER Perceval BRET\nLABEL com.ac.src.architecture=\"x86_64\" \\\n      com.ac.src.distribution=\"lfs\" \\\n      com.ac.src.version=\"7.9\" \\\n      com.ac.src.init=\"systemd\"\nCMD [\"/bin/bash\"]\n#  install required packages\nRUN apt-get update -q \\\n && apt-get install build-essential bison gawk texinfo wget file -q -y \\\n && apt-get -q -y autoremove \\\n && rm -rf /var/lib/apt/lists/*\n#  set bash as default shell\nWORKDIR /bin\nRUN rm sh \\\n && ln -s bash sh\n#  create directories\nENV LFS=\"/mnt/lfs\"\nRUN mkdir -pv $LFS/{usr,sources} \\\n && chmod -v a+wt $LFS/sources\nWORKDIR $LFS/sources\n#  check environment\nCOPY version-check.sh library-check.sh $LFS/sources/\nRUN chmod -v 755 *.sh \\\n && sync \\\n && ./version-check.sh \\\n && ./library-check.sh\n#  create tools directory\nRUN mkdir -pv $LFS/tools \\\n && ln -sv $LFS/tools /\n#  create lfs user (with lfs as password)\nRUN groupadd lfs \\\n && useradd -s /bin/bash -g lfs -m -k /dev/null lfs \\\n && echo \"lfs:lfs\" | chpasswd\n#  set directories accesses\nRUN chown -v lfs $LFS/tools \\\n && chown -v lfs $LFS/sources\n#  set lfs user environment\nUSER lfs\nCOPY .bash_profile .bashrc /home/lfs/\n#  @hint must be defined as ENV to be accessible by RUN commands\nENV LC_ALL=\"POSIX\" \\\n    LFS_TGT=\"x86_64-lfs-linux-gnu\" \\\n    PATH=\"/tools/bin:/bin:/usr/bin\" \\\n    MAKEFLAGS=\"-j $PROC\"\n# ##########################\n#  compile binutils (pass 1)\n# ##########################\nCOPY binutils-2.26.tar.bz2 $LFS/sources/\nRUN tar -xf binutils-2.26.tar.bz2 -C /tmp/ \\\n && pushd /tmp/binutils-2.26 \\\n && mkdir -v build \\\n && cd build \\\n && ../configure --prefix=/tools --with-sysroot=$LFS --with-lib-path=/tools/lib --target=$LFS_TGT --disable-nls --disable-werror \\\n && make \\\n && mkdir -pv /tools/lib \\\n && ln -sv lib /tools/lib64 \\\n && make install \\\n && popd \\\n && rm -rf /tmp/binutils-*\n# #####################\n#  compile gcc (pass 1)\n# #####################\nCOPY gcc-5.3.0.tar.bz2 mpfr-3.1.3.tar.xz gmp-6.1.0.tar.xz mpc-1.0.3.tar.gz $LFS/sources/\nRUN tar -xf gcc-5.3.0.tar.bz2 -C /tmp/ \\\n && pushd /tmp/gcc-5.3.0 \\\n && tar -xf $LFS/sources/mpfr-3.1.3.tar.xz \\\n && mv -v mpfr-3.1.3 mpfr \\\n && tar -xf $LFS/sources/gmp-6.1.0.tar.xz \\\n && mv -v gmp-6.1.0 gmp \\\n && tar -xf $LFS/sources/mpc-1.0.3.tar.gz \\\n && mv -v mpc-1.0.3 mpc \\\n && for file in $( find gcc/config -name linux64.h -o -name linux.h -o -name sysv4.h ;); do cp -uv $file{,.orig} ;sed -e 's@/lib\\(64\\)\\?\\(32\\)\\?/ld@/tools&@g' -e 's@/usr@/tools@g' $file.orig > $file;echo -e \"\\n#undef STANDARD_STARTFILE_PREFIX_1 \\n#undef STANDARD_STARTFILE_PREFIX_2 \\n#define STANDARD_STARTFILE_PREFIX_1 \\\"/tools/lib/\\\" \\n#define STANDARD_STARTFILE_PREFIX_2 \\\"\\\"\" >> $file;touch $file.orig ; done \\\n && mkdir -v build \\\n && cd build \\\n && ../configure --target=$LFS_TGT --prefix=/tools --with-glibc-version=2.11 --with-sysroot=$LFS --with-newlib --without-headers --with-local-prefix=/tools --with-native-system-header-dir=/tools/include --disable-nls --disable-shared --disable-multilib --disable-decimal-float --disable-threads --disable-libatomic --disable-libgomp --disable-libquadmath --disable-libssp --disable-libvtv --disable-libstdcxx --enable-languages=c,c++ \\\n && make \\\n && make install \\\n && popd \\\n && rm -rf /tmp/gcc-*\n# ##########################\n#  compile Linux API headers\n# ##########################\nCOPY linux-4.4.2.tar.xz $LFS/sources/\nRUN tar -xf linux-4.4.2.tar.xz -C /tmp/ \\\n && pushd /tmp/linux-4.4.2 \\\n && make mrproper \\\n && make INSTALL_HDR_PATH=dest headers_install \\\n && cp -rv dest/include/* /tools/include \\\n && popd \\\n && rm -rf /tmp/linux-*\n# ##############\n#  compile glibc\n# ##############\nCOPY glibc-2.23.tar.xz $LFS/sources/\nRUN tar -xf glibc-2.23.tar.xz -C /tmp/ \\\n && pushd /tmp/glibc-2.23 \\\n && mkdir -v build \\\n && cd build \\\n && ../configure --prefix=/tools --host=$LFS_TGT --build=$( ../scripts/config.guess ;) --disable-profile --enable-kernel=2.6.32 --enable-obsolete-rpc --with-headers=/tools/include libc_cv_forced_unwind=yes libc_cv_ctors_header=yes libc_cv_c_cleanup=yes \\\n && make \\\n && make install \\\n && popd \\\n && rm -rf /tmp/glibc-*\n#  run tests\nRUN echo 'int main(){}' > dummy.c \\\n && $LFS_TGT-gcc dummy.c \\\n && readelf -l a.out | grep ': /tools' \\\n && rm -v dummy.c a.out\n# ##################\n#  compile libstdc++\n# ##################\nCOPY gcc-5.3.0.tar.bz2 $LFS/sources/\nRUN tar -xf gcc-5.3.0.tar.bz2 -C /tmp/ \\\n && pushd /tmp/gcc-5.3.0 \\\n && mkdir -v build \\\n && cd build \\\n && ../libstdc++-v3/configure --host=$LFS_TGT --prefix=/tools --disable-multilib --disable-nls --disable-libstdcxx-threads --disable-libstdcxx-pch --with-gxx-include-dir=/tools/$LFS_TGT/include/c++/5.3.0 \\\n && make \\\n && make install \\\n && popd \\\n && rm -rf /tmp/gcc-*\n# ##########################\n#  compile binutils (pass 2)\n# ##########################\nCOPY binutils-2.26.tar.bz2 $LFS/sources/\nRUN tar -xf binutils-2.26.tar.bz2 -C /tmp/ \\\n && pushd /tmp/binutils-2.26 \\\n && mkdir -v build \\\n && cd build \\\n && CC=$LFS_TGT-gcc AR=$LFS_TGT-ar RANLIB=$LFS_TGT-ranlib ../configure --prefix=/tools --disable-nls --disable-werror --with-lib-path=/tools/lib --with-sysroot \\\n && make \\\n && make install \\\n && make -C ld clean \\\n && make -C ld LIB_PATH=/usr/lib:/lib \\\n && cp -v ld/ld-new /tools/bin \\\n && popd \\\n && rm -rf /tmp/binutils-*\n# #####################\n#  compile gcc (pass 2)\n# #####################\nCOPY gcc-5.3.0.tar.bz2 mpfr-3.1.3.tar.xz gmp-6.1.0.tar.xz mpc-1.0.3.tar.gz $LFS/sources/\nRUN tar -xf gcc-5.3.0.tar.bz2 -C /tmp/ \\\n && pushd /tmp/gcc-5.3.0 \\\n && cat gcc/limitx.h gcc/glimits.h gcc/limity.h > `dirname $( $LFS_TGT-gcc -print-libgcc-file-name ;) `/include-fixed/limits.h \\\n && for file in $( find gcc/config -name linux64.h -o -name linux.h -o -name sysv4.h ;); do cp -uv $file{,.orig} ;sed -e 's@/lib\\(64\\)\\?\\(32\\)\\?/ld@/tools&@g' -e 's@/usr@/tools@g' $file.orig > $file;echo -e \"\\n#undef STANDARD_STARTFILE_PREFIX_1 \\n#undef STANDARD_STARTFILE_PREFIX_2 \\n#define STANDARD_STARTFILE_PREFIX_1 \\\"/tools/lib/\\\" \\n#define STANDARD_STARTFILE_PREFIX_2 \\\"\\\"\" >> $file;touch $file.orig ; done \\\n && tar -xf $LFS/sources/mpfr-3.1.3.tar.xz \\\n && mv -v mpfr-3.1.3 mpfr \\\n && tar -xf $LFS/sources/gmp-6.1.0.tar.xz \\\n && mv -v gmp-6.1.0 gmp \\\n && tar -xf $LFS/sources/mpc-1.0.3.tar.gz \\\n && mv -v mpc-1.0.3 mpc \\\n && mkdir -v build \\\n && cd build \\\n && CC=$LFS_TGT-gcc CXX=$LFS_TGT-g++ AR=$LFS_TGT-ar RANLIB=$LFS_TGT-ranlib ../configure --prefix=/tools --with-local-prefix=/tools --with-native-system-header-dir=/tools/include --enable-languages=c,c++ --disable-libstdcxx-pch --disable-multilib --disable-bootstrap --disable-libgomp \\\n && make \\\n && make install \\\n && ln -sv gcc /tools/bin/cc \\\n && popd \\\n && rm -rf /tmp/gcc-*\n#  run tests\nRUN echo 'int main(){}' > dummy.c \\\n && cc dummy.c \\\n && readelf -l a.out | grep ': /tools' \\\n && rm -v dummy.c a.out\n# #################\n#  compile tcl-core\n# #################\nCOPY tcl-core8.6.4-src.tar.gz $LFS/sources/\nRUN tar -xf tcl-core8.6.4-src.tar.gz -C /tmp/ \\\n && pushd /tmp/tcl8.6.4 \\\n && cd unix \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then TZ=UTC make test ; fi \\\n && make install \\\n && chmod -v u+w /tools/lib/libtcl8.6.so \\\n && make install-private-headers \\\n && ln -sv tclsh8.6 /tools/bin/tclsh \\\n && popd \\\n && rm -rf /tmp/tcl*\n# ###############\n#  compile expect\n# ###############\nCOPY expect5.45.tar.gz $LFS/sources/\nRUN tar -xf expect5.45.tar.gz -C /tmp/ \\\n && pushd /tmp/expect5.45 \\\n && cp -v configure{,.orig} \\\n && sed 's:/usr/local/bin:/bin:' configure.orig > configure \\\n && ./configure --prefix=/tools --with-tcl=/tools/lib --with-tclinclude=/tools/include \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make test ; fi \\\n && make SCRIPTS=\"\" install \\\n && popd \\\n && rm -rf /tmp/expect*\n# ################\n#  compile dejaGNU\n# ################\nCOPY dejagnu-1.5.3.tar.gz $LFS/sources/\nRUN tar -xf dejagnu-1.5.3.tar.gz -C /tmp/ \\\n && pushd /tmp/dejagnu-1.5.3 \\\n && ./configure --prefix=/tools \\\n && make install \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && popd \\\n && rm -rf /tmp/dejagnu-*\n# ##############\n#  compile check\n# ##############\nCOPY check-0.10.0.tar.gz $LFS/sources/\nRUN tar -xf check-0.10.0.tar.gz -C /tmp/ \\\n && pushd /tmp/check-0.10.0 \\\n && PKG_CONFIG= ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/check-*\n# ################\n#  compile ncurses\n# ################\nCOPY ncurses-6.0.tar.gz $LFS/sources/\nRUN tar -xf ncurses-6.0.tar.gz -C /tmp/ \\\n && pushd /tmp/ncurses-6.0 \\\n && sed -i s/mawk// configure \\\n && ./configure --prefix=/tools --with-shared --without-debug --without-ada --enable-widec --enable-overwrite \\\n && make \\\n && make install \\\n && popd \\\n && rm -rf /tmp/ncurses-*\n# #############\n#  compile bash\n# #############\nCOPY bash-4.3.30.tar.gz $LFS/sources/\nRUN tar -xf bash-4.3.30.tar.gz -C /tmp/ \\\n && pushd /tmp/bash-4.3.30 \\\n && ./configure --prefix=/tools --without-bash-malloc \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make tests ; fi \\\n && make install \\\n && ln -sv bash /tools/bin/sh \\\n && popd \\\n && rm -rf /tmp/bash-*\n# ##############\n#  compile bzip2\n# ##############\nCOPY bzip2-1.0.6.tar.gz $LFS/sources/\nRUN tar -xf bzip2-1.0.6.tar.gz -C /tmp/ \\\n && pushd /tmp/bzip2-1.0.6 \\\n && make \\\n && make PREFIX=/tools install \\\n && popd \\\n && rm -rf /tmp/bzip2-*\n# ##################\n#  compile coreutils\n# ##################\n#  2 tests fail (dd/direct.sh, dd/sparse.sh). Similar issue reported on some file systems => may be linked to docker fs\nCOPY coreutils-8.25.tar.xz $LFS/sources/\nRUN tar -xf coreutils-8.25.tar.xz -C /tmp/ \\\n && pushd /tmp/coreutils-8.25 \\\n && ./configure --prefix=/tools --enable-install-program=hostname \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make RUN_EXPENSIVE_TESTS=yes check || true ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/coreutils-*\n# ##################\n#  compile diffutils\n# ##################\nCOPY diffutils-3.3.tar.xz $LFS/sources/\nRUN tar -xf diffutils-3.3.tar.xz -C /tmp/ \\\n && pushd /tmp/diffutils-3.3 \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/diffutils-*\n# #############\n#  compile file\n# #############\nCOPY file-5.25.tar.gz $LFS/sources/\nRUN tar -xf file-5.25.tar.gz -C /tmp/ \\\n && pushd /tmp/file-5.25 \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/file-*\n# ##################\n#  compile findutils\n# ##################\nCOPY findutils-4.6.0.tar.gz $LFS/sources/\nRUN tar -xf findutils-4.6.0.tar.gz -C /tmp/ \\\n && pushd /tmp/findutils-4.6.0 \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/findutils-*\n# #############\n#  compile gawk\n# #############\nCOPY gawk-4.1.3.tar.xz $LFS/sources/\nRUN tar -xf gawk-4.1.3.tar.xz -C /tmp/ \\\n && pushd /tmp/gawk-4.1.3 \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/gawk-*\n# ################\n#  compile gettext\n# ################\nCOPY gettext-0.19.7.tar.xz $LFS/sources/\nRUN tar -xf gettext-0.19.7.tar.xz -C /tmp/ \\\n && pushd /tmp/gettext-0.19.7 \\\n && cd gettext-tools \\\n && EMACS=\"no\" ./configure --prefix=/tools --disable-shared \\\n && make -C gnulib-lib \\\n && make -C intl pluralx.c \\\n && make -C src msgfmt \\\n && make -C src msgmerge \\\n && make -C src xgettext \\\n && cp -v src/{msgfmt,msgmerge,xgettext} /tools/bin \\\n && popd \\\n && rm -rf /tmp/gettext-*\n# #############\n#  compile grep\n# #############\nCOPY grep-2.23.tar.xz $LFS/sources/\nRUN tar -xf grep-2.23.tar.xz -C /tmp/ \\\n && pushd /tmp/grep-2.23 \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/grep-*\n# #############\n#  compile gzip \n# #############\n#  1 test fails (zless)\nCOPY gzip-1.6.tar.xz $LFS/sources/\nRUN tar -xf gzip-1.6.tar.xz -C /tmp/ \\\n && pushd /tmp/gzip-1.6 \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check || true ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/gzip-*\n# ###########\n#  compile m4\n# ###########\nCOPY m4-1.4.17.tar.xz $LFS/sources/\nRUN tar -xf m4-1.4.17.tar.xz -C /tmp/ \\\n && pushd /tmp/m4-1.4.17 \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/m4-*\n# #############\n#  compile make\n# #############\n#  1 test fails (misc/fopen-fail)\nCOPY make-4.1.tar.bz2 $LFS/sources/\nRUN tar -xf make-4.1.tar.bz2 -C /tmp/ \\\n && pushd /tmp/make-4.1 \\\n && ./configure --prefix=/tools --without-guile \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check || true ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/make-*\n# ##############\n#  compile patch\n# ##############\nCOPY patch-2.7.5.tar.xz $LFS/sources/\nRUN tar -xf patch-2.7.5.tar.xz -C /tmp/ \\\n && pushd /tmp/patch-2.7.5 \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/patch-*\n# #############\n#  compile perl\n# #############\nCOPY perl-5.22.1.tar.bz2 $LFS/sources/\nRUN tar -xf perl-5.22.1.tar.bz2 -C /tmp/ \\\n && pushd /tmp/perl-5.22.1 \\\n && sh Configure -des -Dprefix=/tools -Dlibs=-lm \\\n && make \\\n && cp -v perl cpan/podlators/pod2man /tools/bin \\\n && mkdir -pv /tools/lib/perl5/5.22.1 \\\n && cp -Rv lib/* /tools/lib/perl5/5.22.1 \\\n && popd \\\n && rm -rf /tmp/perl-*\n# ############\n#  compile sed\n# ############\nCOPY sed-4.2.2.tar.bz2 $LFS/sources/\nRUN tar -xf sed-4.2.2.tar.bz2 -C /tmp/ \\\n && pushd /tmp/sed-4.2.2 \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/sed-*\n# ############\n#  compile tar\n# ############\nCOPY tar-1.28.tar.xz $LFS/sources/\nRUN tar -xf tar-1.28.tar.xz -C /tmp/ \\\n && pushd /tmp/tar-1.28 \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/tar-*\n# ################\n#  compile texinfo\n# ################\nCOPY texinfo-6.1.tar.xz $LFS/sources/\nRUN tar -xf texinfo-6.1.tar.xz -C /tmp/ \\\n && pushd /tmp/texinfo-6.1 \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/texinfo-*\n# ###################\n#  compile util-linux\n# ###################\nCOPY util-linux-2.27.1.tar.xz $LFS/sources/\nRUN tar -xf util-linux-2.27.1.tar.xz -C /tmp/ \\\n && pushd /tmp/util-linux-2.27.1 \\\n && ./configure --prefix=/tools --without-python --disable-makeinstall-chown --without-systemdsystemunitdir PKG_CONFIG=\"\" \\\n && make \\\n && make install \\\n && popd \\\n && rm -rf /tmp/util-linux-*\n# ###########\n#  compile xz\n# ###########\nCOPY xz-5.2.2.tar.xz $LFS/sources/\nRUN tar -xf xz-5.2.2.tar.xz -C /tmp/ \\\n && pushd /tmp/xz-5.2.2 \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/xz-*\n#  stripping\nRUN strip --strip-debug /tools/lib/* || true\nRUN /usr/bin/strip --strip-unneeded /tools/{,s}bin/* || true\nRUN rm -rf /tools/{,share}/{info,man,doc}\nUSER root\nRUN chown -R root:root $LFS/tools\n","injectedSmells":[],"originalDockerfileHash":"b9764b6f2706b01c71da6c6940289819","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   cf. http://www.linuxfromscratch.org/lfs/view/7.9-systemd/\nFROM debian:8\nARG LFS_TEST=1\nARG PROC=1\nMAINTAINER Perceval BRET\nLABEL com.ac.src.architecture=\"x86_64\" \\\n      com.ac.src.distribution=\"lfs\" \\\n      com.ac.src.version=\"7.9\" \\\n      com.ac.src.init=\"systemd\"\nCMD [\"/bin/bash\"]\n#   install required packages\nRUN apt-get update -q \\\n && apt-get install build-essential bison gawk texinfo wget file -q -y \\\n && apt-get -q -y autoremove \\\n && rm -rf /var/lib/apt/lists/*\n#   set bash as default shell\nWORKDIR /bin\nRUN rm sh \\\n && ln -s bash sh\n#   create directories\nENV LFS=\"/mnt/lfs\"\nRUN mkdir -pv $LFS/{usr,sources} \\\n && chmod -v a+wt $LFS/sources\nWORKDIR $LFS/sources\n#   check environment\nCOPY version-check.sh library-check.sh $LFS/sources/\nRUN chmod -v 755 *.sh \\\n && sync \\\n && ./version-check.sh \\\n && ./library-check.sh\n#   create tools directory\nRUN mkdir -pv $LFS/tools \\\n && ln -sv $LFS/tools /\n#   create lfs user (with lfs as password)\nRUN groupadd lfs \\\n && useradd -s /bin/bash -g lfs -m -k /dev/null lfs \\\n && echo \"lfs:lfs\" | chpasswd\n#   set directories accesses\nRUN chown -v lfs $LFS/tools \\\n && chown -v lfs $LFS/sources\n#   set lfs user environment\nUSER lfs\nCOPY .bash_profile .bashrc /home/lfs/\n#   @hint must be defined as ENV to be accessible by RUN commands\nENV LC_ALL=\"POSIX\" \\\n    LFS_TGT=\"x86_64-lfs-linux-gnu\" \\\n    PATH=\"/tools/bin:/bin:/usr/bin\" \\\n    MAKEFLAGS=\"-j $PROC\"\n#  ##########################\n#   compile binutils (pass 1)\n#  ##########################\nCOPY binutils-2.26.tar.bz2 $LFS/sources/\nRUN tar -xf binutils-2.26.tar.bz2 -C /tmp/ \\\n && pushd /tmp/binutils-2.26 \\\n && mkdir -v build \\\n && cd build \\\n && ../configure --prefix=/tools --with-sysroot=$LFS --with-lib-path=/tools/lib --target=$LFS_TGT --disable-nls --disable-werror \\\n && make \\\n && mkdir -pv /tools/lib \\\n && ln -sv lib /tools/lib64 \\\n && make install \\\n && popd \\\n && rm -rf /tmp/binutils-*\n#  #####################\n#   compile gcc (pass 1)\n#  #####################\nCOPY gcc-5.3.0.tar.bz2 mpfr-3.1.3.tar.xz gmp-6.1.0.tar.xz mpc-1.0.3.tar.gz $LFS/sources/\nRUN tar -xf gcc-5.3.0.tar.bz2 -C /tmp/ \\\n && pushd /tmp/gcc-5.3.0 \\\n && tar -xf $LFS/sources/mpfr-3.1.3.tar.xz \\\n && mv -v mpfr-3.1.3 mpfr \\\n && tar -xf $LFS/sources/gmp-6.1.0.tar.xz \\\n && mv -v gmp-6.1.0 gmp \\\n && tar -xf $LFS/sources/mpc-1.0.3.tar.gz \\\n && mv -v mpc-1.0.3 mpc \\\n && for file in $( find gcc/config -name linux64.h -o -name linux.h -o -name sysv4.h ;); do cp -uv $file{,.orig} ;sed -e 's@/lib\\(64\\)\\?\\(32\\)\\?/ld@/tools&@g' -e 's@/usr@/tools@g' $file.orig > $file;echo -e \"\\n#undef STANDARD_STARTFILE_PREFIX_1 \\n#undef STANDARD_STARTFILE_PREFIX_2 \\n#define STANDARD_STARTFILE_PREFIX_1 \\\"/tools/lib/\\\" \\n#define STANDARD_STARTFILE_PREFIX_2 \\\"\\\"\" >> $file;touch $file.orig ; done \\\n && mkdir -v build \\\n && cd build \\\n && ../configure --target=$LFS_TGT --prefix=/tools --with-glibc-version=2.11 --with-sysroot=$LFS --with-newlib --without-headers --with-local-prefix=/tools --with-native-system-header-dir=/tools/include --disable-nls --disable-shared --disable-multilib --disable-decimal-float --disable-threads --disable-libatomic --disable-libgomp --disable-libquadmath --disable-libssp --disable-libvtv --disable-libstdcxx --enable-languages=c,c++ \\\n && make \\\n && make install \\\n && popd \\\n && rm -rf /tmp/gcc-*\n#  ##########################\n#   compile Linux API headers\n#  ##########################\nCOPY linux-4.4.2.tar.xz $LFS/sources/\nRUN tar -xf linux-4.4.2.tar.xz -C /tmp/ \\\n && pushd /tmp/linux-4.4.2 \\\n && make mrproper \\\n && make INSTALL_HDR_PATH=dest headers_install \\\n && cp -rv dest/include/* /tools/include \\\n && popd \\\n && rm -rf /tmp/linux-*\n#  ##############\n#   compile glibc\n#  ##############\nCOPY glibc-2.23.tar.xz $LFS/sources/\nRUN tar -xf glibc-2.23.tar.xz -C /tmp/ \\\n && pushd /tmp/glibc-2.23 \\\n && mkdir -v build \\\n && cd build \\\n && ../configure --prefix=/tools --host=$LFS_TGT --build=$( ../scripts/config.guess ;) --disable-profile --enable-kernel=2.6.32 --enable-obsolete-rpc --with-headers=/tools/include libc_cv_forced_unwind=yes libc_cv_ctors_header=yes libc_cv_c_cleanup=yes \\\n && make \\\n && make install \\\n && popd \\\n && rm -rf /tmp/glibc-*\n#   run tests\nRUN echo 'int main(){}' > dummy.c \\\n && $LFS_TGT-gcc dummy.c \\\n && readelf -l a.out | grep ': /tools' \\\n && rm -v dummy.c a.out\n#  ##################\n#   compile libstdc++\n#  ##################\nCOPY gcc-5.3.0.tar.bz2 $LFS/sources/\nRUN tar -xf gcc-5.3.0.tar.bz2 -C /tmp/ \\\n && pushd /tmp/gcc-5.3.0 \\\n && mkdir -v build \\\n && cd build \\\n && ../libstdc++-v3/configure --host=$LFS_TGT --prefix=/tools --disable-multilib --disable-nls --disable-libstdcxx-threads --disable-libstdcxx-pch --with-gxx-include-dir=/tools/$LFS_TGT/include/c++/5.3.0 \\\n && make \\\n && make install \\\n && popd \\\n && rm -rf /tmp/gcc-*\n#  ##########################\n#   compile binutils (pass 2)\n#  ##########################\nCOPY binutils-2.26.tar.bz2 $LFS/sources/\nRUN tar -xf binutils-2.26.tar.bz2 -C /tmp/ \\\n && pushd /tmp/binutils-2.26 \\\n && mkdir -v build \\\n && cd build \\\n && CC=$LFS_TGT-gcc AR=$LFS_TGT-ar RANLIB=$LFS_TGT-ranlib ../configure --prefix=/tools --disable-nls --disable-werror --with-lib-path=/tools/lib --with-sysroot \\\n && make \\\n && make install \\\n && make -C ld clean \\\n && make -C ld LIB_PATH=/usr/lib:/lib \\\n && cp -v ld/ld-new /tools/bin \\\n && popd \\\n && rm -rf /tmp/binutils-*\n#  #####################\n#   compile gcc (pass 2)\n#  #####################\nCOPY gcc-5.3.0.tar.bz2 mpfr-3.1.3.tar.xz gmp-6.1.0.tar.xz mpc-1.0.3.tar.gz $LFS/sources/\nRUN tar -xf gcc-5.3.0.tar.bz2 -C /tmp/ \\\n && pushd /tmp/gcc-5.3.0 \\\n && cat gcc/limitx.h gcc/glimits.h gcc/limity.h > `dirname $( $LFS_TGT-gcc -print-libgcc-file-name ;) `/include-fixed/limits.h \\\n && for file in $( find gcc/config -name linux64.h -o -name linux.h -o -name sysv4.h ;); do cp -uv $file{,.orig} ;sed -e 's@/lib\\(64\\)\\?\\(32\\)\\?/ld@/tools&@g' -e 's@/usr@/tools@g' $file.orig > $file;echo -e \"\\n#undef STANDARD_STARTFILE_PREFIX_1 \\n#undef STANDARD_STARTFILE_PREFIX_2 \\n#define STANDARD_STARTFILE_PREFIX_1 \\\"/tools/lib/\\\" \\n#define STANDARD_STARTFILE_PREFIX_2 \\\"\\\"\" >> $file;touch $file.orig ; done \\\n && tar -xf $LFS/sources/mpfr-3.1.3.tar.xz \\\n && mv -v mpfr-3.1.3 mpfr \\\n && tar -xf $LFS/sources/gmp-6.1.0.tar.xz \\\n && mv -v gmp-6.1.0 gmp \\\n && tar -xf $LFS/sources/mpc-1.0.3.tar.gz \\\n && mv -v mpc-1.0.3 mpc \\\n && mkdir -v build \\\n && cd build \\\n && CC=$LFS_TGT-gcc CXX=$LFS_TGT-g++ AR=$LFS_TGT-ar RANLIB=$LFS_TGT-ranlib ../configure --prefix=/tools --with-local-prefix=/tools --with-native-system-header-dir=/tools/include --enable-languages=c,c++ --disable-libstdcxx-pch --disable-multilib --disable-bootstrap --disable-libgomp \\\n && make \\\n && make install \\\n && ln -sv gcc /tools/bin/cc \\\n && popd \\\n && rm -rf /tmp/gcc-*\n#   run tests\nRUN echo 'int main(){}' > dummy.c \\\n && cc dummy.c \\\n && readelf -l a.out | grep ': /tools' \\\n && rm -v dummy.c a.out\n#  #################\n#   compile tcl-core\n#  #################\nCOPY tcl-core8.6.4-src.tar.gz $LFS/sources/\nRUN tar -xf tcl-core8.6.4-src.tar.gz -C /tmp/ \\\n && pushd /tmp/tcl8.6.4 \\\n && cd unix \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then TZ=UTC make test ; fi \\\n && make install \\\n && chmod -v u+w /tools/lib/libtcl8.6.so \\\n && make install-private-headers \\\n && ln -sv tclsh8.6 /tools/bin/tclsh \\\n && popd \\\n && rm -rf /tmp/tcl*\n#  ###############\n#   compile expect\n#  ###############\nCOPY expect5.45.tar.gz $LFS/sources/\nRUN tar -xf expect5.45.tar.gz -C /tmp/ \\\n && pushd /tmp/expect5.45 \\\n && cp -v configure{,.orig} \\\n && sed 's:/usr/local/bin:/bin:' configure.orig > configure \\\n && ./configure --prefix=/tools --with-tcl=/tools/lib --with-tclinclude=/tools/include \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make test ; fi \\\n && make SCRIPTS=\"\" install \\\n && popd \\\n && rm -rf /tmp/expect*\n#  ################\n#   compile dejaGNU\n#  ################\nCOPY dejagnu-1.5.3.tar.gz $LFS/sources/\nRUN tar -xf dejagnu-1.5.3.tar.gz -C /tmp/ \\\n && pushd /tmp/dejagnu-1.5.3 \\\n && ./configure --prefix=/tools \\\n && make install \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && popd \\\n && rm -rf /tmp/dejagnu-*\n#  ##############\n#   compile check\n#  ##############\nCOPY check-0.10.0.tar.gz $LFS/sources/\nRUN tar -xf check-0.10.0.tar.gz -C /tmp/ \\\n && pushd /tmp/check-0.10.0 \\\n && PKG_CONFIG= ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/check-*\n#  ################\n#   compile ncurses\n#  ################\nCOPY ncurses-6.0.tar.gz $LFS/sources/\nRUN tar -xf ncurses-6.0.tar.gz -C /tmp/ \\\n && pushd /tmp/ncurses-6.0 \\\n && sed -i s/mawk// configure \\\n && ./configure --prefix=/tools --with-shared --without-debug --without-ada --enable-widec --enable-overwrite \\\n && make \\\n && make install \\\n && popd \\\n && rm -rf /tmp/ncurses-*\n#  #############\n#   compile bash\n#  #############\nCOPY bash-4.3.30.tar.gz $LFS/sources/\nRUN tar -xf bash-4.3.30.tar.gz -C /tmp/ \\\n && pushd /tmp/bash-4.3.30 \\\n && ./configure --prefix=/tools --without-bash-malloc \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make tests ; fi \\\n && make install \\\n && ln -sv bash /tools/bin/sh \\\n && popd \\\n && rm -rf /tmp/bash-*\n#  ##############\n#   compile bzip2\n#  ##############\nCOPY bzip2-1.0.6.tar.gz $LFS/sources/\nRUN tar -xf bzip2-1.0.6.tar.gz -C /tmp/ \\\n && pushd /tmp/bzip2-1.0.6 \\\n && make \\\n && make PREFIX=/tools install \\\n && popd \\\n && rm -rf /tmp/bzip2-*\n#  ##################\n#   compile coreutils\n#  ##################\n#   2 tests fail (dd/direct.sh, dd/sparse.sh). Similar issue reported on some file systems => may be linked to docker fs\nCOPY coreutils-8.25.tar.xz $LFS/sources/\nRUN tar -xf coreutils-8.25.tar.xz -C /tmp/ \\\n && pushd /tmp/coreutils-8.25 \\\n && ./configure --prefix=/tools --enable-install-program=hostname \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make RUN_EXPENSIVE_TESTS=yes check || true ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/coreutils-*\n#  ##################\n#   compile diffutils\n#  ##################\nCOPY diffutils-3.3.tar.xz $LFS/sources/\nRUN tar -xf diffutils-3.3.tar.xz -C /tmp/ \\\n && pushd /tmp/diffutils-3.3 \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/diffutils-*\n#  #############\n#   compile file\n#  #############\nCOPY file-5.25.tar.gz $LFS/sources/\nRUN tar -xf file-5.25.tar.gz -C /tmp/ \\\n && pushd /tmp/file-5.25 \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/file-*\n#  ##################\n#   compile findutils\n#  ##################\nCOPY findutils-4.6.0.tar.gz $LFS/sources/\nRUN tar -xf findutils-4.6.0.tar.gz -C /tmp/ \\\n && pushd /tmp/findutils-4.6.0 \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/findutils-*\n#  #############\n#   compile gawk\n#  #############\nCOPY gawk-4.1.3.tar.xz $LFS/sources/\nRUN tar -xf gawk-4.1.3.tar.xz -C /tmp/ \\\n && pushd /tmp/gawk-4.1.3 \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/gawk-*\n#  ################\n#   compile gettext\n#  ################\nCOPY gettext-0.19.7.tar.xz $LFS/sources/\nRUN tar -xf gettext-0.19.7.tar.xz -C /tmp/ \\\n && pushd /tmp/gettext-0.19.7 \\\n && cd gettext-tools \\\n && EMACS=\"no\" ./configure --prefix=/tools --disable-shared \\\n && make -C gnulib-lib \\\n && make -C intl pluralx.c \\\n && make -C src msgfmt \\\n && make -C src msgmerge \\\n && make -C src xgettext \\\n && cp -v src/{msgfmt,msgmerge,xgettext} /tools/bin \\\n && popd \\\n && rm -rf /tmp/gettext-*\n#  #############\n#   compile grep\n#  #############\nCOPY grep-2.23.tar.xz $LFS/sources/\nRUN tar -xf grep-2.23.tar.xz -C /tmp/ \\\n && pushd /tmp/grep-2.23 \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/grep-*\n#  #############\n#   compile gzip \n#  #############\n#   1 test fails (zless)\nCOPY gzip-1.6.tar.xz $LFS/sources/\nRUN tar -xf gzip-1.6.tar.xz -C /tmp/ \\\n && pushd /tmp/gzip-1.6 \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check || true ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/gzip-*\n#  ###########\n#   compile m4\n#  ###########\nCOPY m4-1.4.17.tar.xz $LFS/sources/\nRUN tar -xf m4-1.4.17.tar.xz -C /tmp/ \\\n && pushd /tmp/m4-1.4.17 \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/m4-*\n#  #############\n#   compile make\n#  #############\n#   1 test fails (misc/fopen-fail)\nCOPY make-4.1.tar.bz2 $LFS/sources/\nRUN tar -xf make-4.1.tar.bz2 -C /tmp/ \\\n && pushd /tmp/make-4.1 \\\n && ./configure --prefix=/tools --without-guile \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check || true ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/make-*\n#  ##############\n#   compile patch\n#  ##############\nCOPY patch-2.7.5.tar.xz $LFS/sources/\nRUN tar -xf patch-2.7.5.tar.xz -C /tmp/ \\\n && pushd /tmp/patch-2.7.5 \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/patch-*\n#  #############\n#   compile perl\n#  #############\nCOPY perl-5.22.1.tar.bz2 $LFS/sources/\nRUN tar -xf perl-5.22.1.tar.bz2 -C /tmp/ \\\n && pushd /tmp/perl-5.22.1 \\\n && sh Configure -des -Dprefix=/tools -Dlibs=-lm \\\n && make \\\n && cp -v perl cpan/podlators/pod2man /tools/bin \\\n && mkdir -pv /tools/lib/perl5/5.22.1 \\\n && cp -Rv lib/* /tools/lib/perl5/5.22.1 \\\n && popd \\\n && rm -rf /tmp/perl-*\n#  ############\n#   compile sed\n#  ############\nCOPY sed-4.2.2.tar.bz2 $LFS/sources/\nRUN tar -xf sed-4.2.2.tar.bz2 -C /tmp/ \\\n && pushd /tmp/sed-4.2.2 \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/sed-*\n#  ############\n#   compile tar\n#  ############\nCOPY tar-1.28.tar.xz $LFS/sources/\nRUN tar -xf tar-1.28.tar.xz -C /tmp/ \\\n && pushd /tmp/tar-1.28 \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/tar-*\n#  ################\n#   compile texinfo\n#  ################\nCOPY texinfo-6.1.tar.xz $LFS/sources/\nRUN tar -xf texinfo-6.1.tar.xz -C /tmp/ \\\n && pushd /tmp/texinfo-6.1 \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/texinfo-*\n#  ###################\n#   compile util-linux\n#  ###################\nCOPY util-linux-2.27.1.tar.xz $LFS/sources/\nRUN tar -xf util-linux-2.27.1.tar.xz -C /tmp/ \\\n && pushd /tmp/util-linux-2.27.1 \\\n && ./configure --prefix=/tools --without-python --disable-makeinstall-chown --without-systemdsystemunitdir PKG_CONFIG=\"\" \\\n && make \\\n && make install \\\n && popd \\\n && rm -rf /tmp/util-linux-*\n#  ###########\n#   compile xz\n#  ###########\nCOPY xz-5.2.2.tar.xz $LFS/sources/\nRUN tar -xf xz-5.2.2.tar.xz -C /tmp/ \\\n && pushd /tmp/xz-5.2.2 \\\n && ./configure --prefix=/tools \\\n && make \\\n && if [ $LFS_TEST -eq 1 ] ; then make check ; fi \\\n && make install \\\n && popd \\\n && rm -rf /tmp/xz-*\n#   stripping\nRUN strip --strip-debug /tools/lib/* || true\nRUN /usr/bin/strip --strip-unneeded /tools/{,s}bin/* || true\nRUN rm -rf /tools/{,share}/{info,man,doc}\nUSER root\nRUN chown -R root:root $LFS/tools\n","originalDockerfileUglifiedHash":"522b7c98c510f6e43a6211125083218a","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/81c61183aead855322780df92bd7c94de5a88b6b.dockerfile"}