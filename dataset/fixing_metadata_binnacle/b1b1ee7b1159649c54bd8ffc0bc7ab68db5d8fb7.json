{"seed":338926290,"processedDockerfileHash":"cecd1895cb1f4598901fb55cc1f4a7f7","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM alpine:3.9.4 AS base_stage\nLABEL maintainer=\"beardedeagle <randy@heroictek.com>\"\n#   Important!  Update this no-op ENV variable when this Dockerfile\n#   is updated with the current date. It will force refresh of all\n#   of the base images.\nENV REFRESHED_AT=\"2019-06-24\" \\\n    ELIXIR_VER=\"1.9.0\" \\\n    HEX_VER=\"0.20.1\" \\\n    REBAR3_VER=\"3.11.1\" \\\n    MIX_HOME=\"/usr/local/lib/elixir/.mix\" \\\n    TERM=\"xterm\" \\\n    LANG=\"C.UTF-8\"\nRUN set -xe \\\n && apk --update --no-cache upgrade \\\n && apk add bash=4.4.19-r1 openssl=1.1.1k-r0 lksctp-tools=1.0.17-r0 --no-cache \\\n && rm -rf /root/.cache \\\n && rm -rf /var/cache/apk/*\nFROM beardedeagle/alpine-erlang-builder:22.0.4 AS deps_stage\nENV ELIXIR_VER=\"1.9.0\" \\\n    HEX_VER=\"0.20.1\" \\\n    REBAR3_VER=\"3.11.1\" \\\n    MIX_HOME=\"/usr/local/lib/elixir/.mix\" \\\n    TERM=\"xterm\" \\\n    LANG=\"C.UTF-8\"\nRUN set -xe \\\n && rm -rf /usr/local/bin/rebar \\\n && rm -rf /usr/local/bin/rebar3 \\\n && apk add autoconf=2.69-r2 binutils-gold=2.31.1-r2 curl=7.64.0-r5 curl-dev=7.64.0-r5 dpkg=1.19.2-r0 dpkg-dev=1.19.2-r0 g++=8.3.0-r0 gcc=8.3.0-r0 libc-dev=0.7.1-r0 linux-headers=4.18.13-r1 lksctp-tools-dev=1.0.17-r0 make=4.2.1-r2 musl=1.1.20-r6 musl-dev=1.1.20-r6 rsync=3.1.3-r1 tar=1.32-r0 --no-cache --virtual .build-deps\nFROM deps_stage AS elixir_stage\nRUN set -xe \\\n && ELIXIR_DOWNLOAD_URL=\"https://github.com/elixir-lang/elixir/archive/v${ELIXIR_VER}.tar.gz\" \\\n && ELIXIR_DOWNLOAD_SHA256=\"dbf4cb66634e22d60fe4aa162946c992257f700c7db123212e7e29d1c0b0c487\" \\\n && curl -fSL -o elixir-src.tar.gz \"$ELIXIR_DOWNLOAD_URL\" \\\n && echo \"$ELIXIR_DOWNLOAD_SHA256 elixir-src.tar.gz\" | sha256sum -c - \\\n && export ELIXIR_TOP=\"/usr/src/elixir_src_${ELIXIR_VER%%@*}\" \\\n && mkdir -vp $ELIXIR_TOP \\\n && tar -xzf elixir-src.tar.gz -C $ELIXIR_TOP --strip-components=1 \\\n && rm elixir-src.tar.gz \\\n && (cd $ELIXIR_TOP \\\n && make -j$( getconf _NPROCESSORS_ONLN ;) \\\n && make install clean ) \\\n && rm -rf $ELIXIR_TOP \\\n && find /usr/local -regex '/usr/local/lib/elixir/\\(lib/\\|erts-\\).*/\\(man\\|doc\\|obj\\|c_src\\|emacs\\|info\\|examples\\)' | xargs rm -rf \\\n && find /usr/local -name src | xargs -r find | grep -v '\\.hrl$' | xargs rm -v || true \\\n && find /usr/local -name src | xargs -r find | xargs rmdir -vp || true \\\n && scanelf --nobanner -E ET_EXEC -BF '%F' --recursive /usr/local | xargs -r strip --strip-all \\\n && scanelf --nobanner -E ET_DYN -BF '%F' --recursive /usr/local | xargs -r strip --strip-unneeded\nFROM elixir_stage AS hex_stage\nRUN set -xe \\\n && HEX_DOWNLOAD_URL=\"https://github.com/hexpm/hex/archive/v${HEX_VER}.tar.gz\" \\\n && HEX_DOWNLOAD_SHA256=\"6af8bda12e3c81d15b9d274c1ab2d6afd9a40e28c1db7bb50baf79b6a73bb3ea\" \\\n && curl -fSL -o hex-src.tar.gz \"$HEX_DOWNLOAD_URL\" \\\n && echo \"$HEX_DOWNLOAD_SHA256 hex-src.tar.gz\" | sha256sum -c - \\\n && mkdir -p /usr/src/hex-src \\\n && tar -xzf hex-src.tar.gz -C /usr/src/hex-src --strip-components=1 \\\n && rm hex-src.tar.gz \\\n && cd /usr/src/hex-src \\\n && MIX_ENV=prod mix install\nFROM elixir_stage AS rebar3_stage\nRUN set -xe \\\n && REBAR3_DOWNLOAD_URL=\"https://github.com/erlang/rebar3/archive/${REBAR3_VER}.tar.gz\" \\\n && REBAR3_DOWNLOAD_SHA256=\"a1822db5210b96b5f8ef10e433b22df19c5fc54dfd847bcaab86c65151ce4171\" \\\n && curl -fSL -o rebar3-src.tar.gz \"$REBAR3_DOWNLOAD_URL\" \\\n && echo \"$REBAR3_DOWNLOAD_SHA256 rebar3-src.tar.gz\" | sha256sum -c - \\\n && mkdir -p /usr/src/rebar3-src \\\n && tar -xzf rebar3-src.tar.gz -C /usr/src/rebar3-src --strip-components=1 \\\n && rm rebar3-src.tar.gz \\\n && cd /usr/src/rebar3-src \\\n && HOME=$PWD ./bootstrap \\\n && MIX_ENV=prod mix local.rebar rebar3 ./rebar3\nFROM deps_stage AS stage\nCOPY --from=elixir_stage /usr/local /opt/elixir\nCOPY --from=hex_stage /usr/local /opt/hex\nCOPY --from=rebar3_stage /usr/local /opt/rebar3\nRUN set -xe \\\n && rsync -a /opt/elixir/ /usr/local \\\n && rsync -a /opt/hex/ /usr/local \\\n && rsync -a /opt/rebar3/ /usr/local \\\n && apk del .build-deps \\\n && rm -rf /root/.cache \\\n && rm -rf /var/cache/apk/*\nFROM base_stage\nCOPY --from=stage /usr/local /usr/local\nRUN addgroup -S docker-user ; adduser -S -G docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM alpine:3.9.4 AS base_stage\nLABEL maintainer=\"beardedeagle <randy@heroictek.com>\"\n#  Important!  Update this no-op ENV variable when this Dockerfile\n#  is updated with the current date. It will force refresh of all\n#  of the base images.\nENV REFRESHED_AT=\"2019-06-24\" \\\n    ELIXIR_VER=\"1.9.0\" \\\n    HEX_VER=\"0.20.1\" \\\n    REBAR3_VER=\"3.11.1\" \\\n    MIX_HOME=\"/usr/local/lib/elixir/.mix\" \\\n    TERM=\"xterm\" \\\n    LANG=\"C.UTF-8\"\nRUN set -xe \\\n && apk --update --no-cache upgrade \\\n && apk add --no-cache bash openssl lksctp-tools \\\n && rm -rf /root/.cache \\\n && rm -rf /var/cache/apk/*\nFROM beardedeagle/alpine-erlang-builder:22.0.4 AS deps_stage\nENV ELIXIR_VER=\"1.9.0\" \\\n    HEX_VER=\"0.20.1\" \\\n    REBAR3_VER=\"3.11.1\" \\\n    MIX_HOME=\"/usr/local/lib/elixir/.mix\" \\\n    TERM=\"xterm\" \\\n    LANG=\"C.UTF-8\"\nRUN set -xe \\\n && rm -rf /usr/local/bin/rebar \\\n && rm -rf /usr/local/bin/rebar3 \\\n && apk add --no-cache --virtual .build-deps autoconf binutils-gold curl curl-dev dpkg dpkg-dev g++ gcc libc-dev linux-headers lksctp-tools-dev make musl musl-dev rsync tar\nFROM deps_stage AS elixir_stage\nRUN set -xe \\\n && ELIXIR_DOWNLOAD_URL=\"https://github.com/elixir-lang/elixir/archive/v${ELIXIR_VER}.tar.gz\" \\\n && ELIXIR_DOWNLOAD_SHA256=\"dbf4cb66634e22d60fe4aa162946c992257f700c7db123212e7e29d1c0b0c487\" \\\n && curl -fSL -o elixir-src.tar.gz \"$ELIXIR_DOWNLOAD_URL\" \\\n && echo \"$ELIXIR_DOWNLOAD_SHA256 elixir-src.tar.gz\" | sha256sum -c - \\\n && export ELIXIR_TOP=\"/usr/src/elixir_src_${ELIXIR_VER%%@*}\" \\\n && mkdir -vp $ELIXIR_TOP \\\n && tar -xzf elixir-src.tar.gz -C $ELIXIR_TOP --strip-components=1 \\\n && rm elixir-src.tar.gz \\\n && (cd $ELIXIR_TOP \\\n && make -j$( getconf _NPROCESSORS_ONLN ;) \\\n && make install clean ) \\\n && rm -rf $ELIXIR_TOP \\\n && find /usr/local -regex '/usr/local/lib/elixir/\\(lib/\\|erts-\\).*/\\(man\\|doc\\|obj\\|c_src\\|emacs\\|info\\|examples\\)' | xargs rm -rf \\\n && find /usr/local -name src | xargs -r find | grep -v '\\.hrl$' | xargs rm -v || true \\\n && find /usr/local -name src | xargs -r find | xargs rmdir -vp || true \\\n && scanelf --nobanner -E ET_EXEC -BF '%F' --recursive /usr/local | xargs -r strip --strip-all \\\n && scanelf --nobanner -E ET_DYN -BF '%F' --recursive /usr/local | xargs -r strip --strip-unneeded\nFROM elixir_stage AS hex_stage\nRUN set -xe \\\n && HEX_DOWNLOAD_URL=\"https://github.com/hexpm/hex/archive/v${HEX_VER}.tar.gz\" \\\n && HEX_DOWNLOAD_SHA256=\"6af8bda12e3c81d15b9d274c1ab2d6afd9a40e28c1db7bb50baf79b6a73bb3ea\" \\\n && curl -fSL -o hex-src.tar.gz \"$HEX_DOWNLOAD_URL\" \\\n && echo \"$HEX_DOWNLOAD_SHA256 hex-src.tar.gz\" | sha256sum -c - \\\n && mkdir -p /usr/src/hex-src \\\n && tar -xzf hex-src.tar.gz -C /usr/src/hex-src --strip-components=1 \\\n && rm hex-src.tar.gz \\\n && cd /usr/src/hex-src \\\n && MIX_ENV=prod mix install\nFROM elixir_stage AS rebar3_stage\nRUN set -xe \\\n && REBAR3_DOWNLOAD_URL=\"https://github.com/erlang/rebar3/archive/${REBAR3_VER}.tar.gz\" \\\n && REBAR3_DOWNLOAD_SHA256=\"a1822db5210b96b5f8ef10e433b22df19c5fc54dfd847bcaab86c65151ce4171\" \\\n && curl -fSL -o rebar3-src.tar.gz \"$REBAR3_DOWNLOAD_URL\" \\\n && echo \"$REBAR3_DOWNLOAD_SHA256 rebar3-src.tar.gz\" | sha256sum -c - \\\n && mkdir -p /usr/src/rebar3-src \\\n && tar -xzf rebar3-src.tar.gz -C /usr/src/rebar3-src --strip-components=1 \\\n && rm rebar3-src.tar.gz \\\n && cd /usr/src/rebar3-src \\\n && HOME=$PWD ./bootstrap \\\n && MIX_ENV=prod mix local.rebar rebar3 ./rebar3\nFROM deps_stage AS stage\nCOPY --from=elixir_stage /usr/local /opt/elixir\nCOPY --from=hex_stage /usr/local /opt/hex\nCOPY --from=rebar3_stage /usr/local /opt/rebar3\nRUN set -xe \\\n && rsync -a /opt/elixir/ /usr/local \\\n && rsync -a /opt/hex/ /usr/local \\\n && rsync -a /opt/rebar3/ /usr/local \\\n && apk del .build-deps \\\n && rm -rf /root/.cache \\\n && rm -rf /var/cache/apk/*\nFROM base_stage\nCOPY --from=stage /usr/local /usr/local\n","injectedSmells":[],"originalDockerfileHash":"65f42fed8f1836aa214d670614339ad2","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM alpine:3.9.4 AS base_stage\nLABEL maintainer=\"beardedeagle <randy@heroictek.com>\"\n#   Important!  Update this no-op ENV variable when this Dockerfile\n#   is updated with the current date. It will force refresh of all\n#   of the base images.\nENV REFRESHED_AT=\"2019-06-24\" \\\n    ELIXIR_VER=\"1.9.0\" \\\n    HEX_VER=\"0.20.1\" \\\n    REBAR3_VER=\"3.11.1\" \\\n    MIX_HOME=\"/usr/local/lib/elixir/.mix\" \\\n    TERM=\"xterm\" \\\n    LANG=\"C.UTF-8\"\nRUN set -xe \\\n && apk --update --no-cache upgrade \\\n && apk add --no-cache bash openssl lksctp-tools \\\n && rm -rf /root/.cache \\\n && rm -rf /var/cache/apk/*\nFROM beardedeagle/alpine-erlang-builder:22.0.4 AS deps_stage\nENV ELIXIR_VER=\"1.9.0\" \\\n    HEX_VER=\"0.20.1\" \\\n    REBAR3_VER=\"3.11.1\" \\\n    MIX_HOME=\"/usr/local/lib/elixir/.mix\" \\\n    TERM=\"xterm\" \\\n    LANG=\"C.UTF-8\"\nRUN set -xe \\\n && rm -rf /usr/local/bin/rebar \\\n && rm -rf /usr/local/bin/rebar3 \\\n && apk add --no-cache --virtual .build-deps autoconf binutils-gold curl curl-dev dpkg dpkg-dev g++ gcc libc-dev linux-headers lksctp-tools-dev make musl musl-dev rsync tar\nFROM deps_stage AS elixir_stage\nRUN set -xe \\\n && ELIXIR_DOWNLOAD_URL=\"https://github.com/elixir-lang/elixir/archive/v${ELIXIR_VER}.tar.gz\" \\\n && ELIXIR_DOWNLOAD_SHA256=\"dbf4cb66634e22d60fe4aa162946c992257f700c7db123212e7e29d1c0b0c487\" \\\n && curl -fSL -o elixir-src.tar.gz \"$ELIXIR_DOWNLOAD_URL\" \\\n && echo \"$ELIXIR_DOWNLOAD_SHA256 elixir-src.tar.gz\" | sha256sum -c - \\\n && export ELIXIR_TOP=\"/usr/src/elixir_src_${ELIXIR_VER%%@*}\" \\\n && mkdir -vp $ELIXIR_TOP \\\n && tar -xzf elixir-src.tar.gz -C $ELIXIR_TOP --strip-components=1 \\\n && rm elixir-src.tar.gz \\\n && (cd $ELIXIR_TOP \\\n && make -j$( getconf _NPROCESSORS_ONLN ;) \\\n && make install clean ) \\\n && rm -rf $ELIXIR_TOP \\\n && find /usr/local -regex '/usr/local/lib/elixir/\\(lib/\\|erts-\\).*/\\(man\\|doc\\|obj\\|c_src\\|emacs\\|info\\|examples\\)' | xargs rm -rf \\\n && find /usr/local -name src | xargs -r find | grep -v '\\.hrl$' | xargs rm -v || true \\\n && find /usr/local -name src | xargs -r find | xargs rmdir -vp || true \\\n && scanelf --nobanner -E ET_EXEC -BF '%F' --recursive /usr/local | xargs -r strip --strip-all \\\n && scanelf --nobanner -E ET_DYN -BF '%F' --recursive /usr/local | xargs -r strip --strip-unneeded\nFROM elixir_stage AS hex_stage\nRUN set -xe \\\n && HEX_DOWNLOAD_URL=\"https://github.com/hexpm/hex/archive/v${HEX_VER}.tar.gz\" \\\n && HEX_DOWNLOAD_SHA256=\"6af8bda12e3c81d15b9d274c1ab2d6afd9a40e28c1db7bb50baf79b6a73bb3ea\" \\\n && curl -fSL -o hex-src.tar.gz \"$HEX_DOWNLOAD_URL\" \\\n && echo \"$HEX_DOWNLOAD_SHA256 hex-src.tar.gz\" | sha256sum -c - \\\n && mkdir -p /usr/src/hex-src \\\n && tar -xzf hex-src.tar.gz -C /usr/src/hex-src --strip-components=1 \\\n && rm hex-src.tar.gz \\\n && cd /usr/src/hex-src \\\n && MIX_ENV=prod mix install\nFROM elixir_stage AS rebar3_stage\nRUN set -xe \\\n && REBAR3_DOWNLOAD_URL=\"https://github.com/erlang/rebar3/archive/${REBAR3_VER}.tar.gz\" \\\n && REBAR3_DOWNLOAD_SHA256=\"a1822db5210b96b5f8ef10e433b22df19c5fc54dfd847bcaab86c65151ce4171\" \\\n && curl -fSL -o rebar3-src.tar.gz \"$REBAR3_DOWNLOAD_URL\" \\\n && echo \"$REBAR3_DOWNLOAD_SHA256 rebar3-src.tar.gz\" | sha256sum -c - \\\n && mkdir -p /usr/src/rebar3-src \\\n && tar -xzf rebar3-src.tar.gz -C /usr/src/rebar3-src --strip-components=1 \\\n && rm rebar3-src.tar.gz \\\n && cd /usr/src/rebar3-src \\\n && HOME=$PWD ./bootstrap \\\n && MIX_ENV=prod mix local.rebar rebar3 ./rebar3\nFROM deps_stage AS stage\nCOPY --from=elixir_stage /usr/local /opt/elixir\nCOPY --from=hex_stage /usr/local /opt/hex\nCOPY --from=rebar3_stage /usr/local /opt/rebar3\nRUN set -xe \\\n && rsync -a /opt/elixir/ /usr/local \\\n && rsync -a /opt/hex/ /usr/local \\\n && rsync -a /opt/rebar3/ /usr/local \\\n && apk del .build-deps \\\n && rm -rf /root/.cache \\\n && rm -rf /var/cache/apk/*\nFROM base_stage\nCOPY --from=stage /usr/local /usr/local\n","originalDockerfileUglifiedHash":"cfa77cc48be55cb2a18e762b2b246ab7","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/b1b1ee7b1159649c54bd8ffc0bc7ab68db5d8fb7.dockerfile"}