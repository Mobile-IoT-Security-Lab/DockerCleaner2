{"seed":1514106493,"processedDockerfileHash":"c5f9a8e245d49700e1f4785d033134af","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-pip","have-a-healthcheck","have-a-user"],"processedDockerfile":"#   This Source Code Form is subject to the terms of the Mozilla Public\n#   License, v. 2.0. If a copy of the MPL was not distributed with this\n#   file, You can obtain one at http://mozilla.org/MPL/2.0/.\n#   Copyright (c) 2014 Mozilla Corporation\n#\nFROM centos:7\nLABEL maintainer=\"mozdef@mozilla.com\"\nENV NODE_VERSION=\"4.7.0\"\nENV METEOR_VERSION=\"1.4.2.3\"\nENV PYTHON_VERSION=\"2.7.11\"\nENV KIBANA_VERSION=\"5.6.7\"\nENV ES_VERSION=\"5.6.7\"\nENV ES_JAVA_VERSION=\"1.8.0\"\nENV RABBITMQ_VERSION=\"3.3.5\"\nENV MONGO_URL=\"mongodb://localhost:3002/meteor\"\nENV ROOT_URL=\"http://localhost\"\nENV PORT=\"3000\"\nCOPY docker/conf/mongodb.repo /etc/yum.repos.d/mongodb.repo\n#   Install ES, RabbitMQ, nginx, Kibana, python, Node, Meteor\nRUN yum clean all \\\n && yum install -y epel-release \\\n && yum install -y wget java-$ES_JAVA_VERSION glibc-devel gcc gcc-c++ libstdc++ supervisor libffi-devel zlib-devel cronie \\\n && useradd -ms /bin/bash -d /opt/mozdef -m mozdef \\\n && mkdir /opt/mozdef/envs \\\n && curl -s -L https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-$ES_VERSION.tar.gz | tar -C /opt/mozdef -xz \\\n && mv /opt/mozdef/elasticsearch-$ES_VERSION /opt/mozdef/envs/elasticsearch \\\n && chown -R mozdef:mozdef /opt/mozdef/envs/elasticsearch \\\n && mkdir /var/log/elasticsearch \\\n && chown -R mozdef:mozdef /var/log/elasticsearch \\\n && mkdir /var/lib/elasticsearch \\\n && chown -R mozdef:mozdef /var/lib/elasticsearch \\\n && rpm --import https://www.rabbitmq.com/rabbitmq-release-signing-key.asc \\\n && yum install -y rabbitmq-server-$RABBITMQ_VERSION \\\n && yum install -y nginx \\\n && mkdir /var/log/mozdef/ \\\n && curl -s -L https://artifacts.elastic.co/downloads/kibana/kibana-$KIBANA_VERSION-linux-x86_64.tar.gz | tar -C /opt/mozdef/ -xz \\\n && mv /opt/mozdef/kibana-$KIBANA_VERSION-linux-x86_64 /opt/mozdef/envs/kibana \\\n && yum install -y mongodb-org \\\n && curl -s -L https://www.python.org/ftp/python/$PYTHON_VERSION/Python-$PYTHON_VERSION.tgz | tar -C /opt/mozdef/ -xz \\\n && cd /opt/mozdef/Python-$PYTHON_VERSION \\\n && ./configure \\\n && make \\\n && make install \\\n && rm -r /opt/mozdef/Python-$PYTHON_VERSION \\\n && cd /opt/mozdef \\\n && yum install -y mysql-devel python-devel python-pip \\\n && chown -R mozdef:mozdef /opt/mozdef/ \\\n && pip install virtualenv==20.21.0 \\\n && cd / \\\n && curl -sL -o /opt/mozdef/nodesource.rpm https://rpm.nodesource.com/pub_4.x/el/7/x86_64/nodesource-release-el7-1.noarch.rpm \\\n && rpm -i --nosignature --force /opt/mozdef/nodesource.rpm \\\n && yum install -y nodejs-$NODE_VERSION \\\n && mkdir /opt/mozdef/meteor \\\n && curl -sL -o /opt/mozdef/meteor.tar.gz https://static-meteor.netdna-ssl.com/packages-bootstrap/$METEOR_VERSION/meteor-bootstrap-os.linux.x86_64.tar.gz \\\n && tar -xzf /opt/mozdef/meteor.tar.gz -C /opt/mozdef/meteor \\\n && mv /opt/mozdef/meteor/.meteor /opt/mozdef \\\n && rm -r /opt/mozdef/meteor \\\n && cp /opt/mozdef/.meteor/packages/meteor-tool/*/mt-os.linux.x86_64/scripts/admin/launch-meteor /usr/bin/meteor\nUSER mozdef\nCOPY meteor /opt/mozdef/envs/mozdef/meteor\nUSER root\nRUN chown -R mozdef:mozdef /opt/mozdef/envs/mozdef/meteor\nCOPY docker/conf/settings.js /opt/mozdef/envs/mozdef/meteor/app/lib/settings.js\nRUN chown -R mozdef:mozdef /opt/mozdef/envs/mozdef/meteor/app/lib/settings.js\nUSER mozdef\nRUN mkdir -p /opt/mozdef/envs/meteor/mozdef \\\n && cd /opt/mozdef/envs/mozdef/meteor \\\n && meteor npm install \\\n && meteor build --server localhost:3002 --directory /opt/mozdef/envs/meteor/mozdef/ \\\n && mv /opt/mozdef/envs/mozdef/meteor/node_modules /opt/mozdef/envs/meteor/mozdef/node_modules\n#   Create python virtual environment and install dependencies\nCOPY requirements.txt /opt/mozdef/envs/mozdef/requirements.txt\nRUN virtualenv /opt/mozdef/envs/python \\\n && source /opt/mozdef/envs/python/bin/activate \\\n && pip install -r /opt/mozdef/envs/mozdef/requirements.txt\nUSER root\nCOPY docker/conf/elasticsearch.yml /opt/mozdef/envs/elasticsearch/config/\nCOPY docker/conf/jvm.options /opt/mozdef/envs/elasticsearch/config/\nCOPY docker/conf/kibana.yml /opt/mozdef/envs/kibana/config/kibana.yml\nCOPY docker/conf/supervisor.conf /etc/supervisor/conf.d/supervisor.conf\nCOPY docker/conf/mongod.conf /etc/mongod.conf\nCOPY docker/conf/rabbitmq.config /etc/rabbitmq/\nCOPY docker/conf/enabled_plugins /etc/rabbitmq/\nCOPY docker/conf/nginx.conf /etc/nginx/nginx.conf\nCOPY static /opt/mozdef/envs/mozdef/static\nCOPY rest /opt/mozdef/envs/mozdef/rest\nCOPY loginput /opt/mozdef/envs/mozdef/loginput\nCOPY bot /opt/mozdef/envs/mozdef/bot\nCOPY lib /opt/mozdef/envs/mozdef/lib\nCOPY cron /opt/mozdef/envs/mozdef/cron\nCOPY alerts /opt/mozdef/envs/mozdef/alerts\nCOPY mq /opt/mozdef/envs/mozdef/mq\nCOPY docker/conf/loginput_index.conf /opt/mozdef/envs/mozdef/loginput/index.conf\nCOPY docker/conf/rest_index.conf /opt/mozdef/envs/mozdef/rest/index.conf\nCOPY docker/conf/config.py /opt/mozdef/envs/mozdef/alerts/lib/config.py\nCOPY docker/conf/cron_entries.txt /cron_entries.txt\nUSER mozdef\nRUN crontab /cron_entries.txt\nUSER root\nRUN mkdir /opt/mozdef/envs/mozdef/data \\\n && mkdir /opt/mozdef/envs/mozdef/config \\\n && mkdir -p /opt/mozdef/envs/mozdef/docker/conf\nCOPY docker/conf/initial_setup.py /opt/mozdef/envs/mozdef/docker/conf/initial_setup.py\n#   We have to replace the python virtualenv path until\n#   https://github.com/mozilla/MozDef/issues/421 is fixed\nRUN sed -i 's|/opt/mozdef/envs/mozdef/bin/activate|/opt/mozdef/envs/python/bin/activate|g' /opt/mozdef/envs/mozdef/cron/*.sh\nRUN chown -R mozdef:mozdef /opt/mozdef/envs/mozdef\n#   VOLUMES\n#    Elasticsearch\nVOLUME /var/lib/elasticsearch\n#    Mongodb\nVOLUME /var/lib/mongo\n#   RabbitMQ\nVOLUME /var/lib/rabbitmq\n#   MozDef data (geolite db for example)\nVOLUME /opt/mozdef/envs/mozdef/data\n#   80 = MozDef Web UI (meteor)\n#   3002 = Mongodb\n#   5672 = RabbitMQ\n#   15672 = RabbitMQ Management\n#   8080 = Loginput\n#   8081 = RestAPI\n#   9090 = Kibana Web UI \"localhost:9090/app/kibana\"\n#   9200 = Elasticsearch\nEXPOSE 80/tcp 3002/tcp 5672/tcp 15672/tcp 8080/tcp 8081/tcp 9090/tcp 9200/tcp\nCMD supervisord -n -c /etc/supervisor/conf.d/supervisor.conf\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  This Source Code Form is subject to the terms of the Mozilla Public\n#  License, v. 2.0. If a copy of the MPL was not distributed with this\n#  file, You can obtain one at http://mozilla.org/MPL/2.0/.\n#  Copyright (c) 2014 Mozilla Corporation\n#\nFROM centos:7\nLABEL maintainer=\"mozdef@mozilla.com\"\nENV NODE_VERSION=\"4.7.0\"\nENV METEOR_VERSION=\"1.4.2.3\"\nENV PYTHON_VERSION=\"2.7.11\"\nENV KIBANA_VERSION=\"5.6.7\"\nENV ES_VERSION=\"5.6.7\"\nENV ES_JAVA_VERSION=\"1.8.0\"\nENV RABBITMQ_VERSION=\"3.3.5\"\nENV MONGO_URL=\"mongodb://localhost:3002/meteor\"\nENV ROOT_URL=\"http://localhost\"\nENV PORT=\"3000\"\nCOPY docker/conf/mongodb.repo /etc/yum.repos.d/mongodb.repo\n#  Install ES, RabbitMQ, nginx, Kibana, python, Node, Meteor\nRUN yum clean all \\\n && yum install -y epel-release \\\n && yum install -y wget java-$ES_JAVA_VERSION glibc-devel gcc gcc-c++ libstdc++ supervisor libffi-devel zlib-devel cronie \\\n && useradd -ms /bin/bash -d /opt/mozdef -m mozdef \\\n && mkdir /opt/mozdef/envs \\\n && curl -s -L https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-$ES_VERSION.tar.gz | tar -C /opt/mozdef -xz \\\n && mv /opt/mozdef/elasticsearch-$ES_VERSION /opt/mozdef/envs/elasticsearch \\\n && chown -R mozdef:mozdef /opt/mozdef/envs/elasticsearch \\\n && mkdir /var/log/elasticsearch \\\n && chown -R mozdef:mozdef /var/log/elasticsearch \\\n && mkdir /var/lib/elasticsearch \\\n && chown -R mozdef:mozdef /var/lib/elasticsearch \\\n && rpm --import https://www.rabbitmq.com/rabbitmq-release-signing-key.asc \\\n && yum install -y rabbitmq-server-$RABBITMQ_VERSION \\\n && yum install -y nginx \\\n && mkdir /var/log/mozdef/ \\\n && curl -s -L https://artifacts.elastic.co/downloads/kibana/kibana-$KIBANA_VERSION-linux-x86_64.tar.gz | tar -C /opt/mozdef/ -xz \\\n && mv /opt/mozdef/kibana-$KIBANA_VERSION-linux-x86_64 /opt/mozdef/envs/kibana \\\n && yum install -y mongodb-org \\\n && curl -s -L https://www.python.org/ftp/python/$PYTHON_VERSION/Python-$PYTHON_VERSION.tgz | tar -C /opt/mozdef/ -xz \\\n && cd /opt/mozdef/Python-$PYTHON_VERSION \\\n && ./configure \\\n && make \\\n && make install \\\n && rm -r /opt/mozdef/Python-$PYTHON_VERSION \\\n && cd /opt/mozdef \\\n && yum install -y mysql-devel python-devel python-pip \\\n && chown -R mozdef:mozdef /opt/mozdef/ \\\n && pip install virtualenv \\\n && cd / \\\n && curl -sL -o /opt/mozdef/nodesource.rpm https://rpm.nodesource.com/pub_4.x/el/7/x86_64/nodesource-release-el7-1.noarch.rpm \\\n && rpm -i --nosignature --force /opt/mozdef/nodesource.rpm \\\n && yum install -y nodejs-$NODE_VERSION \\\n && mkdir /opt/mozdef/meteor \\\n && curl -sL -o /opt/mozdef/meteor.tar.gz https://static-meteor.netdna-ssl.com/packages-bootstrap/$METEOR_VERSION/meteor-bootstrap-os.linux.x86_64.tar.gz \\\n && tar -xzf /opt/mozdef/meteor.tar.gz -C /opt/mozdef/meteor \\\n && mv /opt/mozdef/meteor/.meteor /opt/mozdef \\\n && rm -r /opt/mozdef/meteor \\\n && cp /opt/mozdef/.meteor/packages/meteor-tool/*/mt-os.linux.x86_64/scripts/admin/launch-meteor /usr/bin/meteor\nUSER mozdef\nCOPY meteor /opt/mozdef/envs/mozdef/meteor\nUSER root\nRUN chown -R mozdef:mozdef /opt/mozdef/envs/mozdef/meteor\nCOPY docker/conf/settings.js /opt/mozdef/envs/mozdef/meteor/app/lib/settings.js\nRUN chown -R mozdef:mozdef /opt/mozdef/envs/mozdef/meteor/app/lib/settings.js\nUSER mozdef\nRUN mkdir -p /opt/mozdef/envs/meteor/mozdef \\\n && cd /opt/mozdef/envs/mozdef/meteor \\\n && meteor npm install \\\n && meteor build --server localhost:3002 --directory /opt/mozdef/envs/meteor/mozdef/ \\\n && mv /opt/mozdef/envs/mozdef/meteor/node_modules /opt/mozdef/envs/meteor/mozdef/node_modules\n#  Create python virtual environment and install dependencies\nCOPY requirements.txt /opt/mozdef/envs/mozdef/requirements.txt\nRUN virtualenv /opt/mozdef/envs/python \\\n && source /opt/mozdef/envs/python/bin/activate \\\n && pip install -r /opt/mozdef/envs/mozdef/requirements.txt\nUSER root\nCOPY docker/conf/elasticsearch.yml /opt/mozdef/envs/elasticsearch/config/\nCOPY docker/conf/jvm.options /opt/mozdef/envs/elasticsearch/config/\nCOPY docker/conf/kibana.yml /opt/mozdef/envs/kibana/config/kibana.yml\nCOPY docker/conf/supervisor.conf /etc/supervisor/conf.d/supervisor.conf\nCOPY docker/conf/mongod.conf /etc/mongod.conf\nCOPY docker/conf/rabbitmq.config /etc/rabbitmq/\nCOPY docker/conf/enabled_plugins /etc/rabbitmq/\nCOPY docker/conf/nginx.conf /etc/nginx/nginx.conf\nCOPY static /opt/mozdef/envs/mozdef/static\nCOPY rest /opt/mozdef/envs/mozdef/rest\nCOPY loginput /opt/mozdef/envs/mozdef/loginput\nCOPY bot /opt/mozdef/envs/mozdef/bot\nCOPY lib /opt/mozdef/envs/mozdef/lib\nCOPY cron /opt/mozdef/envs/mozdef/cron\nCOPY alerts /opt/mozdef/envs/mozdef/alerts\nCOPY mq /opt/mozdef/envs/mozdef/mq\nCOPY docker/conf/loginput_index.conf /opt/mozdef/envs/mozdef/loginput/index.conf\nCOPY docker/conf/rest_index.conf /opt/mozdef/envs/mozdef/rest/index.conf\nCOPY docker/conf/config.py /opt/mozdef/envs/mozdef/alerts/lib/config.py\nCOPY docker/conf/cron_entries.txt /cron_entries.txt\nUSER mozdef\nRUN crontab /cron_entries.txt\nUSER root\nRUN mkdir /opt/mozdef/envs/mozdef/data \\\n && mkdir /opt/mozdef/envs/mozdef/config \\\n && mkdir -p /opt/mozdef/envs/mozdef/docker/conf\nCOPY docker/conf/initial_setup.py /opt/mozdef/envs/mozdef/docker/conf/initial_setup.py\n#  We have to replace the python virtualenv path until\n#  https://github.com/mozilla/MozDef/issues/421 is fixed\nRUN sed -i 's|/opt/mozdef/envs/mozdef/bin/activate|/opt/mozdef/envs/python/bin/activate|g' /opt/mozdef/envs/mozdef/cron/*.sh\nRUN chown -R mozdef:mozdef /opt/mozdef/envs/mozdef\n#  VOLUMES\n#   Elasticsearch\nVOLUME /var/lib/elasticsearch\n#   Mongodb\nVOLUME /var/lib/mongo\n#  RabbitMQ\nVOLUME /var/lib/rabbitmq\n#  MozDef data (geolite db for example)\nVOLUME /opt/mozdef/envs/mozdef/data\n#  80 = MozDef Web UI (meteor)\n#  3002 = Mongodb\n#  5672 = RabbitMQ\n#  15672 = RabbitMQ Management\n#  8080 = Loginput\n#  8081 = RestAPI\n#  9090 = Kibana Web UI \"localhost:9090/app/kibana\"\n#  9200 = Elasticsearch\nEXPOSE 80/tcp 3002/tcp 5672/tcp 15672/tcp 8080/tcp 8081/tcp 9090/tcp 9200/tcp\nCMD supervisord -n -c /etc/supervisor/conf.d/supervisor.conf\n","injectedSmells":[],"originalDockerfileHash":"945fd576337288c2d4bd6eb85a3f6e7d","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   This Source Code Form is subject to the terms of the Mozilla Public\n#   License, v. 2.0. If a copy of the MPL was not distributed with this\n#   file, You can obtain one at http://mozilla.org/MPL/2.0/.\n#   Copyright (c) 2014 Mozilla Corporation\n#\nFROM centos:7\nLABEL maintainer=\"mozdef@mozilla.com\"\nENV NODE_VERSION=\"4.7.0\"\nENV METEOR_VERSION=\"1.4.2.3\"\nENV PYTHON_VERSION=\"2.7.11\"\nENV KIBANA_VERSION=\"5.6.7\"\nENV ES_VERSION=\"5.6.7\"\nENV ES_JAVA_VERSION=\"1.8.0\"\nENV RABBITMQ_VERSION=\"3.3.5\"\nENV MONGO_URL=\"mongodb://localhost:3002/meteor\"\nENV ROOT_URL=\"http://localhost\"\nENV PORT=\"3000\"\nCOPY docker/conf/mongodb.repo /etc/yum.repos.d/mongodb.repo\n#   Install ES, RabbitMQ, nginx, Kibana, python, Node, Meteor\nRUN yum clean all \\\n && yum install -y epel-release \\\n && yum install -y wget java-$ES_JAVA_VERSION glibc-devel gcc gcc-c++ libstdc++ supervisor libffi-devel zlib-devel cronie \\\n && useradd -ms /bin/bash -d /opt/mozdef -m mozdef \\\n && mkdir /opt/mozdef/envs \\\n && curl -s -L https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-$ES_VERSION.tar.gz | tar -C /opt/mozdef -xz \\\n && mv /opt/mozdef/elasticsearch-$ES_VERSION /opt/mozdef/envs/elasticsearch \\\n && chown -R mozdef:mozdef /opt/mozdef/envs/elasticsearch \\\n && mkdir /var/log/elasticsearch \\\n && chown -R mozdef:mozdef /var/log/elasticsearch \\\n && mkdir /var/lib/elasticsearch \\\n && chown -R mozdef:mozdef /var/lib/elasticsearch \\\n && rpm --import https://www.rabbitmq.com/rabbitmq-release-signing-key.asc \\\n && yum install -y rabbitmq-server-$RABBITMQ_VERSION \\\n && yum install -y nginx \\\n && mkdir /var/log/mozdef/ \\\n && curl -s -L https://artifacts.elastic.co/downloads/kibana/kibana-$KIBANA_VERSION-linux-x86_64.tar.gz | tar -C /opt/mozdef/ -xz \\\n && mv /opt/mozdef/kibana-$KIBANA_VERSION-linux-x86_64 /opt/mozdef/envs/kibana \\\n && yum install -y mongodb-org \\\n && curl -s -L https://www.python.org/ftp/python/$PYTHON_VERSION/Python-$PYTHON_VERSION.tgz | tar -C /opt/mozdef/ -xz \\\n && cd /opt/mozdef/Python-$PYTHON_VERSION \\\n && ./configure \\\n && make \\\n && make install \\\n && rm -r /opt/mozdef/Python-$PYTHON_VERSION \\\n && cd /opt/mozdef \\\n && yum install -y mysql-devel python-devel python-pip \\\n && chown -R mozdef:mozdef /opt/mozdef/ \\\n && pip install virtualenv \\\n && cd / \\\n && curl -sL -o /opt/mozdef/nodesource.rpm https://rpm.nodesource.com/pub_4.x/el/7/x86_64/nodesource-release-el7-1.noarch.rpm \\\n && rpm -i --nosignature --force /opt/mozdef/nodesource.rpm \\\n && yum install -y nodejs-$NODE_VERSION \\\n && mkdir /opt/mozdef/meteor \\\n && curl -sL -o /opt/mozdef/meteor.tar.gz https://static-meteor.netdna-ssl.com/packages-bootstrap/$METEOR_VERSION/meteor-bootstrap-os.linux.x86_64.tar.gz \\\n && tar -xzf /opt/mozdef/meteor.tar.gz -C /opt/mozdef/meteor \\\n && mv /opt/mozdef/meteor/.meteor /opt/mozdef \\\n && rm -r /opt/mozdef/meteor \\\n && cp /opt/mozdef/.meteor/packages/meteor-tool/*/mt-os.linux.x86_64/scripts/admin/launch-meteor /usr/bin/meteor\nUSER mozdef\nCOPY meteor /opt/mozdef/envs/mozdef/meteor\nUSER root\nRUN chown -R mozdef:mozdef /opt/mozdef/envs/mozdef/meteor\nCOPY docker/conf/settings.js /opt/mozdef/envs/mozdef/meteor/app/lib/settings.js\nRUN chown -R mozdef:mozdef /opt/mozdef/envs/mozdef/meteor/app/lib/settings.js\nUSER mozdef\nRUN mkdir -p /opt/mozdef/envs/meteor/mozdef \\\n && cd /opt/mozdef/envs/mozdef/meteor \\\n && meteor npm install \\\n && meteor build --server localhost:3002 --directory /opt/mozdef/envs/meteor/mozdef/ \\\n && mv /opt/mozdef/envs/mozdef/meteor/node_modules /opt/mozdef/envs/meteor/mozdef/node_modules\n#   Create python virtual environment and install dependencies\nCOPY requirements.txt /opt/mozdef/envs/mozdef/requirements.txt\nRUN virtualenv /opt/mozdef/envs/python \\\n && source /opt/mozdef/envs/python/bin/activate \\\n && pip install -r /opt/mozdef/envs/mozdef/requirements.txt\nUSER root\nCOPY docker/conf/elasticsearch.yml /opt/mozdef/envs/elasticsearch/config/\nCOPY docker/conf/jvm.options /opt/mozdef/envs/elasticsearch/config/\nCOPY docker/conf/kibana.yml /opt/mozdef/envs/kibana/config/kibana.yml\nCOPY docker/conf/supervisor.conf /etc/supervisor/conf.d/supervisor.conf\nCOPY docker/conf/mongod.conf /etc/mongod.conf\nCOPY docker/conf/rabbitmq.config /etc/rabbitmq/\nCOPY docker/conf/enabled_plugins /etc/rabbitmq/\nCOPY docker/conf/nginx.conf /etc/nginx/nginx.conf\nCOPY static /opt/mozdef/envs/mozdef/static\nCOPY rest /opt/mozdef/envs/mozdef/rest\nCOPY loginput /opt/mozdef/envs/mozdef/loginput\nCOPY bot /opt/mozdef/envs/mozdef/bot\nCOPY lib /opt/mozdef/envs/mozdef/lib\nCOPY cron /opt/mozdef/envs/mozdef/cron\nCOPY alerts /opt/mozdef/envs/mozdef/alerts\nCOPY mq /opt/mozdef/envs/mozdef/mq\nCOPY docker/conf/loginput_index.conf /opt/mozdef/envs/mozdef/loginput/index.conf\nCOPY docker/conf/rest_index.conf /opt/mozdef/envs/mozdef/rest/index.conf\nCOPY docker/conf/config.py /opt/mozdef/envs/mozdef/alerts/lib/config.py\nCOPY docker/conf/cron_entries.txt /cron_entries.txt\nUSER mozdef\nRUN crontab /cron_entries.txt\nUSER root\nRUN mkdir /opt/mozdef/envs/mozdef/data \\\n && mkdir /opt/mozdef/envs/mozdef/config \\\n && mkdir -p /opt/mozdef/envs/mozdef/docker/conf\nCOPY docker/conf/initial_setup.py /opt/mozdef/envs/mozdef/docker/conf/initial_setup.py\n#   We have to replace the python virtualenv path until\n#   https://github.com/mozilla/MozDef/issues/421 is fixed\nRUN sed -i 's|/opt/mozdef/envs/mozdef/bin/activate|/opt/mozdef/envs/python/bin/activate|g' /opt/mozdef/envs/mozdef/cron/*.sh\nRUN chown -R mozdef:mozdef /opt/mozdef/envs/mozdef\n#   VOLUMES\n#    Elasticsearch\nVOLUME /var/lib/elasticsearch\n#    Mongodb\nVOLUME /var/lib/mongo\n#   RabbitMQ\nVOLUME /var/lib/rabbitmq\n#   MozDef data (geolite db for example)\nVOLUME /opt/mozdef/envs/mozdef/data\n#   80 = MozDef Web UI (meteor)\n#   3002 = Mongodb\n#   5672 = RabbitMQ\n#   15672 = RabbitMQ Management\n#   8080 = Loginput\n#   8081 = RestAPI\n#   9090 = Kibana Web UI \"localhost:9090/app/kibana\"\n#   9200 = Elasticsearch\nEXPOSE 80/tcp 3002/tcp 5672/tcp 15672/tcp 8080/tcp 8081/tcp 9090/tcp 9200/tcp\nCMD supervisord -n -c /etc/supervisor/conf.d/supervisor.conf\n","originalDockerfileUglifiedHash":"fe81e25fe5c7d80f48957060b6c11a68","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/2069be4bbe7a704e8d5fad06c2120ba19f1c804b.dockerfile"}