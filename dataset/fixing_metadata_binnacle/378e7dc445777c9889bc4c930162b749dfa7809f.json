{"seed":228997471,"processedDockerfileHash":"334bcfa9660650c42ae389870bad0e58","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","have-a-healthcheck","have-a-user"],"processedDockerfile":"#   This Dockerfile is used to build an image containing basic stuff to be used as a Jenkins slave build node.\nFROM ubuntu:18.04\nLABEL Description=\" This image is for building Jenkins Slave with Azure CLi and Ansible\"\nUSER root\n#   Make sure apt is happy\nENV DEBIAN_FRONTEND=\"noninteractive\"\nRUN :\n#   Install a basic SSH server\nRUN (apt-get update ;apt-get install --no-install-recommends openssh-server=1:7.6p1-4ubuntu0.7 -y )\nRUN mkdir -p /var/run/sshd\n#   Install JDK 8 (latest edition) for Jenkins\nRUN (apt-get update ;apt-get install --no-install-recommends default-jdk=2:1.11-68ubuntu1~18.04.1 -y )\n#   Install utilities\nRUN (apt-get update ;apt-get install --no-install-recommends git=1:2.17.1-1ubuntu0.17 -y )\nRUN (apt-get update ;apt-get install --no-install-recommends wget=1.19.4-1ubuntu2.2 -y )\nRUN (apt-get update ;apt-get install --no-install-recommends build-essential=12.4ubuntu1 -y )\n#   Install Other tools\nRUN (apt-get update ;apt-get install --no-install-recommends virtualenv=15.1.0+ds-1.1 -y )\nRUN (apt-get update ;apt-get install --no-install-recommends bc=1.07.1-2 -y )\nRUN (apt-get update ;apt-get install --no-install-recommends sudo=1.8.21p2-3ubuntu1.5 -y )\nRUN (apt-get update ;apt-get install --no-install-recommends iputils-ping=3:20161105-1ubuntu3 -y )\nRUN (apt-get update ;apt-get install --no-install-recommends picocom=2.2-2 -y )\nRUN (apt-get update ;apt-get install --no-install-recommends curl=7.58.0-2ubuntu3.24 -y )\nRUN (apt-get update ;apt-get install --no-install-recommends software-properties-common=0.96.24.32.20 -y )\nRUN add-apt-repository ppa:ubuntu-toolchain-r/test -y\nRUN :\n#   Add user jenkins to the image\nRUN adduser --quiet jenkins\nRUN adduser jenkins dialout\nRUN adduser jenkins plugdev\n#   Add user jenkins to sudoers with NOPASSWD\nRUN echo \"jenkins ALL=(ALL) NOPASSWD:ALL\" >> /etc/sudoers\n#   Set password for the jenkins user (you may want to alter this).\nRUN echo \"jenkins:jenkins\" | chpasswd\n#   Setting for sshd\nRUN sed -i 's|session required pam_loginuid.so|session optional pam_loginuid.so|g' /etc/pam.d/sshd\n#   Standard SSH port\nEXPOSE 22/tcp\n#   Clean up\nRUN apt-get clean\n#   Install Ansbile \nRUN echo \"===> Adding Ansible's PPA...\" \\\n && apt-get update -y \\\n && (apt-get update ;apt-get install --no-install-recommends gnupg2=2.2.4-1ubuntu1.6 -y ) \\\n && echo \"deb http://ppa.launchpad.net/ansible/ansible/ubuntu bionic main\" | tee /etc/apt/sources.list.d/ansible.list \\\n && echo \"deb-src http://ppa.launchpad.net/ansible/ansible/ubuntu bionic main\" | tee -a /etc/apt/sources.list.d/ansible.list \\\n && apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys 7BB9C367 \\\n && DEBIAN_FRONTEND=noninteractive apt-get update \\\n && echo \"===> Installing Ansible...\" \\\n && (apt-get update ;apt-get install --no-install-recommends ansible=2.5.1+dfsg-1ubuntu0.1 -y ) \\\n && echo \"===> Installing handy tools (not absolutely required)...\" \\\n && (apt-get update ;apt-get install --no-install-recommends python-pip=9.0.1-2.3~ubuntu1.18.04.8 -y ) \\\n && pip install pycrypto==2.6.1 pywinrm==0.4.3 --upgrade \\\n && (apt-get update ;apt-get install --no-install-recommends sshpass=1.06-1 openssh-client=1:7.6p1-4ubuntu0.7 -y ) \\\n && echo \"===> Removing Ansible PPA...\" \\\n && rm -rf /var/lib/apt/lists/* /etc/apt/sources.list.d/ansible.list \\\n && echo \"===> Adding hosts for convenience...\" \\\n && echo 'localhost' > /etc/ansible/hosts\n#   Install Azure CLi and Dependency\nRUN :\nRUN (apt-get update ;apt-get install --no-install-recommends curl=7.58.0-2ubuntu3.24 -y )\nRUN (apt-get update ;apt-get install --no-install-recommends build-essential=12.4ubuntu1 libssl-dev=1.1.1-1ubuntu2.1~18.04.21 libffi-dev=3.2.1-8 python-dev=2.7.15~rc1-1 -y )\nRUN (apt-get update ;apt-get install --no-install-recommends python-dev=2.7.15~rc1-1 -y )\nRUN (apt-get update ;apt-get install --no-install-recommends python3-pip=9.0.1-2.3~ubuntu1.18.04.8 -y )\nRUN (apt-get update ;apt-get install --no-install-recommends python3=3.6.7-1~18.04 -y )\nRUN (apt-get update ;apt-get install --no-install-recommends python-setuptools=39.0.1-2ubuntu0.1 -y )\nRUN curl -L https://aka.ms/InstallAzureCliBundled -o azure-cli_bundle.tar.gz\nRUN tar -xvzf azure-cli_bundle.tar.gz\nRUN azure-cli_bundle_*/installer\nRUN echo 'export PATH=/root/bin/az:$PATH' >> ~/.bash_profile\nRUN echo 'export PATH=/root/bin/az:$PATH' >> ~/.bashrc\nRUN echo 'export PATH=/root/bin/az:$PATH' >> ~/.profile\nRUN export PATH=$PATH:/root/bin\n#  Install Azure COPY \nFROM microsoft/dotnet:2.1-runtime\nRUN apt-get update \\\n && (apt-get update ;apt-get install --no-install-recommends rsync=3.1.2-2.1ubuntu1.6 libunwind8=1.2.1-8ubuntu0.1 -y ) \\\n && rm -rf /var/lib/apt/lists/*\nRUN set -ex \\\n && curl -L -o azcopy.tar.gz https://aka.ms/downloadazcopylinux64 \\\n && tar -xf azcopy.tar.gz \\\n && rm -f azcopy.tar.gz \\\n && ./install.sh \\\n && rm -f install.sh \\\n && rm -rf azcopy\nCMD [\"ansible-playbook\", \"--version\"]\nCMD [\"python3\", \"--version\"]\nCMD [\"az\", \"--version\"]\nCMD [\"/usr/sbin/sshd\", \"-D\"]\nCMD [\"/usr/bin/azcopy\"]\nCMD [\"azcopy\", \"--version\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  This Dockerfile is used to build an image containing basic stuff to be used as a Jenkins slave build node.\nFROM ubuntu:18.04\nLABEL Description=\" This image is for building Jenkins Slave with Azure CLi and Ansible\"\nUSER root\n#  Make sure apt is happy\nENV DEBIAN_FRONTEND=\"noninteractive\"\nRUN apt-get update -y\n#  Install a basic SSH server\nRUN apt-get install openssh-server -y\nRUN mkdir -p /var/run/sshd\n#  Install JDK 8 (latest edition) for Jenkins\nRUN apt-get install --no-install-recommends default-jdk -y\n#  Install utilities\nRUN apt-get install git -y\nRUN apt-get install wget -y\nRUN apt-get install build-essential -y\n#  Install Other tools\nRUN apt-get install virtualenv -y\nRUN apt-get install bc -y\nRUN apt-get install sudo -y\nRUN apt-get install iputils-ping -y\nRUN apt-get install picocom -y\nRUN apt-get install curl -y\nRUN apt-get install software-properties-common -y\nRUN add-apt-repository ppa:ubuntu-toolchain-r/test -y\nRUN apt-get update -y\n#  Add user jenkins to the image\nRUN adduser --quiet jenkins\nRUN adduser jenkins dialout\nRUN adduser jenkins plugdev\n#  Add user jenkins to sudoers with NOPASSWD\nRUN echo \"jenkins ALL=(ALL) NOPASSWD:ALL\" >> /etc/sudoers\n#  Set password for the jenkins user (you may want to alter this).\nRUN echo \"jenkins:jenkins\" | chpasswd\n#  Setting for sshd\nRUN sed -i 's|session required pam_loginuid.so|session optional pam_loginuid.so|g' /etc/pam.d/sshd\n#  Standard SSH port\nEXPOSE 22/tcp\n#  Clean up\nRUN apt-get clean\n#  Install Ansbile \nRUN echo \"===> Adding Ansible's PPA...\" \\\n && apt-get update -y \\\n && apt-get install gnupg2 -y \\\n && echo \"deb http://ppa.launchpad.net/ansible/ansible/ubuntu bionic main\" | tee /etc/apt/sources.list.d/ansible.list \\\n && echo \"deb-src http://ppa.launchpad.net/ansible/ansible/ubuntu bionic main\" | tee -a /etc/apt/sources.list.d/ansible.list \\\n && apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys 7BB9C367 \\\n && DEBIAN_FRONTEND=noninteractive apt-get update \\\n && echo \"===> Installing Ansible...\" \\\n && apt-get install ansible -y \\\n && echo \"===> Installing handy tools (not absolutely required)...\" \\\n && apt-get install python-pip -y \\\n && pip install pycrypto pywinrm --upgrade \\\n && apt-get install sshpass openssh-client -y \\\n && echo \"===> Removing Ansible PPA...\" \\\n && rm -rf /var/lib/apt/lists/* /etc/apt/sources.list.d/ansible.list \\\n && echo \"===> Adding hosts for convenience...\" \\\n && echo 'localhost' > /etc/ansible/hosts\n#  Install Azure CLi and Dependency\nRUN apt-get update -y\nRUN apt-get install curl -y\nRUN apt-get install build-essential libssl-dev libffi-dev python-dev -y\nRUN apt-get install python-dev -y\nRUN apt-get install python3-pip -y\nRUN apt-get install python3 -y\nRUN apt-get install python-setuptools -y\nRUN curl -L https://aka.ms/InstallAzureCliBundled -o azure-cli_bundle.tar.gz\nRUN tar -xvzf azure-cli_bundle.tar.gz\nRUN azure-cli_bundle_*/installer\nRUN echo 'export PATH=/root/bin/az:$PATH' >> ~/.bash_profile\nRUN echo 'export PATH=/root/bin/az:$PATH' >> ~/.bashrc\nRUN echo 'export PATH=/root/bin/az:$PATH' >> ~/.profile\nRUN export PATH=$PATH:/root/bin\n# Install Azure COPY \nFROM microsoft/dotnet:2.1-runtime\nRUN apt-get update \\\n && apt-get install --no-install-recommends rsync libunwind8 -y \\\n && rm -rf /var/lib/apt/lists/*\nRUN set -ex \\\n && curl -L -o azcopy.tar.gz https://aka.ms/downloadazcopylinux64 \\\n && tar -xf azcopy.tar.gz \\\n && rm -f azcopy.tar.gz \\\n && ./install.sh \\\n && rm -f install.sh \\\n && rm -rf azcopy\nCMD [\"ansible-playbook\", \"--version\"]\nCMD [\"python3\", \"--version\"]\nCMD [\"az\", \"--version\"]\nCMD [\"/usr/sbin/sshd\", \"-D\"]\nCMD [\"/usr/bin/azcopy\"]\nCMD [\"azcopy\", \"--version\"]\n","injectedSmells":[],"originalDockerfileHash":"d568ea9f22345275d2c03e970da6395f","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   This Dockerfile is used to build an image containing basic stuff to be used as a Jenkins slave build node.\nFROM ubuntu:18.04\nLABEL Description=\" This image is for building Jenkins Slave with Azure CLi and Ansible\"\nUSER root\n#   Make sure apt is happy\nENV DEBIAN_FRONTEND=\"noninteractive\"\nRUN apt-get update -y\n#   Install a basic SSH server\nRUN apt-get install openssh-server -y\nRUN mkdir -p /var/run/sshd\n#   Install JDK 8 (latest edition) for Jenkins\nRUN apt-get install --no-install-recommends default-jdk -y\n#   Install utilities\nRUN apt-get install git -y\nRUN apt-get install wget -y\nRUN apt-get install build-essential -y\n#   Install Other tools\nRUN apt-get install virtualenv -y\nRUN apt-get install bc -y\nRUN apt-get install sudo -y\nRUN apt-get install iputils-ping -y\nRUN apt-get install picocom -y\nRUN apt-get install curl -y\nRUN apt-get install software-properties-common -y\nRUN add-apt-repository ppa:ubuntu-toolchain-r/test -y\nRUN apt-get update -y\n#   Add user jenkins to the image\nRUN adduser --quiet jenkins\nRUN adduser jenkins dialout\nRUN adduser jenkins plugdev\n#   Add user jenkins to sudoers with NOPASSWD\nRUN echo \"jenkins ALL=(ALL) NOPASSWD:ALL\" >> /etc/sudoers\n#   Set password for the jenkins user (you may want to alter this).\nRUN echo \"jenkins:jenkins\" | chpasswd\n#   Setting for sshd\nRUN sed -i 's|session required pam_loginuid.so|session optional pam_loginuid.so|g' /etc/pam.d/sshd\n#   Standard SSH port\nEXPOSE 22/tcp\n#   Clean up\nRUN apt-get clean\n#   Install Ansbile \nRUN echo \"===> Adding Ansible's PPA...\" \\\n && apt-get update -y \\\n && apt-get install gnupg2 -y \\\n && echo \"deb http://ppa.launchpad.net/ansible/ansible/ubuntu bionic main\" | tee /etc/apt/sources.list.d/ansible.list \\\n && echo \"deb-src http://ppa.launchpad.net/ansible/ansible/ubuntu bionic main\" | tee -a /etc/apt/sources.list.d/ansible.list \\\n && apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys 7BB9C367 \\\n && DEBIAN_FRONTEND=noninteractive apt-get update \\\n && echo \"===> Installing Ansible...\" \\\n && apt-get install ansible -y \\\n && echo \"===> Installing handy tools (not absolutely required)...\" \\\n && apt-get install python-pip -y \\\n && pip install pycrypto pywinrm --upgrade \\\n && apt-get install sshpass openssh-client -y \\\n && echo \"===> Removing Ansible PPA...\" \\\n && rm -rf /var/lib/apt/lists/* /etc/apt/sources.list.d/ansible.list \\\n && echo \"===> Adding hosts for convenience...\" \\\n && echo 'localhost' > /etc/ansible/hosts\n#   Install Azure CLi and Dependency\nRUN apt-get update -y\nRUN apt-get install curl -y\nRUN apt-get install build-essential libssl-dev libffi-dev python-dev -y\nRUN apt-get install python-dev -y\nRUN apt-get install python3-pip -y\nRUN apt-get install python3 -y\nRUN apt-get install python-setuptools -y\nRUN curl -L https://aka.ms/InstallAzureCliBundled -o azure-cli_bundle.tar.gz\nRUN tar -xvzf azure-cli_bundle.tar.gz\nRUN azure-cli_bundle_*/installer\nRUN echo 'export PATH=/root/bin/az:$PATH' >> ~/.bash_profile\nRUN echo 'export PATH=/root/bin/az:$PATH' >> ~/.bashrc\nRUN echo 'export PATH=/root/bin/az:$PATH' >> ~/.profile\nRUN export PATH=$PATH:/root/bin\n#  Install Azure COPY \nFROM microsoft/dotnet:2.1-runtime\nRUN apt-get update \\\n && apt-get install --no-install-recommends rsync libunwind8 -y \\\n && rm -rf /var/lib/apt/lists/*\nRUN set -ex \\\n && curl -L -o azcopy.tar.gz https://aka.ms/downloadazcopylinux64 \\\n && tar -xf azcopy.tar.gz \\\n && rm -f azcopy.tar.gz \\\n && ./install.sh \\\n && rm -f install.sh \\\n && rm -rf azcopy\nCMD [\"ansible-playbook\", \"--version\"]\nCMD [\"python3\", \"--version\"]\nCMD [\"az\", \"--version\"]\nCMD [\"/usr/sbin/sshd\", \"-D\"]\nCMD [\"/usr/bin/azcopy\"]\nCMD [\"azcopy\", \"--version\"]\n","originalDockerfileUglifiedHash":"99ea9381a27e543813bfdeea87c8c016","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/378e7dc445777c9889bc4c930162b749dfa7809f.dockerfile"}