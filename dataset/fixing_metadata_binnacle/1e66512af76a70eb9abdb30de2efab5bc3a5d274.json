{"seed":3234569809,"processedDockerfileHash":"1ce9c39913f2200bcc52e9152e842451","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","have-a-healthcheck","have-a-user"],"processedDockerfile":"#  # -*- docker-image-name: \"scaleway/ubuntu:xenial\" -*-\nARG MULTIARCH_ARCH\nFROM multiarch/ubuntu-debootstrap:${MULTIARCH_ARCH}-xenial\nARG SCW_ARCH\nMAINTAINER Scaleway <opensource@scaleway.com> (@scaleway)\n#   Environment\nENV DEBIAN_FRONTEND=\"noninteractive\" \\\n    SCW_BASE_IMAGE=\"scaleway/ubuntu:xenial\"\n#   Configure aptitude\nCOPY ./overlay-${SCW_ARCH}/etc/apt/ /etc/apt/\n#   Adding and calling builder-enter\nCOPY ./overlay-base/usr/local/sbin/scw-builder-enter /usr/local/sbin/\nRUN /usr/local/sbin/scw-builder-enter\n#   Install packages\n#   XXX: On armv7l, the base image installs a version of libudev1 which is\n#   incompatible with the udev package. For this architecture and this\n#   architecture only, allow downgrading (with --allow-downgrades) libudev1\n#   otherwise apt-get install fails.\nENV FLASH_KERNEL_SKIP=\"1\"\nRUN : \\\n && apt-get -o Dpkg::Options::='--force-confold' -o Dpkg::Options::='--force-confdef' install --only-upgrade base-files \\\n && rm -rf /etc/update-motd.d/*.dpkg-dist \\\n && apt-get -y -qq upgrade \\\n && apt-get -y -qq $( test ${SCW_ARCH} = \"arm\" \\\n && echo \"--allow-downgrades\" ;) install bash bash-completion bc ca-certificates cron command-not-found curl dbus dmidecode dstat ethstatus file fio grub-efi-$( dpkg --print-architecture | sed 's/armhf/arm/' ;) haveged htop ioping iotop iperf iptables iputils-ping isc-dhcp-client less linux-image-generic locate lsb-release lsof make man-db mg module-init-tools mosh nano net-tools netcat ntp ntpdate python-apt python-software-properties python-yaml rsync rsyslog screen shunit2 socat software-properties-common ssh sudo sysstat systemd-sysv tar tcpdump tmux udev uuid-runtime vim wget whiptail unattended-upgrades \\\n && apt-get clean\n#   Add Scaleway PPA\nRUN add-apt-repository ppa:scaleway/stable \\\n && apt-get update \\\n && (apt-get update ;apt-get install --no-install-recommends cloud-init -y )\n#   Remove keys created during installed, to be created on first boot\nRUN rm -v /etc/ssh/ssh_host_*key*\n#   Patch rootfs\n#   - Tweaks rootfs so it matches Scaleway infrastructure\nRUN rm -f /etc/update-motd.d/10-help-text /etc/update-motd.d/00-header\nCOPY ./overlay-base/ ./overlay/ ./overlay-${SCW_ARCH}/ /\n#   remove root password, it will be created on first boot\nRUN passwd -d root\n#   Configure locales\nRUN locale-gen en_US.UTF-8 \\\n && locale-gen fr_FR.UTF-8 \\\n && dpkg-reconfigure locales\n#   Configure Systemd\nRUN systemctl set-default multi-user\nRUN systemctl preset --preset-mode=full $( cat /etc/systemd/system-preset/*scw*.preset | cut -d' ' -f2 | tr '\\n' ' ' ;)\n#   make /sbin/init a relative symlink for initrd boot\nRUN rm -f /sbin/init /bin/init \\\n && ln -sf ../lib/systemd/systemd /sbin/init \\\n && ln -sf ../lib/systemd/systemd /bin/init\n#   Fix permissions\nRUN chown root:syslog /var/log \\\n && chmod 755 /etc/default\n#   Remove dbus machine-id\nRUN rm /var/lib/dbus/machine-id\n#   Clean rootfs from image-builder\nRUN /usr/local/sbin/scw-builder-leave\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"# # -*- docker-image-name: \"scaleway/ubuntu:xenial\" -*-\nARG MULTIARCH_ARCH\nFROM multiarch/ubuntu-debootstrap:${MULTIARCH_ARCH}-xenial\nARG SCW_ARCH\nMAINTAINER Scaleway <opensource@scaleway.com> (@scaleway)\n#  Environment\nENV DEBIAN_FRONTEND=\"noninteractive\" \\\n    SCW_BASE_IMAGE=\"scaleway/ubuntu:xenial\"\n#  Configure aptitude\nCOPY ./overlay-${SCW_ARCH}/etc/apt/ /etc/apt/\n#  Adding and calling builder-enter\nCOPY ./overlay-base/usr/local/sbin/scw-builder-enter /usr/local/sbin/\nRUN /usr/local/sbin/scw-builder-enter\n#  Install packages\n#  XXX: On armv7l, the base image installs a version of libudev1 which is\n#  incompatible with the udev package. For this architecture and this\n#  architecture only, allow downgrading (with --allow-downgrades) libudev1\n#  otherwise apt-get install fails.\nENV FLASH_KERNEL_SKIP=\"1\"\nRUN apt-get update -q \\\n && apt-get -o Dpkg::Options::='--force-confold' -o Dpkg::Options::='--force-confdef' install --only-upgrade base-files \\\n && rm -rf /etc/update-motd.d/*.dpkg-dist \\\n && apt-get -y -qq upgrade \\\n && apt-get -y -qq $( test ${SCW_ARCH} = \"arm\" \\\n && echo \"--allow-downgrades\" ;) install bash bash-completion bc ca-certificates cron command-not-found curl dbus dmidecode dstat ethstatus file fio grub-efi-$( dpkg --print-architecture | sed 's/armhf/arm/' ;) haveged htop ioping iotop iperf iptables iputils-ping isc-dhcp-client less linux-image-generic locate lsb-release lsof make man-db mg module-init-tools mosh nano net-tools netcat ntp ntpdate python-apt python-software-properties python-yaml rsync rsyslog screen shunit2 socat software-properties-common ssh sudo sysstat systemd-sysv tar tcpdump tmux udev uuid-runtime vim wget whiptail unattended-upgrades \\\n && apt-get clean\n#  Add Scaleway PPA\nRUN add-apt-repository ppa:scaleway/stable \\\n && apt-get update \\\n && apt-get install cloud-init -y\n#  Remove keys created during installed, to be created on first boot\nRUN rm -v /etc/ssh/ssh_host_*key*\n#  Patch rootfs\n#  - Tweaks rootfs so it matches Scaleway infrastructure\nRUN rm -f /etc/update-motd.d/10-help-text /etc/update-motd.d/00-header\nCOPY ./overlay-base/ ./overlay/ ./overlay-${SCW_ARCH}/ /\n#  remove root password, it will be created on first boot\nRUN passwd -d root\n#  Configure locales\nRUN locale-gen en_US.UTF-8 \\\n && locale-gen fr_FR.UTF-8 \\\n && dpkg-reconfigure locales\n#  Configure Systemd\nRUN systemctl set-default multi-user\nRUN systemctl preset --preset-mode=full $( cat /etc/systemd/system-preset/*scw*.preset | cut -d' ' -f2 | tr '\\n' ' ' ;)\n#  make /sbin/init a relative symlink for initrd boot\nRUN rm -f /sbin/init /bin/init \\\n && ln -sf ../lib/systemd/systemd /sbin/init \\\n && ln -sf ../lib/systemd/systemd /bin/init\n#  Fix permissions\nRUN chown root:syslog /var/log \\\n && chmod 755 /etc/default\n#  Remove dbus machine-id\nRUN rm /var/lib/dbus/machine-id\n#  Clean rootfs from image-builder\nRUN /usr/local/sbin/scw-builder-leave\n","injectedSmells":[],"originalDockerfileHash":"b7462839127522a7f3c9bf91c0cb9e51","successfullyInjectedSmells":[],"originalDockerfileUglified":"#  # -*- docker-image-name: \"scaleway/ubuntu:xenial\" -*-\nARG MULTIARCH_ARCH\nFROM multiarch/ubuntu-debootstrap:${MULTIARCH_ARCH}-xenial\nARG SCW_ARCH\nMAINTAINER Scaleway <opensource@scaleway.com> (@scaleway)\n#   Environment\nENV DEBIAN_FRONTEND=\"noninteractive\" \\\n    SCW_BASE_IMAGE=\"scaleway/ubuntu:xenial\"\n#   Configure aptitude\nCOPY ./overlay-${SCW_ARCH}/etc/apt/ /etc/apt/\n#   Adding and calling builder-enter\nCOPY ./overlay-base/usr/local/sbin/scw-builder-enter /usr/local/sbin/\nRUN /usr/local/sbin/scw-builder-enter\n#   Install packages\n#   XXX: On armv7l, the base image installs a version of libudev1 which is\n#   incompatible with the udev package. For this architecture and this\n#   architecture only, allow downgrading (with --allow-downgrades) libudev1\n#   otherwise apt-get install fails.\nENV FLASH_KERNEL_SKIP=\"1\"\nRUN apt-get update -q \\\n && apt-get -o Dpkg::Options::='--force-confold' -o Dpkg::Options::='--force-confdef' install --only-upgrade base-files \\\n && rm -rf /etc/update-motd.d/*.dpkg-dist \\\n && apt-get -y -qq upgrade \\\n && apt-get -y -qq $( test ${SCW_ARCH} = \"arm\" \\\n && echo \"--allow-downgrades\" ;) install bash bash-completion bc ca-certificates cron command-not-found curl dbus dmidecode dstat ethstatus file fio grub-efi-$( dpkg --print-architecture | sed 's/armhf/arm/' ;) haveged htop ioping iotop iperf iptables iputils-ping isc-dhcp-client less linux-image-generic locate lsb-release lsof make man-db mg module-init-tools mosh nano net-tools netcat ntp ntpdate python-apt python-software-properties python-yaml rsync rsyslog screen shunit2 socat software-properties-common ssh sudo sysstat systemd-sysv tar tcpdump tmux udev uuid-runtime vim wget whiptail unattended-upgrades \\\n && apt-get clean\n#   Add Scaleway PPA\nRUN add-apt-repository ppa:scaleway/stable \\\n && apt-get update \\\n && apt-get install cloud-init -y\n#   Remove keys created during installed, to be created on first boot\nRUN rm -v /etc/ssh/ssh_host_*key*\n#   Patch rootfs\n#   - Tweaks rootfs so it matches Scaleway infrastructure\nRUN rm -f /etc/update-motd.d/10-help-text /etc/update-motd.d/00-header\nCOPY ./overlay-base/ ./overlay/ ./overlay-${SCW_ARCH}/ /\n#   remove root password, it will be created on first boot\nRUN passwd -d root\n#   Configure locales\nRUN locale-gen en_US.UTF-8 \\\n && locale-gen fr_FR.UTF-8 \\\n && dpkg-reconfigure locales\n#   Configure Systemd\nRUN systemctl set-default multi-user\nRUN systemctl preset --preset-mode=full $( cat /etc/systemd/system-preset/*scw*.preset | cut -d' ' -f2 | tr '\\n' ' ' ;)\n#   make /sbin/init a relative symlink for initrd boot\nRUN rm -f /sbin/init /bin/init \\\n && ln -sf ../lib/systemd/systemd /sbin/init \\\n && ln -sf ../lib/systemd/systemd /bin/init\n#   Fix permissions\nRUN chown root:syslog /var/log \\\n && chmod 755 /etc/default\n#   Remove dbus machine-id\nRUN rm /var/lib/dbus/machine-id\n#   Clean rootfs from image-builder\nRUN /usr/local/sbin/scw-builder-leave\n","originalDockerfileUglifiedHash":"162dd31f7b534433b03a928136fadf30","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/1e66512af76a70eb9abdb30de2efab5bc3a5d274.dockerfile"}