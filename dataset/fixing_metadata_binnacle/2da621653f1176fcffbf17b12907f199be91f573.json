{"seed":3488607025,"processedDockerfileHash":"6fb26d6b54abeb45f9a5fc7aac7a9421","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","pin-package-manager-versions-apt-get","do-not-have-secrets","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM ubuntu:16.04\n#   Authentication information for hpfeeds in the broker container.\n#   Example command to add the credentials to the broker:\n#\n#   docker exec broker /opt/hpfeeds/env/bin/python /opt/hpfeeds/broker/add_user.py \\\n#  \tdionaea b64c2e86d0eb546e5b2757508df50222 dionaea.connections \"\"\n#   docker exec broker /opt/hpfeeds/env/bin/python /opt/hpfeeds/broker/add_user.py \\\n#  \tdionaea b64c2e86d0eb546e5b2757508df50222 dionaea.dcerpcrequests \"\"\n#   docker exec broker /opt/hpfeeds/env/bin/python /opt/hpfeeds/broker/add_user.py \\\n#  \tdionaea b64c2e86d0eb546e5b2757508df50222 dionaea.shellcodeprofiles \"\"\n#   docker exec broker /opt/hpfeeds/env/bin/python /opt/hpfeeds/broker/add_user.py \\\n#  \tdionaea b64c2e86d0eb546e5b2757508df50222 dionaea.capture \"\"\nENV HPF_HOST=\"broker\"\nENV HPF_PORT=\"10000\"\nENV HPF_IDENT=\"dionaea\"\n# A secret has been removed here. Please do not provide secrets from the Dockerfile as these will leak into the metadata of the resulting docker image. To provide secrets the --secret flag of the docker build command can be used (https://docs.docker.com/develop/develop-images/build_enhancements/#new-docker-build-secret-information).\n#   You may want to change the dionaea user id inside the container if\n#   you're going to mount an external log directory.  The internal uid\n#   needs write permissions to the external volume.\n#\n#   E.g. to save dionaea logs to /var/log/dionaea on the host OS, run docker with ...\n#\n#   \t-v /var/log/dionaea:/opt/dionaea/log\n#   \n#   ... and make sure /var/log/dionaea is writable by the dionaea uid inside the container.\nENV DIONAEA_UID=\"1000\"\n#   Install packages\nRUN apt-get update \\\n && apt-get install --no-install-recommends supervisor=3.2.0-2ubuntu0.2 autoconf=2.69-9 automake=1:1.15-4ubuntu1 build-essential=12.1ubuntu2 git=1:2.7.4-0ubuntu1.10 htop=2.0.1-1ubuntu1 libcurl4-openssl-dev=7.47.0-1ubuntu2.19 libemu-dev=0.2.0+git20120122-1.2 libgc-dev=1:7.4.2-7.3ubuntu0.1 libev-dev=1:4.22-1 libglib2.0-dev=2.48.2-0ubuntu4.8 libloudmouth1-dev=1.5.2-1build1 libnetfilter-queue-dev=1.0.2-2 libpcap-dev=1.7.4-2ubuntu0.1 libreadline-dev=6.3-8ubuntu2 libsqlite3-dev=3.11.0-1ubuntu1.5 libssl-dev=1.0.2g-1ubuntu4.20 libtool=2.4.6-0.1 libudns-dev=0.4-1 pkg-config=0.29.1-0ubuntu1 sqlite3=3.11.0-1ubuntu1.5 subversion=1.9.3-2ubuntu1.3 python3=3.5.1-3 cython3=0.23.4-0ubuntu5 python3-pip=8.1.1-2ubuntu0.6 -y\n#   Create the dionaea user\nRUN useradd -u ${DIONAEA_UID} -s /bin/false dionaea\n#   Download dionaea and compile it\nRUN cd /usr/src \\\n && git clone https://github.com/ThomasAdam/liblcfg.git \\\n && cd liblcfg/code \\\n && autoreconf -vi \\\n && ./configure --prefix=/opt/dionaea \\\n && make install \\\n && cd /usr/src \\\n && git clone https://github.com/threatstream/mhn \\\n && git clone https://github.com/gento/dionaea.git dionaea \\\n && cp mhn/server/mhn/static/hpfeeds.py dionaea/modules/python/scripts/ \\\n && cd dionaea \\\n && autoreconf -vi \\\n && ln -s /usr/bin/python3 /usr/bin/python3.2 \\\n && ln -s /usr/bin/cython3 /usr/bin/cython \\\n && pip3 install -e git+https://github.com/HurricaneLabs/pyev.git#egg=pyev \\\n && ./configure --disable-werror --prefix=/opt/dionaea --with-lcfg-include=/opt/dionaea/include/ --with-lcfg-lib=/opt/dionaea/lib/ \\\n && sed -i -e 's/-Werror//' modules/nfq/Makefile \\\n && make LDFLAGS=-lcrypto \\\n && make install \\\n && sed -i -e 's/{:s}/{!s:s}/g' /opt/dionaea/lib/dionaea/python/dionaea/sip/__init__.py \\\n && sed -i -e 's/{:/{!s:/g' /opt/dionaea/lib/dionaea/python/dionaea/mssql/mssql.py \\\n && chown $DIONAEA_UID /opt/dionaea/var/dionaea\nCOPY dionaea.conf /opt/dionaea/etc/dionaea/\nCOPY supervisor-dionaea.conf /etc/supervisor/conf.d/dionaea.conf\nRUN sed -i -e \"s/HPF_HOST/$HPF_HOST/\" /opt/dionaea/etc/dionaea/dionaea.conf \\\n && sed -i -e \"s/HPF_PORT/$HPF_PORT/\" /opt/dionaea/etc/dionaea/dionaea.conf \\\n && sed -i -e \"s/HPF_IDENT/$HPF_IDENT/\" /opt/dionaea/etc/dionaea/dionaea.conf \\\n && sed -i -e \"s/HPF_SECRET/$HPF_SECRET/\" /opt/dionaea/etc/dionaea/dionaea.conf\nEXPOSE 21/tcp\nEXPOSE 42/tcp\nEXPOSE 80/tcp\nEXPOSE 135/tcp\nEXPOSE 443/tcp\nEXPOSE 445/tcp\nEXPOSE 1433/tcp\nEXPOSE 1723/tcp\nEXPOSE 1883/tcp\nEXPOSE 3306/tcp\nEXPOSE 5060/tcp\nEXPOSE 5061/tcp\nEXPOSE 69/udp\nEXPOSE 1900/udp\nEXPOSE 5060/udp\nWORKDIR /opt/dionaea\nCMD [\"/usr/bin/supervisord\", \"-n\", \"-c\", \"/etc/supervisor/supervisord.conf\"]\n#   How to run the container:\n#\n#   docker run --rm --name dionaea --link broker dionaea\n#\n#   To log outside the container:\n#\n#   mkdir /var/log/dionaea\n#   chown 1000 /var/log/dionaea\n#   docker run --rm --name dionaea -v /var/log/dionaea:/opt/dionaea/log --link broker dionaea\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM ubuntu:16.04\n#  Authentication information for hpfeeds in the broker container.\n#  Example command to add the credentials to the broker:\n#\n#  docker exec broker /opt/hpfeeds/env/bin/python /opt/hpfeeds/broker/add_user.py \\\n# \tdionaea b64c2e86d0eb546e5b2757508df50222 dionaea.connections \"\"\n#  docker exec broker /opt/hpfeeds/env/bin/python /opt/hpfeeds/broker/add_user.py \\\n# \tdionaea b64c2e86d0eb546e5b2757508df50222 dionaea.dcerpcrequests \"\"\n#  docker exec broker /opt/hpfeeds/env/bin/python /opt/hpfeeds/broker/add_user.py \\\n# \tdionaea b64c2e86d0eb546e5b2757508df50222 dionaea.shellcodeprofiles \"\"\n#  docker exec broker /opt/hpfeeds/env/bin/python /opt/hpfeeds/broker/add_user.py \\\n# \tdionaea b64c2e86d0eb546e5b2757508df50222 dionaea.capture \"\"\nENV HPF_HOST=\"broker\"\nENV HPF_PORT=\"10000\"\nENV HPF_IDENT=\"dionaea\"\nENV HPF_SECRET=\"b64c2e86d0eb546e5b2757508df50222\"\n#  You may want to change the dionaea user id inside the container if\n#  you're going to mount an external log directory.  The internal uid\n#  needs write permissions to the external volume.\n#\n#  E.g. to save dionaea logs to /var/log/dionaea on the host OS, run docker with ...\n#\n#  \t-v /var/log/dionaea:/opt/dionaea/log\n#  \n#  ... and make sure /var/log/dionaea is writable by the dionaea uid inside the container.\nENV DIONAEA_UID=\"1000\"\n#  Install packages\nRUN apt-get update \\\n && apt-get install supervisor autoconf automake build-essential git htop libcurl4-openssl-dev libemu-dev libgc-dev libev-dev libglib2.0-dev libloudmouth1-dev libnetfilter-queue-dev libpcap-dev libreadline-dev libsqlite3-dev libssl-dev libtool libudns-dev pkg-config sqlite3 subversion python3 cython3 python3-pip -y\n#  Create the dionaea user\nRUN useradd -u ${DIONAEA_UID} -s /bin/false dionaea\n#  Download dionaea and compile it\nRUN cd /usr/src \\\n && git clone https://github.com/ThomasAdam/liblcfg.git \\\n && cd liblcfg/code \\\n && autoreconf -vi \\\n && ./configure --prefix=/opt/dionaea \\\n && make install \\\n && cd /usr/src \\\n && git clone https://github.com/threatstream/mhn \\\n && git clone https://github.com/gento/dionaea.git dionaea \\\n && cp mhn/server/mhn/static/hpfeeds.py dionaea/modules/python/scripts/ \\\n && cd dionaea \\\n && autoreconf -vi \\\n && ln -s /usr/bin/python3 /usr/bin/python3.2 \\\n && ln -s /usr/bin/cython3 /usr/bin/cython \\\n && pip3 install -e git+https://github.com/HurricaneLabs/pyev.git#egg=pyev \\\n && ./configure --disable-werror --prefix=/opt/dionaea --with-lcfg-include=/opt/dionaea/include/ --with-lcfg-lib=/opt/dionaea/lib/ \\\n && sed -i -e 's/-Werror//' modules/nfq/Makefile \\\n && make LDFLAGS=-lcrypto \\\n && make install \\\n && sed -i -e 's/{:s}/{!s:s}/g' /opt/dionaea/lib/dionaea/python/dionaea/sip/__init__.py \\\n && sed -i -e 's/{:/{!s:/g' /opt/dionaea/lib/dionaea/python/dionaea/mssql/mssql.py \\\n && chown $DIONAEA_UID /opt/dionaea/var/dionaea\nCOPY dionaea.conf /opt/dionaea/etc/dionaea/\nCOPY supervisor-dionaea.conf /etc/supervisor/conf.d/dionaea.conf\nRUN sed -i -e \"s/HPF_HOST/$HPF_HOST/\" /opt/dionaea/etc/dionaea/dionaea.conf \\\n && sed -i -e \"s/HPF_PORT/$HPF_PORT/\" /opt/dionaea/etc/dionaea/dionaea.conf \\\n && sed -i -e \"s/HPF_IDENT/$HPF_IDENT/\" /opt/dionaea/etc/dionaea/dionaea.conf \\\n && sed -i -e \"s/HPF_SECRET/$HPF_SECRET/\" /opt/dionaea/etc/dionaea/dionaea.conf\nEXPOSE 21/tcp\nEXPOSE 42/tcp\nEXPOSE 80/tcp\nEXPOSE 135/tcp\nEXPOSE 443/tcp\nEXPOSE 445/tcp\nEXPOSE 1433/tcp\nEXPOSE 1723/tcp\nEXPOSE 1883/tcp\nEXPOSE 3306/tcp\nEXPOSE 5060/tcp\nEXPOSE 5061/tcp\nEXPOSE 69/udp\nEXPOSE 1900/udp\nEXPOSE 5060/udp\nWORKDIR /opt/dionaea\nCMD [\"/usr/bin/supervisord\", \"-n\", \"-c\", \"/etc/supervisor/supervisord.conf\"]\n#  How to run the container:\n#\n#  docker run --rm --name dionaea --link broker dionaea\n#\n#  To log outside the container:\n#\n#  mkdir /var/log/dionaea\n#  chown 1000 /var/log/dionaea\n#  docker run --rm --name dionaea -v /var/log/dionaea:/opt/dionaea/log --link broker dionaea\n","injectedSmells":[],"originalDockerfileHash":"63f91a6d86b47c41f18f24d7cfefeb31","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM ubuntu:16.04\n#   Authentication information for hpfeeds in the broker container.\n#   Example command to add the credentials to the broker:\n#\n#   docker exec broker /opt/hpfeeds/env/bin/python /opt/hpfeeds/broker/add_user.py \\\n#  \tdionaea b64c2e86d0eb546e5b2757508df50222 dionaea.connections \"\"\n#   docker exec broker /opt/hpfeeds/env/bin/python /opt/hpfeeds/broker/add_user.py \\\n#  \tdionaea b64c2e86d0eb546e5b2757508df50222 dionaea.dcerpcrequests \"\"\n#   docker exec broker /opt/hpfeeds/env/bin/python /opt/hpfeeds/broker/add_user.py \\\n#  \tdionaea b64c2e86d0eb546e5b2757508df50222 dionaea.shellcodeprofiles \"\"\n#   docker exec broker /opt/hpfeeds/env/bin/python /opt/hpfeeds/broker/add_user.py \\\n#  \tdionaea b64c2e86d0eb546e5b2757508df50222 dionaea.capture \"\"\nENV HPF_HOST=\"broker\"\nENV HPF_PORT=\"10000\"\nENV HPF_IDENT=\"dionaea\"\nENV HPF_SECRET=\"b64c2e86d0eb546e5b2757508df50222\"\n#   You may want to change the dionaea user id inside the container if\n#   you're going to mount an external log directory.  The internal uid\n#   needs write permissions to the external volume.\n#\n#   E.g. to save dionaea logs to /var/log/dionaea on the host OS, run docker with ...\n#\n#   \t-v /var/log/dionaea:/opt/dionaea/log\n#   \n#   ... and make sure /var/log/dionaea is writable by the dionaea uid inside the container.\nENV DIONAEA_UID=\"1000\"\n#   Install packages\nRUN apt-get update \\\n && apt-get install supervisor autoconf automake build-essential git htop libcurl4-openssl-dev libemu-dev libgc-dev libev-dev libglib2.0-dev libloudmouth1-dev libnetfilter-queue-dev libpcap-dev libreadline-dev libsqlite3-dev libssl-dev libtool libudns-dev pkg-config sqlite3 subversion python3 cython3 python3-pip -y\n#   Create the dionaea user\nRUN useradd -u ${DIONAEA_UID} -s /bin/false dionaea\n#   Download dionaea and compile it\nRUN cd /usr/src \\\n && git clone https://github.com/ThomasAdam/liblcfg.git \\\n && cd liblcfg/code \\\n && autoreconf -vi \\\n && ./configure --prefix=/opt/dionaea \\\n && make install \\\n && cd /usr/src \\\n && git clone https://github.com/threatstream/mhn \\\n && git clone https://github.com/gento/dionaea.git dionaea \\\n && cp mhn/server/mhn/static/hpfeeds.py dionaea/modules/python/scripts/ \\\n && cd dionaea \\\n && autoreconf -vi \\\n && ln -s /usr/bin/python3 /usr/bin/python3.2 \\\n && ln -s /usr/bin/cython3 /usr/bin/cython \\\n && pip3 install -e git+https://github.com/HurricaneLabs/pyev.git#egg=pyev \\\n && ./configure --disable-werror --prefix=/opt/dionaea --with-lcfg-include=/opt/dionaea/include/ --with-lcfg-lib=/opt/dionaea/lib/ \\\n && sed -i -e 's/-Werror//' modules/nfq/Makefile \\\n && make LDFLAGS=-lcrypto \\\n && make install \\\n && sed -i -e 's/{:s}/{!s:s}/g' /opt/dionaea/lib/dionaea/python/dionaea/sip/__init__.py \\\n && sed -i -e 's/{:/{!s:/g' /opt/dionaea/lib/dionaea/python/dionaea/mssql/mssql.py \\\n && chown $DIONAEA_UID /opt/dionaea/var/dionaea\nCOPY dionaea.conf /opt/dionaea/etc/dionaea/\nCOPY supervisor-dionaea.conf /etc/supervisor/conf.d/dionaea.conf\nRUN sed -i -e \"s/HPF_HOST/$HPF_HOST/\" /opt/dionaea/etc/dionaea/dionaea.conf \\\n && sed -i -e \"s/HPF_PORT/$HPF_PORT/\" /opt/dionaea/etc/dionaea/dionaea.conf \\\n && sed -i -e \"s/HPF_IDENT/$HPF_IDENT/\" /opt/dionaea/etc/dionaea/dionaea.conf \\\n && sed -i -e \"s/HPF_SECRET/$HPF_SECRET/\" /opt/dionaea/etc/dionaea/dionaea.conf\nEXPOSE 21/tcp\nEXPOSE 42/tcp\nEXPOSE 80/tcp\nEXPOSE 135/tcp\nEXPOSE 443/tcp\nEXPOSE 445/tcp\nEXPOSE 1433/tcp\nEXPOSE 1723/tcp\nEXPOSE 1883/tcp\nEXPOSE 3306/tcp\nEXPOSE 5060/tcp\nEXPOSE 5061/tcp\nEXPOSE 69/udp\nEXPOSE 1900/udp\nEXPOSE 5060/udp\nWORKDIR /opt/dionaea\nCMD [\"/usr/bin/supervisord\", \"-n\", \"-c\", \"/etc/supervisor/supervisord.conf\"]\n#   How to run the container:\n#\n#   docker run --rm --name dionaea --link broker dionaea\n#\n#   To log outside the container:\n#\n#   mkdir /var/log/dionaea\n#   chown 1000 /var/log/dionaea\n#   docker run --rm --name dionaea -v /var/log/dionaea:/opt/dionaea/log --link broker dionaea\n","originalDockerfileUglifiedHash":"2bc22b5f06d72a114fd1bab523fefdc2","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/2da621653f1176fcffbf17b12907f199be91f573.dockerfile"}