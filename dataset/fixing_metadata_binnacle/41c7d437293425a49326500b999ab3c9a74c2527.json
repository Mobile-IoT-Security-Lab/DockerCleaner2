{"seed":4140522647,"processedDockerfileHash":"8decf83c64a9143b6dbd5f10e6b0f7ad","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"#  !/usr/bin/env docker build -t xrdp\n#\n#   A common Xrdp image that the window-manager images build on\n#\n#   docker build -t xrdp .\nFROM debian:jessie\nRUN :\nRUN (apt-get update ;apt-get install --no-install-recommends xterm apt-utils sudo -yq )\n#  RUN apt-get install -yq xterm xrdp apt-utils sudo\n#   for RDP\nEXPOSE 3389/tcp\n#   Build from source\nRUN apt-get update \\\n && (apt-get update ;apt-get install --no-install-recommends vim-tiny git make -yq )\n#   packages installed by X11RDP-o-Matic\nRUN (apt-get update ;apt-get install --no-install-recommends dialog lsb-release build-essential checkinstall automake automake git git-core libssl-dev libpam0g-dev zlib1g-dev libtool libtool-bin libx11-dev libxfixes-dev pkg-config flex bison libxml2-dev intltool xsltproc xutils-dev python-libxml2 g++ xutils libfuse-dev wget libxrandr-dev libdrm-dev libpixman-1-dev libgl1-mesa-dev libxkbfile-dev libxfont-dev libpciaccess-dev dh-make gettext xfonts-utils libjpeg-dev nasm curl libturbojpeg1 libturbojpeg1-dev libpulse-dev libavcodec-dev libavformat-dev x11proto-* -yq )\nWORKDIR /usr/src\n#  RUN git clone https://github.com/scarygliders/X11RDP-o-Matic\n#  RUN cd X11RDP-o-Matic \\\n#  \t&& ./X11rdp-o-matic.sh --justdoit --nocleanup --withsound --withfreerdp --withxrdpvr --withneutrino\nRUN git clone https://github.com/neutrinolabs/xrdp\nWORKDIR /usr/src/xrdp\nRUN git submodule init \\\n && git submodule update\nRUN ./bootstrap\n#   --disable-pam as it seems it uses systemd!\nRUN ./configure --enable-xrdpdebug --enable-tjpeg --enable-fuse --enable-simplesound --enable-load_pulse_modules --disable-pam\n#  RUN ./configure --enable-xrdpdebug --enable-neutrinordp --enable-tjpeg --enable-fuse --enable-xrdpvr --enable-rfxcodec --enable-opus\nRUN make\nRUN make install\n#   and now xorgxrdp\nRUN (apt-get update ;apt-get install --no-install-recommends xserver-xorg-dev -yq )\nWORKDIR /usr/src/xrdp/xorgxrdp\nRUN ./bootstrap\nRUN ./configure\nRUN make\nRUN make install\n#   it asks user to select keyboard\nRUN DEBIAN_FRONTEND=noninteractive apt-get install -yq xserver-xorg-core\n#   add our user\nRUN adduser --disabled-password --gecos \"\" dockerx\nRUN adduser dockerx sudo\nRUN adduser dockerx users\nRUN echo \"dockerx:docker\" | chpasswd\nENTRYPOINT [\"/start.sh\"]\nRUN (apt-get update ;apt-get install --no-install-recommends rxvt-unicode -yq )\nCMD [\"rxvt-unicode\", \"-geometry\", \"164x58\", \"-e\", \"bash\"]\n#   Audio?\n#   https://github.com/neutrinolabs/xrdp/issues/321\n#   http://w.vmeta.jp/tdiary/20140918.html\nRUN (apt-get update ;apt-get install --no-install-recommends dpkg-dev dbus-x11 -yq )\nWORKDIR /usr/src\nRUN cat /etc/apt/sources.list | sed 's/^deb /deb-src /g' >> /etc/apt/sources.list \\\n && : \\\n && apt-get source pulseaudio \\\n && apt-get build-dep -yq pulseaudio \\\n && apt-get source --compile pulseaudio\nRUN (apt-get update ;apt-get install --no-install-recommends pulseaudio -yq ) \\\n && adduser root audio \\\n && adduser root pulse \\\n && adduser root pulse-access \\\n && adduser dockerx audio \\\n && adduser dockerx pulse \\\n && adduser dockerx pulse-access\nRUN cd /usr/src/xrdp/sesman/chansrv/pulse \\\n && sed -i~ 's|^PULSE_DIR.*|PULSE_DIR = /usr/src/pulseaudio-5.0|' Makefile \\\n && make \\\n && cp module-xrdp-sink.so module-xrdp-source.so /usr/lib/pulse-5.0/modules/\n#   The scripts that make it work (keep last)\nCOPY run.sh /usr/local/bin/run\nCOPY xrdp.ini /etc/xrdp/\nCOPY start.sh /\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"# !/usr/bin/env docker build -t xrdp\n#\n#  A common Xrdp image that the window-manager images build on\n#\n#  docker build -t xrdp .\nFROM debian:jessie\nRUN apt-get update\nRUN apt-get install xterm apt-utils sudo -yq\n# RUN apt-get install -yq xterm xrdp apt-utils sudo\n#  for RDP\nEXPOSE 3389/tcp\n#  Build from source\nRUN apt-get update \\\n && apt-get install vim-tiny git make -yq\n#  packages installed by X11RDP-o-Matic\nRUN apt-get install dialog lsb-release build-essential checkinstall automake automake git git-core libssl-dev libpam0g-dev zlib1g-dev libtool libtool-bin libx11-dev libxfixes-dev pkg-config flex bison libxml2-dev intltool xsltproc xutils-dev python-libxml2 g++ xutils libfuse-dev wget libxrandr-dev libdrm-dev libpixman-1-dev libgl1-mesa-dev libxkbfile-dev libxfont-dev libpciaccess-dev dh-make gettext xfonts-utils libjpeg-dev nasm curl libturbojpeg1 libturbojpeg1-dev libpulse-dev libavcodec-dev libavformat-dev x11proto-* -yq\nWORKDIR /usr/src\n# RUN git clone https://github.com/scarygliders/X11RDP-o-Matic\n# RUN cd X11RDP-o-Matic \\\n# \t&& ./X11rdp-o-matic.sh --justdoit --nocleanup --withsound --withfreerdp --withxrdpvr --withneutrino\nRUN git clone https://github.com/neutrinolabs/xrdp\nWORKDIR /usr/src/xrdp\nRUN git submodule init \\\n && git submodule update\nRUN ./bootstrap\n#  --disable-pam as it seems it uses systemd!\nRUN ./configure --enable-xrdpdebug --enable-tjpeg --enable-fuse --enable-simplesound --enable-load_pulse_modules --disable-pam\n# RUN ./configure --enable-xrdpdebug --enable-neutrinordp --enable-tjpeg --enable-fuse --enable-xrdpvr --enable-rfxcodec --enable-opus\nRUN make\nRUN make install\n#  and now xorgxrdp\nRUN apt-get install xserver-xorg-dev -yq\nWORKDIR /usr/src/xrdp/xorgxrdp\nRUN ./bootstrap\nRUN ./configure\nRUN make\nRUN make install\n#  it asks user to select keyboard\nRUN DEBIAN_FRONTEND=noninteractive apt-get install -yq xserver-xorg-core\n#  add our user\nRUN adduser --disabled-password --gecos \"\" dockerx\nRUN adduser dockerx sudo\nRUN adduser dockerx users\nRUN echo \"dockerx:docker\" | chpasswd\nENTRYPOINT [\"/start.sh\"]\nRUN apt-get install rxvt-unicode -yq\nCMD [\"rxvt-unicode\", \"-geometry\", \"164x58\", \"-e\", \"bash\"]\n#  Audio?\n#  https://github.com/neutrinolabs/xrdp/issues/321\n#  http://w.vmeta.jp/tdiary/20140918.html\nRUN apt-get install dpkg-dev dbus-x11 -yq\nWORKDIR /usr/src\nRUN cat /etc/apt/sources.list | sed 's/^deb /deb-src /g' >> /etc/apt/sources.list \\\n && apt-get update \\\n && apt-get source pulseaudio \\\n && apt-get build-dep -yq pulseaudio \\\n && apt-get source --compile pulseaudio\nRUN apt-get install pulseaudio -yq \\\n && adduser root audio \\\n && adduser root pulse \\\n && adduser root pulse-access \\\n && adduser dockerx audio \\\n && adduser dockerx pulse \\\n && adduser dockerx pulse-access\nRUN cd /usr/src/xrdp/sesman/chansrv/pulse \\\n && sed -i~ 's|^PULSE_DIR.*|PULSE_DIR = /usr/src/pulseaudio-5.0|' Makefile \\\n && make \\\n && cp module-xrdp-sink.so module-xrdp-source.so /usr/lib/pulse-5.0/modules/\n#  The scripts that make it work (keep last)\nADD run.sh /usr/local/bin/run\nADD xrdp.ini /etc/xrdp/\nADD start.sh /\n","injectedSmells":[],"originalDockerfileHash":"0649048ff02fa128c82523b0f6cb5c97","successfullyInjectedSmells":[],"originalDockerfileUglified":"#  !/usr/bin/env docker build -t xrdp\n#\n#   A common Xrdp image that the window-manager images build on\n#\n#   docker build -t xrdp .\nFROM debian:jessie\nRUN apt-get update\nRUN apt-get install xterm apt-utils sudo -yq\n#  RUN apt-get install -yq xterm xrdp apt-utils sudo\n#   for RDP\nEXPOSE 3389/tcp\n#   Build from source\nRUN apt-get update \\\n && apt-get install vim-tiny git make -yq\n#   packages installed by X11RDP-o-Matic\nRUN apt-get install dialog lsb-release build-essential checkinstall automake automake git git-core libssl-dev libpam0g-dev zlib1g-dev libtool libtool-bin libx11-dev libxfixes-dev pkg-config flex bison libxml2-dev intltool xsltproc xutils-dev python-libxml2 g++ xutils libfuse-dev wget libxrandr-dev libdrm-dev libpixman-1-dev libgl1-mesa-dev libxkbfile-dev libxfont-dev libpciaccess-dev dh-make gettext xfonts-utils libjpeg-dev nasm curl libturbojpeg1 libturbojpeg1-dev libpulse-dev libavcodec-dev libavformat-dev x11proto-* -yq\nWORKDIR /usr/src\n#  RUN git clone https://github.com/scarygliders/X11RDP-o-Matic\n#  RUN cd X11RDP-o-Matic \\\n#  \t&& ./X11rdp-o-matic.sh --justdoit --nocleanup --withsound --withfreerdp --withxrdpvr --withneutrino\nRUN git clone https://github.com/neutrinolabs/xrdp\nWORKDIR /usr/src/xrdp\nRUN git submodule init \\\n && git submodule update\nRUN ./bootstrap\n#   --disable-pam as it seems it uses systemd!\nRUN ./configure --enable-xrdpdebug --enable-tjpeg --enable-fuse --enable-simplesound --enable-load_pulse_modules --disable-pam\n#  RUN ./configure --enable-xrdpdebug --enable-neutrinordp --enable-tjpeg --enable-fuse --enable-xrdpvr --enable-rfxcodec --enable-opus\nRUN make\nRUN make install\n#   and now xorgxrdp\nRUN apt-get install xserver-xorg-dev -yq\nWORKDIR /usr/src/xrdp/xorgxrdp\nRUN ./bootstrap\nRUN ./configure\nRUN make\nRUN make install\n#   it asks user to select keyboard\nRUN DEBIAN_FRONTEND=noninteractive apt-get install -yq xserver-xorg-core\n#   add our user\nRUN adduser --disabled-password --gecos \"\" dockerx\nRUN adduser dockerx sudo\nRUN adduser dockerx users\nRUN echo \"dockerx:docker\" | chpasswd\nENTRYPOINT [\"/start.sh\"]\nRUN apt-get install rxvt-unicode -yq\nCMD [\"rxvt-unicode\", \"-geometry\", \"164x58\", \"-e\", \"bash\"]\n#   Audio?\n#   https://github.com/neutrinolabs/xrdp/issues/321\n#   http://w.vmeta.jp/tdiary/20140918.html\nRUN apt-get install dpkg-dev dbus-x11 -yq\nWORKDIR /usr/src\nRUN cat /etc/apt/sources.list | sed 's/^deb /deb-src /g' >> /etc/apt/sources.list \\\n && apt-get update \\\n && apt-get source pulseaudio \\\n && apt-get build-dep -yq pulseaudio \\\n && apt-get source --compile pulseaudio\nRUN apt-get install pulseaudio -yq \\\n && adduser root audio \\\n && adduser root pulse \\\n && adduser root pulse-access \\\n && adduser dockerx audio \\\n && adduser dockerx pulse \\\n && adduser dockerx pulse-access\nRUN cd /usr/src/xrdp/sesman/chansrv/pulse \\\n && sed -i~ 's|^PULSE_DIR.*|PULSE_DIR = /usr/src/pulseaudio-5.0|' Makefile \\\n && make \\\n && cp module-xrdp-sink.so module-xrdp-source.so /usr/lib/pulse-5.0/modules/\n#   The scripts that make it work (keep last)\nADD run.sh /usr/local/bin/run\nADD xrdp.ini /etc/xrdp/\nADD start.sh /\n","originalDockerfileUglifiedHash":"d2a5a191667781562edf98e9089407a5","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/41c7d437293425a49326500b999ab3c9a74c2527.dockerfile"}