{"seed":1769686505,"processedDockerfileHash":"42eb0534eef22ad69d30b4540dc2df7f","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apt-get","do-not-have-secrets","have-a-healthcheck","have-a-user"],"processedDockerfile":"#   Start by pulling down our existing container\n#   to sync 1.9 Gb of data from OpenVAS.\nFROM mikesplain/openvas\nFROM ubuntu:16.04\nCOPY --from=0 /var/lib/openvas /var/lib/openvas\nCOPY config/redis.config /etc/redis/redis.config\nCOPY config/sasl_passwd_template /\nCOPY config/main.cf_template /\nCOPY config/ldapUserSync/* /ldapUserSync/\nCOPY start /start\n# A secret has been removed here. Please do not provide secrets from the Dockerfile as these will leak into the metadata of the resulting docker image. To provide secrets the --secret flag of the docker build command can be used (https://docs.docker.com/develop/develop-images/build_enhancements/#new-docker-build-secret-information).\nENV DEBIAN_FRONTEND=\"noninteractive\" \\\n    PUBLIC_HOSTNAME=\"openvas\"\nRUN apt-get update \\\n && apt-get install --no-install-recommends software-properties-common=0.99.35 -yq \\\n && add-apt-repository ppa:mikesplain/openvas -y \\\n && add-apt-repository ppa:mrazavi/openvas -y \\\n && apt-get clean \\\n && apt-get update \\\n && apt-get install --no-install-recommends alien=8.95.6 autotools-dev=20220109.1 bind9-host=1:9.18.12-1ubuntu1 binutils=2.40-2ubuntu3 bsdmainutils=12.1.7+nmu3ubuntu2 build-essential=12.9ubuntu3 bzip2=1.0.8-5build1 ca-certificates=20230311 cpio=2.13+dfsg-7.1 cpp=4:12.2.0-3ubuntu1 cpp-5 curl=7.88.1-7ubuntu1 debhelper=13.11.4ubuntu3 debugedit=1:5.0-5 dh-python=5.20230130 dh-strip-nondeterminism=1.13.1-1 dirb=2.22+dfsg-5 dirmngr=2.2.40-1ubuntu2 dnsutils=1:9.18.12-1ubuntu1 dpkg-dev=1.21.21ubuntu1 fakeroot=1.31-1.1 file=1:5.44-3 fontconfig=2.14.1-3ubuntu3 fontconfig-config=2.14.1-3ubuntu3 fonts-dejavu-core=2.37-6 fonts-lato=2.0-2.1 fonts-liberation=1:1.07.4-11 fonts-lmodern=2.005-1 fonts-texgyre=20180621-6 g++=4:12.2.0-3ubuntu1 g++-5 gcc=4:12.2.0-3ubuntu1 gcc-5 geoip-database=20230203-1 gettext=0.21-11 gettext-base=0.21-11 ghostscript=10.0.0~dfsg1-0ubuntu1 gir1.2-glib-2.0:amd64 gnupg-agent=2.2.40-1ubuntu2 gnupg2=2.2.40-1ubuntu2 gnutls-bin=3.7.8-5ubuntu1 graphviz=2.42.2-7build3 groff-base=1.22.4-10 gsfonts=2:20200910-7 hicolor-icon-theme=0.17-2 ifupdown=0.8.36+nmu1ubuntu4 intltool-debian=0.35.0+20060710.6 iproute2=6.1.0-1ubuntu2 isc-dhcp-client=4.4.3-P1-1ubuntu1 isc-dhcp-common=4.4.3-P1-1ubuntu1 javascript-common=11+nmu1 ldap-utils=2.6.3+dfsg-1~exp1ubuntu2 libalgorithm-diff-perl=1.201-1 libalgorithm-diff-xs-perl=0.04-8 libalgorithm-merge-perl=0.08-5 libapr1:amd64 libaprutil1:amd64 libarchive-zip-perl=1.68-1 libarchive13:amd64 libasan2:amd64 libasn1-8-heimdal:amd64 libasprintf-dev:amd64 libasprintf0v5:amd64 libassuan0:amd64 libatk1.0-0:amd64 libatk1.0-data libatm1:amd64 libatomic1:amd64 libauthen-sasl-perl=2.1600-3 libavahi-client3:amd64 libavahi-common-data:amd64 libavahi-common3:amd64 libbind9-140:amd64 libblas-common libblas3=3.11.0-2 libbsd0:amd64 libc-dev-bin=2.37-0ubuntu2 libc6-dev:amd64 libcairo2:amd64 libcc1-0:amd64 libcdt5=2.42.2-7build3 libcgraph6=2.42.2-7build3 libcilkrts5:amd64 libcroco3:amd64 libcups2:amd64 libcupsfilters1:amd64 libcupsimage2:amd64 libcurl3:amd64 libcurl3-gnutls:amd64 libdatrie1:amd64 libdbus-1-3:amd64 libdns-export162 libdns162:amd64 libdpkg-perl=1.21.21ubuntu1 libdrm-amdgpu1:amd64 libdrm-common=2.4.114-1 libdrm-intel1:amd64 libdrm-nouveau2:amd64 libdrm-radeon1:amd64 libdrm2:amd64 libedit2:amd64 libelf1:amd64 libencode-locale-perl=1.05-3 libexpat1:amd64 libfakeroot:amd64 libffi6:amd64 libfile-basedir-perl=0.09-2 libfile-desktopentry-perl=0.22-3 libfile-fcntllock-perl=0.22-4build1 libfile-homedir-perl=1.006-2 libfile-listing-perl=6.15-1 libfile-mimeinfo-perl=0.33-1 libfile-stripnondeterminism-perl=1.13.1-1 libfile-which-perl=1.27-2 libfont-afm-perl=1.20-4 libfontconfig1:amd64 libfontenc1:amd64 libfreetype6:amd64 libgcc-5-dev:amd64 libgd3:amd64 libgdbm3:amd64 libgdk-pixbuf2.0-0:amd64 libgdk-pixbuf2.0-common=2.42.10+dfsg-1build1 libgeoip1:amd64 libgettextpo-dev:amd64 libgettextpo0:amd64 libgirepository-1.0-1:amd64 libgl1-mesa-dri:amd64 libgl1-mesa-glx:amd64 libglapi-mesa:amd64 libglib2.0-0:amd64 libgmp10:amd64 libgnutls30:amd64 libgomp1:amd64 libgpgme11:amd64 libgraphite2-3:amd64 libgs9:amd64 libgs9-common=10.0.0~dfsg1-0ubuntu1 libgssapi-krb5-2:amd64 libgssapi3-heimdal:amd64 libgtk2.0-0:amd64 libgtk2.0-bin=2.24.33-2ubuntu2 libgtk2.0-common=2.24.33-2ubuntu2 libgtksourceview2.0-0 libgtksourceview2.0-common libgvc6=2.42.2-7build3 libgvpr2=2.42.2-7build3 libharfbuzz-icu0:amd64 libharfbuzz0b:amd64 libhcrypto4-heimdal:amd64 libheimbase1-heimdal:amd64 libheimntlm0-heimdal:amd64 libhiredis0.13:amd64 libhogweed4:amd64 libhtml-form-perl=6.11-1 libhtml-format-perl=2.16-2 libhtml-parser-perl=3.81-1 libhtml-tagset-perl=3.20-6 libhtml-tree-perl=5.07-3 libhttp-cookies-perl=6.10-1 libhttp-daemon-perl=6.14-2 libhttp-date-perl=6.05-2 libhttp-message-perl=6.44-1 libhttp-negotiate-perl=6.01-2 libhx509-5-heimdal:amd64 libice6:amd64 libicu55:amd64 libidn11:amd64 libijs-0.35:amd64 libio-html-perl=1.004-3 libio-socket-ssl-perl=2.081-2 libipc-system-simple-perl=1.30-2 libisc-export160 libisc160:amd64 libisccc140:amd64 libisccfg140:amd64 libisl15:amd64 libitm1:amd64 libjbig0:amd64 libjbig2dec0=0.19-3build2 libjemalloc1 libjpeg-turbo8:amd64 libjpeg8:amd64 libjs-jquery=3.6.1+dfsg+~3.5.14-1 libk5crypto3:amd64 libkeyutils1:amd64 libkpathsea6:amd64 libkrb5-26-heimdal:amd64 libkrb5-3:amd64 libkrb5support0:amd64 libksba8:amd64 liblcms2-2:amd64 libldap-2.4-2:amd64 libldb1:amd64 liblinear3:amd64 libllvm6.0:amd64 liblsan0:amd64 libltdl7:amd64 liblua5.2-0:amd64 liblwp-mediatypes-perl=6.04-2 liblwp-protocol-https-perl=6.10-1 liblwres141:amd64 liblzo2-2:amd64 libmagic1:amd64 libmail-sendmail-perl=0.80-3 libmailtools-perl=2.21-2 libmicrohttpd10 libmnl0:amd64 libmpc3:amd64 libmpdec2:amd64 libmpfr4:amd64 libmpx0:amd64 libnet-dbus-perl=1.2.0-2 libnet-http-perl=6.22-1 libnet-smtp-ssl-perl=1.04-2 libnet-ssleay-perl=1.92-2build2 libnettle6:amd64 libnpth0:amd64 libnspr4:amd64 libnss3:amd64 libnss3-nssdb libopenvas9 libopenvas9-dev libopts25:amd64 libp11-kit0:amd64 libpango-1.0-0:amd64 libpangocairo-1.0-0:amd64 libpangoft2-1.0-0:amd64 libpaper-utils=1.1.28build2 libpaper1:amd64 libpathplan4=2.42.2-7build3 libpcap0.8:amd64 libpci3:amd64 libpciaccess0:amd64 libperl5.22:amd64 libpipeline1:amd64 libpixman-1-0:amd64 libpng12-0:amd64 libpoppler58:amd64 libpopt0:amd64 libpotrace0=1.16-2 libptexenc1:amd64 libpython-stdlib:amd64 libpython2.7:amd64 libpython2.7-minimal:amd64 libpython2.7-stdlib:amd64 libpython3-stdlib:amd64 libpython3.5-minimal:amd64 libpython3.5-stdlib:amd64 libquadmath0:amd64 libroken18-heimdal:amd64 librpm3 librpmbuild3 librpmio3 librpmsign3 librtmp1:amd64 libruby2.3:amd64 libsasl2-2:amd64 libsasl2-modules:amd64 libsasl2-modules-db:amd64 libsensors4:amd64 libserf-1-1:amd64 libsm6:amd64 libsmbclient:amd64 libsnmp-base=5.9.3+dfsg-2ubuntu2 libsnmp30:amd64 libsqlite3-0:amd64 libssh-4:amd64 libssl1.0.0:amd64 libstdc++-5-dev:amd64 libsvn1:amd64 libsynctex1:amd64 libsys-hostname-long-perl=1.5-3 libtalloc2:amd64 libtasn1-6:amd64 libtcl8.6:amd64 libtdb1:amd64 libtevent0:amd64 libtexlua52:amd64 libtexluajit2:amd64 libtext-iconv-perl=1.7-8 libthai-data=0.1.29-1build1 libthai0:amd64 libtie-ixhash-perl=1.23-4 libtiff5:amd64 libtimedate-perl=2.3300-2 libtk8.6:amd64 libtsan0:amd64 libtxc-dxtn-s2tc0:amd64 libubsan0:amd64 libunistring0:amd64 liburi-perl=5.17-1ubuntu1 libutempter0:amd64 libvpx3:amd64 libwbclient0:amd64 libwhisker2-perl=2.5-1.2 libwind0-heimdal:amd64 libwrap0:amd64 libwww-perl=6.67-1 libwww-robotrules-perl=6.02-1 libx11-6:amd64 libx11-data=2:1.8.4-2 libx11-protocol-perl=0.56-9 libx11-xcb1:amd64 libxau6:amd64 libxaw7:amd64 libxcb-dri2-0:amd64 libxcb-dri3-0:amd64 libxcb-glx0:amd64 libxcb-present0:amd64 libxcb-render0:amd64 libxcb-shape0:amd64 libxcb-shm0:amd64 libxcb-sync1:amd64 libxcb1:amd64 libxcomposite1:amd64 libxcursor1:amd64 libxdamage1:amd64 libxdmcp6:amd64 libxext6:amd64 libxfixes3:amd64 libxft2:amd64 libxi6:amd64 libxinerama1:amd64 libxml-parser-perl=2.46-4 libxml-twig-perl=1:3.52-2 libxml-xpathengine-perl=0.14-2 libxml2:amd64 libxmu6:amd64 libxmuu1:amd64 libxpm4:amd64 libxrandr2:amd64 libxrender1:amd64 libxshmfence1:amd64 libxslt1.1:amd64 libxss1:amd64 libxt6:amd64 libxtables11:amd64 libxtst6:amd64 libxv1:amd64 libxxf86dga1:amd64 libxxf86vm1:amd64 libyaml-0-2:amd64 libyaml-tiny-perl=1.73-1 libzzip-0-13:amd64 linux-libc-dev:amd64 lmodern=2.005-1 lua-lpeg:amd64 make=4.3-4.1build1 man-db=2.11.2-1 manpages=6.03-1 manpages-dev=6.03-1 mime-support=3.66 ndiff=7.93+dfsg1-1 net-tools=2.10-0.1ubuntu3 netbase=6.4 nikto=1:2.1.5-3.1 nmap=7.93+dfsg1-1 nsis=3.08-3 nsis-common=3.08-3 openssh-client=1:9.0p1-1ubuntu8 openssl=3.0.8-1ubuntu1 openvas9 openvas9-cli openvas9-gsa openvas9-manager openvas9-scanner patch=2.7.6-7build2 perl=5.36.0-7 perl-modules-5.22 pinentry-curses=1.2.1-1ubuntu1 po-debconf=1.0.21+nmu1 poppler-data=0.4.12-1 postfix=3.7.4-2build1 preview-latex-style=12.2-1ubuntu1 prosper ps2eps=1.70-1 python python-beautifulsoup python-bs4 python-cairo python-cffi-backend python-chardet python-crypto python-cryptography python-defusedxml python-enum34 python-gi python-gobject python-gobject-2 python-gtk2 python-gtksourceview2 python-html5lib python-idna python-ipaddress python-ldb python-lxml python-minimal python-ndg-httpsclient python-openssl python-pkg-resources python-pyasn1 python-pypdf python-pysqlite2 python-requests python-samba python-scapy python-simplejson python-six python-soappy python-svn python-talloc python-tdb python-urllib3 python-wstools python2.7=2.7.18-13ubuntu2 python2.7-minimal=2.7.18-13ubuntu2 python3=3.11.2-1 python3-minimal=3.11.2-1 python3.5 python3.5-minimal rake=13.0.6-3 redis-server=5:7.0.8-4 redis-tools=5:7.0.8-4 rename=2.01-1 rpm=4.18.0+dfsg-1build1 rpm-common=4.18.0+dfsg-1build1 rpm2cpio=4.18.0+dfsg-1build1 rsync=3.2.7-1 ruby=1:3.1 ruby-did-you-mean=1.6.3-1 ruby-minitest=5.17.0-1 ruby-net-telnet=0.2.0-1 ruby-power-assert=2.0.3-1 ruby-test-unit=3.5.7-1 ruby2.3 rubygems-integration=1.18 samba-common=2:4.17.5+dfsg-2ubuntu3 samba-common-bin=2:4.17.5+dfsg-2ubuntu3 samba-libs:amd64 sgml-base=1.31 shared-mime-info=2.2-1 smbclient=2:4.17.5+dfsg-2ubuntu3 socat=1.7.4.4-2 sqlite3=3.40.1-1 sshpass=1.09-1 ssl-cert=1.1.2 t1utils=1.41-4build2 tcl=8.6.13 tcl8.6=8.6.13+dfsg-2 tcpd=7.6.q-32 tex-common=6.18 tex-gyre=20180621-6 texlive-base=2022.20230122-2 texlive-binaries=2022.20220321.62855-5build1 texlive-extra-utils=2022.20230122-2 texlive-font-utils=2022.20230122-2 texlive-fonts-recommended=2022.20230122-2 texlive-fonts-recommended-doc=2022.20230122-2 texlive-generic-recommended texlive-latex-base=2022.20230122-2 texlive-latex-extra=2022.20230122-2 texlive-latex-recommended=2022.20230122-2 texlive-pictures=2022.20230122-2 texlive-pstricks=2022.20230122-2 tipa=2:1.3-21 tk=8.6.13 tk8.6=8.6.13-2 tzdata=2022g-7ubuntu2 ucf=3.0043+nmu1 unzip=6.0-27ubuntu1 w3af w3af-console wapiti=3.0.4+dfsg-2 wget=1.21.3-1ubuntu1 x11-common=1:7.7+23ubuntu2 x11-utils=7.7+5build2 x11-xserver-utils=7.7+9build1 xauth=1:1.1.2-1 xbitmaps=1.1.1-2.1ubuntu1 xdg-utils=1.1.3-4.1ubuntu3 xml-core=0.18+nmu1 xsltproc=1.1.35-1 xterm=379-1ubuntu1 xz-utils=5.4.1-0.2 zip=3.0-13 -yq \\\n && rm -rf /var/lib/apt/lists/*\nRUN wget -q https://github.com/Arachni/arachni/releases/download/v1.5.1/arachni-1.5.1-0.5.12-linux-x86_64.tar.gz \\\n && tar -zxf arachni-1.5.1-0.5.12-linux-x86_64.tar.gz \\\n && mv arachni-1.5.1-0.5.12 /opt/arachni \\\n && ln -s /opt/arachni/bin/* /usr/local/bin/ \\\n && rm -rf arachni*\nRUN mkdir -p /var/run/redis \\\n && wget -q --no-check-certificate https://raw.githubusercontent.com/kurobeats/OpenVas-Management-Scripts/master/openvas-check-setup -O /openvas-check-setup \\\n && chmod +x /openvas-check-setup \\\n && sed -i 's/DAEMON_ARGS=\"\"/DAEMON_ARGS=\"-a 0.0.0.0 --client-watch-interval=0\"/' /etc/init.d/openvas-manager \\\n && sed -i 's/DAEMON_ARGS=\"\"/DAEMON_ARGS=\"--mlisten 127.0.0.1 -m 9390 --gnutls-priorities=SECURE128:-AES-128-CBC:-CAMELLIA-128-CBC:-VERS-SSL3.0:-VERS-TLS1.0\"/' /etc/init.d/openvas-gsa \\\n && sed -i '/^\\[ -n \"$HTTP_STS_MAX_AGE\" \\]/a[ -n \"$PUBLIC_HOSTNAME\" ] \\\n && DAEMON_ARGS=\"$DAEMON_ARGS --allow-header-host=$PUBLIC_HOSTNAME\"' /etc/init.d/openvas-gsa \\\n && sed -i 's/PORT_NUMBER=4000/PORT_NUMBER=443/' /etc/default/openvas-gsa \\\n && greenbone-nvt-sync > /dev/null \\\n && greenbone-scapdata-sync > /dev/null \\\n && greenbone-certdata-sync > /dev/null \\\n && BUILD=true /start \\\n && service openvas-scanner stop \\\n && service openvas-manager stop \\\n && service openvas-gsa stop \\\n && service redis-server stop\nENV BUILD=\"\"\nCMD /start\nEXPOSE 443/tcp 9390/tcp\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  Start by pulling down our existing container\n#  to sync 1.9 Gb of data from OpenVAS.\nFROM mikesplain/openvas\nFROM ubuntu:16.04\nCOPY --from=0 /var/lib/openvas /var/lib/openvas\nCOPY config/redis.config /etc/redis/redis.config\nCOPY config/sasl_passwd_template /\nCOPY config/main.cf_template /\nCOPY config/ldapUserSync/* /ldapUserSync/\nCOPY start /start\nENV DEBIAN_FRONTEND=\"noninteractive\" \\\n    OV_PASSWORD=\"admin\" \\\n    PUBLIC_HOSTNAME=\"openvas\"\nRUN apt-get update \\\n && apt-get install --no-install-recommends software-properties-common -yq \\\n && add-apt-repository ppa:mikesplain/openvas -y \\\n && add-apt-repository ppa:mrazavi/openvas -y \\\n && apt-get clean \\\n && apt-get update \\\n && apt-get install --no-install-recommends alien autotools-dev bind9-host binutils bsdmainutils build-essential bzip2 ca-certificates cpio cpp cpp-5 curl debhelper debugedit dh-python dh-strip-nondeterminism dirb dirmngr dnsutils dpkg-dev fakeroot file fontconfig fontconfig-config fonts-dejavu-core fonts-lato fonts-liberation fonts-lmodern fonts-texgyre g++ g++-5 gcc gcc-5 geoip-database gettext gettext-base ghostscript gir1.2-glib-2.0:amd64 gnupg-agent gnupg2 gnutls-bin graphviz groff-base gsfonts hicolor-icon-theme ifupdown intltool-debian iproute2 isc-dhcp-client isc-dhcp-common javascript-common ldap-utils libalgorithm-diff-perl libalgorithm-diff-xs-perl libalgorithm-merge-perl libapr1:amd64 libaprutil1:amd64 libarchive-zip-perl libarchive13:amd64 libasan2:amd64 libasn1-8-heimdal:amd64 libasprintf-dev:amd64 libasprintf0v5:amd64 libassuan0:amd64 libatk1.0-0:amd64 libatk1.0-data libatm1:amd64 libatomic1:amd64 libauthen-sasl-perl libavahi-client3:amd64 libavahi-common-data:amd64 libavahi-common3:amd64 libbind9-140:amd64 libblas-common libblas3 libbsd0:amd64 libc-dev-bin libc6-dev:amd64 libcairo2:amd64 libcc1-0:amd64 libcdt5 libcgraph6 libcilkrts5:amd64 libcroco3:amd64 libcups2:amd64 libcupsfilters1:amd64 libcupsimage2:amd64 libcurl3:amd64 libcurl3-gnutls:amd64 libdatrie1:amd64 libdbus-1-3:amd64 libdns-export162 libdns162:amd64 libdpkg-perl libdrm-amdgpu1:amd64 libdrm-common libdrm-intel1:amd64 libdrm-nouveau2:amd64 libdrm-radeon1:amd64 libdrm2:amd64 libedit2:amd64 libelf1:amd64 libencode-locale-perl libexpat1:amd64 libfakeroot:amd64 libffi6:amd64 libfile-basedir-perl libfile-desktopentry-perl libfile-fcntllock-perl libfile-homedir-perl libfile-listing-perl libfile-mimeinfo-perl libfile-stripnondeterminism-perl libfile-which-perl libfont-afm-perl libfontconfig1:amd64 libfontenc1:amd64 libfreetype6:amd64 libgcc-5-dev:amd64 libgd3:amd64 libgdbm3:amd64 libgdk-pixbuf2.0-0:amd64 libgdk-pixbuf2.0-common libgeoip1:amd64 libgettextpo-dev:amd64 libgettextpo0:amd64 libgirepository-1.0-1:amd64 libgl1-mesa-dri:amd64 libgl1-mesa-glx:amd64 libglapi-mesa:amd64 libglib2.0-0:amd64 libgmp10:amd64 libgnutls30:amd64 libgomp1:amd64 libgpgme11:amd64 libgraphite2-3:amd64 libgs9:amd64 libgs9-common libgssapi-krb5-2:amd64 libgssapi3-heimdal:amd64 libgtk2.0-0:amd64 libgtk2.0-bin libgtk2.0-common libgtksourceview2.0-0 libgtksourceview2.0-common libgvc6 libgvpr2 libharfbuzz-icu0:amd64 libharfbuzz0b:amd64 libhcrypto4-heimdal:amd64 libheimbase1-heimdal:amd64 libheimntlm0-heimdal:amd64 libhiredis0.13:amd64 libhogweed4:amd64 libhtml-form-perl libhtml-format-perl libhtml-parser-perl libhtml-tagset-perl libhtml-tree-perl libhttp-cookies-perl libhttp-daemon-perl libhttp-date-perl libhttp-message-perl libhttp-negotiate-perl libhx509-5-heimdal:amd64 libice6:amd64 libicu55:amd64 libidn11:amd64 libijs-0.35:amd64 libio-html-perl libio-socket-ssl-perl libipc-system-simple-perl libisc-export160 libisc160:amd64 libisccc140:amd64 libisccfg140:amd64 libisl15:amd64 libitm1:amd64 libjbig0:amd64 libjbig2dec0 libjemalloc1 libjpeg-turbo8:amd64 libjpeg8:amd64 libjs-jquery libk5crypto3:amd64 libkeyutils1:amd64 libkpathsea6:amd64 libkrb5-26-heimdal:amd64 libkrb5-3:amd64 libkrb5support0:amd64 libksba8:amd64 liblcms2-2:amd64 libldap-2.4-2:amd64 libldb1:amd64 liblinear3:amd64 libllvm6.0:amd64 liblsan0:amd64 libltdl7:amd64 liblua5.2-0:amd64 liblwp-mediatypes-perl liblwp-protocol-https-perl liblwres141:amd64 liblzo2-2:amd64 libmagic1:amd64 libmail-sendmail-perl libmailtools-perl libmicrohttpd10 libmnl0:amd64 libmpc3:amd64 libmpdec2:amd64 libmpfr4:amd64 libmpx0:amd64 libnet-dbus-perl libnet-http-perl libnet-smtp-ssl-perl libnet-ssleay-perl libnettle6:amd64 libnpth0:amd64 libnspr4:amd64 libnss3:amd64 libnss3-nssdb libopenvas9 libopenvas9-dev libopts25:amd64 libp11-kit0:amd64 libpango-1.0-0:amd64 libpangocairo-1.0-0:amd64 libpangoft2-1.0-0:amd64 libpaper-utils libpaper1:amd64 libpathplan4 libpcap0.8:amd64 libpci3:amd64 libpciaccess0:amd64 libperl5.22:amd64 libpipeline1:amd64 libpixman-1-0:amd64 libpng12-0:amd64 libpoppler58:amd64 libpopt0:amd64 libpotrace0 libptexenc1:amd64 libpython-stdlib:amd64 libpython2.7:amd64 libpython2.7-minimal:amd64 libpython2.7-stdlib:amd64 libpython3-stdlib:amd64 libpython3.5-minimal:amd64 libpython3.5-stdlib:amd64 libquadmath0:amd64 libroken18-heimdal:amd64 librpm3 librpmbuild3 librpmio3 librpmsign3 librtmp1:amd64 libruby2.3:amd64 libsasl2-2:amd64 libsasl2-modules:amd64 libsasl2-modules-db:amd64 libsensors4:amd64 libserf-1-1:amd64 libsm6:amd64 libsmbclient:amd64 libsnmp-base libsnmp30:amd64 libsqlite3-0:amd64 libssh-4:amd64 libssl1.0.0:amd64 libstdc++-5-dev:amd64 libsvn1:amd64 libsynctex1:amd64 libsys-hostname-long-perl libtalloc2:amd64 libtasn1-6:amd64 libtcl8.6:amd64 libtdb1:amd64 libtevent0:amd64 libtexlua52:amd64 libtexluajit2:amd64 libtext-iconv-perl libthai-data libthai0:amd64 libtie-ixhash-perl libtiff5:amd64 libtimedate-perl libtk8.6:amd64 libtsan0:amd64 libtxc-dxtn-s2tc0:amd64 libubsan0:amd64 libunistring0:amd64 liburi-perl libutempter0:amd64 libvpx3:amd64 libwbclient0:amd64 libwhisker2-perl libwind0-heimdal:amd64 libwrap0:amd64 libwww-perl libwww-robotrules-perl libx11-6:amd64 libx11-data libx11-protocol-perl libx11-xcb1:amd64 libxau6:amd64 libxaw7:amd64 libxcb-dri2-0:amd64 libxcb-dri3-0:amd64 libxcb-glx0:amd64 libxcb-present0:amd64 libxcb-render0:amd64 libxcb-shape0:amd64 libxcb-shm0:amd64 libxcb-sync1:amd64 libxcb1:amd64 libxcomposite1:amd64 libxcursor1:amd64 libxdamage1:amd64 libxdmcp6:amd64 libxext6:amd64 libxfixes3:amd64 libxft2:amd64 libxi6:amd64 libxinerama1:amd64 libxml-parser-perl libxml-twig-perl libxml-xpathengine-perl libxml2:amd64 libxmu6:amd64 libxmuu1:amd64 libxpm4:amd64 libxrandr2:amd64 libxrender1:amd64 libxshmfence1:amd64 libxslt1.1:amd64 libxss1:amd64 libxt6:amd64 libxtables11:amd64 libxtst6:amd64 libxv1:amd64 libxxf86dga1:amd64 libxxf86vm1:amd64 libyaml-0-2:amd64 libyaml-tiny-perl libzzip-0-13:amd64 linux-libc-dev:amd64 lmodern lua-lpeg:amd64 make man-db manpages manpages-dev mime-support ndiff net-tools netbase nikto nmap nsis nsis-common openssh-client openssl openvas9 openvas9-cli openvas9-gsa openvas9-manager openvas9-scanner patch perl perl-modules-5.22 pinentry-curses po-debconf poppler-data postfix preview-latex-style prosper ps2eps python python-beautifulsoup python-bs4 python-cairo python-cffi-backend python-chardet python-crypto python-cryptography python-defusedxml python-enum34 python-gi python-gobject python-gobject-2 python-gtk2 python-gtksourceview2 python-html5lib python-idna python-ipaddress python-ldb python-lxml python-minimal python-ndg-httpsclient python-openssl python-pkg-resources python-pyasn1 python-pypdf python-pysqlite2 python-requests python-samba python-scapy python-simplejson python-six python-soappy python-svn python-talloc python-tdb python-urllib3 python-wstools python2.7 python2.7-minimal python3 python3-minimal python3.5 python3.5-minimal rake redis-server redis-tools rename rpm rpm-common rpm2cpio rsync ruby ruby-did-you-mean ruby-minitest ruby-net-telnet ruby-power-assert ruby-test-unit ruby2.3 rubygems-integration samba-common samba-common-bin samba-libs:amd64 sgml-base shared-mime-info smbclient socat sqlite3 sshpass ssl-cert t1utils tcl tcl8.6 tcpd tex-common tex-gyre texlive-base texlive-binaries texlive-extra-utils texlive-font-utils texlive-fonts-recommended texlive-fonts-recommended-doc texlive-generic-recommended texlive-latex-base texlive-latex-extra texlive-latex-recommended texlive-pictures texlive-pstricks tipa tk tk8.6 tzdata ucf unzip w3af w3af-console wapiti wget x11-common x11-utils x11-xserver-utils xauth xbitmaps xdg-utils xml-core xsltproc xterm xz-utils zip -yq \\\n && rm -rf /var/lib/apt/lists/*\nRUN wget -q https://github.com/Arachni/arachni/releases/download/v1.5.1/arachni-1.5.1-0.5.12-linux-x86_64.tar.gz \\\n && tar -zxf arachni-1.5.1-0.5.12-linux-x86_64.tar.gz \\\n && mv arachni-1.5.1-0.5.12 /opt/arachni \\\n && ln -s /opt/arachni/bin/* /usr/local/bin/ \\\n && rm -rf arachni*\nRUN mkdir -p /var/run/redis \\\n && wget -q --no-check-certificate https://raw.githubusercontent.com/kurobeats/OpenVas-Management-Scripts/master/openvas-check-setup -O /openvas-check-setup \\\n && chmod +x /openvas-check-setup \\\n && sed -i 's/DAEMON_ARGS=\"\"/DAEMON_ARGS=\"-a 0.0.0.0 --client-watch-interval=0\"/' /etc/init.d/openvas-manager \\\n && sed -i 's/DAEMON_ARGS=\"\"/DAEMON_ARGS=\"--mlisten 127.0.0.1 -m 9390 --gnutls-priorities=SECURE128:-AES-128-CBC:-CAMELLIA-128-CBC:-VERS-SSL3.0:-VERS-TLS1.0\"/' /etc/init.d/openvas-gsa \\\n && sed -i '/^\\[ -n \"$HTTP_STS_MAX_AGE\" \\]/a[ -n \"$PUBLIC_HOSTNAME\" ] \\\n && DAEMON_ARGS=\"$DAEMON_ARGS --allow-header-host=$PUBLIC_HOSTNAME\"' /etc/init.d/openvas-gsa \\\n && sed -i 's/PORT_NUMBER=4000/PORT_NUMBER=443/' /etc/default/openvas-gsa \\\n && greenbone-nvt-sync > /dev/null \\\n && greenbone-scapdata-sync > /dev/null \\\n && greenbone-certdata-sync > /dev/null \\\n && BUILD=true /start \\\n && service openvas-scanner stop \\\n && service openvas-manager stop \\\n && service openvas-gsa stop \\\n && service redis-server stop\nENV BUILD=\"\"\nCMD /start\nEXPOSE 443/tcp 9390/tcp\n","injectedSmells":[],"originalDockerfileHash":"e5dde09d01a8278b8d4dff4b697b45e9","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   Start by pulling down our existing container\n#   to sync 1.9 Gb of data from OpenVAS.\nFROM mikesplain/openvas\nFROM ubuntu:16.04\nCOPY --from=0 /var/lib/openvas /var/lib/openvas\nCOPY config/redis.config /etc/redis/redis.config\nCOPY config/sasl_passwd_template /\nCOPY config/main.cf_template /\nCOPY config/ldapUserSync/* /ldapUserSync/\nCOPY start /start\nENV DEBIAN_FRONTEND=\"noninteractive\" \\\n    OV_PASSWORD=\"admin\" \\\n    PUBLIC_HOSTNAME=\"openvas\"\nRUN apt-get update \\\n && apt-get install --no-install-recommends software-properties-common -yq \\\n && add-apt-repository ppa:mikesplain/openvas -y \\\n && add-apt-repository ppa:mrazavi/openvas -y \\\n && apt-get clean \\\n && apt-get update \\\n && apt-get install --no-install-recommends alien autotools-dev bind9-host binutils bsdmainutils build-essential bzip2 ca-certificates cpio cpp cpp-5 curl debhelper debugedit dh-python dh-strip-nondeterminism dirb dirmngr dnsutils dpkg-dev fakeroot file fontconfig fontconfig-config fonts-dejavu-core fonts-lato fonts-liberation fonts-lmodern fonts-texgyre g++ g++-5 gcc gcc-5 geoip-database gettext gettext-base ghostscript gir1.2-glib-2.0:amd64 gnupg-agent gnupg2 gnutls-bin graphviz groff-base gsfonts hicolor-icon-theme ifupdown intltool-debian iproute2 isc-dhcp-client isc-dhcp-common javascript-common ldap-utils libalgorithm-diff-perl libalgorithm-diff-xs-perl libalgorithm-merge-perl libapr1:amd64 libaprutil1:amd64 libarchive-zip-perl libarchive13:amd64 libasan2:amd64 libasn1-8-heimdal:amd64 libasprintf-dev:amd64 libasprintf0v5:amd64 libassuan0:amd64 libatk1.0-0:amd64 libatk1.0-data libatm1:amd64 libatomic1:amd64 libauthen-sasl-perl libavahi-client3:amd64 libavahi-common-data:amd64 libavahi-common3:amd64 libbind9-140:amd64 libblas-common libblas3 libbsd0:amd64 libc-dev-bin libc6-dev:amd64 libcairo2:amd64 libcc1-0:amd64 libcdt5 libcgraph6 libcilkrts5:amd64 libcroco3:amd64 libcups2:amd64 libcupsfilters1:amd64 libcupsimage2:amd64 libcurl3:amd64 libcurl3-gnutls:amd64 libdatrie1:amd64 libdbus-1-3:amd64 libdns-export162 libdns162:amd64 libdpkg-perl libdrm-amdgpu1:amd64 libdrm-common libdrm-intel1:amd64 libdrm-nouveau2:amd64 libdrm-radeon1:amd64 libdrm2:amd64 libedit2:amd64 libelf1:amd64 libencode-locale-perl libexpat1:amd64 libfakeroot:amd64 libffi6:amd64 libfile-basedir-perl libfile-desktopentry-perl libfile-fcntllock-perl libfile-homedir-perl libfile-listing-perl libfile-mimeinfo-perl libfile-stripnondeterminism-perl libfile-which-perl libfont-afm-perl libfontconfig1:amd64 libfontenc1:amd64 libfreetype6:amd64 libgcc-5-dev:amd64 libgd3:amd64 libgdbm3:amd64 libgdk-pixbuf2.0-0:amd64 libgdk-pixbuf2.0-common libgeoip1:amd64 libgettextpo-dev:amd64 libgettextpo0:amd64 libgirepository-1.0-1:amd64 libgl1-mesa-dri:amd64 libgl1-mesa-glx:amd64 libglapi-mesa:amd64 libglib2.0-0:amd64 libgmp10:amd64 libgnutls30:amd64 libgomp1:amd64 libgpgme11:amd64 libgraphite2-3:amd64 libgs9:amd64 libgs9-common libgssapi-krb5-2:amd64 libgssapi3-heimdal:amd64 libgtk2.0-0:amd64 libgtk2.0-bin libgtk2.0-common libgtksourceview2.0-0 libgtksourceview2.0-common libgvc6 libgvpr2 libharfbuzz-icu0:amd64 libharfbuzz0b:amd64 libhcrypto4-heimdal:amd64 libheimbase1-heimdal:amd64 libheimntlm0-heimdal:amd64 libhiredis0.13:amd64 libhogweed4:amd64 libhtml-form-perl libhtml-format-perl libhtml-parser-perl libhtml-tagset-perl libhtml-tree-perl libhttp-cookies-perl libhttp-daemon-perl libhttp-date-perl libhttp-message-perl libhttp-negotiate-perl libhx509-5-heimdal:amd64 libice6:amd64 libicu55:amd64 libidn11:amd64 libijs-0.35:amd64 libio-html-perl libio-socket-ssl-perl libipc-system-simple-perl libisc-export160 libisc160:amd64 libisccc140:amd64 libisccfg140:amd64 libisl15:amd64 libitm1:amd64 libjbig0:amd64 libjbig2dec0 libjemalloc1 libjpeg-turbo8:amd64 libjpeg8:amd64 libjs-jquery libk5crypto3:amd64 libkeyutils1:amd64 libkpathsea6:amd64 libkrb5-26-heimdal:amd64 libkrb5-3:amd64 libkrb5support0:amd64 libksba8:amd64 liblcms2-2:amd64 libldap-2.4-2:amd64 libldb1:amd64 liblinear3:amd64 libllvm6.0:amd64 liblsan0:amd64 libltdl7:amd64 liblua5.2-0:amd64 liblwp-mediatypes-perl liblwp-protocol-https-perl liblwres141:amd64 liblzo2-2:amd64 libmagic1:amd64 libmail-sendmail-perl libmailtools-perl libmicrohttpd10 libmnl0:amd64 libmpc3:amd64 libmpdec2:amd64 libmpfr4:amd64 libmpx0:amd64 libnet-dbus-perl libnet-http-perl libnet-smtp-ssl-perl libnet-ssleay-perl libnettle6:amd64 libnpth0:amd64 libnspr4:amd64 libnss3:amd64 libnss3-nssdb libopenvas9 libopenvas9-dev libopts25:amd64 libp11-kit0:amd64 libpango-1.0-0:amd64 libpangocairo-1.0-0:amd64 libpangoft2-1.0-0:amd64 libpaper-utils libpaper1:amd64 libpathplan4 libpcap0.8:amd64 libpci3:amd64 libpciaccess0:amd64 libperl5.22:amd64 libpipeline1:amd64 libpixman-1-0:amd64 libpng12-0:amd64 libpoppler58:amd64 libpopt0:amd64 libpotrace0 libptexenc1:amd64 libpython-stdlib:amd64 libpython2.7:amd64 libpython2.7-minimal:amd64 libpython2.7-stdlib:amd64 libpython3-stdlib:amd64 libpython3.5-minimal:amd64 libpython3.5-stdlib:amd64 libquadmath0:amd64 libroken18-heimdal:amd64 librpm3 librpmbuild3 librpmio3 librpmsign3 librtmp1:amd64 libruby2.3:amd64 libsasl2-2:amd64 libsasl2-modules:amd64 libsasl2-modules-db:amd64 libsensors4:amd64 libserf-1-1:amd64 libsm6:amd64 libsmbclient:amd64 libsnmp-base libsnmp30:amd64 libsqlite3-0:amd64 libssh-4:amd64 libssl1.0.0:amd64 libstdc++-5-dev:amd64 libsvn1:amd64 libsynctex1:amd64 libsys-hostname-long-perl libtalloc2:amd64 libtasn1-6:amd64 libtcl8.6:amd64 libtdb1:amd64 libtevent0:amd64 libtexlua52:amd64 libtexluajit2:amd64 libtext-iconv-perl libthai-data libthai0:amd64 libtie-ixhash-perl libtiff5:amd64 libtimedate-perl libtk8.6:amd64 libtsan0:amd64 libtxc-dxtn-s2tc0:amd64 libubsan0:amd64 libunistring0:amd64 liburi-perl libutempter0:amd64 libvpx3:amd64 libwbclient0:amd64 libwhisker2-perl libwind0-heimdal:amd64 libwrap0:amd64 libwww-perl libwww-robotrules-perl libx11-6:amd64 libx11-data libx11-protocol-perl libx11-xcb1:amd64 libxau6:amd64 libxaw7:amd64 libxcb-dri2-0:amd64 libxcb-dri3-0:amd64 libxcb-glx0:amd64 libxcb-present0:amd64 libxcb-render0:amd64 libxcb-shape0:amd64 libxcb-shm0:amd64 libxcb-sync1:amd64 libxcb1:amd64 libxcomposite1:amd64 libxcursor1:amd64 libxdamage1:amd64 libxdmcp6:amd64 libxext6:amd64 libxfixes3:amd64 libxft2:amd64 libxi6:amd64 libxinerama1:amd64 libxml-parser-perl libxml-twig-perl libxml-xpathengine-perl libxml2:amd64 libxmu6:amd64 libxmuu1:amd64 libxpm4:amd64 libxrandr2:amd64 libxrender1:amd64 libxshmfence1:amd64 libxslt1.1:amd64 libxss1:amd64 libxt6:amd64 libxtables11:amd64 libxtst6:amd64 libxv1:amd64 libxxf86dga1:amd64 libxxf86vm1:amd64 libyaml-0-2:amd64 libyaml-tiny-perl libzzip-0-13:amd64 linux-libc-dev:amd64 lmodern lua-lpeg:amd64 make man-db manpages manpages-dev mime-support ndiff net-tools netbase nikto nmap nsis nsis-common openssh-client openssl openvas9 openvas9-cli openvas9-gsa openvas9-manager openvas9-scanner patch perl perl-modules-5.22 pinentry-curses po-debconf poppler-data postfix preview-latex-style prosper ps2eps python python-beautifulsoup python-bs4 python-cairo python-cffi-backend python-chardet python-crypto python-cryptography python-defusedxml python-enum34 python-gi python-gobject python-gobject-2 python-gtk2 python-gtksourceview2 python-html5lib python-idna python-ipaddress python-ldb python-lxml python-minimal python-ndg-httpsclient python-openssl python-pkg-resources python-pyasn1 python-pypdf python-pysqlite2 python-requests python-samba python-scapy python-simplejson python-six python-soappy python-svn python-talloc python-tdb python-urllib3 python-wstools python2.7 python2.7-minimal python3 python3-minimal python3.5 python3.5-minimal rake redis-server redis-tools rename rpm rpm-common rpm2cpio rsync ruby ruby-did-you-mean ruby-minitest ruby-net-telnet ruby-power-assert ruby-test-unit ruby2.3 rubygems-integration samba-common samba-common-bin samba-libs:amd64 sgml-base shared-mime-info smbclient socat sqlite3 sshpass ssl-cert t1utils tcl tcl8.6 tcpd tex-common tex-gyre texlive-base texlive-binaries texlive-extra-utils texlive-font-utils texlive-fonts-recommended texlive-fonts-recommended-doc texlive-generic-recommended texlive-latex-base texlive-latex-extra texlive-latex-recommended texlive-pictures texlive-pstricks tipa tk tk8.6 tzdata ucf unzip w3af w3af-console wapiti wget x11-common x11-utils x11-xserver-utils xauth xbitmaps xdg-utils xml-core xsltproc xterm xz-utils zip -yq \\\n && rm -rf /var/lib/apt/lists/*\nRUN wget -q https://github.com/Arachni/arachni/releases/download/v1.5.1/arachni-1.5.1-0.5.12-linux-x86_64.tar.gz \\\n && tar -zxf arachni-1.5.1-0.5.12-linux-x86_64.tar.gz \\\n && mv arachni-1.5.1-0.5.12 /opt/arachni \\\n && ln -s /opt/arachni/bin/* /usr/local/bin/ \\\n && rm -rf arachni*\nRUN mkdir -p /var/run/redis \\\n && wget -q --no-check-certificate https://raw.githubusercontent.com/kurobeats/OpenVas-Management-Scripts/master/openvas-check-setup -O /openvas-check-setup \\\n && chmod +x /openvas-check-setup \\\n && sed -i 's/DAEMON_ARGS=\"\"/DAEMON_ARGS=\"-a 0.0.0.0 --client-watch-interval=0\"/' /etc/init.d/openvas-manager \\\n && sed -i 's/DAEMON_ARGS=\"\"/DAEMON_ARGS=\"--mlisten 127.0.0.1 -m 9390 --gnutls-priorities=SECURE128:-AES-128-CBC:-CAMELLIA-128-CBC:-VERS-SSL3.0:-VERS-TLS1.0\"/' /etc/init.d/openvas-gsa \\\n && sed -i '/^\\[ -n \"$HTTP_STS_MAX_AGE\" \\]/a[ -n \"$PUBLIC_HOSTNAME\" ] \\\n && DAEMON_ARGS=\"$DAEMON_ARGS --allow-header-host=$PUBLIC_HOSTNAME\"' /etc/init.d/openvas-gsa \\\n && sed -i 's/PORT_NUMBER=4000/PORT_NUMBER=443/' /etc/default/openvas-gsa \\\n && greenbone-nvt-sync > /dev/null \\\n && greenbone-scapdata-sync > /dev/null \\\n && greenbone-certdata-sync > /dev/null \\\n && BUILD=true /start \\\n && service openvas-scanner stop \\\n && service openvas-manager stop \\\n && service openvas-gsa stop \\\n && service redis-server stop\nENV BUILD=\"\"\nCMD /start\nEXPOSE 443/tcp 9390/tcp\n","originalDockerfileUglifiedHash":"0a759d05a8ca285773c03343a6befdc2","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/f866e018613bfec510f3a683898dcda0b84158d2.dockerfile"}