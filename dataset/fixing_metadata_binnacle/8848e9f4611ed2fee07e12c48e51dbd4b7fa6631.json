{"seed":3275184421,"processedDockerfileHash":"9cf38a6d363187d0090eef97a61c3b8b","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","pin-package-manager-versions-apt-get","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM debian:stretch-slim\nARG DEBIAN_FRONTEND=noninteractive\nARG BUILD_DATE\nARG DOCKER_TAG\nARG VCS_REF\nLABEL maintainer=\"Emmanuel Dyan <emmanueldyan@gmail.com>\" \\\n      org.label-schema.build-date=\"$BUILD_DATE\" \\\n      org.label-schema.name=\"$DOCKER_TAG\" \\\n      org.label-schema.description=\"Docker PHP Image based on Debian and including main modules\" \\\n      org.label-schema.url=\"https://cloud.docker.com/u/edyan/repository/docker/edyan/php\" \\\n      org.label-schema.vcs-url=\"https://github.com/edyan/docker-php\" \\\n      org.label-schema.vcs-ref=\"$VCS_REF\" \\\n      org.label-schema.schema-version=\"1.0\" \\\n      org.label-schema.vendor=\"edyan\" \\\n      org.label-schema.version=\"$VERSION\" \\\n      org.label-schema.docker.cmd=\"docker run -d --rm $DOCKER_TAG\"\n#   Set a default conf for apt install\nRUN echo 'apt::install-recommends \"false\";' > /etc/apt/apt.conf.d/no-install-recommends \\\n && apt-get update -y \\\n && apt-get install --no-install-recommends apt-transport-https gnupg ca-certificates curl -y \\\n && echo \"deb https://packages.sury.org/php/ stretch main\" > /etc/apt/sources.list.d/sury.org.list \\\n && curl -sS https://packages.sury.org/php/apt.gpg | apt-key add - \\\n && apt-get update -y \\\n && apt-get upgrade -y \\\n && apt-get install --no-install-recommends iptables php7.1-bcmath php7.1-bz2 php7.1-cli php7.1-curl php7.1-fpm php7.1-gd php7.1-gmp php7.1-imap php7.1-interbase php7.1-intl php7.1-json php7.1-ldap php7.1-mbstring php7.1-mcrypt php7.1-mysql php7.1-odbc php7.1-opcache php7.1-pgsql php7.1-readline php7.1-soap php7.1-sqlite3 php7.1-xml php7.1-xmlrpc php7.1-zip php-apcu php-geoip php-imagick php-ssh2 php-tideways -y \\\n && rm -rf /usr/lib/php/20131226 /usr/lib/php/20151012 /usr/lib/php/20170718 /usr/lib/php/20180731 \\\n && rm -rf /etc/php/5.6 /etc/php/7.0 /etc/php/7.2 /etc/php/7.3 \\\n && apt-get install --no-install-recommends build-essential libmemcached11 libmemcachedutil2 libmemcached-dev php-pear php7.1-dev pkg-config zlib1g-dev -y \\\n && pecl channel-update pecl.php.net \\\n && pecl install memcached mongodb redis xdebug \\\n && echo \"extension=mongodb.so\" > /etc/php/7.1/mods-available/mongodb.ini \\\n && phpenmod mongodb \\\n && echo \"extension=memcached.so\" > /etc/php/7.1/mods-available/memcached.ini \\\n && phpenmod memcached \\\n && echo \"extension=redis.so\" > /etc/php/7.1/mods-available/redis.ini \\\n && phpenmod redis \\\n && echo \"zend_extension=xdebug.so\" > /etc/php/7.1/mods-available/xdebug.ini \\\n && phpenmod xdebug \\\n && apt-get purge --autoremove -y build-essential libmemcached-dev php-pear php7.1-dev pkg-config zlib1g-dev \\\n && apt-get autoremove -y \\\n && apt-get autoclean \\\n && apt-get clean \\\n && find /root /tmp -mindepth 1 -delete \\\n && rm -rf /build /var/lib/apt/lists/* /usr/share/man/* /usr/share/doc/* /var/cache/* /var/log/* /usr/share/php/docs /usr/share/php/tests\nCOPY php-cli.ini /etc/php/7.1/cli/conf.d/30-custom-php.ini\nCOPY php-fpm.ini /etc/php/7.1/fpm/conf.d/30-custom-php.ini\nCOPY www.conf /etc/php/7.1/fpm/pool.d/\n#   For custom Configuration that comes from outside (via a docker compose mount)\nRUN mkdir /etc/php/7.1/fpm/user-conf.d \\\n && echo \"; Default empty file\" > /etc/php/7.1/fpm/user-conf.d/example.conf \\\n && mkdir /var/log/php \\\n && mkdir /home/www-data \\\n && chown www-data:www-data /home/www-data \\\n && usermod -d /home/www-data www-data \\\n && mkdir -p /run/php \\\n && chown www-data:www-data /run/php\nCOPY run.sh /run.sh\nRUN chmod +x /run.sh\nENV ENVIRONMENT=\"dev\"\nENV PHP_ENABLED_MODULES=\"\\\"\nENV FPM_UID=\"33\"\nENV FPM_GID=\"33\"\nEXPOSE 9000/tcp\nCMD [\"/run.sh\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM debian:stretch-slim\nARG DEBIAN_FRONTEND=noninteractive\nARG BUILD_DATE\nARG DOCKER_TAG\nARG VCS_REF\nLABEL maintainer=\"Emmanuel Dyan <emmanueldyan@gmail.com>\" \\\n      org.label-schema.build-date=\"$BUILD_DATE\" \\\n      org.label-schema.name=\"$DOCKER_TAG\" \\\n      org.label-schema.description=\"Docker PHP Image based on Debian and including main modules\" \\\n      org.label-schema.url=\"https://cloud.docker.com/u/edyan/repository/docker/edyan/php\" \\\n      org.label-schema.vcs-url=\"https://github.com/edyan/docker-php\" \\\n      org.label-schema.vcs-ref=\"$VCS_REF\" \\\n      org.label-schema.schema-version=\"1.0\" \\\n      org.label-schema.vendor=\"edyan\" \\\n      org.label-schema.version=\"$VERSION\" \\\n      org.label-schema.docker.cmd=\"docker run -d --rm $DOCKER_TAG\"\n#  Set a default conf for apt install\nRUN echo 'apt::install-recommends \"false\";' > /etc/apt/apt.conf.d/no-install-recommends \\\n && apt-get update -y \\\n && apt-get install -y apt-transport-https gnupg ca-certificates curl \\\n && echo \"deb https://packages.sury.org/php/ stretch main\" > /etc/apt/sources.list.d/sury.org.list \\\n && curl -sS https://packages.sury.org/php/apt.gpg | apt-key add - \\\n && apt-get update -y \\\n && apt-get upgrade -y \\\n && apt-get install -y iptables php7.1-bcmath php7.1-bz2 php7.1-cli php7.1-curl php7.1-fpm php7.1-gd php7.1-gmp php7.1-imap php7.1-interbase php7.1-intl php7.1-json php7.1-ldap php7.1-mbstring php7.1-mcrypt php7.1-mysql php7.1-odbc php7.1-opcache php7.1-pgsql php7.1-readline php7.1-soap php7.1-sqlite3 php7.1-xml php7.1-xmlrpc php7.1-zip php-apcu php-geoip php-imagick php-ssh2 php-tideways \\\n && rm -rf /usr/lib/php/20131226 /usr/lib/php/20151012 /usr/lib/php/20170718 /usr/lib/php/20180731 \\\n && rm -rf /etc/php/5.6 /etc/php/7.0 /etc/php/7.2 /etc/php/7.3 \\\n && apt-get install -y build-essential libmemcached11 libmemcachedutil2 libmemcached-dev php-pear php7.1-dev pkg-config zlib1g-dev \\\n && pecl channel-update pecl.php.net \\\n && pecl install memcached mongodb redis xdebug \\\n && echo \"extension=mongodb.so\" > /etc/php/7.1/mods-available/mongodb.ini \\\n && phpenmod mongodb \\\n && echo \"extension=memcached.so\" > /etc/php/7.1/mods-available/memcached.ini \\\n && phpenmod memcached \\\n && echo \"extension=redis.so\" > /etc/php/7.1/mods-available/redis.ini \\\n && phpenmod redis \\\n && echo \"zend_extension=xdebug.so\" > /etc/php/7.1/mods-available/xdebug.ini \\\n && phpenmod xdebug \\\n && apt-get purge --autoremove -y build-essential libmemcached-dev php-pear php7.1-dev pkg-config zlib1g-dev \\\n && apt-get autoremove -y \\\n && apt-get autoclean \\\n && apt-get clean \\\n && find /root /tmp -mindepth 1 -delete \\\n && rm -rf /build /var/lib/apt/lists/* /usr/share/man/* /usr/share/doc/* /var/cache/* /var/log/* /usr/share/php/docs /usr/share/php/tests\nCOPY php-cli.ini /etc/php/7.1/cli/conf.d/30-custom-php.ini\nCOPY php-fpm.ini /etc/php/7.1/fpm/conf.d/30-custom-php.ini\nCOPY www.conf /etc/php/7.1/fpm/pool.d/\n#  For custom Configuration that comes from outside (via a docker compose mount)\nRUN mkdir /etc/php/7.1/fpm/user-conf.d \\\n && echo \"; Default empty file\" > /etc/php/7.1/fpm/user-conf.d/example.conf \\\n && mkdir /var/log/php \\\n && mkdir /home/www-data \\\n && chown www-data:www-data /home/www-data \\\n && usermod -d /home/www-data www-data \\\n && mkdir -p /run/php \\\n && chown www-data:www-data /run/php\nCOPY run.sh /run.sh\nRUN chmod +x /run.sh\nENV ENVIRONMENT=\"dev\"\nENV PHP_ENABLED_MODULES=\"\"\\\"\"\nENV FPM_UID=\"33\"\nENV FPM_GID=\"33\"\nEXPOSE 9000/tcp\nCMD [\"/run.sh\"]\n","injectedSmells":[],"originalDockerfileHash":"d163363c38b3e7ac5d979371c3375925","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM debian:stretch-slim\nARG DEBIAN_FRONTEND=noninteractive\nARG BUILD_DATE\nARG DOCKER_TAG\nARG VCS_REF\nLABEL maintainer=\"Emmanuel Dyan <emmanueldyan@gmail.com>\" \\\n      org.label-schema.build-date=\"$BUILD_DATE\" \\\n      org.label-schema.name=\"$DOCKER_TAG\" \\\n      org.label-schema.description=\"Docker PHP Image based on Debian and including main modules\" \\\n      org.label-schema.url=\"https://cloud.docker.com/u/edyan/repository/docker/edyan/php\" \\\n      org.label-schema.vcs-url=\"https://github.com/edyan/docker-php\" \\\n      org.label-schema.vcs-ref=\"$VCS_REF\" \\\n      org.label-schema.schema-version=\"1.0\" \\\n      org.label-schema.vendor=\"edyan\" \\\n      org.label-schema.version=\"$VERSION\" \\\n      org.label-schema.docker.cmd=\"docker run -d --rm $DOCKER_TAG\"\n#   Set a default conf for apt install\nRUN echo 'apt::install-recommends \"false\";' > /etc/apt/apt.conf.d/no-install-recommends \\\n && apt-get update -y \\\n && apt-get install apt-transport-https gnupg ca-certificates curl -y \\\n && echo \"deb https://packages.sury.org/php/ stretch main\" > /etc/apt/sources.list.d/sury.org.list \\\n && curl -sS https://packages.sury.org/php/apt.gpg | apt-key add - \\\n && apt-get update -y \\\n && apt-get upgrade -y \\\n && apt-get install iptables php7.1-bcmath php7.1-bz2 php7.1-cli php7.1-curl php7.1-fpm php7.1-gd php7.1-gmp php7.1-imap php7.1-interbase php7.1-intl php7.1-json php7.1-ldap php7.1-mbstring php7.1-mcrypt php7.1-mysql php7.1-odbc php7.1-opcache php7.1-pgsql php7.1-readline php7.1-soap php7.1-sqlite3 php7.1-xml php7.1-xmlrpc php7.1-zip php-apcu php-geoip php-imagick php-ssh2 php-tideways -y \\\n && rm -rf /usr/lib/php/20131226 /usr/lib/php/20151012 /usr/lib/php/20170718 /usr/lib/php/20180731 \\\n && rm -rf /etc/php/5.6 /etc/php/7.0 /etc/php/7.2 /etc/php/7.3 \\\n && apt-get install build-essential libmemcached11 libmemcachedutil2 libmemcached-dev php-pear php7.1-dev pkg-config zlib1g-dev -y \\\n && pecl channel-update pecl.php.net \\\n && pecl install memcached mongodb redis xdebug \\\n && echo \"extension=mongodb.so\" > /etc/php/7.1/mods-available/mongodb.ini \\\n && phpenmod mongodb \\\n && echo \"extension=memcached.so\" > /etc/php/7.1/mods-available/memcached.ini \\\n && phpenmod memcached \\\n && echo \"extension=redis.so\" > /etc/php/7.1/mods-available/redis.ini \\\n && phpenmod redis \\\n && echo \"zend_extension=xdebug.so\" > /etc/php/7.1/mods-available/xdebug.ini \\\n && phpenmod xdebug \\\n && apt-get purge --autoremove -y build-essential libmemcached-dev php-pear php7.1-dev pkg-config zlib1g-dev \\\n && apt-get autoremove -y \\\n && apt-get autoclean \\\n && apt-get clean \\\n && find /root /tmp -mindepth 1 -delete \\\n && rm -rf /build /var/lib/apt/lists/* /usr/share/man/* /usr/share/doc/* /var/cache/* /var/log/* /usr/share/php/docs /usr/share/php/tests\nCOPY php-cli.ini /etc/php/7.1/cli/conf.d/30-custom-php.ini\nCOPY php-fpm.ini /etc/php/7.1/fpm/conf.d/30-custom-php.ini\nCOPY www.conf /etc/php/7.1/fpm/pool.d/\n#   For custom Configuration that comes from outside (via a docker compose mount)\nRUN mkdir /etc/php/7.1/fpm/user-conf.d \\\n && echo \"; Default empty file\" > /etc/php/7.1/fpm/user-conf.d/example.conf \\\n && mkdir /var/log/php \\\n && mkdir /home/www-data \\\n && chown www-data:www-data /home/www-data \\\n && usermod -d /home/www-data www-data \\\n && mkdir -p /run/php \\\n && chown www-data:www-data /run/php\nCOPY run.sh /run.sh\nRUN chmod +x /run.sh\nENV ENVIRONMENT=\"dev\"\nENV PHP_ENABLED_MODULES=\"\\\"\nENV FPM_UID=\"33\"\nENV FPM_GID=\"33\"\nEXPOSE 9000/tcp\nCMD [\"/run.sh\"]\n","originalDockerfileUglifiedHash":"02255136ebdba64f83b4b0e99440a1e1","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/8848e9f4611ed2fee07e12c48e51dbd4b7fa6631.dockerfile"}