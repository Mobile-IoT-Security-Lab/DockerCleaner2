{"seed":3269294928,"processedDockerfileHash":"13295a2e3af92ab55416130478086742","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apt-get","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM nvidia/cuda:7.5-cudnn5-devel-ubuntu14.04\nLABEL version=\"0.1.0\"\nLABEL version_convention=\"Semantic Versioning (see www.semver.org)\"\nLABEL title=\"Dockerfile for TextBoxes++ with CRNN\"\nLABEL description=\"This Dockerfile sets up TextBoxes++and CRNN with all their respective dependencies.Make sure to run with nvidia-docker\"\nRUN apt-get update \\\n && apt-get install --no-install-recommends autoconf autoconf-archive automake binutils-dev bison build-essential cmake curl flex g++ git libatlas-base-dev libboost-all-dev libdouble-conversion-dev libedit-dev libevent-dev libgeos-dev libgflags-dev libgoogle-glog-dev libhdf5-serial-dev libjemalloc-dev libkrb5-dev libleveldb-dev liblmdb-dev liblz4-dev liblzma-dev libmatio-dev libnuma-dev libopencv-dev libprotobuf-dev libpython3-dev libpython-dev libsasl2-dev libsnappy-dev libssl-dev libtool pkg-config protobuf-compiler python-dev python-numpy python-opencv python-pip python-scipy wget zlib1g-dev -y \\\n && rm -rf /var/lib/apt/lists/*\nENV CAFFE_ROOT=\"/opt/caffe\"\nWORKDIR $CAFFE_ROOT\n#  #######################################\n#  ### Install CRNN Dependencies #########\n#  #######################################\n#   Install pytorch\nWORKDIR /root\nRUN git clone https://github.com/torch/distro.git /root/torch --recursive\nRUN cd /root/torch \\\n && bash install-deps\nRUN cd /root/torch \\\n && ./install.sh\n#   Update the PATHs\n#   This is normally done by calling\n#       source ~/torch/install/bin/torch-activate\nENV LUA_PATH=\"/root/.luarocks/share/lua/5.1/?.lua;/root/.luarocks/share/lua/5.1/?/init.lua;/root/torch/install/share/lua/5.1/?.lua;/root/torch/install/share/lua/5.1/?/init.lua;./?.lua;/root/torch/install/share/luajit-2.1.0-beta1/?.lua;/usr/local/share/lua/5.1/?.lua;/usr/local/share/lua/5.1/?/init.lua\"\nENV LUA_CPATH=\"/root/.luarocks/lib/lua/5.1/?.so;/root/torch/install/lib/lua/5.1/?.so;./?.so;/usr/local/lib/lua/5.1/?.so;/usr/local/lib/lua/5.1/loadall.so\"\nENV PATH=\"/root/torch/install/bin:$PATH\"\nENV LD_LIBRARY_PATH=\"/root/torch/install/lib:$LD_LIBRARY_PATH\"\nENV DYLD_LIBRARY_PATH=\"/root/torch/install/lib:$DYLD_LIBRARY_PATH\"\nENV LUA_CPATH=\"/root/torch/install/lib/?.so;$LUA_CPATH\"\n#   Install Folly\nRUN git clone -b v0.35.0 --depth 1 https://github.com/facebook/folly\nRUN cd /root/folly/folly \\\n && autoreconf -ivf \\\n && ./configure \\\n && make \\\n && make install \\\n && ldconfig\n#   Install fbthrift\nRUN git clone -b v0.24.0 --depth 1 https://github.com/facebook/fbthrift\nCOPY patches/fbthrift.diff ${CAFFE_ROOT}/patches/fbthrift.diff\nRUN cd /root/fbthrift \\\n && git apply ${CAFFE_ROOT}/patches/fbthrift.diff\nRUN cd /root/fbthrift/thrift \\\n && autoreconf -ivf \\\n && ./configure \\\n && make \\\n && make install\n#   Install thpp\nRUN git clone -b v1.0 https://github.com/facebook/thpp\nCOPY patches/thpp.diff ${CAFFE_ROOT}/patches/thpp.diff\nRUN cd /root/thpp \\\n && git apply ${CAFFE_ROOT}/patches/thpp.diff\nRUN cd /root/thpp/thpp \\\n && ./build.sh\n#   Install fblualib\nRUN git clone -b v1.0 https://github.com/facebook/fblualib\nRUN cd /root/fblualib/fblualib \\\n && ./build.sh\n#  #######################################\n#  ### Install CRNN ######################\n#  #######################################\nCOPY crnn/src ${CAFFE_ROOT}/crnn/src\n#   Install CRNN\nRUN cd ${CAFFE_ROOT}/crnn/src \\\n && ./build_cpp.sh\n#  #######################################\n#  ### Install Textboxes++ Dependencies ##\n#  #######################################\nWORKDIR $CAFFE_ROOT\n#   Cython needs to be installed seperately\nCOPY python ${CAFFE_ROOT}/python\nRUN pip install Cython==0.28.5\nRUN pip install -r python/requirements.txt\n#  #######################################\n#  ### Install Textboxes++ ###############\n#  #######################################\nWORKDIR $CAFFE_ROOT\n#   Include Build context\nCOPY caffe.cloc ${CAFFE_ROOT}/caffe.cloc\nCOPY cmake ${CAFFE_ROOT}/cmake\nCOPY CMakeLists.txt ${CAFFE_ROOT}/CMakeLists.txt\nCOPY include ${CAFFE_ROOT}/include\nCOPY matlab ${CAFFE_ROOT}/matlab\nCOPY src ${CAFFE_ROOT}/src\nCOPY tools ${CAFFE_ROOT}/tools\nCOPY LICENSE ${CAFFE_ROOT}/LICENSE\nCOPY scripts ${CAFFE_ROOT}/scripts\n#   CUDA_ARCH_NAME=Manual is a workaround the lack of compute_60 or higher in cuda7.5's cuda\n#   Required for recent GPUs\nRUN mkdir build \\\n && cd build \\\n && cmake .. -DCUDA_ARCH_NAME=Manual \\\n && make -j\"$( nproc ;)\"\n#   HACK: OpenCV can be confused by (the lack of) this driver in some systems\nRUN ln /dev/null /dev/raw1394\nENV PYCAFFE_ROOT=\"$CAFFE_ROOT/python\"\nENV PYTHONPATH=\"$PYCAFFE_ROOT:$PYTHONPATH\"\nENV PATH=\"$CAFFE_ROOT/build/tools:$PYCAFFE_ROOT:$PATH\"\nRUN echo \"$CAFFE_ROOT/build/lib\" >> /etc/ld.so.conf.d/caffe.conf \\\n && ldconfig\n#  #######################################\n#  ### COPY Context required at runtime ##\n#  #######################################\nCOPY crnn/data ${CAFFE_ROOT}/crnn/data\nCOPY data ${CAFFE_ROOT}/data\nCOPY demo_images ${CAFFE_ROOT}/demo_images\nCOPY examples ${CAFFE_ROOT}/examples\nCOPY README.md ${CAFFE_ROOT}/README.md\nWORKDIR /opt/caffe\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM nvidia/cuda:7.5-cudnn5-devel-ubuntu14.04\nLABEL version=\"0.1.0\"\nLABEL version_convention=\"Semantic Versioning (see www.semver.org)\"\nLABEL title=\"Dockerfile for TextBoxes++ with CRNN\"\nLABEL description=\"This Dockerfile sets up TextBoxes++and CRNN with all their respective dependencies.Make sure to run with nvidia-docker\"\nRUN apt-get update \\\n && apt-get install --no-install-recommends autoconf autoconf-archive automake binutils-dev bison build-essential cmake curl flex g++ git libatlas-base-dev libboost-all-dev libdouble-conversion-dev libedit-dev libevent-dev libgeos-dev libgflags-dev libgoogle-glog-dev libhdf5-serial-dev libjemalloc-dev libkrb5-dev libleveldb-dev liblmdb-dev liblz4-dev liblzma-dev libmatio-dev libnuma-dev libopencv-dev libprotobuf-dev libpython3-dev libpython-dev libsasl2-dev libsnappy-dev libssl-dev libtool pkg-config protobuf-compiler python-dev python-numpy python-opencv python-pip python-scipy wget zlib1g-dev -y \\\n && rm -rf /var/lib/apt/lists/*\nENV CAFFE_ROOT=\"/opt/caffe\"\nWORKDIR $CAFFE_ROOT\n# #######################################\n# ### Install CRNN Dependencies #########\n# #######################################\n#  Install pytorch\nWORKDIR /root\nRUN git clone https://github.com/torch/distro.git /root/torch --recursive\nRUN cd /root/torch \\\n && bash install-deps\nRUN cd /root/torch \\\n && ./install.sh\n#  Update the PATHs\n#  This is normally done by calling\n#      source ~/torch/install/bin/torch-activate\nENV LUA_PATH=\"/root/.luarocks/share/lua/5.1/?.lua;/root/.luarocks/share/lua/5.1/?/init.lua;/root/torch/install/share/lua/5.1/?.lua;/root/torch/install/share/lua/5.1/?/init.lua;./?.lua;/root/torch/install/share/luajit-2.1.0-beta1/?.lua;/usr/local/share/lua/5.1/?.lua;/usr/local/share/lua/5.1/?/init.lua\"\nENV LUA_CPATH=\"/root/.luarocks/lib/lua/5.1/?.so;/root/torch/install/lib/lua/5.1/?.so;./?.so;/usr/local/lib/lua/5.1/?.so;/usr/local/lib/lua/5.1/loadall.so\"\nENV PATH=\"/root/torch/install/bin:$PATH\"\nENV LD_LIBRARY_PATH=\"/root/torch/install/lib:$LD_LIBRARY_PATH\"\nENV DYLD_LIBRARY_PATH=\"/root/torch/install/lib:$DYLD_LIBRARY_PATH\"\nENV LUA_CPATH=\"/root/torch/install/lib/?.so;$LUA_CPATH\"\n#  Install Folly\nRUN git clone -b v0.35.0 --depth 1 https://github.com/facebook/folly\nRUN cd /root/folly/folly \\\n && autoreconf -ivf \\\n && ./configure \\\n && make \\\n && make install \\\n && ldconfig\n#  Install fbthrift\nRUN git clone -b v0.24.0 --depth 1 https://github.com/facebook/fbthrift\nCOPY patches/fbthrift.diff ${CAFFE_ROOT}/patches/fbthrift.diff\nRUN cd /root/fbthrift \\\n && git apply ${CAFFE_ROOT}/patches/fbthrift.diff\nRUN cd /root/fbthrift/thrift \\\n && autoreconf -ivf \\\n && ./configure \\\n && make \\\n && make install\n#  Install thpp\nRUN git clone -b v1.0 https://github.com/facebook/thpp\nCOPY patches/thpp.diff ${CAFFE_ROOT}/patches/thpp.diff\nRUN cd /root/thpp \\\n && git apply ${CAFFE_ROOT}/patches/thpp.diff\nRUN cd /root/thpp/thpp \\\n && ./build.sh\n#  Install fblualib\nRUN git clone -b v1.0 https://github.com/facebook/fblualib\nRUN cd /root/fblualib/fblualib \\\n && ./build.sh\n# #######################################\n# ### Install CRNN ######################\n# #######################################\nCOPY crnn/src ${CAFFE_ROOT}/crnn/src\n#  Install CRNN\nRUN cd ${CAFFE_ROOT}/crnn/src \\\n && ./build_cpp.sh\n# #######################################\n# ### Install Textboxes++ Dependencies ##\n# #######################################\nWORKDIR $CAFFE_ROOT\n#  Cython needs to be installed seperately\nCOPY python ${CAFFE_ROOT}/python\nRUN pip install Cython==0.28.5\nRUN pip install -r python/requirements.txt\n# #######################################\n# ### Install Textboxes++ ###############\n# #######################################\nWORKDIR $CAFFE_ROOT\n#  Include Build context\nCOPY caffe.cloc ${CAFFE_ROOT}/caffe.cloc\nCOPY cmake ${CAFFE_ROOT}/cmake\nCOPY CMakeLists.txt ${CAFFE_ROOT}/CMakeLists.txt\nCOPY include ${CAFFE_ROOT}/include\nCOPY matlab ${CAFFE_ROOT}/matlab\nCOPY src ${CAFFE_ROOT}/src\nCOPY tools ${CAFFE_ROOT}/tools\nCOPY LICENSE ${CAFFE_ROOT}/LICENSE\nCOPY scripts ${CAFFE_ROOT}/scripts\n#  CUDA_ARCH_NAME=Manual is a workaround the lack of compute_60 or higher in cuda7.5's cuda\n#  Required for recent GPUs\nRUN mkdir build \\\n && cd build \\\n && cmake .. -DCUDA_ARCH_NAME=Manual \\\n && make -j\"$( nproc ;)\"\n#  HACK: OpenCV can be confused by (the lack of) this driver in some systems\nRUN ln /dev/null /dev/raw1394\nENV PYCAFFE_ROOT=\"$CAFFE_ROOT/python\"\nENV PYTHONPATH=\"$PYCAFFE_ROOT:$PYTHONPATH\"\nENV PATH=\"$CAFFE_ROOT/build/tools:$PYCAFFE_ROOT:$PATH\"\nRUN echo \"$CAFFE_ROOT/build/lib\" >> /etc/ld.so.conf.d/caffe.conf \\\n && ldconfig\n# #######################################\n# ### COPY Context required at runtime ##\n# #######################################\nCOPY crnn/data ${CAFFE_ROOT}/crnn/data\nCOPY data ${CAFFE_ROOT}/data\nCOPY demo_images ${CAFFE_ROOT}/demo_images\nCOPY examples ${CAFFE_ROOT}/examples\nCOPY README.md ${CAFFE_ROOT}/README.md\nWORKDIR /opt/caffe\n","injectedSmells":[],"originalDockerfileHash":"eb75aca1c1026f985b46c2b5c2dd7b50","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM nvidia/cuda:7.5-cudnn5-devel-ubuntu14.04\nLABEL version=\"0.1.0\"\nLABEL version_convention=\"Semantic Versioning (see www.semver.org)\"\nLABEL title=\"Dockerfile for TextBoxes++ with CRNN\"\nLABEL description=\"This Dockerfile sets up TextBoxes++and CRNN with all their respective dependencies.Make sure to run with nvidia-docker\"\nRUN apt-get update \\\n && apt-get install --no-install-recommends autoconf autoconf-archive automake binutils-dev bison build-essential cmake curl flex g++ git libatlas-base-dev libboost-all-dev libdouble-conversion-dev libedit-dev libevent-dev libgeos-dev libgflags-dev libgoogle-glog-dev libhdf5-serial-dev libjemalloc-dev libkrb5-dev libleveldb-dev liblmdb-dev liblz4-dev liblzma-dev libmatio-dev libnuma-dev libopencv-dev libprotobuf-dev libpython3-dev libpython-dev libsasl2-dev libsnappy-dev libssl-dev libtool pkg-config protobuf-compiler python-dev python-numpy python-opencv python-pip python-scipy wget zlib1g-dev -y \\\n && rm -rf /var/lib/apt/lists/*\nENV CAFFE_ROOT=\"/opt/caffe\"\nWORKDIR $CAFFE_ROOT\n#  #######################################\n#  ### Install CRNN Dependencies #########\n#  #######################################\n#   Install pytorch\nWORKDIR /root\nRUN git clone https://github.com/torch/distro.git /root/torch --recursive\nRUN cd /root/torch \\\n && bash install-deps\nRUN cd /root/torch \\\n && ./install.sh\n#   Update the PATHs\n#   This is normally done by calling\n#       source ~/torch/install/bin/torch-activate\nENV LUA_PATH=\"/root/.luarocks/share/lua/5.1/?.lua;/root/.luarocks/share/lua/5.1/?/init.lua;/root/torch/install/share/lua/5.1/?.lua;/root/torch/install/share/lua/5.1/?/init.lua;./?.lua;/root/torch/install/share/luajit-2.1.0-beta1/?.lua;/usr/local/share/lua/5.1/?.lua;/usr/local/share/lua/5.1/?/init.lua\"\nENV LUA_CPATH=\"/root/.luarocks/lib/lua/5.1/?.so;/root/torch/install/lib/lua/5.1/?.so;./?.so;/usr/local/lib/lua/5.1/?.so;/usr/local/lib/lua/5.1/loadall.so\"\nENV PATH=\"/root/torch/install/bin:$PATH\"\nENV LD_LIBRARY_PATH=\"/root/torch/install/lib:$LD_LIBRARY_PATH\"\nENV DYLD_LIBRARY_PATH=\"/root/torch/install/lib:$DYLD_LIBRARY_PATH\"\nENV LUA_CPATH=\"/root/torch/install/lib/?.so;$LUA_CPATH\"\n#   Install Folly\nRUN git clone -b v0.35.0 --depth 1 https://github.com/facebook/folly\nRUN cd /root/folly/folly \\\n && autoreconf -ivf \\\n && ./configure \\\n && make \\\n && make install \\\n && ldconfig\n#   Install fbthrift\nRUN git clone -b v0.24.0 --depth 1 https://github.com/facebook/fbthrift\nCOPY patches/fbthrift.diff ${CAFFE_ROOT}/patches/fbthrift.diff\nRUN cd /root/fbthrift \\\n && git apply ${CAFFE_ROOT}/patches/fbthrift.diff\nRUN cd /root/fbthrift/thrift \\\n && autoreconf -ivf \\\n && ./configure \\\n && make \\\n && make install\n#   Install thpp\nRUN git clone -b v1.0 https://github.com/facebook/thpp\nCOPY patches/thpp.diff ${CAFFE_ROOT}/patches/thpp.diff\nRUN cd /root/thpp \\\n && git apply ${CAFFE_ROOT}/patches/thpp.diff\nRUN cd /root/thpp/thpp \\\n && ./build.sh\n#   Install fblualib\nRUN git clone -b v1.0 https://github.com/facebook/fblualib\nRUN cd /root/fblualib/fblualib \\\n && ./build.sh\n#  #######################################\n#  ### Install CRNN ######################\n#  #######################################\nCOPY crnn/src ${CAFFE_ROOT}/crnn/src\n#   Install CRNN\nRUN cd ${CAFFE_ROOT}/crnn/src \\\n && ./build_cpp.sh\n#  #######################################\n#  ### Install Textboxes++ Dependencies ##\n#  #######################################\nWORKDIR $CAFFE_ROOT\n#   Cython needs to be installed seperately\nCOPY python ${CAFFE_ROOT}/python\nRUN pip install Cython==0.28.5\nRUN pip install -r python/requirements.txt\n#  #######################################\n#  ### Install Textboxes++ ###############\n#  #######################################\nWORKDIR $CAFFE_ROOT\n#   Include Build context\nCOPY caffe.cloc ${CAFFE_ROOT}/caffe.cloc\nCOPY cmake ${CAFFE_ROOT}/cmake\nCOPY CMakeLists.txt ${CAFFE_ROOT}/CMakeLists.txt\nCOPY include ${CAFFE_ROOT}/include\nCOPY matlab ${CAFFE_ROOT}/matlab\nCOPY src ${CAFFE_ROOT}/src\nCOPY tools ${CAFFE_ROOT}/tools\nCOPY LICENSE ${CAFFE_ROOT}/LICENSE\nCOPY scripts ${CAFFE_ROOT}/scripts\n#   CUDA_ARCH_NAME=Manual is a workaround the lack of compute_60 or higher in cuda7.5's cuda\n#   Required for recent GPUs\nRUN mkdir build \\\n && cd build \\\n && cmake .. -DCUDA_ARCH_NAME=Manual \\\n && make -j\"$( nproc ;)\"\n#   HACK: OpenCV can be confused by (the lack of) this driver in some systems\nRUN ln /dev/null /dev/raw1394\nENV PYCAFFE_ROOT=\"$CAFFE_ROOT/python\"\nENV PYTHONPATH=\"$PYCAFFE_ROOT:$PYTHONPATH\"\nENV PATH=\"$CAFFE_ROOT/build/tools:$PYCAFFE_ROOT:$PATH\"\nRUN echo \"$CAFFE_ROOT/build/lib\" >> /etc/ld.so.conf.d/caffe.conf \\\n && ldconfig\n#  #######################################\n#  ### COPY Context required at runtime ##\n#  #######################################\nCOPY crnn/data ${CAFFE_ROOT}/crnn/data\nCOPY data ${CAFFE_ROOT}/data\nCOPY demo_images ${CAFFE_ROOT}/demo_images\nCOPY examples ${CAFFE_ROOT}/examples\nCOPY README.md ${CAFFE_ROOT}/README.md\nWORKDIR /opt/caffe\n","originalDockerfileUglifiedHash":"4d2fa3a4ed6d57c15427759c42d0e484","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/f053a39aa67250433b6edac584fb1333d776385b.dockerfile"}