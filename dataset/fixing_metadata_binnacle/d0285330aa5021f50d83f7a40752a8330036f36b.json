{"seed":2245465382,"processedDockerfileHash":"2761517e102b1d6cf945ac58f7cd4540","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["have-a-healthcheck","have-a-user"],"processedDockerfile":"#\n#   Dockerfile for WordPress\n#\nFROM ubuntu:16.04\nMAINTAINER Azure App Service Container Images <appsvc-images@microsoft.com>\n#   ========\n#   ENV vars\n#   ========\n#   apache httpd\nENV HTTPD_VERSION=\"\\\"2.4.25\\\"\"\nENV HTTPD_DOWNLOAD_URL=\"\\\"https://www.apache.org/dist/httpd/httpd-$HTTPD_VERSION.tar.gz\\\"\"\nENV HTTPD_SHA1=\"\\\"377c62dc6b25c9378221111dec87c28f8fe6ac69\\\"\"\nENV HTTPD_SOURCE=\"\\\"/usr/src/httpd\\\"\"\nENV HTTPD_HOME=\"\\\"/usr/local/httpd\\\"\"\nENV HTTPD_CONF_DIR=\"\\\"$HTTPD_HOME/conf\\\"\"\nENV HTTPD_CONF_FILE=\"\\\"$HTTPD_CONF_DIR/httpd.conf\\\"\"\nENV HTTPD_LOG_DIR=\"\\\"/home/LogFiles/httpd\\\"\"\nENV PATH=\"\\\"$HTTPD_HOME/bin\\\":$PATH\"\n#   mariadb\nENV MARIADB_DATA_DIR=\"\\\"/home/data\\\"\"\nENV MARIADB_LOG_DIR=\"\\\"/home/LogFiles/mysql\\\"\"\n#   php\nENV PHP_VERSION=\"\\\"7.1.2\\\"\"\nENV PHP_DOWNLOAD_URL=\"\\\"https://secure.php.net/get/php-$PHP_VERSION.tar.gz/from/this/mirror\\\"\"\nENV PHP_SHA256=\"\\\"e6773217c9c719ca22abb104ae3d437d53daceaf31faf2e5eeb1f9f5028005d8\\\"\"\nENV PHP_SOURCE=\"\\\"/usr/src/php\\\"\"\nENV PHP_HOME=\"\\\"/usr/local/php\\\"\"\nENV PHP_CONF_DIR=\"\\\"$PHP_HOME/etc\\\"\"\nENV PHP_CONF_DIR_SCAN=\"\\\"$PHP_CONF_DIR/conf.d\\\"\"\nENV PATH=\"\\\"$PHP_HOME/bin\\\":$PATH\"\n#   redis\nENV REDIS_VERSION=\"\\\"3.2.8\\\"\"\nENV REDIS_DOWNLOAD_URL=\"\\\"http://download.redis.io/releases/redis-$REDIS_VERSION.tar.gz\\\"\"\nENV REDIS_SHA1=\"\\\"6780d1abb66f33a97aad0edbe020403d0a15b67f\\\"\"\nENV REDIS_SOURCE=\"\\\"/usr/src/redis\\\"\"\nENV REDIS_HOME=\"\\\"/usr/local/redis\\\"\"\nENV PATH=\"\\\"$REDIS_HOME/bin\\\":$PATH\"\n#   phpMyAdmin\nENV PHPMYADMIN_VERSION=\"\\\"4.6.6\\\"\"\nENV PHPMYADMIN_DOWNLOAD_URL=\"\\\"https://files.phpmyadmin.net/phpMyAdmin/$PHPMYADMIN_VERSION/phpMyAdmin-$PHPMYADMIN_VERSION-all-languages.tar.gz\\\"\"\nENV PHPMYADMIN_SHA256=\"\\\"54086600558613b31c4daddf4ae58fbc1c252a2b8e3e6fae12f851f78677d72e\\\"\"\nENV PHPMYADMIN_SOURCE=\"\\\"/usr/src/phpmyadmin\\\"\"\nENV PHPMYADMIN_HOME=\"\\\"/home/phpmyadmin\\\"\"\n#   wordpress\nENV WORDPRESS_VERSION=\"\\\"4.7.3\\\"\"\nENV WORDPRESS_DOWNLOAD_URL=\"\\\"https://wordpress.org/wordpress-$WORDPRESS_VERSION.tar.gz\\\"\"\nENV WORDPRESS_SHA1=\"\\\"35adcd8162eae00d5bc37f35344fdc06b22ffc98\\\"\"\nENV WORDPRESS_SOURCE=\"\\\"/usr/src/wordpress\\\"\"\nENV WORDPRESS_HOME=\"\\\"/home/site/wwwroot\\\"\"\n#\nENV DOCKER_BUILD_HOME=\"\\\"/dockerbuild\\\"\"\n#   ====================\n#   Download and Install\n#   1. tools\n#   2. apache httpd\n#   3. mariadb\n#   4. php\n#   5. redis\n#   6. phpmyadmin\n#   7. wordpress\n#   ====================\nWORKDIR $DOCKER_BUILD_HOME\nRUN set -ex \\\n && tools=\" g++ gcc make pkg-config wget \" \\\n && apt-get update \\\n && apt-get install --no-install-recommends $tools -y -V \\\n && rm -r /var/lib/apt/lists/* \\\n && mkdir -p $HTTPD_SOURCE \\\n && mkdir -p $HTTPD_HOME \\\n && httpdBuildtimeDeps=\" libpcre++-dev libssl-dev \" \\\n && httpdRuntimeDeps=\" libapr1 libaprutil1 libaprutil1-ldap libapr1-dev libaprutil1-dev \" \\\n && apt-get update \\\n && apt-get install --no-install-recommends $httpdBuildtimeDeps $httpdRuntimeDeps -y -V \\\n && rm -r /var/lib/apt/lists/* \\\n && cd $DOCKER_BUILD_HOME \\\n && wget -O httpd.tar.gz \"$HTTPD_DOWNLOAD_URL\" --no-check-certificate \\\n && echo \"$HTTPD_SHA1 *httpd.tar.gz\" | sha1sum -c - \\\n && tar -xf httpd.tar.gz -C $HTTPD_SOURCE --strip-components=1 \\\n && cd $HTTPD_SOURCE \\\n && ./configure --prefix=$HTTPD_HOME --with-mpm=prefork --enable-mods-shared=reallyall --enable-ssl \\\n && make -j \"$( nproc ;)\" \\\n && make install \\\n && make clean \\\n && rm -rf $HTTPD_SOURCE $HTTPD_HOME/man $HTTPD_HOME/manual \\\n && rm $DOCKER_BUILD_HOME/httpd.tar.gz \\\n && apt-get purge -y -V -o APT::AutoRemove::RecommendsImportant=false --auto-remove $httpdBuildtimeDeps \\\n && apt-get update \\\n && DEBIAN_FRONTEND=noninteractive apt-get install mariadb-server -y -V --no-install-recommends \\\n && rm -r /var/lib/apt/lists/* \\\n && mkdir -p $PHP_SOURCE \\\n && mkdir -p $PHP_HOME \\\n && phpBuildtimeDeps=\" libbz2-dev libgmp-dev libicu-dev libldap2-dev libssl-dev libxml2-dev \" \\\n && phpRuntimeDeps=\" libcurl4-openssl-dev libjpeg-dev libpng12-dev libxml2 \" \\\n && apt-get update \\\n && apt-get install --no-install-recommends $phpBuildtimeDeps $phpRuntimeDeps -y -V \\\n && rm -rf /var/lib/apt/lists/* \\\n && ln -s /usr/include/x86_64-linux-gnu/gmp.h /usr/include/gmp.h \\\n && ln -s /usr/lib/x86_64-linux-gnu/libldap.so /usr/lib/libldap.so \\\n && ln -s /usr/lib/x86_64-linux-gnu/liblber.so /usr/lib/liblber.so \\\n && cd $DOCKER_BUILD_HOME \\\n && wget -O php.tar.gz \"$PHP_DOWNLOAD_URL\" --no-check-certificate \\\n && echo \"$PHP_SHA256 *php.tar.gz\" | sha256sum -c - \\\n && tar -xf php.tar.gz -C $PHP_SOURCE --strip-components=1 \\\n && cd $PHP_SOURCE \\\n && ./configure --prefix=$PHP_HOME --disable-cgi --disable-pdo --enable-bcmath --enable-intl --enable-mbstring --enable-zip --with-apxs2=$HTTPD_HOME/bin/apxs --with-bz2 --with-config-file-path=$PHP_CONF_DIR --with-config-file-scan-dir=$PHP_CONF_DIR_SCAN --with-curl --with-gd --with-jpeg-dir --with-png-dir --with-gmp --with-ldap --with-mysqli=mysqlnd --with-openssl \\\n && make -j \"$( nproc ;)\" \\\n && make install \\\n && make clean \\\n && rm -rf $PHP_SOURCE \\\n && rm -rf $PHP_HOME/php/man \\\n && rm $DOCKER_BUILD_HOME/php.tar.gz \\\n && apt-get purge -y -V -o APT::AutoRemove::RecommendsImportant=false --auto-remove $phpBuildtimeDeps \\\n && mkdir -p $REDIS_SOURCE \\\n && mkdir -p $REDIS_HOME \\\n && cd $DOCKER_BUILD_HOME \\\n && wget -O redis.tar.gz \"$REDIS_DOWNLOAD_URL\" --no-check-certificate \\\n && echo \"$REDIS_SHA1 *redis.tar.gz\" | sha1sum -c - \\\n && tar -xf redis.tar.gz -C $REDIS_SOURCE --strip-components=1 \\\n && cd $REDIS_SOURCE \\\n && make -j \"$( nproc ;)\" \\\n && make PREFIX=$REDIS_HOME install \\\n && rm -rf $REDIS_SOURCE E \\\n && rm $DOCKER_BUILD_HOME/redis.tar.gz \\\n && mkdir -p $PHPMYADMIN_SOURCE \\\n && cd $PHPMYADMIN_SOURCE \\\n && wget -O phpmyadmin.tar.gz \"$PHPMYADMIN_DOWNLOAD_URL\" --no-check-certificate \\\n && echo \"$PHPMYADMIN_SHA256 *phpmyadmin.tar.gz\" | sha256sum -c - \\\n && mkdir -p $WORDPRESS_SOURCE \\\n && cd $WORDPRESS_SOURCE \\\n && wget -O wordpress.tar.gz \"$WORDPRESS_DOWNLOAD_URL\" --no-check-certificate \\\n && echo \"$WORDPRESS_SHA1 *wordpress.tar.gz\" | sha1sum -c - \\\n && apt-get purge -y -V -o APT::AutoRemove::RecommendsImportant=false --auto-remove $tools \\\n && apt-get autoremove -y\n#   =========\n#   Configure\n#   =========\n#   httpd confs\nCOPY httpd.conf $HTTPD_CONF_DIR/\nCOPY httpd-modules.conf $HTTPD_CONF_DIR/\nCOPY httpd-php.conf $HTTPD_CONF_DIR/\nCOPY httpd-wordpress.conf $HTTPD_CONF_DIR/\nCOPY httpd-phpmyadmin.conf $HTTPD_CONF_DIR/\n#   php confs\nCOPY php.ini $PHP_CONF_DIR/\nCOPY php-opcache.ini $PHP_CONF_DIR_SCAN/\n#   wordpress conf\nCOPY wp-config.php.microsoft $WORDPRESS_SOURCE/\n#   phpmyadmin conf\nCOPY phpmyadmin-config.inc.php $PHPMYADMIN_SOURCE/\nRUN set -ex \\\n && echo 'Include conf/httpd-php.conf' >> $HTTPD_CONF_FILE \\\n && sed -i 's/skip_log_error/#skip_log_error/g' /etc/mysql/mariadb.conf.d/50-mysqld_safe.cnf \\\n && sed -i 's/syslog/#syslog/g' /etc/mysql/mariadb.conf.d/50-mysqld_safe.cnf \\\n && test ! -d /var/lib/php/sessions \\\n && mkdir -p /var/lib/php/sessions \\\n && chown www-data:www-data /var/lib/php/sessions \\\n && test ! -d /var/www \\\n && mkdir -p /var/www \\\n && echo '<html><head><meta http-equiv=\"refresh\" content=\"30\" /><meta http-equiv=\"pragma\" content=\"no-cache\" /><meta http-equiv=\"cache-control\" content=\"no-cache\" /><title>Installing WordPress</title></head><body>Installing WordPress ... This could be done in minutes. Please refresh your browser later.</body></html>' > /var/www/index.html \\\n && chown -R www-data:www-data /var/www \\\n && ln -s $WORDPRESS_HOME /var/www/wordpress \\\n && ln -s $PHPMYADMIN_HOME /var/www/phpmyadmin \\\n && rm -rf /var/log/mysql \\\n && ln -s $MARIADB_LOG_DIR /var/log/mysql \\\n && rm -rf /var/log/httpd \\\n && ln -s $HTTPD_LOG_DIR /var/log/httpd\n#   =====\n#   final\n#   =====\nCOPY entrypoint.sh /usr/local/bin/\nRUN chmod +x /usr/local/bin/entrypoint.sh\nEXPOSE 80/tcp\nENTRYPOINT [\"entrypoint.sh\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#\n#  Dockerfile for WordPress\n#\nFROM ubuntu:16.04\nMAINTAINER Azure App Service Container Images <appsvc-images@microsoft.com>\n#  ========\n#  ENV vars\n#  ========\n#  apache httpd\nENV HTTPD_VERSION=\"\\\"2.4.25\\\"\"\nENV HTTPD_DOWNLOAD_URL=\"\\\"https://www.apache.org/dist/httpd/httpd-$HTTPD_VERSION.tar.gz\\\"\"\nENV HTTPD_SHA1=\"\\\"377c62dc6b25c9378221111dec87c28f8fe6ac69\\\"\"\nENV HTTPD_SOURCE=\"\\\"/usr/src/httpd\\\"\"\nENV HTTPD_HOME=\"\\\"/usr/local/httpd\\\"\"\nENV HTTPD_CONF_DIR=\"\\\"$HTTPD_HOME/conf\\\"\"\nENV HTTPD_CONF_FILE=\"\\\"$HTTPD_CONF_DIR/httpd.conf\\\"\"\nENV HTTPD_LOG_DIR=\"\\\"/home/LogFiles/httpd\\\"\"\nENV PATH=\"\\\"$HTTPD_HOME/bin\\\":$PATH\"\n#  mariadb\nENV MARIADB_DATA_DIR=\"\\\"/home/data\\\"\"\nENV MARIADB_LOG_DIR=\"\\\"/home/LogFiles/mysql\\\"\"\n#  php\nENV PHP_VERSION=\"\\\"7.1.2\\\"\"\nENV PHP_DOWNLOAD_URL=\"\\\"https://secure.php.net/get/php-$PHP_VERSION.tar.gz/from/this/mirror\\\"\"\nENV PHP_SHA256=\"\\\"e6773217c9c719ca22abb104ae3d437d53daceaf31faf2e5eeb1f9f5028005d8\\\"\"\nENV PHP_SOURCE=\"\\\"/usr/src/php\\\"\"\nENV PHP_HOME=\"\\\"/usr/local/php\\\"\"\nENV PHP_CONF_DIR=\"\\\"$PHP_HOME/etc\\\"\"\nENV PHP_CONF_DIR_SCAN=\"\\\"$PHP_CONF_DIR/conf.d\\\"\"\nENV PATH=\"\\\"$PHP_HOME/bin\\\":$PATH\"\n#  redis\nENV REDIS_VERSION=\"\\\"3.2.8\\\"\"\nENV REDIS_DOWNLOAD_URL=\"\\\"http://download.redis.io/releases/redis-$REDIS_VERSION.tar.gz\\\"\"\nENV REDIS_SHA1=\"\\\"6780d1abb66f33a97aad0edbe020403d0a15b67f\\\"\"\nENV REDIS_SOURCE=\"\\\"/usr/src/redis\\\"\"\nENV REDIS_HOME=\"\\\"/usr/local/redis\\\"\"\nENV PATH=\"\\\"$REDIS_HOME/bin\\\":$PATH\"\n#  phpMyAdmin\nENV PHPMYADMIN_VERSION=\"\\\"4.6.6\\\"\"\nENV PHPMYADMIN_DOWNLOAD_URL=\"\\\"https://files.phpmyadmin.net/phpMyAdmin/$PHPMYADMIN_VERSION/phpMyAdmin-$PHPMYADMIN_VERSION-all-languages.tar.gz\\\"\"\nENV PHPMYADMIN_SHA256=\"\\\"54086600558613b31c4daddf4ae58fbc1c252a2b8e3e6fae12f851f78677d72e\\\"\"\nENV PHPMYADMIN_SOURCE=\"\\\"/usr/src/phpmyadmin\\\"\"\nENV PHPMYADMIN_HOME=\"\\\"/home/phpmyadmin\\\"\"\n#  wordpress\nENV WORDPRESS_VERSION=\"\\\"4.7.3\\\"\"\nENV WORDPRESS_DOWNLOAD_URL=\"\\\"https://wordpress.org/wordpress-$WORDPRESS_VERSION.tar.gz\\\"\"\nENV WORDPRESS_SHA1=\"\\\"35adcd8162eae00d5bc37f35344fdc06b22ffc98\\\"\"\nENV WORDPRESS_SOURCE=\"\\\"/usr/src/wordpress\\\"\"\nENV WORDPRESS_HOME=\"\\\"/home/site/wwwroot\\\"\"\n#\nENV DOCKER_BUILD_HOME=\"\\\"/dockerbuild\\\"\"\n#  ====================\n#  Download and Install\n#  1. tools\n#  2. apache httpd\n#  3. mariadb\n#  4. php\n#  5. redis\n#  6. phpmyadmin\n#  7. wordpress\n#  ====================\nWORKDIR $DOCKER_BUILD_HOME\nRUN set -ex \\\n && tools=\" g++ gcc make pkg-config wget \" \\\n && apt-get update \\\n && apt-get install --no-install-recommends $tools -y -V \\\n && rm -r /var/lib/apt/lists/* \\\n && mkdir -p $HTTPD_SOURCE \\\n && mkdir -p $HTTPD_HOME \\\n && httpdBuildtimeDeps=\" libpcre++-dev libssl-dev \" \\\n && httpdRuntimeDeps=\" libapr1 libaprutil1 libaprutil1-ldap libapr1-dev libaprutil1-dev \" \\\n && apt-get update \\\n && apt-get install --no-install-recommends $httpdBuildtimeDeps $httpdRuntimeDeps -y -V \\\n && rm -r /var/lib/apt/lists/* \\\n && cd $DOCKER_BUILD_HOME \\\n && wget -O httpd.tar.gz \"$HTTPD_DOWNLOAD_URL\" --no-check-certificate \\\n && echo \"$HTTPD_SHA1 *httpd.tar.gz\" | sha1sum -c - \\\n && tar -xf httpd.tar.gz -C $HTTPD_SOURCE --strip-components=1 \\\n && cd $HTTPD_SOURCE \\\n && ./configure --prefix=$HTTPD_HOME --with-mpm=prefork --enable-mods-shared=reallyall --enable-ssl \\\n && make -j \"$( nproc ;)\" \\\n && make install \\\n && make clean \\\n && rm -rf $HTTPD_SOURCE $HTTPD_HOME/man $HTTPD_HOME/manual \\\n && rm $DOCKER_BUILD_HOME/httpd.tar.gz \\\n && apt-get purge -y -V -o APT::AutoRemove::RecommendsImportant=false --auto-remove $httpdBuildtimeDeps \\\n && apt-get update \\\n && DEBIAN_FRONTEND=noninteractive apt-get install mariadb-server -y -V --no-install-recommends \\\n && rm -r /var/lib/apt/lists/* \\\n && mkdir -p $PHP_SOURCE \\\n && mkdir -p $PHP_HOME \\\n && phpBuildtimeDeps=\" libbz2-dev libgmp-dev libicu-dev libldap2-dev libssl-dev libxml2-dev \" \\\n && phpRuntimeDeps=\" libcurl4-openssl-dev libjpeg-dev libpng12-dev libxml2 \" \\\n && apt-get update \\\n && apt-get install --no-install-recommends $phpBuildtimeDeps $phpRuntimeDeps -y -V \\\n && rm -rf /var/lib/apt/lists/* \\\n && ln -s /usr/include/x86_64-linux-gnu/gmp.h /usr/include/gmp.h \\\n && ln -s /usr/lib/x86_64-linux-gnu/libldap.so /usr/lib/libldap.so \\\n && ln -s /usr/lib/x86_64-linux-gnu/liblber.so /usr/lib/liblber.so \\\n && cd $DOCKER_BUILD_HOME \\\n && wget -O php.tar.gz \"$PHP_DOWNLOAD_URL\" --no-check-certificate \\\n && echo \"$PHP_SHA256 *php.tar.gz\" | sha256sum -c - \\\n && tar -xf php.tar.gz -C $PHP_SOURCE --strip-components=1 \\\n && cd $PHP_SOURCE \\\n && ./configure --prefix=$PHP_HOME --disable-cgi --disable-pdo --enable-bcmath --enable-intl --enable-mbstring --enable-zip --with-apxs2=$HTTPD_HOME/bin/apxs --with-bz2 --with-config-file-path=$PHP_CONF_DIR --with-config-file-scan-dir=$PHP_CONF_DIR_SCAN --with-curl --with-gd --with-jpeg-dir --with-png-dir --with-gmp --with-ldap --with-mysqli=mysqlnd --with-openssl \\\n && make -j \"$( nproc ;)\" \\\n && make install \\\n && make clean \\\n && rm -rf $PHP_SOURCE \\\n && rm -rf $PHP_HOME/php/man \\\n && rm $DOCKER_BUILD_HOME/php.tar.gz \\\n && apt-get purge -y -V -o APT::AutoRemove::RecommendsImportant=false --auto-remove $phpBuildtimeDeps \\\n && mkdir -p $REDIS_SOURCE \\\n && mkdir -p $REDIS_HOME \\\n && cd $DOCKER_BUILD_HOME \\\n && wget -O redis.tar.gz \"$REDIS_DOWNLOAD_URL\" --no-check-certificate \\\n && echo \"$REDIS_SHA1 *redis.tar.gz\" | sha1sum -c - \\\n && tar -xf redis.tar.gz -C $REDIS_SOURCE --strip-components=1 \\\n && cd $REDIS_SOURCE \\\n && make -j \"$( nproc ;)\" \\\n && make PREFIX=$REDIS_HOME install \\\n && rm -rf $REDIS_SOURCE E \\\n && rm $DOCKER_BUILD_HOME/redis.tar.gz \\\n && mkdir -p $PHPMYADMIN_SOURCE \\\n && cd $PHPMYADMIN_SOURCE \\\n && wget -O phpmyadmin.tar.gz \"$PHPMYADMIN_DOWNLOAD_URL\" --no-check-certificate \\\n && echo \"$PHPMYADMIN_SHA256 *phpmyadmin.tar.gz\" | sha256sum -c - \\\n && mkdir -p $WORDPRESS_SOURCE \\\n && cd $WORDPRESS_SOURCE \\\n && wget -O wordpress.tar.gz \"$WORDPRESS_DOWNLOAD_URL\" --no-check-certificate \\\n && echo \"$WORDPRESS_SHA1 *wordpress.tar.gz\" | sha1sum -c - \\\n && apt-get purge -y -V -o APT::AutoRemove::RecommendsImportant=false --auto-remove $tools \\\n && apt-get autoremove -y\n#  =========\n#  Configure\n#  =========\n#  httpd confs\nCOPY httpd.conf $HTTPD_CONF_DIR/\nCOPY httpd-modules.conf $HTTPD_CONF_DIR/\nCOPY httpd-php.conf $HTTPD_CONF_DIR/\nCOPY httpd-wordpress.conf $HTTPD_CONF_DIR/\nCOPY httpd-phpmyadmin.conf $HTTPD_CONF_DIR/\n#  php confs\nCOPY php.ini $PHP_CONF_DIR/\nCOPY php-opcache.ini $PHP_CONF_DIR_SCAN/\n#  wordpress conf\nCOPY wp-config.php.microsoft $WORDPRESS_SOURCE/\n#  phpmyadmin conf\nCOPY phpmyadmin-config.inc.php $PHPMYADMIN_SOURCE/\nRUN set -ex \\\n && echo 'Include conf/httpd-php.conf' >> $HTTPD_CONF_FILE \\\n && sed -i 's/skip_log_error/#skip_log_error/g' /etc/mysql/mariadb.conf.d/50-mysqld_safe.cnf \\\n && sed -i 's/syslog/#syslog/g' /etc/mysql/mariadb.conf.d/50-mysqld_safe.cnf \\\n && test ! -d /var/lib/php/sessions \\\n && mkdir -p /var/lib/php/sessions \\\n && chown www-data:www-data /var/lib/php/sessions \\\n && test ! -d /var/www \\\n && mkdir -p /var/www \\\n && echo '<html><head><meta http-equiv=\"refresh\" content=\"30\" /><meta http-equiv=\"pragma\" content=\"no-cache\" /><meta http-equiv=\"cache-control\" content=\"no-cache\" /><title>Installing WordPress</title></head><body>Installing WordPress ... This could be done in minutes. Please refresh your browser later.</body></html>' > /var/www/index.html \\\n && chown -R www-data:www-data /var/www \\\n && ln -s $WORDPRESS_HOME /var/www/wordpress \\\n && ln -s $PHPMYADMIN_HOME /var/www/phpmyadmin \\\n && rm -rf /var/log/mysql \\\n && ln -s $MARIADB_LOG_DIR /var/log/mysql \\\n && rm -rf /var/log/httpd \\\n && ln -s $HTTPD_LOG_DIR /var/log/httpd\n#  =====\n#  final\n#  =====\nCOPY entrypoint.sh /usr/local/bin/\nRUN chmod +x /usr/local/bin/entrypoint.sh\nEXPOSE 80/tcp\nENTRYPOINT [\"entrypoint.sh\"]\n","injectedSmells":[],"originalDockerfileHash":"7b7bd73f5a9a5532805705bb85d71526","successfullyInjectedSmells":[],"originalDockerfileUglified":"#\n#   Dockerfile for WordPress\n#\nFROM ubuntu:16.04\nMAINTAINER Azure App Service Container Images <appsvc-images@microsoft.com>\n#   ========\n#   ENV vars\n#   ========\n#   apache httpd\nENV HTTPD_VERSION=\"\\\"2.4.25\\\"\"\nENV HTTPD_DOWNLOAD_URL=\"\\\"https://www.apache.org/dist/httpd/httpd-$HTTPD_VERSION.tar.gz\\\"\"\nENV HTTPD_SHA1=\"\\\"377c62dc6b25c9378221111dec87c28f8fe6ac69\\\"\"\nENV HTTPD_SOURCE=\"\\\"/usr/src/httpd\\\"\"\nENV HTTPD_HOME=\"\\\"/usr/local/httpd\\\"\"\nENV HTTPD_CONF_DIR=\"\\\"$HTTPD_HOME/conf\\\"\"\nENV HTTPD_CONF_FILE=\"\\\"$HTTPD_CONF_DIR/httpd.conf\\\"\"\nENV HTTPD_LOG_DIR=\"\\\"/home/LogFiles/httpd\\\"\"\nENV PATH=\"\\\"$HTTPD_HOME/bin\\\":$PATH\"\n#   mariadb\nENV MARIADB_DATA_DIR=\"\\\"/home/data\\\"\"\nENV MARIADB_LOG_DIR=\"\\\"/home/LogFiles/mysql\\\"\"\n#   php\nENV PHP_VERSION=\"\\\"7.1.2\\\"\"\nENV PHP_DOWNLOAD_URL=\"\\\"https://secure.php.net/get/php-$PHP_VERSION.tar.gz/from/this/mirror\\\"\"\nENV PHP_SHA256=\"\\\"e6773217c9c719ca22abb104ae3d437d53daceaf31faf2e5eeb1f9f5028005d8\\\"\"\nENV PHP_SOURCE=\"\\\"/usr/src/php\\\"\"\nENV PHP_HOME=\"\\\"/usr/local/php\\\"\"\nENV PHP_CONF_DIR=\"\\\"$PHP_HOME/etc\\\"\"\nENV PHP_CONF_DIR_SCAN=\"\\\"$PHP_CONF_DIR/conf.d\\\"\"\nENV PATH=\"\\\"$PHP_HOME/bin\\\":$PATH\"\n#   redis\nENV REDIS_VERSION=\"\\\"3.2.8\\\"\"\nENV REDIS_DOWNLOAD_URL=\"\\\"http://download.redis.io/releases/redis-$REDIS_VERSION.tar.gz\\\"\"\nENV REDIS_SHA1=\"\\\"6780d1abb66f33a97aad0edbe020403d0a15b67f\\\"\"\nENV REDIS_SOURCE=\"\\\"/usr/src/redis\\\"\"\nENV REDIS_HOME=\"\\\"/usr/local/redis\\\"\"\nENV PATH=\"\\\"$REDIS_HOME/bin\\\":$PATH\"\n#   phpMyAdmin\nENV PHPMYADMIN_VERSION=\"\\\"4.6.6\\\"\"\nENV PHPMYADMIN_DOWNLOAD_URL=\"\\\"https://files.phpmyadmin.net/phpMyAdmin/$PHPMYADMIN_VERSION/phpMyAdmin-$PHPMYADMIN_VERSION-all-languages.tar.gz\\\"\"\nENV PHPMYADMIN_SHA256=\"\\\"54086600558613b31c4daddf4ae58fbc1c252a2b8e3e6fae12f851f78677d72e\\\"\"\nENV PHPMYADMIN_SOURCE=\"\\\"/usr/src/phpmyadmin\\\"\"\nENV PHPMYADMIN_HOME=\"\\\"/home/phpmyadmin\\\"\"\n#   wordpress\nENV WORDPRESS_VERSION=\"\\\"4.7.3\\\"\"\nENV WORDPRESS_DOWNLOAD_URL=\"\\\"https://wordpress.org/wordpress-$WORDPRESS_VERSION.tar.gz\\\"\"\nENV WORDPRESS_SHA1=\"\\\"35adcd8162eae00d5bc37f35344fdc06b22ffc98\\\"\"\nENV WORDPRESS_SOURCE=\"\\\"/usr/src/wordpress\\\"\"\nENV WORDPRESS_HOME=\"\\\"/home/site/wwwroot\\\"\"\n#\nENV DOCKER_BUILD_HOME=\"\\\"/dockerbuild\\\"\"\n#   ====================\n#   Download and Install\n#   1. tools\n#   2. apache httpd\n#   3. mariadb\n#   4. php\n#   5. redis\n#   6. phpmyadmin\n#   7. wordpress\n#   ====================\nWORKDIR $DOCKER_BUILD_HOME\nRUN set -ex \\\n && tools=\" g++ gcc make pkg-config wget \" \\\n && apt-get update \\\n && apt-get install --no-install-recommends $tools -y -V \\\n && rm -r /var/lib/apt/lists/* \\\n && mkdir -p $HTTPD_SOURCE \\\n && mkdir -p $HTTPD_HOME \\\n && httpdBuildtimeDeps=\" libpcre++-dev libssl-dev \" \\\n && httpdRuntimeDeps=\" libapr1 libaprutil1 libaprutil1-ldap libapr1-dev libaprutil1-dev \" \\\n && apt-get update \\\n && apt-get install --no-install-recommends $httpdBuildtimeDeps $httpdRuntimeDeps -y -V \\\n && rm -r /var/lib/apt/lists/* \\\n && cd $DOCKER_BUILD_HOME \\\n && wget -O httpd.tar.gz \"$HTTPD_DOWNLOAD_URL\" --no-check-certificate \\\n && echo \"$HTTPD_SHA1 *httpd.tar.gz\" | sha1sum -c - \\\n && tar -xf httpd.tar.gz -C $HTTPD_SOURCE --strip-components=1 \\\n && cd $HTTPD_SOURCE \\\n && ./configure --prefix=$HTTPD_HOME --with-mpm=prefork --enable-mods-shared=reallyall --enable-ssl \\\n && make -j \"$( nproc ;)\" \\\n && make install \\\n && make clean \\\n && rm -rf $HTTPD_SOURCE $HTTPD_HOME/man $HTTPD_HOME/manual \\\n && rm $DOCKER_BUILD_HOME/httpd.tar.gz \\\n && apt-get purge -y -V -o APT::AutoRemove::RecommendsImportant=false --auto-remove $httpdBuildtimeDeps \\\n && apt-get update \\\n && DEBIAN_FRONTEND=noninteractive apt-get install mariadb-server -y -V --no-install-recommends \\\n && rm -r /var/lib/apt/lists/* \\\n && mkdir -p $PHP_SOURCE \\\n && mkdir -p $PHP_HOME \\\n && phpBuildtimeDeps=\" libbz2-dev libgmp-dev libicu-dev libldap2-dev libssl-dev libxml2-dev \" \\\n && phpRuntimeDeps=\" libcurl4-openssl-dev libjpeg-dev libpng12-dev libxml2 \" \\\n && apt-get update \\\n && apt-get install --no-install-recommends $phpBuildtimeDeps $phpRuntimeDeps -y -V \\\n && rm -rf /var/lib/apt/lists/* \\\n && ln -s /usr/include/x86_64-linux-gnu/gmp.h /usr/include/gmp.h \\\n && ln -s /usr/lib/x86_64-linux-gnu/libldap.so /usr/lib/libldap.so \\\n && ln -s /usr/lib/x86_64-linux-gnu/liblber.so /usr/lib/liblber.so \\\n && cd $DOCKER_BUILD_HOME \\\n && wget -O php.tar.gz \"$PHP_DOWNLOAD_URL\" --no-check-certificate \\\n && echo \"$PHP_SHA256 *php.tar.gz\" | sha256sum -c - \\\n && tar -xf php.tar.gz -C $PHP_SOURCE --strip-components=1 \\\n && cd $PHP_SOURCE \\\n && ./configure --prefix=$PHP_HOME --disable-cgi --disable-pdo --enable-bcmath --enable-intl --enable-mbstring --enable-zip --with-apxs2=$HTTPD_HOME/bin/apxs --with-bz2 --with-config-file-path=$PHP_CONF_DIR --with-config-file-scan-dir=$PHP_CONF_DIR_SCAN --with-curl --with-gd --with-jpeg-dir --with-png-dir --with-gmp --with-ldap --with-mysqli=mysqlnd --with-openssl \\\n && make -j \"$( nproc ;)\" \\\n && make install \\\n && make clean \\\n && rm -rf $PHP_SOURCE \\\n && rm -rf $PHP_HOME/php/man \\\n && rm $DOCKER_BUILD_HOME/php.tar.gz \\\n && apt-get purge -y -V -o APT::AutoRemove::RecommendsImportant=false --auto-remove $phpBuildtimeDeps \\\n && mkdir -p $REDIS_SOURCE \\\n && mkdir -p $REDIS_HOME \\\n && cd $DOCKER_BUILD_HOME \\\n && wget -O redis.tar.gz \"$REDIS_DOWNLOAD_URL\" --no-check-certificate \\\n && echo \"$REDIS_SHA1 *redis.tar.gz\" | sha1sum -c - \\\n && tar -xf redis.tar.gz -C $REDIS_SOURCE --strip-components=1 \\\n && cd $REDIS_SOURCE \\\n && make -j \"$( nproc ;)\" \\\n && make PREFIX=$REDIS_HOME install \\\n && rm -rf $REDIS_SOURCE E \\\n && rm $DOCKER_BUILD_HOME/redis.tar.gz \\\n && mkdir -p $PHPMYADMIN_SOURCE \\\n && cd $PHPMYADMIN_SOURCE \\\n && wget -O phpmyadmin.tar.gz \"$PHPMYADMIN_DOWNLOAD_URL\" --no-check-certificate \\\n && echo \"$PHPMYADMIN_SHA256 *phpmyadmin.tar.gz\" | sha256sum -c - \\\n && mkdir -p $WORDPRESS_SOURCE \\\n && cd $WORDPRESS_SOURCE \\\n && wget -O wordpress.tar.gz \"$WORDPRESS_DOWNLOAD_URL\" --no-check-certificate \\\n && echo \"$WORDPRESS_SHA1 *wordpress.tar.gz\" | sha1sum -c - \\\n && apt-get purge -y -V -o APT::AutoRemove::RecommendsImportant=false --auto-remove $tools \\\n && apt-get autoremove -y\n#   =========\n#   Configure\n#   =========\n#   httpd confs\nCOPY httpd.conf $HTTPD_CONF_DIR/\nCOPY httpd-modules.conf $HTTPD_CONF_DIR/\nCOPY httpd-php.conf $HTTPD_CONF_DIR/\nCOPY httpd-wordpress.conf $HTTPD_CONF_DIR/\nCOPY httpd-phpmyadmin.conf $HTTPD_CONF_DIR/\n#   php confs\nCOPY php.ini $PHP_CONF_DIR/\nCOPY php-opcache.ini $PHP_CONF_DIR_SCAN/\n#   wordpress conf\nCOPY wp-config.php.microsoft $WORDPRESS_SOURCE/\n#   phpmyadmin conf\nCOPY phpmyadmin-config.inc.php $PHPMYADMIN_SOURCE/\nRUN set -ex \\\n && echo 'Include conf/httpd-php.conf' >> $HTTPD_CONF_FILE \\\n && sed -i 's/skip_log_error/#skip_log_error/g' /etc/mysql/mariadb.conf.d/50-mysqld_safe.cnf \\\n && sed -i 's/syslog/#syslog/g' /etc/mysql/mariadb.conf.d/50-mysqld_safe.cnf \\\n && test ! -d /var/lib/php/sessions \\\n && mkdir -p /var/lib/php/sessions \\\n && chown www-data:www-data /var/lib/php/sessions \\\n && test ! -d /var/www \\\n && mkdir -p /var/www \\\n && echo '<html><head><meta http-equiv=\"refresh\" content=\"30\" /><meta http-equiv=\"pragma\" content=\"no-cache\" /><meta http-equiv=\"cache-control\" content=\"no-cache\" /><title>Installing WordPress</title></head><body>Installing WordPress ... This could be done in minutes. Please refresh your browser later.</body></html>' > /var/www/index.html \\\n && chown -R www-data:www-data /var/www \\\n && ln -s $WORDPRESS_HOME /var/www/wordpress \\\n && ln -s $PHPMYADMIN_HOME /var/www/phpmyadmin \\\n && rm -rf /var/log/mysql \\\n && ln -s $MARIADB_LOG_DIR /var/log/mysql \\\n && rm -rf /var/log/httpd \\\n && ln -s $HTTPD_LOG_DIR /var/log/httpd\n#   =====\n#   final\n#   =====\nCOPY entrypoint.sh /usr/local/bin/\nRUN chmod +x /usr/local/bin/entrypoint.sh\nEXPOSE 80/tcp\nENTRYPOINT [\"entrypoint.sh\"]\n","originalDockerfileUglifiedHash":"b414b40bc04e23e407cb9dc1610a6d74","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/d0285330aa5021f50d83f7a40752a8330036f36b.dockerfile"}