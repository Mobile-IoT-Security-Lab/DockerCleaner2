{"seed":798912493,"processedDockerfileHash":"f490717ef9fed838f5f2194cfff537f7","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["have-a-healthcheck","have-a-user"],"processedDockerfile":"#\n#  ########################################\n#   这是就架构下的dockerfile\n#  ########################################\n#\n#   PHP Dockerfile\n#   满足laravel5.1版本的基本要求，包含了很多杂七杂八的扩展\n#\n#   https://github.com/ibbd/dockerfile-php-fpm\n#\n#   下载相关资源：./download.sh\n#   sudo docker build -t ibbd/php-fpm ./\n#\n#   Pull base image.\nFROM php:5.6-fpm\nMAINTAINER Alex Cai \"cyy0523xc@gmail.com\"\n#   sources.list\n#   git clone git@github.com:IBBD/docker-compose.git\n#   如果导致apt-get Install不成功，可以先注释这句\n#  ADD ext/sources.list   /etc/apt/sources.list\n#   Install modules\n#   composer需要先安装zip\n#   pecl install imagick时需要libmagickwand-dev。但是这个安装的东西有点多，python2.7也安装了\nRUN apt-get update \\\n && apt-get install --no-install-recommends libmcrypt-dev libfreetype6-dev libjpeg62-turbo-dev libpng12-dev libssl-dev libmagickwand-dev -y \\\n && apt-get autoremove \\\n && apt-get clean \\\n && rm -r /var/lib/apt/lists/*\n#  COPY ext/msgpack.tgz  /msgpack.tgz \n#  COPY ext/composer.php /composer.php\n#   install php modules\n#   pecl install php modules\n#   安装mongo扩展时，出现如下错误：\n#   Unable to load dynamic library '/usr/local/lib/php/extensions/no-debug-non-zts-20131226/mongo.so'\n#   需要先安装libssl-dev\n#   如果本地构建的话，建议先下载好相应的扩展包\n#   直接使用pecl install msgpack会报错：\n#   Failed to download pecl/msgpack within preferred state \"stable\", latest release is version 0.5.7, stability \"beta\", use \"channel://pecl.php.net/msgpack-0.5.7\" to install\n#\n#   install imagick 报错如下\n#   checking ImageMagick MagickWand API configuration program... configure: error: not found. Please provide a path to MagickWand-config or Wand-config program.\n#   ERROR: `/tmp/pear/temp/imagick/configure --with-php-config=/usr/local/bin/php-config --with-imagick' failed\n#   原因：由于安装imagick扩展时需要依赖ImageMagick的函数库，因此必须要先安装ImageMagick, 但是安装了却依然不行。官网上有人评论需要安装libmagickwand-dev\n#   解决：apt-get install libmagickwand-dev \n#\n#   注意：msgpack 2.0.0需要php7\n#  && pecl install msgpack-beta \\\n#   2016-03-09 增加mysql扩展\n#   2016-07-12 增加soap扩展\nRUN docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ \\\n && docker-php-ext-install gd \\\n && docker-php-ext-install soap \\\n && docker-php-ext-install iconv mcrypt pdo_mysql tokenizer mbstring zip mysqli mysql \\\n && pecl install redis-2.2.8 \\\n && echo \"extension=redis.so\" > /usr/local/etc/php/conf.d/redis.ini \\\n && pecl install memcache \\\n && echo \"extension=memcache.so\" > /usr/local/etc/php/conf.d/memcache.ini \\\n && pecl install channel://pecl.php.net/msgpack-0.5.7 \\\n && echo \"extension=msgpack.so\" > /usr/local/etc/php/conf.d/msgpack.ini \\\n && pecl install mongo \\\n && echo \"extension=mongo.so\" > /usr/local/etc/php/conf.d/mongo.ini \\\n && pecl install mongodb \\\n && echo \"extension=mongodb.so\" > /usr/local/etc/php/conf.d/mongodb.ini \\\n && pecl install imagick-beta \\\n && echo \"extension=imagick.so\" > /usr/local/etc/php/conf.d/imagick.ini \\\n && pecl clear-cache\n#   composer \n#   composer中国镜像\n#   注意：需要先安装lumen，在安装laravel，否则报错\n#   不应在镜像中绑定国内的镜像，因为镜像可能会用到国外的服务器\n#   测试国内的容易抽风。。\n#  && curl -sS https://getcomposer.org/installer -o /composer.php \\\n#  && php composer.php \\\n#  && mv composer.phar /usr/local/bin/composer \\\n#  && composer config -g repo.packagist composer http://packagist.phpcomposer.com \\\n#  && rm -f composer.php \\\n#  && chmod 755 /usr/local/bin/composer \\\n#  && php -r \"if (hash('SHA384', file_get_contents('composer-setup.php')) === 'fd26ce67e3b237fffd5e5544b45b0d92c41a4afe3e3f778e942e43ce6be197b9cdc7c251dcde6e2a52297ea269370680') { echo 'Installer verified';  } else { echo 'Installer corrupt'; unlink('composer-setup.php');  }\" \\\nRUN cd / \\\n && php -r \"readfile('https://getcomposer.org/installer');\" > composer-setup.php \\\n && php composer-setup.php --filename=composer --install-dir=/usr/local/bin/ \\\n && rm composer-setup.php \\\n && composer global require \"laravel/lumen-installer\" \\\n && composer global require \"laravel/installer\" \\\n && composer clearcache \\\n && composer clear-cache\n#   解决时区问题\nENV TZ=\"\\\"Asia/Shanghai\\\"\"\n#   终端设置\n#   执行php-fpm时，默认值是dumb，这时在终端操作时可能会出现：terminal is not fully functional\nENV TERM=\"xterm\"\n#   Define mountable directories.\nVOLUME /var/www\n#   工作目录\nWORKDIR /var/www \nEXPOSE 9000/tcp\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\n","originalDockerfile":"#\n# ########################################\n#  这是就架构下的dockerfile\n# ########################################\n#\n#  PHP Dockerfile\n#  满足laravel5.1版本的基本要求，包含了很多杂七杂八的扩展\n#\n#  https://github.com/ibbd/dockerfile-php-fpm\n#\n#  下载相关资源：./download.sh\n#  sudo docker build -t ibbd/php-fpm ./\n#\n#  Pull base image.\nFROM php:5.6-fpm\nMAINTAINER Alex Cai \"cyy0523xc@gmail.com\"\n#  sources.list\n#  git clone git@github.com:IBBD/docker-compose.git\n#  如果导致apt-get Install不成功，可以先注释这句\n# ADD ext/sources.list   /etc/apt/sources.list\n#  Install modules\n#  composer需要先安装zip\n#  pecl install imagick时需要libmagickwand-dev。但是这个安装的东西有点多，python2.7也安装了\nRUN apt-get update \\\n && apt-get install --no-install-recommends libmcrypt-dev libfreetype6-dev libjpeg62-turbo-dev libpng12-dev libssl-dev libmagickwand-dev -y \\\n && apt-get autoremove \\\n && apt-get clean \\\n && rm -r /var/lib/apt/lists/*\n# COPY ext/msgpack.tgz  /msgpack.tgz \n# COPY ext/composer.php /composer.php\n#  install php modules\n#  pecl install php modules\n#  安装mongo扩展时，出现如下错误：\n#  Unable to load dynamic library '/usr/local/lib/php/extensions/no-debug-non-zts-20131226/mongo.so'\n#  需要先安装libssl-dev\n#  如果本地构建的话，建议先下载好相应的扩展包\n#  直接使用pecl install msgpack会报错：\n#  Failed to download pecl/msgpack within preferred state \"stable\", latest release is version 0.5.7, stability \"beta\", use \"channel://pecl.php.net/msgpack-0.5.7\" to install\n#\n#  install imagick 报错如下\n#  checking ImageMagick MagickWand API configuration program... configure: error: not found. Please provide a path to MagickWand-config or Wand-config program.\n#  ERROR: `/tmp/pear/temp/imagick/configure --with-php-config=/usr/local/bin/php-config --with-imagick' failed\n#  原因：由于安装imagick扩展时需要依赖ImageMagick的函数库，因此必须要先安装ImageMagick, 但是安装了却依然不行。官网上有人评论需要安装libmagickwand-dev\n#  解决：apt-get install libmagickwand-dev \n#\n#  注意：msgpack 2.0.0需要php7\n# && pecl install msgpack-beta \\\n#  2016-03-09 增加mysql扩展\n#  2016-07-12 增加soap扩展\nRUN docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ \\\n && docker-php-ext-install gd \\\n && docker-php-ext-install soap \\\n && docker-php-ext-install iconv mcrypt pdo_mysql tokenizer mbstring zip mysqli mysql \\\n && pecl install redis-2.2.8 \\\n && echo \"extension=redis.so\" > /usr/local/etc/php/conf.d/redis.ini \\\n && pecl install memcache \\\n && echo \"extension=memcache.so\" > /usr/local/etc/php/conf.d/memcache.ini \\\n && pecl install channel://pecl.php.net/msgpack-0.5.7 \\\n && echo \"extension=msgpack.so\" > /usr/local/etc/php/conf.d/msgpack.ini \\\n && pecl install mongo \\\n && echo \"extension=mongo.so\" > /usr/local/etc/php/conf.d/mongo.ini \\\n && pecl install mongodb \\\n && echo \"extension=mongodb.so\" > /usr/local/etc/php/conf.d/mongodb.ini \\\n && pecl install imagick-beta \\\n && echo \"extension=imagick.so\" > /usr/local/etc/php/conf.d/imagick.ini \\\n && pecl clear-cache\n#  composer \n#  composer中国镜像\n#  注意：需要先安装lumen，在安装laravel，否则报错\n#  不应在镜像中绑定国内的镜像，因为镜像可能会用到国外的服务器\n#  测试国内的容易抽风。。\n# && curl -sS https://getcomposer.org/installer -o /composer.php \\\n# && php composer.php \\\n# && mv composer.phar /usr/local/bin/composer \\\n# && composer config -g repo.packagist composer http://packagist.phpcomposer.com \\\n# && rm -f composer.php \\\n# && chmod 755 /usr/local/bin/composer \\\n# && php -r \"if (hash('SHA384', file_get_contents('composer-setup.php')) === 'fd26ce67e3b237fffd5e5544b45b0d92c41a4afe3e3f778e942e43ce6be197b9cdc7c251dcde6e2a52297ea269370680') { echo 'Installer verified';  } else { echo 'Installer corrupt'; unlink('composer-setup.php');  }\" \\\nRUN cd / \\\n && php -r \"readfile('https://getcomposer.org/installer');\" > composer-setup.php \\\n && php composer-setup.php --filename=composer --install-dir=/usr/local/bin/ \\\n && rm composer-setup.php \\\n && composer global require \"laravel/lumen-installer\" \\\n && composer global require \"laravel/installer\" \\\n && composer clearcache \\\n && composer clear-cache\n#  解决时区问题\nENV TZ=\"\\\"Asia/Shanghai\\\"\"\n#  终端设置\n#  执行php-fpm时，默认值是dumb，这时在终端操作时可能会出现：terminal is not fully functional\nENV TERM=\"xterm\"\n#  Define mountable directories.\nVOLUME /var/www\n#  工作目录\nWORKDIR /var/www \nEXPOSE 9000/tcp\n","injectedSmells":[],"originalDockerfileHash":"73c3967f2ccf8cdec817c88f2f9e6fed","successfullyInjectedSmells":[],"originalDockerfileUglified":"#\n#  ########################################\n#   这是就架构下的dockerfile\n#  ########################################\n#\n#   PHP Dockerfile\n#   满足laravel5.1版本的基本要求，包含了很多杂七杂八的扩展\n#\n#   https://github.com/ibbd/dockerfile-php-fpm\n#\n#   下载相关资源：./download.sh\n#   sudo docker build -t ibbd/php-fpm ./\n#\n#   Pull base image.\nFROM php:5.6-fpm\nMAINTAINER Alex Cai \"cyy0523xc@gmail.com\"\n#   sources.list\n#   git clone git@github.com:IBBD/docker-compose.git\n#   如果导致apt-get Install不成功，可以先注释这句\n#  ADD ext/sources.list   /etc/apt/sources.list\n#   Install modules\n#   composer需要先安装zip\n#   pecl install imagick时需要libmagickwand-dev。但是这个安装的东西有点多，python2.7也安装了\nRUN apt-get update \\\n && apt-get install --no-install-recommends libmcrypt-dev libfreetype6-dev libjpeg62-turbo-dev libpng12-dev libssl-dev libmagickwand-dev -y \\\n && apt-get autoremove \\\n && apt-get clean \\\n && rm -r /var/lib/apt/lists/*\n#  COPY ext/msgpack.tgz  /msgpack.tgz \n#  COPY ext/composer.php /composer.php\n#   install php modules\n#   pecl install php modules\n#   安装mongo扩展时，出现如下错误：\n#   Unable to load dynamic library '/usr/local/lib/php/extensions/no-debug-non-zts-20131226/mongo.so'\n#   需要先安装libssl-dev\n#   如果本地构建的话，建议先下载好相应的扩展包\n#   直接使用pecl install msgpack会报错：\n#   Failed to download pecl/msgpack within preferred state \"stable\", latest release is version 0.5.7, stability \"beta\", use \"channel://pecl.php.net/msgpack-0.5.7\" to install\n#\n#   install imagick 报错如下\n#   checking ImageMagick MagickWand API configuration program... configure: error: not found. Please provide a path to MagickWand-config or Wand-config program.\n#   ERROR: `/tmp/pear/temp/imagick/configure --with-php-config=/usr/local/bin/php-config --with-imagick' failed\n#   原因：由于安装imagick扩展时需要依赖ImageMagick的函数库，因此必须要先安装ImageMagick, 但是安装了却依然不行。官网上有人评论需要安装libmagickwand-dev\n#   解决：apt-get install libmagickwand-dev \n#\n#   注意：msgpack 2.0.0需要php7\n#  && pecl install msgpack-beta \\\n#   2016-03-09 增加mysql扩展\n#   2016-07-12 增加soap扩展\nRUN docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ \\\n && docker-php-ext-install gd \\\n && docker-php-ext-install soap \\\n && docker-php-ext-install iconv mcrypt pdo_mysql tokenizer mbstring zip mysqli mysql \\\n && pecl install redis-2.2.8 \\\n && echo \"extension=redis.so\" > /usr/local/etc/php/conf.d/redis.ini \\\n && pecl install memcache \\\n && echo \"extension=memcache.so\" > /usr/local/etc/php/conf.d/memcache.ini \\\n && pecl install channel://pecl.php.net/msgpack-0.5.7 \\\n && echo \"extension=msgpack.so\" > /usr/local/etc/php/conf.d/msgpack.ini \\\n && pecl install mongo \\\n && echo \"extension=mongo.so\" > /usr/local/etc/php/conf.d/mongo.ini \\\n && pecl install mongodb \\\n && echo \"extension=mongodb.so\" > /usr/local/etc/php/conf.d/mongodb.ini \\\n && pecl install imagick-beta \\\n && echo \"extension=imagick.so\" > /usr/local/etc/php/conf.d/imagick.ini \\\n && pecl clear-cache\n#   composer \n#   composer中国镜像\n#   注意：需要先安装lumen，在安装laravel，否则报错\n#   不应在镜像中绑定国内的镜像，因为镜像可能会用到国外的服务器\n#   测试国内的容易抽风。。\n#  && curl -sS https://getcomposer.org/installer -o /composer.php \\\n#  && php composer.php \\\n#  && mv composer.phar /usr/local/bin/composer \\\n#  && composer config -g repo.packagist composer http://packagist.phpcomposer.com \\\n#  && rm -f composer.php \\\n#  && chmod 755 /usr/local/bin/composer \\\n#  && php -r \"if (hash('SHA384', file_get_contents('composer-setup.php')) === 'fd26ce67e3b237fffd5e5544b45b0d92c41a4afe3e3f778e942e43ce6be197b9cdc7c251dcde6e2a52297ea269370680') { echo 'Installer verified';  } else { echo 'Installer corrupt'; unlink('composer-setup.php');  }\" \\\nRUN cd / \\\n && php -r \"readfile('https://getcomposer.org/installer');\" > composer-setup.php \\\n && php composer-setup.php --filename=composer --install-dir=/usr/local/bin/ \\\n && rm composer-setup.php \\\n && composer global require \"laravel/lumen-installer\" \\\n && composer global require \"laravel/installer\" \\\n && composer clearcache \\\n && composer clear-cache\n#   解决时区问题\nENV TZ=\"\\\"Asia/Shanghai\\\"\"\n#   终端设置\n#   执行php-fpm时，默认值是dumb，这时在终端操作时可能会出现：terminal is not fully functional\nENV TERM=\"xterm\"\n#   Define mountable directories.\nVOLUME /var/www\n#   工作目录\nWORKDIR /var/www \nEXPOSE 9000/tcp\n","originalDockerfileUglifiedHash":"61dabab41e4a7759235ff96c6a6635ee","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/793544440b17e0d656da73d831563f4a9d1cfb62.dockerfile"}