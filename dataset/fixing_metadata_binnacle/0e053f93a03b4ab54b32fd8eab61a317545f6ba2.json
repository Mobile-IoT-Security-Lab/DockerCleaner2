{"seed":1978410026,"processedDockerfileHash":"491204ea52c81949f26f416022c4bc59","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM php:5.6-apache\nMAINTAINER Rafael Corrêa Gomes <rafaelcgstz@gmail.com>\nENV XDEBUG_PORT=\"9000\"\nRUN apt-get update \\\n && (apt-get update ;apt-get install --no-install-recommends libmcrypt-dev libmcrypt4 libcurl3-dev libfreetype6 libjpeg62-turbo libfreetype6-dev libjpeg62-turbo-dev apt-utils mariadb-server-core-10.1 mariadb-server-10.1 mariadb-client-10.1 libxml2-dev git wget zip vim gcc make autoconf libc-dev pkg-config -y )\nRUN docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ \\\n && docker-php-ext-install pdo pdo_mysql gd mcrypt mbstring soap\nRUN chmod 777 -R /var/www \\\n && chown -R www-data:1000 /var/www \\\n && usermod -u 1000 www-data \\\n && chsh -s /bin/bash www-data \\\n && a2enmod rewrite \\\n && a2enmod headers \\\n && sed -i -e 's/\\/var\\/www\\/html/\\/var\\/www\\/htdocs/' /etc/apache2/apache2.conf\n#   Install oAuth\nRUN : \\\n && pecl install oauth-1.2.3 \\\n && echo \"extension=oauth.so\" > /usr/local/etc/php/conf.d/docker-php-ext-oauth.ini\n#   Install Mhsendmail\nRUN DEBIAN_FRONTEND=noninteractive apt-get -y install golang-go \\\n && mkdir /opt/go \\\n && export GOPATH=/opt/go \\\n && go get github.com/mailhog/mhsendmail\n#   Install XDebug\nRUN pecl install xdebug-2.5.5 \\\n && pecl channel-update pecl.php.net \\\n && docker-php-ext-enable xdebug\nRUN echo \"zend_extension=$( find /usr/local/lib/php/extensions/ -name xdebug.so ;)\" > /usr/local/etc/php/conf.d/xdebug.iniOLD\n#   Install Magerun\nRUN wget https://files.magerun.net/n98-magerun.phar --no-check-certificate \\\n && chmod +x ./n98-magerun.phar \\\n && mv ./n98-magerun.phar /usr/local/bin/\n#   Install Modman\nRUN wget https://raw.githubusercontent.com/colinmollenhour/modman/master/modman -O /usr/local/bin/modma\n#   SSH\n#   RUN apt-get update && apt-get install -y openssh-server openssh-client\n#   RUN mkdir /var/run/sshd\n#   RUN echo 'root:root' | chpasswd\n#   RUN sed -i 's/PermitRootLogin without-password/PermitRootLogin yes/' /etc/ssh/sshd_config\n#   RUN sed 's@session\\s*required\\s*pam_loginuid.so@session optional pam_loginuid.so@g' -i /etc/pam.d/sshd\n#   ENV NOTVISIBLE \"in users profile\"\n#   RUN echo \"export VISIBLE=now\" >> /etc/profile\n#   RUN /etc/init.d/apache2 restart\n#   Install Composer\nRUN curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin/ --filename=composer\n#   To SSH\n#   RUN /usr/sbin/sshd\n#   Configuring system\nCOPY .docker/config/php.ini /usr/local/etc/php/php.ini\nCOPY .docker/config/magento.conf /etc/apache2/sites-available/magento.conf\nCOPY .docker/config/custom-xdebug.ini /usr/local/etc/php/conf.d/custom-xdebug.ini\nCOPY .docker/bin/* /usr/local/bin/\nCOPY .docker/users/* /var/www/\nRUN chmod +x /usr/local/bin/*\nRUN ln -s /etc/apache2/sites-available/magento.conf /etc/apache2/sites-enabled/magento.conf\nVOLUME [\"/var/www/html\"]\nWORKDIR /var/www/html\nCOPY ./src /var/www/html\nCMD [\"apache2-foreground\", \"-DFOREGROUND\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\n","originalDockerfile":"FROM php:5.6-apache\nMAINTAINER Rafael Corrêa Gomes <rafaelcgstz@gmail.com>\nENV XDEBUG_PORT=\"9000\"\nRUN apt-get update \\\n && apt-get install libmcrypt-dev libmcrypt4 libcurl3-dev libfreetype6 libjpeg62-turbo libfreetype6-dev libjpeg62-turbo-dev apt-utils mariadb-server-core-10.1 mariadb-server-10.1 mariadb-client-10.1 libxml2-dev git wget zip vim gcc make autoconf libc-dev pkg-config -y\nRUN docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ \\\n && docker-php-ext-install pdo pdo_mysql gd mcrypt mbstring soap\nRUN chmod 777 -R /var/www \\\n && chown -R www-data:1000 /var/www \\\n && usermod -u 1000 www-data \\\n && chsh -s /bin/bash www-data \\\n && a2enmod rewrite \\\n && a2enmod headers \\\n && sed -i -e 's/\\/var\\/www\\/html/\\/var\\/www\\/htdocs/' /etc/apache2/apache2.conf\n#  Install oAuth\nRUN apt-get update \\\n && pecl install oauth-1.2.3 \\\n && echo \"extension=oauth.so\" > /usr/local/etc/php/conf.d/docker-php-ext-oauth.ini\n#  Install Mhsendmail\nRUN DEBIAN_FRONTEND=noninteractive apt-get -y install golang-go \\\n && mkdir /opt/go \\\n && export GOPATH=/opt/go \\\n && go get github.com/mailhog/mhsendmail\n#  Install XDebug\nRUN pecl install xdebug-2.5.5 \\\n && pecl channel-update pecl.php.net \\\n && docker-php-ext-enable xdebug\nRUN echo \"zend_extension=$( find /usr/local/lib/php/extensions/ -name xdebug.so ;)\" > /usr/local/etc/php/conf.d/xdebug.iniOLD\n#  Install Magerun\nRUN wget https://files.magerun.net/n98-magerun.phar --no-check-certificate \\\n && chmod +x ./n98-magerun.phar \\\n && mv ./n98-magerun.phar /usr/local/bin/\n#  Install Modman\nRUN wget https://raw.githubusercontent.com/colinmollenhour/modman/master/modman -O /usr/local/bin/modma\n#  SSH\n#  RUN apt-get update && apt-get install -y openssh-server openssh-client\n#  RUN mkdir /var/run/sshd\n#  RUN echo 'root:root' | chpasswd\n#  RUN sed -i 's/PermitRootLogin without-password/PermitRootLogin yes/' /etc/ssh/sshd_config\n#  RUN sed 's@session\\s*required\\s*pam_loginuid.so@session optional pam_loginuid.so@g' -i /etc/pam.d/sshd\n#  ENV NOTVISIBLE \"in users profile\"\n#  RUN echo \"export VISIBLE=now\" >> /etc/profile\n#  RUN /etc/init.d/apache2 restart\n#  Install Composer\nRUN curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin/ --filename=composer\n#  To SSH\n#  RUN /usr/sbin/sshd\n#  Configuring system\nADD .docker/config/php.ini /usr/local/etc/php/php.ini\nADD .docker/config/magento.conf /etc/apache2/sites-available/magento.conf\nADD .docker/config/custom-xdebug.ini /usr/local/etc/php/conf.d/custom-xdebug.ini\nCOPY .docker/bin/* /usr/local/bin/\nCOPY .docker/users/* /var/www/\nRUN chmod +x /usr/local/bin/*\nRUN ln -s /etc/apache2/sites-available/magento.conf /etc/apache2/sites-enabled/magento.conf\nVOLUME [\"/var/www/html\"]\nWORKDIR /var/www/html\nCOPY ./src /var/www/html\nCMD [\"apache2-foreground\", \"-DFOREGROUND\"]\n","injectedSmells":[],"originalDockerfileHash":"49be87286876681b815112e275ec242a","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM php:5.6-apache\nMAINTAINER Rafael Corrêa Gomes <rafaelcgstz@gmail.com>\nENV XDEBUG_PORT=\"9000\"\nRUN apt-get update \\\n && apt-get install libmcrypt-dev libmcrypt4 libcurl3-dev libfreetype6 libjpeg62-turbo libfreetype6-dev libjpeg62-turbo-dev apt-utils mariadb-server-core-10.1 mariadb-server-10.1 mariadb-client-10.1 libxml2-dev git wget zip vim gcc make autoconf libc-dev pkg-config -y\nRUN docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ \\\n && docker-php-ext-install pdo pdo_mysql gd mcrypt mbstring soap\nRUN chmod 777 -R /var/www \\\n && chown -R www-data:1000 /var/www \\\n && usermod -u 1000 www-data \\\n && chsh -s /bin/bash www-data \\\n && a2enmod rewrite \\\n && a2enmod headers \\\n && sed -i -e 's/\\/var\\/www\\/html/\\/var\\/www\\/htdocs/' /etc/apache2/apache2.conf\n#   Install oAuth\nRUN apt-get update \\\n && pecl install oauth-1.2.3 \\\n && echo \"extension=oauth.so\" > /usr/local/etc/php/conf.d/docker-php-ext-oauth.ini\n#   Install Mhsendmail\nRUN DEBIAN_FRONTEND=noninteractive apt-get -y install golang-go \\\n && mkdir /opt/go \\\n && export GOPATH=/opt/go \\\n && go get github.com/mailhog/mhsendmail\n#   Install XDebug\nRUN pecl install xdebug-2.5.5 \\\n && pecl channel-update pecl.php.net \\\n && docker-php-ext-enable xdebug\nRUN echo \"zend_extension=$( find /usr/local/lib/php/extensions/ -name xdebug.so ;)\" > /usr/local/etc/php/conf.d/xdebug.iniOLD\n#   Install Magerun\nRUN wget https://files.magerun.net/n98-magerun.phar --no-check-certificate \\\n && chmod +x ./n98-magerun.phar \\\n && mv ./n98-magerun.phar /usr/local/bin/\n#   Install Modman\nRUN wget https://raw.githubusercontent.com/colinmollenhour/modman/master/modman -O /usr/local/bin/modma\n#   SSH\n#   RUN apt-get update && apt-get install -y openssh-server openssh-client\n#   RUN mkdir /var/run/sshd\n#   RUN echo 'root:root' | chpasswd\n#   RUN sed -i 's/PermitRootLogin without-password/PermitRootLogin yes/' /etc/ssh/sshd_config\n#   RUN sed 's@session\\s*required\\s*pam_loginuid.so@session optional pam_loginuid.so@g' -i /etc/pam.d/sshd\n#   ENV NOTVISIBLE \"in users profile\"\n#   RUN echo \"export VISIBLE=now\" >> /etc/profile\n#   RUN /etc/init.d/apache2 restart\n#   Install Composer\nRUN curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin/ --filename=composer\n#   To SSH\n#   RUN /usr/sbin/sshd\n#   Configuring system\nADD .docker/config/php.ini /usr/local/etc/php/php.ini\nADD .docker/config/magento.conf /etc/apache2/sites-available/magento.conf\nADD .docker/config/custom-xdebug.ini /usr/local/etc/php/conf.d/custom-xdebug.ini\nCOPY .docker/bin/* /usr/local/bin/\nCOPY .docker/users/* /var/www/\nRUN chmod +x /usr/local/bin/*\nRUN ln -s /etc/apache2/sites-available/magento.conf /etc/apache2/sites-enabled/magento.conf\nVOLUME [\"/var/www/html\"]\nWORKDIR /var/www/html\nCOPY ./src /var/www/html\nCMD [\"apache2-foreground\", \"-DFOREGROUND\"]\n","originalDockerfileUglifiedHash":"bf411dc3c2b71c9aa7e2e97e0622260c","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/0e053f93a03b4ab54b32fd8eab61a317545f6ba2.dockerfile"}