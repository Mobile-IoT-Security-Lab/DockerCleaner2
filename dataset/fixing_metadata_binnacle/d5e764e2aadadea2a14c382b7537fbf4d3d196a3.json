{"seed":3997342813,"processedDockerfileHash":"e9d180faa9c081ff0f7b43d5e7a51480","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","pin-package-manager-versions-apt-get","have-a-healthcheck","have-a-user"],"processedDockerfile":"#   **Description:**\n#\n#   Source: https://github.com/dlandon/zoneminder\n#\n#   Run zoneminder in a container.\n#\n#   Zoneminder GUI: http://IP:8080/zm or https://IP:8443/zm\n#\n#   zmNinja Notification Sever: https://IP:9000\n#\n#   **Running:**\n#\n#   ```sh\n#   docker run -d --name zoneminder \\\n#   --net bridge \\\n#    --privileged \\\n#    -p 8080:80/tcp \\\n#    -p 8443:443/tcp \\\n#    -p 9000:9000/tcp \\\n#    -e TZ=\"America/New_York\" \\\n#    -e SHMEM=\"50%\" \\\n#    -e PUID=\"99\" \\\n#    -e PGID=\"100\" \\\n#    -v ~/zm/config:/config \\\n#    -v ~/zm/data:/var/cache/zoneminder \\\n#    cdrage/zoneminder\n#   ```\nFROM dlandon/baseimage\nLABEL maintainer=\"dlandon\"\nENV SHMEM=\"50%\" \\\n    PUID=\"99\" \\\n    PGID=\"100\"\nCOPY init/ /etc/my_init.d/\nCOPY defaults/ /root/\nCOPY zmeventnotification/zmeventnotification.pl /usr/bin/\nCOPY zmeventnotification/zmeventnotification.ini /root/\nRUN add-apt-repository -y ppa:iconnor/zoneminder \\\n && apt-get update \\\n && apt-get upgrade -y -o Dpkg::Options::=\"--force-confold\" \\\n && apt-get dist-upgrade -y \\\n && apt-get install --no-install-recommends mariadb-server=1:10.11.2-1 -y \\\n && apt-get install --no-install-recommends wget=1.21.3-1ubuntu1 -y \\\n && apt-get install --no-install-recommends sudo=1.9.13p1-1ubuntu2 -y \\\n && apt-get install --no-install-recommends cakephp -y \\\n && apt-get install --no-install-recommends libav-tools -y \\\n && apt-get install --no-install-recommends ssmtp=2.64-11 mailutils=1:3.15-4 php-curl=2:8.1+92ubuntu1 net-tools=2.10-0.1ubuntu3 -y \\\n && apt-get install --no-install-recommends php-gd=2:8.1+92ubuntu1 zoneminder=1.30.4* -y \\\n && apt-get install --no-install-recommends libcrypt-mysql-perl=0.04-7build1 libyaml-perl=1.30-2 make=4.3-4.1build1 libjson-perl=4.10000-1 -y\nRUN rm /etc/mysql/my.cnf \\\n && cp /etc/mysql/mariadb.conf.d/50-server.cnf /etc/mysql/my.cnf \\\n && chmod 740 /etc/zm/zm.conf \\\n && chown root:www-data /etc/zm/zm.conf \\\n && adduser www-data video \\\n && a2enmod cgi \\\n && a2enconf zoneminder \\\n && a2enmod rewrite \\\n && perl -MCPAN -e \"force install Net::WebSocket::Server\" \\\n && perl -MCPAN -e \"force install LWP::Protocol::https\" \\\n && perl -MCPAN -e \"force install Config::IniFiles\"\nRUN cd /root \\\n && wget www.andywilcock.com/code/cambozola/cambozola-latest.tar.gz \\\n && tar xvf cambozola-latest.tar.gz \\\n && cp cambozola*/dist/cambozola.jar /usr/share/zoneminder/www \\\n && rm -rf cambozola*/ \\\n && rm -rf cambozola-latest.tar.gz \\\n && chmod 775 /usr/share/zoneminder/www/cambozola.jar \\\n && chown -R www-data:www-data /usr/share/zoneminder/ \\\n && echo \"ServerName localhost\" >> /etc/apache2/apache2.conf \\\n && sed -i \"s|^;date.timezone =.*|date.timezone = ${TZ}|\" /etc/php/7.0/apache2/php.ini \\\n && sed -i \"s|^start() {$|start() {\\n sleep 15|\" /etc/init.d/zoneminder \\\n && service mysql start \\\n && mysql -uroot < /usr/share/zoneminder/db/zm_create.sql \\\n && mysql -uroot -e \"grant all on zm.* to 'zmuser'@localhost identified by 'zmpass';\" \\\n && mysqladmin -uroot reload \\\n && mysql -sfu root < \"mysql_secure_installation.sql\" \\\n && rm mysql_secure_installation.sql \\\n && mysql -sfu root < \"mysql_defaults.sql\" \\\n && rm mysql_defaults.sql\nRUN service mysql restart \\\n && sleep 10 \\\n && service apache2 restart \\\n && service zoneminder start\nRUN systemd-tmpfiles --create zoneminder.conf \\\n && cp /root/default-ssl.conf /etc/apache2/sites-enabled/default-ssl.conf \\\n && mkdir /etc/apache2/ssl/ \\\n && chmod a+x /usr/bin/zmeventnotification.pl \\\n && mkdir /etc/private \\\n && chmod 777 /etc/private \\\n && chmod -R +x /etc/my_init.d/ \\\n && cp -p /etc/zm/zm.conf /root/zm.conf \\\n && sed -i \"/'zmupdate.pl',/a\\ \\ \\ \\ 'zmeventnotification.pl',\" /usr/bin/zmdc.pl \\\n && sed -i '/runCommand( \"zmdc.pl start zmfilter.pl\" );/a\\ \\ \\ \\ \\ \\ \\ \\ runCommand( \"zmdc.pl start zmeventnotification.pl\" )\\;' /usr/bin/zmpkg.pl\nRUN rm /etc/apt/sources.list.d/iconnor-ubuntu-zoneminder-xenial.list \\\n && apt-get -y remove wget make \\\n && update-rc.d -f zoneminder remove \\\n && update-rc.d -f mysql remove \\\n && update-rc.d -f mysql-common remove \\\n && apt-get -y clean \\\n && apt-get -y autoremove \\\n && rm -rf /tmp/* /var/tmp/*\nVOLUME [\"/config\"]  [\"/var/cache/zoneminder\"]\nEXPOSE 80/tcp 443/tcp 9000/tcp\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  **Description:**\n#\n#  Source: https://github.com/dlandon/zoneminder\n#\n#  Run zoneminder in a container.\n#\n#  Zoneminder GUI: http://IP:8080/zm or https://IP:8443/zm\n#\n#  zmNinja Notification Sever: https://IP:9000\n#\n#  **Running:**\n#\n#  ```sh\n#  docker run -d --name zoneminder \\\n#  --net bridge \\\n#   --privileged \\\n#   -p 8080:80/tcp \\\n#   -p 8443:443/tcp \\\n#   -p 9000:9000/tcp \\\n#   -e TZ=\"America/New_York\" \\\n#   -e SHMEM=\"50%\" \\\n#   -e PUID=\"99\" \\\n#   -e PGID=\"100\" \\\n#   -v ~/zm/config:/config \\\n#   -v ~/zm/data:/var/cache/zoneminder \\\n#   cdrage/zoneminder\n#  ```\nFROM dlandon/baseimage\nLABEL maintainer=\"dlandon\"\nENV SHMEM=\"50%\" \\\n    PUID=\"99\" \\\n    PGID=\"100\"\nCOPY init/ /etc/my_init.d/\nCOPY defaults/ /root/\nCOPY zmeventnotification/zmeventnotification.pl /usr/bin/\nCOPY zmeventnotification/zmeventnotification.ini /root/\nRUN add-apt-repository -y ppa:iconnor/zoneminder \\\n && apt-get update \\\n && apt-get upgrade -y -o Dpkg::Options::=\"--force-confold\" \\\n && apt-get dist-upgrade -y \\\n && apt-get install mariadb-server -y \\\n && apt-get install wget -y \\\n && apt-get install sudo -y \\\n && apt-get install cakephp -y \\\n && apt-get install libav-tools -y \\\n && apt-get install ssmtp mailutils php-curl net-tools -y \\\n && apt-get install php-gd zoneminder=1.30.4* -y \\\n && apt-get install libcrypt-mysql-perl libyaml-perl make libjson-perl -y\nRUN rm /etc/mysql/my.cnf \\\n && cp /etc/mysql/mariadb.conf.d/50-server.cnf /etc/mysql/my.cnf \\\n && chmod 740 /etc/zm/zm.conf \\\n && chown root:www-data /etc/zm/zm.conf \\\n && adduser www-data video \\\n && a2enmod cgi \\\n && a2enconf zoneminder \\\n && a2enmod rewrite \\\n && perl -MCPAN -e \"force install Net::WebSocket::Server\" \\\n && perl -MCPAN -e \"force install LWP::Protocol::https\" \\\n && perl -MCPAN -e \"force install Config::IniFiles\"\nRUN cd /root \\\n && wget www.andywilcock.com/code/cambozola/cambozola-latest.tar.gz \\\n && tar xvf cambozola-latest.tar.gz \\\n && cp cambozola*/dist/cambozola.jar /usr/share/zoneminder/www \\\n && rm -rf cambozola*/ \\\n && rm -rf cambozola-latest.tar.gz \\\n && chmod 775 /usr/share/zoneminder/www/cambozola.jar \\\n && chown -R www-data:www-data /usr/share/zoneminder/ \\\n && echo \"ServerName localhost\" >> /etc/apache2/apache2.conf \\\n && sed -i \"s|^;date.timezone =.*|date.timezone = ${TZ}|\" /etc/php/7.0/apache2/php.ini \\\n && sed -i \"s|^start() {$|start() {\\n sleep 15|\" /etc/init.d/zoneminder \\\n && service mysql start \\\n && mysql -uroot < /usr/share/zoneminder/db/zm_create.sql \\\n && mysql -uroot -e \"grant all on zm.* to 'zmuser'@localhost identified by 'zmpass';\" \\\n && mysqladmin -uroot reload \\\n && mysql -sfu root < \"mysql_secure_installation.sql\" \\\n && rm mysql_secure_installation.sql \\\n && mysql -sfu root < \"mysql_defaults.sql\" \\\n && rm mysql_defaults.sql\nRUN service mysql restart \\\n && sleep 10 \\\n && service apache2 restart \\\n && service zoneminder start\nRUN systemd-tmpfiles --create zoneminder.conf \\\n && cp /root/default-ssl.conf /etc/apache2/sites-enabled/default-ssl.conf \\\n && mkdir /etc/apache2/ssl/ \\\n && chmod a+x /usr/bin/zmeventnotification.pl \\\n && mkdir /etc/private \\\n && chmod 777 /etc/private \\\n && chmod -R +x /etc/my_init.d/ \\\n && cp -p /etc/zm/zm.conf /root/zm.conf \\\n && sed -i \"/'zmupdate.pl',/a\\ \\ \\ \\ 'zmeventnotification.pl',\" /usr/bin/zmdc.pl \\\n && sed -i '/runCommand( \"zmdc.pl start zmfilter.pl\" );/a\\ \\ \\ \\ \\ \\ \\ \\ runCommand( \"zmdc.pl start zmeventnotification.pl\" )\\;' /usr/bin/zmpkg.pl\nRUN rm /etc/apt/sources.list.d/iconnor-ubuntu-zoneminder-xenial.list \\\n && apt-get -y remove wget make \\\n && update-rc.d -f zoneminder remove \\\n && update-rc.d -f mysql remove \\\n && update-rc.d -f mysql-common remove \\\n && apt-get -y clean \\\n && apt-get -y autoremove \\\n && rm -rf /tmp/* /var/tmp/*\nVOLUME [\"/config\"]  [\"/var/cache/zoneminder\"]\nEXPOSE 80/tcp 443/tcp 9000/tcp\n","injectedSmells":[],"originalDockerfileHash":"a15039efd15a720be110fd96ee429c5d","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   **Description:**\n#\n#   Source: https://github.com/dlandon/zoneminder\n#\n#   Run zoneminder in a container.\n#\n#   Zoneminder GUI: http://IP:8080/zm or https://IP:8443/zm\n#\n#   zmNinja Notification Sever: https://IP:9000\n#\n#   **Running:**\n#\n#   ```sh\n#   docker run -d --name zoneminder \\\n#   --net bridge \\\n#    --privileged \\\n#    -p 8080:80/tcp \\\n#    -p 8443:443/tcp \\\n#    -p 9000:9000/tcp \\\n#    -e TZ=\"America/New_York\" \\\n#    -e SHMEM=\"50%\" \\\n#    -e PUID=\"99\" \\\n#    -e PGID=\"100\" \\\n#    -v ~/zm/config:/config \\\n#    -v ~/zm/data:/var/cache/zoneminder \\\n#    cdrage/zoneminder\n#   ```\nFROM dlandon/baseimage\nLABEL maintainer=\"dlandon\"\nENV SHMEM=\"50%\" \\\n    PUID=\"99\" \\\n    PGID=\"100\"\nCOPY init/ /etc/my_init.d/\nCOPY defaults/ /root/\nCOPY zmeventnotification/zmeventnotification.pl /usr/bin/\nCOPY zmeventnotification/zmeventnotification.ini /root/\nRUN add-apt-repository -y ppa:iconnor/zoneminder \\\n && apt-get update \\\n && apt-get upgrade -y -o Dpkg::Options::=\"--force-confold\" \\\n && apt-get dist-upgrade -y \\\n && apt-get install mariadb-server -y \\\n && apt-get install wget -y \\\n && apt-get install sudo -y \\\n && apt-get install cakephp -y \\\n && apt-get install libav-tools -y \\\n && apt-get install ssmtp mailutils php-curl net-tools -y \\\n && apt-get install php-gd zoneminder=1.30.4* -y \\\n && apt-get install libcrypt-mysql-perl libyaml-perl make libjson-perl -y\nRUN rm /etc/mysql/my.cnf \\\n && cp /etc/mysql/mariadb.conf.d/50-server.cnf /etc/mysql/my.cnf \\\n && chmod 740 /etc/zm/zm.conf \\\n && chown root:www-data /etc/zm/zm.conf \\\n && adduser www-data video \\\n && a2enmod cgi \\\n && a2enconf zoneminder \\\n && a2enmod rewrite \\\n && perl -MCPAN -e \"force install Net::WebSocket::Server\" \\\n && perl -MCPAN -e \"force install LWP::Protocol::https\" \\\n && perl -MCPAN -e \"force install Config::IniFiles\"\nRUN cd /root \\\n && wget www.andywilcock.com/code/cambozola/cambozola-latest.tar.gz \\\n && tar xvf cambozola-latest.tar.gz \\\n && cp cambozola*/dist/cambozola.jar /usr/share/zoneminder/www \\\n && rm -rf cambozola*/ \\\n && rm -rf cambozola-latest.tar.gz \\\n && chmod 775 /usr/share/zoneminder/www/cambozola.jar \\\n && chown -R www-data:www-data /usr/share/zoneminder/ \\\n && echo \"ServerName localhost\" >> /etc/apache2/apache2.conf \\\n && sed -i \"s|^;date.timezone =.*|date.timezone = ${TZ}|\" /etc/php/7.0/apache2/php.ini \\\n && sed -i \"s|^start() {$|start() {\\n sleep 15|\" /etc/init.d/zoneminder \\\n && service mysql start \\\n && mysql -uroot < /usr/share/zoneminder/db/zm_create.sql \\\n && mysql -uroot -e \"grant all on zm.* to 'zmuser'@localhost identified by 'zmpass';\" \\\n && mysqladmin -uroot reload \\\n && mysql -sfu root < \"mysql_secure_installation.sql\" \\\n && rm mysql_secure_installation.sql \\\n && mysql -sfu root < \"mysql_defaults.sql\" \\\n && rm mysql_defaults.sql\nRUN service mysql restart \\\n && sleep 10 \\\n && service apache2 restart \\\n && service zoneminder start\nRUN systemd-tmpfiles --create zoneminder.conf \\\n && cp /root/default-ssl.conf /etc/apache2/sites-enabled/default-ssl.conf \\\n && mkdir /etc/apache2/ssl/ \\\n && chmod a+x /usr/bin/zmeventnotification.pl \\\n && mkdir /etc/private \\\n && chmod 777 /etc/private \\\n && chmod -R +x /etc/my_init.d/ \\\n && cp -p /etc/zm/zm.conf /root/zm.conf \\\n && sed -i \"/'zmupdate.pl',/a\\ \\ \\ \\ 'zmeventnotification.pl',\" /usr/bin/zmdc.pl \\\n && sed -i '/runCommand( \"zmdc.pl start zmfilter.pl\" );/a\\ \\ \\ \\ \\ \\ \\ \\ runCommand( \"zmdc.pl start zmeventnotification.pl\" )\\;' /usr/bin/zmpkg.pl\nRUN rm /etc/apt/sources.list.d/iconnor-ubuntu-zoneminder-xenial.list \\\n && apt-get -y remove wget make \\\n && update-rc.d -f zoneminder remove \\\n && update-rc.d -f mysql remove \\\n && update-rc.d -f mysql-common remove \\\n && apt-get -y clean \\\n && apt-get -y autoremove \\\n && rm -rf /tmp/* /var/tmp/*\nVOLUME [\"/config\"]  [\"/var/cache/zoneminder\"]\nEXPOSE 80/tcp 443/tcp 9000/tcp\n","originalDockerfileUglifiedHash":"444536c29a24e97ec9b552e55735c8cb","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/d5e764e2aadadea2a14c382b7537fbf4d3d196a3.dockerfile"}