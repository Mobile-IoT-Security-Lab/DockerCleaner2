{"seed":3582924173,"processedDockerfileHash":"f2563f7fee8d4d218bd0a94660070328","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["do-not-use-apt-get-update-alone","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM debian:stretch-slim\nLABEL maintainer=\"contact@ocsinventory-ng.org\"\nLABEL version=\"2.5\"\nLABEL description=\"OCS (Open Computers and Software Inventory Next Generation)\"\nARG APT_FLAGS=\"-y --no-install-recommends\"\nVOLUME /var/lib/mysql\nRUN : ; apt-get ${APT_FLAGS} install apache2 apache2-doc apt-utils php7.0 php7.0-gd php7.0-mysql php7.0-cgi php7.0-curl php7.0-xml php7.0-soap php7.0-zip perl build-essential libapache2-mod-php7.0 libxml2 libxml-simple-perl libc6-dev libnet-ip-perl libxml-libxml-perl libapache2-mod-perl2 libdbi-perl libapache-dbi-perl libdbd-mysql-perl libio-compress-perl libxml-simple-perl libsoap-lite-perl libarchive-zip-perl libnet-ip-perl php-mbstring php-pclzip libsoap-lite-perl libarchive-zip-perl libmodule-build-perl nano wget tar make ; cpan -i XML::Entities ; /usr/sbin/a2dissite 000-default ; /usr/sbin/a2enmod rewrite ; /usr/sbin/a2enmod ssl ; /usr/sbin/a2enmod authz_user ; wget https://raw.githubusercontent.com/OCSInventory-NG/OCSInventory-Server/master/binutils/docker-download.sh ; sh docker-download.sh 2.5\nENV TZ=\"\\\"Europe/Paris\\\"\"\nWORKDIR /tmp/ocs/Apache\nRUN perl Makefile.PL ; make ; make install ; ln -snf /usr/share/zoneinfo/$TZ /etc/localtime \\\n && echo $TZ > /etc/timezone; cp -R blib/lib/Apache /usr/local/share/perl/5.28.0/ ; cp -R Ocsinventory /usr/local/share/perl/5.28.0/ ; cp /tmp/ocs/etc/logrotate.d/ocsinventory-server /etc/logrotate.d/ ; mkdir -p /etc/ocsinventory-server/plugins ; mkdir -p /etc/ocsinventory-server/perl ; mkdir -p /usr/share/ocsinventory-reports/ocsreports\nENV APACHE_RUN_USER=\"www-data\"\nENV APACHE_RUN_GROUP=\"www-data\"\nENV APACHE_LOG_DIR=\"/var/log/apache2\"\nENV APACHE_PID_FILE=\"/var/run/apache2.pid\"\nENV APACHE_RUN_DIR=\"/var/run/apache2f\"\nENV APACHE_LOCK_DIR=\"/var/lock/apache2\"\nENV APACHE_LOG_DIR=\"/var/log/apache2\"\nENV OCS_DBSERVER_READ_PORT=\"3306\"\nENV OCS_DBSERVER_WRITE_PORT=\"3306\"\nWORKDIR /tmp/ocs\nRUN cp -R ocsreports/* /usr/share/ocsinventory-reports/ocsreports ; bash -c 'mkdir -p /var/lib/ocsinventory-reports/{download,ipd,logs,scripts,snmp}' ; chmod -R +w /var/lib/ocsinventory-reports ; chown www-data: -R /var/lib/ocsinventory-reports ; cp binutils/ipdiscover-util.pl /usr/share/ocsinventory-reports/ocsreports/ipdiscover-util.pl ; chown www-data: /usr/share/ocsinventory-reports/ocsreports/ipdiscover-util.pl ; chmod 755 /usr/share/ocsinventory-reports/ocsreports/ipdiscover-util.pl ; mkdir -p /var/log/ocsinventory-server/ ; chmod +w /var/log/ocsinventory-server ; chown -R www-data: /usr/share/ocsinventory-reports/\nCOPY ./dbconfig.inc.php /usr/share/ocsinventory-reports/ocsreports/dbconfig.inc.php\nCOPY /conf/ocsinventory-reports.conf /conf/z-ocsinventory-server.conf /etc/apache2/conf-available/\nCOPY ./conf/php.ini /etc/php/7.0/apache2/php.ini\nCOPY ./scripts/run.sh /root/run.sh\nRUN chown www-data: /usr/share/ocsinventory-reports/ocsreports/dbconfig.inc.php ; chmod +x /root/run.sh ; ln -s /etc/apache2/conf-available/ocsinventory-reports.conf /etc/apache2/conf-enabled/ocsinventory-reports.conf ; ln -s /etc/apache2/conf-available/z-ocsinventory-server.conf /etc/apache2/conf-enabled/z-ocsinventory-server.conf ; rm /usr/share/ocsinventory-reports/ocsreports/install.php ; rm -rf /tmp/ocs ; apt-get clean ; apt-get autoclean ; apt-get autoremove ; rm -rf /var/lib/apt/lists/* ; rm -rf /var/cache/apt/archives/*\nEXPOSE 80/tcp\nEXPOSE 443/tcp\nCMD [\"/bin/bash\", \"/root/run.sh\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM debian:stretch-slim\nLABEL maintainer=\"contact@ocsinventory-ng.org\"\nLABEL version=\"2.5\"\nLABEL description=\"OCS (Open Computers and Software Inventory Next Generation)\"\nARG APT_FLAGS=\"-y --no-install-recommends\"\nVOLUME /var/lib/mysql\nRUN apt-get update ; apt-get ${APT_FLAGS} install apache2 apache2-doc apt-utils php7.0 php7.0-gd php7.0-mysql php7.0-cgi php7.0-curl php7.0-xml php7.0-soap php7.0-zip perl build-essential libapache2-mod-php7.0 libxml2 libxml-simple-perl libc6-dev libnet-ip-perl libxml-libxml-perl libapache2-mod-perl2 libdbi-perl libapache-dbi-perl libdbd-mysql-perl libio-compress-perl libxml-simple-perl libsoap-lite-perl libarchive-zip-perl libnet-ip-perl php-mbstring php-pclzip libsoap-lite-perl libarchive-zip-perl libmodule-build-perl nano wget tar make ; cpan -i XML::Entities ; /usr/sbin/a2dissite 000-default ; /usr/sbin/a2enmod rewrite ; /usr/sbin/a2enmod ssl ; /usr/sbin/a2enmod authz_user ; wget https://raw.githubusercontent.com/OCSInventory-NG/OCSInventory-Server/master/binutils/docker-download.sh ; sh docker-download.sh 2.5\nENV TZ=\"\\\"Europe/Paris\\\"\"\nWORKDIR /tmp/ocs/Apache\nRUN perl Makefile.PL ; make ; make install ; ln -snf /usr/share/zoneinfo/$TZ /etc/localtime \\\n && echo $TZ > /etc/timezone; cp -R blib/lib/Apache /usr/local/share/perl/5.28.0/ ; cp -R Ocsinventory /usr/local/share/perl/5.28.0/ ; cp /tmp/ocs/etc/logrotate.d/ocsinventory-server /etc/logrotate.d/ ; mkdir -p /etc/ocsinventory-server/plugins ; mkdir -p /etc/ocsinventory-server/perl ; mkdir -p /usr/share/ocsinventory-reports/ocsreports\nENV APACHE_RUN_USER=\"www-data\"\nENV APACHE_RUN_GROUP=\"www-data\"\nENV APACHE_LOG_DIR=\"/var/log/apache2\"\nENV APACHE_PID_FILE=\"/var/run/apache2.pid\"\nENV APACHE_RUN_DIR=\"/var/run/apache2f\"\nENV APACHE_LOCK_DIR=\"/var/lock/apache2\"\nENV APACHE_LOG_DIR=\"/var/log/apache2\"\nENV OCS_DBSERVER_READ_PORT=\"3306\"\nENV OCS_DBSERVER_WRITE_PORT=\"3306\"\nWORKDIR /tmp/ocs\nRUN cp -R ocsreports/* /usr/share/ocsinventory-reports/ocsreports ; bash -c 'mkdir -p /var/lib/ocsinventory-reports/{download,ipd,logs,scripts,snmp}' ; chmod -R +w /var/lib/ocsinventory-reports ; chown www-data: -R /var/lib/ocsinventory-reports ; cp binutils/ipdiscover-util.pl /usr/share/ocsinventory-reports/ocsreports/ipdiscover-util.pl ; chown www-data: /usr/share/ocsinventory-reports/ocsreports/ipdiscover-util.pl ; chmod 755 /usr/share/ocsinventory-reports/ocsreports/ipdiscover-util.pl ; mkdir -p /var/log/ocsinventory-server/ ; chmod +w /var/log/ocsinventory-server ; chown -R www-data: /usr/share/ocsinventory-reports/\nCOPY ./dbconfig.inc.php /usr/share/ocsinventory-reports/ocsreports/dbconfig.inc.php\nCOPY /conf/ocsinventory-reports.conf /conf/z-ocsinventory-server.conf /etc/apache2/conf-available/\nCOPY ./conf/php.ini /etc/php/7.0/apache2/php.ini\nCOPY ./scripts/run.sh /root/run.sh\nRUN chown www-data: /usr/share/ocsinventory-reports/ocsreports/dbconfig.inc.php ; chmod +x /root/run.sh ; ln -s /etc/apache2/conf-available/ocsinventory-reports.conf /etc/apache2/conf-enabled/ocsinventory-reports.conf ; ln -s /etc/apache2/conf-available/z-ocsinventory-server.conf /etc/apache2/conf-enabled/z-ocsinventory-server.conf ; rm /usr/share/ocsinventory-reports/ocsreports/install.php ; rm -rf /tmp/ocs ; apt-get clean ; apt-get autoclean ; apt-get autoremove ; rm -rf /var/lib/apt/lists/* ; rm -rf /var/cache/apt/archives/*\nEXPOSE 80/tcp\nEXPOSE 443/tcp\nCMD [\"/bin/bash\", \"/root/run.sh\"]\n","injectedSmells":[],"originalDockerfileHash":"0d61b5a4de90c7265af35d00d58f158d","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM debian:stretch-slim\nLABEL maintainer=\"contact@ocsinventory-ng.org\"\nLABEL version=\"2.5\"\nLABEL description=\"OCS (Open Computers and Software Inventory Next Generation)\"\nARG APT_FLAGS=\"-y --no-install-recommends\"\nVOLUME /var/lib/mysql\nRUN apt-get update ; apt-get ${APT_FLAGS} install apache2 apache2-doc apt-utils php7.0 php7.0-gd php7.0-mysql php7.0-cgi php7.0-curl php7.0-xml php7.0-soap php7.0-zip perl build-essential libapache2-mod-php7.0 libxml2 libxml-simple-perl libc6-dev libnet-ip-perl libxml-libxml-perl libapache2-mod-perl2 libdbi-perl libapache-dbi-perl libdbd-mysql-perl libio-compress-perl libxml-simple-perl libsoap-lite-perl libarchive-zip-perl libnet-ip-perl php-mbstring php-pclzip libsoap-lite-perl libarchive-zip-perl libmodule-build-perl nano wget tar make ; cpan -i XML::Entities ; /usr/sbin/a2dissite 000-default ; /usr/sbin/a2enmod rewrite ; /usr/sbin/a2enmod ssl ; /usr/sbin/a2enmod authz_user ; wget https://raw.githubusercontent.com/OCSInventory-NG/OCSInventory-Server/master/binutils/docker-download.sh ; sh docker-download.sh 2.5\nENV TZ=\"\\\"Europe/Paris\\\"\"\nWORKDIR /tmp/ocs/Apache\nRUN perl Makefile.PL ; make ; make install ; ln -snf /usr/share/zoneinfo/$TZ /etc/localtime \\\n && echo $TZ > /etc/timezone; cp -R blib/lib/Apache /usr/local/share/perl/5.28.0/ ; cp -R Ocsinventory /usr/local/share/perl/5.28.0/ ; cp /tmp/ocs/etc/logrotate.d/ocsinventory-server /etc/logrotate.d/ ; mkdir -p /etc/ocsinventory-server/plugins ; mkdir -p /etc/ocsinventory-server/perl ; mkdir -p /usr/share/ocsinventory-reports/ocsreports\nENV APACHE_RUN_USER=\"www-data\"\nENV APACHE_RUN_GROUP=\"www-data\"\nENV APACHE_LOG_DIR=\"/var/log/apache2\"\nENV APACHE_PID_FILE=\"/var/run/apache2.pid\"\nENV APACHE_RUN_DIR=\"/var/run/apache2f\"\nENV APACHE_LOCK_DIR=\"/var/lock/apache2\"\nENV APACHE_LOG_DIR=\"/var/log/apache2\"\nENV OCS_DBSERVER_READ_PORT=\"3306\"\nENV OCS_DBSERVER_WRITE_PORT=\"3306\"\nWORKDIR /tmp/ocs\nRUN cp -R ocsreports/* /usr/share/ocsinventory-reports/ocsreports ; bash -c 'mkdir -p /var/lib/ocsinventory-reports/{download,ipd,logs,scripts,snmp}' ; chmod -R +w /var/lib/ocsinventory-reports ; chown www-data: -R /var/lib/ocsinventory-reports ; cp binutils/ipdiscover-util.pl /usr/share/ocsinventory-reports/ocsreports/ipdiscover-util.pl ; chown www-data: /usr/share/ocsinventory-reports/ocsreports/ipdiscover-util.pl ; chmod 755 /usr/share/ocsinventory-reports/ocsreports/ipdiscover-util.pl ; mkdir -p /var/log/ocsinventory-server/ ; chmod +w /var/log/ocsinventory-server ; chown -R www-data: /usr/share/ocsinventory-reports/\nCOPY ./dbconfig.inc.php /usr/share/ocsinventory-reports/ocsreports/dbconfig.inc.php\nCOPY /conf/ocsinventory-reports.conf /conf/z-ocsinventory-server.conf /etc/apache2/conf-available/\nCOPY ./conf/php.ini /etc/php/7.0/apache2/php.ini\nCOPY ./scripts/run.sh /root/run.sh\nRUN chown www-data: /usr/share/ocsinventory-reports/ocsreports/dbconfig.inc.php ; chmod +x /root/run.sh ; ln -s /etc/apache2/conf-available/ocsinventory-reports.conf /etc/apache2/conf-enabled/ocsinventory-reports.conf ; ln -s /etc/apache2/conf-available/z-ocsinventory-server.conf /etc/apache2/conf-enabled/z-ocsinventory-server.conf ; rm /usr/share/ocsinventory-reports/ocsreports/install.php ; rm -rf /tmp/ocs ; apt-get clean ; apt-get autoclean ; apt-get autoremove ; rm -rf /var/lib/apt/lists/* ; rm -rf /var/cache/apt/archives/*\nEXPOSE 80/tcp\nEXPOSE 443/tcp\nCMD [\"/bin/bash\", \"/root/run.sh\"]\n","originalDockerfileUglifiedHash":"0d61b5a4de90c7265af35d00d58f158d","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/7e7e3097c488ed1c02be5f091446dba93f6650a1.dockerfile"}