{"seed":1089142598,"processedDockerfileHash":"ec4728885d1355531ff45a5ec2f8d510","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","have-a-healthcheck","have-a-user"],"processedDockerfile":"ARG BUILD_FROM=hassioaddons/base:3.1.0\n#   hadolint ignore=DL3006\nFROM ${BUILD_FROM}\n#   Set shell\nSHELL [\"/bin/bash\", \"-o\", \"pipefail\", \"-c\"]\n#   Sets working directory\nWORKDIR /app\n#   Versions\nENV HIVEMQ=\"46338a633eb26bc9f6d8d8ff82f8f2aedc004a57\" \\\n    LIBWEBSOCKETS=\"2.4.2\" \\\n    MOSQUITTO=\"1.6.2\"\n#   Setup base\n#   hadolint ignore=DL3003\nRUN apk add git=2.20.1-r0 cmake=3.13.0-r0 build-base=0.5-r1 zlib-dev=1.2.11-r1 openssl-dev=1.1.1b-r1 --no-cache --virtual .build-dependencies \\\n && apk add nginx=1.14.2-r1 lua-resty-http=0.13-r0 nginx-mod-http-lua=1.14.2-r1 --no-cache \\\n && git clone --depth=1 https://github.com/hivemq/hivemq-mqtt-web-client.git /app \\\n && git checkout \"${HIVEMQ}\" \\\n && git clone --branch \"v${LIBWEBSOCKETS}\" --depth=1 https://github.com/warmcat/libwebsockets.git /tmp/libwebsockets \\\n && mkdir -p /tmp/libwebsockets/build \\\n && cd /tmp/libwebsockets/build \\\n && cmake .. -DCMAKE_BUILD_TYPE=MinSizeRel -DCMAKE_INSTALL_PREFIX=/usr -DLWS_IPV6=OFF -DLWS_WITHOUT_BUILTIN_GETIFADDRS=ON -DLWS_WITHOUT_CLIENT=ON -DLWS_WITHOUT_EXTENSIONS=ON -DLWS_WITHOUT_TESTAPPS=ON -DLWS_WITH_SHARED=OFF -DLWS_WITH_ZIP_FOPS=OFF -DLWS_WITH_ZLIB=OFF \\\n && make \\\n && make install \\\n && git clone --branch \"v${MOSQUITTO}\" --depth=1 https://github.com/eclipse/mosquitto.git /tmp/mosquitto \\\n && cd /tmp/mosquitto \\\n && make WITH_ADNS=no WITH_DOCS=no WITH_UUID=no WITH_MEMORY_TRACKING=no WITH_SHARED_LIBRARIES=no WITH_SRV=no WITH_STRIP=yes WITH_TLS_PSK=no WITH_WEBSOCKETS=yes prefix=/usr binary \\\n && make WITH_DOCS=no install binary \\\n && addgroup -S mosquitto \\\n && adduser -S -D -H -h /var/empty -s /sbin/nologin -G mosquitto -g mosquitto mosquitto \\\n && apk del --no-cache --purge .build-dependencies \\\n && rm -fr /etc/nginx /opt/mosquitto.conf /opt/acl /tmp/*\n#   Copy root filesystem\nCOPY rootfs /\n#   Build arguments\nARG BUILD_ARCH\nARG BUILD_DATE\nARG BUILD_REF\nARG BUILD_VERSION\n#   Labels\nLABEL io.hass.name=\"MQTT Server & Web client\" \\\n      io.hass.description=\"Mosquitto MQTT Server bundled with Hivemq's web client.\" \\\n      io.hass.arch=\"${BUILD_ARCH}\" \\\n      io.hass.type=\"addon\" \\\n      io.hass.version=\"${BUILD_VERSION}\" \\\n      maintainer=\"Joakim Sørensen @ludeeus <ludeeus@gmail.com>\" \\\n      org.label-schema.description=\"Mosquitto MQTT Server bundled with Hivemq's web client.\" \\\n      org.label-schema.build-date=\"${BUILD_DATE}\" \\\n      org.label-schema.name=\"MQTT Server & Web client\" \\\n      org.label-schema.schema-version=\"1.0\" \\\n      org.label-schema.url=\"https://community.home-assistant.io/t/community-hass-io-add-ons-mqtt-server-web-client/70376\" \\\n      org.label-schema.usage=\"https://github.com/hassio-addons/addon-mqtt/tree/master/README.md\" \\\n      org.label-schema.vcs-ref=\"${BUILD_REF}\" \\\n      org.label-schema.vcs-url=\"https://github.com/hassio-addons/addon-mqtt\" \\\n      org.label-schema.vendor=\"Community Hass.io Add-ons\"\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"ARG BUILD_FROM=hassioaddons/base:3.1.0\n#  hadolint ignore=DL3006\nFROM ${BUILD_FROM}\n#  Set shell\nSHELL [\"/bin/bash\", \"-o\", \"pipefail\", \"-c\"]\n#  Sets working directory\nWORKDIR /app\n#  Versions\nENV HIVEMQ=\"46338a633eb26bc9f6d8d8ff82f8f2aedc004a57\" \\\n    LIBWEBSOCKETS=\"2.4.2\" \\\n    MOSQUITTO=\"1.6.2\"\n#  Setup base\n#  hadolint ignore=DL3003\nRUN apk add --no-cache --virtual .build-dependencies git=2.20.1-r0 cmake=3.13.0-r0 build-base=0.5-r1 zlib-dev=1.2.11-r1 openssl-dev=1.1.1b-r1 \\\n && apk add --no-cache nginx=1.14.2-r1 lua-resty-http=0.13-r0 nginx-mod-http-lua=1.14.2-r1 \\\n && git clone --depth=1 https://github.com/hivemq/hivemq-mqtt-web-client.git /app \\\n && git checkout \"${HIVEMQ}\" \\\n && git clone --branch \"v${LIBWEBSOCKETS}\" --depth=1 https://github.com/warmcat/libwebsockets.git /tmp/libwebsockets \\\n && mkdir -p /tmp/libwebsockets/build \\\n && cd /tmp/libwebsockets/build \\\n && cmake .. -DCMAKE_BUILD_TYPE=MinSizeRel -DCMAKE_INSTALL_PREFIX=/usr -DLWS_IPV6=OFF -DLWS_WITHOUT_BUILTIN_GETIFADDRS=ON -DLWS_WITHOUT_CLIENT=ON -DLWS_WITHOUT_EXTENSIONS=ON -DLWS_WITHOUT_TESTAPPS=ON -DLWS_WITH_SHARED=OFF -DLWS_WITH_ZIP_FOPS=OFF -DLWS_WITH_ZLIB=OFF \\\n && make \\\n && make install \\\n && git clone --branch \"v${MOSQUITTO}\" --depth=1 https://github.com/eclipse/mosquitto.git /tmp/mosquitto \\\n && cd /tmp/mosquitto \\\n && make WITH_ADNS=no WITH_DOCS=no WITH_UUID=no WITH_MEMORY_TRACKING=no WITH_SHARED_LIBRARIES=no WITH_SRV=no WITH_STRIP=yes WITH_TLS_PSK=no WITH_WEBSOCKETS=yes prefix=/usr binary \\\n && make WITH_DOCS=no install binary \\\n && addgroup -S mosquitto \\\n && adduser -S -D -H -h /var/empty -s /sbin/nologin -G mosquitto -g mosquitto mosquitto \\\n && apk del --no-cache --purge .build-dependencies \\\n && rm -fr /etc/nginx /opt/mosquitto.conf /opt/acl /tmp/*\n#  Copy root filesystem\nCOPY rootfs /\n#  Build arguments\nARG BUILD_ARCH\nARG BUILD_DATE\nARG BUILD_REF\nARG BUILD_VERSION\n#  Labels\nLABEL io.hass.name=\"MQTT Server & Web client\" \\\n      io.hass.description=\"Mosquitto MQTT Server bundled with Hivemq's web client.\" \\\n      io.hass.arch=\"${BUILD_ARCH}\" \\\n      io.hass.type=\"addon\" \\\n      io.hass.version=\"${BUILD_VERSION}\" \\\n      maintainer=\"Joakim Sørensen @ludeeus <ludeeus@gmail.com>\" \\\n      org.label-schema.description=\"Mosquitto MQTT Server bundled with Hivemq's web client.\" \\\n      org.label-schema.build-date=\"${BUILD_DATE}\" \\\n      org.label-schema.name=\"MQTT Server & Web client\" \\\n      org.label-schema.schema-version=\"1.0\" \\\n      org.label-schema.url=\"https://community.home-assistant.io/t/community-hass-io-add-ons-mqtt-server-web-client/70376\" \\\n      org.label-schema.usage=\"https://github.com/hassio-addons/addon-mqtt/tree/master/README.md\" \\\n      org.label-schema.vcs-ref=\"${BUILD_REF}\" \\\n      org.label-schema.vcs-url=\"https://github.com/hassio-addons/addon-mqtt\" \\\n      org.label-schema.vendor=\"Community Hass.io Add-ons\"\n","injectedSmells":[],"originalDockerfileHash":"085965ea003c0e1d34f2bd3d40eaff46","successfullyInjectedSmells":[],"originalDockerfileUglified":"ARG BUILD_FROM=hassioaddons/base:3.1.0\n#   hadolint ignore=DL3006\nFROM ${BUILD_FROM}\n#   Set shell\nSHELL [\"/bin/bash\", \"-o\", \"pipefail\", \"-c\"]\n#   Sets working directory\nWORKDIR /app\n#   Versions\nENV HIVEMQ=\"46338a633eb26bc9f6d8d8ff82f8f2aedc004a57\" \\\n    LIBWEBSOCKETS=\"2.4.2\" \\\n    MOSQUITTO=\"1.6.2\"\n#   Setup base\n#   hadolint ignore=DL3003\nRUN apk add --no-cache --virtual .build-dependencies git=2.20.1-r0 cmake=3.13.0-r0 build-base=0.5-r1 zlib-dev=1.2.11-r1 openssl-dev=1.1.1b-r1 \\\n && apk add --no-cache nginx=1.14.2-r1 lua-resty-http=0.13-r0 nginx-mod-http-lua=1.14.2-r1 \\\n && git clone --depth=1 https://github.com/hivemq/hivemq-mqtt-web-client.git /app \\\n && git checkout \"${HIVEMQ}\" \\\n && git clone --branch \"v${LIBWEBSOCKETS}\" --depth=1 https://github.com/warmcat/libwebsockets.git /tmp/libwebsockets \\\n && mkdir -p /tmp/libwebsockets/build \\\n && cd /tmp/libwebsockets/build \\\n && cmake .. -DCMAKE_BUILD_TYPE=MinSizeRel -DCMAKE_INSTALL_PREFIX=/usr -DLWS_IPV6=OFF -DLWS_WITHOUT_BUILTIN_GETIFADDRS=ON -DLWS_WITHOUT_CLIENT=ON -DLWS_WITHOUT_EXTENSIONS=ON -DLWS_WITHOUT_TESTAPPS=ON -DLWS_WITH_SHARED=OFF -DLWS_WITH_ZIP_FOPS=OFF -DLWS_WITH_ZLIB=OFF \\\n && make \\\n && make install \\\n && git clone --branch \"v${MOSQUITTO}\" --depth=1 https://github.com/eclipse/mosquitto.git /tmp/mosquitto \\\n && cd /tmp/mosquitto \\\n && make WITH_ADNS=no WITH_DOCS=no WITH_UUID=no WITH_MEMORY_TRACKING=no WITH_SHARED_LIBRARIES=no WITH_SRV=no WITH_STRIP=yes WITH_TLS_PSK=no WITH_WEBSOCKETS=yes prefix=/usr binary \\\n && make WITH_DOCS=no install binary \\\n && addgroup -S mosquitto \\\n && adduser -S -D -H -h /var/empty -s /sbin/nologin -G mosquitto -g mosquitto mosquitto \\\n && apk del --no-cache --purge .build-dependencies \\\n && rm -fr /etc/nginx /opt/mosquitto.conf /opt/acl /tmp/*\n#   Copy root filesystem\nCOPY rootfs /\n#   Build arguments\nARG BUILD_ARCH\nARG BUILD_DATE\nARG BUILD_REF\nARG BUILD_VERSION\n#   Labels\nLABEL io.hass.name=\"MQTT Server & Web client\" \\\n      io.hass.description=\"Mosquitto MQTT Server bundled with Hivemq's web client.\" \\\n      io.hass.arch=\"${BUILD_ARCH}\" \\\n      io.hass.type=\"addon\" \\\n      io.hass.version=\"${BUILD_VERSION}\" \\\n      maintainer=\"Joakim Sørensen @ludeeus <ludeeus@gmail.com>\" \\\n      org.label-schema.description=\"Mosquitto MQTT Server bundled with Hivemq's web client.\" \\\n      org.label-schema.build-date=\"${BUILD_DATE}\" \\\n      org.label-schema.name=\"MQTT Server & Web client\" \\\n      org.label-schema.schema-version=\"1.0\" \\\n      org.label-schema.url=\"https://community.home-assistant.io/t/community-hass-io-add-ons-mqtt-server-web-client/70376\" \\\n      org.label-schema.usage=\"https://github.com/hassio-addons/addon-mqtt/tree/master/README.md\" \\\n      org.label-schema.vcs-ref=\"${BUILD_REF}\" \\\n      org.label-schema.vcs-url=\"https://github.com/hassio-addons/addon-mqtt\" \\\n      org.label-schema.vendor=\"Community Hass.io Add-ons\"\n","originalDockerfileUglifiedHash":"5f02cf66fa39f6f3462b0e9770c58eda","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/af50bc47ad28d55c9187dac53906dd0cf5fcfa64.dockerfile"}