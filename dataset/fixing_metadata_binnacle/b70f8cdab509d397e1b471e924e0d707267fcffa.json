{"seed":2225143078,"processedDockerfileHash":"7e11a258881cec9eb185ae59d6d79682","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["have-a-healthcheck","have-a-user"],"processedDockerfile":"#   Dockerfile for PetIBM-0.4.1\nFROM nvidia/cuda:8.0-devel-ubuntu16.04\nMAINTAINER Olivier Mesnard <mesnardo@gwu.edu>\n#   Install base system.\nCOPY ssh_config /root/.ssh/config\nRUN apt-get update \\\n && apt-get install --no-install-recommends ca-certificates build-essential autotools-dev gfortran cmake git pkg-config wget curl unzip -y \\\n && apt-get install --no-install-recommends libopenmpi-dev libopenmpi1.10 openmpi-bin openmpi-common openmpi-doc -y \\\n && apt-get install --no-install-recommends flex bison python-dev -y \\\n && apt-get install --no-install-recommends libibverbs1 ibverbs-utils librdmacm1 rdmacm-utils ibutils ibacm libibcm1 libibmad5 libibumad3 opensm libopensm5a srptools perftest infiniband-diags ibsim-utils libmthca1 libmlx4-1 libmlx5-1 mstflint libdapl2 dapl2-utils -y \\\n && apt-get install --no-install-recommends openssh-server openssh-client -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && mkdir /var/run/sshd \\\n && ssh-keygen -A \\\n && sed -i 's/PermitRootLogin without-password/PermitRootLogin yes/' /etc/ssh/sshd_config \\\n && sed 's@session\\s*required\\s*pam_loginuid.so@session optional pam_loginuid.so@g' -i /etc/pam.d/sshd \\\n && ssh-keygen -f /root/.ssh/id_rsa -t rsa -N '' \\\n && chmod 600 /root/.ssh/config \\\n && chmod 700 /root/.ssh \\\n && cp /root/.ssh/id_rsa.pub /root/.ssh/authorized_keys\n#   Build PETSc-3.10.2 in optimized mode.\nRUN VERSION=3.10.2 \\\n && TARBALL=petsc-lite-${VERSION}.tar.gz \\\n && wget http://ftp.mcs.anl.gov/pub/petsc/release-snapshots/${TARBALL} -P /tmp \\\n && PETSC_DIR=/opt/petsc/${VERSION} \\\n && PETSC_ARCH=linux-gnu-openmpi-dbg \\\n && mkdir -p ${PETSC_DIR} \\\n && tar -xzf /tmp/${TARBALL} -C ${PETSC_DIR} --strip-components=1 \\\n && cd ${PETSC_DIR} \\\n && ./configure --PETSC_DIR=${PETSC_DIR} --PETSC_ARCH=${PETSC_ARCH} --with-cc=mpicc --with-cxx=mpicxx --with-fc=mpif90 --COPTFLAGS=-O0 --CXXFLAGS=-O0 --FOPTFLAGS=-O0 --with-debugging=1 --download-hdf5 --download-fblaslapack --download-hypre --download-ptscotch --download-metis --download-parmetis --download-superlu_dist \\\n && make PETSC_DIR=${PETSC_DIR} PETSC_ARCH=${PETSC_ARCH} all \\\n && rm -f /tmp/${TARBALL}\n#   Build AmgX-2.0.\nRUN VERSION=2.0 \\\n && COMMIT=3049527e0c396424df4582e837f9dd89a20f50df \\\n && TARBALL=master.tar.gz \\\n && wget https://github.com/NVIDIA/AMGX/archive/${TARBALL} -P /tmp \\\n && SRCDIR=/opt/amgx/${VERSION} \\\n && URL=https://github.com/NVIDIA/AMGX \\\n && git clone ${URL} ${SRCDIR} \\\n && cd ${SRCDIR} \\\n && git checkout ${COMMIT} \\\n && BUILDDIR=${SRCDIR}/build \\\n && mkdir -p ${BUILDDIR} \\\n && cd ${BUILDDIR} \\\n && cmake ${SRCDIR} -DCMAKE_BUILD_TYPE=\"Release\" -DCMAKE_INSTALL_PREFIX=\"/usr/local\" -DCMAKE_C_COMPILER=mpicc -DCMAKE_C_FLAGS_PROFILE=\"-O3 -DNDEBUG\" -DCMAKE_CXX_COMPILER=mpicxx -DCMAKE_CXX_FLAGS_PROFILE=\"-O3 -DNDEBUG\" -DMPI_CXX_COMPILER=mpicxx -DMPI_CXX_COMPILE_FLAGS=\"-O3\" -DMPI_C_COMPILER=mpicc -DMPI_C_COMPILE_FLAGS=\"-O3\" -DCUDA_ARCH=\"35 37\" -DCUDA_HOST_COMPILER=/usr/bin/mpicc \\\n && make -j\"$( nproc ;)\" all \\\n && make install \\\n && ldconfig ${SRCDIR}/lib\nENV PETSC_DIR=\"/opt/petsc/3.10.2\"\nENV PETSC_ARCH=\"linux-gnu-openmpi-dbg\"\n#   Build and install PetIBM-0.4.1.\nRUN VERSION=0.4.1 \\\n && TARBALL=v${VERSION}.tar.gz \\\n && wget https://github.com/barbagroup/PetIBM/archive/${TARBALL} -P /tmp \\\n && SRCDIR=/opt/petibm/${VERSION} \\\n && BUILDDIR=${SRCDIR}/build \\\n && mkdir -p ${SRCDIR} ${BUILDDIR} \\\n && tar -xzf /tmp/${TARBALL} -C ${SRCDIR} --strip-components=1 \\\n && cd ${BUILDDIR} \\\n && ${SRCDIR}/configure --prefix=/usr/local CXX=mpicxx CXXFLAGS=\"-g -O0 -std=c++14\" --enable-static=no --with-petsc-dir=${PETSC_DIR} --with-petsc-arch=${PETSC_ARCH} --with-cuda-dir=/usr/local/cuda-8.0 --with-amgx-dir=/usr/local --enable-amgxwrapper --enable-yamlcpp --enable-gtest \\\n && make -j\"$( nproc ;)\" all \\\n && make check \\\n && make install \\\n && ldconfig /usr/local/lib \\\n && rm -f /tmp/${TARBALL}\nEXPOSE 23/tcp\nCMD [\"/usr/sbin/sshd\", \"-D\", \"-p\", \"23\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  Dockerfile for PetIBM-0.4.1\nFROM nvidia/cuda:8.0-devel-ubuntu16.04\nMAINTAINER Olivier Mesnard <mesnardo@gwu.edu>\n#  Install base system.\nCOPY ssh_config /root/.ssh/config\nRUN apt-get update \\\n && apt-get install --no-install-recommends ca-certificates build-essential autotools-dev gfortran cmake git pkg-config wget curl unzip -y \\\n && apt-get install --no-install-recommends libopenmpi-dev libopenmpi1.10 openmpi-bin openmpi-common openmpi-doc -y \\\n && apt-get install --no-install-recommends flex bison python-dev -y \\\n && apt-get install --no-install-recommends libibverbs1 ibverbs-utils librdmacm1 rdmacm-utils ibutils ibacm libibcm1 libibmad5 libibumad3 opensm libopensm5a srptools perftest infiniband-diags ibsim-utils libmthca1 libmlx4-1 libmlx5-1 mstflint libdapl2 dapl2-utils -y \\\n && apt-get install --no-install-recommends openssh-server openssh-client -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && mkdir /var/run/sshd \\\n && ssh-keygen -A \\\n && sed -i 's/PermitRootLogin without-password/PermitRootLogin yes/' /etc/ssh/sshd_config \\\n && sed 's@session\\s*required\\s*pam_loginuid.so@session optional pam_loginuid.so@g' -i /etc/pam.d/sshd \\\n && ssh-keygen -f /root/.ssh/id_rsa -t rsa -N '' \\\n && chmod 600 /root/.ssh/config \\\n && chmod 700 /root/.ssh \\\n && cp /root/.ssh/id_rsa.pub /root/.ssh/authorized_keys\n#  Build PETSc-3.10.2 in optimized mode.\nRUN VERSION=3.10.2 \\\n && TARBALL=petsc-lite-${VERSION}.tar.gz \\\n && wget http://ftp.mcs.anl.gov/pub/petsc/release-snapshots/${TARBALL} -P /tmp \\\n && PETSC_DIR=/opt/petsc/${VERSION} \\\n && PETSC_ARCH=linux-gnu-openmpi-dbg \\\n && mkdir -p ${PETSC_DIR} \\\n && tar -xzf /tmp/${TARBALL} -C ${PETSC_DIR} --strip-components=1 \\\n && cd ${PETSC_DIR} \\\n && ./configure --PETSC_DIR=${PETSC_DIR} --PETSC_ARCH=${PETSC_ARCH} --with-cc=mpicc --with-cxx=mpicxx --with-fc=mpif90 --COPTFLAGS=-O0 --CXXFLAGS=-O0 --FOPTFLAGS=-O0 --with-debugging=1 --download-hdf5 --download-fblaslapack --download-hypre --download-ptscotch --download-metis --download-parmetis --download-superlu_dist \\\n && make PETSC_DIR=${PETSC_DIR} PETSC_ARCH=${PETSC_ARCH} all \\\n && rm -f /tmp/${TARBALL}\n#  Build AmgX-2.0.\nRUN VERSION=2.0 \\\n && COMMIT=3049527e0c396424df4582e837f9dd89a20f50df \\\n && TARBALL=master.tar.gz \\\n && wget https://github.com/NVIDIA/AMGX/archive/${TARBALL} -P /tmp \\\n && SRCDIR=/opt/amgx/${VERSION} \\\n && URL=https://github.com/NVIDIA/AMGX \\\n && git clone ${URL} ${SRCDIR} \\\n && cd ${SRCDIR} \\\n && git checkout ${COMMIT} \\\n && BUILDDIR=${SRCDIR}/build \\\n && mkdir -p ${BUILDDIR} \\\n && cd ${BUILDDIR} \\\n && cmake ${SRCDIR} -DCMAKE_BUILD_TYPE=\"Release\" -DCMAKE_INSTALL_PREFIX=\"/usr/local\" -DCMAKE_C_COMPILER=mpicc -DCMAKE_C_FLAGS_PROFILE=\"-O3 -DNDEBUG\" -DCMAKE_CXX_COMPILER=mpicxx -DCMAKE_CXX_FLAGS_PROFILE=\"-O3 -DNDEBUG\" -DMPI_CXX_COMPILER=mpicxx -DMPI_CXX_COMPILE_FLAGS=\"-O3\" -DMPI_C_COMPILER=mpicc -DMPI_C_COMPILE_FLAGS=\"-O3\" -DCUDA_ARCH=\"35 37\" -DCUDA_HOST_COMPILER=/usr/bin/mpicc \\\n && make -j\"$( nproc ;)\" all \\\n && make install \\\n && ldconfig ${SRCDIR}/lib\nENV PETSC_DIR=\"/opt/petsc/3.10.2\"\nENV PETSC_ARCH=\"linux-gnu-openmpi-dbg\"\n#  Build and install PetIBM-0.4.1.\nRUN VERSION=0.4.1 \\\n && TARBALL=v${VERSION}.tar.gz \\\n && wget https://github.com/barbagroup/PetIBM/archive/${TARBALL} -P /tmp \\\n && SRCDIR=/opt/petibm/${VERSION} \\\n && BUILDDIR=${SRCDIR}/build \\\n && mkdir -p ${SRCDIR} ${BUILDDIR} \\\n && tar -xzf /tmp/${TARBALL} -C ${SRCDIR} --strip-components=1 \\\n && cd ${BUILDDIR} \\\n && ${SRCDIR}/configure --prefix=/usr/local CXX=mpicxx CXXFLAGS=\"-g -O0 -std=c++14\" --enable-static=no --with-petsc-dir=${PETSC_DIR} --with-petsc-arch=${PETSC_ARCH} --with-cuda-dir=/usr/local/cuda-8.0 --with-amgx-dir=/usr/local --enable-amgxwrapper --enable-yamlcpp --enable-gtest \\\n && make -j\"$( nproc ;)\" all \\\n && make check \\\n && make install \\\n && ldconfig /usr/local/lib \\\n && rm -f /tmp/${TARBALL}\nEXPOSE 23/tcp\nCMD [\"/usr/sbin/sshd\", \"-D\", \"-p\", \"23\"]\n","injectedSmells":[],"originalDockerfileHash":"fe510fdcf25d5734eef04c1a84a0fd26","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   Dockerfile for PetIBM-0.4.1\nFROM nvidia/cuda:8.0-devel-ubuntu16.04\nMAINTAINER Olivier Mesnard <mesnardo@gwu.edu>\n#   Install base system.\nCOPY ssh_config /root/.ssh/config\nRUN apt-get update \\\n && apt-get install --no-install-recommends ca-certificates build-essential autotools-dev gfortran cmake git pkg-config wget curl unzip -y \\\n && apt-get install --no-install-recommends libopenmpi-dev libopenmpi1.10 openmpi-bin openmpi-common openmpi-doc -y \\\n && apt-get install --no-install-recommends flex bison python-dev -y \\\n && apt-get install --no-install-recommends libibverbs1 ibverbs-utils librdmacm1 rdmacm-utils ibutils ibacm libibcm1 libibmad5 libibumad3 opensm libopensm5a srptools perftest infiniband-diags ibsim-utils libmthca1 libmlx4-1 libmlx5-1 mstflint libdapl2 dapl2-utils -y \\\n && apt-get install --no-install-recommends openssh-server openssh-client -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && mkdir /var/run/sshd \\\n && ssh-keygen -A \\\n && sed -i 's/PermitRootLogin without-password/PermitRootLogin yes/' /etc/ssh/sshd_config \\\n && sed 's@session\\s*required\\s*pam_loginuid.so@session optional pam_loginuid.so@g' -i /etc/pam.d/sshd \\\n && ssh-keygen -f /root/.ssh/id_rsa -t rsa -N '' \\\n && chmod 600 /root/.ssh/config \\\n && chmod 700 /root/.ssh \\\n && cp /root/.ssh/id_rsa.pub /root/.ssh/authorized_keys\n#   Build PETSc-3.10.2 in optimized mode.\nRUN VERSION=3.10.2 \\\n && TARBALL=petsc-lite-${VERSION}.tar.gz \\\n && wget http://ftp.mcs.anl.gov/pub/petsc/release-snapshots/${TARBALL} -P /tmp \\\n && PETSC_DIR=/opt/petsc/${VERSION} \\\n && PETSC_ARCH=linux-gnu-openmpi-dbg \\\n && mkdir -p ${PETSC_DIR} \\\n && tar -xzf /tmp/${TARBALL} -C ${PETSC_DIR} --strip-components=1 \\\n && cd ${PETSC_DIR} \\\n && ./configure --PETSC_DIR=${PETSC_DIR} --PETSC_ARCH=${PETSC_ARCH} --with-cc=mpicc --with-cxx=mpicxx --with-fc=mpif90 --COPTFLAGS=-O0 --CXXFLAGS=-O0 --FOPTFLAGS=-O0 --with-debugging=1 --download-hdf5 --download-fblaslapack --download-hypre --download-ptscotch --download-metis --download-parmetis --download-superlu_dist \\\n && make PETSC_DIR=${PETSC_DIR} PETSC_ARCH=${PETSC_ARCH} all \\\n && rm -f /tmp/${TARBALL}\n#   Build AmgX-2.0.\nRUN VERSION=2.0 \\\n && COMMIT=3049527e0c396424df4582e837f9dd89a20f50df \\\n && TARBALL=master.tar.gz \\\n && wget https://github.com/NVIDIA/AMGX/archive/${TARBALL} -P /tmp \\\n && SRCDIR=/opt/amgx/${VERSION} \\\n && URL=https://github.com/NVIDIA/AMGX \\\n && git clone ${URL} ${SRCDIR} \\\n && cd ${SRCDIR} \\\n && git checkout ${COMMIT} \\\n && BUILDDIR=${SRCDIR}/build \\\n && mkdir -p ${BUILDDIR} \\\n && cd ${BUILDDIR} \\\n && cmake ${SRCDIR} -DCMAKE_BUILD_TYPE=\"Release\" -DCMAKE_INSTALL_PREFIX=\"/usr/local\" -DCMAKE_C_COMPILER=mpicc -DCMAKE_C_FLAGS_PROFILE=\"-O3 -DNDEBUG\" -DCMAKE_CXX_COMPILER=mpicxx -DCMAKE_CXX_FLAGS_PROFILE=\"-O3 -DNDEBUG\" -DMPI_CXX_COMPILER=mpicxx -DMPI_CXX_COMPILE_FLAGS=\"-O3\" -DMPI_C_COMPILER=mpicc -DMPI_C_COMPILE_FLAGS=\"-O3\" -DCUDA_ARCH=\"35 37\" -DCUDA_HOST_COMPILER=/usr/bin/mpicc \\\n && make -j\"$( nproc ;)\" all \\\n && make install \\\n && ldconfig ${SRCDIR}/lib\nENV PETSC_DIR=\"/opt/petsc/3.10.2\"\nENV PETSC_ARCH=\"linux-gnu-openmpi-dbg\"\n#   Build and install PetIBM-0.4.1.\nRUN VERSION=0.4.1 \\\n && TARBALL=v${VERSION}.tar.gz \\\n && wget https://github.com/barbagroup/PetIBM/archive/${TARBALL} -P /tmp \\\n && SRCDIR=/opt/petibm/${VERSION} \\\n && BUILDDIR=${SRCDIR}/build \\\n && mkdir -p ${SRCDIR} ${BUILDDIR} \\\n && tar -xzf /tmp/${TARBALL} -C ${SRCDIR} --strip-components=1 \\\n && cd ${BUILDDIR} \\\n && ${SRCDIR}/configure --prefix=/usr/local CXX=mpicxx CXXFLAGS=\"-g -O0 -std=c++14\" --enable-static=no --with-petsc-dir=${PETSC_DIR} --with-petsc-arch=${PETSC_ARCH} --with-cuda-dir=/usr/local/cuda-8.0 --with-amgx-dir=/usr/local --enable-amgxwrapper --enable-yamlcpp --enable-gtest \\\n && make -j\"$( nproc ;)\" all \\\n && make check \\\n && make install \\\n && ldconfig /usr/local/lib \\\n && rm -f /tmp/${TARBALL}\nEXPOSE 23/tcp\nCMD [\"/usr/sbin/sshd\", \"-D\", \"-p\", \"23\"]\n","originalDockerfileUglifiedHash":"d80703798f53068d565549aac0c9a895","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/b70f8cdab509d397e1b471e924e0d707267fcffa.dockerfile"}