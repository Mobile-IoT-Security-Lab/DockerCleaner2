{"seed":368374015,"processedDockerfileHash":"628f8b680c5af1adcea87057cb8c8ee7","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","have-a-healthcheck","have-a-user"],"processedDockerfile":"#\n#   Builder\n#\nFROM abiosoft/caddy:builder AS builder\nARG version=\"1.0.0\"\nARG plugins=\"git,cors,realip,expires,cache\"\n#   process wrapper\nRUN go get -v github.com/abiosoft/parent\nRUN VERSION=${version} PLUGINS=${plugins} ENABLE_TELEMETRY=false /bin/sh /usr/bin/builder.sh\n#\n#   Final stage\n#\nFROM alpine:3.10\nLABEL maintainer=\"\\\"Abiola Ibrahim <abiola89@gmail.com>\\\"\"\nARG version=\"1.0.0\"\nLABEL caddy_version=\"$version\"\n#   PHP www-user UID and GID\nARG PUID=\"1000\"\nARG PGID=\"1000\"\n#   Let's Encrypt Agreement\nENV ACME_AGREE=\"false\"\n#   Telemetry Stats\nENV ENABLE_TELEMETRY=\"false\"\nRUN apk add openssh-client git tar php7-fpm curl --no-cache\n#   essential php libs\nRUN apk add php7-bcmath php7-ctype php7-curl php7-dom php7-fileinfo php7-gd php7-iconv php7-json php7-mbstring php7-mysqli php7-opcache php7-openssl php7-pdo php7-pdo_mysql php7-pdo_sqlite php7-pgsql php7-phar php7-session php7-simplexml php7-sqlite3 php7-tokenizer php7-xml php7-xmlreader php7-xmlwriter php7-zip --no-cache\n#   symblink php7 to php\nRUN ln -sf /usr/bin/php7 /usr/bin/php\n#   symlink php-fpm7 to php-fpm\nRUN ln -sf /usr/bin/php-fpm7 /usr/bin/php-fpm\n#   add a php www-user instead of nobody\nRUN addgroup -g ${PGID} www-user \\\n && adduser -D -H -u ${PUID} -G www-user www-user \\\n && sed -i \"s|^user = .*|user = www-user|g\" /etc/php7/php-fpm.d/www.conf \\\n && sed -i \"s|^group = .*|group = www-user|g\" /etc/php7/php-fpm.d/www.conf\n#   composer\nRUN curl --silent --show-error --fail --location --header \"Accept: application/tar+gzip, application/x-gzip, application/octet-stream\" \"https://getcomposer.org/installer\" | php -- --install-dir=/usr/bin --filename=composer\n#   allow environment variable access.\nRUN echo \"clear_env = no\" >> /etc/php7/php-fpm.conf\n#   install caddy\nCOPY --from=builder /install/caddy /usr/bin/caddy\n#   validate install\nRUN /usr/bin/caddy -version\nRUN /usr/bin/caddy -plugins\nEXPOSE 80/tcp 443/tcp 2015/tcp\nVOLUME /root/.caddy /srv\nWORKDIR /srv\nCOPY Caddyfile /etc/Caddyfile\nCOPY index.php /srv/index.php\n#   install process wrapper\nCOPY --from=builder /go/bin/parent /bin/parent\nENTRYPOINT [\"/bin/parent\", \"caddy\"]\nCMD [\"--conf\", \"/etc/Caddyfile\", \"--log\", \"stdout\", \"--agree=$ACME_AGREE\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#\n#  Builder\n#\nFROM abiosoft/caddy:builder AS builder\nARG version=\"1.0.0\"\nARG plugins=\"git,cors,realip,expires,cache\"\n#  process wrapper\nRUN go get -v github.com/abiosoft/parent\nRUN VERSION=${version} PLUGINS=${plugins} ENABLE_TELEMETRY=false /bin/sh /usr/bin/builder.sh\n#\n#  Final stage\n#\nFROM alpine:3.10\nLABEL maintainer=\"\\\"Abiola Ibrahim <abiola89@gmail.com>\\\"\"\nARG version=\"1.0.0\"\nLABEL caddy_version=\"$version\"\n#  PHP www-user UID and GID\nARG PUID=\"1000\"\nARG PGID=\"1000\"\n#  Let's Encrypt Agreement\nENV ACME_AGREE=\"false\"\n#  Telemetry Stats\nENV ENABLE_TELEMETRY=\"false\"\nRUN apk add --no-cache openssh-client git tar php7-fpm curl\n#  essential php libs\nRUN apk add --no-cache php7-bcmath php7-ctype php7-curl php7-dom php7-fileinfo php7-gd php7-iconv php7-json php7-mbstring php7-mysqli php7-opcache php7-openssl php7-pdo php7-pdo_mysql php7-pdo_sqlite php7-pgsql php7-phar php7-session php7-simplexml php7-sqlite3 php7-tokenizer php7-xml php7-xmlreader php7-xmlwriter php7-zip\n#  symblink php7 to php\nRUN ln -sf /usr/bin/php7 /usr/bin/php\n#  symlink php-fpm7 to php-fpm\nRUN ln -sf /usr/bin/php-fpm7 /usr/bin/php-fpm\n#  add a php www-user instead of nobody\nRUN addgroup -g ${PGID} www-user \\\n && adduser -D -H -u ${PUID} -G www-user www-user \\\n && sed -i \"s|^user = .*|user = www-user|g\" /etc/php7/php-fpm.d/www.conf \\\n && sed -i \"s|^group = .*|group = www-user|g\" /etc/php7/php-fpm.d/www.conf\n#  composer\nRUN curl --silent --show-error --fail --location --header \"Accept: application/tar+gzip, application/x-gzip, application/octet-stream\" \"https://getcomposer.org/installer\" | php -- --install-dir=/usr/bin --filename=composer\n#  allow environment variable access.\nRUN echo \"clear_env = no\" >> /etc/php7/php-fpm.conf\n#  install caddy\nCOPY --from=builder /install/caddy /usr/bin/caddy\n#  validate install\nRUN /usr/bin/caddy -version\nRUN /usr/bin/caddy -plugins\nEXPOSE 80/tcp 443/tcp 2015/tcp\nVOLUME /root/.caddy /srv\nWORKDIR /srv\nCOPY Caddyfile /etc/Caddyfile\nCOPY index.php /srv/index.php\n#  install process wrapper\nCOPY --from=builder /go/bin/parent /bin/parent\nENTRYPOINT [\"/bin/parent\", \"caddy\"]\nCMD [\"--conf\", \"/etc/Caddyfile\", \"--log\", \"stdout\", \"--agree=$ACME_AGREE\"]\n","injectedSmells":[],"originalDockerfileHash":"e4bd274fa112d10a7ecc709b15f4f0ff","successfullyInjectedSmells":[],"originalDockerfileUglified":"#\n#   Builder\n#\nFROM abiosoft/caddy:builder AS builder\nARG version=\"1.0.0\"\nARG plugins=\"git,cors,realip,expires,cache\"\n#   process wrapper\nRUN go get -v github.com/abiosoft/parent\nRUN VERSION=${version} PLUGINS=${plugins} ENABLE_TELEMETRY=false /bin/sh /usr/bin/builder.sh\n#\n#   Final stage\n#\nFROM alpine:3.10\nLABEL maintainer=\"\\\"Abiola Ibrahim <abiola89@gmail.com>\\\"\"\nARG version=\"1.0.0\"\nLABEL caddy_version=\"$version\"\n#   PHP www-user UID and GID\nARG PUID=\"1000\"\nARG PGID=\"1000\"\n#   Let's Encrypt Agreement\nENV ACME_AGREE=\"false\"\n#   Telemetry Stats\nENV ENABLE_TELEMETRY=\"false\"\nRUN apk add --no-cache openssh-client git tar php7-fpm curl\n#   essential php libs\nRUN apk add --no-cache php7-bcmath php7-ctype php7-curl php7-dom php7-fileinfo php7-gd php7-iconv php7-json php7-mbstring php7-mysqli php7-opcache php7-openssl php7-pdo php7-pdo_mysql php7-pdo_sqlite php7-pgsql php7-phar php7-session php7-simplexml php7-sqlite3 php7-tokenizer php7-xml php7-xmlreader php7-xmlwriter php7-zip\n#   symblink php7 to php\nRUN ln -sf /usr/bin/php7 /usr/bin/php\n#   symlink php-fpm7 to php-fpm\nRUN ln -sf /usr/bin/php-fpm7 /usr/bin/php-fpm\n#   add a php www-user instead of nobody\nRUN addgroup -g ${PGID} www-user \\\n && adduser -D -H -u ${PUID} -G www-user www-user \\\n && sed -i \"s|^user = .*|user = www-user|g\" /etc/php7/php-fpm.d/www.conf \\\n && sed -i \"s|^group = .*|group = www-user|g\" /etc/php7/php-fpm.d/www.conf\n#   composer\nRUN curl --silent --show-error --fail --location --header \"Accept: application/tar+gzip, application/x-gzip, application/octet-stream\" \"https://getcomposer.org/installer\" | php -- --install-dir=/usr/bin --filename=composer\n#   allow environment variable access.\nRUN echo \"clear_env = no\" >> /etc/php7/php-fpm.conf\n#   install caddy\nCOPY --from=builder /install/caddy /usr/bin/caddy\n#   validate install\nRUN /usr/bin/caddy -version\nRUN /usr/bin/caddy -plugins\nEXPOSE 80/tcp 443/tcp 2015/tcp\nVOLUME /root/.caddy /srv\nWORKDIR /srv\nCOPY Caddyfile /etc/Caddyfile\nCOPY index.php /srv/index.php\n#   install process wrapper\nCOPY --from=builder /go/bin/parent /bin/parent\nENTRYPOINT [\"/bin/parent\", \"caddy\"]\nCMD [\"--conf\", \"/etc/Caddyfile\", \"--log\", \"stdout\", \"--agree=$ACME_AGREE\"]\n","originalDockerfileUglifiedHash":"bbb0cd8d5a623bcdb36a59464b6e9db3","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/10d697d275aad8f5c4b6b99481ed5ce46d535efc.dockerfile"}