{"seed":2205429588,"processedDockerfileHash":"962ee64c98721937429ea0a58f37f870","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM alpine:3.2\nMAINTAINER Jacob Blain Christen <mailto:dweomer5@gmail.com, https://github.com/dweomer, https://twitter.com/dweomer>\nENV OPENLDAP_VERSION=\"2.4.40\"\nCOPY *.template /srv/openldap/\nCOPY openldap.sh /srv/\nVOLUME [\"/etc/openldap/slapd.d\", \"/var/lib/openldap\"]\nRUN set -x \\\n && chmod -v +x /srv/openldap.sh \\\n && mkdir -vp /etc/openldap/sasl2 /srv/openldap.d /tmp/openldap \\\n && export BUILD_DEPS=\" autoconf automake curl cyrus-sasl-dev db-dev g++ gcc groff gzip libtool make mosquitto-dev openldap-back-bdb openldap-back-ldap openldap-back-meta openldap-back-monitor openldap-back-sql openssl-dev tar unixodbc-dev util-linux-dev \" \\\n && apk add gettext=0.19.4-r1 libintl=0.19.4-r1 openldap=2.4.40-r5 openldap-back-hdb=2.4.40-r5 openldap-clients=2.4.40-r5 openldap-mqtt=2.4.40-r5 unixodbc=2.3.2-r1 ${BUILD_DEPS} --update \\\n && cp -v /usr/bin/envsubst /usr/local/bin/ \\\n && curl -fL ftp://ftp.openldap.org/pub/OpenLDAP/openldap-release/openldap-${OPENLDAP_VERSION}.tgz -o /tmp/openldap.tgz \\\n && curl -fL http://git.alpinelinux.org/cgit/aports/plain/main/openldap/0001-dbd-enabled-by-default.patch?h=3.2-stable -o /tmp/0001-dbd-enabled-by-default.patch \\\n && curl -fL http://git.alpinelinux.org/cgit/aports/plain/main/openldap/CVE-2015-1545.patch?h=3.2-stable -o /tmp/CVE-2015-1545.patch \\\n && curl -fL http://git.alpinelinux.org/cgit/aports/plain/main/openldap/CVE-2015-1546.patch?h=3.2-stable -o /tmp/CVE-2015-1546.patch \\\n && curl -fL http://git.alpinelinux.org/cgit/aports/plain/main/openldap/CVE-2015-6908.patch?h=3.2-stable -o /tmp/CVE-2015-6908.patch \\\n && curl -fL http://git.alpinelinux.org/cgit/aports/plain/main/openldap/openldap-2.4-ppolicy.patch?h=3.2-stable -o /tmp/openldap-2.4-ppolicy.patch \\\n && curl -fL http://git.alpinelinux.org/cgit/aports/plain/main/openldap/openldap-2.4.11-libldap_r.patch?h=3.2-stable -o /tmp/openldap-2.4.11-libldap_r.patch \\\n && curl -fL http://git.alpinelinux.org/cgit/aports/plain/main/openldap/openldap-mqtt-overlay.patch?h=3.2-stable -o /tmp/openldap-mqtt-overlay.patch \\\n && tar -xzf /tmp/openldap.tgz --strip=1 -C /tmp/openldap \\\n && cd /tmp/openldap \\\n && for p in /tmp/*.patch; do patch -p1 -i $p || true ; done \\\n && rm -vrf /etc/openldap/schema /usr/sbin/slap* /usr/lib/slap* \\\n && ./configure --prefix=/usr --libexecdir=/usr/lib --sysconfdir=/etc --mandir=/tmp/man --localstatedir=/var/lib/openldap --enable-crypt --enable-dynamic --enable-modules --enable-local --enable-slapd --enable-spasswd --enable-bdb=mod --enable-hdb=mod --enable-dnssrv=mod --enable-ldap=mod --enable-meta=mod --enable-monitor=mod --enable-null=mod --enable-passwd=mod --enable-relay=mod --enable-shell=mod --enable-sock=mod --enable-sql=mod --enable-overlays=mod --with-tls=openssl --with-cyrus-sasl \\\n && make \\\n && make install \\\n && cd contrib/slapd-modules/mqtt \\\n && make prefix=/usr libexec=/usr/lib \\\n && make prefix=/usr libexec=/usr/lib install \\\n && cd /usr/sbin \\\n && ln -vs ../lib/slapd \\\n && chown -vR ldap:ldap /etc/openldap /var/lib/openldap \\\n && apk del --purge gettext ${BUILD_DEPS} \\\n && mv -vf /etc/openldap/ldap.conf /etc/openldap/ldap.conf.original \\\n && mv -vf /etc/openldap/slapd.conf /etc/openldap/slapd.conf.original \\\n && echo \"mech_list: plain external\" > /etc/openldap/sasl2/slapd.conf \\\n && rm -vfr /tmp/* /usr/share/man/* /var/tmp/* /var/cache/apk/*\nEXPOSE 389/tcp\nENTRYPOINT [\"/srv/openldap.sh\"]\nCMD [\"slapd\", \"-h\", \"ldapi:///\", \"ldap:///\", \"-u\", \"ldap\", \"-g\", \"ldap\", \"-d\", \"none\"]\nRUN addgroup -S docker-user ; adduser -S -G docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM alpine:3.2\nMAINTAINER Jacob Blain Christen <mailto:dweomer5@gmail.com, https://github.com/dweomer, https://twitter.com/dweomer>\nENV OPENLDAP_VERSION=\"2.4.40\"\nCOPY *.template /srv/openldap/\nCOPY openldap.sh /srv/\nVOLUME [\"/etc/openldap/slapd.d\", \"/var/lib/openldap\"]\nRUN set -x \\\n && chmod -v +x /srv/openldap.sh \\\n && mkdir -vp /etc/openldap/sasl2 /srv/openldap.d /tmp/openldap \\\n && export BUILD_DEPS=\" autoconf automake curl cyrus-sasl-dev db-dev g++ gcc groff gzip libtool make mosquitto-dev openldap-back-bdb openldap-back-ldap openldap-back-meta openldap-back-monitor openldap-back-sql openssl-dev tar unixodbc-dev util-linux-dev \" \\\n && apk add --update gettext libintl openldap openldap-back-hdb openldap-clients openldap-mqtt unixodbc ${BUILD_DEPS} \\\n && cp -v /usr/bin/envsubst /usr/local/bin/ \\\n && curl -fL ftp://ftp.openldap.org/pub/OpenLDAP/openldap-release/openldap-${OPENLDAP_VERSION}.tgz -o /tmp/openldap.tgz \\\n && curl -fL http://git.alpinelinux.org/cgit/aports/plain/main/openldap/0001-dbd-enabled-by-default.patch?h=3.2-stable -o /tmp/0001-dbd-enabled-by-default.patch \\\n && curl -fL http://git.alpinelinux.org/cgit/aports/plain/main/openldap/CVE-2015-1545.patch?h=3.2-stable -o /tmp/CVE-2015-1545.patch \\\n && curl -fL http://git.alpinelinux.org/cgit/aports/plain/main/openldap/CVE-2015-1546.patch?h=3.2-stable -o /tmp/CVE-2015-1546.patch \\\n && curl -fL http://git.alpinelinux.org/cgit/aports/plain/main/openldap/CVE-2015-6908.patch?h=3.2-stable -o /tmp/CVE-2015-6908.patch \\\n && curl -fL http://git.alpinelinux.org/cgit/aports/plain/main/openldap/openldap-2.4-ppolicy.patch?h=3.2-stable -o /tmp/openldap-2.4-ppolicy.patch \\\n && curl -fL http://git.alpinelinux.org/cgit/aports/plain/main/openldap/openldap-2.4.11-libldap_r.patch?h=3.2-stable -o /tmp/openldap-2.4.11-libldap_r.patch \\\n && curl -fL http://git.alpinelinux.org/cgit/aports/plain/main/openldap/openldap-mqtt-overlay.patch?h=3.2-stable -o /tmp/openldap-mqtt-overlay.patch \\\n && tar -xzf /tmp/openldap.tgz --strip=1 -C /tmp/openldap \\\n && cd /tmp/openldap \\\n && for p in /tmp/*.patch; do patch -p1 -i $p || true ; done \\\n && rm -vrf /etc/openldap/schema /usr/sbin/slap* /usr/lib/slap* \\\n && ./configure --prefix=/usr --libexecdir=/usr/lib --sysconfdir=/etc --mandir=/tmp/man --localstatedir=/var/lib/openldap --enable-crypt --enable-dynamic --enable-modules --enable-local --enable-slapd --enable-spasswd --enable-bdb=mod --enable-hdb=mod --enable-dnssrv=mod --enable-ldap=mod --enable-meta=mod --enable-monitor=mod --enable-null=mod --enable-passwd=mod --enable-relay=mod --enable-shell=mod --enable-sock=mod --enable-sql=mod --enable-overlays=mod --with-tls=openssl --with-cyrus-sasl \\\n && make \\\n && make install \\\n && cd contrib/slapd-modules/mqtt \\\n && make prefix=/usr libexec=/usr/lib \\\n && make prefix=/usr libexec=/usr/lib install \\\n && cd /usr/sbin \\\n && ln -vs ../lib/slapd \\\n && chown -vR ldap:ldap /etc/openldap /var/lib/openldap \\\n && apk del --purge gettext ${BUILD_DEPS} \\\n && mv -vf /etc/openldap/ldap.conf /etc/openldap/ldap.conf.original \\\n && mv -vf /etc/openldap/slapd.conf /etc/openldap/slapd.conf.original \\\n && echo \"mech_list: plain external\" > /etc/openldap/sasl2/slapd.conf \\\n && rm -vfr /tmp/* /usr/share/man/* /var/tmp/* /var/cache/apk/*\nEXPOSE 389/tcp\nENTRYPOINT [\"/srv/openldap.sh\"]\nCMD [\"slapd\", \"-h\", \"ldapi:///\", \"ldap:///\", \"-u\", \"ldap\", \"-g\", \"ldap\", \"-d\", \"none\"]\n","injectedSmells":[],"originalDockerfileHash":"259712466f8b6b471776496583742f54","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM alpine:3.2\nMAINTAINER Jacob Blain Christen <mailto:dweomer5@gmail.com, https://github.com/dweomer, https://twitter.com/dweomer>\nENV OPENLDAP_VERSION=\"2.4.40\"\nCOPY *.template /srv/openldap/\nCOPY openldap.sh /srv/\nVOLUME [\"/etc/openldap/slapd.d\", \"/var/lib/openldap\"]\nRUN set -x \\\n && chmod -v +x /srv/openldap.sh \\\n && mkdir -vp /etc/openldap/sasl2 /srv/openldap.d /tmp/openldap \\\n && export BUILD_DEPS=\" autoconf automake curl cyrus-sasl-dev db-dev g++ gcc groff gzip libtool make mosquitto-dev openldap-back-bdb openldap-back-ldap openldap-back-meta openldap-back-monitor openldap-back-sql openssl-dev tar unixodbc-dev util-linux-dev \" \\\n && apk add --update gettext libintl openldap openldap-back-hdb openldap-clients openldap-mqtt unixodbc ${BUILD_DEPS} \\\n && cp -v /usr/bin/envsubst /usr/local/bin/ \\\n && curl -fL ftp://ftp.openldap.org/pub/OpenLDAP/openldap-release/openldap-${OPENLDAP_VERSION}.tgz -o /tmp/openldap.tgz \\\n && curl -fL http://git.alpinelinux.org/cgit/aports/plain/main/openldap/0001-dbd-enabled-by-default.patch?h=3.2-stable -o /tmp/0001-dbd-enabled-by-default.patch \\\n && curl -fL http://git.alpinelinux.org/cgit/aports/plain/main/openldap/CVE-2015-1545.patch?h=3.2-stable -o /tmp/CVE-2015-1545.patch \\\n && curl -fL http://git.alpinelinux.org/cgit/aports/plain/main/openldap/CVE-2015-1546.patch?h=3.2-stable -o /tmp/CVE-2015-1546.patch \\\n && curl -fL http://git.alpinelinux.org/cgit/aports/plain/main/openldap/CVE-2015-6908.patch?h=3.2-stable -o /tmp/CVE-2015-6908.patch \\\n && curl -fL http://git.alpinelinux.org/cgit/aports/plain/main/openldap/openldap-2.4-ppolicy.patch?h=3.2-stable -o /tmp/openldap-2.4-ppolicy.patch \\\n && curl -fL http://git.alpinelinux.org/cgit/aports/plain/main/openldap/openldap-2.4.11-libldap_r.patch?h=3.2-stable -o /tmp/openldap-2.4.11-libldap_r.patch \\\n && curl -fL http://git.alpinelinux.org/cgit/aports/plain/main/openldap/openldap-mqtt-overlay.patch?h=3.2-stable -o /tmp/openldap-mqtt-overlay.patch \\\n && tar -xzf /tmp/openldap.tgz --strip=1 -C /tmp/openldap \\\n && cd /tmp/openldap \\\n && for p in /tmp/*.patch; do patch -p1 -i $p || true ; done \\\n && rm -vrf /etc/openldap/schema /usr/sbin/slap* /usr/lib/slap* \\\n && ./configure --prefix=/usr --libexecdir=/usr/lib --sysconfdir=/etc --mandir=/tmp/man --localstatedir=/var/lib/openldap --enable-crypt --enable-dynamic --enable-modules --enable-local --enable-slapd --enable-spasswd --enable-bdb=mod --enable-hdb=mod --enable-dnssrv=mod --enable-ldap=mod --enable-meta=mod --enable-monitor=mod --enable-null=mod --enable-passwd=mod --enable-relay=mod --enable-shell=mod --enable-sock=mod --enable-sql=mod --enable-overlays=mod --with-tls=openssl --with-cyrus-sasl \\\n && make \\\n && make install \\\n && cd contrib/slapd-modules/mqtt \\\n && make prefix=/usr libexec=/usr/lib \\\n && make prefix=/usr libexec=/usr/lib install \\\n && cd /usr/sbin \\\n && ln -vs ../lib/slapd \\\n && chown -vR ldap:ldap /etc/openldap /var/lib/openldap \\\n && apk del --purge gettext ${BUILD_DEPS} \\\n && mv -vf /etc/openldap/ldap.conf /etc/openldap/ldap.conf.original \\\n && mv -vf /etc/openldap/slapd.conf /etc/openldap/slapd.conf.original \\\n && echo \"mech_list: plain external\" > /etc/openldap/sasl2/slapd.conf \\\n && rm -vfr /tmp/* /usr/share/man/* /var/tmp/* /var/cache/apk/*\nEXPOSE 389/tcp\nENTRYPOINT [\"/srv/openldap.sh\"]\nCMD [\"slapd\", \"-h\", \"ldapi:///\", \"ldap:///\", \"-u\", \"ldap\", \"-g\", \"ldap\", \"-d\", \"none\"]\n","originalDockerfileUglifiedHash":"259712466f8b6b471776496583742f54","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/eb90f3b73ba0090da6e5ea2a83d8a53962f9bcaf.dockerfile"}