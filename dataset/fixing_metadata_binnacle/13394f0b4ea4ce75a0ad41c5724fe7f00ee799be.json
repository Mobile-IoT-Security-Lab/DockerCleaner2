{"seed":2150738525,"processedDockerfileHash":"f31403a1eb514d54b43f0f91b0bf1a34","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM lsiobase/nginx:arm32v7-3.9\n#   set version label\nARG BUILD_DATE\nARG VERSION\nARG NEXTCLOUD_RELEASE\nLABEL build_version=\"Linuxserver.io version:- ${VERSION} Build-date:- ${BUILD_DATE}\"\nLABEL maintainer=\"sparklyballs\"\n#   environment settings\nENV NEXTCLOUD_PATH=\"/config/www/nextcloud\"\nRUN\n#   copy local files\nCOPY root/ /\n#   ports and volumes\nEXPOSE 443/tcp\nVOLUME /config /data\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM lsiobase/nginx:arm32v7-3.9\n#  set version label\nARG BUILD_DATE\nARG VERSION\nARG NEXTCLOUD_RELEASE\nLABEL build_version=\"Linuxserver.io version:- ${VERSION} Build-date:- ${BUILD_DATE}\"\nLABEL maintainer=\"sparklyballs\"\n#  environment settings\nENV NEXTCLOUD_PATH=\"/config/www/nextcloud\"\nRUN echo \"**** install build packages ****\" \\\n && apk add --no-cache --virtual=build-dependencies --upgrade autoconf automake file g++ gcc make php7-dev re2c samba-dev zlib-dev \\\n && echo \"**** install runtime packages ****\" \\\n && apk add --no-cache --upgrade curl ffmpeg imagemagick libxml2 php7-apcu php7-bz2 php7-ctype php7-curl php7-dom php7-exif php7-ftp php7-gd php7-gmp php7-iconv php7-imagick php7-imap php7-intl php7-ldap php7-mcrypt php7-memcached php7-opcache php7-pcntl php7-pdo_mysql php7-pdo_pgsql php7-pdo_sqlite php7-pgsql php7-phar php7-posix php7-redis php7-sodium php7-sqlite3 php7-xmlreader php7-zip samba-client sudo tar unzip \\\n && echo \"**** compile smbclient ****\" \\\n && git clone git://github.com/eduardok/libsmbclient-php.git /tmp/smbclient \\\n && cd /tmp/smbclient \\\n && phpize7 \\\n && ./configure --with-php-config=/usr/bin/php-config7 \\\n && make \\\n && make install \\\n && echo \"**** configure php and nginx for nextcloud ****\" \\\n && echo \"extension=\"smbclient.so\"\" > /etc/php7/conf.d/00_smbclient.ini \\\n && echo 'apc.enable_cli=1' >> /etc/php7/conf.d/apcu.ini \\\n && sed -i -e 's/;opcache.enable.*=.*/opcache.enable=1/g' -e 's/;opcache.interned_strings_buffer.*=.*/opcache.interned_strings_buffer=8/g' -e 's/;opcache.max_accelerated_files.*=.*/opcache.max_accelerated_files=10000/g' -e 's/;opcache.memory_consumption.*=.*/opcache.memory_consumption=128/g' -e 's/;opcache.save_comments.*=.*/opcache.save_comments=1/g' -e 's/;opcache.revalidate_freq.*=.*/opcache.revalidate_freq=1/g' -e 's/;always_populate_raw_post_data.*=.*/always_populate_raw_post_data=-1/g' -e 's/memory_limit.*=.*128M/memory_limit=512M/g' /etc/php7/php.ini \\\n && sed -i '/opcache.enable=1/a opcache.enable_cli=1' /etc/php7/php.ini \\\n && echo \"env[PATH] = /usr/local/bin:/usr/bin:/bin\" >> /etc/php7/php-fpm.conf \\\n && echo \"**** set version tag ****\" \\\n && if [ -z ${NEXTCLOUD_RELEASE+x} ] ; then NEXTCLOUD_RELEASE=$( curl -s https://raw.githubusercontent.com/nextcloud/nextcloud.com/master/strings.php | awk -F' '/VERSIONS_SERVER_FULL_STABLE/ {print $2;exit}' ;) ; fi \\\n && echo ${NEXTCLOUD_RELEASE} > /version.txt \\\n && echo \"**** cleanup ****\" \\\n && apk del --purge build-dependencies \\\n && rm -rf /tmp/*\n#  copy local files\nCOPY root/ /\n#  ports and volumes\nEXPOSE 443/tcp\nVOLUME /config /data\n","injectedSmells":[],"originalDockerfileHash":"09fbab602166963a8c4b784e8031aa5d","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM lsiobase/nginx:arm32v7-3.9\n#   set version label\nARG BUILD_DATE\nARG VERSION\nARG NEXTCLOUD_RELEASE\nLABEL build_version=\"Linuxserver.io version:- ${VERSION} Build-date:- ${BUILD_DATE}\"\nLABEL maintainer=\"sparklyballs\"\n#   environment settings\nENV NEXTCLOUD_PATH=\"/config/www/nextcloud\"\nRUN\n#   copy local files\nCOPY root/ /\n#   ports and volumes\nEXPOSE 443/tcp\nVOLUME /config /data\n","originalDockerfileUglifiedHash":"e6b3385e820d99518eee61266d6c2e40","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/13394f0b4ea4ce75a0ad41c5724fe7f00ee799be.dockerfile"}