{"seed":1197970994,"processedDockerfileHash":"7a2211723c9710fa362c58920003eb51","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","pin-package-manager-versions-apt-get","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM php:7.2-fpm\nLABEL maintainer=\"hareku <hareku908@gmail.com>\"\nUSER root\nRUN apt-get update \\\n && apt-get install --no-install-recommends curl=7.64.0-4+deb10u5 busybox-static=1:1.30.1-4 libmemcached-dev=1.0.18-4.2 libz-dev libpq-dev=11.19-0+deb10u1 libjpeg-dev=1:1.5.2-2+deb10u1 libpng-dev=1.6.36-6 libfreetype6-dev=2.9.1-3+deb10u3 libssl-dev=1.1.1n-0+deb10u4 libmcrypt-dev=2.5.8-3.4 -y \\\n && rm -rf /var/lib/apt/lists/*\nRUN docker-php-ext-install pdo_mysql \\\n && docker-php-ext-install pdo_pgsql \\\n && docker-php-ext-configure gd --enable-gd-native-ttf --with-jpeg-dir=/usr/lib --with-freetype-dir=/usr/include/freetype2 \\\n && docker-php-ext-install gd\nENV DEBIAN_FRONTEND=\"noninteractive\"\nRUN apt-get update -yqq \\\n && apt-get install --no-install-recommends apt-utils=1.8.2.3 -y \\\n && pecl channel-update pecl.php.net\n#  ##########################################################################\n#   ZipArchive:\n#  ##########################################################################\nRUN apt-get install --no-install-recommends libzip-dev=1.5.1-4 -y \\\n && docker-php-ext-configure zip --with-libzip \\\n && docker-php-ext-install zip\n#  ##########################################################################\n#   Mysql Client:\n#  ##########################################################################\nRUN apt-get install --no-install-recommends mysql-client -y\n#  ##########################################################################\n#   PHP Memcached:\n#  ##########################################################################\nRUN curl -L -o /tmp/memcached.tar.gz \"https://github.com/php-memcached-dev/php-memcached/archive/php7.tar.gz\"\nRUN mkdir -p memcached \\\n && tar -C memcached -zxvf /tmp/memcached.tar.gz --strip 1 \\\n && (cd memcached \\\n && phpize \\\n && ./configure \\\n && make -j$( nproc ;) \\\n && make install ) \\\n && rm -r memcached \\\n && rm /tmp/memcached.tar.gz \\\n && docker-php-ext-enable memcached\n#  ##########################################################################\n#   PHP REDIS EXTENSION:\n#  ##########################################################################\nRUN printf \"\\n\" | pecl install -o -f redis \\\n && rm -rf /tmp/pear \\\n && docker-php-ext-enable redis\n#  ##########################################################################\n#   Image optimizers:\n#  ##########################################################################\nRUN apt-get install --no-install-recommends jpegoptim=1.4.6-1 optipng=0.7.7-1 pngquant=2.12.2-1 gifsicle=1.91-5 -y\n#  ##########################################################################\n#   ImageMagick:\n#  ##########################################################################\nRUN apt-get install --no-install-recommends libmagickwand-dev=8:6.9.10.23+dfsg-2.1+deb10u4 imagemagick=8:6.9.10.23+dfsg-2.1+deb10u4 -y \\\n && pecl install imagick \\\n && docker-php-ext-enable imagick\n#  ##########################################################################\n#   Crontab\n#  ##########################################################################\nCOPY ./crontab /var/spool/cron/crontabs/root\n#  ##########################################################################\n#   Opcache:\n#  ##########################################################################\nRUN docker-php-ext-install opcache\nCOPY ./opcache.ini /usr/local/etc/php/conf.d/opcache.ini\n#  ##########################################################################\n#   Supervisor:\n#  ##########################################################################\nRUN apt-get install --no-install-recommends supervisor=3.3.5-1 -y \\\n && rm -rf /var/lib/apt/lists/*\nCOPY ./supervisord.conf /etc/\nCOPY ./supervisord.d/crond.conf /etc/supervisord.d/\nCOPY ./supervisord.d/laravel-worker.conf /etc/supervisord.d/\nCOPY ./supervisord.d/php-fpm.conf /etc/supervisord.d/\n#\n#  --------------------------------------------------------------------------\n#   Final Touch\n#  --------------------------------------------------------------------------\n#\nCOPY ./laravel.ini /usr/local/etc/php/conf.d\nCOPY ./xlaravel.pool.conf /usr/local/etc/php-fpm.d/\nCOPY ./php7.2.ini /usr/local/etc/php/php.ini\n#   Clean up\nRUN apt-get clean \\\n && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* \\\n && rm /var/log/lastlog /var/log/faillog\nRUN usermod -u 1000 www-data\nENTRYPOINT [\"/usr/bin/supervisord\", \"-n\", \"-c\", \"/etc/supervisord.conf\"]\nWORKDIR /etc/supervisor/conf.d/\nEXPOSE 9000/tcp\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\n","originalDockerfile":"FROM php:7.2-fpm\nLABEL maintainer=\"hareku <hareku908@gmail.com>\"\nUSER root\nRUN apt-get update \\\n && apt-get install --no-install-recommends curl busybox-static libmemcached-dev libz-dev libpq-dev libjpeg-dev libpng-dev libfreetype6-dev libssl-dev libmcrypt-dev -y \\\n && rm -rf /var/lib/apt/lists/*\nRUN docker-php-ext-install pdo_mysql \\\n && docker-php-ext-install pdo_pgsql \\\n && docker-php-ext-configure gd --enable-gd-native-ttf --with-jpeg-dir=/usr/lib --with-freetype-dir=/usr/include/freetype2 \\\n && docker-php-ext-install gd\nENV DEBIAN_FRONTEND=\"noninteractive\"\nRUN apt-get update -yqq \\\n && apt-get install apt-utils -y \\\n && pecl channel-update pecl.php.net\n# ##########################################################################\n#  ZipArchive:\n# ##########################################################################\nRUN apt-get install libzip-dev -y \\\n && docker-php-ext-configure zip --with-libzip \\\n && docker-php-ext-install zip\n# ##########################################################################\n#  Mysql Client:\n# ##########################################################################\nRUN apt-get install mysql-client -y\n# ##########################################################################\n#  PHP Memcached:\n# ##########################################################################\nRUN curl -L -o /tmp/memcached.tar.gz \"https://github.com/php-memcached-dev/php-memcached/archive/php7.tar.gz\"\nRUN mkdir -p memcached \\\n && tar -C memcached -zxvf /tmp/memcached.tar.gz --strip 1 \\\n && (cd memcached \\\n && phpize \\\n && ./configure \\\n && make -j$( nproc ;) \\\n && make install ) \\\n && rm -r memcached \\\n && rm /tmp/memcached.tar.gz \\\n && docker-php-ext-enable memcached\n# ##########################################################################\n#  PHP REDIS EXTENSION:\n# ##########################################################################\nRUN printf \"\\n\" | pecl install -o -f redis \\\n && rm -rf /tmp/pear \\\n && docker-php-ext-enable redis\n# ##########################################################################\n#  Image optimizers:\n# ##########################################################################\nRUN apt-get install jpegoptim optipng pngquant gifsicle -y\n# ##########################################################################\n#  ImageMagick:\n# ##########################################################################\nRUN apt-get install libmagickwand-dev imagemagick -y \\\n && pecl install imagick \\\n && docker-php-ext-enable imagick\n# ##########################################################################\n#  Crontab\n# ##########################################################################\nCOPY ./crontab /var/spool/cron/crontabs/root\n# ##########################################################################\n#  Opcache:\n# ##########################################################################\nRUN docker-php-ext-install opcache\nCOPY ./opcache.ini /usr/local/etc/php/conf.d/opcache.ini\n# ##########################################################################\n#  Supervisor:\n# ##########################################################################\nRUN apt-get install --no-install-recommends supervisor -y \\\n && rm -rf /var/lib/apt/lists/*\nCOPY ./supervisord.conf /etc/\nCOPY ./supervisord.d/crond.conf /etc/supervisord.d/\nCOPY ./supervisord.d/laravel-worker.conf /etc/supervisord.d/\nCOPY ./supervisord.d/php-fpm.conf /etc/supervisord.d/\n#\n# --------------------------------------------------------------------------\n#  Final Touch\n# --------------------------------------------------------------------------\n#\nCOPY ./laravel.ini /usr/local/etc/php/conf.d\nCOPY ./xlaravel.pool.conf /usr/local/etc/php-fpm.d/\nCOPY ./php7.2.ini /usr/local/etc/php/php.ini\n#  Clean up\nRUN apt-get clean \\\n && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* \\\n && rm /var/log/lastlog /var/log/faillog\nRUN usermod -u 1000 www-data\nENTRYPOINT [\"/usr/bin/supervisord\", \"-n\", \"-c\", \"/etc/supervisord.conf\"]\nWORKDIR /etc/supervisor/conf.d/\nEXPOSE 9000/tcp\n","injectedSmells":[],"originalDockerfileHash":"72a647a4c76d2ccf38b48eb647679632","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM php:7.2-fpm\nLABEL maintainer=\"hareku <hareku908@gmail.com>\"\nUSER root\nRUN apt-get update \\\n && apt-get install --no-install-recommends curl busybox-static libmemcached-dev libz-dev libpq-dev libjpeg-dev libpng-dev libfreetype6-dev libssl-dev libmcrypt-dev -y \\\n && rm -rf /var/lib/apt/lists/*\nRUN docker-php-ext-install pdo_mysql \\\n && docker-php-ext-install pdo_pgsql \\\n && docker-php-ext-configure gd --enable-gd-native-ttf --with-jpeg-dir=/usr/lib --with-freetype-dir=/usr/include/freetype2 \\\n && docker-php-ext-install gd\nENV DEBIAN_FRONTEND=\"noninteractive\"\nRUN apt-get update -yqq \\\n && apt-get install apt-utils -y \\\n && pecl channel-update pecl.php.net\n#  ##########################################################################\n#   ZipArchive:\n#  ##########################################################################\nRUN apt-get install libzip-dev -y \\\n && docker-php-ext-configure zip --with-libzip \\\n && docker-php-ext-install zip\n#  ##########################################################################\n#   Mysql Client:\n#  ##########################################################################\nRUN apt-get install mysql-client -y\n#  ##########################################################################\n#   PHP Memcached:\n#  ##########################################################################\nRUN curl -L -o /tmp/memcached.tar.gz \"https://github.com/php-memcached-dev/php-memcached/archive/php7.tar.gz\"\nRUN mkdir -p memcached \\\n && tar -C memcached -zxvf /tmp/memcached.tar.gz --strip 1 \\\n && (cd memcached \\\n && phpize \\\n && ./configure \\\n && make -j$( nproc ;) \\\n && make install ) \\\n && rm -r memcached \\\n && rm /tmp/memcached.tar.gz \\\n && docker-php-ext-enable memcached\n#  ##########################################################################\n#   PHP REDIS EXTENSION:\n#  ##########################################################################\nRUN printf \"\\n\" | pecl install -o -f redis \\\n && rm -rf /tmp/pear \\\n && docker-php-ext-enable redis\n#  ##########################################################################\n#   Image optimizers:\n#  ##########################################################################\nRUN apt-get install jpegoptim optipng pngquant gifsicle -y\n#  ##########################################################################\n#   ImageMagick:\n#  ##########################################################################\nRUN apt-get install libmagickwand-dev imagemagick -y \\\n && pecl install imagick \\\n && docker-php-ext-enable imagick\n#  ##########################################################################\n#   Crontab\n#  ##########################################################################\nCOPY ./crontab /var/spool/cron/crontabs/root\n#  ##########################################################################\n#   Opcache:\n#  ##########################################################################\nRUN docker-php-ext-install opcache\nCOPY ./opcache.ini /usr/local/etc/php/conf.d/opcache.ini\n#  ##########################################################################\n#   Supervisor:\n#  ##########################################################################\nRUN apt-get install --no-install-recommends supervisor -y \\\n && rm -rf /var/lib/apt/lists/*\nCOPY ./supervisord.conf /etc/\nCOPY ./supervisord.d/crond.conf /etc/supervisord.d/\nCOPY ./supervisord.d/laravel-worker.conf /etc/supervisord.d/\nCOPY ./supervisord.d/php-fpm.conf /etc/supervisord.d/\n#\n#  --------------------------------------------------------------------------\n#   Final Touch\n#  --------------------------------------------------------------------------\n#\nCOPY ./laravel.ini /usr/local/etc/php/conf.d\nCOPY ./xlaravel.pool.conf /usr/local/etc/php-fpm.d/\nCOPY ./php7.2.ini /usr/local/etc/php/php.ini\n#   Clean up\nRUN apt-get clean \\\n && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* \\\n && rm /var/log/lastlog /var/log/faillog\nRUN usermod -u 1000 www-data\nENTRYPOINT [\"/usr/bin/supervisord\", \"-n\", \"-c\", \"/etc/supervisord.conf\"]\nWORKDIR /etc/supervisor/conf.d/\nEXPOSE 9000/tcp\n","originalDockerfileUglifiedHash":"6e3dc911cf7f2c55dada23fd322b1218","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/e2b1b9d900c7a50b0813ae7c1db80132aac968a9.dockerfile"}