{"seed":2019088876,"processedDockerfileHash":"4f2a71663ba17f748002fdf54dec97db","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"#  BUILD_PUSH=hub,quay\n#  BUILD_PUSH_TAG_FROM=PHP_VERSION\nFROM bigm/base-deb-tools\n#   compile PHP 5.6 (cli and fpm)\n#   based on https://github.com/docker-library/php/blob/master/5.6/fpm/Dockerfile\n#   persistent / runtime deps\nRUN /xt/tools/_apt_install ca-certificates curl libpcre3 librecode0 libsqlite3-0 libxml2\n#   phpize deps\nRUN /xt/tools/_apt_install autoconf file g++ gcc libc-dev make pkg-config re2c\nENV PHP_INI_DIR=\"/usr/local/etc/php\"\nRUN mkdir -p $PHP_INI_DIR/conf.d\n#  prepare what will be compiled\nENV PHP_EXTRA_CONFIGURE_ARGS=\"--enable-fpm --with-fpm-user=root --with-fpm-group=root\"\nRUN /xt/tools/_apt_install $PHP_EXTRA_BUILD_DEPS bzip2 libcurl4-openssl-dev libpcre3-dev libreadline6-dev libssl-dev libxml2-dev librecode-dev libsqlite3-dev xz-utils\nRUN gpg --keyserver pool.sks-keyservers.net --recv-keys 6E4F6AB321FDC07F2C332E3AC2BF0BC433CFC8B3 0BD78B5F97500D450838F95DFE857D9A90D90EC1\nENV PHP_VERSION=\"5.6.20\"\nCOPY compile-php.sh /tmp/compile-php.sh\nRUN /tmp/compile-php.sh \\\n && rm /tmp/compile-php.sh\nCOPY tools/* /xt/tools/\n#  install very common extensions\nRUN /xt/tools/_apt_install libpng12-dev libjpeg-dev libbz2-dev libxslt1-dev libssh2-1-dev libmcrypt-dev\nRUN /xt/tools/php_compile_extension gd --with-png-dir=/usr --with-jpeg-dir=/usr \\\n && /xt/tools/php_compile_extension zip \\\n && /xt/tools/php_compile_extension mbstring \\\n && /xt/tools/php_compile_extension pdo_mysql \\\n && /xt/tools/php_compile_extension bz2 \\\n && /xt/tools/php_compile_extension xsl \\\n && /xt/tools/php_compile_extension xmlrpc \\\n && /xt/tools/php_compile_extension wddx \\\n && /xt/tools/php_compile_extension sockets \\\n && /xt/tools/php_compile_extension exif \\\n && /xt/tools/php_compile_extension ftp \\\n && /xt/tools/php_compile_extension gettext \\\n && /xt/tools/php_compile_extension mcrypt \\\n && /xt/tools/php_compile_extension soap \\\n && /xt/tools/php_compile_cleanup\n#  sysvsem + sysvshm\n#  sysvmsg?\n#  shmop?\n#  gmp ?\n#  mysql ?\n#  mysqli ?\nRUN yes \"\" | pecl install ssh2-0.12 \\\n && echo \"extension=ssh2.so\" > /usr/local/etc/php/conf.d/ext-ssh2.ini\nRUN yes \"\" | pecl install xdebug \\\n && echo \"zend_extension=/usr/local/lib/php/extensions/no-debug-non-zts-20131226/xdebug.so\" > /usr/local/etc/ext-xdebug.ini \\\n && echo \"xdebug.remote_enable = on\" >> /usr/local/etc/ext-xdebug.ini \\\n && echo \"xdebug.remote_connect_back = on\" >> /usr/local/etc/ext-xdebug.ini \\\n && echo 'xdebug.idekey = \"PHPSTORM\"' >> /usr/local/etc/ext-xdebug.ini\nRUN yes \"\" | pecl install APCu-4.0.10 \\\n && echo \"extension=apcu.so\" > /usr/local/etc/php/conf.d/ext-apcu.ini\n#   stable=2.2.7\nENV MEMCACHED_VERSION=\"2.2.0\"\nRUN /xt/tools/_apt_install libmemcached-dev \\\n && pecl install igbinary \\\n && /xt/tools/_download /tmp/memcached.tgz https://pecl.php.net/get/memcached-${MEMCACHED_VERSION}.tgz \\\n && cd /tmp \\\n && tar xf memcached.tgz \\\n && cd /tmp/memcached-${MEMCACHED_VERSION} \\\n && phpize \\\n && ./configure --disable-memcached-sasl \\\n && make \\\n && make install \\\n && echo \"extension=igbinary.so\" > /usr/local/etc/php/conf.d/ext-igbinary.ini \\\n && echo \"extension=memcached.so\" > /usr/local/etc/php/conf.d/ext-memcached.ini\nRUN /xt/tools/_apt_install libmagickwand-dev \\\n && yes \"\" | pecl install imagick \\\n && echo \"extension=imagick.so\" > /usr/local/etc/php/conf.d/ext-imagick.ini\nRUN yes \"\" | pecl install mongo \\\n && echo \"extension=mongo.so\" > /usr/local/etc/php/conf.d/ext-mongo.ini\n#  .install very common extensions\n#  # Install HHVM\n#  RUN curl http://dl.hhvm.com/conf/hhvm.gpg.key | apt-key add - \\\n#  \t&& echo \"deb http://dl.hhvm.com/ubuntu trusty main\" | tee /etc/apt/sources.list.d/hhvm.list \\\n#  \t&& /xt/tools/_apt_install hhvm\n#   composer\nRUN curl -sS https://getcomposer.org/installer | php \\\n && mv composer.phar /usr/local/bin/composer\n#   some pear libraries\nRUN pear install SQL_Parser-0.6.0\n#   wkhtmltopdf - http://wkhtmltopdf.org/downloads.html\nRUN /xt/tools/_apt_install libxext6 fontconfig xfonts-base xfonts-75dpi libxrender-dev \\\n && /xt/tools/_download /tmp/wkhtmltox.deb http://download.gna.org/wkhtmltopdf/0.12/0.12.2.1/wkhtmltox-0.12.2.1_linux-trusty-amd64.deb \\\n && dpkg -i /tmp/wkhtmltox.deb\n#   translate-toolkit\nRUN /xt/tools/_apt_install translate-toolkit\nRUN /xt/tools/_enable_ssmtp \\\n && echo 'sendmail_path = \"/usr/sbin/ssmtp -t\"' > /usr/local/etc/php/conf.d/sendmail.ini\n#   another PDF tool\nRUN /xt/tools/_apt_install pdftk\nCOPY etc/php-fpm.conf /usr/local/etc/\nCOPY etc/fpm.d/* /usr/local/etc/fpm.d/\nCOPY startup/* /xt/startup/\nCOPY supervisor/* /etc/supervisord.d/\nRUN mkdir -p /var/www/html\nWORKDIR /var/www\nENV PHP_TIMEZONE=\"Europe/London\"\nENV PHP_CONF_VERSION=\"production\"\nRUN echo \"xdebug.profiler_enable = 0\" >> /usr/local/etc/ext-xdebug.ini \\\n && echo \"xdebug.profiler_enable_trigger = 1\" >> /usr/local/etc/ext-xdebug.ini \\\n && echo \"xdebug.trace_enable_trigger = 1\" >> /usr/local/etc/ext-xdebug.ini\nEXPOSE 9000/tcp\n#   .compile PHP 5.6 (cli and fpm)\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"# BUILD_PUSH=hub,quay\n# BUILD_PUSH_TAG_FROM=PHP_VERSION\nFROM bigm/base-deb-tools\n#  compile PHP 5.6 (cli and fpm)\n#  based on https://github.com/docker-library/php/blob/master/5.6/fpm/Dockerfile\n#  persistent / runtime deps\nRUN /xt/tools/_apt_install ca-certificates curl libpcre3 librecode0 libsqlite3-0 libxml2\n#  phpize deps\nRUN /xt/tools/_apt_install autoconf file g++ gcc libc-dev make pkg-config re2c\nENV PHP_INI_DIR=\"/usr/local/etc/php\"\nRUN mkdir -p $PHP_INI_DIR/conf.d\n# prepare what will be compiled\nENV PHP_EXTRA_CONFIGURE_ARGS=\"--enable-fpm --with-fpm-user=root --with-fpm-group=root\"\nRUN /xt/tools/_apt_install $PHP_EXTRA_BUILD_DEPS bzip2 libcurl4-openssl-dev libpcre3-dev libreadline6-dev libssl-dev libxml2-dev librecode-dev libsqlite3-dev xz-utils\nRUN gpg --keyserver pool.sks-keyservers.net --recv-keys 6E4F6AB321FDC07F2C332E3AC2BF0BC433CFC8B3 0BD78B5F97500D450838F95DFE857D9A90D90EC1\nENV PHP_VERSION=\"5.6.20\"\nCOPY compile-php.sh /tmp/compile-php.sh\nRUN /tmp/compile-php.sh \\\n && rm /tmp/compile-php.sh\nCOPY tools/* /xt/tools/\n# install very common extensions\nRUN /xt/tools/_apt_install libpng12-dev libjpeg-dev libbz2-dev libxslt1-dev libssh2-1-dev libmcrypt-dev\nRUN /xt/tools/php_compile_extension gd --with-png-dir=/usr --with-jpeg-dir=/usr \\\n && /xt/tools/php_compile_extension zip \\\n && /xt/tools/php_compile_extension mbstring \\\n && /xt/tools/php_compile_extension pdo_mysql \\\n && /xt/tools/php_compile_extension bz2 \\\n && /xt/tools/php_compile_extension xsl \\\n && /xt/tools/php_compile_extension xmlrpc \\\n && /xt/tools/php_compile_extension wddx \\\n && /xt/tools/php_compile_extension sockets \\\n && /xt/tools/php_compile_extension exif \\\n && /xt/tools/php_compile_extension ftp \\\n && /xt/tools/php_compile_extension gettext \\\n && /xt/tools/php_compile_extension mcrypt \\\n && /xt/tools/php_compile_extension soap \\\n && /xt/tools/php_compile_cleanup\n# sysvsem + sysvshm\n# sysvmsg?\n# shmop?\n# gmp ?\n# mysql ?\n# mysqli ?\nRUN yes \"\" | pecl install ssh2-0.12 \\\n && echo \"extension=ssh2.so\" > /usr/local/etc/php/conf.d/ext-ssh2.ini\nRUN yes \"\" | pecl install xdebug \\\n && echo \"zend_extension=/usr/local/lib/php/extensions/no-debug-non-zts-20131226/xdebug.so\" > /usr/local/etc/ext-xdebug.ini \\\n && echo \"xdebug.remote_enable = on\" >> /usr/local/etc/ext-xdebug.ini \\\n && echo \"xdebug.remote_connect_back = on\" >> /usr/local/etc/ext-xdebug.ini \\\n && echo 'xdebug.idekey = \"PHPSTORM\"' >> /usr/local/etc/ext-xdebug.ini\nRUN yes \"\" | pecl install APCu-4.0.10 \\\n && echo \"extension=apcu.so\" > /usr/local/etc/php/conf.d/ext-apcu.ini\n#  stable=2.2.7\nENV MEMCACHED_VERSION=\"2.2.0\"\nRUN /xt/tools/_apt_install libmemcached-dev \\\n && pecl install igbinary \\\n && /xt/tools/_download /tmp/memcached.tgz https://pecl.php.net/get/memcached-${MEMCACHED_VERSION}.tgz \\\n && cd /tmp \\\n && tar xf memcached.tgz \\\n && cd /tmp/memcached-${MEMCACHED_VERSION} \\\n && phpize \\\n && ./configure --disable-memcached-sasl \\\n && make \\\n && make install \\\n && echo \"extension=igbinary.so\" > /usr/local/etc/php/conf.d/ext-igbinary.ini \\\n && echo \"extension=memcached.so\" > /usr/local/etc/php/conf.d/ext-memcached.ini\nRUN /xt/tools/_apt_install libmagickwand-dev \\\n && yes \"\" | pecl install imagick \\\n && echo \"extension=imagick.so\" > /usr/local/etc/php/conf.d/ext-imagick.ini\nRUN yes \"\" | pecl install mongo \\\n && echo \"extension=mongo.so\" > /usr/local/etc/php/conf.d/ext-mongo.ini\n# .install very common extensions\n# # Install HHVM\n# RUN curl http://dl.hhvm.com/conf/hhvm.gpg.key | apt-key add - \\\n# \t&& echo \"deb http://dl.hhvm.com/ubuntu trusty main\" | tee /etc/apt/sources.list.d/hhvm.list \\\n# \t&& /xt/tools/_apt_install hhvm\n#  composer\nRUN curl -sS https://getcomposer.org/installer | php \\\n && mv composer.phar /usr/local/bin/composer\n#  some pear libraries\nRUN pear install SQL_Parser-0.6.0\n#  wkhtmltopdf - http://wkhtmltopdf.org/downloads.html\nRUN /xt/tools/_apt_install libxext6 fontconfig xfonts-base xfonts-75dpi libxrender-dev \\\n && /xt/tools/_download /tmp/wkhtmltox.deb http://download.gna.org/wkhtmltopdf/0.12/0.12.2.1/wkhtmltox-0.12.2.1_linux-trusty-amd64.deb \\\n && dpkg -i /tmp/wkhtmltox.deb\n#  translate-toolkit\nRUN /xt/tools/_apt_install translate-toolkit\nRUN /xt/tools/_enable_ssmtp \\\n && echo 'sendmail_path = \"/usr/sbin/ssmtp -t\"' > /usr/local/etc/php/conf.d/sendmail.ini\n#  another PDF tool\nRUN /xt/tools/_apt_install pdftk\nCOPY etc/php-fpm.conf /usr/local/etc/\nCOPY etc/fpm.d/* /usr/local/etc/fpm.d/\nCOPY startup/* /xt/startup/\nADD supervisor/* /etc/supervisord.d/\nRUN mkdir -p /var/www/html\nWORKDIR /var/www\nENV PHP_TIMEZONE=\"Europe/London\"\nENV PHP_CONF_VERSION=\"production\"\nRUN echo \"xdebug.profiler_enable = 0\" >> /usr/local/etc/ext-xdebug.ini \\\n && echo \"xdebug.profiler_enable_trigger = 1\" >> /usr/local/etc/ext-xdebug.ini \\\n && echo \"xdebug.trace_enable_trigger = 1\" >> /usr/local/etc/ext-xdebug.ini\nEXPOSE 9000/tcp\n#  .compile PHP 5.6 (cli and fpm)\n","injectedSmells":[],"originalDockerfileHash":"2d9a3bbbb3e8acfee123b0117858d9ec","successfullyInjectedSmells":[],"originalDockerfileUglified":"#  BUILD_PUSH=hub,quay\n#  BUILD_PUSH_TAG_FROM=PHP_VERSION\nFROM bigm/base-deb-tools\n#   compile PHP 5.6 (cli and fpm)\n#   based on https://github.com/docker-library/php/blob/master/5.6/fpm/Dockerfile\n#   persistent / runtime deps\nRUN /xt/tools/_apt_install ca-certificates curl libpcre3 librecode0 libsqlite3-0 libxml2\n#   phpize deps\nRUN /xt/tools/_apt_install autoconf file g++ gcc libc-dev make pkg-config re2c\nENV PHP_INI_DIR=\"/usr/local/etc/php\"\nRUN mkdir -p $PHP_INI_DIR/conf.d\n#  prepare what will be compiled\nENV PHP_EXTRA_CONFIGURE_ARGS=\"--enable-fpm --with-fpm-user=root --with-fpm-group=root\"\nRUN /xt/tools/_apt_install $PHP_EXTRA_BUILD_DEPS bzip2 libcurl4-openssl-dev libpcre3-dev libreadline6-dev libssl-dev libxml2-dev librecode-dev libsqlite3-dev xz-utils\nRUN gpg --keyserver pool.sks-keyservers.net --recv-keys 6E4F6AB321FDC07F2C332E3AC2BF0BC433CFC8B3 0BD78B5F97500D450838F95DFE857D9A90D90EC1\nENV PHP_VERSION=\"5.6.20\"\nCOPY compile-php.sh /tmp/compile-php.sh\nRUN /tmp/compile-php.sh \\\n && rm /tmp/compile-php.sh\nCOPY tools/* /xt/tools/\n#  install very common extensions\nRUN /xt/tools/_apt_install libpng12-dev libjpeg-dev libbz2-dev libxslt1-dev libssh2-1-dev libmcrypt-dev\nRUN /xt/tools/php_compile_extension gd --with-png-dir=/usr --with-jpeg-dir=/usr \\\n && /xt/tools/php_compile_extension zip \\\n && /xt/tools/php_compile_extension mbstring \\\n && /xt/tools/php_compile_extension pdo_mysql \\\n && /xt/tools/php_compile_extension bz2 \\\n && /xt/tools/php_compile_extension xsl \\\n && /xt/tools/php_compile_extension xmlrpc \\\n && /xt/tools/php_compile_extension wddx \\\n && /xt/tools/php_compile_extension sockets \\\n && /xt/tools/php_compile_extension exif \\\n && /xt/tools/php_compile_extension ftp \\\n && /xt/tools/php_compile_extension gettext \\\n && /xt/tools/php_compile_extension mcrypt \\\n && /xt/tools/php_compile_extension soap \\\n && /xt/tools/php_compile_cleanup\n#  sysvsem + sysvshm\n#  sysvmsg?\n#  shmop?\n#  gmp ?\n#  mysql ?\n#  mysqli ?\nRUN yes \"\" | pecl install ssh2-0.12 \\\n && echo \"extension=ssh2.so\" > /usr/local/etc/php/conf.d/ext-ssh2.ini\nRUN yes \"\" | pecl install xdebug \\\n && echo \"zend_extension=/usr/local/lib/php/extensions/no-debug-non-zts-20131226/xdebug.so\" > /usr/local/etc/ext-xdebug.ini \\\n && echo \"xdebug.remote_enable = on\" >> /usr/local/etc/ext-xdebug.ini \\\n && echo \"xdebug.remote_connect_back = on\" >> /usr/local/etc/ext-xdebug.ini \\\n && echo 'xdebug.idekey = \"PHPSTORM\"' >> /usr/local/etc/ext-xdebug.ini\nRUN yes \"\" | pecl install APCu-4.0.10 \\\n && echo \"extension=apcu.so\" > /usr/local/etc/php/conf.d/ext-apcu.ini\n#   stable=2.2.7\nENV MEMCACHED_VERSION=\"2.2.0\"\nRUN /xt/tools/_apt_install libmemcached-dev \\\n && pecl install igbinary \\\n && /xt/tools/_download /tmp/memcached.tgz https://pecl.php.net/get/memcached-${MEMCACHED_VERSION}.tgz \\\n && cd /tmp \\\n && tar xf memcached.tgz \\\n && cd /tmp/memcached-${MEMCACHED_VERSION} \\\n && phpize \\\n && ./configure --disable-memcached-sasl \\\n && make \\\n && make install \\\n && echo \"extension=igbinary.so\" > /usr/local/etc/php/conf.d/ext-igbinary.ini \\\n && echo \"extension=memcached.so\" > /usr/local/etc/php/conf.d/ext-memcached.ini\nRUN /xt/tools/_apt_install libmagickwand-dev \\\n && yes \"\" | pecl install imagick \\\n && echo \"extension=imagick.so\" > /usr/local/etc/php/conf.d/ext-imagick.ini\nRUN yes \"\" | pecl install mongo \\\n && echo \"extension=mongo.so\" > /usr/local/etc/php/conf.d/ext-mongo.ini\n#  .install very common extensions\n#  # Install HHVM\n#  RUN curl http://dl.hhvm.com/conf/hhvm.gpg.key | apt-key add - \\\n#  \t&& echo \"deb http://dl.hhvm.com/ubuntu trusty main\" | tee /etc/apt/sources.list.d/hhvm.list \\\n#  \t&& /xt/tools/_apt_install hhvm\n#   composer\nRUN curl -sS https://getcomposer.org/installer | php \\\n && mv composer.phar /usr/local/bin/composer\n#   some pear libraries\nRUN pear install SQL_Parser-0.6.0\n#   wkhtmltopdf - http://wkhtmltopdf.org/downloads.html\nRUN /xt/tools/_apt_install libxext6 fontconfig xfonts-base xfonts-75dpi libxrender-dev \\\n && /xt/tools/_download /tmp/wkhtmltox.deb http://download.gna.org/wkhtmltopdf/0.12/0.12.2.1/wkhtmltox-0.12.2.1_linux-trusty-amd64.deb \\\n && dpkg -i /tmp/wkhtmltox.deb\n#   translate-toolkit\nRUN /xt/tools/_apt_install translate-toolkit\nRUN /xt/tools/_enable_ssmtp \\\n && echo 'sendmail_path = \"/usr/sbin/ssmtp -t\"' > /usr/local/etc/php/conf.d/sendmail.ini\n#   another PDF tool\nRUN /xt/tools/_apt_install pdftk\nCOPY etc/php-fpm.conf /usr/local/etc/\nCOPY etc/fpm.d/* /usr/local/etc/fpm.d/\nCOPY startup/* /xt/startup/\nADD supervisor/* /etc/supervisord.d/\nRUN mkdir -p /var/www/html\nWORKDIR /var/www\nENV PHP_TIMEZONE=\"Europe/London\"\nENV PHP_CONF_VERSION=\"production\"\nRUN echo \"xdebug.profiler_enable = 0\" >> /usr/local/etc/ext-xdebug.ini \\\n && echo \"xdebug.profiler_enable_trigger = 1\" >> /usr/local/etc/ext-xdebug.ini \\\n && echo \"xdebug.trace_enable_trigger = 1\" >> /usr/local/etc/ext-xdebug.ini\nEXPOSE 9000/tcp\n#   .compile PHP 5.6 (cli and fpm)\n","originalDockerfileUglifiedHash":"3f21671a40902f7bb67c52dfdbb40125","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/3bcfadf88c6e43c50d02f31e8cd8be31d815206d.dockerfile"}