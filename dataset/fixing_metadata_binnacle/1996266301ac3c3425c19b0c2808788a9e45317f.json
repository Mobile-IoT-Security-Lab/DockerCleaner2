{"seed":1396113815,"processedDockerfileHash":"51a8cd9986d0f17ccb1a04784df5396a","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","have-a-healthcheck","have-a-user"],"processedDockerfile":"#\n#   Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n#   or more contributor license agreements. Licensed under the Elastic License;\n#   you may not use this file except in compliance with the Elastic License.\n#\nFROM alpine:3.4\n#   This is basically automating the setup instructions in build-setup/linux.md\nMAINTAINER David Roberts <dave.roberts@elastic.co>\n#   Make sure OS packages are up to date and required packages are installed\nRUN apk update \\\n && apk add bash=4.3.42-r5 build-base=0.4-r1 bzip2=1.0.6-r5 coreutils=8.25-r0 curl=7.60.0-r1 diffutils=3.3-r0 file=5.27-r0 git=2.8.6-r0 openssl=1.0.2n-r0 sed=4.2.2-r0 tar=1.29-r1 tzdata=2016d-r0 unzip=6.0-r1 which=2.21-r0 xz-libs=5.2.2-r1 zip=3.0-r4 zlib-dev=1.2.11-r0\n#   For compiling in C++14 mode\nENV CXX=\"\\\"g++ -std=gnu++14\\\"\"\n#   Build libxml2\nRUN wget -q -O - ftp://anonymous@ftp.xmlsoft.org/libxml2/libxml2-2.9.4.tar.gz | tar zxf - \\\n && cd libxml2-2.9.4 \\\n && ./configure --without-python --without-readline \\\n && make -j`grep -c '^processor' /proc/cpuinfo ` \\\n && make install \\\n && cd .. \\\n && rm -rf libxml2-2.9.4\n#   Build APR\nRUN wget -q -O - http://archive.apache.org/dist/apr/apr-1.5.2.tar.bz2 | tar jxf - \\\n && cd apr-1.5.2 \\\n && ./configure --prefix=/usr/local \\\n && make -j`grep -c '^processor' /proc/cpuinfo ` \\\n && make install \\\n && cd .. \\\n && rm -rf apr-1.5.2\n#   Build APR utilities\nRUN wget -q -O - http://archive.apache.org/dist/apr/apr-util-1.5.4.tar.bz2 | tar jxf - \\\n && cd apr-util-1.5.4 \\\n && ./configure --prefix=/usr/local --with-apr=/usr/local/bin/apr-1-config --with-expat=builtin \\\n && make -j`grep -c '^processor' /proc/cpuinfo ` \\\n && make install \\\n && cd .. \\\n && rm -rf apr-util-1.5.4\n#   Build log4cxx\nRUN wget -q -O - http://apache.cs.utah.edu/logging/log4cxx/0.10.0/apache-log4cxx-0.10.0.tar.gz | tar zxf - \\\n && cd apache-log4cxx-0.10.0 \\\n && sed -i -e 's/#define _LOG4CXX_OBJECTPTR_INIT(x) { exchange(x);/#define _LOG4CXX_OBJECTPTR_INIT(x) : ObjectPtrBase() { exchange(x); /g' src/main/include/log4cxx/helpers/objectptr.h \\\n && sed -i -e 's/#define _LOG4CXX_OBJECTPTR_INIT(x) : p(x) {/#define _LOG4CXX_OBJECTPTR_INIT(x) : ObjectPtrBase(), p(x) {/g' src/main/include/log4cxx/helpers/objectptr.h \\\n && sed -i -e 's%#include <log4cxx/helpers/bytebuffer.h>%#include <log4cxx/helpers/bytebuffer.h>\\n#include <string.h>%g' src/main/cpp/inputstreamreader.cpp \\\n && sed -i -e 's%#include <log4cxx/helpers/bytebuffer.h>%#include <log4cxx/helpers/bytebuffer.h>\\n#include <string.h>%g' src/main/cpp/socketoutputstream.cpp \\\n && sed -i -e 's/#include <locale.h>/#include <locale.h>\\n#include <string.h>\\n#include <stdio.h>\\n#include <wchar.h>/' src/examples/cpp/console.cpp \\\n && sed -i -e '152,163s/0x/(char)0x/g' src/main/cpp/locationinfo.cpp \\\n && sed -i -e '239,292s/0x/(char)0x/g' src/main/cpp/loggingevent.cpp \\\n && sed -i -e '39s/0x/(char)0x/g' src/main/cpp/objectoutputstream.cpp \\\n && sed -i -e '84,92s/0x/(char)0x/g' src/main/cpp/objectoutputstream.cpp \\\n && sed -i -e '193,214s/0x/(char)0x/g' src/test/cpp/xml/domtestcase.cpp \\\n && ./configure --with-charset=utf-8 --with-logchar=utf-8 --with-apr=/usr/local --with-apr-util=/usr/local \\\n && make -j`grep -c '^processor' /proc/cpuinfo ` \\\n && make install \\\n && cd .. \\\n && rm -rf apache-log4cxx-0.10.0\n#   Build Boost\nRUN wget -q -O - http://sourceforge.mirrorservice.org/b/bo/boost/boost/1.65.1/boost_1_65_1.tar.bz2 | tar jxf - \\\n && cd boost_1_65_1 \\\n && ./bootstrap.sh cxxflags=-std=gnu++14 --without-libraries=context --without-libraries=coroutine --without-libraries=graph_parallel --without-libraries=log --without-libraries=mpi --without-libraries=python --without-icu \\\n && sed -i -e 's/(17ul)(29ul)(37ul)(53ul)(67ul)(79ul) \\\\/(3ul)(17ul)(29ul)(37ul)(53ul)(67ul)(79ul) \\\\/' boost/unordered/detail/implementation.hpp \\\n && sed -i -e 's%#if ((defined(__linux__) \\&\\& !defined(__UCLIBC__) \\&\\& !defined(BOOST_MATH_HAVE_FIXED_GLIBC)) || defined(__QNX__) || defined(__IBMCPP__)) \\&\\& !defined(BOOST_NO_FENV_H)%#if ((!defined(BOOST_MATH_NO_LONG_DOUBLE_MATH_FUNCTIONS) \\&\\& defined(__linux__) \\&\\& !defined(__UCLIBC__) \\&\\& !defined(BOOST_MATH_HAVE_FIXED_GLIBC)) || defined(__QNX__) || defined(__IBMCPP__)) \\&\\& !defined(BOOST_NO_FENV_H)%g' boost/math/tools/config.hpp \\\n && ./b2 -j`grep -c '^processor' /proc/cpuinfo ` --layout=versioned --disable-icu pch=off optimization=speed inlining=full define=BOOST_MATH_NO_LONG_DOUBLE_MATH_FUNCTIONS \\\n && ./b2 install --layout=versioned --disable-icu pch=off optimization=speed inlining=full define=BOOST_MATH_NO_LONG_DOUBLE_MATH_FUNCTIONS \\\n && cd .. \\\n && rm -rf boost_1_65_1\n#   Build cppunit\nRUN wget -q -O - http://dev-www.libreoffice.org/src/cppunit-1.13.2.tar.gz | tar zxf - \\\n && cd cppunit-1.13.2 \\\n && ./configure \\\n && make -j`grep -c '^processor' /proc/cpuinfo ` \\\n && make install \\\n && cd .. \\\n && rm -rf cppunit-1.13.2\n#   Build patchelf\nRUN wget -q -O - https://nixos.org/releases/patchelf/patchelf-0.9/patchelf-0.9.tar.gz | tar zxf - \\\n && cd patchelf-0.9 \\\n && ./configure \\\n && make -j`grep -c '^processor' /proc/cpuinfo ` \\\n && make install \\\n && cd .. \\\n && rm -rf patchelf-0.9\nRUN addgroup -S docker-user ; adduser -S -G docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#\n#  Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n#  or more contributor license agreements. Licensed under the Elastic License;\n#  you may not use this file except in compliance with the Elastic License.\n#\nFROM alpine:3.4\n#  This is basically automating the setup instructions in build-setup/linux.md\nMAINTAINER David Roberts <dave.roberts@elastic.co>\n#  Make sure OS packages are up to date and required packages are installed\nRUN apk update \\\n && apk add bash build-base bzip2 coreutils curl diffutils file git openssl sed tar tzdata unzip which xz-libs zip zlib-dev\n#  For compiling in C++14 mode\nENV CXX=\"\\\"g++ -std=gnu++14\\\"\"\n#  Build libxml2\nRUN wget -q -O - ftp://anonymous@ftp.xmlsoft.org/libxml2/libxml2-2.9.4.tar.gz | tar zxf - \\\n && cd libxml2-2.9.4 \\\n && ./configure --without-python --without-readline \\\n && make -j`grep -c '^processor' /proc/cpuinfo ` \\\n && make install \\\n && cd .. \\\n && rm -rf libxml2-2.9.4\n#  Build APR\nRUN wget -q -O - http://archive.apache.org/dist/apr/apr-1.5.2.tar.bz2 | tar jxf - \\\n && cd apr-1.5.2 \\\n && ./configure --prefix=/usr/local \\\n && make -j`grep -c '^processor' /proc/cpuinfo ` \\\n && make install \\\n && cd .. \\\n && rm -rf apr-1.5.2\n#  Build APR utilities\nRUN wget -q -O - http://archive.apache.org/dist/apr/apr-util-1.5.4.tar.bz2 | tar jxf - \\\n && cd apr-util-1.5.4 \\\n && ./configure --prefix=/usr/local --with-apr=/usr/local/bin/apr-1-config --with-expat=builtin \\\n && make -j`grep -c '^processor' /proc/cpuinfo ` \\\n && make install \\\n && cd .. \\\n && rm -rf apr-util-1.5.4\n#  Build log4cxx\nRUN wget -q -O - http://apache.cs.utah.edu/logging/log4cxx/0.10.0/apache-log4cxx-0.10.0.tar.gz | tar zxf - \\\n && cd apache-log4cxx-0.10.0 \\\n && sed -i -e 's/#define _LOG4CXX_OBJECTPTR_INIT(x) { exchange(x);/#define _LOG4CXX_OBJECTPTR_INIT(x) : ObjectPtrBase() { exchange(x); /g' src/main/include/log4cxx/helpers/objectptr.h \\\n && sed -i -e 's/#define _LOG4CXX_OBJECTPTR_INIT(x) : p(x) {/#define _LOG4CXX_OBJECTPTR_INIT(x) : ObjectPtrBase(), p(x) {/g' src/main/include/log4cxx/helpers/objectptr.h \\\n && sed -i -e 's%#include <log4cxx/helpers/bytebuffer.h>%#include <log4cxx/helpers/bytebuffer.h>\\n#include <string.h>%g' src/main/cpp/inputstreamreader.cpp \\\n && sed -i -e 's%#include <log4cxx/helpers/bytebuffer.h>%#include <log4cxx/helpers/bytebuffer.h>\\n#include <string.h>%g' src/main/cpp/socketoutputstream.cpp \\\n && sed -i -e 's/#include <locale.h>/#include <locale.h>\\n#include <string.h>\\n#include <stdio.h>\\n#include <wchar.h>/' src/examples/cpp/console.cpp \\\n && sed -i -e '152,163s/0x/(char)0x/g' src/main/cpp/locationinfo.cpp \\\n && sed -i -e '239,292s/0x/(char)0x/g' src/main/cpp/loggingevent.cpp \\\n && sed -i -e '39s/0x/(char)0x/g' src/main/cpp/objectoutputstream.cpp \\\n && sed -i -e '84,92s/0x/(char)0x/g' src/main/cpp/objectoutputstream.cpp \\\n && sed -i -e '193,214s/0x/(char)0x/g' src/test/cpp/xml/domtestcase.cpp \\\n && ./configure --with-charset=utf-8 --with-logchar=utf-8 --with-apr=/usr/local --with-apr-util=/usr/local \\\n && make -j`grep -c '^processor' /proc/cpuinfo ` \\\n && make install \\\n && cd .. \\\n && rm -rf apache-log4cxx-0.10.0\n#  Build Boost\nRUN wget -q -O - http://sourceforge.mirrorservice.org/b/bo/boost/boost/1.65.1/boost_1_65_1.tar.bz2 | tar jxf - \\\n && cd boost_1_65_1 \\\n && ./bootstrap.sh cxxflags=-std=gnu++14 --without-libraries=context --without-libraries=coroutine --without-libraries=graph_parallel --without-libraries=log --without-libraries=mpi --without-libraries=python --without-icu \\\n && sed -i -e 's/(17ul)(29ul)(37ul)(53ul)(67ul)(79ul) \\\\/(3ul)(17ul)(29ul)(37ul)(53ul)(67ul)(79ul) \\\\/' boost/unordered/detail/implementation.hpp \\\n && sed -i -e 's%#if ((defined(__linux__) \\&\\& !defined(__UCLIBC__) \\&\\& !defined(BOOST_MATH_HAVE_FIXED_GLIBC)) || defined(__QNX__) || defined(__IBMCPP__)) \\&\\& !defined(BOOST_NO_FENV_H)%#if ((!defined(BOOST_MATH_NO_LONG_DOUBLE_MATH_FUNCTIONS) \\&\\& defined(__linux__) \\&\\& !defined(__UCLIBC__) \\&\\& !defined(BOOST_MATH_HAVE_FIXED_GLIBC)) || defined(__QNX__) || defined(__IBMCPP__)) \\&\\& !defined(BOOST_NO_FENV_H)%g' boost/math/tools/config.hpp \\\n && ./b2 -j`grep -c '^processor' /proc/cpuinfo ` --layout=versioned --disable-icu pch=off optimization=speed inlining=full define=BOOST_MATH_NO_LONG_DOUBLE_MATH_FUNCTIONS \\\n && ./b2 install --layout=versioned --disable-icu pch=off optimization=speed inlining=full define=BOOST_MATH_NO_LONG_DOUBLE_MATH_FUNCTIONS \\\n && cd .. \\\n && rm -rf boost_1_65_1\n#  Build cppunit\nRUN wget -q -O - http://dev-www.libreoffice.org/src/cppunit-1.13.2.tar.gz | tar zxf - \\\n && cd cppunit-1.13.2 \\\n && ./configure \\\n && make -j`grep -c '^processor' /proc/cpuinfo ` \\\n && make install \\\n && cd .. \\\n && rm -rf cppunit-1.13.2\n#  Build patchelf\nRUN wget -q -O - https://nixos.org/releases/patchelf/patchelf-0.9/patchelf-0.9.tar.gz | tar zxf - \\\n && cd patchelf-0.9 \\\n && ./configure \\\n && make -j`grep -c '^processor' /proc/cpuinfo ` \\\n && make install \\\n && cd .. \\\n && rm -rf patchelf-0.9\n","injectedSmells":[],"originalDockerfileHash":"ecc54b8e6cfb32db668939a253370197","successfullyInjectedSmells":[],"originalDockerfileUglified":"#\n#   Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n#   or more contributor license agreements. Licensed under the Elastic License;\n#   you may not use this file except in compliance with the Elastic License.\n#\nFROM alpine:3.4\n#   This is basically automating the setup instructions in build-setup/linux.md\nMAINTAINER David Roberts <dave.roberts@elastic.co>\n#   Make sure OS packages are up to date and required packages are installed\nRUN apk update \\\n && apk add bash build-base bzip2 coreutils curl diffutils file git openssl sed tar tzdata unzip which xz-libs zip zlib-dev\n#   For compiling in C++14 mode\nENV CXX=\"\\\"g++ -std=gnu++14\\\"\"\n#   Build libxml2\nRUN wget -q -O - ftp://anonymous@ftp.xmlsoft.org/libxml2/libxml2-2.9.4.tar.gz | tar zxf - \\\n && cd libxml2-2.9.4 \\\n && ./configure --without-python --without-readline \\\n && make -j`grep -c '^processor' /proc/cpuinfo ` \\\n && make install \\\n && cd .. \\\n && rm -rf libxml2-2.9.4\n#   Build APR\nRUN wget -q -O - http://archive.apache.org/dist/apr/apr-1.5.2.tar.bz2 | tar jxf - \\\n && cd apr-1.5.2 \\\n && ./configure --prefix=/usr/local \\\n && make -j`grep -c '^processor' /proc/cpuinfo ` \\\n && make install \\\n && cd .. \\\n && rm -rf apr-1.5.2\n#   Build APR utilities\nRUN wget -q -O - http://archive.apache.org/dist/apr/apr-util-1.5.4.tar.bz2 | tar jxf - \\\n && cd apr-util-1.5.4 \\\n && ./configure --prefix=/usr/local --with-apr=/usr/local/bin/apr-1-config --with-expat=builtin \\\n && make -j`grep -c '^processor' /proc/cpuinfo ` \\\n && make install \\\n && cd .. \\\n && rm -rf apr-util-1.5.4\n#   Build log4cxx\nRUN wget -q -O - http://apache.cs.utah.edu/logging/log4cxx/0.10.0/apache-log4cxx-0.10.0.tar.gz | tar zxf - \\\n && cd apache-log4cxx-0.10.0 \\\n && sed -i -e 's/#define _LOG4CXX_OBJECTPTR_INIT(x) { exchange(x);/#define _LOG4CXX_OBJECTPTR_INIT(x) : ObjectPtrBase() { exchange(x); /g' src/main/include/log4cxx/helpers/objectptr.h \\\n && sed -i -e 's/#define _LOG4CXX_OBJECTPTR_INIT(x) : p(x) {/#define _LOG4CXX_OBJECTPTR_INIT(x) : ObjectPtrBase(), p(x) {/g' src/main/include/log4cxx/helpers/objectptr.h \\\n && sed -i -e 's%#include <log4cxx/helpers/bytebuffer.h>%#include <log4cxx/helpers/bytebuffer.h>\\n#include <string.h>%g' src/main/cpp/inputstreamreader.cpp \\\n && sed -i -e 's%#include <log4cxx/helpers/bytebuffer.h>%#include <log4cxx/helpers/bytebuffer.h>\\n#include <string.h>%g' src/main/cpp/socketoutputstream.cpp \\\n && sed -i -e 's/#include <locale.h>/#include <locale.h>\\n#include <string.h>\\n#include <stdio.h>\\n#include <wchar.h>/' src/examples/cpp/console.cpp \\\n && sed -i -e '152,163s/0x/(char)0x/g' src/main/cpp/locationinfo.cpp \\\n && sed -i -e '239,292s/0x/(char)0x/g' src/main/cpp/loggingevent.cpp \\\n && sed -i -e '39s/0x/(char)0x/g' src/main/cpp/objectoutputstream.cpp \\\n && sed -i -e '84,92s/0x/(char)0x/g' src/main/cpp/objectoutputstream.cpp \\\n && sed -i -e '193,214s/0x/(char)0x/g' src/test/cpp/xml/domtestcase.cpp \\\n && ./configure --with-charset=utf-8 --with-logchar=utf-8 --with-apr=/usr/local --with-apr-util=/usr/local \\\n && make -j`grep -c '^processor' /proc/cpuinfo ` \\\n && make install \\\n && cd .. \\\n && rm -rf apache-log4cxx-0.10.0\n#   Build Boost\nRUN wget -q -O - http://sourceforge.mirrorservice.org/b/bo/boost/boost/1.65.1/boost_1_65_1.tar.bz2 | tar jxf - \\\n && cd boost_1_65_1 \\\n && ./bootstrap.sh cxxflags=-std=gnu++14 --without-libraries=context --without-libraries=coroutine --without-libraries=graph_parallel --without-libraries=log --without-libraries=mpi --without-libraries=python --without-icu \\\n && sed -i -e 's/(17ul)(29ul)(37ul)(53ul)(67ul)(79ul) \\\\/(3ul)(17ul)(29ul)(37ul)(53ul)(67ul)(79ul) \\\\/' boost/unordered/detail/implementation.hpp \\\n && sed -i -e 's%#if ((defined(__linux__) \\&\\& !defined(__UCLIBC__) \\&\\& !defined(BOOST_MATH_HAVE_FIXED_GLIBC)) || defined(__QNX__) || defined(__IBMCPP__)) \\&\\& !defined(BOOST_NO_FENV_H)%#if ((!defined(BOOST_MATH_NO_LONG_DOUBLE_MATH_FUNCTIONS) \\&\\& defined(__linux__) \\&\\& !defined(__UCLIBC__) \\&\\& !defined(BOOST_MATH_HAVE_FIXED_GLIBC)) || defined(__QNX__) || defined(__IBMCPP__)) \\&\\& !defined(BOOST_NO_FENV_H)%g' boost/math/tools/config.hpp \\\n && ./b2 -j`grep -c '^processor' /proc/cpuinfo ` --layout=versioned --disable-icu pch=off optimization=speed inlining=full define=BOOST_MATH_NO_LONG_DOUBLE_MATH_FUNCTIONS \\\n && ./b2 install --layout=versioned --disable-icu pch=off optimization=speed inlining=full define=BOOST_MATH_NO_LONG_DOUBLE_MATH_FUNCTIONS \\\n && cd .. \\\n && rm -rf boost_1_65_1\n#   Build cppunit\nRUN wget -q -O - http://dev-www.libreoffice.org/src/cppunit-1.13.2.tar.gz | tar zxf - \\\n && cd cppunit-1.13.2 \\\n && ./configure \\\n && make -j`grep -c '^processor' /proc/cpuinfo ` \\\n && make install \\\n && cd .. \\\n && rm -rf cppunit-1.13.2\n#   Build patchelf\nRUN wget -q -O - https://nixos.org/releases/patchelf/patchelf-0.9/patchelf-0.9.tar.gz | tar zxf - \\\n && cd patchelf-0.9 \\\n && ./configure \\\n && make -j`grep -c '^processor' /proc/cpuinfo ` \\\n && make install \\\n && cd .. \\\n && rm -rf patchelf-0.9\n","originalDockerfileUglifiedHash":"22d0f07d816284968210c866da003fef","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/1996266301ac3c3425c19b0c2808788a9e45317f.dockerfile"}