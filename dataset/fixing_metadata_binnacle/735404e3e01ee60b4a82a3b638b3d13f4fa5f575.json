{"seed":3715889538,"processedDockerfileHash":"8252921fcedbe262ee9097320c83d4bf","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM alpine:3.6\nARG NGINX_VERSION=1.13.2\n#  ftp://ftp.openssl.org/source/\nARG OPENSSL_VERSION=1.0.2l\nARG HEADERES_MORE_NGINX_MODULE=0.33\nARG MODSECURITY_MODULE=3.0.0\nARG MODSECURITY_NGINX_MODULE=1.0.0\nARG NAXSI_MODULE=0.55.3\nRUN apk add curl-dev=7.61.1-r2 wget=1.20.3-r0 linux-headers=4.4.6-r2 alpine-sdk=0.5-r0 zlib-dev=1.2.11-r0 pcre-dev=8.41-r0 libxslt-dev=1.1.29-r4 libxml2-dev=2.9.8-r1 geoip-dev=1.6.10-r0 perl=5.24.4-r2 libaio-dev=0.3.110-r0 acme-client=0.1.16-r3 libtool=2.4.6-r1 m4=1.4.18-r0 autoconf=2.69-r0 automake=1.15.1-r0 yajl-dev=2.1.0-r0 gd-dev=2.2.5-r3 --no-cache\nRUN addgroup -g 9000 -S www-data \\\n && adduser -u 9000 -D -S -G www-data www-data\nRUN mkdir -p /tmp/nginx /tmp/headers-more-nginx-module /tmp/modsecurity-nginx /tmp/naxsi /opt/.openssl /opt/nginx-configuration /opt/modsecurity\nRUN wget http://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz -O latest_ngnix.gzipped\nRUN wget ftp://ftp.openssl.org/source/openssl-${OPENSSL_VERSION}.tar.gz -O latest_openssl.gzipped\nRUN wget https://github.com/openresty/headers-more-nginx-module/archive/v${HEADERES_MORE_NGINX_MODULE}.tar.gz -O headers_more_nginx_module.gzipped\nRUN wget https://github.com/SpiderLabs/ModSecurity/releases/download/v${MODSECURITY_MODULE}/modsecurity-v${MODSECURITY_MODULE}.tar.gz -O modsecurity.gzipped\nRUN wget https://github.com/SpiderLabs/ModSecurity-nginx/releases/download/v${MODSECURITY_NGINX_MODULE}/modsecurity-nginx-v${MODSECURITY_NGINX_MODULE}.tar.gz -O modsecurity-nginx.gzipped\nRUN wget https://github.com/nbs-system/naxsi/archive/${NAXSI_MODULE}.tar.gz -O naxsi.gzipped\nWORKDIR /\nRUN tar --extract --strip-components=1 --file=latest_ngnix.gzipped --directory=/tmp/nginx \\\n && tar --extract --strip-components=1 --file=modsecurity.gzipped --directory=/opt/modsecurity \\\n && tar --extract --strip-components=1 --file=headers_more_nginx_module.gzipped --directory=/tmp/headers-more-nginx-module \\\n && tar --extract --strip-components=1 --file=latest_openssl.gzipped --directory=/opt/.openssl \\\n && tar --extract --strip-components=1 --file=modsecurity-nginx.gzipped --directory=/tmp/modsecurity-nginx \\\n && tar --extract --strip-components=1 --file=naxsi.gzipped --directory=/tmp/naxsi \\\n && rm -Rfv latest_ngnix.gzipped latest_openssl.gzipped headers_more_nginx_module.gzipped modsecurity.gzipped modsecurity-nginx.gzipped naxsi.gzipped\nWORKDIR /opt/modsecurity\nRUN ./configure \\\n && make -j 8 \\\n && make install\nWORKDIR /opt/.openssl\nRUN ./config --prefix=/usr/local --openssldir=/usr/local/open-ssl threads zlib \\\n && make -j 8 \\\n && make test \\\n && make install\nWORKDIR /tmp/nginx\nRUN ./configure --prefix=/usr/local/nginx --sbin-path=/usr/local/sbin/nginx --user=www-data --group=www-data --pid-path=/var/run/nginx.pid --lock-path=/run/lock/subsys/nginx --http-client-body-temp-path=/var/lib/nginx/body --http-proxy-temp-path=/var/lib/nginx/proxy --http-log-path=/var/log/nginx/access.log --error-log-path=/var/log/nginx/error.log --conf-path=/opt/nginx-configuration/nginx.conf --add-module=/tmp/headers-more-nginx-module --add-module=/tmp/modsecurity-nginx --add-module=/tmp/naxsi/naxsi_src --with-openssl=/opt/.openssl --with-file-aio --with-ipv6 --with-http_ssl_module --with-http_v2_module --with-stream --with-stream_ssl_module --with-http_realip_module --with-http_addition_module --with-http_xslt_module --with-http_image_filter_module --with-http_geoip_module --with-http_sub_module --with-http_dav_module --with-http_flv_module --with-http_mp4_module --with-http_gunzip_module --with-http_gzip_static_module --with-http_random_index_module --with-http_secure_link_module --with-http_degradation_module --with-http_stub_status_module --with-pcre-jit --with-pcre --with-debug --with-mail --with-mail_ssl_module --without-mail_pop3_module --without-http_uwsgi_module --without-http_scgi_module \\\n && make -j 8 \\\n && make install\nRUN openssl dhparam -out /etc/dhparam.pem 4096\nRUN mv /tmp/naxsi/naxsi_config/naxsi_core.rules /opt/naxsi_core.rules\nRUN mkdir -p /var/lib/nginx/body /var/www/acme\nRUN rm -Rfv /tmp/*\nEXPOSE 80/tcp 443/tcp\nWORKDIR /opt\nCOPY ./run/bootstrap.sh bootstrap.sh\nCOPY ./certbot certbot/\nRUN chmod u+x bootstrap.sh\nENTRYPOINT [\"sh\", \"bootstrap.sh\"]\nRUN addgroup -S docker-user ; adduser -S -G docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM alpine:3.6\nARG NGINX_VERSION=1.13.2\n# ftp://ftp.openssl.org/source/\nARG OPENSSL_VERSION=1.0.2l\nARG HEADERES_MORE_NGINX_MODULE=0.33\nARG MODSECURITY_MODULE=3.0.0\nARG MODSECURITY_NGINX_MODULE=1.0.0\nARG NAXSI_MODULE=0.55.3\nRUN apk --no-cache add curl-dev wget linux-headers alpine-sdk zlib-dev pcre-dev libxslt-dev libxml2-dev geoip-dev perl libaio-dev acme-client libtool m4 autoconf automake yajl-dev gd-dev\nRUN addgroup -g 9000 -S www-data \\\n && adduser -u 9000 -D -S -G www-data www-data\nRUN mkdir -p /tmp/nginx /tmp/headers-more-nginx-module /tmp/modsecurity-nginx /tmp/naxsi /opt/.openssl /opt/nginx-configuration /opt/modsecurity\nRUN wget http://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz -O latest_ngnix.gzipped\nRUN wget ftp://ftp.openssl.org/source/openssl-${OPENSSL_VERSION}.tar.gz -O latest_openssl.gzipped\nRUN wget https://github.com/openresty/headers-more-nginx-module/archive/v${HEADERES_MORE_NGINX_MODULE}.tar.gz -O headers_more_nginx_module.gzipped\nRUN wget https://github.com/SpiderLabs/ModSecurity/releases/download/v${MODSECURITY_MODULE}/modsecurity-v${MODSECURITY_MODULE}.tar.gz -O modsecurity.gzipped\nRUN wget https://github.com/SpiderLabs/ModSecurity-nginx/releases/download/v${MODSECURITY_NGINX_MODULE}/modsecurity-nginx-v${MODSECURITY_NGINX_MODULE}.tar.gz -O modsecurity-nginx.gzipped\nRUN wget https://github.com/nbs-system/naxsi/archive/${NAXSI_MODULE}.tar.gz -O naxsi.gzipped\nWORKDIR /\nRUN tar --extract --strip-components=1 --file=latest_ngnix.gzipped --directory=/tmp/nginx \\\n && tar --extract --strip-components=1 --file=modsecurity.gzipped --directory=/opt/modsecurity \\\n && tar --extract --strip-components=1 --file=headers_more_nginx_module.gzipped --directory=/tmp/headers-more-nginx-module \\\n && tar --extract --strip-components=1 --file=latest_openssl.gzipped --directory=/opt/.openssl \\\n && tar --extract --strip-components=1 --file=modsecurity-nginx.gzipped --directory=/tmp/modsecurity-nginx \\\n && tar --extract --strip-components=1 --file=naxsi.gzipped --directory=/tmp/naxsi \\\n && rm -Rfv latest_ngnix.gzipped latest_openssl.gzipped headers_more_nginx_module.gzipped modsecurity.gzipped modsecurity-nginx.gzipped naxsi.gzipped\nWORKDIR /opt/modsecurity\nRUN ./configure \\\n && make -j 8 \\\n && make install\nWORKDIR /opt/.openssl\nRUN ./config --prefix=/usr/local --openssldir=/usr/local/open-ssl threads zlib \\\n && make -j 8 \\\n && make test \\\n && make install\nWORKDIR /tmp/nginx\nRUN ./configure --prefix=/usr/local/nginx --sbin-path=/usr/local/sbin/nginx --user=www-data --group=www-data --pid-path=/var/run/nginx.pid --lock-path=/run/lock/subsys/nginx --http-client-body-temp-path=/var/lib/nginx/body --http-proxy-temp-path=/var/lib/nginx/proxy --http-log-path=/var/log/nginx/access.log --error-log-path=/var/log/nginx/error.log --conf-path=/opt/nginx-configuration/nginx.conf --add-module=/tmp/headers-more-nginx-module --add-module=/tmp/modsecurity-nginx --add-module=/tmp/naxsi/naxsi_src --with-openssl=/opt/.openssl --with-file-aio --with-ipv6 --with-http_ssl_module --with-http_v2_module --with-stream --with-stream_ssl_module --with-http_realip_module --with-http_addition_module --with-http_xslt_module --with-http_image_filter_module --with-http_geoip_module --with-http_sub_module --with-http_dav_module --with-http_flv_module --with-http_mp4_module --with-http_gunzip_module --with-http_gzip_static_module --with-http_random_index_module --with-http_secure_link_module --with-http_degradation_module --with-http_stub_status_module --with-pcre-jit --with-pcre --with-debug --with-mail --with-mail_ssl_module --without-mail_pop3_module --without-http_uwsgi_module --without-http_scgi_module \\\n && make -j 8 \\\n && make install\nRUN openssl dhparam -out /etc/dhparam.pem 4096\nRUN mv /tmp/naxsi/naxsi_config/naxsi_core.rules /opt/naxsi_core.rules\nRUN mkdir -p /var/lib/nginx/body /var/www/acme\nRUN rm -Rfv /tmp/*\nEXPOSE 80/tcp 443/tcp\nWORKDIR /opt\nADD ./run/bootstrap.sh bootstrap.sh\nADD ./certbot certbot/\nRUN chmod u+x bootstrap.sh\nENTRYPOINT [\"sh\", \"bootstrap.sh\"]\n","injectedSmells":[],"originalDockerfileHash":"025a25bf544430066fbb180ddd7bf982","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM alpine:3.6\nARG NGINX_VERSION=1.13.2\n#  ftp://ftp.openssl.org/source/\nARG OPENSSL_VERSION=1.0.2l\nARG HEADERES_MORE_NGINX_MODULE=0.33\nARG MODSECURITY_MODULE=3.0.0\nARG MODSECURITY_NGINX_MODULE=1.0.0\nARG NAXSI_MODULE=0.55.3\nRUN apk --no-cache add curl-dev wget linux-headers alpine-sdk zlib-dev pcre-dev libxslt-dev libxml2-dev geoip-dev perl libaio-dev acme-client libtool m4 autoconf automake yajl-dev gd-dev\nRUN addgroup -g 9000 -S www-data \\\n && adduser -u 9000 -D -S -G www-data www-data\nRUN mkdir -p /tmp/nginx /tmp/headers-more-nginx-module /tmp/modsecurity-nginx /tmp/naxsi /opt/.openssl /opt/nginx-configuration /opt/modsecurity\nRUN wget http://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz -O latest_ngnix.gzipped\nRUN wget ftp://ftp.openssl.org/source/openssl-${OPENSSL_VERSION}.tar.gz -O latest_openssl.gzipped\nRUN wget https://github.com/openresty/headers-more-nginx-module/archive/v${HEADERES_MORE_NGINX_MODULE}.tar.gz -O headers_more_nginx_module.gzipped\nRUN wget https://github.com/SpiderLabs/ModSecurity/releases/download/v${MODSECURITY_MODULE}/modsecurity-v${MODSECURITY_MODULE}.tar.gz -O modsecurity.gzipped\nRUN wget https://github.com/SpiderLabs/ModSecurity-nginx/releases/download/v${MODSECURITY_NGINX_MODULE}/modsecurity-nginx-v${MODSECURITY_NGINX_MODULE}.tar.gz -O modsecurity-nginx.gzipped\nRUN wget https://github.com/nbs-system/naxsi/archive/${NAXSI_MODULE}.tar.gz -O naxsi.gzipped\nWORKDIR /\nRUN tar --extract --strip-components=1 --file=latest_ngnix.gzipped --directory=/tmp/nginx \\\n && tar --extract --strip-components=1 --file=modsecurity.gzipped --directory=/opt/modsecurity \\\n && tar --extract --strip-components=1 --file=headers_more_nginx_module.gzipped --directory=/tmp/headers-more-nginx-module \\\n && tar --extract --strip-components=1 --file=latest_openssl.gzipped --directory=/opt/.openssl \\\n && tar --extract --strip-components=1 --file=modsecurity-nginx.gzipped --directory=/tmp/modsecurity-nginx \\\n && tar --extract --strip-components=1 --file=naxsi.gzipped --directory=/tmp/naxsi \\\n && rm -Rfv latest_ngnix.gzipped latest_openssl.gzipped headers_more_nginx_module.gzipped modsecurity.gzipped modsecurity-nginx.gzipped naxsi.gzipped\nWORKDIR /opt/modsecurity\nRUN ./configure \\\n && make -j 8 \\\n && make install\nWORKDIR /opt/.openssl\nRUN ./config --prefix=/usr/local --openssldir=/usr/local/open-ssl threads zlib \\\n && make -j 8 \\\n && make test \\\n && make install\nWORKDIR /tmp/nginx\nRUN ./configure --prefix=/usr/local/nginx --sbin-path=/usr/local/sbin/nginx --user=www-data --group=www-data --pid-path=/var/run/nginx.pid --lock-path=/run/lock/subsys/nginx --http-client-body-temp-path=/var/lib/nginx/body --http-proxy-temp-path=/var/lib/nginx/proxy --http-log-path=/var/log/nginx/access.log --error-log-path=/var/log/nginx/error.log --conf-path=/opt/nginx-configuration/nginx.conf --add-module=/tmp/headers-more-nginx-module --add-module=/tmp/modsecurity-nginx --add-module=/tmp/naxsi/naxsi_src --with-openssl=/opt/.openssl --with-file-aio --with-ipv6 --with-http_ssl_module --with-http_v2_module --with-stream --with-stream_ssl_module --with-http_realip_module --with-http_addition_module --with-http_xslt_module --with-http_image_filter_module --with-http_geoip_module --with-http_sub_module --with-http_dav_module --with-http_flv_module --with-http_mp4_module --with-http_gunzip_module --with-http_gzip_static_module --with-http_random_index_module --with-http_secure_link_module --with-http_degradation_module --with-http_stub_status_module --with-pcre-jit --with-pcre --with-debug --with-mail --with-mail_ssl_module --without-mail_pop3_module --without-http_uwsgi_module --without-http_scgi_module \\\n && make -j 8 \\\n && make install\nRUN openssl dhparam -out /etc/dhparam.pem 4096\nRUN mv /tmp/naxsi/naxsi_config/naxsi_core.rules /opt/naxsi_core.rules\nRUN mkdir -p /var/lib/nginx/body /var/www/acme\nRUN rm -Rfv /tmp/*\nEXPOSE 80/tcp 443/tcp\nWORKDIR /opt\nADD ./run/bootstrap.sh bootstrap.sh\nADD ./certbot certbot/\nRUN chmod u+x bootstrap.sh\nENTRYPOINT [\"sh\", \"bootstrap.sh\"]\n","originalDockerfileUglifiedHash":"feedf6f526b2f539b2ac3ccb9d4a6181","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/735404e3e01ee60b4a82a3b638b3d13f4fa5f575.dockerfile"}