{"seed":399997326,"processedDockerfileHash":"9f4eb24ff6ee199b48c841c02b0f7e14","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apt-get","have-a-healthcheck","have-a-user"],"processedDockerfile":"#   The Dockerfile is Licensed under GNU AFFERO GENERAL PUBLIC LICENSE Version 3\nFROM resin/rpi-raspbian\nLABEL maintainer=\"sahil@ole.org,mappuji@ole.org\"\n#   Add CouchDB user account\nRUN groupadd -r couchdb \\\n && useradd -d /opt/couchdb -g couchdb couchdb\nRUN apt-get update -y \\\n && apt-get install --no-install-recommends ca-certificates=20230311 curl=7.88.1-7ubuntu1 erlang-nox=1:25.2.3+dfsg-1 erlang-reltool=1:25.2.3+dfsg-1 haproxy=2.6.9-1ubuntu1 libicu52 libmozjs185-1.0 openssl=3.0.8-1ubuntu1 -y \\\n && rm -rf /var/lib/apt/lists/*\n#   grab gosu for easy step-down from root and tini for signal handling\n#   see https://github.com/apache/couchdb-docker/pull/28#discussion_r141112407\nENV GOSU_VERSION=\"1.10\"\nENV TINI_VERSION=\"0.16.1\"\nRUN set -ex ; apt-get update ; apt-get install --no-install-recommends wget=1.21.3-1ubuntu1 -y ; rm -rf /var/lib/apt/lists/* ; dpkgArch=\"$( dpkg --print-architecture | awk -F- '{ print $NF }' ;)\" ; wget -O /usr/local/bin/gosu \"https://github.com/tianon/gosu/releases/download/${GOSU_VERSION}/gosu-$dpkgArch\" ; wget -O /usr/local/bin/gosu.asc \"https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-$dpkgArch.asc\" ; export GNUPGHOME=\"$( mktemp -d ;)\" ; gpg --keyserver ha.pool.sks-keyservers.net --recv-keys B42F6819007F00F88E364FD4036A9C25BF357DD4 ; gpg --batch --verify /usr/local/bin/gosu.asc /usr/local/bin/gosu ; rm -r \"$GNUPGHOME\" /usr/local/bin/gosu.asc ; chmod +x /usr/local/bin/gosu ; if ! type \"tini\" > /dev/null; then wget -O /usr/local/bin/tini \"https://github.com/krallin/tini/releases/download/v${TINI_VERSION}/tini-$dpkgArch\" ;wget -O /usr/local/bin/tini.asc \"https://github.com/krallin/tini/releases/download/v${TINI_VERSION}/tini-$dpkgArch.asc\" ;export GNUPGHOME=\"$( mktemp -d ;)\" ;gpg --keyserver ha.pool.sks-keyservers.net --recv-keys 595E85A6B1B4779EA4DAAEC70B588DFF0527A9B7 ;gpg --batch --verify /usr/local/bin/tini.asc /usr/local/bin/tini ;rm -r \"$GNUPGHOME\" /usr/local/bin/tini.asc ;chmod +x /usr/local/bin/tini ;tini --version ; fi ; apt-get purge -y --auto-remove wget\n#   https://www.apache.org/dist/couchdb/KEYS\nENV GPG_KEYS=\"15DD4F3B8AACA54740EB78C7B7B7C53943ECCEE1  1CFBFA43C19B6DF4A0CA3934669C02FFDF3CEBA3  25BBBAC113C1BFD5AA594A4C9F96B92930380381  4BFCA2B99BADC6F9F105BEC9C5E32E2D6B065BFB  5D680346FAA3E51B29DBCB681015F68F9DA248BC  7BCCEB868313DDA925DF1805ECA5BCB7BB9656B0  C3F4DFAEAD621E1C94523AEEC376457E61D50B88  D2B17F9DA23C0A10991AF2E3D9EE01E47852AEE4  E0AF0A194D55C84E4A19A801CDB0C0F904F4EE9B  29E4F38113DF707D722A6EF91FE9AF73118F1A7C  2EC788AE3F239FA13E82D215CDE711289384AE37\"\nRUN set -xe \\\n && for key in $GPG_KEYS; do gpg --keyserver ha.pool.sks-keyservers.net --recv-keys \"$key\" ; done\nENV COUCHDB_VERSION=\"2.2.0\"\n#   Download dev dependencies\nRUN buildDeps=' apt-transport-https gcc g++ erlang-dev libcurl4-openssl-dev libicu-dev libmozjs185-dev make ' \\\n && apt-get update -y -qq \\\n && apt-get install --no-install-recommends $buildDeps -y \\\n && cd /usr/src \\\n && mkdir couchdb \\\n && curl -fSL https://dist.apache.org/repos/dist/release/couchdb/source/$COUCHDB_VERSION/apache-couchdb-$COUCHDB_VERSION.tar.gz -o couchdb.tar.gz \\\n && curl -fSL https://dist.apache.org/repos/dist/release/couchdb/source/$COUCHDB_VERSION/apache-couchdb-$COUCHDB_VERSION.tar.gz.asc -o couchdb.tar.gz.asc \\\n && gpg --batch --verify couchdb.tar.gz.asc couchdb.tar.gz \\\n && tar -xzf couchdb.tar.gz -C couchdb --strip-components=1 \\\n && cd couchdb \\\n && ./configure --disable-docs \\\n && make release \\\n && mv /usr/src/couchdb/rel/couchdb /opt/ \\\n && apt-get purge -y --auto-remove $buildDeps \\\n && rm -rf /var/lib/apt/lists/* /usr/src/couchdb* \\\n && mkdir /opt/couchdb/data \\\n && chown -R couchdb:couchdb /opt/couchdb\n#   Add configuration\nCOPY local.ini /opt/couchdb/etc/local.d/\nCOPY vm.args /opt/couchdb/etc/\nCOPY ./docker-entrypoint.sh /\n#   Setup directories and permissions\nRUN chown -R couchdb:couchdb /opt/couchdb/etc/local.d/ /opt/couchdb/etc/vm.args\nWORKDIR /opt/couchdb\nEXPOSE 5984/tcp 4369/tcp 9100/tcp\nVOLUME [\"/opt/couchdb/data\"]\nENTRYPOINT [\"tini\", \"--\", \"/docker-entrypoint.sh\"]\nCMD [\"/opt/couchdb/bin/couchdb\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  The Dockerfile is Licensed under GNU AFFERO GENERAL PUBLIC LICENSE Version 3\nFROM resin/rpi-raspbian\nLABEL maintainer=\"sahil@ole.org,mappuji@ole.org\"\n#  Add CouchDB user account\nRUN groupadd -r couchdb \\\n && useradd -d /opt/couchdb -g couchdb couchdb\nRUN apt-get update -y \\\n && apt-get install --no-install-recommends ca-certificates curl erlang-nox erlang-reltool haproxy libicu52 libmozjs185-1.0 openssl -y \\\n && rm -rf /var/lib/apt/lists/*\n#  grab gosu for easy step-down from root and tini for signal handling\n#  see https://github.com/apache/couchdb-docker/pull/28#discussion_r141112407\nENV GOSU_VERSION=\"1.10\"\nENV TINI_VERSION=\"0.16.1\"\nRUN set -ex ; apt-get update ; apt-get install --no-install-recommends wget -y ; rm -rf /var/lib/apt/lists/* ; dpkgArch=\"$( dpkg --print-architecture | awk -F- '{ print $NF }' ;)\" ; wget -O /usr/local/bin/gosu \"https://github.com/tianon/gosu/releases/download/${GOSU_VERSION}/gosu-$dpkgArch\" ; wget -O /usr/local/bin/gosu.asc \"https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-$dpkgArch.asc\" ; export GNUPGHOME=\"$( mktemp -d ;)\" ; gpg --keyserver ha.pool.sks-keyservers.net --recv-keys B42F6819007F00F88E364FD4036A9C25BF357DD4 ; gpg --batch --verify /usr/local/bin/gosu.asc /usr/local/bin/gosu ; rm -r \"$GNUPGHOME\" /usr/local/bin/gosu.asc ; chmod +x /usr/local/bin/gosu ; if ! type \"tini\" > /dev/null; then wget -O /usr/local/bin/tini \"https://github.com/krallin/tini/releases/download/v${TINI_VERSION}/tini-$dpkgArch\" ;wget -O /usr/local/bin/tini.asc \"https://github.com/krallin/tini/releases/download/v${TINI_VERSION}/tini-$dpkgArch.asc\" ;export GNUPGHOME=\"$( mktemp -d ;)\" ;gpg --keyserver ha.pool.sks-keyservers.net --recv-keys 595E85A6B1B4779EA4DAAEC70B588DFF0527A9B7 ;gpg --batch --verify /usr/local/bin/tini.asc /usr/local/bin/tini ;rm -r \"$GNUPGHOME\" /usr/local/bin/tini.asc ;chmod +x /usr/local/bin/tini ;tini --version ; fi ; apt-get purge -y --auto-remove wget\n#  https://www.apache.org/dist/couchdb/KEYS\nENV GPG_KEYS=\"15DD4F3B8AACA54740EB78C7B7B7C53943ECCEE1  1CFBFA43C19B6DF4A0CA3934669C02FFDF3CEBA3  25BBBAC113C1BFD5AA594A4C9F96B92930380381  4BFCA2B99BADC6F9F105BEC9C5E32E2D6B065BFB  5D680346FAA3E51B29DBCB681015F68F9DA248BC  7BCCEB868313DDA925DF1805ECA5BCB7BB9656B0  C3F4DFAEAD621E1C94523AEEC376457E61D50B88  D2B17F9DA23C0A10991AF2E3D9EE01E47852AEE4  E0AF0A194D55C84E4A19A801CDB0C0F904F4EE9B  29E4F38113DF707D722A6EF91FE9AF73118F1A7C  2EC788AE3F239FA13E82D215CDE711289384AE37\"\nRUN set -xe \\\n && for key in $GPG_KEYS; do gpg --keyserver ha.pool.sks-keyservers.net --recv-keys \"$key\" ; done\nENV COUCHDB_VERSION=\"2.2.0\"\n#  Download dev dependencies\nRUN buildDeps=' apt-transport-https gcc g++ erlang-dev libcurl4-openssl-dev libicu-dev libmozjs185-dev make ' \\\n && apt-get update -y -qq \\\n && apt-get install --no-install-recommends $buildDeps -y \\\n && cd /usr/src \\\n && mkdir couchdb \\\n && curl -fSL https://dist.apache.org/repos/dist/release/couchdb/source/$COUCHDB_VERSION/apache-couchdb-$COUCHDB_VERSION.tar.gz -o couchdb.tar.gz \\\n && curl -fSL https://dist.apache.org/repos/dist/release/couchdb/source/$COUCHDB_VERSION/apache-couchdb-$COUCHDB_VERSION.tar.gz.asc -o couchdb.tar.gz.asc \\\n && gpg --batch --verify couchdb.tar.gz.asc couchdb.tar.gz \\\n && tar -xzf couchdb.tar.gz -C couchdb --strip-components=1 \\\n && cd couchdb \\\n && ./configure --disable-docs \\\n && make release \\\n && mv /usr/src/couchdb/rel/couchdb /opt/ \\\n && apt-get purge -y --auto-remove $buildDeps \\\n && rm -rf /var/lib/apt/lists/* /usr/src/couchdb* \\\n && mkdir /opt/couchdb/data \\\n && chown -R couchdb:couchdb /opt/couchdb\n#  Add configuration\nCOPY local.ini /opt/couchdb/etc/local.d/\nCOPY vm.args /opt/couchdb/etc/\nCOPY ./docker-entrypoint.sh /\n#  Setup directories and permissions\nRUN chown -R couchdb:couchdb /opt/couchdb/etc/local.d/ /opt/couchdb/etc/vm.args\nWORKDIR /opt/couchdb\nEXPOSE 5984/tcp 4369/tcp 9100/tcp\nVOLUME [\"/opt/couchdb/data\"]\nENTRYPOINT [\"tini\", \"--\", \"/docker-entrypoint.sh\"]\nCMD [\"/opt/couchdb/bin/couchdb\"]\n","injectedSmells":[],"originalDockerfileHash":"52a3a3a35028f0b3b47ff0ad17d7798e","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   The Dockerfile is Licensed under GNU AFFERO GENERAL PUBLIC LICENSE Version 3\nFROM resin/rpi-raspbian\nLABEL maintainer=\"sahil@ole.org,mappuji@ole.org\"\n#   Add CouchDB user account\nRUN groupadd -r couchdb \\\n && useradd -d /opt/couchdb -g couchdb couchdb\nRUN apt-get update -y \\\n && apt-get install --no-install-recommends ca-certificates curl erlang-nox erlang-reltool haproxy libicu52 libmozjs185-1.0 openssl -y \\\n && rm -rf /var/lib/apt/lists/*\n#   grab gosu for easy step-down from root and tini for signal handling\n#   see https://github.com/apache/couchdb-docker/pull/28#discussion_r141112407\nENV GOSU_VERSION=\"1.10\"\nENV TINI_VERSION=\"0.16.1\"\nRUN set -ex ; apt-get update ; apt-get install --no-install-recommends wget -y ; rm -rf /var/lib/apt/lists/* ; dpkgArch=\"$( dpkg --print-architecture | awk -F- '{ print $NF }' ;)\" ; wget -O /usr/local/bin/gosu \"https://github.com/tianon/gosu/releases/download/${GOSU_VERSION}/gosu-$dpkgArch\" ; wget -O /usr/local/bin/gosu.asc \"https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-$dpkgArch.asc\" ; export GNUPGHOME=\"$( mktemp -d ;)\" ; gpg --keyserver ha.pool.sks-keyservers.net --recv-keys B42F6819007F00F88E364FD4036A9C25BF357DD4 ; gpg --batch --verify /usr/local/bin/gosu.asc /usr/local/bin/gosu ; rm -r \"$GNUPGHOME\" /usr/local/bin/gosu.asc ; chmod +x /usr/local/bin/gosu ; if ! type \"tini\" > /dev/null; then wget -O /usr/local/bin/tini \"https://github.com/krallin/tini/releases/download/v${TINI_VERSION}/tini-$dpkgArch\" ;wget -O /usr/local/bin/tini.asc \"https://github.com/krallin/tini/releases/download/v${TINI_VERSION}/tini-$dpkgArch.asc\" ;export GNUPGHOME=\"$( mktemp -d ;)\" ;gpg --keyserver ha.pool.sks-keyservers.net --recv-keys 595E85A6B1B4779EA4DAAEC70B588DFF0527A9B7 ;gpg --batch --verify /usr/local/bin/tini.asc /usr/local/bin/tini ;rm -r \"$GNUPGHOME\" /usr/local/bin/tini.asc ;chmod +x /usr/local/bin/tini ;tini --version ; fi ; apt-get purge -y --auto-remove wget\n#   https://www.apache.org/dist/couchdb/KEYS\nENV GPG_KEYS=\"15DD4F3B8AACA54740EB78C7B7B7C53943ECCEE1  1CFBFA43C19B6DF4A0CA3934669C02FFDF3CEBA3  25BBBAC113C1BFD5AA594A4C9F96B92930380381  4BFCA2B99BADC6F9F105BEC9C5E32E2D6B065BFB  5D680346FAA3E51B29DBCB681015F68F9DA248BC  7BCCEB868313DDA925DF1805ECA5BCB7BB9656B0  C3F4DFAEAD621E1C94523AEEC376457E61D50B88  D2B17F9DA23C0A10991AF2E3D9EE01E47852AEE4  E0AF0A194D55C84E4A19A801CDB0C0F904F4EE9B  29E4F38113DF707D722A6EF91FE9AF73118F1A7C  2EC788AE3F239FA13E82D215CDE711289384AE37\"\nRUN set -xe \\\n && for key in $GPG_KEYS; do gpg --keyserver ha.pool.sks-keyservers.net --recv-keys \"$key\" ; done\nENV COUCHDB_VERSION=\"2.2.0\"\n#   Download dev dependencies\nRUN buildDeps=' apt-transport-https gcc g++ erlang-dev libcurl4-openssl-dev libicu-dev libmozjs185-dev make ' \\\n && apt-get update -y -qq \\\n && apt-get install --no-install-recommends $buildDeps -y \\\n && cd /usr/src \\\n && mkdir couchdb \\\n && curl -fSL https://dist.apache.org/repos/dist/release/couchdb/source/$COUCHDB_VERSION/apache-couchdb-$COUCHDB_VERSION.tar.gz -o couchdb.tar.gz \\\n && curl -fSL https://dist.apache.org/repos/dist/release/couchdb/source/$COUCHDB_VERSION/apache-couchdb-$COUCHDB_VERSION.tar.gz.asc -o couchdb.tar.gz.asc \\\n && gpg --batch --verify couchdb.tar.gz.asc couchdb.tar.gz \\\n && tar -xzf couchdb.tar.gz -C couchdb --strip-components=1 \\\n && cd couchdb \\\n && ./configure --disable-docs \\\n && make release \\\n && mv /usr/src/couchdb/rel/couchdb /opt/ \\\n && apt-get purge -y --auto-remove $buildDeps \\\n && rm -rf /var/lib/apt/lists/* /usr/src/couchdb* \\\n && mkdir /opt/couchdb/data \\\n && chown -R couchdb:couchdb /opt/couchdb\n#   Add configuration\nCOPY local.ini /opt/couchdb/etc/local.d/\nCOPY vm.args /opt/couchdb/etc/\nCOPY ./docker-entrypoint.sh /\n#   Setup directories and permissions\nRUN chown -R couchdb:couchdb /opt/couchdb/etc/local.d/ /opt/couchdb/etc/vm.args\nWORKDIR /opt/couchdb\nEXPOSE 5984/tcp 4369/tcp 9100/tcp\nVOLUME [\"/opt/couchdb/data\"]\nENTRYPOINT [\"tini\", \"--\", \"/docker-entrypoint.sh\"]\nCMD [\"/opt/couchdb/bin/couchdb\"]\n","originalDockerfileUglifiedHash":"2bb94a88c671383711248b66a84aba17","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/20222cad2e5f5d73d497789a8bda453f8474c964.dockerfile"}