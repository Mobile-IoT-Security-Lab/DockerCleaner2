{"seed":2610605485,"processedDockerfileHash":"4e6a2cf050fa3720d44caf5b195fcf2a","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"#   Copyright 2016 Teradata\n#\n#   Licensed under the Apache License, Version 2.0 (the \"License\");\n#   you may not use this file except in compliance with the License.\n#   You may obtain a copy of the License at\n#\n#       http://www.apache.org/licenses/LICENSE-2.0\n#\n#   Unless required by applicable law or agreed to in writing, software\n#   distributed under the License is distributed on an \"AS IS\" BASIS,\n#   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n#   See the License for the specific language governing permissions and\n#   limitations under the License.\nFROM teradatalabs/cdh5-hive:unlabelled\nMAINTAINER Teradata Docker Team <docker@teradata.com>\n#   INSTALL KERBEROS\nRUN yum install -y krb5-libs krb5-server krb5-workstation\n#   ADD KERBEROS CONFIGURATION\nCOPY files/kerberos/krb5.conf /etc/krb5.conf\nCOPY files/kerberos/kdc.conf /var/kerberos/krb5kdc/kdc.conf\nCOPY files/kerberos/kadm5.acl /var/kerberos/krb5kdc/kadm5.acl\n#   CREATE KERBEROS DATABASE\nRUN /usr/sbin/kdb5_util create -s -P password\n#   ADD SUPERVISORD BOOTSTRAP KERBEROS SCRIPT\nCOPY files/bootstrap-kerberos.sh /root/bootstrap-kerberos.sh\nCOPY files/supervisord.d/bootstrap-kerberos.conf /etc/supervisord.d/bootstrap-kerberos.conf\n#   ADD HADOOP PRINCIPALS\nRUN /usr/sbin/kadmin.local -q \"addprinc -randkey hdfs/hadoop-master@LABS.TERADATA.COM\"\nRUN /usr/sbin/kadmin.local -q \"addprinc -randkey mapred/hadoop-master@LABS.TERADATA.COM\"\nRUN /usr/sbin/kadmin.local -q \"addprinc -randkey yarn/hadoop-master@LABS.TERADATA.COM\"\nRUN /usr/sbin/kadmin.local -q \"addprinc -randkey HTTP/hadoop-master@LABS.TERADATA.COM\"\n#   CREATE HADOOP KEYTAB FILES\nRUN /usr/sbin/kadmin.local -q \"xst -norandkey -k /etc/hadoop/conf/hdfs.keytab hdfs/hadoop-master HTTP/hadoop-master\"\nRUN /usr/sbin/kadmin.local -q \"xst -norandkey -k /etc/hadoop/conf/mapred.keytab mapred/hadoop-master HTTP/hadoop-master\"\nRUN /usr/sbin/kadmin.local -q \"xst -norandkey -k /etc/hadoop/conf/yarn.keytab yarn/hadoop-master HTTP/hadoop-master\"\nRUN /usr/sbin/kadmin.local -q \"xst -norandkey -k /etc/hadoop/conf/HTTP.keytab HTTP/hadoop-master\"\nRUN chown hdfs:hadoop /etc/hadoop/conf/hdfs.keytab\nRUN chown mapred:hadoop /etc/hadoop/conf/mapred.keytab\nRUN chown yarn:hadoop /etc/hadoop/conf/yarn.keytab\nRUN chown hdfs:hadoop /etc/hadoop/conf/HTTP.keytab\nRUN chmod 644 /etc/hadoop/conf/*.keytab\n#   ENABLE HADOOP SECURITY\nCOPY files/conf/core-site.xml /etc/hadoop/conf/core-site.xml\nCOPY files/conf/hdfs-site.xml /etc/hadoop/conf/hdfs-site.xml\n#   ENABLE MAPRED SECURITY\nCOPY files/conf/mapred-site.xml /etc/hadoop/conf/mapred-site.xml\nCOPY files/conf/taskcontroller.cfg /etc/hadoop/conf/taskcontroller.cfg\n#   ENABLE YARN SECURITY\nCOPY files/conf/yarn-site.xml /etc/hadoop/conf/yarn-site.xml\nCOPY files/conf/container-executor.cfg /etc/hadoop/conf/container-executor.cfg\nRUN chmod 6050 /etc/hadoop/conf/container-executor.cfg\n#   CREATE HIVE PRINCIPAL AND KEYTAB\nRUN /usr/sbin/kadmin.local -q \"addprinc -randkey hive/hadoop-master@LABS.TERADATA.COM\"\nRUN /usr/sbin/kadmin.local -q \"xst -norandkey -k /etc/hive/conf/hive.keytab hive/hadoop-master\"\n#   ENABLE HIVE SECURITY\nCOPY files/conf/hive-site.xml /etc/hive/conf/hive-site.xml\nRUN chown hive:hadoop /etc/hive/conf/hive.keytab\nRUN chmod 644 /etc/hive/conf/hive.keytab\n#   ENABLE AUTHORIZATION IN HIVE SERVER \nCOPY files/conf/hiveserver2-site.xml /etc/hive/conf/hiveserver2-site.xml\n#   CREATE PRESTO PRINCIPAL AND KEYTAB\nRUN /usr/sbin/kadmin.local -q \"addprinc -randkey presto-server/presto-master.docker.cluster@LABS.TERADATA.COM\"\nRUN /usr/sbin/kadmin.local -q \"addprinc -randkey presto-server/presto-worker.docker.cluster@LABS.TERADATA.COM\"\nRUN /usr/sbin/kadmin.local -q \"addprinc -randkey presto-server/presto-worker-1.docker.cluster@LABS.TERADATA.COM\"\nRUN /usr/sbin/kadmin.local -q \"addprinc -randkey presto-server/presto-worker-2.docker.cluster@LABS.TERADATA.COM\"\nRUN /usr/sbin/kadmin.local -q \"addprinc -randkey HTTP/presto-master.docker.cluster@LABS.TERADATA.COM\"\nRUN /usr/sbin/kadmin.local -q \"addprinc -randkey presto-client/presto-master.docker.cluster@LABS.TERADATA.COM\"\nRUN /usr/sbin/kadmin.local -q \"addprinc -randkey hive/presto-master.docker.cluster@LABS.TERADATA.COM\"\nRUN mkdir -p /etc/presto/conf\nRUN /usr/sbin/kadmin.local -q \"xst -norandkey -k /etc/presto/conf/presto-server.keytab presto-server/presto-master.docker.cluster presto-server/presto-worker.docker.cluster presto-server/presto-worker-1.docker.cluster presto-server/presto-worker-2.docker.cluster\"\nRUN /usr/sbin/kadmin.local -q \"xst -norandkey -k /etc/presto/conf/presto-server-HTTP.keytab HTTP/presto-master.docker.cluster\"\nRUN /usr/sbin/kadmin.local -q \"xst -norandkey -k /etc/presto/conf/presto-client.keytab presto-client/presto-master.docker.cluster\"\nRUN /usr/sbin/kadmin.local -q \"xst -norandkey -k /etc/presto/conf/hive-presto-master.keytab hive/presto-master.docker.cluster\"\nRUN chmod 644 /etc/presto/conf/*.keytab\n#   CREATE SSL KEYSTORE\nRUN keytool -genkeypair -alias presto -keyalg RSA -keystore /etc/presto/conf/keystore.jks -keypass password -storepass password -dname \"CN=presto-master, OU=, O=, L=, S=, C=\"\nRUN chmod 644 /etc/presto/conf/keystore.jks\n#   EXPOSE KERBEROS PORTS\nEXPOSE 88/tcp\nEXPOSE 749/tcp\nCMD /root/startup.sh\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  Copyright 2016 Teradata\n#\n#  Licensed under the Apache License, Version 2.0 (the \"License\");\n#  you may not use this file except in compliance with the License.\n#  You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n#  Unless required by applicable law or agreed to in writing, software\n#  distributed under the License is distributed on an \"AS IS\" BASIS,\n#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n#  See the License for the specific language governing permissions and\n#  limitations under the License.\nFROM teradatalabs/cdh5-hive:unlabelled\nMAINTAINER Teradata Docker Team <docker@teradata.com>\n#  INSTALL KERBEROS\nRUN yum install -y krb5-libs krb5-server krb5-workstation\n#  ADD KERBEROS CONFIGURATION\nADD files/kerberos/krb5.conf /etc/krb5.conf\nADD files/kerberos/kdc.conf /var/kerberos/krb5kdc/kdc.conf\nADD files/kerberos/kadm5.acl /var/kerberos/krb5kdc/kadm5.acl\n#  CREATE KERBEROS DATABASE\nRUN /usr/sbin/kdb5_util create -s -P password\n#  ADD SUPERVISORD BOOTSTRAP KERBEROS SCRIPT\nADD files/bootstrap-kerberos.sh /root/bootstrap-kerberos.sh\nADD files/supervisord.d/bootstrap-kerberos.conf /etc/supervisord.d/bootstrap-kerberos.conf\n#  ADD HADOOP PRINCIPALS\nRUN /usr/sbin/kadmin.local -q \"addprinc -randkey hdfs/hadoop-master@LABS.TERADATA.COM\"\nRUN /usr/sbin/kadmin.local -q \"addprinc -randkey mapred/hadoop-master@LABS.TERADATA.COM\"\nRUN /usr/sbin/kadmin.local -q \"addprinc -randkey yarn/hadoop-master@LABS.TERADATA.COM\"\nRUN /usr/sbin/kadmin.local -q \"addprinc -randkey HTTP/hadoop-master@LABS.TERADATA.COM\"\n#  CREATE HADOOP KEYTAB FILES\nRUN /usr/sbin/kadmin.local -q \"xst -norandkey -k /etc/hadoop/conf/hdfs.keytab hdfs/hadoop-master HTTP/hadoop-master\"\nRUN /usr/sbin/kadmin.local -q \"xst -norandkey -k /etc/hadoop/conf/mapred.keytab mapred/hadoop-master HTTP/hadoop-master\"\nRUN /usr/sbin/kadmin.local -q \"xst -norandkey -k /etc/hadoop/conf/yarn.keytab yarn/hadoop-master HTTP/hadoop-master\"\nRUN /usr/sbin/kadmin.local -q \"xst -norandkey -k /etc/hadoop/conf/HTTP.keytab HTTP/hadoop-master\"\nRUN chown hdfs:hadoop /etc/hadoop/conf/hdfs.keytab\nRUN chown mapred:hadoop /etc/hadoop/conf/mapred.keytab\nRUN chown yarn:hadoop /etc/hadoop/conf/yarn.keytab\nRUN chown hdfs:hadoop /etc/hadoop/conf/HTTP.keytab\nRUN chmod 644 /etc/hadoop/conf/*.keytab\n#  ENABLE HADOOP SECURITY\nADD files/conf/core-site.xml /etc/hadoop/conf/core-site.xml\nADD files/conf/hdfs-site.xml /etc/hadoop/conf/hdfs-site.xml\n#  ENABLE MAPRED SECURITY\nADD files/conf/mapred-site.xml /etc/hadoop/conf/mapred-site.xml\nADD files/conf/taskcontroller.cfg /etc/hadoop/conf/taskcontroller.cfg\n#  ENABLE YARN SECURITY\nADD files/conf/yarn-site.xml /etc/hadoop/conf/yarn-site.xml\nADD files/conf/container-executor.cfg /etc/hadoop/conf/container-executor.cfg\nRUN chmod 6050 /etc/hadoop/conf/container-executor.cfg\n#  CREATE HIVE PRINCIPAL AND KEYTAB\nRUN /usr/sbin/kadmin.local -q \"addprinc -randkey hive/hadoop-master@LABS.TERADATA.COM\"\nRUN /usr/sbin/kadmin.local -q \"xst -norandkey -k /etc/hive/conf/hive.keytab hive/hadoop-master\"\n#  ENABLE HIVE SECURITY\nADD files/conf/hive-site.xml /etc/hive/conf/hive-site.xml\nRUN chown hive:hadoop /etc/hive/conf/hive.keytab\nRUN chmod 644 /etc/hive/conf/hive.keytab\n#  ENABLE AUTHORIZATION IN HIVE SERVER \nADD files/conf/hiveserver2-site.xml /etc/hive/conf/hiveserver2-site.xml\n#  CREATE PRESTO PRINCIPAL AND KEYTAB\nRUN /usr/sbin/kadmin.local -q \"addprinc -randkey presto-server/presto-master.docker.cluster@LABS.TERADATA.COM\"\nRUN /usr/sbin/kadmin.local -q \"addprinc -randkey presto-server/presto-worker.docker.cluster@LABS.TERADATA.COM\"\nRUN /usr/sbin/kadmin.local -q \"addprinc -randkey presto-server/presto-worker-1.docker.cluster@LABS.TERADATA.COM\"\nRUN /usr/sbin/kadmin.local -q \"addprinc -randkey presto-server/presto-worker-2.docker.cluster@LABS.TERADATA.COM\"\nRUN /usr/sbin/kadmin.local -q \"addprinc -randkey HTTP/presto-master.docker.cluster@LABS.TERADATA.COM\"\nRUN /usr/sbin/kadmin.local -q \"addprinc -randkey presto-client/presto-master.docker.cluster@LABS.TERADATA.COM\"\nRUN /usr/sbin/kadmin.local -q \"addprinc -randkey hive/presto-master.docker.cluster@LABS.TERADATA.COM\"\nRUN mkdir -p /etc/presto/conf\nRUN /usr/sbin/kadmin.local -q \"xst -norandkey -k /etc/presto/conf/presto-server.keytab presto-server/presto-master.docker.cluster presto-server/presto-worker.docker.cluster presto-server/presto-worker-1.docker.cluster presto-server/presto-worker-2.docker.cluster\"\nRUN /usr/sbin/kadmin.local -q \"xst -norandkey -k /etc/presto/conf/presto-server-HTTP.keytab HTTP/presto-master.docker.cluster\"\nRUN /usr/sbin/kadmin.local -q \"xst -norandkey -k /etc/presto/conf/presto-client.keytab presto-client/presto-master.docker.cluster\"\nRUN /usr/sbin/kadmin.local -q \"xst -norandkey -k /etc/presto/conf/hive-presto-master.keytab hive/presto-master.docker.cluster\"\nRUN chmod 644 /etc/presto/conf/*.keytab\n#  CREATE SSL KEYSTORE\nRUN keytool -genkeypair -alias presto -keyalg RSA -keystore /etc/presto/conf/keystore.jks -keypass password -storepass password -dname \"CN=presto-master, OU=, O=, L=, S=, C=\"\nRUN chmod 644 /etc/presto/conf/keystore.jks\n#  EXPOSE KERBEROS PORTS\nEXPOSE 88/tcp\nEXPOSE 749/tcp\nCMD /root/startup.sh\n","injectedSmells":[],"originalDockerfileHash":"b0c01dd75857434290ffac7d9b9aadad","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   Copyright 2016 Teradata\n#\n#   Licensed under the Apache License, Version 2.0 (the \"License\");\n#   you may not use this file except in compliance with the License.\n#   You may obtain a copy of the License at\n#\n#       http://www.apache.org/licenses/LICENSE-2.0\n#\n#   Unless required by applicable law or agreed to in writing, software\n#   distributed under the License is distributed on an \"AS IS\" BASIS,\n#   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n#   See the License for the specific language governing permissions and\n#   limitations under the License.\nFROM teradatalabs/cdh5-hive:unlabelled\nMAINTAINER Teradata Docker Team <docker@teradata.com>\n#   INSTALL KERBEROS\nRUN yum install -y krb5-libs krb5-server krb5-workstation\n#   ADD KERBEROS CONFIGURATION\nADD files/kerberos/krb5.conf /etc/krb5.conf\nADD files/kerberos/kdc.conf /var/kerberos/krb5kdc/kdc.conf\nADD files/kerberos/kadm5.acl /var/kerberos/krb5kdc/kadm5.acl\n#   CREATE KERBEROS DATABASE\nRUN /usr/sbin/kdb5_util create -s -P password\n#   ADD SUPERVISORD BOOTSTRAP KERBEROS SCRIPT\nADD files/bootstrap-kerberos.sh /root/bootstrap-kerberos.sh\nADD files/supervisord.d/bootstrap-kerberos.conf /etc/supervisord.d/bootstrap-kerberos.conf\n#   ADD HADOOP PRINCIPALS\nRUN /usr/sbin/kadmin.local -q \"addprinc -randkey hdfs/hadoop-master@LABS.TERADATA.COM\"\nRUN /usr/sbin/kadmin.local -q \"addprinc -randkey mapred/hadoop-master@LABS.TERADATA.COM\"\nRUN /usr/sbin/kadmin.local -q \"addprinc -randkey yarn/hadoop-master@LABS.TERADATA.COM\"\nRUN /usr/sbin/kadmin.local -q \"addprinc -randkey HTTP/hadoop-master@LABS.TERADATA.COM\"\n#   CREATE HADOOP KEYTAB FILES\nRUN /usr/sbin/kadmin.local -q \"xst -norandkey -k /etc/hadoop/conf/hdfs.keytab hdfs/hadoop-master HTTP/hadoop-master\"\nRUN /usr/sbin/kadmin.local -q \"xst -norandkey -k /etc/hadoop/conf/mapred.keytab mapred/hadoop-master HTTP/hadoop-master\"\nRUN /usr/sbin/kadmin.local -q \"xst -norandkey -k /etc/hadoop/conf/yarn.keytab yarn/hadoop-master HTTP/hadoop-master\"\nRUN /usr/sbin/kadmin.local -q \"xst -norandkey -k /etc/hadoop/conf/HTTP.keytab HTTP/hadoop-master\"\nRUN chown hdfs:hadoop /etc/hadoop/conf/hdfs.keytab\nRUN chown mapred:hadoop /etc/hadoop/conf/mapred.keytab\nRUN chown yarn:hadoop /etc/hadoop/conf/yarn.keytab\nRUN chown hdfs:hadoop /etc/hadoop/conf/HTTP.keytab\nRUN chmod 644 /etc/hadoop/conf/*.keytab\n#   ENABLE HADOOP SECURITY\nADD files/conf/core-site.xml /etc/hadoop/conf/core-site.xml\nADD files/conf/hdfs-site.xml /etc/hadoop/conf/hdfs-site.xml\n#   ENABLE MAPRED SECURITY\nADD files/conf/mapred-site.xml /etc/hadoop/conf/mapred-site.xml\nADD files/conf/taskcontroller.cfg /etc/hadoop/conf/taskcontroller.cfg\n#   ENABLE YARN SECURITY\nADD files/conf/yarn-site.xml /etc/hadoop/conf/yarn-site.xml\nADD files/conf/container-executor.cfg /etc/hadoop/conf/container-executor.cfg\nRUN chmod 6050 /etc/hadoop/conf/container-executor.cfg\n#   CREATE HIVE PRINCIPAL AND KEYTAB\nRUN /usr/sbin/kadmin.local -q \"addprinc -randkey hive/hadoop-master@LABS.TERADATA.COM\"\nRUN /usr/sbin/kadmin.local -q \"xst -norandkey -k /etc/hive/conf/hive.keytab hive/hadoop-master\"\n#   ENABLE HIVE SECURITY\nADD files/conf/hive-site.xml /etc/hive/conf/hive-site.xml\nRUN chown hive:hadoop /etc/hive/conf/hive.keytab\nRUN chmod 644 /etc/hive/conf/hive.keytab\n#   ENABLE AUTHORIZATION IN HIVE SERVER \nADD files/conf/hiveserver2-site.xml /etc/hive/conf/hiveserver2-site.xml\n#   CREATE PRESTO PRINCIPAL AND KEYTAB\nRUN /usr/sbin/kadmin.local -q \"addprinc -randkey presto-server/presto-master.docker.cluster@LABS.TERADATA.COM\"\nRUN /usr/sbin/kadmin.local -q \"addprinc -randkey presto-server/presto-worker.docker.cluster@LABS.TERADATA.COM\"\nRUN /usr/sbin/kadmin.local -q \"addprinc -randkey presto-server/presto-worker-1.docker.cluster@LABS.TERADATA.COM\"\nRUN /usr/sbin/kadmin.local -q \"addprinc -randkey presto-server/presto-worker-2.docker.cluster@LABS.TERADATA.COM\"\nRUN /usr/sbin/kadmin.local -q \"addprinc -randkey HTTP/presto-master.docker.cluster@LABS.TERADATA.COM\"\nRUN /usr/sbin/kadmin.local -q \"addprinc -randkey presto-client/presto-master.docker.cluster@LABS.TERADATA.COM\"\nRUN /usr/sbin/kadmin.local -q \"addprinc -randkey hive/presto-master.docker.cluster@LABS.TERADATA.COM\"\nRUN mkdir -p /etc/presto/conf\nRUN /usr/sbin/kadmin.local -q \"xst -norandkey -k /etc/presto/conf/presto-server.keytab presto-server/presto-master.docker.cluster presto-server/presto-worker.docker.cluster presto-server/presto-worker-1.docker.cluster presto-server/presto-worker-2.docker.cluster\"\nRUN /usr/sbin/kadmin.local -q \"xst -norandkey -k /etc/presto/conf/presto-server-HTTP.keytab HTTP/presto-master.docker.cluster\"\nRUN /usr/sbin/kadmin.local -q \"xst -norandkey -k /etc/presto/conf/presto-client.keytab presto-client/presto-master.docker.cluster\"\nRUN /usr/sbin/kadmin.local -q \"xst -norandkey -k /etc/presto/conf/hive-presto-master.keytab hive/presto-master.docker.cluster\"\nRUN chmod 644 /etc/presto/conf/*.keytab\n#   CREATE SSL KEYSTORE\nRUN keytool -genkeypair -alias presto -keyalg RSA -keystore /etc/presto/conf/keystore.jks -keypass password -storepass password -dname \"CN=presto-master, OU=, O=, L=, S=, C=\"\nRUN chmod 644 /etc/presto/conf/keystore.jks\n#   EXPOSE KERBEROS PORTS\nEXPOSE 88/tcp\nEXPOSE 749/tcp\nCMD /root/startup.sh\n","originalDockerfileUglifiedHash":"90e7f02775cfcacbecec6359b4dbecc5","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/db8686f39f42e18c516aac846e848c8ee3b3cc2d.dockerfile"}