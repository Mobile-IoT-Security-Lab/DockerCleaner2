{"seed":1974791031,"processedDockerfileHash":"dafda53b44032426df8a3703553ac408","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","pin-package-manager-versions-apt-get","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"#   Don't edit this file directly, since it was generated from a template,\n#   and you're changes will be *clobbered*.  Edit the template instead.\nFROM ubuntu:14.04\nENV PYTHONPATH=\"/opt/caffe/python\"\n#   Add caffe binaries to path\nENV PATH=\"$PATH:/opt/caffe/.build_release/tools\"\n#   Get dependencies\nRUN apt-get update \\\n && apt-get install --no-install-recommends bc=1.06.95-8ubuntu1 cmake=2.8.12.2-0ubuntu3 curl=7.35.0-1ubuntu2.20 gcc-4.6=4.6.4-6ubuntu2 g++-4.6=4.6.4-6ubuntu2 gcc-4.6-multilib=4.6.4-6ubuntu2 g++-4.6-multilib=4.6.4-6ubuntu2 gfortran=4:4.8.2-1ubuntu6 git=1:1.9.1-1ubuntu0.10 libprotobuf-dev=2.5.0-9ubuntu1 libleveldb-dev=1.15.0-2 libsnappy-dev=1.1.0-1ubuntu1 libopencv-dev=2.4.8+dfsg1-2ubuntu1.2 libboost-all-dev=1.54.0.1ubuntu1 libhdf5-serial-dev=1.8.11-5ubuntu7.1 liblmdb-dev=0.9.10-1 libjpeg62=6b1-4ubuntu1 libfreeimage-dev=3.15.4-3ubuntu0.1 libatlas-base-dev=3.10.1-4 pkgconf=0.9.4-1 protobuf-compiler=2.5.0-9ubuntu1 python-dev=2.7.5-5ubuntu3 python-pip=1.5.4-1ubuntu4 unzip=6.0-9ubuntu1.5 wget=1.15-1ubuntu1.14.04.5 -y\n#   Use gcc 4.6\nRUN update-alternatives --install /usr/bin/cc cc /usr/bin/gcc-4.6 30 \\\n && update-alternatives --install /usr/bin/c++ c++ /usr/bin/g++-4.6 30 \\\n && update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-4.6 30 \\\n && update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-4.6 30\n#   Clone the Caffe repo\nRUN cd /opt \\\n && git clone https://github.com/BVLC/caffe.git\n#   Glog\nRUN cd /opt \\\n && wget https://google-glog.googlecode.com/files/glog-0.3.3.tar.gz \\\n && tar zxvf glog-0.3.3.tar.gz \\\n && cd /opt/glog-0.3.3 \\\n && ./configure \\\n && make \\\n && make install\n#   Workaround for error loading libglog:\n#     error while loading shared libraries: libglog.so.0: cannot open shared object file\n#   The system already has /usr/local/lib listed in /etc/ld.so.conf.d/libc.conf, so\n#   running `ldconfig` fixes the problem (which is simpler than using $LD_LIBRARY_PATH)\n#   TODO: looks like this needs to be run _every_ time a new docker instance is run,\n#         so maybe LD_LIBRARY_PATh is a better approach (or add call to ldconfig in ~/.bashrc)\nRUN ldconfig\n#   Gflags\nRUN cd /opt \\\n && wget https://github.com/schuhschuh/gflags/archive/master.zip \\\n && unzip master.zip \\\n && cd /opt/gflags-master \\\n && mkdir build \\\n && cd /opt/gflags-master/build \\\n && export CXXFLAGS=\"-fPIC\" \\\n && cmake .. \\\n && make VERBOSE=1 \\\n && make \\\n && make install\n#   Build Caffe core\nRUN cd /opt/caffe \\\n && cp Makefile.config.example Makefile.config \\\n && echo \"CPU_ONLY := 1\" >> Makefile.config \\\n && echo \"CXX := /usr/bin/g++-4.6\" >> Makefile.config \\\n && sed -i 's/CXX :=/CXX ?=/' Makefile \\\n && make all\n#   Add ld-so.conf so it can find libcaffe.so\nCOPY caffe-ld-so.conf /etc/ld.so.conf.d/\n#   Run ldconfig again (not sure if needed)\nRUN ldconfig\n#   Install python deps\nRUN cd /opt/caffe \\\n && cat python/requirements.txt | xargs -L 1 sudo pip install\n#   Numpy include path hack - github.com/BVLC/caffe/wiki/Ubuntu-14.04-VirtualBox-VM\nRUN ln -s /usr/include/python2.7/ /usr/local/include/python2.7 \\\n && ln -s /usr/local/lib/python2.7/dist-packages/numpy/core/include/numpy/ /usr/local/include/python2.7/numpy\n#   Build Caffe python bindings\nRUN cd /opt/caffe \\\n && make pycaffe\n#   Make + run tests\nRUN cd /opt/caffe \\\n && make test \\\n && make runtest\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  Don't edit this file directly, since it was generated from a template,\n#  and you're changes will be *clobbered*.  Edit the template instead.\nFROM ubuntu:14.04\nENV PYTHONPATH=\"/opt/caffe/python\"\n#  Add caffe binaries to path\nENV PATH=\"$PATH:/opt/caffe/.build_release/tools\"\n#  Get dependencies\nRUN apt-get update \\\n && apt-get install bc cmake curl gcc-4.6 g++-4.6 gcc-4.6-multilib g++-4.6-multilib gfortran git libprotobuf-dev libleveldb-dev libsnappy-dev libopencv-dev libboost-all-dev libhdf5-serial-dev liblmdb-dev libjpeg62 libfreeimage-dev libatlas-base-dev pkgconf protobuf-compiler python-dev python-pip unzip wget -y\n#  Use gcc 4.6\nRUN update-alternatives --install /usr/bin/cc cc /usr/bin/gcc-4.6 30 \\\n && update-alternatives --install /usr/bin/c++ c++ /usr/bin/g++-4.6 30 \\\n && update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-4.6 30 \\\n && update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-4.6 30\n#  Clone the Caffe repo\nRUN cd /opt \\\n && git clone https://github.com/BVLC/caffe.git\n#  Glog\nRUN cd /opt \\\n && wget https://google-glog.googlecode.com/files/glog-0.3.3.tar.gz \\\n && tar zxvf glog-0.3.3.tar.gz \\\n && cd /opt/glog-0.3.3 \\\n && ./configure \\\n && make \\\n && make install\n#  Workaround for error loading libglog:\n#    error while loading shared libraries: libglog.so.0: cannot open shared object file\n#  The system already has /usr/local/lib listed in /etc/ld.so.conf.d/libc.conf, so\n#  running `ldconfig` fixes the problem (which is simpler than using $LD_LIBRARY_PATH)\n#  TODO: looks like this needs to be run _every_ time a new docker instance is run,\n#        so maybe LD_LIBRARY_PATh is a better approach (or add call to ldconfig in ~/.bashrc)\nRUN ldconfig\n#  Gflags\nRUN cd /opt \\\n && wget https://github.com/schuhschuh/gflags/archive/master.zip \\\n && unzip master.zip \\\n && cd /opt/gflags-master \\\n && mkdir build \\\n && cd /opt/gflags-master/build \\\n && export CXXFLAGS=\"-fPIC\" \\\n && cmake .. \\\n && make VERBOSE=1 \\\n && make \\\n && make install\n#  Build Caffe core\nRUN cd /opt/caffe \\\n && cp Makefile.config.example Makefile.config \\\n && echo \"CPU_ONLY := 1\" >> Makefile.config \\\n && echo \"CXX := /usr/bin/g++-4.6\" >> Makefile.config \\\n && sed -i 's/CXX :=/CXX ?=/' Makefile \\\n && make all\n#  Add ld-so.conf so it can find libcaffe.so\nADD caffe-ld-so.conf /etc/ld.so.conf.d/\n#  Run ldconfig again (not sure if needed)\nRUN ldconfig\n#  Install python deps\nRUN cd /opt/caffe \\\n && cat python/requirements.txt | xargs -L 1 sudo pip install\n#  Numpy include path hack - github.com/BVLC/caffe/wiki/Ubuntu-14.04-VirtualBox-VM\nRUN ln -s /usr/include/python2.7/ /usr/local/include/python2.7 \\\n && ln -s /usr/local/lib/python2.7/dist-packages/numpy/core/include/numpy/ /usr/local/include/python2.7/numpy\n#  Build Caffe python bindings\nRUN cd /opt/caffe \\\n && make pycaffe\n#  Make + run tests\nRUN cd /opt/caffe \\\n && make test \\\n && make runtest\n","injectedSmells":[],"originalDockerfileHash":"3f852475c5ac016106588d1b75b4eb77","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   Don't edit this file directly, since it was generated from a template,\n#   and you're changes will be *clobbered*.  Edit the template instead.\nFROM ubuntu:14.04\nENV PYTHONPATH=\"/opt/caffe/python\"\n#   Add caffe binaries to path\nENV PATH=\"$PATH:/opt/caffe/.build_release/tools\"\n#   Get dependencies\nRUN apt-get update \\\n && apt-get install bc cmake curl gcc-4.6 g++-4.6 gcc-4.6-multilib g++-4.6-multilib gfortran git libprotobuf-dev libleveldb-dev libsnappy-dev libopencv-dev libboost-all-dev libhdf5-serial-dev liblmdb-dev libjpeg62 libfreeimage-dev libatlas-base-dev pkgconf protobuf-compiler python-dev python-pip unzip wget -y\n#   Use gcc 4.6\nRUN update-alternatives --install /usr/bin/cc cc /usr/bin/gcc-4.6 30 \\\n && update-alternatives --install /usr/bin/c++ c++ /usr/bin/g++-4.6 30 \\\n && update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-4.6 30 \\\n && update-alternatives --install /usr/bin/g++ g++ /usr/bin/g++-4.6 30\n#   Clone the Caffe repo\nRUN cd /opt \\\n && git clone https://github.com/BVLC/caffe.git\n#   Glog\nRUN cd /opt \\\n && wget https://google-glog.googlecode.com/files/glog-0.3.3.tar.gz \\\n && tar zxvf glog-0.3.3.tar.gz \\\n && cd /opt/glog-0.3.3 \\\n && ./configure \\\n && make \\\n && make install\n#   Workaround for error loading libglog:\n#     error while loading shared libraries: libglog.so.0: cannot open shared object file\n#   The system already has /usr/local/lib listed in /etc/ld.so.conf.d/libc.conf, so\n#   running `ldconfig` fixes the problem (which is simpler than using $LD_LIBRARY_PATH)\n#   TODO: looks like this needs to be run _every_ time a new docker instance is run,\n#         so maybe LD_LIBRARY_PATh is a better approach (or add call to ldconfig in ~/.bashrc)\nRUN ldconfig\n#   Gflags\nRUN cd /opt \\\n && wget https://github.com/schuhschuh/gflags/archive/master.zip \\\n && unzip master.zip \\\n && cd /opt/gflags-master \\\n && mkdir build \\\n && cd /opt/gflags-master/build \\\n && export CXXFLAGS=\"-fPIC\" \\\n && cmake .. \\\n && make VERBOSE=1 \\\n && make \\\n && make install\n#   Build Caffe core\nRUN cd /opt/caffe \\\n && cp Makefile.config.example Makefile.config \\\n && echo \"CPU_ONLY := 1\" >> Makefile.config \\\n && echo \"CXX := /usr/bin/g++-4.6\" >> Makefile.config \\\n && sed -i 's/CXX :=/CXX ?=/' Makefile \\\n && make all\n#   Add ld-so.conf so it can find libcaffe.so\nADD caffe-ld-so.conf /etc/ld.so.conf.d/\n#   Run ldconfig again (not sure if needed)\nRUN ldconfig\n#   Install python deps\nRUN cd /opt/caffe \\\n && cat python/requirements.txt | xargs -L 1 sudo pip install\n#   Numpy include path hack - github.com/BVLC/caffe/wiki/Ubuntu-14.04-VirtualBox-VM\nRUN ln -s /usr/include/python2.7/ /usr/local/include/python2.7 \\\n && ln -s /usr/local/lib/python2.7/dist-packages/numpy/core/include/numpy/ /usr/local/include/python2.7/numpy\n#   Build Caffe python bindings\nRUN cd /opt/caffe \\\n && make pycaffe\n#   Make + run tests\nRUN cd /opt/caffe \\\n && make test \\\n && make runtest\n","originalDockerfileUglifiedHash":"b6e858e8f0a75c523dc0dc2f52733f77","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/382225c4a66f33563951847b43aec993f014041c.dockerfile"}