{"seed":2715846262,"processedDockerfileHash":"b4b576cda7c9be36fd156eaaac2ae53f","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["have-a-healthcheck","have-a-user"],"processedDockerfile":"ARG DOCKER_IMG=laurmarinovici/tesp\nARG DOCKER_IMG_VERSION=:base\nFROM ${DOCKER_IMG}${DOCKER_IMG_VERSION} AS tesp-fncs-builder\n#   -----------------------------------------------------\n#   Environment variables giving the location where TESP\n#   related software will be installed on the Docker container.\n#   -----------------------------------------------------\nENV TESP=\"${WORK_DIR}/tesp-platform\"\nENV FNCS_INSTALL=\"${TESP}/FNCSInstall\"\nENV GLD_INSTALL=\"${TESP}/GridLABDInstall\"\nENV EPLUS_INSTALL=\"${TESP}/EnergyPlusInstall\"\nENV EPLUSJSON_INSTALL=\"${TESP}/EPlusJSONInstall\"\n#   ----------------------------------------------------\n#   Because I want to use the software versions I already have\n#   installed on the current VM, I am going to use\n#   directly the downloads and repositories I have, letting aside\n#   the commands that are performing the actual downloads, and \n#   repository cloning.\n#   Hence, from the context of the folder where I have all my downloads\n#   and clones, I only add the needed ones.\n#   I am running the image building script from inside the folder where\n#   all repositories have been already cloned in the source folders below.\n#   --------------------------------------------------------------\n#   FNCS branch = develop\nENV FNCS_SOURCE=\"fncs\"\n#   -------------------------------\n#   GridLAB-D branch = feature/1146\nENV GLD_SOURCE=\"gridlab-d\"\n#   -------------------------------\n#   Energy Plus branch = fncs-v8.3.0\nENV EPLUS_SOURCE=\"EnergyPlus\"\n#   EnergyPlusJSON copied from TESP sources to the context first\nENV EPLUSJSON_SOURCE=\"EnergyPlusJSON\"\n#   -------------------------------\n#   The folder on the image where all source files will be copied to,\n#   so that installation can proceed.\nENV SOURCE_DIR=\"${WORK_DIR}/sources/\"\n#   --------------------------------------------------------------\n#   Environment variables needed for the package installation\n#   --------------------------------------------------------------\nENV LD_LIBRARY_PATH=\"$LD_LIBRARY_PATH:${FNCS_INSTALL}/lib\"\nENV FNCS_LIBRARY=\"${FNCS_INSTALL}/lib\"\nENV FNCS_INCLUDE_DIR=\"${FNCS_INSTALL}/include\"\nENV PATH=\"${PATH}:${FNCS_INSTALL}/bin:${GLD_INSTALL}/bin:${EPLUS_INSTALL}:${EPLUS_INSTALL}/PreProcess:${EPLUS_INSTALL}/PostProcess:${EPLUSJSON_INSTALL}/bin\"\nENV GLPATH=\"${GLD_INSTALL}/lib/gridlabd:${GLD_INSTALL}/share/gridlabd\"\n#   default values\nENV FNCS_LOG_FILE=\"no\"\nENV FNCS_LOG_STDOUT=\"no\"\nENV FNCS_LOG_TRACE=\"no\"\nENV FNCS_LOG_LEVEL=\"DEBUG4\"\n#   ------------------------------------------------------------------\n#   Adding the host source folders to the Docker image source folders\n#   ------------------------------------------------------------------\nCOPY --chown=tesp-user:tesp-user ./ ${SOURCE_DIR}\nRUN mkdir -p ${SOURCE_DIR} \\\n && mkdir -p ${TESP} \\\n && cd ${SOURCE_DIR}/${FNCS_SOURCE} \\\n && autoreconf -if \\\n && ./configure --prefix=${FNCS_INSTALL} \\\n && make \\\n && make install \\\n && /bin/rm -r ${SOURCE_DIR}/${FNCS_SOURCE} \\\n && cd ${SOURCE_DIR}${GLD_SOURCE} \\\n && autoreconf -isf \\\n && ./configure --prefix=${GLD_INSTALL} --with-fncs=${FNCS_INSTALL} --enable-silent-rules 'CPP=gcc -E' 'CXXPP=g++ -E' 'CC=gcc' 'CXX=g++' 'CFLAGS=-w -O3 -fno-inline-functions' 'CXXFLAGS=-w -O3 -fno-inline-functions -std=c++14' 'LDFLAGS=-w -O3' \\\n && make \\\n && make install \\\n && /bin/rm -r ${SOURCE_DIR}${GLD_SOURCE} \\\n && cd ${SOURCE_DIR}/${EPLUS_SOURCE} \\\n && mkdir build \\\n && cd ./build \\\n && cmake -DCMAKE_INSTALL_PREFIX:PATH=${EPLUS_INSTALL} -DCMAKE_PREFIX_PATH=${FNCS_INSTALL} -DBUILD_FORTRAN=ON -DBUILD_PACKAGE=ON -DENABLE_INSTALL_REMOTE=OFF ${SOURCE_DIR}/${EPLUS_SOURCE} \\\n && make -j 4 \\\n && make install \\\n && /bin/rm -r ${SOURCE_DIR}/${EPLUS_SOURCE} \\\n && cd ${SOURCE_DIR}/${EPLUSJSON_SOURCE} \\\n && autoheader \\\n && aclocal \\\n && automake --add-missing \\\n && autoreconf -if \\\n && ./configure --prefix=${EPLUSJSON_INSTALL} --with-fncs=${FNCS_INSTALL} \\\n && make \\\n && make install \\\n && /bin/rm -r ${SOURCE_DIR}/${EPLUSJSON_SOURCE} \\\n && /bin/rm -r ${SOURCE_DIR}\nFROM ${DOCKER_IMG}${DOCKER_IMG_VERSION} AS tesp-fncs-production\n#   -----------------------------------------------------\n#   Environment variables giving the location where TESP\n#   related software will be installed on the Docker container.\n#   -----------------------------------------------------\nENV TESP=\"${WORK_DIR}/tesp-platform\"\nENV FNCS_INSTALL=\"${TESP}/FNCSInstall\"\nENV GLD_INSTALL=\"${TESP}/GridLABDInstall\"\nENV EPLUS_INSTALL=\"${TESP}/EnergyPlusInstall\"\nENV EPLUSJSON_INSTALL=\"${TESP}/EPlusJSONInstall\"\n#   --------------------------------------------------------------\n#   Environment variables needed for the package installation\n#   --------------------------------------------------------------\nENV LD_LIBRARY_PATH=\"$LD_LIBRARY_PATH:${FNCS_INSTALL}/lib\"\nENV FNCS_LIBRARY=\"${FNCS_INSTALL}/lib\"\nENV FNCS_INCLUDE_DIR=\"${FNCS_INSTALL}/include\"\nENV PATH=\"${PATH}:${FNCS_INSTALL}/bin:${GLD_INSTALL}/bin:${EPLUS_INSTALL}:${EPLUS_INSTALL}/PreProcess:${EPLUS_INSTALL}/PostProcess:${EPLUSJSON_INSTALL}/bin\"\nENV GLPATH=\"${GLD_INSTALL}/lib/gridlabd:${GLD_INSTALL}/share/gridlabd\"\nCOPY --chown=tesp-user --from=tesp-fncs-builder ${WORK_DIR} ${WORK_DIR}\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"ARG DOCKER_IMG=laurmarinovici/tesp\nARG DOCKER_IMG_VERSION=:base\nFROM ${DOCKER_IMG}${DOCKER_IMG_VERSION} AS tesp-fncs-builder\n#  -----------------------------------------------------\n#  Environment variables giving the location where TESP\n#  related software will be installed on the Docker container.\n#  -----------------------------------------------------\nENV TESP=\"${WORK_DIR}/tesp-platform\"\nENV FNCS_INSTALL=\"${TESP}/FNCSInstall\"\nENV GLD_INSTALL=\"${TESP}/GridLABDInstall\"\nENV EPLUS_INSTALL=\"${TESP}/EnergyPlusInstall\"\nENV EPLUSJSON_INSTALL=\"${TESP}/EPlusJSONInstall\"\n#  ----------------------------------------------------\n#  Because I want to use the software versions I already have\n#  installed on the current VM, I am going to use\n#  directly the downloads and repositories I have, letting aside\n#  the commands that are performing the actual downloads, and \n#  repository cloning.\n#  Hence, from the context of the folder where I have all my downloads\n#  and clones, I only add the needed ones.\n#  I am running the image building script from inside the folder where\n#  all repositories have been already cloned in the source folders below.\n#  --------------------------------------------------------------\n#  FNCS branch = develop\nENV FNCS_SOURCE=\"fncs\"\n#  -------------------------------\n#  GridLAB-D branch = feature/1146\nENV GLD_SOURCE=\"gridlab-d\"\n#  -------------------------------\n#  Energy Plus branch = fncs-v8.3.0\nENV EPLUS_SOURCE=\"EnergyPlus\"\n#  EnergyPlusJSON copied from TESP sources to the context first\nENV EPLUSJSON_SOURCE=\"EnergyPlusJSON\"\n#  -------------------------------\n#  The folder on the image where all source files will be copied to,\n#  so that installation can proceed.\nENV SOURCE_DIR=\"${WORK_DIR}/sources/\"\n#  --------------------------------------------------------------\n#  Environment variables needed for the package installation\n#  --------------------------------------------------------------\nENV LD_LIBRARY_PATH=\"$LD_LIBRARY_PATH:${FNCS_INSTALL}/lib\"\nENV FNCS_LIBRARY=\"${FNCS_INSTALL}/lib\"\nENV FNCS_INCLUDE_DIR=\"${FNCS_INSTALL}/include\"\nENV PATH=\"${PATH}:${FNCS_INSTALL}/bin:${GLD_INSTALL}/bin:${EPLUS_INSTALL}:${EPLUS_INSTALL}/PreProcess:${EPLUS_INSTALL}/PostProcess:${EPLUSJSON_INSTALL}/bin\"\nENV GLPATH=\"${GLD_INSTALL}/lib/gridlabd:${GLD_INSTALL}/share/gridlabd\"\n#  default values\nENV FNCS_LOG_FILE=\"no\"\nENV FNCS_LOG_STDOUT=\"no\"\nENV FNCS_LOG_TRACE=\"no\"\nENV FNCS_LOG_LEVEL=\"DEBUG4\"\n#  ------------------------------------------------------------------\n#  Adding the host source folders to the Docker image source folders\n#  ------------------------------------------------------------------\nCOPY --chown=tesp-user:tesp-user ./ ${SOURCE_DIR}\nRUN mkdir -p ${SOURCE_DIR} \\\n && mkdir -p ${TESP} \\\n && cd ${SOURCE_DIR}/${FNCS_SOURCE} \\\n && autoreconf -if \\\n && ./configure --prefix=${FNCS_INSTALL} \\\n && make \\\n && make install \\\n && /bin/rm -r ${SOURCE_DIR}/${FNCS_SOURCE} \\\n && cd ${SOURCE_DIR}${GLD_SOURCE} \\\n && autoreconf -isf \\\n && ./configure --prefix=${GLD_INSTALL} --with-fncs=${FNCS_INSTALL} --enable-silent-rules 'CPP=gcc -E' 'CXXPP=g++ -E' 'CC=gcc' 'CXX=g++' 'CFLAGS=-w -O3 -fno-inline-functions' 'CXXFLAGS=-w -O3 -fno-inline-functions -std=c++14' 'LDFLAGS=-w -O3' \\\n && make \\\n && make install \\\n && /bin/rm -r ${SOURCE_DIR}${GLD_SOURCE} \\\n && cd ${SOURCE_DIR}/${EPLUS_SOURCE} \\\n && mkdir build \\\n && cd ./build \\\n && cmake -DCMAKE_INSTALL_PREFIX:PATH=${EPLUS_INSTALL} -DCMAKE_PREFIX_PATH=${FNCS_INSTALL} -DBUILD_FORTRAN=ON -DBUILD_PACKAGE=ON -DENABLE_INSTALL_REMOTE=OFF ${SOURCE_DIR}/${EPLUS_SOURCE} \\\n && make -j 4 \\\n && make install \\\n && /bin/rm -r ${SOURCE_DIR}/${EPLUS_SOURCE} \\\n && cd ${SOURCE_DIR}/${EPLUSJSON_SOURCE} \\\n && autoheader \\\n && aclocal \\\n && automake --add-missing \\\n && autoreconf -if \\\n && ./configure --prefix=${EPLUSJSON_INSTALL} --with-fncs=${FNCS_INSTALL} \\\n && make \\\n && make install \\\n && /bin/rm -r ${SOURCE_DIR}/${EPLUSJSON_SOURCE} \\\n && /bin/rm -r ${SOURCE_DIR}\nFROM ${DOCKER_IMG}${DOCKER_IMG_VERSION} AS tesp-fncs-production\n#  -----------------------------------------------------\n#  Environment variables giving the location where TESP\n#  related software will be installed on the Docker container.\n#  -----------------------------------------------------\nENV TESP=\"${WORK_DIR}/tesp-platform\"\nENV FNCS_INSTALL=\"${TESP}/FNCSInstall\"\nENV GLD_INSTALL=\"${TESP}/GridLABDInstall\"\nENV EPLUS_INSTALL=\"${TESP}/EnergyPlusInstall\"\nENV EPLUSJSON_INSTALL=\"${TESP}/EPlusJSONInstall\"\n#  --------------------------------------------------------------\n#  Environment variables needed for the package installation\n#  --------------------------------------------------------------\nENV LD_LIBRARY_PATH=\"$LD_LIBRARY_PATH:${FNCS_INSTALL}/lib\"\nENV FNCS_LIBRARY=\"${FNCS_INSTALL}/lib\"\nENV FNCS_INCLUDE_DIR=\"${FNCS_INSTALL}/include\"\nENV PATH=\"${PATH}:${FNCS_INSTALL}/bin:${GLD_INSTALL}/bin:${EPLUS_INSTALL}:${EPLUS_INSTALL}/PreProcess:${EPLUS_INSTALL}/PostProcess:${EPLUSJSON_INSTALL}/bin\"\nENV GLPATH=\"${GLD_INSTALL}/lib/gridlabd:${GLD_INSTALL}/share/gridlabd\"\nCOPY --chown=tesp-user --from=tesp-fncs-builder ${WORK_DIR} ${WORK_DIR}\n","injectedSmells":[],"originalDockerfileHash":"d344ba9f98374f9c36ded958a1e08676","successfullyInjectedSmells":[],"originalDockerfileUglified":"ARG DOCKER_IMG=laurmarinovici/tesp\nARG DOCKER_IMG_VERSION=:base\nFROM ${DOCKER_IMG}${DOCKER_IMG_VERSION} AS tesp-fncs-builder\n#   -----------------------------------------------------\n#   Environment variables giving the location where TESP\n#   related software will be installed on the Docker container.\n#   -----------------------------------------------------\nENV TESP=\"${WORK_DIR}/tesp-platform\"\nENV FNCS_INSTALL=\"${TESP}/FNCSInstall\"\nENV GLD_INSTALL=\"${TESP}/GridLABDInstall\"\nENV EPLUS_INSTALL=\"${TESP}/EnergyPlusInstall\"\nENV EPLUSJSON_INSTALL=\"${TESP}/EPlusJSONInstall\"\n#   ----------------------------------------------------\n#   Because I want to use the software versions I already have\n#   installed on the current VM, I am going to use\n#   directly the downloads and repositories I have, letting aside\n#   the commands that are performing the actual downloads, and \n#   repository cloning.\n#   Hence, from the context of the folder where I have all my downloads\n#   and clones, I only add the needed ones.\n#   I am running the image building script from inside the folder where\n#   all repositories have been already cloned in the source folders below.\n#   --------------------------------------------------------------\n#   FNCS branch = develop\nENV FNCS_SOURCE=\"fncs\"\n#   -------------------------------\n#   GridLAB-D branch = feature/1146\nENV GLD_SOURCE=\"gridlab-d\"\n#   -------------------------------\n#   Energy Plus branch = fncs-v8.3.0\nENV EPLUS_SOURCE=\"EnergyPlus\"\n#   EnergyPlusJSON copied from TESP sources to the context first\nENV EPLUSJSON_SOURCE=\"EnergyPlusJSON\"\n#   -------------------------------\n#   The folder on the image where all source files will be copied to,\n#   so that installation can proceed.\nENV SOURCE_DIR=\"${WORK_DIR}/sources/\"\n#   --------------------------------------------------------------\n#   Environment variables needed for the package installation\n#   --------------------------------------------------------------\nENV LD_LIBRARY_PATH=\"$LD_LIBRARY_PATH:${FNCS_INSTALL}/lib\"\nENV FNCS_LIBRARY=\"${FNCS_INSTALL}/lib\"\nENV FNCS_INCLUDE_DIR=\"${FNCS_INSTALL}/include\"\nENV PATH=\"${PATH}:${FNCS_INSTALL}/bin:${GLD_INSTALL}/bin:${EPLUS_INSTALL}:${EPLUS_INSTALL}/PreProcess:${EPLUS_INSTALL}/PostProcess:${EPLUSJSON_INSTALL}/bin\"\nENV GLPATH=\"${GLD_INSTALL}/lib/gridlabd:${GLD_INSTALL}/share/gridlabd\"\n#   default values\nENV FNCS_LOG_FILE=\"no\"\nENV FNCS_LOG_STDOUT=\"no\"\nENV FNCS_LOG_TRACE=\"no\"\nENV FNCS_LOG_LEVEL=\"DEBUG4\"\n#   ------------------------------------------------------------------\n#   Adding the host source folders to the Docker image source folders\n#   ------------------------------------------------------------------\nCOPY --chown=tesp-user:tesp-user ./ ${SOURCE_DIR}\nRUN mkdir -p ${SOURCE_DIR} \\\n && mkdir -p ${TESP} \\\n && cd ${SOURCE_DIR}/${FNCS_SOURCE} \\\n && autoreconf -if \\\n && ./configure --prefix=${FNCS_INSTALL} \\\n && make \\\n && make install \\\n && /bin/rm -r ${SOURCE_DIR}/${FNCS_SOURCE} \\\n && cd ${SOURCE_DIR}${GLD_SOURCE} \\\n && autoreconf -isf \\\n && ./configure --prefix=${GLD_INSTALL} --with-fncs=${FNCS_INSTALL} --enable-silent-rules 'CPP=gcc -E' 'CXXPP=g++ -E' 'CC=gcc' 'CXX=g++' 'CFLAGS=-w -O3 -fno-inline-functions' 'CXXFLAGS=-w -O3 -fno-inline-functions -std=c++14' 'LDFLAGS=-w -O3' \\\n && make \\\n && make install \\\n && /bin/rm -r ${SOURCE_DIR}${GLD_SOURCE} \\\n && cd ${SOURCE_DIR}/${EPLUS_SOURCE} \\\n && mkdir build \\\n && cd ./build \\\n && cmake -DCMAKE_INSTALL_PREFIX:PATH=${EPLUS_INSTALL} -DCMAKE_PREFIX_PATH=${FNCS_INSTALL} -DBUILD_FORTRAN=ON -DBUILD_PACKAGE=ON -DENABLE_INSTALL_REMOTE=OFF ${SOURCE_DIR}/${EPLUS_SOURCE} \\\n && make -j 4 \\\n && make install \\\n && /bin/rm -r ${SOURCE_DIR}/${EPLUS_SOURCE} \\\n && cd ${SOURCE_DIR}/${EPLUSJSON_SOURCE} \\\n && autoheader \\\n && aclocal \\\n && automake --add-missing \\\n && autoreconf -if \\\n && ./configure --prefix=${EPLUSJSON_INSTALL} --with-fncs=${FNCS_INSTALL} \\\n && make \\\n && make install \\\n && /bin/rm -r ${SOURCE_DIR}/${EPLUSJSON_SOURCE} \\\n && /bin/rm -r ${SOURCE_DIR}\nFROM ${DOCKER_IMG}${DOCKER_IMG_VERSION} AS tesp-fncs-production\n#   -----------------------------------------------------\n#   Environment variables giving the location where TESP\n#   related software will be installed on the Docker container.\n#   -----------------------------------------------------\nENV TESP=\"${WORK_DIR}/tesp-platform\"\nENV FNCS_INSTALL=\"${TESP}/FNCSInstall\"\nENV GLD_INSTALL=\"${TESP}/GridLABDInstall\"\nENV EPLUS_INSTALL=\"${TESP}/EnergyPlusInstall\"\nENV EPLUSJSON_INSTALL=\"${TESP}/EPlusJSONInstall\"\n#   --------------------------------------------------------------\n#   Environment variables needed for the package installation\n#   --------------------------------------------------------------\nENV LD_LIBRARY_PATH=\"$LD_LIBRARY_PATH:${FNCS_INSTALL}/lib\"\nENV FNCS_LIBRARY=\"${FNCS_INSTALL}/lib\"\nENV FNCS_INCLUDE_DIR=\"${FNCS_INSTALL}/include\"\nENV PATH=\"${PATH}:${FNCS_INSTALL}/bin:${GLD_INSTALL}/bin:${EPLUS_INSTALL}:${EPLUS_INSTALL}/PreProcess:${EPLUS_INSTALL}/PostProcess:${EPLUSJSON_INSTALL}/bin\"\nENV GLPATH=\"${GLD_INSTALL}/lib/gridlabd:${GLD_INSTALL}/share/gridlabd\"\nCOPY --chown=tesp-user --from=tesp-fncs-builder ${WORK_DIR} ${WORK_DIR}\n","originalDockerfileUglifiedHash":"af6d732576ef997820eb74e54f84f79e","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/788166be360271116fecc3f07c8e227f7a1de68d.dockerfile"}