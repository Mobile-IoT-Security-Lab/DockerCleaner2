{"seed":2988543102,"processedDockerfileHash":"7f410388559a27844ebd302f0598c3be","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM centos:latest\nMAINTAINER \"The CentOS Project\" <admin@jiobxn.com>\nARG LATEST=\"0\"\nARG php_v=\"7.0\"\n#  7.0\\7.1\\7.2\nRUN cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\nRUN yum clean all ; yum -y install epel-release ; yum -y update \\\n && yum -y install net-tools bash-completion vim wget strace make gcc-c++ autoconf iptables bzip2 unzip bzip2-devel mingw64-win-iconv libmcrypt-devel libxml2-devel libcurl-devel libpng-devel libc-client-devel krb5-devel libicu-devel libjpeg libjpeg-devel libXpm-devel freetype-devel gmp-devel readline-devel net-snmp-devel libtidy-devel libgcrypt-devel gd-devel gdbm-devel libxslt-devel mhash-devel openldap-devel libacl-devel enchant-devel libwebp-devel libedit-devel libmemcached-devel \\\n && yum clean all\nRUN cd /usr/local/src \\\n && PHP_VERSION=\"$( curl -s http://php.net/downloads.php | egrep php-${mysql_v}.*.tar.gz | awk -F/ '{print $3}' ;)\" \\\n && wget -c http://php.net/distributions/${PHP_VERSION} \\\n && wget -c https://github.com/phpredis/phpredis/archive/php7.zip \\\n && wget -c \"https://github.com$( curl -s https://github.com/php-memcached-dev/php-memcached/releases | grep tar.gz | awk -F\\\" 'NR==1{print $2}' ;)\"\nRUN cd /usr/local/src \\\n && tar zxf php-*.tar.gz \\\n && unzip php7.zip \\\n && tar zxf v*.tar.gz \\\n && cd /usr/local/src/php-* \\\n && ./configure --prefix=/usr/local/php --with-config-file-path=/usr/local/php/etc --with-pdo-mysql --with-mysqli --with-iconv-dir=/usr --with-mcrypt=/usr --with-libdir=lib64 --with-mhash --with-curl --with-xmlrpc --with-gettext --with-imap-ssl --with-imap --with-pear --with-gd --with-kerberos --with-pcre-regex --with-snmp --with-gmp --with-openssl --with-zlib --with-pcre-dir --with-libxml-dir --with-png-dir --with-freetype-dir --with-icu-dir=/usr --with-jpeg-dir --with-xpm-dir --with-readline --with-ldap-sasl --with-ldap --with-tidy --with-xsl --with-gdbm --with-bz2 --with-fpm-acl --with-enchant --with-webp-dir --with-pcre-jit --with-libedit --with-system-ciphers --enable-zend-signals --enable-calendar --enable-opcache --enable-exif --enable-intl --enable-mysqlnd --enable-dba --enable-fpm --enable-xml --enable-ftp --enable-zip --enable-soap --enable-shmop --enable-wddx --enable-pcntl --enable-bcmath --enable-sockets --enable-sysvsem --enable-sysvmsg --enable-sysvshm --enable-mbregex --enable-mbstring --enable-session --enable-embedded-mysqli --enable-gd-native-ttf --enable-inline-optimization \\\n && make -j8 \\\n && make install \\\n && cp /usr/local/src/php-*/php.ini-development /usr/local/php/etc/php.ini \\\n && ln -s /usr/local/php/bin/* /usr/local/bin/ \\\n && ln -s /usr/local/php/sbin/* /usr/local/bin/ \\\n && cd /usr/local/src/phpredis-php7 \\\n && phpize \\\n && ./configure \\\n && make -j8 \\\n && make install \\\n && sed -i '876 i extension=redis.so' /usr/local/php/etc/php.ini \\\n && cd /usr/local/src/php-memcached-* \\\n && phpize \\\n && ./configure \\\n && make -j8 \\\n && make install \\\n && sed -i '877 i extension=memcached.so' /usr/local/php/etc/php.ini \\\n && cp /usr/local/php/etc/php-fpm.conf.default /usr/local/php/etc/php-fpm.conf \\\n && cp /usr/local/php/etc/php-fpm.d/www.conf.default /usr/local/php/etc/php-fpm.d/www.conf \\\n && sed -i 's/listen = 127.0.0.1:9000/listen = [::]:9000/' /usr/local/php/etc/php-fpm.d/www.conf \\\n && sed -i 's/;daemonize = yes/daemonize = no/' /usr/local/php/etc/php-fpm.conf \\\n && sed -i 's/;date.timezone =/date.timezone = PRC/' /usr/local/php/etc/php.ini \\\n && rm -rf /usr/local/src/*\nVOLUME /var/www\nCOPY php.sh /php.sh\nRUN chmod +x /php.sh\nENTRYPOINT [\"/php.sh\"]\nEXPOSE 9000/tcp\nCMD [\"php-fpm\"]\n#   docker build -t php:7 .\n#   docker run -d --restart always -p 9000:9000 -v /docker/www:/var/www --hostname php --name php php:7\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM centos:latest\nMAINTAINER \"The CentOS Project\" <admin@jiobxn.com>\nARG LATEST=\"0\"\nARG php_v=\"7.0\"\n# 7.0\\7.1\\7.2\nRUN cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\nRUN yum clean all ; yum -y install epel-release ; yum -y update \\\n && yum -y install net-tools bash-completion vim wget strace make gcc-c++ autoconf iptables bzip2 unzip bzip2-devel mingw64-win-iconv libmcrypt-devel libxml2-devel libcurl-devel libpng-devel libc-client-devel krb5-devel libicu-devel libjpeg libjpeg-devel libXpm-devel freetype-devel gmp-devel readline-devel net-snmp-devel libtidy-devel libgcrypt-devel gd-devel gdbm-devel libxslt-devel mhash-devel openldap-devel libacl-devel enchant-devel libwebp-devel libedit-devel libmemcached-devel \\\n && yum clean all\nRUN cd /usr/local/src \\\n && PHP_VERSION=\"$( curl -s http://php.net/downloads.php | egrep php-${mysql_v}.*.tar.gz | awk -F/ '{print $3}' ;)\" \\\n && wget -c http://php.net/distributions/${PHP_VERSION} \\\n && wget -c https://github.com/phpredis/phpredis/archive/php7.zip \\\n && wget -c \"https://github.com$( curl -s https://github.com/php-memcached-dev/php-memcached/releases | grep tar.gz | awk -F\\\" 'NR==1{print $2}' ;)\"\nRUN cd /usr/local/src \\\n && tar zxf php-*.tar.gz \\\n && unzip php7.zip \\\n && tar zxf v*.tar.gz \\\n && cd /usr/local/src/php-* \\\n && ./configure --prefix=/usr/local/php --with-config-file-path=/usr/local/php/etc --with-pdo-mysql --with-mysqli --with-iconv-dir=/usr --with-mcrypt=/usr --with-libdir=lib64 --with-mhash --with-curl --with-xmlrpc --with-gettext --with-imap-ssl --with-imap --with-pear --with-gd --with-kerberos --with-pcre-regex --with-snmp --with-gmp --with-openssl --with-zlib --with-pcre-dir --with-libxml-dir --with-png-dir --with-freetype-dir --with-icu-dir=/usr --with-jpeg-dir --with-xpm-dir --with-readline --with-ldap-sasl --with-ldap --with-tidy --with-xsl --with-gdbm --with-bz2 --with-fpm-acl --with-enchant --with-webp-dir --with-pcre-jit --with-libedit --with-system-ciphers --enable-zend-signals --enable-calendar --enable-opcache --enable-exif --enable-intl --enable-mysqlnd --enable-dba --enable-fpm --enable-xml --enable-ftp --enable-zip --enable-soap --enable-shmop --enable-wddx --enable-pcntl --enable-bcmath --enable-sockets --enable-sysvsem --enable-sysvmsg --enable-sysvshm --enable-mbregex --enable-mbstring --enable-session --enable-embedded-mysqli --enable-gd-native-ttf --enable-inline-optimization \\\n && make -j8 \\\n && make install \\\n && cp /usr/local/src/php-*/php.ini-development /usr/local/php/etc/php.ini \\\n && ln -s /usr/local/php/bin/* /usr/local/bin/ \\\n && ln -s /usr/local/php/sbin/* /usr/local/bin/ \\\n && cd /usr/local/src/phpredis-php7 \\\n && phpize \\\n && ./configure \\\n && make -j8 \\\n && make install \\\n && sed -i '876 i extension=redis.so' /usr/local/php/etc/php.ini \\\n && cd /usr/local/src/php-memcached-* \\\n && phpize \\\n && ./configure \\\n && make -j8 \\\n && make install \\\n && sed -i '877 i extension=memcached.so' /usr/local/php/etc/php.ini \\\n && cp /usr/local/php/etc/php-fpm.conf.default /usr/local/php/etc/php-fpm.conf \\\n && cp /usr/local/php/etc/php-fpm.d/www.conf.default /usr/local/php/etc/php-fpm.d/www.conf \\\n && sed -i 's/listen = 127.0.0.1:9000/listen = [::]:9000/' /usr/local/php/etc/php-fpm.d/www.conf \\\n && sed -i 's/;daemonize = yes/daemonize = no/' /usr/local/php/etc/php-fpm.conf \\\n && sed -i 's/;date.timezone =/date.timezone = PRC/' /usr/local/php/etc/php.ini \\\n && rm -rf /usr/local/src/*\nVOLUME /var/www\nCOPY php.sh /php.sh\nRUN chmod +x /php.sh\nENTRYPOINT [\"/php.sh\"]\nEXPOSE 9000/tcp\nCMD [\"php-fpm\"]\n#  docker build -t php:7 .\n#  docker run -d --restart always -p 9000:9000 -v /docker/www:/var/www --hostname php --name php php:7\n","injectedSmells":[],"originalDockerfileHash":"661ddc6564050cdbb734cfccb2218c7e","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM centos:latest\nMAINTAINER \"The CentOS Project\" <admin@jiobxn.com>\nARG LATEST=\"0\"\nARG php_v=\"7.0\"\n#  7.0\\7.1\\7.2\nRUN cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\nRUN yum clean all ; yum -y install epel-release ; yum -y update \\\n && yum -y install net-tools bash-completion vim wget strace make gcc-c++ autoconf iptables bzip2 unzip bzip2-devel mingw64-win-iconv libmcrypt-devel libxml2-devel libcurl-devel libpng-devel libc-client-devel krb5-devel libicu-devel libjpeg libjpeg-devel libXpm-devel freetype-devel gmp-devel readline-devel net-snmp-devel libtidy-devel libgcrypt-devel gd-devel gdbm-devel libxslt-devel mhash-devel openldap-devel libacl-devel enchant-devel libwebp-devel libedit-devel libmemcached-devel \\\n && yum clean all\nRUN cd /usr/local/src \\\n && PHP_VERSION=\"$( curl -s http://php.net/downloads.php | egrep php-${mysql_v}.*.tar.gz | awk -F/ '{print $3}' ;)\" \\\n && wget -c http://php.net/distributions/${PHP_VERSION} \\\n && wget -c https://github.com/phpredis/phpredis/archive/php7.zip \\\n && wget -c \"https://github.com$( curl -s https://github.com/php-memcached-dev/php-memcached/releases | grep tar.gz | awk -F\\\" 'NR==1{print $2}' ;)\"\nRUN cd /usr/local/src \\\n && tar zxf php-*.tar.gz \\\n && unzip php7.zip \\\n && tar zxf v*.tar.gz \\\n && cd /usr/local/src/php-* \\\n && ./configure --prefix=/usr/local/php --with-config-file-path=/usr/local/php/etc --with-pdo-mysql --with-mysqli --with-iconv-dir=/usr --with-mcrypt=/usr --with-libdir=lib64 --with-mhash --with-curl --with-xmlrpc --with-gettext --with-imap-ssl --with-imap --with-pear --with-gd --with-kerberos --with-pcre-regex --with-snmp --with-gmp --with-openssl --with-zlib --with-pcre-dir --with-libxml-dir --with-png-dir --with-freetype-dir --with-icu-dir=/usr --with-jpeg-dir --with-xpm-dir --with-readline --with-ldap-sasl --with-ldap --with-tidy --with-xsl --with-gdbm --with-bz2 --with-fpm-acl --with-enchant --with-webp-dir --with-pcre-jit --with-libedit --with-system-ciphers --enable-zend-signals --enable-calendar --enable-opcache --enable-exif --enable-intl --enable-mysqlnd --enable-dba --enable-fpm --enable-xml --enable-ftp --enable-zip --enable-soap --enable-shmop --enable-wddx --enable-pcntl --enable-bcmath --enable-sockets --enable-sysvsem --enable-sysvmsg --enable-sysvshm --enable-mbregex --enable-mbstring --enable-session --enable-embedded-mysqli --enable-gd-native-ttf --enable-inline-optimization \\\n && make -j8 \\\n && make install \\\n && cp /usr/local/src/php-*/php.ini-development /usr/local/php/etc/php.ini \\\n && ln -s /usr/local/php/bin/* /usr/local/bin/ \\\n && ln -s /usr/local/php/sbin/* /usr/local/bin/ \\\n && cd /usr/local/src/phpredis-php7 \\\n && phpize \\\n && ./configure \\\n && make -j8 \\\n && make install \\\n && sed -i '876 i extension=redis.so' /usr/local/php/etc/php.ini \\\n && cd /usr/local/src/php-memcached-* \\\n && phpize \\\n && ./configure \\\n && make -j8 \\\n && make install \\\n && sed -i '877 i extension=memcached.so' /usr/local/php/etc/php.ini \\\n && cp /usr/local/php/etc/php-fpm.conf.default /usr/local/php/etc/php-fpm.conf \\\n && cp /usr/local/php/etc/php-fpm.d/www.conf.default /usr/local/php/etc/php-fpm.d/www.conf \\\n && sed -i 's/listen = 127.0.0.1:9000/listen = [::]:9000/' /usr/local/php/etc/php-fpm.d/www.conf \\\n && sed -i 's/;daemonize = yes/daemonize = no/' /usr/local/php/etc/php-fpm.conf \\\n && sed -i 's/;date.timezone =/date.timezone = PRC/' /usr/local/php/etc/php.ini \\\n && rm -rf /usr/local/src/*\nVOLUME /var/www\nCOPY php.sh /php.sh\nRUN chmod +x /php.sh\nENTRYPOINT [\"/php.sh\"]\nEXPOSE 9000/tcp\nCMD [\"php-fpm\"]\n#   docker build -t php:7 .\n#   docker run -d --restart always -p 9000:9000 -v /docker/www:/var/www --hostname php --name php php:7\n","originalDockerfileUglifiedHash":"d092bab7ca23dd8619e772b1eec830f7","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/74e0af940cf0552b9204278b428f85761fb27756.dockerfile"}