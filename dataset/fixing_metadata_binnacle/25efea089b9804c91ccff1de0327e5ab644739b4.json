{"seed":4093031129,"processedDockerfileHash":"4ec2db6c244c057cec065b6d8f9831b7","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM benchflow/base-images:dns-envconsul-java8_dev\nMAINTAINER Vincenzo FERME <info@vincenzoferme.it>\nENV JAVA_HOME=\"/usr/lib/jvm/java8\"\nENV FABAN_DRIVERS_MAKER_VERSION=\"v-dev\"\nENV RELEASE_VERSION=\"v-dev\"\nENV FABAN_VERSION=\"dev\"\nENV FABAN_ROOT=\"/app/\"\nENV FABAN_HOME=\"${FABAN_ROOT}faban\"\nENV CLIENT_VERSION=\"v-dev\"\nENV SUT_LIBRARIES_VERSION=\"v-dev\"\nENV SUT_PLUGINS_VERSION=\"v-dev\"\nENV GENERATION_RESOURCES_ROOT=\"/app/drivers\"\nENV LIBRARIES_ROOT=\"${GENERATION_RESOURCES_ROOT}/libraries\"\nENV PLUGINS_ROOT=\"${GENERATION_RESOURCES_ROOT}/plugins\"\nENV TEMPLATES_ROOT=\"${GENERATION_RESOURCES_ROOT}/templates\"\nENV BENCHFLOW_SERVICES_ROOT=\"/app/benchflow-services\"\nENV BENCHFLOW_COLLECTORS_ROOT=\"${BENCHFLOW_SERVICES_ROOT}/collectors\"\nENV BENCHFLOW_MONITORS_ROOT=\"${BENCHFLOW_SERVICES_ROOT}/monitors\"\n#   Get benchflow-drivers-maker\nRUN wget -q --no-check-certificate -O /app/benchflow-drivers-maker.jar https://github.com/benchflow/drivers-maker/releases/download/$FABAN_DRIVERS_MAKER_VERSION/benchflow-drivers-maker.jar\nCOPY configuration.yml /app/\n#   copy driver skeleton\nCOPY ./application/src/main/resources/app/drivers/templates /app/drivers/templates/\n#   copy cloud.benchflow.driversmaker.generation package classes\nCOPY ./application/src/main/java/cloud/benchflow/driversmaker/generation /app/application/src/main/java/cloud/benchflow/driversmaker/generation/\n#   Get benchflow-drivers-maker dependencies\nRUN apk add wget tar --update \\\n && wget -q --no-check-certificate -O /tmp/faban.tar.gz https://github.com/benchflow/faban/releases/download/${RELEASE_VERSION}/faban-kit-${FABAN_VERSION}.tar.gz \\\n && mkdir -p ${FABAN_ROOT}/ \\\n && tar -xzvf /tmp/faban.tar.gz -C ${FABAN_ROOT}/ \\\n && mkdir -p ${FABAN_HOME}/master/webapps/faban \\\n && cd ${FABAN_HOME}/master/webapps/faban \\\n && JAVA=`readlink -f $( which java ;) | sed 's|/bin/java$||' ` \\\n && $JAVA/bin/jar xvf ../faban.war \\\n && rm -f ${FABAN_HOME}/*.* \\\n && rm -rf ${FABAN_HOME}/benchmarks ${FABAN_HOME}/bin ${FABAN_HOME}/config ${FABAN_HOME}/legal ${FABAN_HOME}/logs ${FABAN_HOME}/output ${FABAN_HOME}/resources ${FABAN_HOME}/samples ${FABAN_HOME}/services \\\n && find ${FABAN_HOME}/master/ -not -path \"/app/faban/master/\" -not -path \"${FABAN_HOME}/master/webapps\" -not -path \"${FABAN_HOME}/master/webapps/faban\" -not -path \"${FABAN_HOME}/master/webapps/faban/WEB-INF\" -not -path \"${FABAN_HOME}/master/webapps/faban/WEB-INF/classes*\" | xargs rm -rf \\\n && mkdir -p ${LIBRARIES_ROOT} \\\n && wget -q --no-check-certificate -O - https://github.com/benchflow/sut-libraries/archive/$SUT_LIBRARIES_VERSION.tar.gz | tar xz --strip-components=1 -C ${LIBRARIES_ROOT} sut-libraries-$SUT_LIBRARIES_VERSION \\\n && mkdir -p ${PLUGINS_ROOT} \\\n && wget -q --no-check-certificate -O - https://github.com/benchflow/sut-plugins/archive/$SUT_PLUGINS_VERSION.tar.gz | tar xz --strip-components=1 -C ${PLUGINS_ROOT} sut-plugins-$SUT_PLUGINS_VERSION \\\n && wget -q --no-check-certificate -O ${TEMPLATES_ROOT}/skeleton/benchmark/lib/benchflow-monitors-driver-library.jar http://github.com/simonedavico/monitors/releases/download/${RELEASE_VERSION}/benchflow-monitors-driver-library.jar \\\n && cp ${TEMPLATES_ROOT}/skeleton/benchmark/lib/benchflow-monitors-driver-library.jar ${TEMPLATES_ROOT}/skeleton/benchmark/build/lib/ \\\n && mkdir -p /tmp/monitors-deployment-descriptors \\\n && mkdir -p ${BENCHFLOW_MONITORS_ROOT} \\\n && wget -q --no-check-certificate -O /tmp/monitors-deployment-descriptors/v-dev.tar.gz https://github.com/benchflow/monitors/archive/v-dev.tar.gz \\\n && tar -xzf /tmp/monitors-deployment-descriptors/v-dev.tar.gz -C /tmp/monitors-deployment-descriptors/ --wildcards --no-anchored '*.monitor.yml' \\\n && find /tmp/monitors-deployment-descriptors/ -name '*.monitor.yml' -type f -exec mv -i {} ${BENCHFLOW_MONITORS_ROOT}\n#   Install Ant (Source: https://hub.docker.com/r/webratio/ant/~/dockerfile/)\nENV ANT_VERSION=\"1.9.4\"\nRUN mkdir -p /opt/ant \\\n && wget -q --no-check-certificate -O /apache-ant-${ANT_VERSION}-bin.tar.gz http://archive.apache.org/dist/ant/binaries/apache-ant-${ANT_VERSION}-bin.tar.gz \\\n && tar -xzf /apache-ant-${ANT_VERSION}-bin.tar.gz \\\n && mv /apache-ant-${ANT_VERSION} /opt/ant \\\n && rm /apache-ant-${ANT_VERSION}-bin.tar.gz \\\n && apk del --purge wget\nENV ANT_HOME=\"/opt/ant\"\nENV PATH=\"${PATH}:/opt/ant/bin\"\nCOPY ./services/envcp/config.tpl /app/config.tpl\nCOPY ./services/envcp/add_servers_info.sh /app/add_servers_info.sh\nRUN chmod +x /app/add_servers_info.sh\nCOPY ./services/300-drivers-maker.conf /apps/chaperone.d/300-drivers-maker.conf\nEXPOSE 8080/tcp\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM benchflow/base-images:dns-envconsul-java8_dev\nMAINTAINER Vincenzo FERME <info@vincenzoferme.it>\nENV JAVA_HOME=\"/usr/lib/jvm/java8\"\nENV FABAN_DRIVERS_MAKER_VERSION=\"v-dev\"\nENV RELEASE_VERSION=\"v-dev\"\nENV FABAN_VERSION=\"dev\"\nENV FABAN_ROOT=\"/app/\"\nENV FABAN_HOME=\"${FABAN_ROOT}faban\"\nENV CLIENT_VERSION=\"v-dev\"\nENV SUT_LIBRARIES_VERSION=\"v-dev\"\nENV SUT_PLUGINS_VERSION=\"v-dev\"\nENV GENERATION_RESOURCES_ROOT=\"/app/drivers\"\nENV LIBRARIES_ROOT=\"${GENERATION_RESOURCES_ROOT}/libraries\"\nENV PLUGINS_ROOT=\"${GENERATION_RESOURCES_ROOT}/plugins\"\nENV TEMPLATES_ROOT=\"${GENERATION_RESOURCES_ROOT}/templates\"\nENV BENCHFLOW_SERVICES_ROOT=\"/app/benchflow-services\"\nENV BENCHFLOW_COLLECTORS_ROOT=\"${BENCHFLOW_SERVICES_ROOT}/collectors\"\nENV BENCHFLOW_MONITORS_ROOT=\"${BENCHFLOW_SERVICES_ROOT}/monitors\"\n#  Get benchflow-drivers-maker\nRUN wget -q --no-check-certificate -O /app/benchflow-drivers-maker.jar https://github.com/benchflow/drivers-maker/releases/download/$FABAN_DRIVERS_MAKER_VERSION/benchflow-drivers-maker.jar\nCOPY configuration.yml /app/\n#  copy driver skeleton\nCOPY ./application/src/main/resources/app/drivers/templates /app/drivers/templates/\n#  copy cloud.benchflow.driversmaker.generation package classes\nCOPY ./application/src/main/java/cloud/benchflow/driversmaker/generation /app/application/src/main/java/cloud/benchflow/driversmaker/generation/\n#  Get benchflow-drivers-maker dependencies\nRUN apk --update add wget tar \\\n && wget -q --no-check-certificate -O /tmp/faban.tar.gz https://github.com/benchflow/faban/releases/download/${RELEASE_VERSION}/faban-kit-${FABAN_VERSION}.tar.gz \\\n && mkdir -p ${FABAN_ROOT}/ \\\n && tar -xzvf /tmp/faban.tar.gz -C ${FABAN_ROOT}/ \\\n && mkdir -p ${FABAN_HOME}/master/webapps/faban \\\n && cd ${FABAN_HOME}/master/webapps/faban \\\n && JAVA=`readlink -f $( which java ;) | sed 's|/bin/java$||' ` \\\n && $JAVA/bin/jar xvf ../faban.war \\\n && rm -f ${FABAN_HOME}/*.* \\\n && rm -rf ${FABAN_HOME}/benchmarks ${FABAN_HOME}/bin ${FABAN_HOME}/config ${FABAN_HOME}/legal ${FABAN_HOME}/logs ${FABAN_HOME}/output ${FABAN_HOME}/resources ${FABAN_HOME}/samples ${FABAN_HOME}/services \\\n && find ${FABAN_HOME}/master/ -not -path \"/app/faban/master/\" -not -path \"${FABAN_HOME}/master/webapps\" -not -path \"${FABAN_HOME}/master/webapps/faban\" -not -path \"${FABAN_HOME}/master/webapps/faban/WEB-INF\" -not -path \"${FABAN_HOME}/master/webapps/faban/WEB-INF/classes*\" | xargs rm -rf \\\n && mkdir -p ${LIBRARIES_ROOT} \\\n && wget -q --no-check-certificate -O - https://github.com/benchflow/sut-libraries/archive/$SUT_LIBRARIES_VERSION.tar.gz | tar xz --strip-components=1 -C ${LIBRARIES_ROOT} sut-libraries-$SUT_LIBRARIES_VERSION \\\n && mkdir -p ${PLUGINS_ROOT} \\\n && wget -q --no-check-certificate -O - https://github.com/benchflow/sut-plugins/archive/$SUT_PLUGINS_VERSION.tar.gz | tar xz --strip-components=1 -C ${PLUGINS_ROOT} sut-plugins-$SUT_PLUGINS_VERSION \\\n && wget -q --no-check-certificate -O ${TEMPLATES_ROOT}/skeleton/benchmark/lib/benchflow-monitors-driver-library.jar http://github.com/simonedavico/monitors/releases/download/${RELEASE_VERSION}/benchflow-monitors-driver-library.jar \\\n && cp ${TEMPLATES_ROOT}/skeleton/benchmark/lib/benchflow-monitors-driver-library.jar ${TEMPLATES_ROOT}/skeleton/benchmark/build/lib/ \\\n && mkdir -p /tmp/monitors-deployment-descriptors \\\n && mkdir -p ${BENCHFLOW_MONITORS_ROOT} \\\n && wget -q --no-check-certificate -O /tmp/monitors-deployment-descriptors/v-dev.tar.gz https://github.com/benchflow/monitors/archive/v-dev.tar.gz \\\n && tar -xzf /tmp/monitors-deployment-descriptors/v-dev.tar.gz -C /tmp/monitors-deployment-descriptors/ --wildcards --no-anchored '*.monitor.yml' \\\n && find /tmp/monitors-deployment-descriptors/ -name '*.monitor.yml' -type f -exec mv -i {} ${BENCHFLOW_MONITORS_ROOT} ; \\\n && rm -rf /tmp/monitors-deployment-descriptors/ \\\n && mkdir -p /tmp/collectors-deployment-descriptors \\\n && mkdir -p ${BENCHFLOW_COLLECTORS_ROOT} \\\n && wget -q --no-check-certificate -O /tmp/collectors-deployment-descriptors/v-dev.tar.gz https://github.com/benchflow/collectors/archive/v-dev.tar.gz \\\n && tar -xzf /tmp/collectors-deployment-descriptors/v-dev.tar.gz -C /tmp/collectors-deployment-descriptors/ --wildcards --no-anchored '*.collector.yml' \\\n && find /tmp/collectors-deployment-descriptors/ -name '*.collector.yml' -type f -exec mv -i {} ${BENCHFLOW_COLLECTORS_ROOT} ; \\\n && rm -rf /tmp/collectors-deployment-descriptors/ \\\n && apk del --purge tar \\\n && rm -rf /var/cache/apk/* /tmp/* /var/tmp/* *.gz\n#  Install Ant (Source: https://hub.docker.com/r/webratio/ant/~/dockerfile/)\nENV ANT_VERSION=\"1.9.4\"\nRUN mkdir -p /opt/ant \\\n && wget -q --no-check-certificate -O /apache-ant-${ANT_VERSION}-bin.tar.gz http://archive.apache.org/dist/ant/binaries/apache-ant-${ANT_VERSION}-bin.tar.gz \\\n && tar -xzf /apache-ant-${ANT_VERSION}-bin.tar.gz \\\n && mv /apache-ant-${ANT_VERSION} /opt/ant \\\n && rm /apache-ant-${ANT_VERSION}-bin.tar.gz \\\n && apk del --purge wget\nENV ANT_HOME=\"/opt/ant\"\nENV PATH=\"${PATH}:/opt/ant/bin\"\nCOPY ./services/envcp/config.tpl /app/config.tpl\nCOPY ./services/envcp/add_servers_info.sh /app/add_servers_info.sh\nRUN chmod +x /app/add_servers_info.sh\nCOPY ./services/300-drivers-maker.conf /apps/chaperone.d/300-drivers-maker.conf\nEXPOSE 8080/tcp\n","injectedSmells":[],"originalDockerfileHash":"6eac1267cf399f7b1294788cf3f6b2d9","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM benchflow/base-images:dns-envconsul-java8_dev\nMAINTAINER Vincenzo FERME <info@vincenzoferme.it>\nENV JAVA_HOME=\"/usr/lib/jvm/java8\"\nENV FABAN_DRIVERS_MAKER_VERSION=\"v-dev\"\nENV RELEASE_VERSION=\"v-dev\"\nENV FABAN_VERSION=\"dev\"\nENV FABAN_ROOT=\"/app/\"\nENV FABAN_HOME=\"${FABAN_ROOT}faban\"\nENV CLIENT_VERSION=\"v-dev\"\nENV SUT_LIBRARIES_VERSION=\"v-dev\"\nENV SUT_PLUGINS_VERSION=\"v-dev\"\nENV GENERATION_RESOURCES_ROOT=\"/app/drivers\"\nENV LIBRARIES_ROOT=\"${GENERATION_RESOURCES_ROOT}/libraries\"\nENV PLUGINS_ROOT=\"${GENERATION_RESOURCES_ROOT}/plugins\"\nENV TEMPLATES_ROOT=\"${GENERATION_RESOURCES_ROOT}/templates\"\nENV BENCHFLOW_SERVICES_ROOT=\"/app/benchflow-services\"\nENV BENCHFLOW_COLLECTORS_ROOT=\"${BENCHFLOW_SERVICES_ROOT}/collectors\"\nENV BENCHFLOW_MONITORS_ROOT=\"${BENCHFLOW_SERVICES_ROOT}/monitors\"\n#   Get benchflow-drivers-maker\nRUN wget -q --no-check-certificate -O /app/benchflow-drivers-maker.jar https://github.com/benchflow/drivers-maker/releases/download/$FABAN_DRIVERS_MAKER_VERSION/benchflow-drivers-maker.jar\nCOPY configuration.yml /app/\n#   copy driver skeleton\nCOPY ./application/src/main/resources/app/drivers/templates /app/drivers/templates/\n#   copy cloud.benchflow.driversmaker.generation package classes\nCOPY ./application/src/main/java/cloud/benchflow/driversmaker/generation /app/application/src/main/java/cloud/benchflow/driversmaker/generation/\n#   Get benchflow-drivers-maker dependencies\nRUN apk --update add wget tar \\\n && wget -q --no-check-certificate -O /tmp/faban.tar.gz https://github.com/benchflow/faban/releases/download/${RELEASE_VERSION}/faban-kit-${FABAN_VERSION}.tar.gz \\\n && mkdir -p ${FABAN_ROOT}/ \\\n && tar -xzvf /tmp/faban.tar.gz -C ${FABAN_ROOT}/ \\\n && mkdir -p ${FABAN_HOME}/master/webapps/faban \\\n && cd ${FABAN_HOME}/master/webapps/faban \\\n && JAVA=`readlink -f $( which java ;) | sed 's|/bin/java$||' ` \\\n && $JAVA/bin/jar xvf ../faban.war \\\n && rm -f ${FABAN_HOME}/*.* \\\n && rm -rf ${FABAN_HOME}/benchmarks ${FABAN_HOME}/bin ${FABAN_HOME}/config ${FABAN_HOME}/legal ${FABAN_HOME}/logs ${FABAN_HOME}/output ${FABAN_HOME}/resources ${FABAN_HOME}/samples ${FABAN_HOME}/services \\\n && find ${FABAN_HOME}/master/ -not -path \"/app/faban/master/\" -not -path \"${FABAN_HOME}/master/webapps\" -not -path \"${FABAN_HOME}/master/webapps/faban\" -not -path \"${FABAN_HOME}/master/webapps/faban/WEB-INF\" -not -path \"${FABAN_HOME}/master/webapps/faban/WEB-INF/classes*\" | xargs rm -rf \\\n && mkdir -p ${LIBRARIES_ROOT} \\\n && wget -q --no-check-certificate -O - https://github.com/benchflow/sut-libraries/archive/$SUT_LIBRARIES_VERSION.tar.gz | tar xz --strip-components=1 -C ${LIBRARIES_ROOT} sut-libraries-$SUT_LIBRARIES_VERSION \\\n && mkdir -p ${PLUGINS_ROOT} \\\n && wget -q --no-check-certificate -O - https://github.com/benchflow/sut-plugins/archive/$SUT_PLUGINS_VERSION.tar.gz | tar xz --strip-components=1 -C ${PLUGINS_ROOT} sut-plugins-$SUT_PLUGINS_VERSION \\\n && wget -q --no-check-certificate -O ${TEMPLATES_ROOT}/skeleton/benchmark/lib/benchflow-monitors-driver-library.jar http://github.com/simonedavico/monitors/releases/download/${RELEASE_VERSION}/benchflow-monitors-driver-library.jar \\\n && cp ${TEMPLATES_ROOT}/skeleton/benchmark/lib/benchflow-monitors-driver-library.jar ${TEMPLATES_ROOT}/skeleton/benchmark/build/lib/ \\\n && mkdir -p /tmp/monitors-deployment-descriptors \\\n && mkdir -p ${BENCHFLOW_MONITORS_ROOT} \\\n && wget -q --no-check-certificate -O /tmp/monitors-deployment-descriptors/v-dev.tar.gz https://github.com/benchflow/monitors/archive/v-dev.tar.gz \\\n && tar -xzf /tmp/monitors-deployment-descriptors/v-dev.tar.gz -C /tmp/monitors-deployment-descriptors/ --wildcards --no-anchored '*.monitor.yml' \\\n && find /tmp/monitors-deployment-descriptors/ -name '*.monitor.yml' -type f -exec mv -i {} ${BENCHFLOW_MONITORS_ROOT}\n#   Install Ant (Source: https://hub.docker.com/r/webratio/ant/~/dockerfile/)\nENV ANT_VERSION=\"1.9.4\"\nRUN mkdir -p /opt/ant \\\n && wget -q --no-check-certificate -O /apache-ant-${ANT_VERSION}-bin.tar.gz http://archive.apache.org/dist/ant/binaries/apache-ant-${ANT_VERSION}-bin.tar.gz \\\n && tar -xzf /apache-ant-${ANT_VERSION}-bin.tar.gz \\\n && mv /apache-ant-${ANT_VERSION} /opt/ant \\\n && rm /apache-ant-${ANT_VERSION}-bin.tar.gz \\\n && apk del --purge wget\nENV ANT_HOME=\"/opt/ant\"\nENV PATH=\"${PATH}:/opt/ant/bin\"\nCOPY ./services/envcp/config.tpl /app/config.tpl\nCOPY ./services/envcp/add_servers_info.sh /app/add_servers_info.sh\nRUN chmod +x /app/add_servers_info.sh\nCOPY ./services/300-drivers-maker.conf /apps/chaperone.d/300-drivers-maker.conf\nEXPOSE 8080/tcp\n","originalDockerfileUglifiedHash":"fb9f070be58c8b854f14a7acfd05f407","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/25efea089b9804c91ccff1de0327e5ab644739b4.dockerfile"}