{"seed":4119960021,"processedDockerfileHash":"b66f96fee7d7b981568499f31178a6db","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apt-get","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM funkygibbon/ubuntu\nEXPOSE 80/tcp\nEXPOSE 443/tcp\n#   http://nginx.org/en/download.html\nENV NGINX_VERSION=\"1.13.12\"\n#   https://github.com/apache/incubator-pagespeed-ngx/releases\nENV NGINX_PAGESPEED_VERSION=\"latest\"\nENV NGINX_PAGESPEED_RELEASE_STATUS=\"stable\"\n#   Releases after 1.11.33.4 there will be a PSOL_BINARY_URL file that tells us where to look, until then this is hardcoded\n#  ENV PAGESPEED_PSOL_VERSION 1.11.33.4\n#   https://github.com/openresty/headers-more-nginx-module/tags\nENV HEADERS_MORE_VERSION=\"0.32\"\n#   https://www.openssl.org/source\nENV OPENSSL_VERSION=\"1.1.0g\"\nCOPY ./bin/download_pagespeed.sh /app/bin/download_pagespeed.sh\nRUN chmod 750 /app/bin/*.sh \\\n && useradd -r -s /usr/sbin/nologin nginx \\\n && mkdir -p /var/log/nginx /var/cache/nginx \\\n && apt-get update \\\n && apt-get install --no-install-recommends wget=1.21.3-1ubuntu1 git-core autoconf=2.71-3 automake=1:1.16.5-1.3 libtool=2.4.7-5 build-essential=12.9ubuntu3 zlib1g-dev=1:1.2.13.dfsg-1ubuntu4 libpcre3-dev=2:8.39-15 libxslt1-dev=1.1.35-1 libxml2-dev=2.9.14+dfsg-1.1build2 libgd2-xpm-dev libgeoip-dev=1.6.12-10 libgoogle-perftools-dev=2.9.1-0ubuntu3 libperl-dev=5.36.0-7 uuid-dev=2.38.1-4ubuntu1 -y \\\n && echo \"Downloading nginx ${NGINX_VERSION} from http://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz ...\" \\\n && wget -O - http://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz --progress=bar --tries=3 | tar zxf - -C /tmp \\\n && echo \"Downloading headers-more ${HEADERS_MORE_VERSION} from https://github.com/openresty/headers-more-nginx-module/archive/v${HEADERS_MORE_VERSION}.tar.gz ...\" \\\n && wget -O - https://github.com/openresty/headers-more-nginx-module/archive/v${HEADERS_MORE_VERSION}.tar.gz --progress=bar --tries=3 | tar zxf - -C /tmp \\\n && /app/bin/download_pagespeed.sh \\\n && echo \"Downloading openssl v${OPENSSL_VERSION} from https://www.openssl.org/source/openssl-${OPENSSL_VERSION}.tar.gz ...\" \\\n && wget -O - https://www.openssl.org/source/openssl-${OPENSSL_VERSION}.tar.gz --progress=bar --tries=3 | tar xzf - -C /tmp \\\n && cd /tmp/nginx-${NGINX_VERSION} \\\n && ./configure --prefix=/etc/nginx --sbin-path=/usr/sbin/nginx --conf-path=/etc/nginx/nginx.conf --error-log-path=/var/log/nginx/error.log --http-log-path=/var/log/nginx/access.log --pid-path=/var/run/nginx.pid --lock-path=/var/run/nginx.lock --http-client-body-temp-path=/var/cache/nginx/client_temp --http-proxy-temp-path=/var/cache/nginx/proxy_temp --http-fastcgi-temp-path=/var/cache/nginx/fastcgi_temp --http-uwsgi-temp-path=/var/cache/nginx/uwsgi_temp --http-scgi-temp-path=/var/cache/nginx/scgi_temp --user=nginx --group=nginx --with-http_ssl_module --with-http_realip_module --with-http_addition_module --with-http_sub_module --with-http_dav_module --with-http_flv_module --with-http_mp4_module --with-http_gunzip_module --with-http_gzip_static_module --with-http_random_index_module --with-http_secure_link_module --with-http_stub_status_module --with-http_auth_request_module --without-http_autoindex_module --without-http_ssi_module --with-threads --with-stream --with-stream_ssl_module --with-mail --with-mail_ssl_module --with-file-aio --with-http_v2_module --with-cc-opt='-g -O2 -fstack-protector --param=ssp-buffer-size=4 -Wformat -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2' --with-ld-opt='-Wl,-Bsymbolic-functions -Wl,-z,relro -Wl,--as-needed' --with-ipv6 --with-pcre-jit --with-openssl=/tmp/openssl-${OPENSSL_VERSION} --add-module=/tmp/headers-more-nginx-module-${HEADERS_MORE_VERSION} --add-module=/tmp/incubator-pagespeed-ngx-${NGINX_PAGESPEED_VERSION}-${NGINX_PAGESPEED_RELEASE_STATUS} \\\n && make \\\n && make install \\\n && apt-get purge -yqq automake autoconf libtool git-core build-essential zlib1g-dev libpcre3-dev libxslt1-dev libxml2-dev libgd2-xpm-dev libgeoip-dev libgoogle-perftools-dev libperl-dev \\\n && apt-get autoremove -yqq \\\n && apt-get clean \\\n && rm -Rf /tmp/* /var/tmp/* /var/lib/apt/lists/*\nENV DEFAULT_APP_USER=\"app\"\nENV DEFAULT_APP_GROUP=\"app\"\nENV DEFAULT_APP_UID=\"1000\"\nENV DEFAULT_APP_GID=\"1000\"\nENV DEFAULT_CHOWN_APP_DIR=\"true\"\nENV DEFAULT_UPLOAD_MAX_SIZE=\"30M\"\nENV DEFAULT_NGINX_MAX_WORKER_PROCESSES=\"8\"\nENV DEFAULT_PAGESPEED_REBEACON_KEY=\"uwuudeL7iedoo7Meengi\"\nENV SSL_ENABLED=\"true\"\nCOPY . /app\nRUN chmod 750 /app/bin/*.sh \\\n && sync \\\n && /app/bin/init_nginx.sh\nCMD [\"/sbin/my_init\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM funkygibbon/ubuntu\nEXPOSE 80/tcp\nEXPOSE 443/tcp\n#  http://nginx.org/en/download.html\nENV NGINX_VERSION=\"1.13.12\"\n#  https://github.com/apache/incubator-pagespeed-ngx/releases\nENV NGINX_PAGESPEED_VERSION=\"latest\"\nENV NGINX_PAGESPEED_RELEASE_STATUS=\"stable\"\n#  Releases after 1.11.33.4 there will be a PSOL_BINARY_URL file that tells us where to look, until then this is hardcoded\n# ENV PAGESPEED_PSOL_VERSION 1.11.33.4\n#  https://github.com/openresty/headers-more-nginx-module/tags\nENV HEADERS_MORE_VERSION=\"0.32\"\n#  https://www.openssl.org/source\nENV OPENSSL_VERSION=\"1.1.0g\"\nCOPY ./bin/download_pagespeed.sh /app/bin/download_pagespeed.sh\nRUN chmod 750 /app/bin/*.sh \\\n && useradd -r -s /usr/sbin/nologin nginx \\\n && mkdir -p /var/log/nginx /var/cache/nginx \\\n && apt-get update \\\n && apt-get install --no-install-recommends wget git-core autoconf automake libtool build-essential zlib1g-dev libpcre3-dev libxslt1-dev libxml2-dev libgd2-xpm-dev libgeoip-dev libgoogle-perftools-dev libperl-dev uuid-dev -y \\\n && echo \"Downloading nginx ${NGINX_VERSION} from http://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz ...\" \\\n && wget -O - http://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz --progress=bar --tries=3 | tar zxf - -C /tmp \\\n && echo \"Downloading headers-more ${HEADERS_MORE_VERSION} from https://github.com/openresty/headers-more-nginx-module/archive/v${HEADERS_MORE_VERSION}.tar.gz ...\" \\\n && wget -O - https://github.com/openresty/headers-more-nginx-module/archive/v${HEADERS_MORE_VERSION}.tar.gz --progress=bar --tries=3 | tar zxf - -C /tmp \\\n && /app/bin/download_pagespeed.sh \\\n && echo \"Downloading openssl v${OPENSSL_VERSION} from https://www.openssl.org/source/openssl-${OPENSSL_VERSION}.tar.gz ...\" \\\n && wget -O - https://www.openssl.org/source/openssl-${OPENSSL_VERSION}.tar.gz --progress=bar --tries=3 | tar xzf - -C /tmp \\\n && cd /tmp/nginx-${NGINX_VERSION} \\\n && ./configure --prefix=/etc/nginx --sbin-path=/usr/sbin/nginx --conf-path=/etc/nginx/nginx.conf --error-log-path=/var/log/nginx/error.log --http-log-path=/var/log/nginx/access.log --pid-path=/var/run/nginx.pid --lock-path=/var/run/nginx.lock --http-client-body-temp-path=/var/cache/nginx/client_temp --http-proxy-temp-path=/var/cache/nginx/proxy_temp --http-fastcgi-temp-path=/var/cache/nginx/fastcgi_temp --http-uwsgi-temp-path=/var/cache/nginx/uwsgi_temp --http-scgi-temp-path=/var/cache/nginx/scgi_temp --user=nginx --group=nginx --with-http_ssl_module --with-http_realip_module --with-http_addition_module --with-http_sub_module --with-http_dav_module --with-http_flv_module --with-http_mp4_module --with-http_gunzip_module --with-http_gzip_static_module --with-http_random_index_module --with-http_secure_link_module --with-http_stub_status_module --with-http_auth_request_module --without-http_autoindex_module --without-http_ssi_module --with-threads --with-stream --with-stream_ssl_module --with-mail --with-mail_ssl_module --with-file-aio --with-http_v2_module --with-cc-opt='-g -O2 -fstack-protector --param=ssp-buffer-size=4 -Wformat -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2' --with-ld-opt='-Wl,-Bsymbolic-functions -Wl,-z,relro -Wl,--as-needed' --with-ipv6 --with-pcre-jit --with-openssl=/tmp/openssl-${OPENSSL_VERSION} --add-module=/tmp/headers-more-nginx-module-${HEADERS_MORE_VERSION} --add-module=/tmp/incubator-pagespeed-ngx-${NGINX_PAGESPEED_VERSION}-${NGINX_PAGESPEED_RELEASE_STATUS} \\\n && make \\\n && make install \\\n && apt-get purge -yqq automake autoconf libtool git-core build-essential zlib1g-dev libpcre3-dev libxslt1-dev libxml2-dev libgd2-xpm-dev libgeoip-dev libgoogle-perftools-dev libperl-dev \\\n && apt-get autoremove -yqq \\\n && apt-get clean \\\n && rm -Rf /tmp/* /var/tmp/* /var/lib/apt/lists/*\nENV DEFAULT_APP_USER=\"app\"\nENV DEFAULT_APP_GROUP=\"app\"\nENV DEFAULT_APP_UID=\"1000\"\nENV DEFAULT_APP_GID=\"1000\"\nENV DEFAULT_CHOWN_APP_DIR=\"true\"\nENV DEFAULT_UPLOAD_MAX_SIZE=\"30M\"\nENV DEFAULT_NGINX_MAX_WORKER_PROCESSES=\"8\"\nENV DEFAULT_PAGESPEED_REBEACON_KEY=\"uwuudeL7iedoo7Meengi\"\nENV SSL_ENABLED=\"true\"\nCOPY . /app\nRUN chmod 750 /app/bin/*.sh \\\n && sync \\\n && /app/bin/init_nginx.sh\nCMD [\"/sbin/my_init\"]\n","injectedSmells":[],"originalDockerfileHash":"8d710b461a51fe0fd82c5528f59199d5","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM funkygibbon/ubuntu\nEXPOSE 80/tcp\nEXPOSE 443/tcp\n#   http://nginx.org/en/download.html\nENV NGINX_VERSION=\"1.13.12\"\n#   https://github.com/apache/incubator-pagespeed-ngx/releases\nENV NGINX_PAGESPEED_VERSION=\"latest\"\nENV NGINX_PAGESPEED_RELEASE_STATUS=\"stable\"\n#   Releases after 1.11.33.4 there will be a PSOL_BINARY_URL file that tells us where to look, until then this is hardcoded\n#  ENV PAGESPEED_PSOL_VERSION 1.11.33.4\n#   https://github.com/openresty/headers-more-nginx-module/tags\nENV HEADERS_MORE_VERSION=\"0.32\"\n#   https://www.openssl.org/source\nENV OPENSSL_VERSION=\"1.1.0g\"\nCOPY ./bin/download_pagespeed.sh /app/bin/download_pagespeed.sh\nRUN chmod 750 /app/bin/*.sh \\\n && useradd -r -s /usr/sbin/nologin nginx \\\n && mkdir -p /var/log/nginx /var/cache/nginx \\\n && apt-get update \\\n && apt-get install --no-install-recommends wget git-core autoconf automake libtool build-essential zlib1g-dev libpcre3-dev libxslt1-dev libxml2-dev libgd2-xpm-dev libgeoip-dev libgoogle-perftools-dev libperl-dev uuid-dev -y \\\n && echo \"Downloading nginx ${NGINX_VERSION} from http://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz ...\" \\\n && wget -O - http://nginx.org/download/nginx-${NGINX_VERSION}.tar.gz --progress=bar --tries=3 | tar zxf - -C /tmp \\\n && echo \"Downloading headers-more ${HEADERS_MORE_VERSION} from https://github.com/openresty/headers-more-nginx-module/archive/v${HEADERS_MORE_VERSION}.tar.gz ...\" \\\n && wget -O - https://github.com/openresty/headers-more-nginx-module/archive/v${HEADERS_MORE_VERSION}.tar.gz --progress=bar --tries=3 | tar zxf - -C /tmp \\\n && /app/bin/download_pagespeed.sh \\\n && echo \"Downloading openssl v${OPENSSL_VERSION} from https://www.openssl.org/source/openssl-${OPENSSL_VERSION}.tar.gz ...\" \\\n && wget -O - https://www.openssl.org/source/openssl-${OPENSSL_VERSION}.tar.gz --progress=bar --tries=3 | tar xzf - -C /tmp \\\n && cd /tmp/nginx-${NGINX_VERSION} \\\n && ./configure --prefix=/etc/nginx --sbin-path=/usr/sbin/nginx --conf-path=/etc/nginx/nginx.conf --error-log-path=/var/log/nginx/error.log --http-log-path=/var/log/nginx/access.log --pid-path=/var/run/nginx.pid --lock-path=/var/run/nginx.lock --http-client-body-temp-path=/var/cache/nginx/client_temp --http-proxy-temp-path=/var/cache/nginx/proxy_temp --http-fastcgi-temp-path=/var/cache/nginx/fastcgi_temp --http-uwsgi-temp-path=/var/cache/nginx/uwsgi_temp --http-scgi-temp-path=/var/cache/nginx/scgi_temp --user=nginx --group=nginx --with-http_ssl_module --with-http_realip_module --with-http_addition_module --with-http_sub_module --with-http_dav_module --with-http_flv_module --with-http_mp4_module --with-http_gunzip_module --with-http_gzip_static_module --with-http_random_index_module --with-http_secure_link_module --with-http_stub_status_module --with-http_auth_request_module --without-http_autoindex_module --without-http_ssi_module --with-threads --with-stream --with-stream_ssl_module --with-mail --with-mail_ssl_module --with-file-aio --with-http_v2_module --with-cc-opt='-g -O2 -fstack-protector --param=ssp-buffer-size=4 -Wformat -Werror=format-security -Wp,-D_FORTIFY_SOURCE=2' --with-ld-opt='-Wl,-Bsymbolic-functions -Wl,-z,relro -Wl,--as-needed' --with-ipv6 --with-pcre-jit --with-openssl=/tmp/openssl-${OPENSSL_VERSION} --add-module=/tmp/headers-more-nginx-module-${HEADERS_MORE_VERSION} --add-module=/tmp/incubator-pagespeed-ngx-${NGINX_PAGESPEED_VERSION}-${NGINX_PAGESPEED_RELEASE_STATUS} \\\n && make \\\n && make install \\\n && apt-get purge -yqq automake autoconf libtool git-core build-essential zlib1g-dev libpcre3-dev libxslt1-dev libxml2-dev libgd2-xpm-dev libgeoip-dev libgoogle-perftools-dev libperl-dev \\\n && apt-get autoremove -yqq \\\n && apt-get clean \\\n && rm -Rf /tmp/* /var/tmp/* /var/lib/apt/lists/*\nENV DEFAULT_APP_USER=\"app\"\nENV DEFAULT_APP_GROUP=\"app\"\nENV DEFAULT_APP_UID=\"1000\"\nENV DEFAULT_APP_GID=\"1000\"\nENV DEFAULT_CHOWN_APP_DIR=\"true\"\nENV DEFAULT_UPLOAD_MAX_SIZE=\"30M\"\nENV DEFAULT_NGINX_MAX_WORKER_PROCESSES=\"8\"\nENV DEFAULT_PAGESPEED_REBEACON_KEY=\"uwuudeL7iedoo7Meengi\"\nENV SSL_ENABLED=\"true\"\nCOPY . /app\nRUN chmod 750 /app/bin/*.sh \\\n && sync \\\n && /app/bin/init_nginx.sh\nCMD [\"/sbin/my_init\"]\n","originalDockerfileUglifiedHash":"37e18e0e4c27ce4ec3215ec890bc9c10","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/f7105fb0ab62482643fef6f934bc1fa4ae4c4a8d.dockerfile"}