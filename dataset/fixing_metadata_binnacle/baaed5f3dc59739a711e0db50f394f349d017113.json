{"seed":3990891123,"processedDockerfileHash":"1b46b9aea14f8e9c8204012cd2b6d264","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-gem","pin-package-manager-versions-apk","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM alpine:3.8 AS build\nRUN apk add cmake=3.11.1-r2 boost-dev=1.66.0-r0 make=4.2.1-r2 curl=7.61.1-r3 git=2.18.4-r0 curl-dev=7.61.1-r3 ruby=2.5.8-r0 ruby-dev=2.5.8-r0 gcc=6.4.0-r9 g++=6.4.0-r9 yaml-cpp-dev=0.6.2-r1 jq=1.6_rc1-r1 openjdk8=8.275.01-r0 --no-cache\nENV JAVA_HOME=\"/usr/lib/jvm/java-1.8-openjdk\"\nENV PATH=\"$PATH:$JAVA_HOME/jre/bin:$JAVA_HOME/bin\"\nSHELL [\"/bin/ash\", \"-eo\", \"pipefail\", \"-c\"]\nRUN mkdir /workspace\nWORKDIR /workspace\nRUN sed -i -e 's/sys\\/poll/poll/' /usr/include/boost/asio/detail/socket_types.hpp\nCOPY configs/components/leatherman.json /workspace\nRUN git clone -b 1.5.x https://github.com/puppetlabs/leatherman \\\n && mkdir -p /workspace/leatherman/build\nWORKDIR /workspace/leatherman/build\nRUN git checkout \"$( jq .ref /workspace/leatherman.json | tr -d \\\" ;)\" \\\n && cmake .. -DBOOST_STATIC=OFF -DCMAKE_VERBOSE_MAKEFILE=ON ; make ; make install\nENV CMAKE_SHARED_OPTIONS=\"-DCMAKE_PREFIX_PATH=/opt/puppetlabs/puppet -DCMAKE_INSTALL_PREFIX=/opt/puppetlabs/puppet -DCMAKE_INSTALL_RPATH=/opt/puppetlabs/puppet/lib -DCMAKE_VERBOSE_MAKEFILE=ON\"\nWORKDIR /workspace\nCOPY configs/components/libwhereami.json /workspace\nRUN git clone https://github.com/puppetlabs/libwhereami \\\n && mkdir -p /workspace/libwhereami/build\nWORKDIR /workspace/libwhereami/build\nRUN git checkout \"$( jq .ref /workspace/libwhereami.json | tr -d \\\" ;)\"\nRUN cmake $CMAKE_SHARED_OPTIONS -DBOOST_STATIC=OFF .. ; make ; make install\nWORKDIR /workspace\nCOPY configs/components/cpp-hocon.json /workspace\nRUN git clone https://github.com/puppetlabs/cpp-hocon \\\n && mkdir -p /workspace/cpp-hocon/build\nWORKDIR /workspace/cpp-hocon/build\nRUN git checkout \"$( jq .ref /workspace/cpp-hocon.json | tr -d \\\" ;)\"\nRUN cmake $CMAKE_SHARED_OPTIONS -DBOOST_STATIC=OFF .. ; make ; make install\nWORKDIR /workspace\nCOPY configs/components/facter.json /workspace\nRUN git clone https://github.com/puppetlabs/facter \\\n && mkdir -p /workspace/facter/build\nWORKDIR /workspace/facter/build\nRUN git checkout \"$( jq .ref /workspace/facter.json | tr -d \\\" ;)\"\nRUN cmake /lib $CMAKE_SHARED_OPTIONS -DRUBY_LIB_INSTALL=/usr/lib/ruby/vendor_ruby .. ; make ; make install\nWORKDIR /workspace\nCOPY configs/components/cpp-pcp-client.json /workspace\nRUN git clone https://github.com/puppetlabs/cpp-pcp-client \\\n && mkdir -p /workspace/cpp-pcp-client/build\nWORKDIR /workspace/cpp-pcp-client/build\nRUN git checkout \"$( jq .ref /workspace/cpp-pcp-client.json | tr -d \\\" ;)\"\nRUN cmake .. $CMAKE_SHARED_OPTIONS ; make ; make install\nWORKDIR /workspace\nCOPY configs/components/pxp-agent.json /workspace\nRUN git clone https://github.com/puppetlabs/pxp-agent \\\n && mkdir -p /workspace/pxp-agent/build\nWORKDIR /workspace/pxp-agent/build\nRUN git checkout \"$( jq .ref /workspace/pxp-agent.json | tr -d \\\" ;)\"\nRUN cmake .. $CMAKE_SHARED_OPTIONS ; make ; make install\nRUN apk add augeas=1.10.1-r3 ruby-augeas=0.5.0-r4 libressl-dev=2.7.5-r0 --no-cache\nRUN gem install deep_merge --version 1.2.2 --no-rdoc --no-ri\nWORKDIR /workspace\nRUN curl -O -L https://people.redhat.com/~rjones/virt-what/files/virt-what-1.18.tar.gz \\\n && tar zxf virt-what-1.18.tar.gz\nWORKDIR /workspace/virt-what-1.18\nRUN ./configure \\\n && make \\\n && make install\nWORKDIR /workspace\nCOPY configs/components/hiera.json /workspace\nRUN git clone https://github.com/puppetlabs/hiera\nWORKDIR /workspace/hiera\nRUN git checkout \"$( jq .ref /workspace/hiera.json | tr -d \\\" ;)\"\nRUN ./install.rb --no-configs --bindir=/opt/puppetlabs/puppet/bin --sitelibdir=/usr/lib/ruby/vendor_ruby\nWORKDIR /workspace\nCOPY configs/components/puppet.json /workspace\nRUN git clone https://github.com/puppetlabs/puppet\nWORKDIR /workspace/puppet\nRUN git checkout \"$( jq .ref /workspace/puppet.json | tr -d \\\" ;)\"\nRUN ./install.rb --bindir=/opt/puppetlabs/puppet/bin --configdir=/etc/puppetlabs/puppet --sitelibdir=/usr/lib/ruby/vendor_ruby --codedir=/etc/puppetlabs/code --vardir=/opt/puppetlabs/puppet/cache --logdir=/var/log/puppetlabs/puppet --rundir=/var/run/puppetlabs --quick\nRUN mkdir -p /opt/puppetlabs/bin \\\n && ln -s /opt/puppetlabs/puppet/bin/facter /opt/puppetlabs/bin/facter \\\n && ln -s /opt/puppetlabs/puppet/bin/puppet /opt/puppetlabs/bin/puppet \\\n && ln -s /opt/puppetlabs/puppet/bin/hiera /opt/puppetlabs/bin/hiera\nENV PATH=\"/opt/puppetlabs/bin:$PATH\"\nRUN puppet config set confdir /etc/puppetlabs/puppet \\\n && puppet config set codedir /etc/puppetlabs/code \\\n && puppet config set vardir /opt/puppetlabs/puppet/cache \\\n && puppet config set logdir /var/log/puppetlabs/puppet \\\n && puppet config set rundir /var/run/puppetlabs\nRUN mkdir -p /etc/puppetlabs/code/environment/production \\\n && puppet module install puppetlabs-augeas_core \\\n && puppet module install puppetlabs-cron_core \\\n && puppet module install puppetlabs-host_core \\\n && puppet module install puppetlabs-mount_core \\\n && puppet module install puppetlabs-scheduled_task \\\n && puppet module install puppetlabs-selinux_core \\\n && puppet module install puppetlabs-sshkeys_core \\\n && puppet module install puppetlabs-yumrepo_core \\\n && puppet module install puppetlabs-zfs_core \\\n && puppet module install puppetlabs-zone_core \\\n && puppet module install puppetlabs-apk\nFROM alpine:3.8\nARG version=6.0.0\nARG vcs_ref\nARG build_date\nENV PUPPET_AGENT_VERSION=\"$version\"\nENV PATH=\"/opt/puppetlabs/bin:$PATH\"\nLABEL org.label-schema.maintainer=\"Puppet Release Team <release@puppet.com>\" \\\n      org.label-schema.vendor=\"Puppet\" \\\n      org.label-schema.url=\"https://github.com/puppetlabs/puppet-agent\" \\\n      org.label-schema.name=\"Puppet Agent (Alpine)\" \\\n      org.label-schema.license=\"Apache-2.0\" \\\n      org.label-schema.version=\"$PUPPET_AGENT_VERSION\" \\\n      org.label-schema.vcs-url=\"https://github.com/puppetlabs/puppet-agent\" \\\n      org.label-schema.vcs-ref=\"$vcs_ref\" \\\n      org.label-schema.build-date=\"$build_date\" \\\n      org.label-schema.schema-version=\"1.0\" \\\n      org.label-schema.dockerfile=\"/Dockerfile\"\nRUN apk add bash=4.4.19-r1 ruby=2.5.8-r0 bind-tools=9.12.4_p2-r0 curl=7.61.1-r3 shadow=4.5-r0 yaml-cpp=0.6.2-r1 ruby-json=2.5.8-r0 ruby-augeas=0.5.0-r4 boost-random=1.66.0-r0 boost-iostreams=1.66.0-r0 boost-graph=1.66.0-r0 boost-signals=1.66.0-r0 boost=1.66.0-r0 boost-serialization=1.66.0-r0 boost-program_options=1.66.0-r0 boost-system=1.66.0-r0 boost-unit_test_framework=1.66.0-r0 boost-math=1.66.0-r0 boost-doc=1.66.0-r0 boost-wserialization=1.66.0-r0 boost-date_time=1.66.0-r0 boost-wave=1.66.0-r0 boost-filesystem=1.66.0-r0 boost-prg_exec_monitor=1.66.0-r0 boost-regex=1.66.0-r0 boost-thread=1.66.0-r0 --no-cache\nCOPY --from=build /usr/lib/ruby/vendor_ruby /usr/lib/ruby/vendor_ruby\nCOPY --from=build /etc/puppetlabs /etc/puppetlabs\nCOPY --from=build /opt/puppetlabs /opt/puppetlabs\nCOPY --from=build /usr/lib/ruby/gems /usr/lib/ruby/gems\nCOPY --from=build /usr/lib/ruby/vendor_ruby /usr/lib/ruby/vendor_ruby\nENTRYPOINT [\"/opt/puppetlabs/bin/puppet\"]\nCMD [\"agent\", \"--verbose\", \"--onetime\", \"--no-daemonize\", \"--summarize\"]\nCOPY docker/puppet-agent-alpine/Dockerfile /\nRUN addgroup -S docker-user ; adduser -S -G docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM alpine:3.8 AS build\nRUN apk add --no-cache cmake boost-dev make curl git curl-dev ruby ruby-dev gcc g++ yaml-cpp-dev jq openjdk8\nENV JAVA_HOME=\"/usr/lib/jvm/java-1.8-openjdk\"\nENV PATH=\"$PATH:$JAVA_HOME/jre/bin:$JAVA_HOME/bin\"\nSHELL [\"/bin/ash\", \"-eo\", \"pipefail\", \"-c\"]\nRUN mkdir /workspace\nWORKDIR /workspace\nRUN sed -i -e 's/sys\\/poll/poll/' /usr/include/boost/asio/detail/socket_types.hpp\nCOPY configs/components/leatherman.json /workspace\nRUN git clone -b 1.5.x https://github.com/puppetlabs/leatherman \\\n && mkdir -p /workspace/leatherman/build\nWORKDIR /workspace/leatherman/build\nRUN git checkout \"$( jq .ref /workspace/leatherman.json | tr -d \\\" ;)\" \\\n && cmake .. -DBOOST_STATIC=OFF -DCMAKE_VERBOSE_MAKEFILE=ON ; make ; make install\nENV CMAKE_SHARED_OPTIONS=\"-DCMAKE_PREFIX_PATH=/opt/puppetlabs/puppet -DCMAKE_INSTALL_PREFIX=/opt/puppetlabs/puppet -DCMAKE_INSTALL_RPATH=/opt/puppetlabs/puppet/lib -DCMAKE_VERBOSE_MAKEFILE=ON\"\nWORKDIR /workspace\nCOPY configs/components/libwhereami.json /workspace\nRUN git clone https://github.com/puppetlabs/libwhereami \\\n && mkdir -p /workspace/libwhereami/build\nWORKDIR /workspace/libwhereami/build\nRUN git checkout \"$( jq .ref /workspace/libwhereami.json | tr -d \\\" ;)\"\nRUN cmake $CMAKE_SHARED_OPTIONS -DBOOST_STATIC=OFF .. ; make ; make install\nWORKDIR /workspace\nCOPY configs/components/cpp-hocon.json /workspace\nRUN git clone https://github.com/puppetlabs/cpp-hocon \\\n && mkdir -p /workspace/cpp-hocon/build\nWORKDIR /workspace/cpp-hocon/build\nRUN git checkout \"$( jq .ref /workspace/cpp-hocon.json | tr -d \\\" ;)\"\nRUN cmake $CMAKE_SHARED_OPTIONS -DBOOST_STATIC=OFF .. ; make ; make install\nWORKDIR /workspace\nCOPY configs/components/facter.json /workspace\nRUN git clone https://github.com/puppetlabs/facter \\\n && mkdir -p /workspace/facter/build\nWORKDIR /workspace/facter/build\nRUN git checkout \"$( jq .ref /workspace/facter.json | tr -d \\\" ;)\"\nRUN cmake /lib $CMAKE_SHARED_OPTIONS -DRUBY_LIB_INSTALL=/usr/lib/ruby/vendor_ruby .. ; make ; make install\nWORKDIR /workspace\nCOPY configs/components/cpp-pcp-client.json /workspace\nRUN git clone https://github.com/puppetlabs/cpp-pcp-client \\\n && mkdir -p /workspace/cpp-pcp-client/build\nWORKDIR /workspace/cpp-pcp-client/build\nRUN git checkout \"$( jq .ref /workspace/cpp-pcp-client.json | tr -d \\\" ;)\"\nRUN cmake .. $CMAKE_SHARED_OPTIONS ; make ; make install\nWORKDIR /workspace\nCOPY configs/components/pxp-agent.json /workspace\nRUN git clone https://github.com/puppetlabs/pxp-agent \\\n && mkdir -p /workspace/pxp-agent/build\nWORKDIR /workspace/pxp-agent/build\nRUN git checkout \"$( jq .ref /workspace/pxp-agent.json | tr -d \\\" ;)\"\nRUN cmake .. $CMAKE_SHARED_OPTIONS ; make ; make install\nRUN apk add --no-cache augeas ruby-augeas libressl-dev\nRUN gem install deep_merge --no-rdoc --no-ri\nWORKDIR /workspace\nRUN curl -O -L https://people.redhat.com/~rjones/virt-what/files/virt-what-1.18.tar.gz \\\n && tar zxf virt-what-1.18.tar.gz\nWORKDIR /workspace/virt-what-1.18\nRUN ./configure \\\n && make \\\n && make install\nWORKDIR /workspace\nCOPY configs/components/hiera.json /workspace\nRUN git clone https://github.com/puppetlabs/hiera\nWORKDIR /workspace/hiera\nRUN git checkout \"$( jq .ref /workspace/hiera.json | tr -d \\\" ;)\"\nRUN ./install.rb --no-configs --bindir=/opt/puppetlabs/puppet/bin --sitelibdir=/usr/lib/ruby/vendor_ruby\nWORKDIR /workspace\nCOPY configs/components/puppet.json /workspace\nRUN git clone https://github.com/puppetlabs/puppet\nWORKDIR /workspace/puppet\nRUN git checkout \"$( jq .ref /workspace/puppet.json | tr -d \\\" ;)\"\nRUN ./install.rb --bindir=/opt/puppetlabs/puppet/bin --configdir=/etc/puppetlabs/puppet --sitelibdir=/usr/lib/ruby/vendor_ruby --codedir=/etc/puppetlabs/code --vardir=/opt/puppetlabs/puppet/cache --logdir=/var/log/puppetlabs/puppet --rundir=/var/run/puppetlabs --quick\nRUN mkdir -p /opt/puppetlabs/bin \\\n && ln -s /opt/puppetlabs/puppet/bin/facter /opt/puppetlabs/bin/facter \\\n && ln -s /opt/puppetlabs/puppet/bin/puppet /opt/puppetlabs/bin/puppet \\\n && ln -s /opt/puppetlabs/puppet/bin/hiera /opt/puppetlabs/bin/hiera\nENV PATH=\"/opt/puppetlabs/bin:$PATH\"\nRUN puppet config set confdir /etc/puppetlabs/puppet \\\n && puppet config set codedir /etc/puppetlabs/code \\\n && puppet config set vardir /opt/puppetlabs/puppet/cache \\\n && puppet config set logdir /var/log/puppetlabs/puppet \\\n && puppet config set rundir /var/run/puppetlabs\nRUN mkdir -p /etc/puppetlabs/code/environment/production \\\n && puppet module install puppetlabs-augeas_core \\\n && puppet module install puppetlabs-cron_core \\\n && puppet module install puppetlabs-host_core \\\n && puppet module install puppetlabs-mount_core \\\n && puppet module install puppetlabs-scheduled_task \\\n && puppet module install puppetlabs-selinux_core \\\n && puppet module install puppetlabs-sshkeys_core \\\n && puppet module install puppetlabs-yumrepo_core \\\n && puppet module install puppetlabs-zfs_core \\\n && puppet module install puppetlabs-zone_core \\\n && puppet module install puppetlabs-apk\nFROM alpine:3.8\nARG version=6.0.0\nARG vcs_ref\nARG build_date\nENV PUPPET_AGENT_VERSION=\"$version\"\nENV PATH=\"/opt/puppetlabs/bin:$PATH\"\nLABEL org.label-schema.maintainer=\"Puppet Release Team <release@puppet.com>\" \\\n      org.label-schema.vendor=\"Puppet\" \\\n      org.label-schema.url=\"https://github.com/puppetlabs/puppet-agent\" \\\n      org.label-schema.name=\"Puppet Agent (Alpine)\" \\\n      org.label-schema.license=\"Apache-2.0\" \\\n      org.label-schema.version=\"$PUPPET_AGENT_VERSION\" \\\n      org.label-schema.vcs-url=\"https://github.com/puppetlabs/puppet-agent\" \\\n      org.label-schema.vcs-ref=\"$vcs_ref\" \\\n      org.label-schema.build-date=\"$build_date\" \\\n      org.label-schema.schema-version=\"1.0\" \\\n      org.label-schema.dockerfile=\"/Dockerfile\"\nRUN apk add --no-cache bash ruby bind-tools curl shadow yaml-cpp ruby-json ruby-augeas boost-random boost-iostreams boost-graph boost-signals boost boost-serialization boost-program_options boost-system boost-unit_test_framework boost-math boost-doc boost-wserialization boost-date_time boost-wave boost-filesystem boost-prg_exec_monitor boost-regex boost-thread\nCOPY --from=build /usr/lib/ruby/vendor_ruby /usr/lib/ruby/vendor_ruby\nCOPY --from=build /etc/puppetlabs /etc/puppetlabs\nCOPY --from=build /opt/puppetlabs /opt/puppetlabs\nCOPY --from=build /usr/lib/ruby/gems /usr/lib/ruby/gems\nCOPY --from=build /usr/lib/ruby/vendor_ruby /usr/lib/ruby/vendor_ruby\nENTRYPOINT [\"/opt/puppetlabs/bin/puppet\"]\nCMD [\"agent\", \"--verbose\", \"--onetime\", \"--no-daemonize\", \"--summarize\"]\nCOPY docker/puppet-agent-alpine/Dockerfile /\n","injectedSmells":[],"originalDockerfileHash":"e8c642a7e546eb9cd723d555ede02a73","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM alpine:3.8 AS build\nRUN apk add --no-cache cmake boost-dev make curl git curl-dev ruby ruby-dev gcc g++ yaml-cpp-dev jq openjdk8\nENV JAVA_HOME=\"/usr/lib/jvm/java-1.8-openjdk\"\nENV PATH=\"$PATH:$JAVA_HOME/jre/bin:$JAVA_HOME/bin\"\nSHELL [\"/bin/ash\", \"-eo\", \"pipefail\", \"-c\"]\nRUN mkdir /workspace\nWORKDIR /workspace\nRUN sed -i -e 's/sys\\/poll/poll/' /usr/include/boost/asio/detail/socket_types.hpp\nCOPY configs/components/leatherman.json /workspace\nRUN git clone -b 1.5.x https://github.com/puppetlabs/leatherman \\\n && mkdir -p /workspace/leatherman/build\nWORKDIR /workspace/leatherman/build\nRUN git checkout \"$( jq .ref /workspace/leatherman.json | tr -d \\\" ;)\" \\\n && cmake .. -DBOOST_STATIC=OFF -DCMAKE_VERBOSE_MAKEFILE=ON ; make ; make install\nENV CMAKE_SHARED_OPTIONS=\"-DCMAKE_PREFIX_PATH=/opt/puppetlabs/puppet -DCMAKE_INSTALL_PREFIX=/opt/puppetlabs/puppet -DCMAKE_INSTALL_RPATH=/opt/puppetlabs/puppet/lib -DCMAKE_VERBOSE_MAKEFILE=ON\"\nWORKDIR /workspace\nCOPY configs/components/libwhereami.json /workspace\nRUN git clone https://github.com/puppetlabs/libwhereami \\\n && mkdir -p /workspace/libwhereami/build\nWORKDIR /workspace/libwhereami/build\nRUN git checkout \"$( jq .ref /workspace/libwhereami.json | tr -d \\\" ;)\"\nRUN cmake $CMAKE_SHARED_OPTIONS -DBOOST_STATIC=OFF .. ; make ; make install\nWORKDIR /workspace\nCOPY configs/components/cpp-hocon.json /workspace\nRUN git clone https://github.com/puppetlabs/cpp-hocon \\\n && mkdir -p /workspace/cpp-hocon/build\nWORKDIR /workspace/cpp-hocon/build\nRUN git checkout \"$( jq .ref /workspace/cpp-hocon.json | tr -d \\\" ;)\"\nRUN cmake $CMAKE_SHARED_OPTIONS -DBOOST_STATIC=OFF .. ; make ; make install\nWORKDIR /workspace\nCOPY configs/components/facter.json /workspace\nRUN git clone https://github.com/puppetlabs/facter \\\n && mkdir -p /workspace/facter/build\nWORKDIR /workspace/facter/build\nRUN git checkout \"$( jq .ref /workspace/facter.json | tr -d \\\" ;)\"\nRUN cmake /lib $CMAKE_SHARED_OPTIONS -DRUBY_LIB_INSTALL=/usr/lib/ruby/vendor_ruby .. ; make ; make install\nWORKDIR /workspace\nCOPY configs/components/cpp-pcp-client.json /workspace\nRUN git clone https://github.com/puppetlabs/cpp-pcp-client \\\n && mkdir -p /workspace/cpp-pcp-client/build\nWORKDIR /workspace/cpp-pcp-client/build\nRUN git checkout \"$( jq .ref /workspace/cpp-pcp-client.json | tr -d \\\" ;)\"\nRUN cmake .. $CMAKE_SHARED_OPTIONS ; make ; make install\nWORKDIR /workspace\nCOPY configs/components/pxp-agent.json /workspace\nRUN git clone https://github.com/puppetlabs/pxp-agent \\\n && mkdir -p /workspace/pxp-agent/build\nWORKDIR /workspace/pxp-agent/build\nRUN git checkout \"$( jq .ref /workspace/pxp-agent.json | tr -d \\\" ;)\"\nRUN cmake .. $CMAKE_SHARED_OPTIONS ; make ; make install\nRUN apk add --no-cache augeas ruby-augeas libressl-dev\nRUN gem install deep_merge --no-rdoc --no-ri\nWORKDIR /workspace\nRUN curl -O -L https://people.redhat.com/~rjones/virt-what/files/virt-what-1.18.tar.gz \\\n && tar zxf virt-what-1.18.tar.gz\nWORKDIR /workspace/virt-what-1.18\nRUN ./configure \\\n && make \\\n && make install\nWORKDIR /workspace\nCOPY configs/components/hiera.json /workspace\nRUN git clone https://github.com/puppetlabs/hiera\nWORKDIR /workspace/hiera\nRUN git checkout \"$( jq .ref /workspace/hiera.json | tr -d \\\" ;)\"\nRUN ./install.rb --no-configs --bindir=/opt/puppetlabs/puppet/bin --sitelibdir=/usr/lib/ruby/vendor_ruby\nWORKDIR /workspace\nCOPY configs/components/puppet.json /workspace\nRUN git clone https://github.com/puppetlabs/puppet\nWORKDIR /workspace/puppet\nRUN git checkout \"$( jq .ref /workspace/puppet.json | tr -d \\\" ;)\"\nRUN ./install.rb --bindir=/opt/puppetlabs/puppet/bin --configdir=/etc/puppetlabs/puppet --sitelibdir=/usr/lib/ruby/vendor_ruby --codedir=/etc/puppetlabs/code --vardir=/opt/puppetlabs/puppet/cache --logdir=/var/log/puppetlabs/puppet --rundir=/var/run/puppetlabs --quick\nRUN mkdir -p /opt/puppetlabs/bin \\\n && ln -s /opt/puppetlabs/puppet/bin/facter /opt/puppetlabs/bin/facter \\\n && ln -s /opt/puppetlabs/puppet/bin/puppet /opt/puppetlabs/bin/puppet \\\n && ln -s /opt/puppetlabs/puppet/bin/hiera /opt/puppetlabs/bin/hiera\nENV PATH=\"/opt/puppetlabs/bin:$PATH\"\nRUN puppet config set confdir /etc/puppetlabs/puppet \\\n && puppet config set codedir /etc/puppetlabs/code \\\n && puppet config set vardir /opt/puppetlabs/puppet/cache \\\n && puppet config set logdir /var/log/puppetlabs/puppet \\\n && puppet config set rundir /var/run/puppetlabs\nRUN mkdir -p /etc/puppetlabs/code/environment/production \\\n && puppet module install puppetlabs-augeas_core \\\n && puppet module install puppetlabs-cron_core \\\n && puppet module install puppetlabs-host_core \\\n && puppet module install puppetlabs-mount_core \\\n && puppet module install puppetlabs-scheduled_task \\\n && puppet module install puppetlabs-selinux_core \\\n && puppet module install puppetlabs-sshkeys_core \\\n && puppet module install puppetlabs-yumrepo_core \\\n && puppet module install puppetlabs-zfs_core \\\n && puppet module install puppetlabs-zone_core \\\n && puppet module install puppetlabs-apk\nFROM alpine:3.8\nARG version=6.0.0\nARG vcs_ref\nARG build_date\nENV PUPPET_AGENT_VERSION=\"$version\"\nENV PATH=\"/opt/puppetlabs/bin:$PATH\"\nLABEL org.label-schema.maintainer=\"Puppet Release Team <release@puppet.com>\" \\\n      org.label-schema.vendor=\"Puppet\" \\\n      org.label-schema.url=\"https://github.com/puppetlabs/puppet-agent\" \\\n      org.label-schema.name=\"Puppet Agent (Alpine)\" \\\n      org.label-schema.license=\"Apache-2.0\" \\\n      org.label-schema.version=\"$PUPPET_AGENT_VERSION\" \\\n      org.label-schema.vcs-url=\"https://github.com/puppetlabs/puppet-agent\" \\\n      org.label-schema.vcs-ref=\"$vcs_ref\" \\\n      org.label-schema.build-date=\"$build_date\" \\\n      org.label-schema.schema-version=\"1.0\" \\\n      org.label-schema.dockerfile=\"/Dockerfile\"\nRUN apk add --no-cache bash ruby bind-tools curl shadow yaml-cpp ruby-json ruby-augeas boost-random boost-iostreams boost-graph boost-signals boost boost-serialization boost-program_options boost-system boost-unit_test_framework boost-math boost-doc boost-wserialization boost-date_time boost-wave boost-filesystem boost-prg_exec_monitor boost-regex boost-thread\nCOPY --from=build /usr/lib/ruby/vendor_ruby /usr/lib/ruby/vendor_ruby\nCOPY --from=build /etc/puppetlabs /etc/puppetlabs\nCOPY --from=build /opt/puppetlabs /opt/puppetlabs\nCOPY --from=build /usr/lib/ruby/gems /usr/lib/ruby/gems\nCOPY --from=build /usr/lib/ruby/vendor_ruby /usr/lib/ruby/vendor_ruby\nENTRYPOINT [\"/opt/puppetlabs/bin/puppet\"]\nCMD [\"agent\", \"--verbose\", \"--onetime\", \"--no-daemonize\", \"--summarize\"]\nCOPY docker/puppet-agent-alpine/Dockerfile /\n","originalDockerfileUglifiedHash":"e8c642a7e546eb9cd723d555ede02a73","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/baaed5f3dc59739a711e0db50f394f349d017113.dockerfile"}