{"seed":3230469756,"processedDockerfileHash":"b0bc6ac4c2a400d47cdfcf35d050051d","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apt-get","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM ubuntu:18.04\nRUN apt-get update -qq \\\n && apt-get upgrade -yq \\\n && apt-mark hold openjdk-11-jre-headless \\\n && apt-get install --no-install-recommends apt-transport-https=1.6.14 apt-utils=1.6.14 ca-certificates=20211016ubuntu0.18.04.1 curl=7.58.0-2ubuntu3.24 git-core gnupg=2.2.4-1ubuntu1.6 jq=1.5+dfsg-2 less=487-0.1 maven=3.6.0-1~18.04.1 openjdk-8-jdk-headless=8u362-ga-0ubuntu1~18.04.1 sudo=1.8.21p2-3ubuntu1.5 supervisor=3.3.1-1.1 wget=1.19.4-1ubuntu2.2 tar=1.29b-2ubuntu0.4 vim=2:8.0.1453-1ubuntu1.11 zookeeperd=3.4.10-3 -yq\n#\n#   Elasticsearch and Kibana\n#\nENV ES_VERSION=\"7.0.0\"\nRUN wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch | apt-key add -\nRUN echo \"deb https://artifacts.elastic.co/packages/7.x/apt stable main\" >> /etc/apt/sources.list.d/elasticsearch-7.x.list\nRUN apt-get update -qq \\\n && apt-get install --no-install-recommends elasticsearch=$ES_VERSION kibana=$ES_VERSION -yq\nRUN ln -s /usr/share/elasticsearch/bin/elasticsearch /usr/bin/elasticsearch\nRUN ln -s /usr/share/kibana/bin/kibana /usr/bin/kibana\nRUN chown -R kibana:kibana /usr/share/kibana/\nUSER root\n#   system configuration, see https://www.elastic.co/guide/en/elasticsearch/reference/current/deb.html\nCOPY etc/sysctl.d/60-elasticsearch.conf /etc/sysctl.d/60-elasticsearch.conf\nCOPY etc/supervisor/conf.d/elasticsearch.conf /etc/supervisor/conf.d/elasticsearch.conf\nCOPY etc/supervisor/conf.d/kibana.conf /etc/supervisor/conf.d/kibana.conf\nRUN chmod -R 644 /etc/sysctl.d/60-elasticsearch.conf /etc/supervisor/conf.d/*.conf\nENV ES_HEAP_SIZE=\"20g\"\n#   set Elasticsearch data path\nRUN sed -Ei 's@^path\\.data: .*@path.data: /data/elasticsearch@' /etc/elasticsearch/elasticsearch.yml\n#   TODO: enable updates via scripting\n#\n#   Apache Storm\n#\nENV STORM_VERSION=\"1.2.2\"\nCOPY downloads/apache-storm-$STORM_VERSION.tar.gz /tmp/apache-storm-$STORM_VERSION.tar.gz\nRUN tar -xzf /tmp/apache-storm-$STORM_VERSION.tar.gz -C /opt\nRUN rm /tmp/apache-storm-$STORM_VERSION.tar.gz\nENV STORM_HOME=\"/opt/apache-storm-$STORM_VERSION\"\nRUN groupadd storm \\\n && useradd --gid storm --home-dir /home/storm --create-home --shell /bin/bash storm \\\n && chown -R storm:storm $STORM_HOME \\\n && mkdir /var/log/storm \\\n && chown -R storm:storm /var/log/storm\nRUN ln -s /var/log/storm $STORM_HOME/logs\nRUN ln -s $STORM_HOME/bin/storm /usr/bin/storm\nCOPY etc/supervisor/conf.d/storm-*.conf /etc/supervisor/conf.d/\nCOPY etc/supervisor/conf.d/zookeeper.conf /etc/supervisor/conf.d/\nRUN chmod -R 644 /etc/supervisor/conf.d/*.conf\n#\n#   Storm crawler\n#\nRUN groupadd ubuntu \\\n && useradd --gid ubuntu --home-dir /home/ubuntu --create-home --shell /bin/bash ubuntu \\\n && chown -R ubuntu:ubuntu /home/ubuntu\nUSER ubuntu\nWORKDIR /home/ubuntu\nRUN mkdir news-crawler/ \\\n && mkdir news-crawler/conf/ \\\n && mkdir news-crawler/lib/ \\\n && mkdir news-crawler/bin/ \\\n && mkdir news-crawler/seeds/ \\\n && chmod -R a+rx news-crawler/\n#   add the news crawler uber-jar\nCOPY target/crawler-1.14.jar news-crawler/lib/crawler.jar\n#   and configuration files\nCOPY conf/*.* news-crawler/conf/\nCOPY seeds/*.txt news-crawler/seeds/\nCOPY bin/*.sh news-crawler/bin/\nCOPY bin/es_status news-crawler/bin/\nUSER root\nRUN chown -R ubuntu:ubuntu /home/ubuntu \\\n && chmod -R a+r /home/ubuntu \\\n && chmod u+x news-crawler/bin/*\n#   Ports:\n#    8080 - Storm UI\n#    9200 - Elasticsearch http\n#    9300 - Elasticsearch java\n#    5601 - Kibana\nEXPOSE 8080/tcp 9200/tcp 9300/tcp 5601/tcp\n#   volumes for persistent data\nUSER root\nRUN mkdir /data\nRUN mkdir /data/elasticsearch \\\n && chown elasticsearch:elasticsearch /data/elasticsearch\nVOLUME [\"/data/elasticsearch\"]\nRUN mkdir /data/warc \\\n && chown storm:storm /data/warc\nVOLUME [\"/data/warc\"]\n#   start all services\nCMD [\"/usr/bin/supervisord\"]\n#   launch the crawl\n#   CMD [\"/home/ubuntu/news-crawler/bin/run-crawler.sh\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM ubuntu:18.04\nRUN apt-get update -qq \\\n && apt-get upgrade -yq \\\n && apt-mark hold openjdk-11-jre-headless \\\n && apt-get install --no-install-recommends apt-transport-https apt-utils ca-certificates curl git-core gnupg jq less maven openjdk-8-jdk-headless sudo supervisor wget tar vim zookeeperd -yq\n#\n#  Elasticsearch and Kibana\n#\nENV ES_VERSION=\"7.0.0\"\nRUN wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch | apt-key add -\nRUN echo \"deb https://artifacts.elastic.co/packages/7.x/apt stable main\" >> /etc/apt/sources.list.d/elasticsearch-7.x.list\nRUN apt-get update -qq \\\n && apt-get install --no-install-recommends elasticsearch=$ES_VERSION kibana=$ES_VERSION -yq\nRUN ln -s /usr/share/elasticsearch/bin/elasticsearch /usr/bin/elasticsearch\nRUN ln -s /usr/share/kibana/bin/kibana /usr/bin/kibana\nRUN chown -R kibana:kibana /usr/share/kibana/\nUSER root\n#  system configuration, see https://www.elastic.co/guide/en/elasticsearch/reference/current/deb.html\nADD etc/sysctl.d/60-elasticsearch.conf /etc/sysctl.d/60-elasticsearch.conf\nADD etc/supervisor/conf.d/elasticsearch.conf /etc/supervisor/conf.d/elasticsearch.conf\nADD etc/supervisor/conf.d/kibana.conf /etc/supervisor/conf.d/kibana.conf\nRUN chmod -R 644 /etc/sysctl.d/60-elasticsearch.conf /etc/supervisor/conf.d/*.conf\nENV ES_HEAP_SIZE=\"20g\"\n#  set Elasticsearch data path\nRUN sed -Ei 's@^path\\.data: .*@path.data: /data/elasticsearch@' /etc/elasticsearch/elasticsearch.yml\n#  TODO: enable updates via scripting\n#\n#  Apache Storm\n#\nENV STORM_VERSION=\"1.2.2\"\nCOPY downloads/apache-storm-$STORM_VERSION.tar.gz /tmp/apache-storm-$STORM_VERSION.tar.gz\nRUN tar -xzf /tmp/apache-storm-$STORM_VERSION.tar.gz -C /opt\nRUN rm /tmp/apache-storm-$STORM_VERSION.tar.gz\nENV STORM_HOME=\"/opt/apache-storm-$STORM_VERSION\"\nRUN groupadd storm \\\n && useradd --gid storm --home-dir /home/storm --create-home --shell /bin/bash storm \\\n && chown -R storm:storm $STORM_HOME \\\n && mkdir /var/log/storm \\\n && chown -R storm:storm /var/log/storm\nRUN ln -s /var/log/storm $STORM_HOME/logs\nRUN ln -s $STORM_HOME/bin/storm /usr/bin/storm\nADD etc/supervisor/conf.d/storm-*.conf /etc/supervisor/conf.d/\nADD etc/supervisor/conf.d/zookeeper.conf /etc/supervisor/conf.d/\nRUN chmod -R 644 /etc/supervisor/conf.d/*.conf\n#\n#  Storm crawler\n#\nRUN groupadd ubuntu \\\n && useradd --gid ubuntu --home-dir /home/ubuntu --create-home --shell /bin/bash ubuntu \\\n && chown -R ubuntu:ubuntu /home/ubuntu\nUSER ubuntu\nWORKDIR /home/ubuntu\nRUN mkdir news-crawler/ \\\n && mkdir news-crawler/conf/ \\\n && mkdir news-crawler/lib/ \\\n && mkdir news-crawler/bin/ \\\n && mkdir news-crawler/seeds/ \\\n && chmod -R a+rx news-crawler/\n#  add the news crawler uber-jar\nADD target/crawler-1.14.jar news-crawler/lib/crawler.jar\n#  and configuration files\nADD conf/*.* news-crawler/conf/\nADD seeds/*.txt news-crawler/seeds/\nADD bin/*.sh news-crawler/bin/\nADD bin/es_status news-crawler/bin/\nUSER root\nRUN chown -R ubuntu:ubuntu /home/ubuntu \\\n && chmod -R a+r /home/ubuntu \\\n && chmod u+x news-crawler/bin/*\n#  Ports:\n#   8080 - Storm UI\n#   9200 - Elasticsearch http\n#   9300 - Elasticsearch java\n#   5601 - Kibana\nEXPOSE 8080/tcp 9200/tcp 9300/tcp 5601/tcp\n#  volumes for persistent data\nUSER root\nRUN mkdir /data\nRUN mkdir /data/elasticsearch \\\n && chown elasticsearch:elasticsearch /data/elasticsearch\nVOLUME [\"/data/elasticsearch\"]\nRUN mkdir /data/warc \\\n && chown storm:storm /data/warc\nVOLUME [\"/data/warc\"]\n#  start all services\nCMD [\"/usr/bin/supervisord\"]\n#  launch the crawl\n#  CMD [\"/home/ubuntu/news-crawler/bin/run-crawler.sh\"]\n","injectedSmells":[],"originalDockerfileHash":"6f8c016fd43d648d224bfdbcc08d0e7c","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM ubuntu:18.04\nRUN apt-get update -qq \\\n && apt-get upgrade -yq \\\n && apt-mark hold openjdk-11-jre-headless \\\n && apt-get install --no-install-recommends apt-transport-https apt-utils ca-certificates curl git-core gnupg jq less maven openjdk-8-jdk-headless sudo supervisor wget tar vim zookeeperd -yq\n#\n#   Elasticsearch and Kibana\n#\nENV ES_VERSION=\"7.0.0\"\nRUN wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch | apt-key add -\nRUN echo \"deb https://artifacts.elastic.co/packages/7.x/apt stable main\" >> /etc/apt/sources.list.d/elasticsearch-7.x.list\nRUN apt-get update -qq \\\n && apt-get install --no-install-recommends elasticsearch=$ES_VERSION kibana=$ES_VERSION -yq\nRUN ln -s /usr/share/elasticsearch/bin/elasticsearch /usr/bin/elasticsearch\nRUN ln -s /usr/share/kibana/bin/kibana /usr/bin/kibana\nRUN chown -R kibana:kibana /usr/share/kibana/\nUSER root\n#   system configuration, see https://www.elastic.co/guide/en/elasticsearch/reference/current/deb.html\nADD etc/sysctl.d/60-elasticsearch.conf /etc/sysctl.d/60-elasticsearch.conf\nADD etc/supervisor/conf.d/elasticsearch.conf /etc/supervisor/conf.d/elasticsearch.conf\nADD etc/supervisor/conf.d/kibana.conf /etc/supervisor/conf.d/kibana.conf\nRUN chmod -R 644 /etc/sysctl.d/60-elasticsearch.conf /etc/supervisor/conf.d/*.conf\nENV ES_HEAP_SIZE=\"20g\"\n#   set Elasticsearch data path\nRUN sed -Ei 's@^path\\.data: .*@path.data: /data/elasticsearch@' /etc/elasticsearch/elasticsearch.yml\n#   TODO: enable updates via scripting\n#\n#   Apache Storm\n#\nENV STORM_VERSION=\"1.2.2\"\nCOPY downloads/apache-storm-$STORM_VERSION.tar.gz /tmp/apache-storm-$STORM_VERSION.tar.gz\nRUN tar -xzf /tmp/apache-storm-$STORM_VERSION.tar.gz -C /opt\nRUN rm /tmp/apache-storm-$STORM_VERSION.tar.gz\nENV STORM_HOME=\"/opt/apache-storm-$STORM_VERSION\"\nRUN groupadd storm \\\n && useradd --gid storm --home-dir /home/storm --create-home --shell /bin/bash storm \\\n && chown -R storm:storm $STORM_HOME \\\n && mkdir /var/log/storm \\\n && chown -R storm:storm /var/log/storm\nRUN ln -s /var/log/storm $STORM_HOME/logs\nRUN ln -s $STORM_HOME/bin/storm /usr/bin/storm\nADD etc/supervisor/conf.d/storm-*.conf /etc/supervisor/conf.d/\nADD etc/supervisor/conf.d/zookeeper.conf /etc/supervisor/conf.d/\nRUN chmod -R 644 /etc/supervisor/conf.d/*.conf\n#\n#   Storm crawler\n#\nRUN groupadd ubuntu \\\n && useradd --gid ubuntu --home-dir /home/ubuntu --create-home --shell /bin/bash ubuntu \\\n && chown -R ubuntu:ubuntu /home/ubuntu\nUSER ubuntu\nWORKDIR /home/ubuntu\nRUN mkdir news-crawler/ \\\n && mkdir news-crawler/conf/ \\\n && mkdir news-crawler/lib/ \\\n && mkdir news-crawler/bin/ \\\n && mkdir news-crawler/seeds/ \\\n && chmod -R a+rx news-crawler/\n#   add the news crawler uber-jar\nADD target/crawler-1.14.jar news-crawler/lib/crawler.jar\n#   and configuration files\nADD conf/*.* news-crawler/conf/\nADD seeds/*.txt news-crawler/seeds/\nADD bin/*.sh news-crawler/bin/\nADD bin/es_status news-crawler/bin/\nUSER root\nRUN chown -R ubuntu:ubuntu /home/ubuntu \\\n && chmod -R a+r /home/ubuntu \\\n && chmod u+x news-crawler/bin/*\n#   Ports:\n#    8080 - Storm UI\n#    9200 - Elasticsearch http\n#    9300 - Elasticsearch java\n#    5601 - Kibana\nEXPOSE 8080/tcp 9200/tcp 9300/tcp 5601/tcp\n#   volumes for persistent data\nUSER root\nRUN mkdir /data\nRUN mkdir /data/elasticsearch \\\n && chown elasticsearch:elasticsearch /data/elasticsearch\nVOLUME [\"/data/elasticsearch\"]\nRUN mkdir /data/warc \\\n && chown storm:storm /data/warc\nVOLUME [\"/data/warc\"]\n#   start all services\nCMD [\"/usr/bin/supervisord\"]\n#   launch the crawl\n#   CMD [\"/home/ubuntu/news-crawler/bin/run-crawler.sh\"]\n","originalDockerfileUglifiedHash":"f0c19e44f9fe7f728995f87b60833eec","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/64cfa7c16516b0ce18dbbc75e89de83462ef019f.dockerfile"}