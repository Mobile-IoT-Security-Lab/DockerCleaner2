{"seed":2404851281,"processedDockerfileHash":"12f9f353a0a1dc7ad8d177d30a85451c","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM alpine:edge\nMAINTAINER Julian Xhokaxhiu <info at julianxhokaxhiu dot com>\n#   Environment variables\n#  ######################\nENV DATA_DIR=\"/srv/data\"\n#   Configurable environment variables\n#  ###################################\n#   Custom DNS where to forward your request, if not found inside the DNS Server.\n#   By default this will be forwarded to Google DNS for IPv4 and IPv6 requests.\n#   See https://doc.powerdns.com/md/recursor/settings/#forward-zones\nENV CUSTOM_DNS=\"\\\"8.8.8.8;8.8.4.4;[2001:4860:4860::8888];[2001:4860:4860::8844]\\\"\"\n#   Custom API Key for PowerDNS.\n#   Leave empty to autogenerate one ( HIGHLY SUGGESTED! )\n#   See https://doc.powerdns.com/md/authoritative/settings/#api-key\nENV API_KEY=\"\\\"\n#   Change this cron rule to what fits best for you.\n#   Used only if ENABLE_ADBLOCK=true\n#   By Default = At 10:00 UTC ~ 2am PST/PDT\nENV CRONTAB_TIME=\"'0 10 * * *'\"\n#   Enable the AdBlock feature\nENV ENABLE_ADBLOCK=\"false\"\n#   Create Volume entry points\n#  ###########################\nVOLUME $DATA_DIR\n#   Copy required files and fix permissions\n#  ########################################\nCOPY src/* /root/\n#   Create missing directories\n#  ###########################\nRUN mkdir -p $DATA_DIR\n#   Set the work directory\n#  #######################\nWORKDIR /root\n#   Fix permissions\n#  ################\nRUN chmod 0644 * \\\n && chmod 0755 *.sh\n#   Install required packages\n#  #############################\nRUN apk add bash=5.2.15-r2 supervisor=4.2.5-r1 pdns=4.7.3-r1 pdns-doc=4.7.3-r1 pdns-recursor=4.8.4-r0 pdns-backend-sqlite3=4.7.3-r1 sqlite=3.41.2-r1 curl=8.0.1-r1 dbus=1.14.6-r1 libldap=2.6.4-r1 python3=3.11.3-r0 --update --no-cache\n#   Required by PowerDNS Admin GUI\nRUN apk add git=2.40.0-r0 gcc=12.2.1_git20220924-r9 musl-dev=1.2.3_git20230322-r0 python3-dev=3.11.3-r0 mariadb-dev=10.11.2-r4 libffi-dev=3.4.4-r1 libxslt-dev=1.1.37-r2 xmlsec-dev=1.2.37-r0 openldap-dev=2.6.4-r1 nodejs=18.15.0-r0 npm=9.6.4-r0 --update --no-cache --virtual .build-deps\n#   Install PowerDNS Admin GUI\n#  #############################\nRUN mkdir -p /usr/share/webapps/ \\\n && cd /usr/share/webapps/ \\\n && git clone https://github.com/ngoduykhanh/PowerDNS-Admin.git powerdns-admin \\\n && cd /usr/share/webapps/powerdns-admin \\\n && pip3 install --no-cache-dir -r requirements.txt \\\n && mv package.json app/static \\\n && cd app/static \\\n && npm install\n#   Cleanup\n#  ########\nRUN find /usr/local\n#   Replace default configurations\n#  ###############################\nRUN rm /etc/pdns/pdns.conf \\\n && rm /etc/pdns/recursor.conf \\\n && rm /etc/supervisord.conf \\\n && mv /root/pdns.conf /etc/pdns \\\n && mv /root/recursor.conf /etc/pdns \\\n && mv /root/config.py /usr/share/webapps/powerdns-admin \\\n && mv /root/supervisord.conf /etc\n#   Allow redirection of stdout to docker logs\n#  ###########################################\nRUN ln -sf /proc/1/fd/1 /var/log/docker.log\n#   Expose required ports\n#  ######################\nEXPOSE 53/tcp\nEXPOSE 53/udp\nEXPOSE 8080/tcp\n#   Change Shell\n#  #############\nSHELL [\"/bin/bash\", \"-c\"]\n#   Set the entry point to init.sh\n#  ##########################################\nENTRYPOINT /root/init.sh\nRUN addgroup -S docker-user ; adduser -S -G docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM alpine:edge\nMAINTAINER Julian Xhokaxhiu <info at julianxhokaxhiu dot com>\n#  Environment variables\n# ######################\nENV DATA_DIR=\"/srv/data\"\n#  Configurable environment variables\n# ###################################\n#  Custom DNS where to forward your request, if not found inside the DNS Server.\n#  By default this will be forwarded to Google DNS for IPv4 and IPv6 requests.\n#  See https://doc.powerdns.com/md/recursor/settings/#forward-zones\nENV CUSTOM_DNS=\"\\\"8.8.8.8;8.8.4.4;[2001:4860:4860::8888];[2001:4860:4860::8844]\\\"\"\n#  Custom API Key for PowerDNS.\n#  Leave empty to autogenerate one ( HIGHLY SUGGESTED! )\n#  See https://doc.powerdns.com/md/authoritative/settings/#api-key\nENV API_KEY=\"\"\\\"\"\n#  Change this cron rule to what fits best for you.\n#  Used only if ENABLE_ADBLOCK=true\n#  By Default = At 10:00 UTC ~ 2am PST/PDT\nENV CRONTAB_TIME=\"'0 10 * * *'\"\n#  Enable the AdBlock feature\nENV ENABLE_ADBLOCK=\"false\"\n#  Create Volume entry points\n# ###########################\nVOLUME $DATA_DIR\n#  Copy required files and fix permissions\n# ########################################\nCOPY src/* /root/\n#  Create missing directories\n# ###########################\nRUN mkdir -p $DATA_DIR\n#  Set the work directory\n# #######################\nWORKDIR /root\n#  Fix permissions\n# ################\nRUN chmod 0644 * \\\n && chmod 0755 *.sh\n#  Install required packages\n# #############################\nRUN apk --update add --no-cache bash supervisor pdns pdns-doc pdns-recursor pdns-backend-sqlite3 sqlite curl dbus libldap python3\n#  Required by PowerDNS Admin GUI\nRUN apk --update add --no-cache --virtual .build-deps git gcc musl-dev python3-dev mariadb-dev libffi-dev libxslt-dev xmlsec-dev openldap-dev nodejs npm\n#  Install PowerDNS Admin GUI\n# #############################\nRUN mkdir -p /usr/share/webapps/ \\\n && cd /usr/share/webapps/ \\\n && git clone https://github.com/ngoduykhanh/PowerDNS-Admin.git powerdns-admin \\\n && cd /usr/share/webapps/powerdns-admin \\\n && pip3 install --no-cache-dir -r requirements.txt \\\n && mv package.json app/static \\\n && cd app/static \\\n && npm install\n#  Cleanup\n# ########\nRUN find /usr/local ( -type d -a -name test -o -name tests ) -o ( -type f -a -name '*.pyc' -o -name '*.pyo' ) -exec rm -rf '{}' + \\\n && apk del .build-deps \\\n && rm -rf /var/cache/apk/*\n#  Replace default configurations\n# ###############################\nRUN rm /etc/pdns/pdns.conf \\\n && rm /etc/pdns/recursor.conf \\\n && rm /etc/supervisord.conf \\\n && mv /root/pdns.conf /etc/pdns \\\n && mv /root/recursor.conf /etc/pdns \\\n && mv /root/config.py /usr/share/webapps/powerdns-admin \\\n && mv /root/supervisord.conf /etc\n#  Allow redirection of stdout to docker logs\n# ###########################################\nRUN ln -sf /proc/1/fd/1 /var/log/docker.log\n#  Expose required ports\n# ######################\nEXPOSE 53/tcp\nEXPOSE 53/udp\nEXPOSE 8080/tcp\n#  Change Shell\n# #############\nSHELL [\"/bin/bash\", \"-c\"]\n#  Set the entry point to init.sh\n# ##########################################\nENTRYPOINT /root/init.sh\n","injectedSmells":[],"originalDockerfileHash":"e1c24fc1db193ba1bba36cde8f571e51","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM alpine:edge\nMAINTAINER Julian Xhokaxhiu <info at julianxhokaxhiu dot com>\n#   Environment variables\n#  ######################\nENV DATA_DIR=\"/srv/data\"\n#   Configurable environment variables\n#  ###################################\n#   Custom DNS where to forward your request, if not found inside the DNS Server.\n#   By default this will be forwarded to Google DNS for IPv4 and IPv6 requests.\n#   See https://doc.powerdns.com/md/recursor/settings/#forward-zones\nENV CUSTOM_DNS=\"\\\"8.8.8.8;8.8.4.4;[2001:4860:4860::8888];[2001:4860:4860::8844]\\\"\"\n#   Custom API Key for PowerDNS.\n#   Leave empty to autogenerate one ( HIGHLY SUGGESTED! )\n#   See https://doc.powerdns.com/md/authoritative/settings/#api-key\nENV API_KEY=\"\\\"\n#   Change this cron rule to what fits best for you.\n#   Used only if ENABLE_ADBLOCK=true\n#   By Default = At 10:00 UTC ~ 2am PST/PDT\nENV CRONTAB_TIME=\"'0 10 * * *'\"\n#   Enable the AdBlock feature\nENV ENABLE_ADBLOCK=\"false\"\n#   Create Volume entry points\n#  ###########################\nVOLUME $DATA_DIR\n#   Copy required files and fix permissions\n#  ########################################\nCOPY src/* /root/\n#   Create missing directories\n#  ###########################\nRUN mkdir -p $DATA_DIR\n#   Set the work directory\n#  #######################\nWORKDIR /root\n#   Fix permissions\n#  ################\nRUN chmod 0644 * \\\n && chmod 0755 *.sh\n#   Install required packages\n#  #############################\nRUN apk --update add --no-cache bash supervisor pdns pdns-doc pdns-recursor pdns-backend-sqlite3 sqlite curl dbus libldap python3\n#   Required by PowerDNS Admin GUI\nRUN apk --update add --no-cache --virtual .build-deps git gcc musl-dev python3-dev mariadb-dev libffi-dev libxslt-dev xmlsec-dev openldap-dev nodejs npm\n#   Install PowerDNS Admin GUI\n#  #############################\nRUN mkdir -p /usr/share/webapps/ \\\n && cd /usr/share/webapps/ \\\n && git clone https://github.com/ngoduykhanh/PowerDNS-Admin.git powerdns-admin \\\n && cd /usr/share/webapps/powerdns-admin \\\n && pip3 install --no-cache-dir -r requirements.txt \\\n && mv package.json app/static \\\n && cd app/static \\\n && npm install\n#   Cleanup\n#  ########\nRUN find /usr/local\n#   Replace default configurations\n#  ###############################\nRUN rm /etc/pdns/pdns.conf \\\n && rm /etc/pdns/recursor.conf \\\n && rm /etc/supervisord.conf \\\n && mv /root/pdns.conf /etc/pdns \\\n && mv /root/recursor.conf /etc/pdns \\\n && mv /root/config.py /usr/share/webapps/powerdns-admin \\\n && mv /root/supervisord.conf /etc\n#   Allow redirection of stdout to docker logs\n#  ###########################################\nRUN ln -sf /proc/1/fd/1 /var/log/docker.log\n#   Expose required ports\n#  ######################\nEXPOSE 53/tcp\nEXPOSE 53/udp\nEXPOSE 8080/tcp\n#   Change Shell\n#  #############\nSHELL [\"/bin/bash\", \"-c\"]\n#   Set the entry point to init.sh\n#  ##########################################\nENTRYPOINT /root/init.sh\n","originalDockerfileUglifiedHash":"f68601c9e817033393f6d4e050c0eb5d","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/835aa0ed543ab57a392b957a8498f7132344242e.dockerfile"}