{"seed":2162683140,"processedDockerfileHash":"fcbdfd9c4aef36acfb70f455f8d4b679","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","have-a-healthcheck","have-a-user"],"processedDockerfile":"#  ##############################\n#   Build the FFmpeg-build image.\nFROM alpine:3.8 AS build\nARG FFMPEG_VERSION=4.1.2\nARG PREFIX=/opt/ffmpeg\nARG LD_LIBRARY_PATH=/opt/ffmpeg/lib\nARG MAKEFLAGS=\"-j4\"\n#   FFmpeg build dependencies.\nRUN apk add build-base=0.5-r1 coreutils=8.29-r2 freetype-dev=2.9.1-r1 gcc=6.4.0-r9 lame-dev=3.100-r0 libogg-dev=1.3.3-r2 libass=0.13.7-r1 libass-dev=0.13.7-r1 libvpx-dev=1.6.1-r0 libvorbis-dev=1.3.6-r2 libwebp-dev=1.0.0-r0 libtheora-dev=1.1.1-r13 opus-dev=1.2.1-r1 pkgconf=1.5.3-r0 pkgconfig rtmpdump-dev=2.4_git20160909-r5 wget=1.20.3-r0 x264-dev=20180304-r1 x265-dev=2.7-r1 yasm=1.3.0-r1 --update\n#   Get fdk-aac from testing.\nRUN echo http://dl-cdn.alpinelinux.org/alpine/edge/testing >> /etc/apk/repositories \\\n && apk add fdk-aac-dev --update\n#   Get ffmpeg source.\nRUN cd /tmp/ \\\n && wget http://ffmpeg.org/releases/ffmpeg-${FFMPEG_VERSION}.tar.gz \\\n && tar zxf ffmpeg-${FFMPEG_VERSION}.tar.gz \\\n && rm ffmpeg-${FFMPEG_VERSION}.tar.gz\n#   Compile ffmpeg.\nRUN cd /tmp/ffmpeg-${FFMPEG_VERSION} \\\n && ./configure --enable-version3 --enable-gpl --enable-nonfree --enable-small --enable-libmp3lame --enable-libx264 --enable-libx265 --enable-libvpx --enable-libtheora --enable-libvorbis --enable-libopus --enable-libfdk-aac --enable-libass --enable-libwebp --enable-librtmp --enable-postproc --enable-avresample --enable-libfreetype --enable-openssl --disable-debug --disable-doc --disable-ffplay --extra-cflags=\"-I${PREFIX}/include\" --extra-ldflags=\"-L${PREFIX}/lib\" --extra-libs=\"-lpthread -lm\" --prefix=\"${PREFIX}\" \\\n && make \\\n && make install \\\n && make distclean\n#   Cleanup.\nRUN rm -rf /var/cache/apk/* /tmp/*\n#  #########################\n#   Build the release image.\nFROM alpine:3.8\nLABEL MAINTAINER=\"Alfred Gutierrez <alf.g.jr@gmail.com>\"\nENV PATH=\"/opt/ffmpeg/bin:$PATH\"\nRUN apk add ca-certificates=20191127-r2 openssl=1.0.2u-r0 pcre=8.42-r0 lame=3.100-r0 libogg=1.3.3-r2 libass=0.13.7-r1 libvpx=1.6.1-r0 libvorbis=1.3.6-r2 libwebp=1.0.0-r0 libtheora=1.1.1-r13 opus=1.2.1-r1 rtmpdump=2.4_git20160909-r5 x264-dev=20180304-r1 x265-dev=2.7-r1 --update\nCOPY --from=build /opt/ffmpeg /opt/ffmpeg\nCOPY --from=build /usr/lib/libfdk-aac.so.2 /usr/lib/libfdk-aac.so.2\nCMD [\"/usr/local/bin/ffmpeg\"]\nRUN addgroup -S docker-user ; adduser -S -G docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"# ##############################\n#  Build the FFmpeg-build image.\nFROM alpine:3.8 AS build\nARG FFMPEG_VERSION=4.1.2\nARG PREFIX=/opt/ffmpeg\nARG LD_LIBRARY_PATH=/opt/ffmpeg/lib\nARG MAKEFLAGS=\"-j4\"\n#  FFmpeg build dependencies.\nRUN apk add --update build-base coreutils freetype-dev gcc lame-dev libogg-dev libass libass-dev libvpx-dev libvorbis-dev libwebp-dev libtheora-dev opus-dev pkgconf pkgconfig rtmpdump-dev wget x264-dev x265-dev yasm\n#  Get fdk-aac from testing.\nRUN echo http://dl-cdn.alpinelinux.org/alpine/edge/testing >> /etc/apk/repositories \\\n && apk add --update fdk-aac-dev\n#  Get ffmpeg source.\nRUN cd /tmp/ \\\n && wget http://ffmpeg.org/releases/ffmpeg-${FFMPEG_VERSION}.tar.gz \\\n && tar zxf ffmpeg-${FFMPEG_VERSION}.tar.gz \\\n && rm ffmpeg-${FFMPEG_VERSION}.tar.gz\n#  Compile ffmpeg.\nRUN cd /tmp/ffmpeg-${FFMPEG_VERSION} \\\n && ./configure --enable-version3 --enable-gpl --enable-nonfree --enable-small --enable-libmp3lame --enable-libx264 --enable-libx265 --enable-libvpx --enable-libtheora --enable-libvorbis --enable-libopus --enable-libfdk-aac --enable-libass --enable-libwebp --enable-librtmp --enable-postproc --enable-avresample --enable-libfreetype --enable-openssl --disable-debug --disable-doc --disable-ffplay --extra-cflags=\"-I${PREFIX}/include\" --extra-ldflags=\"-L${PREFIX}/lib\" --extra-libs=\"-lpthread -lm\" --prefix=\"${PREFIX}\" \\\n && make \\\n && make install \\\n && make distclean\n#  Cleanup.\nRUN rm -rf /var/cache/apk/* /tmp/*\n# #########################\n#  Build the release image.\nFROM alpine:3.8\nLABEL MAINTAINER=\"Alfred Gutierrez <alf.g.jr@gmail.com>\"\nENV PATH=\"/opt/ffmpeg/bin:$PATH\"\nRUN apk add --update ca-certificates openssl pcre lame libogg libass libvpx libvorbis libwebp libtheora opus rtmpdump x264-dev x265-dev\nCOPY --from=build /opt/ffmpeg /opt/ffmpeg\nCOPY --from=build /usr/lib/libfdk-aac.so.2 /usr/lib/libfdk-aac.so.2\nCMD [\"/usr/local/bin/ffmpeg\"]\n","injectedSmells":[],"originalDockerfileHash":"9bcc302c8c22d5ab8d1a433180e7ed04","successfullyInjectedSmells":[],"originalDockerfileUglified":"#  ##############################\n#   Build the FFmpeg-build image.\nFROM alpine:3.8 AS build\nARG FFMPEG_VERSION=4.1.2\nARG PREFIX=/opt/ffmpeg\nARG LD_LIBRARY_PATH=/opt/ffmpeg/lib\nARG MAKEFLAGS=\"-j4\"\n#   FFmpeg build dependencies.\nRUN apk add --update build-base coreutils freetype-dev gcc lame-dev libogg-dev libass libass-dev libvpx-dev libvorbis-dev libwebp-dev libtheora-dev opus-dev pkgconf pkgconfig rtmpdump-dev wget x264-dev x265-dev yasm\n#   Get fdk-aac from testing.\nRUN echo http://dl-cdn.alpinelinux.org/alpine/edge/testing >> /etc/apk/repositories \\\n && apk add --update fdk-aac-dev\n#   Get ffmpeg source.\nRUN cd /tmp/ \\\n && wget http://ffmpeg.org/releases/ffmpeg-${FFMPEG_VERSION}.tar.gz \\\n && tar zxf ffmpeg-${FFMPEG_VERSION}.tar.gz \\\n && rm ffmpeg-${FFMPEG_VERSION}.tar.gz\n#   Compile ffmpeg.\nRUN cd /tmp/ffmpeg-${FFMPEG_VERSION} \\\n && ./configure --enable-version3 --enable-gpl --enable-nonfree --enable-small --enable-libmp3lame --enable-libx264 --enable-libx265 --enable-libvpx --enable-libtheora --enable-libvorbis --enable-libopus --enable-libfdk-aac --enable-libass --enable-libwebp --enable-librtmp --enable-postproc --enable-avresample --enable-libfreetype --enable-openssl --disable-debug --disable-doc --disable-ffplay --extra-cflags=\"-I${PREFIX}/include\" --extra-ldflags=\"-L${PREFIX}/lib\" --extra-libs=\"-lpthread -lm\" --prefix=\"${PREFIX}\" \\\n && make \\\n && make install \\\n && make distclean\n#   Cleanup.\nRUN rm -rf /var/cache/apk/* /tmp/*\n#  #########################\n#   Build the release image.\nFROM alpine:3.8\nLABEL MAINTAINER=\"Alfred Gutierrez <alf.g.jr@gmail.com>\"\nENV PATH=\"/opt/ffmpeg/bin:$PATH\"\nRUN apk add --update ca-certificates openssl pcre lame libogg libass libvpx libvorbis libwebp libtheora opus rtmpdump x264-dev x265-dev\nCOPY --from=build /opt/ffmpeg /opt/ffmpeg\nCOPY --from=build /usr/lib/libfdk-aac.so.2 /usr/lib/libfdk-aac.so.2\nCMD [\"/usr/local/bin/ffmpeg\"]\n","originalDockerfileUglifiedHash":"5615281b48cc4272ac08a825db50a81d","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/d5f83e7f271b5842e5d7aeada664a519e759e665.dockerfile"}