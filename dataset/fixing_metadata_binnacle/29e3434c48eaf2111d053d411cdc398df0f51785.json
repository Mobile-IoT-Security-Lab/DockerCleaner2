{"seed":454349826,"processedDockerfileHash":"42339f7eaa660d86e028dbe27f98636e","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","have-a-healthcheck"],"processedDockerfile":"#   © Copyright IBM Corporation 2017, 2019.\n#   LICENSE: Apache License, Version 2.0 (http://www.apache.org/licenses/LICENSE-2.0)\n#  ######### Dockerfile for Zabbix-server version 4.2.2 #########\n#\n#   This Dockerfile builds a basic installation of Zabbix-server.\n#\n#   Zabbix server is the central process of Zabbix software\n#\n#   To build this image, from the directory containing this Dockerfile\n#   (assuming that the file is named Dockerfile):\n#   docker build -t <image_name> .\n#\n#   To Start Zabbix server run the below command:\n#   docker run --name <container_name> -p <portnumber>:80 -d <image>\n#\n#   Test in the browser by using the following url:\n#   http://<hostname>:<port_number>/zabbix\n#\n#  #################################################################################\n#   Base Image\nFROM s390x/ubuntu:16.04\nARG ZBX_SERVER_VER=4.2.2\n#   The author\nMAINTAINER LoZ Open Source Ecosystem (https://www.ibm.com/developerworks/community/groups/community/lozopensource)\nENV DEBIAN_FRONTEND=\"noninteractive\"\nENV PATH=\"$PATH:/usr/local/sbin/\"\nENV SOURCE_DIR=\"/\"\nWORKDIR $SOURCE_DIR\n#   Install dependencies\nRUN apt-get update \\\n && apt-get install --no-install-recommends mysql-server -y \\\n && apt-get install --no-install-recommends sudo apache2 ceph curl gcc git libapache2-mod-php libcurl3 libcurl4-openssl-dev libmysqlclient-dev libmysqld-dev libsnmp-dev libxml2-dev make php php7.0-gd php7.0-ldap php7.0-xml php-bcmath php-mbstring php-mysql snmp snmptrapd vim wget libevent-dev libpcre3-dev -y \\\n && cd /etc/apache2 \\\n && chmod 766 apache2.conf \\\n && echo \"ServerName localhost\" >> apache2.conf \\\n && echo \"AddType application/x-httpd-php .php\" >> apache2.conf \\\n && echo \"<Directory />\" >> apache2.conf \\\n && echo \" DirectoryIndex index.php \" >> apache2.conf \\\n && echo \"</Directory>\" >> apache2.conf \\\n && cd $SOURCE_DIR \\\n && wget https://excellmedia.dl.sourceforge.net/project/zabbix/ZABBIX%20Latest%20Stable/${ZBX_SERVER_VER}/zabbix-${ZBX_SERVER_VER}.tar.gz \\\n && tar -xf zabbix-${ZBX_SERVER_VER}.tar.gz \\\n && cd zabbix-${ZBX_SERVER_VER}/ \\\n && ./configure --enable-server --with-mysql --enable-ipv6 --with-net-snmp --with-libcurl --with-libxml2 \\\n && make \\\n && make install \\\n && /usr/sbin/groupadd zabbix \\\n && /usr/sbin/useradd -g zabbix zabbix \\\n && cd /zabbix-${ZBX_SERVER_VER}/frontends/php/ \\\n && mkdir -p /var/www/html/zabbix \\\n && cp -rf * /var/www/html/zabbix/ \\\n && cd /var/www/html/zabbix \\\n && chown -R zabbix:zabbix conf \\\n && service mysql start \\\n && /usr/bin/mysql -e \"create database zabbix\" \\\n && /usr/bin/mysql -e \"create user 'zabbix'@'localhost'\" \\\n && /usr/bin/mysql -e \"grant all privileges on zabbix.* to 'zabbix'@'localhost'\" \\\n && cd /zabbix-${ZBX_SERVER_VER}/database/mysql \\\n && mysql -uzabbix zabbix < schema.sql \\\n && mysql -uzabbix zabbix < images.sql \\\n && mysql -uzabbix zabbix < data.sql \\\n && sed -i 's/max_execution_time = 30/max_execution_time = 300/g' /etc/php/7.0/apache2/php.ini \\\n && sed -i 's/max_input_time = 60/max_input_time = 300/g' /etc/php/7.0/apache2/php.ini \\\n && sed -i 's/post_max_size = 8M/post_max_size = 16M/g' /etc/php/7.0/apache2/php.ini \\\n && sed -i \"s/;date.timezone =/date.timezone = 'Asia\\/Kolkata'/g\" /etc/php/7.0/apache2/php.ini \\\n && echo 'zabbix ALL=(ALL) NOPASSWD: ALL' >> /etc/sudoers \\\n && echo 'sudo service apache2 start \\\n && sudo service mysql start \\\n && zabbix_server --foreground' > /start.sh \\\n && apt-get -y remove curl gcc git make vim wget \\\n && apt-get autoremove -y \\\n && apt-get clean \\\n && rm -rf /zabbix-${ZBX_SERVER_VER}.tar.gz \\\n && rm -rf /var/lib/apt/lists/*\nRUN cd /var/www/html/zabbix \\\n && chmod 733 assets\n#   Expose ports for apache2 & default port of Zabbix server\nEXPOSE 80/tcp 10051/tcp\nVOLUME /var/lib/mysql\n#   Switch to zabbix user\nUSER zabbix\n#   Start apache2 and mysql sever & zabbix server\nCMD [\"/bin/bash\", \"/start.sh\"]\n#   End of Dockerfile\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  © Copyright IBM Corporation 2017, 2019.\n#  LICENSE: Apache License, Version 2.0 (http://www.apache.org/licenses/LICENSE-2.0)\n# ######### Dockerfile for Zabbix-server version 4.2.2 #########\n#\n#  This Dockerfile builds a basic installation of Zabbix-server.\n#\n#  Zabbix server is the central process of Zabbix software\n#\n#  To build this image, from the directory containing this Dockerfile\n#  (assuming that the file is named Dockerfile):\n#  docker build -t <image_name> .\n#\n#  To Start Zabbix server run the below command:\n#  docker run --name <container_name> -p <portnumber>:80 -d <image>\n#\n#  Test in the browser by using the following url:\n#  http://<hostname>:<port_number>/zabbix\n#\n# #################################################################################\n#  Base Image\nFROM s390x/ubuntu:16.04\nARG ZBX_SERVER_VER=4.2.2\n#  The author\nMAINTAINER LoZ Open Source Ecosystem (https://www.ibm.com/developerworks/community/groups/community/lozopensource)\nENV DEBIAN_FRONTEND=\"noninteractive\"\nENV PATH=\"$PATH:/usr/local/sbin/\"\nENV SOURCE_DIR=\"/\"\nWORKDIR $SOURCE_DIR\n#  Install dependencies\nRUN apt-get update \\\n && apt-get install mysql-server -y \\\n && apt-get install sudo apache2 ceph curl gcc git libapache2-mod-php libcurl3 libcurl4-openssl-dev libmysqlclient-dev libmysqld-dev libsnmp-dev libxml2-dev make php php7.0-gd php7.0-ldap php7.0-xml php-bcmath php-mbstring php-mysql snmp snmptrapd vim wget libevent-dev libpcre3-dev -y \\\n && cd /etc/apache2 \\\n && chmod 766 apache2.conf \\\n && echo \"ServerName localhost\" >> apache2.conf \\\n && echo \"AddType application/x-httpd-php .php\" >> apache2.conf \\\n && echo \"<Directory />\" >> apache2.conf \\\n && echo \" DirectoryIndex index.php \" >> apache2.conf \\\n && echo \"</Directory>\" >> apache2.conf \\\n && cd $SOURCE_DIR \\\n && wget https://excellmedia.dl.sourceforge.net/project/zabbix/ZABBIX%20Latest%20Stable/${ZBX_SERVER_VER}/zabbix-${ZBX_SERVER_VER}.tar.gz \\\n && tar -xf zabbix-${ZBX_SERVER_VER}.tar.gz \\\n && cd zabbix-${ZBX_SERVER_VER}/ \\\n && ./configure --enable-server --with-mysql --enable-ipv6 --with-net-snmp --with-libcurl --with-libxml2 \\\n && make \\\n && make install \\\n && /usr/sbin/groupadd zabbix \\\n && /usr/sbin/useradd -g zabbix zabbix \\\n && cd /zabbix-${ZBX_SERVER_VER}/frontends/php/ \\\n && mkdir -p /var/www/html/zabbix \\\n && cp -rf * /var/www/html/zabbix/ \\\n && cd /var/www/html/zabbix \\\n && chown -R zabbix:zabbix conf \\\n && service mysql start \\\n && /usr/bin/mysql -e \"create database zabbix\" \\\n && /usr/bin/mysql -e \"create user 'zabbix'@'localhost'\" \\\n && /usr/bin/mysql -e \"grant all privileges on zabbix.* to 'zabbix'@'localhost'\" \\\n && cd /zabbix-${ZBX_SERVER_VER}/database/mysql \\\n && mysql -uzabbix zabbix < schema.sql \\\n && mysql -uzabbix zabbix < images.sql \\\n && mysql -uzabbix zabbix < data.sql \\\n && sed -i 's/max_execution_time = 30/max_execution_time = 300/g' /etc/php/7.0/apache2/php.ini \\\n && sed -i 's/max_input_time = 60/max_input_time = 300/g' /etc/php/7.0/apache2/php.ini \\\n && sed -i 's/post_max_size = 8M/post_max_size = 16M/g' /etc/php/7.0/apache2/php.ini \\\n && sed -i \"s/;date.timezone =/date.timezone = 'Asia\\/Kolkata'/g\" /etc/php/7.0/apache2/php.ini \\\n && echo 'zabbix ALL=(ALL) NOPASSWD: ALL' >> /etc/sudoers \\\n && echo 'sudo service apache2 start \\\n && sudo service mysql start \\\n && zabbix_server --foreground' > /start.sh \\\n && apt-get -y remove curl gcc git make vim wget \\\n && apt-get autoremove -y \\\n && apt-get clean \\\n && rm -rf /zabbix-${ZBX_SERVER_VER}.tar.gz \\\n && rm -rf /var/lib/apt/lists/*\nRUN cd /var/www/html/zabbix \\\n && chmod 733 assets\n#  Expose ports for apache2 & default port of Zabbix server\nEXPOSE 80/tcp 10051/tcp\nVOLUME /var/lib/mysql\n#  Switch to zabbix user\nUSER zabbix\n#  Start apache2 and mysql sever & zabbix server\nCMD [\"/bin/bash\", \"/start.sh\"]\n#  End of Dockerfile\n","injectedSmells":[],"originalDockerfileHash":"fe64e707c379f4476f7382e41b14d402","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   © Copyright IBM Corporation 2017, 2019.\n#   LICENSE: Apache License, Version 2.0 (http://www.apache.org/licenses/LICENSE-2.0)\n#  ######### Dockerfile for Zabbix-server version 4.2.2 #########\n#\n#   This Dockerfile builds a basic installation of Zabbix-server.\n#\n#   Zabbix server is the central process of Zabbix software\n#\n#   To build this image, from the directory containing this Dockerfile\n#   (assuming that the file is named Dockerfile):\n#   docker build -t <image_name> .\n#\n#   To Start Zabbix server run the below command:\n#   docker run --name <container_name> -p <portnumber>:80 -d <image>\n#\n#   Test in the browser by using the following url:\n#   http://<hostname>:<port_number>/zabbix\n#\n#  #################################################################################\n#   Base Image\nFROM s390x/ubuntu:16.04\nARG ZBX_SERVER_VER=4.2.2\n#   The author\nMAINTAINER LoZ Open Source Ecosystem (https://www.ibm.com/developerworks/community/groups/community/lozopensource)\nENV DEBIAN_FRONTEND=\"noninteractive\"\nENV PATH=\"$PATH:/usr/local/sbin/\"\nENV SOURCE_DIR=\"/\"\nWORKDIR $SOURCE_DIR\n#   Install dependencies\nRUN apt-get update \\\n && apt-get install mysql-server -y \\\n && apt-get install sudo apache2 ceph curl gcc git libapache2-mod-php libcurl3 libcurl4-openssl-dev libmysqlclient-dev libmysqld-dev libsnmp-dev libxml2-dev make php php7.0-gd php7.0-ldap php7.0-xml php-bcmath php-mbstring php-mysql snmp snmptrapd vim wget libevent-dev libpcre3-dev -y \\\n && cd /etc/apache2 \\\n && chmod 766 apache2.conf \\\n && echo \"ServerName localhost\" >> apache2.conf \\\n && echo \"AddType application/x-httpd-php .php\" >> apache2.conf \\\n && echo \"<Directory />\" >> apache2.conf \\\n && echo \" DirectoryIndex index.php \" >> apache2.conf \\\n && echo \"</Directory>\" >> apache2.conf \\\n && cd $SOURCE_DIR \\\n && wget https://excellmedia.dl.sourceforge.net/project/zabbix/ZABBIX%20Latest%20Stable/${ZBX_SERVER_VER}/zabbix-${ZBX_SERVER_VER}.tar.gz \\\n && tar -xf zabbix-${ZBX_SERVER_VER}.tar.gz \\\n && cd zabbix-${ZBX_SERVER_VER}/ \\\n && ./configure --enable-server --with-mysql --enable-ipv6 --with-net-snmp --with-libcurl --with-libxml2 \\\n && make \\\n && make install \\\n && /usr/sbin/groupadd zabbix \\\n && /usr/sbin/useradd -g zabbix zabbix \\\n && cd /zabbix-${ZBX_SERVER_VER}/frontends/php/ \\\n && mkdir -p /var/www/html/zabbix \\\n && cp -rf * /var/www/html/zabbix/ \\\n && cd /var/www/html/zabbix \\\n && chown -R zabbix:zabbix conf \\\n && service mysql start \\\n && /usr/bin/mysql -e \"create database zabbix\" \\\n && /usr/bin/mysql -e \"create user 'zabbix'@'localhost'\" \\\n && /usr/bin/mysql -e \"grant all privileges on zabbix.* to 'zabbix'@'localhost'\" \\\n && cd /zabbix-${ZBX_SERVER_VER}/database/mysql \\\n && mysql -uzabbix zabbix < schema.sql \\\n && mysql -uzabbix zabbix < images.sql \\\n && mysql -uzabbix zabbix < data.sql \\\n && sed -i 's/max_execution_time = 30/max_execution_time = 300/g' /etc/php/7.0/apache2/php.ini \\\n && sed -i 's/max_input_time = 60/max_input_time = 300/g' /etc/php/7.0/apache2/php.ini \\\n && sed -i 's/post_max_size = 8M/post_max_size = 16M/g' /etc/php/7.0/apache2/php.ini \\\n && sed -i \"s/;date.timezone =/date.timezone = 'Asia\\/Kolkata'/g\" /etc/php/7.0/apache2/php.ini \\\n && echo 'zabbix ALL=(ALL) NOPASSWD: ALL' >> /etc/sudoers \\\n && echo 'sudo service apache2 start \\\n && sudo service mysql start \\\n && zabbix_server --foreground' > /start.sh \\\n && apt-get -y remove curl gcc git make vim wget \\\n && apt-get autoremove -y \\\n && apt-get clean \\\n && rm -rf /zabbix-${ZBX_SERVER_VER}.tar.gz \\\n && rm -rf /var/lib/apt/lists/*\nRUN cd /var/www/html/zabbix \\\n && chmod 733 assets\n#   Expose ports for apache2 & default port of Zabbix server\nEXPOSE 80/tcp 10051/tcp\nVOLUME /var/lib/mysql\n#   Switch to zabbix user\nUSER zabbix\n#   Start apache2 and mysql sever & zabbix server\nCMD [\"/bin/bash\", \"/start.sh\"]\n#   End of Dockerfile\n","originalDockerfileUglifiedHash":"030939b55113b060d2e5c746c0a90556","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/29e3434c48eaf2111d053d411cdc398df0f51785.dockerfile"}