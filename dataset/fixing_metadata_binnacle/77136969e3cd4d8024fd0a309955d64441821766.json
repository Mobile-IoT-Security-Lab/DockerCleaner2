{"seed":1237588053,"processedDockerfileHash":"02b74ceb358ed8ec64f3e6307589d9e7","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","have-a-healthcheck","have-a-user"],"processedDockerfile":"#\n#   Dockerfile for Apache/PHP/MySQL\n#\nFROM alpine:3.8\nMAINTAINER Azure App Service Container Images <appsvc-images@microsoft.com>\n#   ========\n#   ENV vars\n#   ========\n#  apache httpd\nENV HTTPD_HOME=\"\\\"/etc/apache2\\\"\"\nENV HTTPD_CONF_DIR=\"\\\"$HTTPD_HOME/conf.d\\\"\"\nENV HTTPD_CONF_FILE=\"\\\"$HTTPD_HOME/httpd.conf\\\"\"\nENV HTTPD_LOG_DIR=\"\\\"/home/LogFiles/httpd\\\"\"\nENV HTTPD_PID_DIR=\"\\\"/run/apache2\\\"\"\nENV PATH=\"$HTTPD_HOME/bin:$PATH\"\n#   mariadb\nENV MARIADB_DATA_DIR=\"\\\"/home/data/mysql\\\"\"\nENV MARIADB_LOG_DIR=\"\\\"/home/LogFiles/mysql\\\"\"\n#   php\nENV PHP_HOME=\"\\\"/etc/php7\\\"\"\nENV PHP_CONF_DIR=\"$PHP_HOME\"\nENV PHP_CONF_FILE=\"$PHP_CONF_DIR\\\"/php.ini\\\"\"\nENV PHP_CONF_DIR_SCAN=\"$PHP_CONF_DIR\\\"/conf.d\\\"\"\nENV PATH=\"$PHP_HOME/bin:$PATH\"\n#   supervisor\nENV SUPERVISOR_LOG_DIR=\"\\\"/home/LogFiles/supervisor\\\"\"\n#   phpmyadmin\nENV PHPMYADMIN_VERSION=\"\\\"4.8.0\\\"\"\nENV PHPMYADMIN_DOWNLOAD_URL=\"\\\"https://files.phpmyadmin.net/phpMyAdmin/$PHPMYADMIN_VERSION/phpMyAdmin-$PHPMYADMIN_VERSION-all-languages.tar.gz\\\"\"\nENV PHPMYADMIN_SHA256=\"\\\"1e83d60627d8036261af71220eae9ffd8d3150778702720905bcfa85c40ce346\\\"\"\nENV PHPMYADMIN_SOURCE=\"\\\"/usr/src/phpmyadmin\\\"\"\nENV PHPMYADMIN_HOME=\"\\\"/home/phpmyadmin\\\"\"\n#   ssh\nENV SSH_PASSWD=\"\\\"root:Docker!\\\"\"\n#   app\nENV APP_HOME=\"\\\"/home/site/wwwroot\\\"\"\n#\nENV DOCKER_BUILD_HOME=\"\\\"/dockerbuild\\\"\"\n#   ensure www-data user exists\nRUN set -x \\\n && addgroup -g 82 -S www-data \\\n && adduser -u 82 -D -S -G www-data www-data\n#   ---------------\n#   2. apache httpd\n#   ---------------\nRUN mkdir -p \"$DOCKER_BUILD_HOME\"\nWORKDIR $DOCKER_BUILD_HOME\nRUN set -x \\\n && apk update \\\n && apk add apache2=2.4.43-r0 apache2-ssl=2.4.43-r0 \\\n && apk add mariadb=10.2.32-r0 mariadb-client=10.2.32-r0 --update \\\n && apk add php7-common=7.2.26-r0 php7-iconv=7.2.26-r0 php7-json=7.2.26-r0 php7-gd=7.2.26-r0 php7-curl=7.2.26-r0 php7-xml=7.2.26-r0 php7-simplexml=7.2.26-r0 php7-pgsql=7.2.26-r0 php7-imap=7.2.26-r0 php7-cgi=7.2.26-r0 fcgi=2.4.0-r8 \\\n && apk add php7-pdo=7.2.26-r0 php7-pdo_pgsql=7.2.26-r0 php7-soap=7.2.26-r0 php7-xmlrpc=7.2.26-r0 php7-posix=7.2.26-r0 php7-mcrypt=1.0.1-r0 php7-gettext=7.2.26-r0 php7-ldap=7.2.26-r0 php7-ctype=7.2.26-r0 php7-dom=7.2.26-r0 \\\n && apk add php7-apache2=7.2.26-r0 php7-embed=7.2.26-r0 php7-session=7.2.26-r0 php7-mbstring=7.2.26-r0 \\\n && apk add php7-mysqli=7.2.26-r0 php7-opcache=7.2.26-r0 php7-xdebug=2.6.1-r0 \\\n && mkdir -p $PHPMYADMIN_SOURCE \\\n && cd $PHPMYADMIN_SOURCE \\\n && wget -O phpmyadmin.tar.gz \"$PHPMYADMIN_DOWNLOAD_URL\" --no-check-certificate \\\n && echo \"$PHPMYADMIN_SHA256 *phpmyadmin.tar.gz\" | sha256sum -c - \\\n && apk add openssh-server=7.7_p1-r4 --update \\\n && echo \"$SSH_PASSWD\" | chpasswd \\\n && apk update \\\n && apk add openrc=0.35.5-r5 \\\n && sed -i 's/\"cgroup_add_service/\" # cgroup_add_service/g' /lib/rc/sh/openrc-run.sh \\\n && apk update \\\n && apk add supervisor=3.3.4-r1 \\\n && rm -rf /var/cache/apk/* /tmp/*\n#   =========\n#   Configure\n#   =========\n#\n#   httpd\nCOPY httpd.conf $HTTPD_HOME/\nCOPY httpd-modules.conf $HTTPD_CONF_DIR/\nCOPY httpd-php.conf $HTTPD_CONF_DIR/\n#   php\nCOPY php.ini $PHP_CONF_DIR/\nCOPY xdebug.ini $PHP_CONF_DIR_SCAN/\nCOPY php-opcache.ini $PHP_CONF_DIR_SCAN/\n#   phpmyadmin\nCOPY httpd-phpmyadmin.conf $HTTPD_CONF_DIR/\nCOPY phpmyadmin-config.inc.php $PHPMYADMIN_SOURCE/\nCOPY mariadb.cnf /etc/mysql/\n#   ssh\nCOPY sshd_config /etc/ssh/\nRUN set -ex \\\n && test ! -d /var/lib/php/sessions \\\n && mkdir -p /var/lib/php/sessions \\\n && chown www-data:www-data /var/lib/php/sessions\n#  #\n#  RUN set -ex \\\n#  && test ! -d /var/www \nRUN set -ex \\\n && mkdir -p /var/www \\\n && chown -R www-data:www-data /var/www \\\n && rm -rf /var/log/httpd \\\n && ln -s $HTTPD_LOG_DIR /var/log/httpd \\\n && rm -rf /var/log/mysql \\\n && ln -s $MARIADB_LOG_DIR /var/log/mysql \\\n && rm -rf /var/log/supervisor \\\n && ln -s $SUPERVISOR_LOG_DIR /var/log/supervisor \\\n && ln -s $PHPMYADMIN_HOME /var/www/phpmyadmin \\\n && ln -s $APP_HOME /var/www/wwwroot \\\n && rm -f /etc/supervisord.conf\n#\n#   =====\n#   final\n#   =====\nCOPY supervisord.conf /etc/\nCOPY entrypoint.sh /usr/local/bin/\nRUN chmod u+x /usr/local/bin/entrypoint.sh\nEXPOSE 2222/tcp 80/tcp\nENTRYPOINT [\"entrypoint.sh\"]\nRUN addgroup -S docker-user ; adduser -S -G docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#\n#  Dockerfile for Apache/PHP/MySQL\n#\nFROM alpine:3.8\nMAINTAINER Azure App Service Container Images <appsvc-images@microsoft.com>\n#  ========\n#  ENV vars\n#  ========\n# apache httpd\nENV HTTPD_HOME=\"\\\"/etc/apache2\\\"\"\nENV HTTPD_CONF_DIR=\"\\\"$HTTPD_HOME/conf.d\\\"\"\nENV HTTPD_CONF_FILE=\"\\\"$HTTPD_HOME/httpd.conf\\\"\"\nENV HTTPD_LOG_DIR=\"\\\"/home/LogFiles/httpd\\\"\"\nENV HTTPD_PID_DIR=\"\\\"/run/apache2\\\"\"\nENV PATH=\"$HTTPD_HOME/bin:$PATH\"\n#  mariadb\nENV MARIADB_DATA_DIR=\"\\\"/home/data/mysql\\\"\"\nENV MARIADB_LOG_DIR=\"\\\"/home/LogFiles/mysql\\\"\"\n#  php\nENV PHP_HOME=\"\\\"/etc/php7\\\"\"\nENV PHP_CONF_DIR=\"$PHP_HOME\"\nENV PHP_CONF_FILE=\"$PHP_CONF_DIR\\\"/php.ini\\\"\"\nENV PHP_CONF_DIR_SCAN=\"$PHP_CONF_DIR\\\"/conf.d\\\"\"\nENV PATH=\"$PHP_HOME/bin:$PATH\"\n#  supervisor\nENV SUPERVISOR_LOG_DIR=\"\\\"/home/LogFiles/supervisor\\\"\"\n#  phpmyadmin\nENV PHPMYADMIN_VERSION=\"\\\"4.8.0\\\"\"\nENV PHPMYADMIN_DOWNLOAD_URL=\"\\\"https://files.phpmyadmin.net/phpMyAdmin/$PHPMYADMIN_VERSION/phpMyAdmin-$PHPMYADMIN_VERSION-all-languages.tar.gz\\\"\"\nENV PHPMYADMIN_SHA256=\"\\\"1e83d60627d8036261af71220eae9ffd8d3150778702720905bcfa85c40ce346\\\"\"\nENV PHPMYADMIN_SOURCE=\"\\\"/usr/src/phpmyadmin\\\"\"\nENV PHPMYADMIN_HOME=\"\\\"/home/phpmyadmin\\\"\"\n#  ssh\nENV SSH_PASSWD=\"\\\"root:Docker!\\\"\"\n#  app\nENV APP_HOME=\"\\\"/home/site/wwwroot\\\"\"\n#\nENV DOCKER_BUILD_HOME=\"\\\"/dockerbuild\\\"\"\n#  ensure www-data user exists\nRUN set -x \\\n && addgroup -g 82 -S www-data \\\n && adduser -u 82 -D -S -G www-data www-data\n#  ---------------\n#  2. apache httpd\n#  ---------------\nRUN mkdir -p \"$DOCKER_BUILD_HOME\"\nWORKDIR $DOCKER_BUILD_HOME\nRUN set -x \\\n && apk update \\\n && apk add apache2 apache2-ssl \\\n && apk add --update mariadb mariadb-client \\\n && apk add php7-common php7-iconv php7-json php7-gd php7-curl php7-xml php7-simplexml php7-pgsql php7-imap php7-cgi fcgi \\\n && apk add php7-pdo php7-pdo_pgsql php7-soap php7-xmlrpc php7-posix php7-mcrypt php7-gettext php7-ldap php7-ctype php7-dom \\\n && apk add php7-apache2 php7-embed php7-session php7-mbstring \\\n && apk add php7-mysqli php7-opcache php7-xdebug \\\n && mkdir -p $PHPMYADMIN_SOURCE \\\n && cd $PHPMYADMIN_SOURCE \\\n && wget -O phpmyadmin.tar.gz \"$PHPMYADMIN_DOWNLOAD_URL\" --no-check-certificate \\\n && echo \"$PHPMYADMIN_SHA256 *phpmyadmin.tar.gz\" | sha256sum -c - \\\n && apk add --update openssh-server \\\n && echo \"$SSH_PASSWD\" | chpasswd \\\n && apk update \\\n && apk add openrc \\\n && sed -i 's/\"cgroup_add_service/\" # cgroup_add_service/g' /lib/rc/sh/openrc-run.sh \\\n && apk update \\\n && apk add supervisor \\\n && rm -rf /var/cache/apk/* /tmp/*\n#  =========\n#  Configure\n#  =========\n#\n#  httpd\nCOPY httpd.conf $HTTPD_HOME/\nCOPY httpd-modules.conf $HTTPD_CONF_DIR/\nCOPY httpd-php.conf $HTTPD_CONF_DIR/\n#  php\nCOPY php.ini $PHP_CONF_DIR/\nCOPY xdebug.ini $PHP_CONF_DIR_SCAN/\nCOPY php-opcache.ini $PHP_CONF_DIR_SCAN/\n#  phpmyadmin\nCOPY httpd-phpmyadmin.conf $HTTPD_CONF_DIR/\nCOPY phpmyadmin-config.inc.php $PHPMYADMIN_SOURCE/\nCOPY mariadb.cnf /etc/mysql/\n#  ssh\nCOPY sshd_config /etc/ssh/\nRUN set -ex \\\n && test ! -d /var/lib/php/sessions \\\n && mkdir -p /var/lib/php/sessions \\\n && chown www-data:www-data /var/lib/php/sessions\n# #\n# RUN set -ex \\\n# && test ! -d /var/www \nRUN set -ex \\\n && mkdir -p /var/www \\\n && chown -R www-data:www-data /var/www \\\n && rm -rf /var/log/httpd \\\n && ln -s $HTTPD_LOG_DIR /var/log/httpd \\\n && rm -rf /var/log/mysql \\\n && ln -s $MARIADB_LOG_DIR /var/log/mysql \\\n && rm -rf /var/log/supervisor \\\n && ln -s $SUPERVISOR_LOG_DIR /var/log/supervisor \\\n && ln -s $PHPMYADMIN_HOME /var/www/phpmyadmin \\\n && ln -s $APP_HOME /var/www/wwwroot \\\n && rm -f /etc/supervisord.conf\n#\n#  =====\n#  final\n#  =====\nCOPY supervisord.conf /etc/\nCOPY entrypoint.sh /usr/local/bin/\nRUN chmod u+x /usr/local/bin/entrypoint.sh\nEXPOSE 2222/tcp 80/tcp\nENTRYPOINT [\"entrypoint.sh\"]\n","injectedSmells":[],"originalDockerfileHash":"b0dd2b3278b0139802d13bfd49c41855","successfullyInjectedSmells":[],"originalDockerfileUglified":"#\n#   Dockerfile for Apache/PHP/MySQL\n#\nFROM alpine:3.8\nMAINTAINER Azure App Service Container Images <appsvc-images@microsoft.com>\n#   ========\n#   ENV vars\n#   ========\n#  apache httpd\nENV HTTPD_HOME=\"\\\"/etc/apache2\\\"\"\nENV HTTPD_CONF_DIR=\"\\\"$HTTPD_HOME/conf.d\\\"\"\nENV HTTPD_CONF_FILE=\"\\\"$HTTPD_HOME/httpd.conf\\\"\"\nENV HTTPD_LOG_DIR=\"\\\"/home/LogFiles/httpd\\\"\"\nENV HTTPD_PID_DIR=\"\\\"/run/apache2\\\"\"\nENV PATH=\"$HTTPD_HOME/bin:$PATH\"\n#   mariadb\nENV MARIADB_DATA_DIR=\"\\\"/home/data/mysql\\\"\"\nENV MARIADB_LOG_DIR=\"\\\"/home/LogFiles/mysql\\\"\"\n#   php\nENV PHP_HOME=\"\\\"/etc/php7\\\"\"\nENV PHP_CONF_DIR=\"$PHP_HOME\"\nENV PHP_CONF_FILE=\"$PHP_CONF_DIR\\\"/php.ini\\\"\"\nENV PHP_CONF_DIR_SCAN=\"$PHP_CONF_DIR\\\"/conf.d\\\"\"\nENV PATH=\"$PHP_HOME/bin:$PATH\"\n#   supervisor\nENV SUPERVISOR_LOG_DIR=\"\\\"/home/LogFiles/supervisor\\\"\"\n#   phpmyadmin\nENV PHPMYADMIN_VERSION=\"\\\"4.8.0\\\"\"\nENV PHPMYADMIN_DOWNLOAD_URL=\"\\\"https://files.phpmyadmin.net/phpMyAdmin/$PHPMYADMIN_VERSION/phpMyAdmin-$PHPMYADMIN_VERSION-all-languages.tar.gz\\\"\"\nENV PHPMYADMIN_SHA256=\"\\\"1e83d60627d8036261af71220eae9ffd8d3150778702720905bcfa85c40ce346\\\"\"\nENV PHPMYADMIN_SOURCE=\"\\\"/usr/src/phpmyadmin\\\"\"\nENV PHPMYADMIN_HOME=\"\\\"/home/phpmyadmin\\\"\"\n#   ssh\nENV SSH_PASSWD=\"\\\"root:Docker!\\\"\"\n#   app\nENV APP_HOME=\"\\\"/home/site/wwwroot\\\"\"\n#\nENV DOCKER_BUILD_HOME=\"\\\"/dockerbuild\\\"\"\n#   ensure www-data user exists\nRUN set -x \\\n && addgroup -g 82 -S www-data \\\n && adduser -u 82 -D -S -G www-data www-data\n#   ---------------\n#   2. apache httpd\n#   ---------------\nRUN mkdir -p \"$DOCKER_BUILD_HOME\"\nWORKDIR $DOCKER_BUILD_HOME\nRUN set -x \\\n && apk update \\\n && apk add apache2 apache2-ssl \\\n && apk add --update mariadb mariadb-client \\\n && apk add php7-common php7-iconv php7-json php7-gd php7-curl php7-xml php7-simplexml php7-pgsql php7-imap php7-cgi fcgi \\\n && apk add php7-pdo php7-pdo_pgsql php7-soap php7-xmlrpc php7-posix php7-mcrypt php7-gettext php7-ldap php7-ctype php7-dom \\\n && apk add php7-apache2 php7-embed php7-session php7-mbstring \\\n && apk add php7-mysqli php7-opcache php7-xdebug \\\n && mkdir -p $PHPMYADMIN_SOURCE \\\n && cd $PHPMYADMIN_SOURCE \\\n && wget -O phpmyadmin.tar.gz \"$PHPMYADMIN_DOWNLOAD_URL\" --no-check-certificate \\\n && echo \"$PHPMYADMIN_SHA256 *phpmyadmin.tar.gz\" | sha256sum -c - \\\n && apk add --update openssh-server \\\n && echo \"$SSH_PASSWD\" | chpasswd \\\n && apk update \\\n && apk add openrc \\\n && sed -i 's/\"cgroup_add_service/\" # cgroup_add_service/g' /lib/rc/sh/openrc-run.sh \\\n && apk update \\\n && apk add supervisor \\\n && rm -rf /var/cache/apk/* /tmp/*\n#   =========\n#   Configure\n#   =========\n#\n#   httpd\nCOPY httpd.conf $HTTPD_HOME/\nCOPY httpd-modules.conf $HTTPD_CONF_DIR/\nCOPY httpd-php.conf $HTTPD_CONF_DIR/\n#   php\nCOPY php.ini $PHP_CONF_DIR/\nCOPY xdebug.ini $PHP_CONF_DIR_SCAN/\nCOPY php-opcache.ini $PHP_CONF_DIR_SCAN/\n#   phpmyadmin\nCOPY httpd-phpmyadmin.conf $HTTPD_CONF_DIR/\nCOPY phpmyadmin-config.inc.php $PHPMYADMIN_SOURCE/\nCOPY mariadb.cnf /etc/mysql/\n#   ssh\nCOPY sshd_config /etc/ssh/\nRUN set -ex \\\n && test ! -d /var/lib/php/sessions \\\n && mkdir -p /var/lib/php/sessions \\\n && chown www-data:www-data /var/lib/php/sessions\n#  #\n#  RUN set -ex \\\n#  && test ! -d /var/www \nRUN set -ex \\\n && mkdir -p /var/www \\\n && chown -R www-data:www-data /var/www \\\n && rm -rf /var/log/httpd \\\n && ln -s $HTTPD_LOG_DIR /var/log/httpd \\\n && rm -rf /var/log/mysql \\\n && ln -s $MARIADB_LOG_DIR /var/log/mysql \\\n && rm -rf /var/log/supervisor \\\n && ln -s $SUPERVISOR_LOG_DIR /var/log/supervisor \\\n && ln -s $PHPMYADMIN_HOME /var/www/phpmyadmin \\\n && ln -s $APP_HOME /var/www/wwwroot \\\n && rm -f /etc/supervisord.conf\n#\n#   =====\n#   final\n#   =====\nCOPY supervisord.conf /etc/\nCOPY entrypoint.sh /usr/local/bin/\nRUN chmod u+x /usr/local/bin/entrypoint.sh\nEXPOSE 2222/tcp 80/tcp\nENTRYPOINT [\"entrypoint.sh\"]\n","originalDockerfileUglifiedHash":"172c27b2f63ceca60993258fd59b73e8","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/77136969e3cd4d8024fd0a309955d64441821766.dockerfile"}