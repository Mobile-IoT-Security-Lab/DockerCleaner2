{"seed":2100698225,"processedDockerfileHash":"fd7ced90e61837d9214906e430a34aae","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","pin-package-manager-versions-apt-get","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM php:7.1-fpm\n#   ssh2\nRUN apt-get update \\\n && apt-get install --no-install-recommends libssh2-1-dev=1.8.0-2.1 libssh2-1=1.8.0-2.1 -y\nRUN pecl install ssh2-1.1.2\nRUN echo extension=ssh2.so >> /usr/local/etc/php/conf.d/ssh2.ini\n#   ssh2\nRUN apt-get update \\\n && apt-get install --no-install-recommends libz-dev libmemcached-dev=1.0.18-4.2 -y\nRUN pecl install memcached-3.1.2\nRUN echo extension=memcached.so >> /usr/local/etc/php/conf.d/memcached.ini\n#   gd extension\nRUN apt-get update \\\n && apt-get install --no-install-recommends libpng-dev=1.6.36-6 libfreetype6-dev=2.9.1-3+deb10u3 libjpeg-dev=1:1.5.2-2+deb10u1 libxpm-dev=1:3.5.12-1 libxml2-dev=2.9.4+dfsg1-7+deb10u5 libxslt-dev libmcrypt-dev=2.5.8-3.4 librabbitmq-dev=0.9.0-0.2 libssh-dev=0.8.7-1+deb10u1 libwebp-dev=0.6.1-2+deb10u1 -y\nRUN docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ --with-xpm-dir=/usr/include --with-webp-dir=/usr/include/\nRUN pecl install amqp-1.9.3\nRUN docker-php-ext-enable amqp\nRUN docker-php-ext-install gd\nRUN docker-php-ext-install zip\nRUN docker-php-ext-install xsl\nRUN apt-get update \\\n && apt-get install --no-install-recommends libicu-dev=63.1-6+deb10u3 -y\nRUN docker-php-ext-install intl\nRUN docker-php-ext-install mysqli\nRUN docker-php-ext-install pdo_mysql\nRUN docker-php-ext-install opcache\nRUN docker-php-ext-install bcmath\nRUN docker-php-ext-install calendar\nRUN docker-php-ext-install mcrypt\nRUN docker-php-ext-install sockets\nRUN pecl install redis \\\n && docker-php-ext-enable redis\n#   ldap\nRUN apt-get update \\\n && apt-get install --no-install-recommends libldap2-dev=2.4.47+dfsg-3+deb10u7 -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && docker-php-ext-configure ldap --with-libdir=lib/x86_64-linux-gnu/ \\\n && docker-php-ext-install ldap\n#   ldap  \nRUN docker-php-ext-configure pcntl --enable-pcntl \\\n && docker-php-ext-install pcntl\nRUN pecl install xdebug-2.6.1\nRUN echo \"zend_extension=`php -i | grep ^extension_dir | cut -f 3 -d ' ' `/xdebug.so\" >> /usr/local/etc/php/conf.d/xdebug.ini\nRUN docker-php-ext-install soap\nENV COMPOSER_HOME=\"/composer\"\nCOPY --from=composer:1.8.4 /usr/bin/composer /usr/local/bin/composer\nRUN apt-get update \\\n && apt-get install --no-install-recommends git=1:2.20.1-2+deb10u8 vim=2:8.1.0875-5+deb10u4 mysql-client rsync=3.1.3-6 sshpass=1.06-1 bzip2=1.0.6-9.2~deb10u2 msmtp=1.8.3-1 unzip=6.0-23+deb10u3 -y\nCOPY php.ini /usr/local/etc/php/php.ini\n#   Cron\nRUN apt-get update \\\n && apt-get install --no-install-recommends cron=3.0pl1-134+deb10u1 -y \\\n && mkfifo --mode 0666 /var/log/cron.log \\\n && sed --regexp-extended --in-place 's/^session\\s+required\\s+pam_loginuid.so$/session optional pam_loginuid.so/' /etc/pam.d/cron\nCOPY start-cron /usr/sbin\nRUN chmod +x /usr/sbin/start-cron\n#   Cron\nENV PHP_DATE_TIMEZONE=\"\" \\\n    PHP_LOG_ERRORS_MAX_LEN=\"1024\" \\\n    PHP_LOG_ERRORS=\"\" \\\n    PHP_MAX_EXECUTION_TIME=\"0\" \\\n    PHP_MAX_FILE_UPLOADS=\"20\" \\\n    PHP_MAX_INPUT_VARS=\"1000\" \\\n    PHP_MEMORY_LIMIT=\"128M\" \\\n    PHP_POST_MAX_SIZE=\"8M\" \\\n    PHP_SENDMAIL_PATH=\"/usr/sbin/sendmail -t -i\" \\\n    PHP_SESSION_SAVE_HANDLER=\"files\" \\\n    PHP_SESSION_SAVE_PATH=\"\" \\\n    PHP_UPLOAD_MAX_FILESIZE=\"2M\" \\\n    PHP_XDEBUG_DEFAULT_ENABLE=\"0\" \\\n    PHP_XDEBUG_IDEKEY=\" PHP_XDEBUG_PROFILER_ENABLE=0\" \\\n    PHP_XDEBUG_REMOTE_AUTOSTART=\"0\" \\\n    PHP_XDEBUG_REMOTE_CONNECT_BACK=\"0\" \\\n    PHP_XDEBUG_REMOTE_ENABLE=\"0\" \\\n    PHP_XDEBUG_REMOTE_HOST=\"0\"\nWORKDIR /usr/src/app\n#   imagick\nRUN apt-get update \\\n && apt-get install --no-install-recommends libmagickwand-dev=8:6.9.10.23+dfsg-2.1+deb10u4 -y \\\n && pecl install imagick \\\n && docker-php-ext-enable imagick\n#   Install Postgre PDO\nRUN apt-get install --no-install-recommends libpq-dev=11.19-0+deb10u1 -y \\\n && docker-php-ext-configure pgsql -with-pgsql=/usr/local/pgsql \\\n && docker-php-ext-install pdo_pgsql pgsql\nRUN pecl install pcov-1.0.0\nRUN docker-php-ext-enable pcov\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\n","originalDockerfile":"FROM php:7.1-fpm\n#  ssh2\nRUN apt-get update \\\n && apt-get install libssh2-1-dev libssh2-1 -y\nRUN pecl install ssh2-1.1.2\nRUN echo extension=ssh2.so >> /usr/local/etc/php/conf.d/ssh2.ini\n#  ssh2\nRUN apt-get update \\\n && apt-get install libz-dev libmemcached-dev -y\nRUN pecl install memcached-3.1.2\nRUN echo extension=memcached.so >> /usr/local/etc/php/conf.d/memcached.ini\n#  gd extension\nRUN apt-get update \\\n && apt-get install libpng-dev libfreetype6-dev libjpeg-dev libxpm-dev libxml2-dev libxslt-dev libmcrypt-dev librabbitmq-dev libssh-dev libwebp-dev -y\nRUN docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ --with-xpm-dir=/usr/include --with-webp-dir=/usr/include/\nRUN pecl install amqp-1.9.3\nRUN docker-php-ext-enable amqp\nRUN docker-php-ext-install gd\nRUN docker-php-ext-install zip\nRUN docker-php-ext-install xsl\nRUN apt-get update \\\n && apt-get install libicu-dev -y\nRUN docker-php-ext-install intl\nRUN docker-php-ext-install mysqli\nRUN docker-php-ext-install pdo_mysql\nRUN docker-php-ext-install opcache\nRUN docker-php-ext-install bcmath\nRUN docker-php-ext-install calendar\nRUN docker-php-ext-install mcrypt\nRUN docker-php-ext-install sockets\nRUN pecl install redis \\\n && docker-php-ext-enable redis\n#  ldap\nRUN apt-get update \\\n && apt-get install libldap2-dev -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && docker-php-ext-configure ldap --with-libdir=lib/x86_64-linux-gnu/ \\\n && docker-php-ext-install ldap\n#  ldap  \nRUN docker-php-ext-configure pcntl --enable-pcntl \\\n && docker-php-ext-install pcntl\nRUN pecl install xdebug-2.6.1\nRUN echo \"zend_extension=`php -i | grep ^extension_dir | cut -f 3 -d ' ' `/xdebug.so\" >> /usr/local/etc/php/conf.d/xdebug.ini\nRUN docker-php-ext-install soap\nENV COMPOSER_HOME=\"/composer\"\nCOPY --from=composer:1.8.4 /usr/bin/composer /usr/local/bin/composer\nRUN apt-get update \\\n && apt-get install git vim mysql-client rsync sshpass bzip2 msmtp unzip -y\nADD php.ini /usr/local/etc/php/php.ini\n#  Cron\nRUN apt-get update \\\n && apt-get install cron -y \\\n && mkfifo --mode 0666 /var/log/cron.log \\\n && sed --regexp-extended --in-place 's/^session\\s+required\\s+pam_loginuid.so$/session optional pam_loginuid.so/' /etc/pam.d/cron\nCOPY start-cron /usr/sbin\nRUN chmod +x /usr/sbin/start-cron\n#  Cron\nENV PHP_DATE_TIMEZONE=\"\" \\\n    PHP_LOG_ERRORS_MAX_LEN=\"1024\" \\\n    PHP_LOG_ERRORS=\"\" \\\n    PHP_MAX_EXECUTION_TIME=\"0\" \\\n    PHP_MAX_FILE_UPLOADS=\"20\" \\\n    PHP_MAX_INPUT_VARS=\"1000\" \\\n    PHP_MEMORY_LIMIT=\"128M\" \\\n    PHP_POST_MAX_SIZE=\"8M\" \\\n    PHP_SENDMAIL_PATH=\"/usr/sbin/sendmail -t -i\" \\\n    PHP_SESSION_SAVE_HANDLER=\"files\" \\\n    PHP_SESSION_SAVE_PATH=\"\" \\\n    PHP_UPLOAD_MAX_FILESIZE=\"2M\" \\\n    PHP_XDEBUG_DEFAULT_ENABLE=\"0\" \\\n    PHP_XDEBUG_IDEKEY=\" PHP_XDEBUG_PROFILER_ENABLE=0\" \\\n    PHP_XDEBUG_REMOTE_AUTOSTART=\"0\" \\\n    PHP_XDEBUG_REMOTE_CONNECT_BACK=\"0\" \\\n    PHP_XDEBUG_REMOTE_ENABLE=\"0\" \\\n    PHP_XDEBUG_REMOTE_HOST=\"0\"\nWORKDIR /usr/src/app\n#  imagick\nRUN apt-get update \\\n && apt-get install libmagickwand-dev -y \\\n && pecl install imagick \\\n && docker-php-ext-enable imagick\n#  Install Postgre PDO\nRUN apt-get install libpq-dev -y \\\n && docker-php-ext-configure pgsql -with-pgsql=/usr/local/pgsql \\\n && docker-php-ext-install pdo_pgsql pgsql\nRUN pecl install pcov-1.0.0\nRUN docker-php-ext-enable pcov\n","injectedSmells":[],"originalDockerfileHash":"09183b7652618262860822ae7d361c71","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM php:7.1-fpm\n#   ssh2\nRUN apt-get update \\\n && apt-get install libssh2-1-dev libssh2-1 -y\nRUN pecl install ssh2-1.1.2\nRUN echo extension=ssh2.so >> /usr/local/etc/php/conf.d/ssh2.ini\n#   ssh2\nRUN apt-get update \\\n && apt-get install libz-dev libmemcached-dev -y\nRUN pecl install memcached-3.1.2\nRUN echo extension=memcached.so >> /usr/local/etc/php/conf.d/memcached.ini\n#   gd extension\nRUN apt-get update \\\n && apt-get install libpng-dev libfreetype6-dev libjpeg-dev libxpm-dev libxml2-dev libxslt-dev libmcrypt-dev librabbitmq-dev libssh-dev libwebp-dev -y\nRUN docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ --with-xpm-dir=/usr/include --with-webp-dir=/usr/include/\nRUN pecl install amqp-1.9.3\nRUN docker-php-ext-enable amqp\nRUN docker-php-ext-install gd\nRUN docker-php-ext-install zip\nRUN docker-php-ext-install xsl\nRUN apt-get update \\\n && apt-get install libicu-dev -y\nRUN docker-php-ext-install intl\nRUN docker-php-ext-install mysqli\nRUN docker-php-ext-install pdo_mysql\nRUN docker-php-ext-install opcache\nRUN docker-php-ext-install bcmath\nRUN docker-php-ext-install calendar\nRUN docker-php-ext-install mcrypt\nRUN docker-php-ext-install sockets\nRUN pecl install redis \\\n && docker-php-ext-enable redis\n#   ldap\nRUN apt-get update \\\n && apt-get install libldap2-dev -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && docker-php-ext-configure ldap --with-libdir=lib/x86_64-linux-gnu/ \\\n && docker-php-ext-install ldap\n#   ldap  \nRUN docker-php-ext-configure pcntl --enable-pcntl \\\n && docker-php-ext-install pcntl\nRUN pecl install xdebug-2.6.1\nRUN echo \"zend_extension=`php -i | grep ^extension_dir | cut -f 3 -d ' ' `/xdebug.so\" >> /usr/local/etc/php/conf.d/xdebug.ini\nRUN docker-php-ext-install soap\nENV COMPOSER_HOME=\"/composer\"\nCOPY --from=composer:1.8.4 /usr/bin/composer /usr/local/bin/composer\nRUN apt-get update \\\n && apt-get install git vim mysql-client rsync sshpass bzip2 msmtp unzip -y\nADD php.ini /usr/local/etc/php/php.ini\n#   Cron\nRUN apt-get update \\\n && apt-get install cron -y \\\n && mkfifo --mode 0666 /var/log/cron.log \\\n && sed --regexp-extended --in-place 's/^session\\s+required\\s+pam_loginuid.so$/session optional pam_loginuid.so/' /etc/pam.d/cron\nCOPY start-cron /usr/sbin\nRUN chmod +x /usr/sbin/start-cron\n#   Cron\nENV PHP_DATE_TIMEZONE=\"\" \\\n    PHP_LOG_ERRORS_MAX_LEN=\"1024\" \\\n    PHP_LOG_ERRORS=\"\" \\\n    PHP_MAX_EXECUTION_TIME=\"0\" \\\n    PHP_MAX_FILE_UPLOADS=\"20\" \\\n    PHP_MAX_INPUT_VARS=\"1000\" \\\n    PHP_MEMORY_LIMIT=\"128M\" \\\n    PHP_POST_MAX_SIZE=\"8M\" \\\n    PHP_SENDMAIL_PATH=\"/usr/sbin/sendmail -t -i\" \\\n    PHP_SESSION_SAVE_HANDLER=\"files\" \\\n    PHP_SESSION_SAVE_PATH=\"\" \\\n    PHP_UPLOAD_MAX_FILESIZE=\"2M\" \\\n    PHP_XDEBUG_DEFAULT_ENABLE=\"0\" \\\n    PHP_XDEBUG_IDEKEY=\" PHP_XDEBUG_PROFILER_ENABLE=0\" \\\n    PHP_XDEBUG_REMOTE_AUTOSTART=\"0\" \\\n    PHP_XDEBUG_REMOTE_CONNECT_BACK=\"0\" \\\n    PHP_XDEBUG_REMOTE_ENABLE=\"0\" \\\n    PHP_XDEBUG_REMOTE_HOST=\"0\"\nWORKDIR /usr/src/app\n#   imagick\nRUN apt-get update \\\n && apt-get install libmagickwand-dev -y \\\n && pecl install imagick \\\n && docker-php-ext-enable imagick\n#   Install Postgre PDO\nRUN apt-get install libpq-dev -y \\\n && docker-php-ext-configure pgsql -with-pgsql=/usr/local/pgsql \\\n && docker-php-ext-install pdo_pgsql pgsql\nRUN pecl install pcov-1.0.0\nRUN docker-php-ext-enable pcov\n","originalDockerfileUglifiedHash":"784d258fed64bd7d9faa68f110cc490d","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/63a9ab38d255518dea771aabd5860c8576fd112f.dockerfile"}