{"seed":4265942358,"processedDockerfileHash":"6bc1cbedd078341f95015d5edd3887b2","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apt-get","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM ubuntu:16.04\nMAINTAINER Antonin Bas <antonin@barefootnetworks.com>\nARG MAKEFLAGS\nENV MAKEFLAGS=\"${MAKEFLAGS:--j2}\"\nRUN apt-get update \\\n && apt-get install --no-install-recommends git=1:2.7.4-0ubuntu1.10 ca-certificates=20210119~16.04.1 -y\n#   Build Protocol Buffers.\nENV PROTOCOL_BUFFERS_DEPS=\"autoconf  automake  g++  libtool  make  curl  unzip\"\nRUN git clone https://github.com/google/protobuf.git\nWORKDIR /protobuf/\nRUN git checkout tags/v3.2.0\nRUN apt-get update \\\n && apt-get install --no-install-recommends $PROTOCOL_BUFFERS_DEPS -y \\\n && export CFLAGS=\"-Os\" \\\n && export CXXFLAGS=\"-Os\" \\\n && export LDFLAGS=\"-Wl,-s\" \\\n && ./autogen.sh \\\n && ./configure \\\n && make \\\n && make install \\\n && ldconfig \\\n && apt-get purge -y $PROTOCOL_BUFFERS_DEPS \\\n && apt-get autoremove --purge -y \\\n && rm -rf /protobuf /var/cache/apt/* /var/lib/apt/lists/* /var/cache/debconf/* /var/lib/dpkg/*-old /var/log/*\nWORKDIR /\n#   Build gRPC.\n#   The gRPC build system should detect that a version of protobuf is already\n#   installed and should not try to install the third-party one included as a\n#   submodule in the grpc repository.\nENV GRPC_DEPS=\"build-essential  autoconf  libtool\"\nRUN git clone https://github.com/google/grpc.git\nWORKDIR /grpc/\nRUN git checkout tags/v1.3.2 \\\n && git submodule update --init --recursive\nRUN apt-get update \\\n && apt-get install --no-install-recommends libgflags-dev=2.1.2-3 $GRPC_DEPS -y \\\n && export LDFLAGS=\"-Wl,-s\" \\\n && make \\\n && make grpc_cli \\\n && make install \\\n && ldconfig \\\n && cp /grpc/bins/opt/grpc_cli /usr/bin/ \\\n && apt-get purge -y $GRPC_DEPS \\\n && apt-get autoremove --purge -y \\\n && rm -rf /grpc /var/cache/apt/* /var/lib/apt/lists/* /var/cache/debconf/* /var/lib/dpkg/*-old /var/log/*\nWORKDIR /\nENV BM_DEPS=\"automake  build-essential  libjudy-dev  libgmp-dev  libpcap-dev  libboost-dev  libboost-program-options-dev  libboost-system-dev  libboost-filesystem-dev  libboost-thread-dev  libtool  pkg-config\"\nRUN apt-get update \\\n && apt-get install --no-install-recommends $BM_DEPS -y\nRUN which wget &> /dev/null || apt-get install --no-install-recommends wget=1.20.3 ; wget --no-verbose --output-document .PI.head.json https://api.github.com/repos/p4lang/PI/git/refs/heads/master\nRUN git clone https://github.com/p4lang/PI/\nWORKDIR /PI\nRUN git submodule update --init --recursive\nRUN export CFLAGS=\"-O0\" \\\n && export CXXFLAGS=\"-O0\" \\\n && ./autogen.sh \\\n && ./configure --with-proto --without-cli --without-internal-rpc \\\n && make \\\n && make install \\\n && ldconfig \\\n && rm -rf /PI/\nWORKDIR /\nCOPY . /behavioral-model/\nWORKDIR /behavioral-model/\nRUN export CFLAGS=\"-O0\" \\\n && export CXXFLAGS=\"-O0\" \\\n && ./autogen.sh \\\n && ./configure --without-thrift --without-nanomsg --with-pi \\\n && make \\\n && make install \\\n && ldconfig\nWORKDIR /behavioral-model/targets/simple_switch_grpc\nRUN export CFLAGS=\"-O0\" \\\n && export CXXFLAGS=\"-O0\" \\\n && ./autogen.sh \\\n && ./configure \\\n && make\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM ubuntu:16.04\nMAINTAINER Antonin Bas <antonin@barefootnetworks.com>\nARG MAKEFLAGS\nENV MAKEFLAGS=\"${MAKEFLAGS:--j2}\"\nRUN apt-get update \\\n && apt-get install --no-install-recommends git ca-certificates -y\n#  Build Protocol Buffers.\nENV PROTOCOL_BUFFERS_DEPS=\"autoconf  automake  g++  libtool  make  curl  unzip\"\nRUN git clone https://github.com/google/protobuf.git\nWORKDIR /protobuf/\nRUN git checkout tags/v3.2.0\nRUN apt-get update \\\n && apt-get install --no-install-recommends $PROTOCOL_BUFFERS_DEPS -y \\\n && export CFLAGS=\"-Os\" \\\n && export CXXFLAGS=\"-Os\" \\\n && export LDFLAGS=\"-Wl,-s\" \\\n && ./autogen.sh \\\n && ./configure \\\n && make \\\n && make install \\\n && ldconfig \\\n && apt-get purge -y $PROTOCOL_BUFFERS_DEPS \\\n && apt-get autoremove --purge -y \\\n && rm -rf /protobuf /var/cache/apt/* /var/lib/apt/lists/* /var/cache/debconf/* /var/lib/dpkg/*-old /var/log/*\nWORKDIR /\n#  Build gRPC.\n#  The gRPC build system should detect that a version of protobuf is already\n#  installed and should not try to install the third-party one included as a\n#  submodule in the grpc repository.\nENV GRPC_DEPS=\"build-essential  autoconf  libtool\"\nRUN git clone https://github.com/google/grpc.git\nWORKDIR /grpc/\nRUN git checkout tags/v1.3.2 \\\n && git submodule update --init --recursive\nRUN apt-get update \\\n && apt-get install --no-install-recommends libgflags-dev $GRPC_DEPS -y \\\n && export LDFLAGS=\"-Wl,-s\" \\\n && make \\\n && make grpc_cli \\\n && make install \\\n && ldconfig \\\n && cp /grpc/bins/opt/grpc_cli /usr/bin/ \\\n && apt-get purge -y $GRPC_DEPS \\\n && apt-get autoremove --purge -y \\\n && rm -rf /grpc /var/cache/apt/* /var/lib/apt/lists/* /var/cache/debconf/* /var/lib/dpkg/*-old /var/log/*\nWORKDIR /\nENV BM_DEPS=\"automake  build-essential  libjudy-dev  libgmp-dev  libpcap-dev  libboost-dev  libboost-program-options-dev  libboost-system-dev  libboost-filesystem-dev  libboost-thread-dev  libtool  pkg-config\"\nRUN apt-get update \\\n && apt-get install --no-install-recommends $BM_DEPS -y\nADD https://api.github.com/repos/p4lang/PI/git/refs/heads/master .PI.head.json\nRUN git clone https://github.com/p4lang/PI/\nWORKDIR /PI\nRUN git submodule update --init --recursive\nRUN export CFLAGS=\"-O0\" \\\n && export CXXFLAGS=\"-O0\" \\\n && ./autogen.sh \\\n && ./configure --with-proto --without-cli --without-internal-rpc \\\n && make \\\n && make install \\\n && ldconfig \\\n && rm -rf /PI/\nWORKDIR /\nCOPY . /behavioral-model/\nWORKDIR /behavioral-model/\nRUN export CFLAGS=\"-O0\" \\\n && export CXXFLAGS=\"-O0\" \\\n && ./autogen.sh \\\n && ./configure --without-thrift --without-nanomsg --with-pi \\\n && make \\\n && make install \\\n && ldconfig\nWORKDIR /behavioral-model/targets/simple_switch_grpc\nRUN export CFLAGS=\"-O0\" \\\n && export CXXFLAGS=\"-O0\" \\\n && ./autogen.sh \\\n && ./configure \\\n && make\n","injectedSmells":[],"originalDockerfileHash":"2ecaff622049c098c7d6aef1fe451d56","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM ubuntu:16.04\nMAINTAINER Antonin Bas <antonin@barefootnetworks.com>\nARG MAKEFLAGS\nENV MAKEFLAGS=\"${MAKEFLAGS:--j2}\"\nRUN apt-get update \\\n && apt-get install --no-install-recommends git ca-certificates -y\n#   Build Protocol Buffers.\nENV PROTOCOL_BUFFERS_DEPS=\"autoconf  automake  g++  libtool  make  curl  unzip\"\nRUN git clone https://github.com/google/protobuf.git\nWORKDIR /protobuf/\nRUN git checkout tags/v3.2.0\nRUN apt-get update \\\n && apt-get install --no-install-recommends $PROTOCOL_BUFFERS_DEPS -y \\\n && export CFLAGS=\"-Os\" \\\n && export CXXFLAGS=\"-Os\" \\\n && export LDFLAGS=\"-Wl,-s\" \\\n && ./autogen.sh \\\n && ./configure \\\n && make \\\n && make install \\\n && ldconfig \\\n && apt-get purge -y $PROTOCOL_BUFFERS_DEPS \\\n && apt-get autoremove --purge -y \\\n && rm -rf /protobuf /var/cache/apt/* /var/lib/apt/lists/* /var/cache/debconf/* /var/lib/dpkg/*-old /var/log/*\nWORKDIR /\n#   Build gRPC.\n#   The gRPC build system should detect that a version of protobuf is already\n#   installed and should not try to install the third-party one included as a\n#   submodule in the grpc repository.\nENV GRPC_DEPS=\"build-essential  autoconf  libtool\"\nRUN git clone https://github.com/google/grpc.git\nWORKDIR /grpc/\nRUN git checkout tags/v1.3.2 \\\n && git submodule update --init --recursive\nRUN apt-get update \\\n && apt-get install --no-install-recommends libgflags-dev $GRPC_DEPS -y \\\n && export LDFLAGS=\"-Wl,-s\" \\\n && make \\\n && make grpc_cli \\\n && make install \\\n && ldconfig \\\n && cp /grpc/bins/opt/grpc_cli /usr/bin/ \\\n && apt-get purge -y $GRPC_DEPS \\\n && apt-get autoremove --purge -y \\\n && rm -rf /grpc /var/cache/apt/* /var/lib/apt/lists/* /var/cache/debconf/* /var/lib/dpkg/*-old /var/log/*\nWORKDIR /\nENV BM_DEPS=\"automake  build-essential  libjudy-dev  libgmp-dev  libpcap-dev  libboost-dev  libboost-program-options-dev  libboost-system-dev  libboost-filesystem-dev  libboost-thread-dev  libtool  pkg-config\"\nRUN apt-get update \\\n && apt-get install --no-install-recommends $BM_DEPS -y\nADD https://api.github.com/repos/p4lang/PI/git/refs/heads/master .PI.head.json\nRUN git clone https://github.com/p4lang/PI/\nWORKDIR /PI\nRUN git submodule update --init --recursive\nRUN export CFLAGS=\"-O0\" \\\n && export CXXFLAGS=\"-O0\" \\\n && ./autogen.sh \\\n && ./configure --with-proto --without-cli --without-internal-rpc \\\n && make \\\n && make install \\\n && ldconfig \\\n && rm -rf /PI/\nWORKDIR /\nCOPY . /behavioral-model/\nWORKDIR /behavioral-model/\nRUN export CFLAGS=\"-O0\" \\\n && export CXXFLAGS=\"-O0\" \\\n && ./autogen.sh \\\n && ./configure --without-thrift --without-nanomsg --with-pi \\\n && make \\\n && make install \\\n && ldconfig\nWORKDIR /behavioral-model/targets/simple_switch_grpc\nRUN export CFLAGS=\"-O0\" \\\n && export CXXFLAGS=\"-O0\" \\\n && ./autogen.sh \\\n && ./configure \\\n && make\n","originalDockerfileUglifiedHash":"26542961036810f3ef64a7c62f358251","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/dee4219852f65921ee889e0d40582883e0c43b20.dockerfile"}