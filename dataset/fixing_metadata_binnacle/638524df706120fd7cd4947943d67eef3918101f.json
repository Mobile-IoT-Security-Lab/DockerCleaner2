{"seed":3512977649,"processedDockerfileHash":"d17c45b43dfee2942024d37e60bf0b87","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM ubuntu:16.04\nLABEL maintainer=\"Muhammad Surya Ihsanuddin<surya.kejawen@gmail.com>\"\nENV DEBIAN_FRONTEND=\"noninteractive\"\nRUN sed -i 's/http:\\/\\/archive.ubuntu.com/http:\\/\\/buaya.klas.or.id/g' /etc/apt/sources.list\n#   Install Software\nRUN : \\\n && apt-get upgrade -y\nRUN (apt-get update ;apt-get install --no-install-recommends nginx-full=1.10.3-0ubuntu0.16.04.5 supervisor=3.2.0-2ubuntu0.2 vim=2:7.4.1689-3ubuntu1.5 varnish=4.1.1-1ubuntu0.2 -y )\nRUN (apt-get update ;apt-get install --no-install-recommends software-properties-common=0.96.20.10 python-software-properties=0.96.20.10 build-essential=12.1ubuntu2 -y )\nRUN (apt-get update ;apt-get install --no-install-recommends curl=7.47.0-1ubuntu2.19 ca-certificates=20210119~16.04.1 -y )\nRUN touch /etc/apt/sources.list.d/ondrej-php.list\nRUN echo \"deb http://ppa.launchpad.net/ondrej/php/ubuntu xenial main\" >> /etc/apt/sources.list.d/ondrej-php.list\nRUN echo \"deb-src http://ppa.launchpad.net/ondrej/php/ubuntu xenial main\" >> /etc/apt/sources.list.d/ondrej-php.list\nRUN apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys 4F4EA0AAE5267A6C\nRUN :\nRUN (apt-get update ;apt-get install --no-install-recommends php7.2 php7.2-cli php7.2-curl php7.2-intl php7.2-mbstring php7.2-xml php7.2-zip php7.2-bcmath php7.2-cli php7.2-fpm php7.2-imap php7.2-json php7.2-opcache php7.2-apcu php7.2-xmlrpc php7.2-bz2 php7.2-common php7.2-gd php7.2-ldap php7.2-pgsql php7.2-readline php7.2-soap php7.2-tidy php7.2-xsl php-apcu=5.1.3+4.0.10-1build1 -y )\nRUN curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin --filename=composer\nRUN apt-get remove --purge -y software-properties-common python-software-properties \\\n && apt-get autoremove -y \\\n && apt-get clean \\\n && apt-get autoclean\nRUN rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* /usr/share/doc/* ~/.composer\n#   Setup Environment\nENV NGINX_WEBROOT=\"/semarthris/public\"\nENV SYMFONY_ENV=\"dev\"\nENV VARNISH_CONFIG=\"/etc/varnish/default.vcl\"\nENV CACHE_SIZE=\"512m\"\nENV VARNISHD_PARAMS=\"-p default_ttl=3600 -p default_grace=3600\"\nENV VARNISH_PORT=\"80\"\nENV BACKEND_HOST=\"localhost\"\nENV BACKEND_PORT=\"8080\"\n#   Supervisor Configuration\nCOPY docker/supervisor/supervisor.conf /etc/supervisord.conf\n#   Nginx Configuration\nCOPY docker/nginx/sites-enabled/site.conf /etc/nginx/conf.d/default.conf\nCOPY docker/nginx/sites-enabled/php-fpm.conf /etc/nginx/conf.d/php-fpm.conf\nCOPY docker/nginx/nginx.conf /etc/nginx/nginx.conf\nCOPY docker/nginx/fastcgi_cache /etc/nginx/fastcgi_cache\nCOPY docker/nginx/static_files.conf /etc/nginx/static_files.conf\nCOPY docker/nginx/logs/site.access.log /var/log/nginx/site.access.log\nCOPY docker/nginx/logs/site.error.log /var/log/nginx/site.error.log\nCOPY docker/nginx/etc/sysctl.conf /etc/sysctl.conf\nCOPY docker/nginx/etc/security/limits.conf /etc/security/limits.conf\nRUN mkdir -p /tmp/nginx/cache\nRUN chmod 777 -R /tmp/nginx\nRUN chmod 777 /var/log/nginx/site.access.log\nRUN chmod 777 /var/log/nginx/site.error.log\n#   PHP Configuration\nCOPY docker/php/php.ini /etc/php/7.2/fpm/php.ini\nCOPY docker/php/php.ini /etc/php/7.2/cli/php.ini\nCOPY docker/php/php-fpm.conf /etc/php/7.2/fpm/php-fpm.conf\nRUN mkdir /run/php\nRUN touch /run/php/php7.2-fpm.sock\nRUN chmod 777 /run/php/php7.2-fpm.sock\n#   Varnish Configuration\nCOPY docker/varnish/default.vcl /etc/varnish/default.vcl\n#   Setup Application\nENV COMPOSER_ALLOW_SUPERUSER=\"1\"\nRUN composer global require \"hirak/prestissimo:~0.3\" --prefer-dist --no-progress --no-suggest --optimize-autoloader --classmap-authoritative -vvv \\\n && composer clear-cache\nWORKDIR /semarthris\nCOPY composer.json ./\nCOPY composer.lock ./\nRUN mkdir -p var/cache var/logs var/sessions \\\n && chmod 777 -R var/ \\\n && composer update --prefer-dist --no-autoloader --no-scripts --no-progress --no-suggest -vvv \\\n && composer clear-cache\nCOPY bin bin/\nCOPY config config/\nCOPY data data/\nCOPY public public/\nCOPY src src/\nCOPY templates templates/\nCOPY .env.dist ./.env.dist\nRUN composer dump-autoload --optimize --classmap-authoritative\n#   Here we go\nCOPY docker/start.sh /start.sh\nRUN chmod +x /start.sh\nEXPOSE 443/tcp 80/tcp\nCMD [\"/start.sh\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM ubuntu:16.04\nLABEL maintainer=\"Muhammad Surya Ihsanuddin<surya.kejawen@gmail.com>\"\nENV DEBIAN_FRONTEND=\"noninteractive\"\nRUN sed -i 's/http:\\/\\/archive.ubuntu.com/http:\\/\\/buaya.klas.or.id/g' /etc/apt/sources.list\n#  Install Software\nRUN apt-get update \\\n && apt-get upgrade -y\nRUN apt-get install nginx-full supervisor vim varnish -y\nRUN apt-get install software-properties-common python-software-properties build-essential -y\nRUN apt-get install curl ca-certificates -y\nRUN touch /etc/apt/sources.list.d/ondrej-php.list\nRUN echo \"deb http://ppa.launchpad.net/ondrej/php/ubuntu xenial main\" >> /etc/apt/sources.list.d/ondrej-php.list\nRUN echo \"deb-src http://ppa.launchpad.net/ondrej/php/ubuntu xenial main\" >> /etc/apt/sources.list.d/ondrej-php.list\nRUN apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys 4F4EA0AAE5267A6C\nRUN apt-get update\nRUN apt-get install php7.2 php7.2-cli php7.2-curl php7.2-intl php7.2-mbstring php7.2-xml php7.2-zip php7.2-bcmath php7.2-cli php7.2-fpm php7.2-imap php7.2-json php7.2-opcache php7.2-apcu php7.2-xmlrpc php7.2-bz2 php7.2-common php7.2-gd php7.2-ldap php7.2-pgsql php7.2-readline php7.2-soap php7.2-tidy php7.2-xsl php-apcu -y\nRUN curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin --filename=composer\nRUN apt-get remove --purge -y software-properties-common python-software-properties \\\n && apt-get autoremove -y \\\n && apt-get clean \\\n && apt-get autoclean\nRUN rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* /usr/share/doc/* ~/.composer\n#  Setup Environment\nENV NGINX_WEBROOT=\"/semarthris/public\"\nENV SYMFONY_ENV=\"dev\"\nENV VARNISH_CONFIG=\"/etc/varnish/default.vcl\"\nENV CACHE_SIZE=\"512m\"\nENV VARNISHD_PARAMS=\"-p default_ttl=3600 -p default_grace=3600\"\nENV VARNISH_PORT=\"80\"\nENV BACKEND_HOST=\"localhost\"\nENV BACKEND_PORT=\"8080\"\n#  Supervisor Configuration\nADD docker/supervisor/supervisor.conf /etc/supervisord.conf\n#  Nginx Configuration\nADD docker/nginx/sites-enabled/site.conf /etc/nginx/conf.d/default.conf\nADD docker/nginx/sites-enabled/php-fpm.conf /etc/nginx/conf.d/php-fpm.conf\nADD docker/nginx/nginx.conf /etc/nginx/nginx.conf\nADD docker/nginx/fastcgi_cache /etc/nginx/fastcgi_cache\nADD docker/nginx/static_files.conf /etc/nginx/static_files.conf\nADD docker/nginx/logs/site.access.log /var/log/nginx/site.access.log\nADD docker/nginx/logs/site.error.log /var/log/nginx/site.error.log\nADD docker/nginx/etc/sysctl.conf /etc/sysctl.conf\nADD docker/nginx/etc/security/limits.conf /etc/security/limits.conf\nRUN mkdir -p /tmp/nginx/cache\nRUN chmod 777 -R /tmp/nginx\nRUN chmod 777 /var/log/nginx/site.access.log\nRUN chmod 777 /var/log/nginx/site.error.log\n#  PHP Configuration\nADD docker/php/php.ini /etc/php/7.2/fpm/php.ini\nADD docker/php/php.ini /etc/php/7.2/cli/php.ini\nADD docker/php/php-fpm.conf /etc/php/7.2/fpm/php-fpm.conf\nRUN mkdir /run/php\nRUN touch /run/php/php7.2-fpm.sock\nRUN chmod 777 /run/php/php7.2-fpm.sock\n#  Varnish Configuration\nADD docker/varnish/default.vcl /etc/varnish/default.vcl\n#  Setup Application\nENV COMPOSER_ALLOW_SUPERUSER=\"1\"\nRUN composer global require \"hirak/prestissimo:~0.3\" --prefer-dist --no-progress --no-suggest --optimize-autoloader --classmap-authoritative -vvv \\\n && composer clear-cache\nWORKDIR /semarthris\nCOPY composer.json ./\nCOPY composer.lock ./\nRUN mkdir -p var/cache var/logs var/sessions \\\n && chmod 777 -R var/ \\\n && composer update --prefer-dist --no-autoloader --no-scripts --no-progress --no-suggest -vvv \\\n && composer clear-cache\nCOPY bin bin/\nCOPY config config/\nCOPY data data/\nCOPY public public/\nCOPY src src/\nCOPY templates templates/\nCOPY .env.dist ./.env.dist\nRUN composer dump-autoload --optimize --classmap-authoritative\n#  Here we go\nADD docker/start.sh /start.sh\nRUN chmod +x /start.sh\nEXPOSE 443/tcp 80/tcp\nCMD [\"/start.sh\"]\n","injectedSmells":[],"originalDockerfileHash":"2f59de9c3d6c503a02d4f1f2d163c8f1","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM ubuntu:16.04\nLABEL maintainer=\"Muhammad Surya Ihsanuddin<surya.kejawen@gmail.com>\"\nENV DEBIAN_FRONTEND=\"noninteractive\"\nRUN sed -i 's/http:\\/\\/archive.ubuntu.com/http:\\/\\/buaya.klas.or.id/g' /etc/apt/sources.list\n#   Install Software\nRUN apt-get update \\\n && apt-get upgrade -y\nRUN apt-get install nginx-full supervisor vim varnish -y\nRUN apt-get install software-properties-common python-software-properties build-essential -y\nRUN apt-get install curl ca-certificates -y\nRUN touch /etc/apt/sources.list.d/ondrej-php.list\nRUN echo \"deb http://ppa.launchpad.net/ondrej/php/ubuntu xenial main\" >> /etc/apt/sources.list.d/ondrej-php.list\nRUN echo \"deb-src http://ppa.launchpad.net/ondrej/php/ubuntu xenial main\" >> /etc/apt/sources.list.d/ondrej-php.list\nRUN apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys 4F4EA0AAE5267A6C\nRUN apt-get update\nRUN apt-get install php7.2 php7.2-cli php7.2-curl php7.2-intl php7.2-mbstring php7.2-xml php7.2-zip php7.2-bcmath php7.2-cli php7.2-fpm php7.2-imap php7.2-json php7.2-opcache php7.2-apcu php7.2-xmlrpc php7.2-bz2 php7.2-common php7.2-gd php7.2-ldap php7.2-pgsql php7.2-readline php7.2-soap php7.2-tidy php7.2-xsl php-apcu -y\nRUN curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin --filename=composer\nRUN apt-get remove --purge -y software-properties-common python-software-properties \\\n && apt-get autoremove -y \\\n && apt-get clean \\\n && apt-get autoclean\nRUN rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* /usr/share/doc/* ~/.composer\n#   Setup Environment\nENV NGINX_WEBROOT=\"/semarthris/public\"\nENV SYMFONY_ENV=\"dev\"\nENV VARNISH_CONFIG=\"/etc/varnish/default.vcl\"\nENV CACHE_SIZE=\"512m\"\nENV VARNISHD_PARAMS=\"-p default_ttl=3600 -p default_grace=3600\"\nENV VARNISH_PORT=\"80\"\nENV BACKEND_HOST=\"localhost\"\nENV BACKEND_PORT=\"8080\"\n#   Supervisor Configuration\nADD docker/supervisor/supervisor.conf /etc/supervisord.conf\n#   Nginx Configuration\nADD docker/nginx/sites-enabled/site.conf /etc/nginx/conf.d/default.conf\nADD docker/nginx/sites-enabled/php-fpm.conf /etc/nginx/conf.d/php-fpm.conf\nADD docker/nginx/nginx.conf /etc/nginx/nginx.conf\nADD docker/nginx/fastcgi_cache /etc/nginx/fastcgi_cache\nADD docker/nginx/static_files.conf /etc/nginx/static_files.conf\nADD docker/nginx/logs/site.access.log /var/log/nginx/site.access.log\nADD docker/nginx/logs/site.error.log /var/log/nginx/site.error.log\nADD docker/nginx/etc/sysctl.conf /etc/sysctl.conf\nADD docker/nginx/etc/security/limits.conf /etc/security/limits.conf\nRUN mkdir -p /tmp/nginx/cache\nRUN chmod 777 -R /tmp/nginx\nRUN chmod 777 /var/log/nginx/site.access.log\nRUN chmod 777 /var/log/nginx/site.error.log\n#   PHP Configuration\nADD docker/php/php.ini /etc/php/7.2/fpm/php.ini\nADD docker/php/php.ini /etc/php/7.2/cli/php.ini\nADD docker/php/php-fpm.conf /etc/php/7.2/fpm/php-fpm.conf\nRUN mkdir /run/php\nRUN touch /run/php/php7.2-fpm.sock\nRUN chmod 777 /run/php/php7.2-fpm.sock\n#   Varnish Configuration\nADD docker/varnish/default.vcl /etc/varnish/default.vcl\n#   Setup Application\nENV COMPOSER_ALLOW_SUPERUSER=\"1\"\nRUN composer global require \"hirak/prestissimo:~0.3\" --prefer-dist --no-progress --no-suggest --optimize-autoloader --classmap-authoritative -vvv \\\n && composer clear-cache\nWORKDIR /semarthris\nCOPY composer.json ./\nCOPY composer.lock ./\nRUN mkdir -p var/cache var/logs var/sessions \\\n && chmod 777 -R var/ \\\n && composer update --prefer-dist --no-autoloader --no-scripts --no-progress --no-suggest -vvv \\\n && composer clear-cache\nCOPY bin bin/\nCOPY config config/\nCOPY data data/\nCOPY public public/\nCOPY src src/\nCOPY templates templates/\nCOPY .env.dist ./.env.dist\nRUN composer dump-autoload --optimize --classmap-authoritative\n#   Here we go\nADD docker/start.sh /start.sh\nRUN chmod +x /start.sh\nEXPOSE 443/tcp 80/tcp\nCMD [\"/start.sh\"]\n","originalDockerfileUglifiedHash":"62ac141a6777a3e584faddff0b5d3371","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/638524df706120fd7cd4947943d67eef3918101f.dockerfile"}