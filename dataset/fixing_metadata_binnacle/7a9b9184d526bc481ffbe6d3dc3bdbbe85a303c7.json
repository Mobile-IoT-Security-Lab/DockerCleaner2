{"seed":1567973008,"processedDockerfileHash":"f0f97b183aee4ca4c78b40c247faf684","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-gem","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM centos:6\n#   general build stuff\nRUN yum update -y \\\n && yum groupinstall -y \"Development Tools\" \\\n && yum install -y wget tar\n#   have to build our own ruby since centos6 ships with ruby1.8 and ruby-vips\n#   needs 1.9+\n#   stuff for a ruby build\nRUN yum install -y libxslt-devel libyaml-devel libxml2-devel gdbm-devel libffi-devel zlib-devel openssl-devel libyaml-devel readline-devel curl-devel openssl-devel pcre-devel git memcached-devel valgrind-devel mysql-devel\nARG RUBY_VERSION=2.6.1\nARG RUBY_URL=https://cache.ruby-lang.org/pub/ruby/2.6\nRUN cd /usr/local/src \\\n && wget ${RUBY_URL}/ruby-${RUBY_VERSION}.tar.gz \\\n && tar xf ruby-${RUBY_VERSION}.tar.gz \\\n && cd ruby-${RUBY_VERSION} \\\n && ./configure \\\n && make \\\n && make install\n#   stuff we need to build our own libvips ... this is a pretty random selection\n#   of dependencies, you'll want to adjust these\n#   the centos6 packages for lcms, librsvg, liborc are all too old,\n#   unfortunately\nRUN yum install -y libpng-devel glib2-devel libjpeg-devel expat-devel zlib-devel fftw3-devel openexr-devel giflib-devel libexif-devel openjpeg-devel libtiff-devel gdk-pixbuf2-devel sqlite-devel cairo-devel\n#   centos6 ships with libgsf-devel 1.14.15-5, but that's too old and crashy for\n#   libvips (needed for dzsave), so we have to build our own \n#   1_14_45 needs a newer glib than centos6 has, so use an older but known-good\n#   version\n#   1_14_27 is not shipped as a \"make dist\" tarball and has an autogen.sh that\n#   fails on centos6 ... we include our own 1.14.27 tarball\n#   1.14.27 is missing zip64 write support, sadly\nARG LIBGSF_VERSION=1.14.27\nCOPY libgsf-${LIBGSF_VERSION}.tar.bz2 /usr/local/src\nRUN cd /usr/local/src \\\n && tar xf libgsf-${LIBGSF_VERSION}.tar.bz2 \\\n && cd libgsf-${LIBGSF_VERSION} \\\n && ./configure \\\n && make \\\n && make install\n#   libvips needs to be able to find the libgsf-1.pc in /usr/local/lib/pkgconfig\nENV PKG_CONFIG_PATH=\"/usr/local/lib/pkgconfig\"\nARG VIPS_VERSION=8.7.4\nARG VIPS_URL=https://github.com/libvips/libvips/releases/download\nRUN cd /usr/local/src \\\n && wget ${VIPS_URL}/v${VIPS_VERSION}/vips-${VIPS_VERSION}.tar.gz \\\n && tar xf vips-${VIPS_VERSION}.tar.gz \\\n && cd vips-${VIPS_VERSION} \\\n && ./configure \\\n && make V=0 \\\n && make install\nRUN gem install ruby-vips --version 2.1.4\nWORKDIR /data\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM centos:6\n#  general build stuff\nRUN yum update -y \\\n && yum groupinstall -y \"Development Tools\" \\\n && yum install -y wget tar\n#  have to build our own ruby since centos6 ships with ruby1.8 and ruby-vips\n#  needs 1.9+\n#  stuff for a ruby build\nRUN yum install -y libxslt-devel libyaml-devel libxml2-devel gdbm-devel libffi-devel zlib-devel openssl-devel libyaml-devel readline-devel curl-devel openssl-devel pcre-devel git memcached-devel valgrind-devel mysql-devel\nARG RUBY_VERSION=2.6.1\nARG RUBY_URL=https://cache.ruby-lang.org/pub/ruby/2.6\nRUN cd /usr/local/src \\\n && wget ${RUBY_URL}/ruby-${RUBY_VERSION}.tar.gz \\\n && tar xf ruby-${RUBY_VERSION}.tar.gz \\\n && cd ruby-${RUBY_VERSION} \\\n && ./configure \\\n && make \\\n && make install\n#  stuff we need to build our own libvips ... this is a pretty random selection\n#  of dependencies, you'll want to adjust these\n#  the centos6 packages for lcms, librsvg, liborc are all too old,\n#  unfortunately\nRUN yum install -y libpng-devel glib2-devel libjpeg-devel expat-devel zlib-devel fftw3-devel openexr-devel giflib-devel libexif-devel openjpeg-devel libtiff-devel gdk-pixbuf2-devel sqlite-devel cairo-devel\n#  centos6 ships with libgsf-devel 1.14.15-5, but that's too old and crashy for\n#  libvips (needed for dzsave), so we have to build our own \n#  1_14_45 needs a newer glib than centos6 has, so use an older but known-good\n#  version\n#  1_14_27 is not shipped as a \"make dist\" tarball and has an autogen.sh that\n#  fails on centos6 ... we include our own 1.14.27 tarball\n#  1.14.27 is missing zip64 write support, sadly\nARG LIBGSF_VERSION=1.14.27\nCOPY libgsf-${LIBGSF_VERSION}.tar.bz2 /usr/local/src\nRUN cd /usr/local/src \\\n && tar xf libgsf-${LIBGSF_VERSION}.tar.bz2 \\\n && cd libgsf-${LIBGSF_VERSION} \\\n && ./configure \\\n && make \\\n && make install\n#  libvips needs to be able to find the libgsf-1.pc in /usr/local/lib/pkgconfig\nENV PKG_CONFIG_PATH=\"/usr/local/lib/pkgconfig\"\nARG VIPS_VERSION=8.7.4\nARG VIPS_URL=https://github.com/libvips/libvips/releases/download\nRUN cd /usr/local/src \\\n && wget ${VIPS_URL}/v${VIPS_VERSION}/vips-${VIPS_VERSION}.tar.gz \\\n && tar xf vips-${VIPS_VERSION}.tar.gz \\\n && cd vips-${VIPS_VERSION} \\\n && ./configure \\\n && make V=0 \\\n && make install\nRUN gem install ruby-vips\nWORKDIR /data\n","injectedSmells":[],"originalDockerfileHash":"bdbc1dbf437320a5e1b334935d755e90","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM centos:6\n#   general build stuff\nRUN yum update -y \\\n && yum groupinstall -y \"Development Tools\" \\\n && yum install -y wget tar\n#   have to build our own ruby since centos6 ships with ruby1.8 and ruby-vips\n#   needs 1.9+\n#   stuff for a ruby build\nRUN yum install -y libxslt-devel libyaml-devel libxml2-devel gdbm-devel libffi-devel zlib-devel openssl-devel libyaml-devel readline-devel curl-devel openssl-devel pcre-devel git memcached-devel valgrind-devel mysql-devel\nARG RUBY_VERSION=2.6.1\nARG RUBY_URL=https://cache.ruby-lang.org/pub/ruby/2.6\nRUN cd /usr/local/src \\\n && wget ${RUBY_URL}/ruby-${RUBY_VERSION}.tar.gz \\\n && tar xf ruby-${RUBY_VERSION}.tar.gz \\\n && cd ruby-${RUBY_VERSION} \\\n && ./configure \\\n && make \\\n && make install\n#   stuff we need to build our own libvips ... this is a pretty random selection\n#   of dependencies, you'll want to adjust these\n#   the centos6 packages for lcms, librsvg, liborc are all too old,\n#   unfortunately\nRUN yum install -y libpng-devel glib2-devel libjpeg-devel expat-devel zlib-devel fftw3-devel openexr-devel giflib-devel libexif-devel openjpeg-devel libtiff-devel gdk-pixbuf2-devel sqlite-devel cairo-devel\n#   centos6 ships with libgsf-devel 1.14.15-5, but that's too old and crashy for\n#   libvips (needed for dzsave), so we have to build our own \n#   1_14_45 needs a newer glib than centos6 has, so use an older but known-good\n#   version\n#   1_14_27 is not shipped as a \"make dist\" tarball and has an autogen.sh that\n#   fails on centos6 ... we include our own 1.14.27 tarball\n#   1.14.27 is missing zip64 write support, sadly\nARG LIBGSF_VERSION=1.14.27\nCOPY libgsf-${LIBGSF_VERSION}.tar.bz2 /usr/local/src\nRUN cd /usr/local/src \\\n && tar xf libgsf-${LIBGSF_VERSION}.tar.bz2 \\\n && cd libgsf-${LIBGSF_VERSION} \\\n && ./configure \\\n && make \\\n && make install\n#   libvips needs to be able to find the libgsf-1.pc in /usr/local/lib/pkgconfig\nENV PKG_CONFIG_PATH=\"/usr/local/lib/pkgconfig\"\nARG VIPS_VERSION=8.7.4\nARG VIPS_URL=https://github.com/libvips/libvips/releases/download\nRUN cd /usr/local/src \\\n && wget ${VIPS_URL}/v${VIPS_VERSION}/vips-${VIPS_VERSION}.tar.gz \\\n && tar xf vips-${VIPS_VERSION}.tar.gz \\\n && cd vips-${VIPS_VERSION} \\\n && ./configure \\\n && make V=0 \\\n && make install\nRUN gem install ruby-vips\nWORKDIR /data\n","originalDockerfileUglifiedHash":"df3b8a58bd1cd85694da82733f2e594a","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/7a9b9184d526bc481ffbe6d3dc3bdbbe85a303c7.dockerfile"}