{"seed":3422135403,"processedDockerfileHash":"2b24a4d079691e729f225eaeacdae485","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","pin-package-manager-versions-apt-get","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM ubuntu:14.04\nRUN apt-get update -qq \\\n && apt-get install --no-install-recommends software-properties-common=0.92.37.8 python-software-properties=0.92.37.8 inotify-tools=3.14-1ubuntu1 debconf-utils=1.5.51ubuntu2 -y \\\n && apt-get install --no-install-recommends git=1:1.9.1-1ubuntu0.10 wget=1.15-1ubuntu1.14.04.5 unzip=6.0-9ubuntu1.5 default-jre=2:1.7-51 openjdk-7-jre=7u211-2.6.17-0ubuntu0.1 php5=5.5.9+dfsg-1ubuntu4.29 -y\nWORKDIR /root\nRUN wget --quiet http://files.basex.org/releases/8.5.3/BaseX853.zip\nRUN unzip BaseX853.zip\nRUN mkdir openinfoman\nRUN cp -R basex/* openinfoman/\nRUN cp basex/.basexhome openinfoman/\nRUN mkdir openinfoman/repo-src\nRUN git clone --single-branch -b connectathonTZ https://github.com/openhie/openinfoman openinfomangh\nRUN cp openinfomangh/repo/* openinfoman/repo-src/\nRUN cp -R openinfomangh/resources openinfoman/\nRUN cp ~/openinfomangh/webapp/*xqm ~/openinfoman/webapp\nRUN mkdir -p ~/openinfoman/webapp/static\nRUN cp -R ~/openinfomangh/webapp/static/* ~/openinfoman/webapp/static\nRUN ln -s ~/openinfoman/bin/basex /usr/local/bin\nRUN basex -Vc \"CREATE DATABASE provider_directory\"\nRUN echo \"module namespace csd_webconf = 'https://github.com/openhie/openinfoman/csd_webconf';\\n declare variable $csd_webconf:db := 'provider_directory';\\n declare variable $csd_webconf:baseurl := '';\\n declare variable $csd_webconf:remote_services := ();\\n \" > $HOME/openinfoman/repo-src/generated_openinfoman_webconfig.xqm\nRUN basex -Vc \"REPO INSTALL http://files.basex.org/modules/expath/functx-1.0.xar\"\nWORKDIR /root/openinfoman/repo-src\n#   Change shell to bash to interpret array syntax\nSHELL [\"/bin/bash\", \"-c\"]\nRUN declare -a arr=( \"generated_openinfoman_webconfig.xqm\" \"csd_webapp_ui.xqm\" \"csd_base_library.xqm\" \"csd_base_library_updating.xqm\" \"csd_base_stored_queries.xqm\" \"csd_document_manager.xqm\" \"csd_load_sample_directories.xqm\" \"csd_query_updated_services.xqm\" \"csd_poll_service_directories.xqm\" \"csd_local_services_cache.xqm\" \"csd_merge_cached_services.xqm\" \"csr_processor.xqm\" \"svs_load_shared_value_sets.xqm\" \"async_fake.xqm\" ) ; for i in \"${arr[@]}\"; do basex -Vc \"repo install $i\" ; done\nRUN basex -Vc \"RUN $HOME/openinfoman/resources/scripts/init_db.xq\"\nWORKDIR /root/openinfoman\nRUN declare -a arr=( resources/stored*definitions/*xml ) ; for i in \"${arr[@]}\"; do resources/scripts/install_stored_function.php $i ; done\nWORKDIR /root/openinfoman/resources/shared_value_sets\nRUN declare -a arr=( * ) ; for i in \"${arr[@]}\"; do basex -q\"import module namespace svs_lsvs = 'https://github.com/openhie/openinfoman/svs_lsvs';' (svs_lsvs:load($i))'\" ; done\n#  ## openinfoman-csv\nWORKDIR /root\nRUN git clone https://github.com/openhie/openinfoman-csv\nWORKDIR /root/openinfoman-csv/repo\nRUN basex -Vc \"REPO INSTALL openinfoman_csv_adapter.xqm\"\n#   this may not be needed\nRUN cp ~/openinfoman-csv/webapp/*xqm ~/openinfoman/webapp\n#  ## openinfoman-rapidpro\nWORKDIR /root\nRUN git clone https://github.com/openhie/openinfoman-rapidpro\nWORKDIR /root/openinfoman\nRUN declare -a arr=( \"$HOME/openinfoman-rapidpro/resources/stored*definitions/*xml\" ) ; for i in \"${arr[@]}\"; do resources/scripts/install_stored_function.php $i ; done\nRUN cp ~/openinfoman-rapidpro/webapp/openinfoman_rapidpro_bindings.xqm ~/openinfoman/webapp\n#  ## openinfoman-ilr\nWORKDIR /root\nRUN git clone https://github.com/openhie/openinfoman-ilr\nWORKDIR /root/openinfoman\nRUN declare -a arr=( \"$HOME/openinfoman-ilr/resources/stored*definitions/*xml\" ) ; for i in \"${arr[@]}\"; do resources/scripts/install_stored_function.php $i ; done\n#  ## openinfoman-hwr\nWORKDIR /root\nRUN git clone https://github.com/openhie/openinfoman-hwr\nWORKDIR /root/openinfoman\nRUN declare -a arr=( \"$HOME/openinfoman-hwr/resources/stored*definitions/*xml\" ) ; for i in \"${arr[@]}\"; do resources/scripts/install_stored_function.php $i ; done\n#  ## openinfoman-dhis\nWORKDIR /root\nRUN git clone https://github.com/openhie/openinfoman-dhis\nRUN cp openinfoman-dhis/repo/* openinfoman/repo-src/\nWORKDIR /root/openinfoman/repo-src\nRUN declare -a arr=( \"dxf2csd.xqm\" \"dxf_1_0.xqm\" \"util.xqm\" ) ; for i in \"${arr[@]}\"; do basex -Vc \"repo install $i\" ; done\nWORKDIR /root/openinfoman\nRUN declare -a arr=( \"$HOME/openinfoman-dhis/resources/stored*definitions/*xml\" ) ; for i in \"${arr[@]}\"; do resources/scripts/install_stored_function.php $i ; done\nRUN cp ~/openinfoman-dhis/webapp/openinfoman_dhis2_bindings.xqm ~/openinfoman/webapp\nRUN cp -R ~/openinfoman-dhis/resources/service_directories/* ~/openinfoman/resources/service_directories/\n#   Must switch back to this dir or paths will fail\nWORKDIR /root/openinfoman/bin\nEXPOSE 8984/tcp 8985/tcp 1984/tcp\nSHELL [\"/bin/sh\", \"-c\"]\nENTRYPOINT [\"/root/openinfoman/bin/basexhttp\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM ubuntu:14.04\nRUN apt-get update -qq \\\n && apt-get install software-properties-common python-software-properties inotify-tools debconf-utils -y \\\n && apt-get install git wget unzip default-jre openjdk-7-jre php5 -y\nWORKDIR /root\nRUN wget --quiet http://files.basex.org/releases/8.5.3/BaseX853.zip\nRUN unzip BaseX853.zip\nRUN mkdir openinfoman\nRUN cp -R basex/* openinfoman/\nRUN cp basex/.basexhome openinfoman/\nRUN mkdir openinfoman/repo-src\nRUN git clone --single-branch -b connectathonTZ https://github.com/openhie/openinfoman openinfomangh\nRUN cp openinfomangh/repo/* openinfoman/repo-src/\nRUN cp -R openinfomangh/resources openinfoman/\nRUN cp ~/openinfomangh/webapp/*xqm ~/openinfoman/webapp\nRUN mkdir -p ~/openinfoman/webapp/static\nRUN cp -R ~/openinfomangh/webapp/static/* ~/openinfoman/webapp/static\nRUN ln -s ~/openinfoman/bin/basex /usr/local/bin\nRUN basex -Vc \"CREATE DATABASE provider_directory\"\nRUN echo \"module namespace csd_webconf = 'https://github.com/openhie/openinfoman/csd_webconf';\\n declare variable $csd_webconf:db := 'provider_directory';\\n declare variable $csd_webconf:baseurl := '';\\n declare variable $csd_webconf:remote_services := ();\\n \" > $HOME/openinfoman/repo-src/generated_openinfoman_webconfig.xqm\nRUN basex -Vc \"REPO INSTALL http://files.basex.org/modules/expath/functx-1.0.xar\"\nWORKDIR /root/openinfoman/repo-src\n#  Change shell to bash to interpret array syntax\nSHELL [\"/bin/bash\", \"-c\"]\nRUN declare -a arr=( \"generated_openinfoman_webconfig.xqm\" \"csd_webapp_ui.xqm\" \"csd_base_library.xqm\" \"csd_base_library_updating.xqm\" \"csd_base_stored_queries.xqm\" \"csd_document_manager.xqm\" \"csd_load_sample_directories.xqm\" \"csd_query_updated_services.xqm\" \"csd_poll_service_directories.xqm\" \"csd_local_services_cache.xqm\" \"csd_merge_cached_services.xqm\" \"csr_processor.xqm\" \"svs_load_shared_value_sets.xqm\" \"async_fake.xqm\" ) ; for i in \"${arr[@]}\"; do basex -Vc \"repo install $i\" ; done\nRUN basex -Vc \"RUN $HOME/openinfoman/resources/scripts/init_db.xq\"\nWORKDIR /root/openinfoman\nRUN declare -a arr=( resources/stored*definitions/*xml ) ; for i in \"${arr[@]}\"; do resources/scripts/install_stored_function.php $i ; done\nWORKDIR /root/openinfoman/resources/shared_value_sets\nRUN declare -a arr=( * ) ; for i in \"${arr[@]}\"; do basex -q\"import module namespace svs_lsvs = 'https://github.com/openhie/openinfoman/svs_lsvs';' (svs_lsvs:load($i))'\" ; done\n# ## openinfoman-csv\nWORKDIR /root\nRUN git clone https://github.com/openhie/openinfoman-csv\nWORKDIR /root/openinfoman-csv/repo\nRUN basex -Vc \"REPO INSTALL openinfoman_csv_adapter.xqm\"\n#  this may not be needed\nRUN cp ~/openinfoman-csv/webapp/*xqm ~/openinfoman/webapp\n# ## openinfoman-rapidpro\nWORKDIR /root\nRUN git clone https://github.com/openhie/openinfoman-rapidpro\nWORKDIR /root/openinfoman\nRUN declare -a arr=( \"$HOME/openinfoman-rapidpro/resources/stored*definitions/*xml\" ) ; for i in \"${arr[@]}\"; do resources/scripts/install_stored_function.php $i ; done\nRUN cp ~/openinfoman-rapidpro/webapp/openinfoman_rapidpro_bindings.xqm ~/openinfoman/webapp\n# ## openinfoman-ilr\nWORKDIR /root\nRUN git clone https://github.com/openhie/openinfoman-ilr\nWORKDIR /root/openinfoman\nRUN declare -a arr=( \"$HOME/openinfoman-ilr/resources/stored*definitions/*xml\" ) ; for i in \"${arr[@]}\"; do resources/scripts/install_stored_function.php $i ; done\n# ## openinfoman-hwr\nWORKDIR /root\nRUN git clone https://github.com/openhie/openinfoman-hwr\nWORKDIR /root/openinfoman\nRUN declare -a arr=( \"$HOME/openinfoman-hwr/resources/stored*definitions/*xml\" ) ; for i in \"${arr[@]}\"; do resources/scripts/install_stored_function.php $i ; done\n# ## openinfoman-dhis\nWORKDIR /root\nRUN git clone https://github.com/openhie/openinfoman-dhis\nRUN cp openinfoman-dhis/repo/* openinfoman/repo-src/\nWORKDIR /root/openinfoman/repo-src\nRUN declare -a arr=( \"dxf2csd.xqm\" \"dxf_1_0.xqm\" \"util.xqm\" ) ; for i in \"${arr[@]}\"; do basex -Vc \"repo install $i\" ; done\nWORKDIR /root/openinfoman\nRUN declare -a arr=( \"$HOME/openinfoman-dhis/resources/stored*definitions/*xml\" ) ; for i in \"${arr[@]}\"; do resources/scripts/install_stored_function.php $i ; done\nRUN cp ~/openinfoman-dhis/webapp/openinfoman_dhis2_bindings.xqm ~/openinfoman/webapp\nRUN cp -R ~/openinfoman-dhis/resources/service_directories/* ~/openinfoman/resources/service_directories/\n#  Must switch back to this dir or paths will fail\nWORKDIR /root/openinfoman/bin\nEXPOSE 8984/tcp 8985/tcp 1984/tcp\nSHELL [\"/bin/sh\", \"-c\"]\nENTRYPOINT [\"/root/openinfoman/bin/basexhttp\"]\n","injectedSmells":[],"originalDockerfileHash":"1c91956806931924a358e6c9cbf9a46b","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM ubuntu:14.04\nRUN apt-get update -qq \\\n && apt-get install software-properties-common python-software-properties inotify-tools debconf-utils -y \\\n && apt-get install git wget unzip default-jre openjdk-7-jre php5 -y\nWORKDIR /root\nRUN wget --quiet http://files.basex.org/releases/8.5.3/BaseX853.zip\nRUN unzip BaseX853.zip\nRUN mkdir openinfoman\nRUN cp -R basex/* openinfoman/\nRUN cp basex/.basexhome openinfoman/\nRUN mkdir openinfoman/repo-src\nRUN git clone --single-branch -b connectathonTZ https://github.com/openhie/openinfoman openinfomangh\nRUN cp openinfomangh/repo/* openinfoman/repo-src/\nRUN cp -R openinfomangh/resources openinfoman/\nRUN cp ~/openinfomangh/webapp/*xqm ~/openinfoman/webapp\nRUN mkdir -p ~/openinfoman/webapp/static\nRUN cp -R ~/openinfomangh/webapp/static/* ~/openinfoman/webapp/static\nRUN ln -s ~/openinfoman/bin/basex /usr/local/bin\nRUN basex -Vc \"CREATE DATABASE provider_directory\"\nRUN echo \"module namespace csd_webconf = 'https://github.com/openhie/openinfoman/csd_webconf';\\n declare variable $csd_webconf:db := 'provider_directory';\\n declare variable $csd_webconf:baseurl := '';\\n declare variable $csd_webconf:remote_services := ();\\n \" > $HOME/openinfoman/repo-src/generated_openinfoman_webconfig.xqm\nRUN basex -Vc \"REPO INSTALL http://files.basex.org/modules/expath/functx-1.0.xar\"\nWORKDIR /root/openinfoman/repo-src\n#   Change shell to bash to interpret array syntax\nSHELL [\"/bin/bash\", \"-c\"]\nRUN declare -a arr=( \"generated_openinfoman_webconfig.xqm\" \"csd_webapp_ui.xqm\" \"csd_base_library.xqm\" \"csd_base_library_updating.xqm\" \"csd_base_stored_queries.xqm\" \"csd_document_manager.xqm\" \"csd_load_sample_directories.xqm\" \"csd_query_updated_services.xqm\" \"csd_poll_service_directories.xqm\" \"csd_local_services_cache.xqm\" \"csd_merge_cached_services.xqm\" \"csr_processor.xqm\" \"svs_load_shared_value_sets.xqm\" \"async_fake.xqm\" ) ; for i in \"${arr[@]}\"; do basex -Vc \"repo install $i\" ; done\nRUN basex -Vc \"RUN $HOME/openinfoman/resources/scripts/init_db.xq\"\nWORKDIR /root/openinfoman\nRUN declare -a arr=( resources/stored*definitions/*xml ) ; for i in \"${arr[@]}\"; do resources/scripts/install_stored_function.php $i ; done\nWORKDIR /root/openinfoman/resources/shared_value_sets\nRUN declare -a arr=( * ) ; for i in \"${arr[@]}\"; do basex -q\"import module namespace svs_lsvs = 'https://github.com/openhie/openinfoman/svs_lsvs';' (svs_lsvs:load($i))'\" ; done\n#  ## openinfoman-csv\nWORKDIR /root\nRUN git clone https://github.com/openhie/openinfoman-csv\nWORKDIR /root/openinfoman-csv/repo\nRUN basex -Vc \"REPO INSTALL openinfoman_csv_adapter.xqm\"\n#   this may not be needed\nRUN cp ~/openinfoman-csv/webapp/*xqm ~/openinfoman/webapp\n#  ## openinfoman-rapidpro\nWORKDIR /root\nRUN git clone https://github.com/openhie/openinfoman-rapidpro\nWORKDIR /root/openinfoman\nRUN declare -a arr=( \"$HOME/openinfoman-rapidpro/resources/stored*definitions/*xml\" ) ; for i in \"${arr[@]}\"; do resources/scripts/install_stored_function.php $i ; done\nRUN cp ~/openinfoman-rapidpro/webapp/openinfoman_rapidpro_bindings.xqm ~/openinfoman/webapp\n#  ## openinfoman-ilr\nWORKDIR /root\nRUN git clone https://github.com/openhie/openinfoman-ilr\nWORKDIR /root/openinfoman\nRUN declare -a arr=( \"$HOME/openinfoman-ilr/resources/stored*definitions/*xml\" ) ; for i in \"${arr[@]}\"; do resources/scripts/install_stored_function.php $i ; done\n#  ## openinfoman-hwr\nWORKDIR /root\nRUN git clone https://github.com/openhie/openinfoman-hwr\nWORKDIR /root/openinfoman\nRUN declare -a arr=( \"$HOME/openinfoman-hwr/resources/stored*definitions/*xml\" ) ; for i in \"${arr[@]}\"; do resources/scripts/install_stored_function.php $i ; done\n#  ## openinfoman-dhis\nWORKDIR /root\nRUN git clone https://github.com/openhie/openinfoman-dhis\nRUN cp openinfoman-dhis/repo/* openinfoman/repo-src/\nWORKDIR /root/openinfoman/repo-src\nRUN declare -a arr=( \"dxf2csd.xqm\" \"dxf_1_0.xqm\" \"util.xqm\" ) ; for i in \"${arr[@]}\"; do basex -Vc \"repo install $i\" ; done\nWORKDIR /root/openinfoman\nRUN declare -a arr=( \"$HOME/openinfoman-dhis/resources/stored*definitions/*xml\" ) ; for i in \"${arr[@]}\"; do resources/scripts/install_stored_function.php $i ; done\nRUN cp ~/openinfoman-dhis/webapp/openinfoman_dhis2_bindings.xqm ~/openinfoman/webapp\nRUN cp -R ~/openinfoman-dhis/resources/service_directories/* ~/openinfoman/resources/service_directories/\n#   Must switch back to this dir or paths will fail\nWORKDIR /root/openinfoman/bin\nEXPOSE 8984/tcp 8985/tcp 1984/tcp\nSHELL [\"/bin/sh\", \"-c\"]\nENTRYPOINT [\"/root/openinfoman/bin/basexhttp\"]\n","originalDockerfileUglifiedHash":"0a8e5fbd2d8be8b9c8c674c8d1bd3d80","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/85f8f14596104dd113c8d74d6f317493269897d1.dockerfile"}