{"seed":2918445672,"processedDockerfileHash":"25ec1befec28a2cd20788a6dcf041e13","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","have-a-healthcheck","have-a-user"],"processedDockerfile":"# syntax = docker/dockerfile:experimental\nARG PHP_VERSION=7.3.6\nFROM --platform=$TARGETPLATFORM php:${PHP_VERSION}-cli-alpine AS php\nLABEL maintainer=\"khs1994-docker/lnmp <khs1994@khs1994.com>\"\nARG PHP_EXTENSION_EXTRA\nARG PECL_EXTENSION_EXTRA\nARG APK_EXTRA\nARG APK_DEV_EXTRA\nENV TZ=\"Asia/Shanghai\" \\\n    APP_ENV=\"development\"\nENV PHP_EXTENSION=\"bcmath  bz2  calendar  enchant  exif  gd  gettext  gmp  imap  intl  mysqli  pcntl  pdo_pgsql  pdo_mysql  pgsql  sockets  sysvmsg  sysvsem  sysvshm  xmlrpc  xsl  zip  ${PHP_EXTENSION_EXTRA:-}\"\nENV PECL_EXTENSION=\"mongodb  igbinary  redis  memcached  yaml  swoole  ${PECL_EXTENSION_EXTRA:-}\"\nARG ALPINE_URL=dl-cdn.alpinelinux.org\nRUN sed -i \"s/dl-cdn.alpinelinux.org/${ALPINE_URL}/g\" /etc/apk/repositories \\\n && set -xe \\\n && PHP_SWOOLE_RUN_DEPS=\" bash tzdata libmemcached-libs libpq libzip zlib libpng freetype libjpeg-turbo libxpm libwebp yaml libbz2 libexif libxslt gmp xmlrpc-c enchant c-client icu-libs ${APK_EXTRA:-} \" \\\n && PHP_SWOOLE_BUILD_DEPS=\" openssl-dev libmemcached-dev cyrus-sasl-dev postgresql-dev libzip-dev zlib-dev libpng-dev freetype-dev libjpeg-turbo-dev libxpm-dev libwebp-dev yaml-dev libexif-dev libxslt-dev gmp-dev xmlrpc-c-dev bzip2-dev enchant-dev imap-dev gettext-dev libwebp-dev icu-dev nghttp2-dev ${APK_DEV_EXTRA:-} \" \\\n && apk add $PHP_SWOOLE_RUN_DEPS --no-cache --virtual .php-swoole-run-deps \\\n && apk add $PHP_SWOOLE_BUILD_DEPS --no-cache --virtual .php-swoole-build-deps \\\n && docker-php-ext-configure zip --with-libzip \\\n && docker-php-ext-configure gd --disable-gd-jis-conv --with-freetype-dir=/usr --with-jpeg-dir=/usr --with-png-dir=/usr --with-webp-dir=/usr --with-xpm-dir=/usr \\\n && docker-php-ext-install $PHP_EXTENSION \\\n && apk add $PHPIZE_DEPS --no-cache --virtual .build-deps \\\n && for extension in ${PHP_EXTENSION}; do strip --strip-all $( php-config --extension-dir ;)/$( echo ${extension} | cut -d '-' -f 1 ;).so ; done \\\n && for extension in $PECL_EXTENSION; do pecl install $extension \\\n && docker-php-ext-enable $( echo ${extension} | cut -d '-' -f 1 ;) || echo \"pecl ${extension} install error\" \\\n && rm -rf /usr/local/lib/php/doc/$( echo ${extension} | cut -d '-' -f 1 ;) \\\n && rm -rf /usr/local/lib/php/test/$( echo ${extension} | cut -d '-' -f 1 ;) \\\n && rm -rf /usr/local/include/php/ext/$( echo ${extension} | cut -d '-' -f 1 ;) \\\n && strip --strip-all $( php-config --extension-dir ;)/$( echo ${extension} | cut -d '-' -f 1 ;).so ; done \\\n && apk del --no-network --no-cache .build-deps .php-swoole-build-deps \\\n && rm -rf /tmp/* \\\n && rm -rf /usr/local/lib/php/.registry/.channel.pecl.php.net/* \\\n && rm -rf /usr/local/sbin\nWORKDIR /app\nENTRYPOINT [\"php\"]\nCMD [\"index.php\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\n","originalDockerfile":"# syntax = docker/dockerfile:experimental\nARG PHP_VERSION=7.3.6\nFROM --platform=$TARGETPLATFORM php:${PHP_VERSION}-cli-alpine AS php\nLABEL maintainer=\"khs1994-docker/lnmp <khs1994@khs1994.com>\"\nARG PHP_EXTENSION_EXTRA\nARG PECL_EXTENSION_EXTRA\nARG APK_EXTRA\nARG APK_DEV_EXTRA\nENV TZ=\"Asia/Shanghai\" \\\n    APP_ENV=\"development\"\nENV PHP_EXTENSION=\"bcmath  bz2  calendar  enchant  exif  gd  gettext  gmp  imap  intl  mysqli  pcntl  pdo_pgsql  pdo_mysql  pgsql  sockets  sysvmsg  sysvsem  sysvshm  xmlrpc  xsl  zip  ${PHP_EXTENSION_EXTRA:-}\"\nENV PECL_EXTENSION=\"mongodb  igbinary  redis  memcached  yaml  swoole  ${PECL_EXTENSION_EXTRA:-}\"\nARG ALPINE_URL=dl-cdn.alpinelinux.org\nRUN sed -i \"s/dl-cdn.alpinelinux.org/${ALPINE_URL}/g\" /etc/apk/repositories \\\n && set -xe \\\n && PHP_SWOOLE_RUN_DEPS=\" bash tzdata libmemcached-libs libpq libzip zlib libpng freetype libjpeg-turbo libxpm libwebp yaml libbz2 libexif libxslt gmp xmlrpc-c enchant c-client icu-libs ${APK_EXTRA:-} \" \\\n && PHP_SWOOLE_BUILD_DEPS=\" openssl-dev libmemcached-dev cyrus-sasl-dev postgresql-dev libzip-dev zlib-dev libpng-dev freetype-dev libjpeg-turbo-dev libxpm-dev libwebp-dev yaml-dev libexif-dev libxslt-dev gmp-dev xmlrpc-c-dev bzip2-dev enchant-dev imap-dev gettext-dev libwebp-dev icu-dev nghttp2-dev ${APK_DEV_EXTRA:-} \" \\\n && apk add --no-cache --virtual .php-swoole-run-deps $PHP_SWOOLE_RUN_DEPS \\\n && apk add --no-cache --virtual .php-swoole-build-deps $PHP_SWOOLE_BUILD_DEPS \\\n && docker-php-ext-configure zip --with-libzip \\\n && docker-php-ext-configure gd --disable-gd-jis-conv --with-freetype-dir=/usr --with-jpeg-dir=/usr --with-png-dir=/usr --with-webp-dir=/usr --with-xpm-dir=/usr \\\n && docker-php-ext-install $PHP_EXTENSION \\\n && apk add --no-cache --virtual .build-deps $PHPIZE_DEPS \\\n && for extension in ${PHP_EXTENSION}; do strip --strip-all $( php-config --extension-dir ;)/$( echo ${extension} | cut -d '-' -f 1 ;).so ; done \\\n && for extension in $PECL_EXTENSION; do pecl install $extension \\\n && docker-php-ext-enable $( echo ${extension} | cut -d '-' -f 1 ;) || echo \"pecl ${extension} install error\" \\\n && rm -rf /usr/local/lib/php/doc/$( echo ${extension} | cut -d '-' -f 1 ;) \\\n && rm -rf /usr/local/lib/php/test/$( echo ${extension} | cut -d '-' -f 1 ;) \\\n && rm -rf /usr/local/include/php/ext/$( echo ${extension} | cut -d '-' -f 1 ;) \\\n && strip --strip-all $( php-config --extension-dir ;)/$( echo ${extension} | cut -d '-' -f 1 ;).so ; done \\\n && apk del --no-network --no-cache .build-deps .php-swoole-build-deps \\\n && rm -rf /tmp/* \\\n && rm -rf /usr/local/lib/php/.registry/.channel.pecl.php.net/* \\\n && rm -rf /usr/local/sbin\nWORKDIR /app\nENTRYPOINT [\"php\"]\nCMD [\"index.php\"]\n","injectedSmells":[],"originalDockerfileHash":"967d30c6bc927b5129e0585aadf3f268","successfullyInjectedSmells":[],"originalDockerfileUglified":"# syntax = docker/dockerfile:experimental\nARG PHP_VERSION=7.3.6\nFROM --platform=$TARGETPLATFORM php:${PHP_VERSION}-cli-alpine AS php\nLABEL maintainer=\"khs1994-docker/lnmp <khs1994@khs1994.com>\"\nARG PHP_EXTENSION_EXTRA\nARG PECL_EXTENSION_EXTRA\nARG APK_EXTRA\nARG APK_DEV_EXTRA\nENV TZ=\"Asia/Shanghai\" \\\n    APP_ENV=\"development\"\nENV PHP_EXTENSION=\"bcmath  bz2  calendar  enchant  exif  gd  gettext  gmp  imap  intl  mysqli  pcntl  pdo_pgsql  pdo_mysql  pgsql  sockets  sysvmsg  sysvsem  sysvshm  xmlrpc  xsl  zip  ${PHP_EXTENSION_EXTRA:-}\"\nENV PECL_EXTENSION=\"mongodb  igbinary  redis  memcached  yaml  swoole  ${PECL_EXTENSION_EXTRA:-}\"\nARG ALPINE_URL=dl-cdn.alpinelinux.org\nRUN sed -i \"s/dl-cdn.alpinelinux.org/${ALPINE_URL}/g\" /etc/apk/repositories \\\n && set -xe \\\n && PHP_SWOOLE_RUN_DEPS=\" bash tzdata libmemcached-libs libpq libzip zlib libpng freetype libjpeg-turbo libxpm libwebp yaml libbz2 libexif libxslt gmp xmlrpc-c enchant c-client icu-libs ${APK_EXTRA:-} \" \\\n && PHP_SWOOLE_BUILD_DEPS=\" openssl-dev libmemcached-dev cyrus-sasl-dev postgresql-dev libzip-dev zlib-dev libpng-dev freetype-dev libjpeg-turbo-dev libxpm-dev libwebp-dev yaml-dev libexif-dev libxslt-dev gmp-dev xmlrpc-c-dev bzip2-dev enchant-dev imap-dev gettext-dev libwebp-dev icu-dev nghttp2-dev ${APK_DEV_EXTRA:-} \" \\\n && apk add --no-cache --virtual .php-swoole-run-deps $PHP_SWOOLE_RUN_DEPS \\\n && apk add --no-cache --virtual .php-swoole-build-deps $PHP_SWOOLE_BUILD_DEPS \\\n && docker-php-ext-configure zip --with-libzip \\\n && docker-php-ext-configure gd --disable-gd-jis-conv --with-freetype-dir=/usr --with-jpeg-dir=/usr --with-png-dir=/usr --with-webp-dir=/usr --with-xpm-dir=/usr \\\n && docker-php-ext-install $PHP_EXTENSION \\\n && apk add --no-cache --virtual .build-deps $PHPIZE_DEPS \\\n && for extension in ${PHP_EXTENSION}; do strip --strip-all $( php-config --extension-dir ;)/$( echo ${extension} | cut -d '-' -f 1 ;).so ; done \\\n && for extension in $PECL_EXTENSION; do pecl install $extension \\\n && docker-php-ext-enable $( echo ${extension} | cut -d '-' -f 1 ;) || echo \"pecl ${extension} install error\" \\\n && rm -rf /usr/local/lib/php/doc/$( echo ${extension} | cut -d '-' -f 1 ;) \\\n && rm -rf /usr/local/lib/php/test/$( echo ${extension} | cut -d '-' -f 1 ;) \\\n && rm -rf /usr/local/include/php/ext/$( echo ${extension} | cut -d '-' -f 1 ;) \\\n && strip --strip-all $( php-config --extension-dir ;)/$( echo ${extension} | cut -d '-' -f 1 ;).so ; done \\\n && apk del --no-network --no-cache .build-deps .php-swoole-build-deps \\\n && rm -rf /tmp/* \\\n && rm -rf /usr/local/lib/php/.registry/.channel.pecl.php.net/* \\\n && rm -rf /usr/local/sbin\nWORKDIR /app\nENTRYPOINT [\"php\"]\nCMD [\"index.php\"]\n","originalDockerfileUglifiedHash":"967d30c6bc927b5129e0585aadf3f268","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/bb5125e609a702adf55407c2f2506b13be09c593.dockerfile"}