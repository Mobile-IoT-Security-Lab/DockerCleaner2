{"seed":486681753,"processedDockerfileHash":"bb2446f8d78cfa0b7b989984d84c52e4","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apt-get","have-a-healthcheck","have-a-user"],"processedDockerfile":"#   php-swoole\nFROM php:7.1-cli\nMAINTAINER Xinyu Jiang 251413215@qq.com\n#  调整时区\nRUN /bin/cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime \\\n && echo 'Asia/Shanghai' > /etc/timezone\n#   构建swoole环境，在这里安装了php,swoole,protobuf,composer,安装扩展：phpredis,msgpack,inotify,igbinary,ds,zip opcache bcmath pdo_mysql\nRUN apt-get update \\\n && apt-get install --no-install-recommends curl=7.64.0-4+deb10u5 zlib1g-dev=1:1.2.11.dfsg-1+deb10u2 vim=2:8.1.0875-5+deb10u4 libssl-dev=1.1.1n-0+deb10u4 libpcre3=2:8.39-12 libpcre3-dev=2:8.39-12 libnghttp2-dev=1.36.0-2+deb10u1 unzip=6.0-23+deb10u3 wget=1.20.1-1.1 make=4.2.1-1.2 supervisor=3.3.5-1 -y \\\n && docker-php-ext-install zip opcache bcmath pdo_mysql \\\n && cd /home \\\n && rm -rf temp \\\n && mkdir temp \\\n && cd temp \\\n && wget https://github.com/swoole/swoole-src/archive/v4.2.6.tar.gz https://github.com/redis/hiredis/archive/v0.13.3.tar.gz https://github.com/phpredis/phpredis/archive/3.1.3.tar.gz https://github.com/msgpack/msgpack-php/archive/msgpack-2.0.2.tar.gz https://github.com/arnaud-lb/php-inotify/archive/2.0.0.tar.gz http://pecl.php.net/get/igbinary-2.0.5.tgz http://pecl.php.net/get/ds-1.2.5.tgz https://github.com/google/protobuf/releases/download/v2.6.1/protobuf-2.6.1.tar.gz https://github.com/allegro/php-protobuf/archive/v0.12.3.tar.gz \\\n && tar -xzvf 3.1.3.tar.gz \\\n && tar -xzvf v0.13.3.tar.gz \\\n && tar -xzvf v4.2.6.tar.gz \\\n && tar -xzvf msgpack-2.0.2.tar.gz \\\n && tar -xzvf 2.0.0.tar.gz \\\n && tar -xzvf igbinary-2.0.5.tgz \\\n && tar -xzvf ds-1.2.5.tgz \\\n && tar -xzvf protobuf-2.6.1.tar.gz \\\n && tar -xzvf v0.12.3.tar.gz \\\n && cd /home/temp/protobuf-2.6.1 \\\n && ./configure --prefix=/usr/local/protobuf \\\n && make \\\n && make install \\\n && cp /usr/local/protobuf/bin/protoc /usr/local/bin/ \\\n && cd /home/temp/hiredis-0.13.3 \\\n && make -j \\\n && make install \\\n && ldconfig \\\n && cd /home/temp/swoole-src-4.2.6 \\\n && phpize \\\n && ./configure --enable-mysqlnd --enable-openssl \\\n && make \\\n && make install \\\n && cd /home/temp/php-inotify-2.0.0 \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && cd /home/temp/ds-1.2.5 \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && cd /home/temp/igbinary-2.0.5 \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && cd /home/temp/phpredis-3.1.3 \\\n && phpize \\\n && ./configure --enable-redis-igbinary \\\n && make \\\n && make install \\\n && cd /home/temp/msgpack-php-msgpack-2.0.2 \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && cd /home/temp/php-protobuf-0.12.3 \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && cd /home/temp \\\n && php -r\"copy('https://getcomposer.org/installer','composer-setup.php');\" \\\n && php composer-setup.php --install-dir=/usr/bin --filename=composer \\\n && mkdir /apps \\\n && cp -r /home/temp/php-protobuf-0.12.3 /apps/php-protobuf \\\n && cd /apps/php-protobuf \\\n && composer install \\\n && rm -rf /home/temp \\\n && cd /usr/local/etc/php/conf.d/ \\\n && echo extension=igbinary.so > igbinary.ini \\\n && echo extension=redis.so > redis.ini \\\n && echo extension=inotify.so > inotify.ini \\\n && echo extension=swoole.so > swoole.ini \\\n && echo extension=msgpack.so > msgpack.ini \\\n && echo extension=ds.so > ds.ini \\\n && echo extension=protobuf.so > ds.ini \\\n && echo memory_limit = 1024 >> php.ini \\\n && echo Mdata.timezone = \"Asia/Shanghai\" >> php.ini \\\n && echo opcache.memory_consumption=128 >> opcache-recommended.ini \\\n && echo opcache.interned_strings_buffer=8 >> opcache-recommended.ini \\\n && echo opcache.max_accelerated_files=4000 >> opcache-recommended.ini \\\n && echo opcache.revalidate_freq=60 >> opcache-recommended.ini \\\n && echo opcache.fast_shutdown=4 >> opcache-recommended.ini \\\n && echo opcache.enable_cli=1 >> opcache-recommended.ini \\\n && composer config -g repo.packagist composer https://packagist.phpcomposer.com \\\n && mkdir -p /var/log/supervisor \\\n && apt-get autoclean \\\n && apt-get autoremove \\\n && rm -rf /var/lib/apt/lists/*\n#  WORKDIR /apps\t\n#  添加服务器代码目录到容器里\n#  VOLUME /apps /apps\n#  暴露端口\n#  EXPOSE 80 9502\n#  启动代码\n#  CMD [\"/bin/bash\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\n","originalDockerfile":"#  php-swoole\nFROM php:7.1-cli\nMAINTAINER Xinyu Jiang 251413215@qq.com\n# 调整时区\nRUN /bin/cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime \\\n && echo 'Asia/Shanghai' > /etc/timezone\n#  构建swoole环境，在这里安装了php,swoole,protobuf,composer,安装扩展：phpredis,msgpack,inotify,igbinary,ds,zip opcache bcmath pdo_mysql\nRUN apt-get update \\\n && apt-get install --no-install-recommends curl zlib1g-dev vim libssl-dev libpcre3 libpcre3-dev libnghttp2-dev unzip wget make supervisor -y \\\n && docker-php-ext-install zip opcache bcmath pdo_mysql \\\n && cd /home \\\n && rm -rf temp \\\n && mkdir temp \\\n && cd temp \\\n && wget https://github.com/swoole/swoole-src/archive/v4.2.6.tar.gz https://github.com/redis/hiredis/archive/v0.13.3.tar.gz https://github.com/phpredis/phpredis/archive/3.1.3.tar.gz https://github.com/msgpack/msgpack-php/archive/msgpack-2.0.2.tar.gz https://github.com/arnaud-lb/php-inotify/archive/2.0.0.tar.gz http://pecl.php.net/get/igbinary-2.0.5.tgz http://pecl.php.net/get/ds-1.2.5.tgz https://github.com/google/protobuf/releases/download/v2.6.1/protobuf-2.6.1.tar.gz https://github.com/allegro/php-protobuf/archive/v0.12.3.tar.gz \\\n && tar -xzvf 3.1.3.tar.gz \\\n && tar -xzvf v0.13.3.tar.gz \\\n && tar -xzvf v4.2.6.tar.gz \\\n && tar -xzvf msgpack-2.0.2.tar.gz \\\n && tar -xzvf 2.0.0.tar.gz \\\n && tar -xzvf igbinary-2.0.5.tgz \\\n && tar -xzvf ds-1.2.5.tgz \\\n && tar -xzvf protobuf-2.6.1.tar.gz \\\n && tar -xzvf v0.12.3.tar.gz \\\n && cd /home/temp/protobuf-2.6.1 \\\n && ./configure --prefix=/usr/local/protobuf \\\n && make \\\n && make install \\\n && cp /usr/local/protobuf/bin/protoc /usr/local/bin/ \\\n && cd /home/temp/hiredis-0.13.3 \\\n && make -j \\\n && make install \\\n && ldconfig \\\n && cd /home/temp/swoole-src-4.2.6 \\\n && phpize \\\n && ./configure --enable-mysqlnd --enable-openssl \\\n && make \\\n && make install \\\n && cd /home/temp/php-inotify-2.0.0 \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && cd /home/temp/ds-1.2.5 \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && cd /home/temp/igbinary-2.0.5 \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && cd /home/temp/phpredis-3.1.3 \\\n && phpize \\\n && ./configure --enable-redis-igbinary \\\n && make \\\n && make install \\\n && cd /home/temp/msgpack-php-msgpack-2.0.2 \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && cd /home/temp/php-protobuf-0.12.3 \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && cd /home/temp \\\n && php -r\"copy('https://getcomposer.org/installer','composer-setup.php');\" \\\n && php composer-setup.php --install-dir=/usr/bin --filename=composer \\\n && mkdir /apps \\\n && cp -r /home/temp/php-protobuf-0.12.3 /apps/php-protobuf \\\n && cd /apps/php-protobuf \\\n && composer install \\\n && rm -rf /home/temp \\\n && cd /usr/local/etc/php/conf.d/ \\\n && echo extension=igbinary.so > igbinary.ini \\\n && echo extension=redis.so > redis.ini \\\n && echo extension=inotify.so > inotify.ini \\\n && echo extension=swoole.so > swoole.ini \\\n && echo extension=msgpack.so > msgpack.ini \\\n && echo extension=ds.so > ds.ini \\\n && echo extension=protobuf.so > ds.ini \\\n && echo memory_limit = 1024 >> php.ini \\\n && echo Mdata.timezone = \"Asia/Shanghai\" >> php.ini \\\n && echo opcache.memory_consumption=128 >> opcache-recommended.ini \\\n && echo opcache.interned_strings_buffer=8 >> opcache-recommended.ini \\\n && echo opcache.max_accelerated_files=4000 >> opcache-recommended.ini \\\n && echo opcache.revalidate_freq=60 >> opcache-recommended.ini \\\n && echo opcache.fast_shutdown=4 >> opcache-recommended.ini \\\n && echo opcache.enable_cli=1 >> opcache-recommended.ini \\\n && composer config -g repo.packagist composer https://packagist.phpcomposer.com \\\n && mkdir -p /var/log/supervisor \\\n && apt-get autoclean \\\n && apt-get autoremove \\\n && rm -rf /var/lib/apt/lists/*\n# WORKDIR /apps\t\n# 添加服务器代码目录到容器里\n# VOLUME /apps /apps\n# 暴露端口\n# EXPOSE 80 9502\n# 启动代码\n# CMD [\"/bin/bash\"]\n","injectedSmells":[],"originalDockerfileHash":"164ab1f27d1c22d66323c9c31d022c99","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   php-swoole\nFROM php:7.1-cli\nMAINTAINER Xinyu Jiang 251413215@qq.com\n#  调整时区\nRUN /bin/cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime \\\n && echo 'Asia/Shanghai' > /etc/timezone\n#   构建swoole环境，在这里安装了php,swoole,protobuf,composer,安装扩展：phpredis,msgpack,inotify,igbinary,ds,zip opcache bcmath pdo_mysql\nRUN apt-get update \\\n && apt-get install --no-install-recommends curl zlib1g-dev vim libssl-dev libpcre3 libpcre3-dev libnghttp2-dev unzip wget make supervisor -y \\\n && docker-php-ext-install zip opcache bcmath pdo_mysql \\\n && cd /home \\\n && rm -rf temp \\\n && mkdir temp \\\n && cd temp \\\n && wget https://github.com/swoole/swoole-src/archive/v4.2.6.tar.gz https://github.com/redis/hiredis/archive/v0.13.3.tar.gz https://github.com/phpredis/phpredis/archive/3.1.3.tar.gz https://github.com/msgpack/msgpack-php/archive/msgpack-2.0.2.tar.gz https://github.com/arnaud-lb/php-inotify/archive/2.0.0.tar.gz http://pecl.php.net/get/igbinary-2.0.5.tgz http://pecl.php.net/get/ds-1.2.5.tgz https://github.com/google/protobuf/releases/download/v2.6.1/protobuf-2.6.1.tar.gz https://github.com/allegro/php-protobuf/archive/v0.12.3.tar.gz \\\n && tar -xzvf 3.1.3.tar.gz \\\n && tar -xzvf v0.13.3.tar.gz \\\n && tar -xzvf v4.2.6.tar.gz \\\n && tar -xzvf msgpack-2.0.2.tar.gz \\\n && tar -xzvf 2.0.0.tar.gz \\\n && tar -xzvf igbinary-2.0.5.tgz \\\n && tar -xzvf ds-1.2.5.tgz \\\n && tar -xzvf protobuf-2.6.1.tar.gz \\\n && tar -xzvf v0.12.3.tar.gz \\\n && cd /home/temp/protobuf-2.6.1 \\\n && ./configure --prefix=/usr/local/protobuf \\\n && make \\\n && make install \\\n && cp /usr/local/protobuf/bin/protoc /usr/local/bin/ \\\n && cd /home/temp/hiredis-0.13.3 \\\n && make -j \\\n && make install \\\n && ldconfig \\\n && cd /home/temp/swoole-src-4.2.6 \\\n && phpize \\\n && ./configure --enable-mysqlnd --enable-openssl \\\n && make \\\n && make install \\\n && cd /home/temp/php-inotify-2.0.0 \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && cd /home/temp/ds-1.2.5 \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && cd /home/temp/igbinary-2.0.5 \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && cd /home/temp/phpredis-3.1.3 \\\n && phpize \\\n && ./configure --enable-redis-igbinary \\\n && make \\\n && make install \\\n && cd /home/temp/msgpack-php-msgpack-2.0.2 \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && cd /home/temp/php-protobuf-0.12.3 \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && cd /home/temp \\\n && php -r\"copy('https://getcomposer.org/installer','composer-setup.php');\" \\\n && php composer-setup.php --install-dir=/usr/bin --filename=composer \\\n && mkdir /apps \\\n && cp -r /home/temp/php-protobuf-0.12.3 /apps/php-protobuf \\\n && cd /apps/php-protobuf \\\n && composer install \\\n && rm -rf /home/temp \\\n && cd /usr/local/etc/php/conf.d/ \\\n && echo extension=igbinary.so > igbinary.ini \\\n && echo extension=redis.so > redis.ini \\\n && echo extension=inotify.so > inotify.ini \\\n && echo extension=swoole.so > swoole.ini \\\n && echo extension=msgpack.so > msgpack.ini \\\n && echo extension=ds.so > ds.ini \\\n && echo extension=protobuf.so > ds.ini \\\n && echo memory_limit = 1024 >> php.ini \\\n && echo Mdata.timezone = \"Asia/Shanghai\" >> php.ini \\\n && echo opcache.memory_consumption=128 >> opcache-recommended.ini \\\n && echo opcache.interned_strings_buffer=8 >> opcache-recommended.ini \\\n && echo opcache.max_accelerated_files=4000 >> opcache-recommended.ini \\\n && echo opcache.revalidate_freq=60 >> opcache-recommended.ini \\\n && echo opcache.fast_shutdown=4 >> opcache-recommended.ini \\\n && echo opcache.enable_cli=1 >> opcache-recommended.ini \\\n && composer config -g repo.packagist composer https://packagist.phpcomposer.com \\\n && mkdir -p /var/log/supervisor \\\n && apt-get autoclean \\\n && apt-get autoremove \\\n && rm -rf /var/lib/apt/lists/*\n#  WORKDIR /apps\t\n#  添加服务器代码目录到容器里\n#  VOLUME /apps /apps\n#  暴露端口\n#  EXPOSE 80 9502\n#  启动代码\n#  CMD [\"/bin/bash\"]\n","originalDockerfileUglifiedHash":"555953ab541baf408fc33bc2867e414a","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/5ad611cc641d38a11512021543f807217a8fcac4.dockerfile"}