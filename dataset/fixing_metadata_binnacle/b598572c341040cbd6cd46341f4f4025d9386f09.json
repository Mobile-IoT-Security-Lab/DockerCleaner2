{"seed":3299190072,"processedDockerfileHash":"dc4d47b192d7910cde7d50f9484bc5c4","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["have-a-healthcheck"],"processedDockerfile":"FROM metacell/java-virgo-maven:development\nLABEL maintainer=\"Facundo Rodriguez <facundo@metacell.us>\"\nARG aKey\nENV aKey=\"${aKey}\"\nARG sKey\nENV sKey=\"${sKey}\"\nARG targetBranch=master\nARG originBranch=master\nARG defaultBranch=master\nRUN /bin/echo -e \"\\e[1;35mORIGIN BRANCH ------------ $originBranch\\e[0m\" \\\n && /bin/echo -e \"\\e[1;35mTARGET BRANCH ------------ $targetBranch\\e[0m\" \\\n && /bin/echo -e \"\\e[1;35mDEFAULT BRANCH ------------ $defaultBranch\\e[0m\"\n#   get geppetto\nRUN mkdir -p workspace \\\n && cd workspace \\\n && ../copy.sh http://github.com/openworm/org.geppetto.git \"${targetBranch}\" \"${originBranch}\" \"${defaultBranch}\"\nCOPY config.json workspace/org.geppetto/utilities/source_setup/\nRUN sudo mv /home/developer/workspace/org.geppetto/utilities/docker/geppetto-persistence/geppetto.plan /home/developer\nCOPY geppetto.plan workspace/org.geppetto/\nWORKDIR $HOME/workspace\nRUN ../copy.sh https://github.com/openworm/org.geppetto.model.git \"${targetBranch}\" \"${originBranch}\" \"${defaultBranch}\" \\\n && cd org.geppetto.model \\\n && /bin/echo -e \"\\e[96mMaven install org.geppetto.model\\e[0m\" \\\n && mvn --quiet install \\\n && rm -rf src\nRUN ../copy.sh https://github.com/openworm/org.geppetto.core.git \"${targetBranch}\" \"${originBranch}\" \"${defaultBranch}\" \\\n && cd org.geppetto.core \\\n && /bin/echo -e \"\\e[96mMaven install org.geppetto.core\\e[0m\" \\\n && mvn --quiet install \\\n && rm -rf src\nRUN ../copy.sh https://github.com/openworm/org.geppetto.model.neuroml.git \"${targetBranch}\" \"${originBranch}\" \"${defaultBranch}\" \\\n && cd org.geppetto.model.neuroml \\\n && /bin/echo -e \"\\e[96mMaven install org.geppetto.model.neuroml\\e[0m\" \\\n && mvn --quiet install \\\n && rm -rf src\nRUN ../copy.sh https://github.com/openworm/org.geppetto.simulation.git \"${targetBranch}\" \"${originBranch}\" \"${defaultBranch}\" \\\n && cd org.geppetto.simulation \\\n && /bin/echo -e \"\\e[96mMaven install org.geppetto.simulation\\e[0m\" \\\n && mvn --quiet install \\\n && rm -rf src\nRUN ../copy.sh https://github.com/openworm/org.geppetto.frontend.git \"${targetBranch}\" \"${originBranch}\" \"${defaultBranch}\"\nRUN cd $HOME/workspace/org.geppetto.frontend/src/main \\\n && $HOME/copy.sh https://github.com/openworm/geppetto-application.git \"${targetBranch}\" \"${originBranch}\" \"${defaultBranch}\" \\\n && mv geppetto-application webapp\nRUN cd $HOME/workspace/org.geppetto.frontend/src/main/webapp \\\n && $HOME/rename.sh https://github.com/openworm/geppetto-client.git \"${targetBranch}\" \"${originBranch}\" \"${defaultBranch}\"\nRUN cd $HOME/workspace/org.geppetto.frontend \\\n && mvn --quiet install \\\n && rm -rf src\nRUN ../copy.sh https://github.com/openworm/org.geppetto.persistence.git \"${targetBranch}\" \"${originBranch}\" \"${defaultBranch}\" \\\n && cd org.geppetto.persistence \\\n && /bin/echo -e \"\\e[96mMaven install org.geppetto.persistence\\e[0m\" \\\n && mvn --quiet install\nWORKDIR $HOME\n#  END GET GEPPETTO SOURCES\n#  INSTALL MYSQL\nUSER root\nENV MYSQL_USER=\"mysql\" \\\n    MYSQL_DATA_DIR=\"/var/lib/mysql\" \\\n    MYSQL_RUN_DIR=\"/run/mysqld\" \\\n    MYSQL_LOG_DIR=\"/var/log/mysql\"\nRUN apt-get -o Acquire::Check-Valid-Until=false update \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -qq -y mysql-server \\\n && rm -rf ${MYSQL_DATA_DIR} \\\n && rm -rf /var/lib/apt/lists/*\nRUN mkdir -p ${MYSQL_DATA_DIR} \\\n && mkdir -p ${MYSQL_RUN_DIR} \\\n && mkdir -p ${MYSQL_LOG_DIR}\nUSER developer\n#  SETUP MYSQL CONFIG\nRUN mkdir -p geppetto/\nRUN mkdir rm /home/developer/virgo/./repository/usr\nCOPY db.properties geppetto/\nCOPY init.sql geppetto/\n#  COPY entrypoint.sh geppetto/\n#  RUN sudo chmod +x geppetto/entrypoint.sh\n#  END SETUP MYSQL CONFIG\n#  SETUP MYSQL INITIAL DATA\nUSER root\nRUN mysql_install_db --user=mysql > /dev/null 2>&1\nRUN sed 's/password = .*/password = /g' -i /etc/mysql/debian.cnf\nRUN service mysql start \\\n && mysql -uroot < /home/developer/geppetto/init.sql\n#  END SETUP MYSQL INITIAL DATA\nUSER developer\n#   RUN cd /home/developer/workspace/org.geppetto.persistence && mvn install --quiet && mvn install\nRUN sudo service mysql start \\\n && cd /home/developer/workspace/org.geppetto.persistence \\\n && mvn exec:java -Dexec.mainClass=\"org.geppetto.persistence.util.DBTestData\" -Dexec.classpathScope=runtime\n#  END INSTALL MYSQL\nRUN cd /home/developer/workspace/org.geppetto/utilities/source_setup \\\n && python update_server.py\nRUN sudo echo \"accessKey=$aKey\" > /home/developer/geppetto/aws.credentials\nRUN sudo echo \"secretKey=$sKey\" >> /home/developer/geppetto/aws.credentials\nEXPOSE 8080/tcp\nCMD sudo service mysql start \\\n && /home/developer/virgo/bin/startup.sh\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM metacell/java-virgo-maven:development\nLABEL maintainer=\"Facundo Rodriguez <facundo@metacell.us>\"\nARG aKey\nENV aKey=\"${aKey}\"\nARG sKey\nENV sKey=\"${sKey}\"\nARG targetBranch=master\nARG originBranch=master\nARG defaultBranch=master\nRUN /bin/echo -e \"\\e[1;35mORIGIN BRANCH ------------ $originBranch\\e[0m\" \\\n && /bin/echo -e \"\\e[1;35mTARGET BRANCH ------------ $targetBranch\\e[0m\" \\\n && /bin/echo -e \"\\e[1;35mDEFAULT BRANCH ------------ $defaultBranch\\e[0m\"\n#  get geppetto\nRUN mkdir -p workspace \\\n && cd workspace \\\n && ../copy.sh http://github.com/openworm/org.geppetto.git \"${targetBranch}\" \"${originBranch}\" \"${defaultBranch}\"\nCOPY config.json workspace/org.geppetto/utilities/source_setup/\nRUN sudo mv /home/developer/workspace/org.geppetto/utilities/docker/geppetto-persistence/geppetto.plan /home/developer\nCOPY geppetto.plan workspace/org.geppetto/\nWORKDIR $HOME/workspace\nRUN ../copy.sh https://github.com/openworm/org.geppetto.model.git \"${targetBranch}\" \"${originBranch}\" \"${defaultBranch}\" \\\n && cd org.geppetto.model \\\n && /bin/echo -e \"\\e[96mMaven install org.geppetto.model\\e[0m\" \\\n && mvn --quiet install \\\n && rm -rf src\nRUN ../copy.sh https://github.com/openworm/org.geppetto.core.git \"${targetBranch}\" \"${originBranch}\" \"${defaultBranch}\" \\\n && cd org.geppetto.core \\\n && /bin/echo -e \"\\e[96mMaven install org.geppetto.core\\e[0m\" \\\n && mvn --quiet install \\\n && rm -rf src\nRUN ../copy.sh https://github.com/openworm/org.geppetto.model.neuroml.git \"${targetBranch}\" \"${originBranch}\" \"${defaultBranch}\" \\\n && cd org.geppetto.model.neuroml \\\n && /bin/echo -e \"\\e[96mMaven install org.geppetto.model.neuroml\\e[0m\" \\\n && mvn --quiet install \\\n && rm -rf src\nRUN ../copy.sh https://github.com/openworm/org.geppetto.simulation.git \"${targetBranch}\" \"${originBranch}\" \"${defaultBranch}\" \\\n && cd org.geppetto.simulation \\\n && /bin/echo -e \"\\e[96mMaven install org.geppetto.simulation\\e[0m\" \\\n && mvn --quiet install \\\n && rm -rf src\nRUN ../copy.sh https://github.com/openworm/org.geppetto.frontend.git \"${targetBranch}\" \"${originBranch}\" \"${defaultBranch}\"\nRUN cd $HOME/workspace/org.geppetto.frontend/src/main \\\n && $HOME/copy.sh https://github.com/openworm/geppetto-application.git \"${targetBranch}\" \"${originBranch}\" \"${defaultBranch}\" \\\n && mv geppetto-application webapp\nRUN cd $HOME/workspace/org.geppetto.frontend/src/main/webapp \\\n && $HOME/rename.sh https://github.com/openworm/geppetto-client.git \"${targetBranch}\" \"${originBranch}\" \"${defaultBranch}\"\nRUN cd $HOME/workspace/org.geppetto.frontend \\\n && mvn --quiet install \\\n && rm -rf src\nRUN ../copy.sh https://github.com/openworm/org.geppetto.persistence.git \"${targetBranch}\" \"${originBranch}\" \"${defaultBranch}\" \\\n && cd org.geppetto.persistence \\\n && /bin/echo -e \"\\e[96mMaven install org.geppetto.persistence\\e[0m\" \\\n && mvn --quiet install\nWORKDIR $HOME\n# END GET GEPPETTO SOURCES\n# INSTALL MYSQL\nUSER root\nENV MYSQL_USER=\"mysql\" \\\n    MYSQL_DATA_DIR=\"/var/lib/mysql\" \\\n    MYSQL_RUN_DIR=\"/run/mysqld\" \\\n    MYSQL_LOG_DIR=\"/var/log/mysql\"\nRUN apt-get -o Acquire::Check-Valid-Until=false update \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -qq -y mysql-server \\\n && rm -rf ${MYSQL_DATA_DIR} \\\n && rm -rf /var/lib/apt/lists/*\nRUN mkdir -p ${MYSQL_DATA_DIR} \\\n && mkdir -p ${MYSQL_RUN_DIR} \\\n && mkdir -p ${MYSQL_LOG_DIR}\nUSER developer\n# SETUP MYSQL CONFIG\nRUN mkdir -p geppetto/\nRUN mkdir rm /home/developer/virgo/./repository/usr\nCOPY db.properties geppetto/\nCOPY init.sql geppetto/\n# COPY entrypoint.sh geppetto/\n# RUN sudo chmod +x geppetto/entrypoint.sh\n# END SETUP MYSQL CONFIG\n# SETUP MYSQL INITIAL DATA\nUSER root\nRUN mysql_install_db --user=mysql > /dev/null 2>&1\nRUN sed 's/password = .*/password = /g' -i /etc/mysql/debian.cnf\nRUN service mysql start \\\n && mysql -uroot < /home/developer/geppetto/init.sql\n# END SETUP MYSQL INITIAL DATA\nUSER developer\n#  RUN cd /home/developer/workspace/org.geppetto.persistence && mvn install --quiet && mvn install\nRUN sudo service mysql start \\\n && cd /home/developer/workspace/org.geppetto.persistence \\\n && mvn exec:java -Dexec.mainClass=\"org.geppetto.persistence.util.DBTestData\" -Dexec.classpathScope=runtime\n# END INSTALL MYSQL\nRUN cd /home/developer/workspace/org.geppetto/utilities/source_setup \\\n && python update_server.py\nRUN sudo echo \"accessKey=$aKey\" > /home/developer/geppetto/aws.credentials\nRUN sudo echo \"secretKey=$sKey\" >> /home/developer/geppetto/aws.credentials\nEXPOSE 8080/tcp\nCMD sudo service mysql start \\\n && /home/developer/virgo/bin/startup.sh\n","injectedSmells":[],"originalDockerfileHash":"bec11c4d955d93f721b09524c4a5a538","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM metacell/java-virgo-maven:development\nLABEL maintainer=\"Facundo Rodriguez <facundo@metacell.us>\"\nARG aKey\nENV aKey=\"${aKey}\"\nARG sKey\nENV sKey=\"${sKey}\"\nARG targetBranch=master\nARG originBranch=master\nARG defaultBranch=master\nRUN /bin/echo -e \"\\e[1;35mORIGIN BRANCH ------------ $originBranch\\e[0m\" \\\n && /bin/echo -e \"\\e[1;35mTARGET BRANCH ------------ $targetBranch\\e[0m\" \\\n && /bin/echo -e \"\\e[1;35mDEFAULT BRANCH ------------ $defaultBranch\\e[0m\"\n#   get geppetto\nRUN mkdir -p workspace \\\n && cd workspace \\\n && ../copy.sh http://github.com/openworm/org.geppetto.git \"${targetBranch}\" \"${originBranch}\" \"${defaultBranch}\"\nCOPY config.json workspace/org.geppetto/utilities/source_setup/\nRUN sudo mv /home/developer/workspace/org.geppetto/utilities/docker/geppetto-persistence/geppetto.plan /home/developer\nCOPY geppetto.plan workspace/org.geppetto/\nWORKDIR $HOME/workspace\nRUN ../copy.sh https://github.com/openworm/org.geppetto.model.git \"${targetBranch}\" \"${originBranch}\" \"${defaultBranch}\" \\\n && cd org.geppetto.model \\\n && /bin/echo -e \"\\e[96mMaven install org.geppetto.model\\e[0m\" \\\n && mvn --quiet install \\\n && rm -rf src\nRUN ../copy.sh https://github.com/openworm/org.geppetto.core.git \"${targetBranch}\" \"${originBranch}\" \"${defaultBranch}\" \\\n && cd org.geppetto.core \\\n && /bin/echo -e \"\\e[96mMaven install org.geppetto.core\\e[0m\" \\\n && mvn --quiet install \\\n && rm -rf src\nRUN ../copy.sh https://github.com/openworm/org.geppetto.model.neuroml.git \"${targetBranch}\" \"${originBranch}\" \"${defaultBranch}\" \\\n && cd org.geppetto.model.neuroml \\\n && /bin/echo -e \"\\e[96mMaven install org.geppetto.model.neuroml\\e[0m\" \\\n && mvn --quiet install \\\n && rm -rf src\nRUN ../copy.sh https://github.com/openworm/org.geppetto.simulation.git \"${targetBranch}\" \"${originBranch}\" \"${defaultBranch}\" \\\n && cd org.geppetto.simulation \\\n && /bin/echo -e \"\\e[96mMaven install org.geppetto.simulation\\e[0m\" \\\n && mvn --quiet install \\\n && rm -rf src\nRUN ../copy.sh https://github.com/openworm/org.geppetto.frontend.git \"${targetBranch}\" \"${originBranch}\" \"${defaultBranch}\"\nRUN cd $HOME/workspace/org.geppetto.frontend/src/main \\\n && $HOME/copy.sh https://github.com/openworm/geppetto-application.git \"${targetBranch}\" \"${originBranch}\" \"${defaultBranch}\" \\\n && mv geppetto-application webapp\nRUN cd $HOME/workspace/org.geppetto.frontend/src/main/webapp \\\n && $HOME/rename.sh https://github.com/openworm/geppetto-client.git \"${targetBranch}\" \"${originBranch}\" \"${defaultBranch}\"\nRUN cd $HOME/workspace/org.geppetto.frontend \\\n && mvn --quiet install \\\n && rm -rf src\nRUN ../copy.sh https://github.com/openworm/org.geppetto.persistence.git \"${targetBranch}\" \"${originBranch}\" \"${defaultBranch}\" \\\n && cd org.geppetto.persistence \\\n && /bin/echo -e \"\\e[96mMaven install org.geppetto.persistence\\e[0m\" \\\n && mvn --quiet install\nWORKDIR $HOME\n#  END GET GEPPETTO SOURCES\n#  INSTALL MYSQL\nUSER root\nENV MYSQL_USER=\"mysql\" \\\n    MYSQL_DATA_DIR=\"/var/lib/mysql\" \\\n    MYSQL_RUN_DIR=\"/run/mysqld\" \\\n    MYSQL_LOG_DIR=\"/var/log/mysql\"\nRUN apt-get -o Acquire::Check-Valid-Until=false update \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -qq -y mysql-server \\\n && rm -rf ${MYSQL_DATA_DIR} \\\n && rm -rf /var/lib/apt/lists/*\nRUN mkdir -p ${MYSQL_DATA_DIR} \\\n && mkdir -p ${MYSQL_RUN_DIR} \\\n && mkdir -p ${MYSQL_LOG_DIR}\nUSER developer\n#  SETUP MYSQL CONFIG\nRUN mkdir -p geppetto/\nRUN mkdir rm /home/developer/virgo/./repository/usr\nCOPY db.properties geppetto/\nCOPY init.sql geppetto/\n#  COPY entrypoint.sh geppetto/\n#  RUN sudo chmod +x geppetto/entrypoint.sh\n#  END SETUP MYSQL CONFIG\n#  SETUP MYSQL INITIAL DATA\nUSER root\nRUN mysql_install_db --user=mysql > /dev/null 2>&1\nRUN sed 's/password = .*/password = /g' -i /etc/mysql/debian.cnf\nRUN service mysql start \\\n && mysql -uroot < /home/developer/geppetto/init.sql\n#  END SETUP MYSQL INITIAL DATA\nUSER developer\n#   RUN cd /home/developer/workspace/org.geppetto.persistence && mvn install --quiet && mvn install\nRUN sudo service mysql start \\\n && cd /home/developer/workspace/org.geppetto.persistence \\\n && mvn exec:java -Dexec.mainClass=\"org.geppetto.persistence.util.DBTestData\" -Dexec.classpathScope=runtime\n#  END INSTALL MYSQL\nRUN cd /home/developer/workspace/org.geppetto/utilities/source_setup \\\n && python update_server.py\nRUN sudo echo \"accessKey=$aKey\" > /home/developer/geppetto/aws.credentials\nRUN sudo echo \"secretKey=$sKey\" >> /home/developer/geppetto/aws.credentials\nEXPOSE 8080/tcp\nCMD sudo service mysql start \\\n && /home/developer/virgo/bin/startup.sh\n","originalDockerfileUglifiedHash":"4f09d2a0cc7267da40b8e55851aa6410","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/b598572c341040cbd6cd46341f4f4025d9386f09.dockerfile"}