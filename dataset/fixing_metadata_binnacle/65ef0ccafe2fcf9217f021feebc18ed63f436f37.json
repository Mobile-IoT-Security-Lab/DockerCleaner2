{"seed":1636746624,"processedDockerfileHash":"ea1f7387b5bb4d9b4e33824c86ff1155","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apt-get","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM ubuntu:bionic\nENV DEBIAN_FRONTEND=\"noninteractive\"\nARG COMPOSER_HASH=\"48e3236262b34d30969dca3c37281b3b4bbe3221bda826ac6a9a62d6444cdb0dcd0615698a5cbe587c3f0fe57a54d8f5\"\nARG NODE_VERSION=\"10.9.0\"\nARG YARN_VERSION=\"1.9.4\"\nARG USER_NAME=\"dev\"\nARG USER_UID=\"1000\"\nARG USER_GID=\"1000\"\nENV TERM=\"xterm\"\nENV LOCALTIME=\"Europe/Warsaw\"\nENV PHP_VER=\"7.2\"\nENV PHP_ETC_DIR=\"/etc/php/${PHP_VER}\"\nRUN apt-get update -q \\\n && apt-get install --no-install-recommends apt-utils=1.6.14 gpg-agent=2.2.4-1ubuntu1.6 software-properties-common=0.96.24.32.20 build-essential=12.4ubuntu1 curl=7.58.0-2ubuntu3.24 -qyf \\\n && apt-get -y remove cmdtest \\\n && add-apt-repository ppa:adshares/releases -y \\\n && add-apt-repository -y ppa:ondrej/php \\\n && curl -sL https://deb.nodesource.com/setup_8.x | bash - \\\n && curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | apt-key add - \\\n && echo \"deb https://dl.yarnpkg.com/debian/ stable main\" | tee /etc/apt/sources.list.d/yarn.list \\\n && apt-get update -q \\\n && apt-get install --no-install-recommends nmap=7.60-1ubuntu5 mtr=0.92-1 curl=7.58.0-2ubuntu3.24 wget=1.19.4-1ubuntu2.2 vim=2:8.0.1453-1ubuntu1.11 less=487-0.1 dnsutils=1:9.11.3+dfsg-1ubuntu1.18 bash-completion=1:2.8-1ubuntu1 net-tools=1.60+git20161116.90da8a0-1ubuntu1 git=1:2.17.1-1ubuntu0.17 bzip2=1.0.6-8.1ubuntu0.2 zip=3.0-11build1 unzip=6.0-21ubuntu1.2 tree=1.7.0-5 mc=3:4.8.19-1 gettext-base=0.19.8.1-6ubuntu0.3 openssl=1.1.1-1ubuntu2.1~18.04.21 openssh-client=1:7.6p1-4ubuntu0.7 openssh-server=1:7.6p1-4ubuntu0.7 gnupg2=2.2.4-1ubuntu1.6 dirmngr=2.2.4-1ubuntu1.6 connect-proxy=1.105-1 iproute2=4.15.0-2ubuntu1.3 mysql-client=5.7.41-0ubuntu0.18.04.1 php-xdebug=2.6.0-0ubuntu1 php-apcu=5.1.9+4.0.11-1build1 ads nodejs=8.10.0~dfsg-2ubuntu0.4 yarn cron=3.0pl1-128.1ubuntu1.2 iputils-* php${PHP_VER}-fpm php${PHP_VER}-mysql php${PHP_VER}-bcmath php${PHP_VER}-bz2 php${PHP_VER}-curl php${PHP_VER}-gd php${PHP_VER}-intl php${PHP_VER}-json php${PHP_VER}-mbstring php${PHP_VER}-opcache php${PHP_VER}-readline php${PHP_VER}-sqlite3 php${PHP_VER}-xml php${PHP_VER}-zip -qyf \\\n && apt-get -qy autoremove \\\n && apt-get -qy clean all \\\n && rm -rf /var/lib/apt/lists/* /var/cache/apk/* /usr/share/doc/* \\\n && echo \"apc.enable_cli=1\" >> /etc/php/${PHP_VER}/cli/php.ini\n#   sshd config\nRUN mkdir /var/run/sshd\nRUN sed \"s|#PasswordAuthentication\\s*yes|PasswordAuthentication no|g\" /etc/ssh/sshd_config\nRUN sed \"s|session\\s*required\\s*pam_loginuid.so|session optional pam_loginuid.so|g\" -i /etc/pam.d/sshd\n#   timezone\nRUN ln -sf /usr/share/zoneinfo/$LOCALTIME /etc/localtime\nRUN echo \"date.timezone = \\\"${LOCALTIME}\\\"\" | tee --append ${PHP_ETC_DIR}/cli/conf.d/00-default.ini\nRUN echo \"date.timezone = \\\"${LOCALTIME}\\\"\" | tee --append ${PHP_ETC_DIR}/fpm/conf.d/00-default.ini\n#   composer\nRUN wget https://getcomposer.org/installer --quiet --output-document=/tmp/composer-setup.php \\\n && echo \" expected: $COMPOSER_HASH\" \\\n && php -r \"echo 'calculated: '. hash_file('SHA384','/tmp/composer-setup.php').PHP_EOL;\" \\\n && php -r \"exit(strcmp(hash_file('SHA384','/tmp/composer-setup.php'),getenv('COMPOSER_HASH')));\" \\\n && php /tmp/composer-setup.php --install-dir=/usr/local/bin --filename=composer \\\n && rm /tmp/composer-setup.php\n#   skel\nCOPY skel /etc/skel/\nRUN chmod u+rwX,go-rwx -R /etc/skel/\n#   root\nCOPY skel /root/\nRUN chmod u+rwX,go-rwx -R /root/\n#   group\nRUN groupmod --non-unique --gid $USER_GID www-data\n#   user\nRUN useradd --uid $USER_UID --no-user-group --gid $USER_GID --create-home --shell /bin/bash $USER_NAME\n#   scripts\nCOPY bin /usr/local/bin/\nARG SYSTEM_USER_ID\nARG SYSTEM_USER_NAME\nRUN if [ $SYSTEM_USER_ID -gt 1000 ] ; then useradd --uid $SYSTEM_USER_ID --no-user-group --create-home $SYSTEM_USER_NAME ; fi\n#   Credit: PHPDocker.io\nCOPY overrides.conf ${PHP_ETC_DIR}/fpm/pool.d/z-overrides.conf\nENTRYPOINT [\"docker-php-entrypoint.sh\"]\nCMD [\"php-fpm.sh\"]\nEXPOSE 9000/tcp\nRUN ln -s /usr/bin/ads /usr/local/bin/ads\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM ubuntu:bionic\nENV DEBIAN_FRONTEND=\"noninteractive\"\nARG COMPOSER_HASH=\"48e3236262b34d30969dca3c37281b3b4bbe3221bda826ac6a9a62d6444cdb0dcd0615698a5cbe587c3f0fe57a54d8f5\"\nARG NODE_VERSION=\"10.9.0\"\nARG YARN_VERSION=\"1.9.4\"\nARG USER_NAME=\"dev\"\nARG USER_UID=\"1000\"\nARG USER_GID=\"1000\"\nENV TERM=\"xterm\"\nENV LOCALTIME=\"Europe/Warsaw\"\nENV PHP_VER=\"7.2\"\nENV PHP_ETC_DIR=\"/etc/php/${PHP_VER}\"\nRUN apt-get update -q \\\n && apt-get install --no-install-recommends apt-utils gpg-agent software-properties-common build-essential curl -qyf \\\n && apt-get -y remove cmdtest \\\n && add-apt-repository ppa:adshares/releases -y \\\n && add-apt-repository -y ppa:ondrej/php \\\n && curl -sL https://deb.nodesource.com/setup_8.x | bash - \\\n && curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | apt-key add - \\\n && echo \"deb https://dl.yarnpkg.com/debian/ stable main\" | tee /etc/apt/sources.list.d/yarn.list \\\n && apt-get update -q \\\n && apt-get install --no-install-recommends nmap mtr curl wget vim less dnsutils bash-completion net-tools git bzip2 zip unzip tree mc gettext-base openssl openssh-client openssh-server gnupg2 dirmngr connect-proxy iproute2 mysql-client php-xdebug php-apcu ads nodejs yarn cron iputils-* php${PHP_VER}-fpm php${PHP_VER}-mysql php${PHP_VER}-bcmath php${PHP_VER}-bz2 php${PHP_VER}-curl php${PHP_VER}-gd php${PHP_VER}-intl php${PHP_VER}-json php${PHP_VER}-mbstring php${PHP_VER}-opcache php${PHP_VER}-readline php${PHP_VER}-sqlite3 php${PHP_VER}-xml php${PHP_VER}-zip -qyf \\\n && apt-get -qy autoremove \\\n && apt-get -qy clean all \\\n && rm -rf /var/lib/apt/lists/* /var/cache/apk/* /usr/share/doc/* \\\n && echo \"apc.enable_cli=1\" >> /etc/php/${PHP_VER}/cli/php.ini\n#  sshd config\nRUN mkdir /var/run/sshd\nRUN sed \"s|#PasswordAuthentication\\s*yes|PasswordAuthentication no|g\" /etc/ssh/sshd_config\nRUN sed \"s|session\\s*required\\s*pam_loginuid.so|session optional pam_loginuid.so|g\" -i /etc/pam.d/sshd\n#  timezone\nRUN ln -sf /usr/share/zoneinfo/$LOCALTIME /etc/localtime\nRUN echo \"date.timezone = \\\"${LOCALTIME}\\\"\" | tee --append ${PHP_ETC_DIR}/cli/conf.d/00-default.ini\nRUN echo \"date.timezone = \\\"${LOCALTIME}\\\"\" | tee --append ${PHP_ETC_DIR}/fpm/conf.d/00-default.ini\n#  composer\nRUN wget https://getcomposer.org/installer --quiet --output-document=/tmp/composer-setup.php \\\n && echo \" expected: $COMPOSER_HASH\" \\\n && php -r \"echo 'calculated: '. hash_file('SHA384','/tmp/composer-setup.php').PHP_EOL;\" \\\n && php -r \"exit(strcmp(hash_file('SHA384','/tmp/composer-setup.php'),getenv('COMPOSER_HASH')));\" \\\n && php /tmp/composer-setup.php --install-dir=/usr/local/bin --filename=composer \\\n && rm /tmp/composer-setup.php\n#  skel\nCOPY skel /etc/skel/\nRUN chmod u+rwX,go-rwx -R /etc/skel/\n#  root\nCOPY skel /root/\nRUN chmod u+rwX,go-rwx -R /root/\n#  group\nRUN groupmod --non-unique --gid $USER_GID www-data\n#  user\nRUN useradd --uid $USER_UID --no-user-group --gid $USER_GID --create-home --shell /bin/bash $USER_NAME\n#  scripts\nCOPY bin /usr/local/bin/\nARG SYSTEM_USER_ID\nARG SYSTEM_USER_NAME\nRUN if [ $SYSTEM_USER_ID -gt 1000 ] ; then useradd --uid $SYSTEM_USER_ID --no-user-group --create-home $SYSTEM_USER_NAME ; fi\n#  Credit: PHPDocker.io\nCOPY overrides.conf ${PHP_ETC_DIR}/fpm/pool.d/z-overrides.conf\nENTRYPOINT [\"docker-php-entrypoint.sh\"]\nCMD [\"php-fpm.sh\"]\nEXPOSE 9000/tcp\nRUN ln -s /usr/bin/ads /usr/local/bin/ads\n","injectedSmells":[],"originalDockerfileHash":"9b0138ce5bc0c5666f1347f4618ec580","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM ubuntu:bionic\nENV DEBIAN_FRONTEND=\"noninteractive\"\nARG COMPOSER_HASH=\"48e3236262b34d30969dca3c37281b3b4bbe3221bda826ac6a9a62d6444cdb0dcd0615698a5cbe587c3f0fe57a54d8f5\"\nARG NODE_VERSION=\"10.9.0\"\nARG YARN_VERSION=\"1.9.4\"\nARG USER_NAME=\"dev\"\nARG USER_UID=\"1000\"\nARG USER_GID=\"1000\"\nENV TERM=\"xterm\"\nENV LOCALTIME=\"Europe/Warsaw\"\nENV PHP_VER=\"7.2\"\nENV PHP_ETC_DIR=\"/etc/php/${PHP_VER}\"\nRUN apt-get update -q \\\n && apt-get install --no-install-recommends apt-utils gpg-agent software-properties-common build-essential curl -qyf \\\n && apt-get -y remove cmdtest \\\n && add-apt-repository ppa:adshares/releases -y \\\n && add-apt-repository -y ppa:ondrej/php \\\n && curl -sL https://deb.nodesource.com/setup_8.x | bash - \\\n && curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | apt-key add - \\\n && echo \"deb https://dl.yarnpkg.com/debian/ stable main\" | tee /etc/apt/sources.list.d/yarn.list \\\n && apt-get update -q \\\n && apt-get install --no-install-recommends nmap mtr curl wget vim less dnsutils bash-completion net-tools git bzip2 zip unzip tree mc gettext-base openssl openssh-client openssh-server gnupg2 dirmngr connect-proxy iproute2 mysql-client php-xdebug php-apcu ads nodejs yarn cron iputils-* php${PHP_VER}-fpm php${PHP_VER}-mysql php${PHP_VER}-bcmath php${PHP_VER}-bz2 php${PHP_VER}-curl php${PHP_VER}-gd php${PHP_VER}-intl php${PHP_VER}-json php${PHP_VER}-mbstring php${PHP_VER}-opcache php${PHP_VER}-readline php${PHP_VER}-sqlite3 php${PHP_VER}-xml php${PHP_VER}-zip -qyf \\\n && apt-get -qy autoremove \\\n && apt-get -qy clean all \\\n && rm -rf /var/lib/apt/lists/* /var/cache/apk/* /usr/share/doc/* \\\n && echo \"apc.enable_cli=1\" >> /etc/php/${PHP_VER}/cli/php.ini\n#   sshd config\nRUN mkdir /var/run/sshd\nRUN sed \"s|#PasswordAuthentication\\s*yes|PasswordAuthentication no|g\" /etc/ssh/sshd_config\nRUN sed \"s|session\\s*required\\s*pam_loginuid.so|session optional pam_loginuid.so|g\" -i /etc/pam.d/sshd\n#   timezone\nRUN ln -sf /usr/share/zoneinfo/$LOCALTIME /etc/localtime\nRUN echo \"date.timezone = \\\"${LOCALTIME}\\\"\" | tee --append ${PHP_ETC_DIR}/cli/conf.d/00-default.ini\nRUN echo \"date.timezone = \\\"${LOCALTIME}\\\"\" | tee --append ${PHP_ETC_DIR}/fpm/conf.d/00-default.ini\n#   composer\nRUN wget https://getcomposer.org/installer --quiet --output-document=/tmp/composer-setup.php \\\n && echo \" expected: $COMPOSER_HASH\" \\\n && php -r \"echo 'calculated: '. hash_file('SHA384','/tmp/composer-setup.php').PHP_EOL;\" \\\n && php -r \"exit(strcmp(hash_file('SHA384','/tmp/composer-setup.php'),getenv('COMPOSER_HASH')));\" \\\n && php /tmp/composer-setup.php --install-dir=/usr/local/bin --filename=composer \\\n && rm /tmp/composer-setup.php\n#   skel\nCOPY skel /etc/skel/\nRUN chmod u+rwX,go-rwx -R /etc/skel/\n#   root\nCOPY skel /root/\nRUN chmod u+rwX,go-rwx -R /root/\n#   group\nRUN groupmod --non-unique --gid $USER_GID www-data\n#   user\nRUN useradd --uid $USER_UID --no-user-group --gid $USER_GID --create-home --shell /bin/bash $USER_NAME\n#   scripts\nCOPY bin /usr/local/bin/\nARG SYSTEM_USER_ID\nARG SYSTEM_USER_NAME\nRUN if [ $SYSTEM_USER_ID -gt 1000 ] ; then useradd --uid $SYSTEM_USER_ID --no-user-group --create-home $SYSTEM_USER_NAME ; fi\n#   Credit: PHPDocker.io\nCOPY overrides.conf ${PHP_ETC_DIR}/fpm/pool.d/z-overrides.conf\nENTRYPOINT [\"docker-php-entrypoint.sh\"]\nCMD [\"php-fpm.sh\"]\nEXPOSE 9000/tcp\nRUN ln -s /usr/bin/ads /usr/local/bin/ads\n","originalDockerfileUglifiedHash":"587124d2cc84ba3bdb5ca95d155c1691","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/65ef0ccafe2fcf9217f021feebc18ed63f436f37.dockerfile"}