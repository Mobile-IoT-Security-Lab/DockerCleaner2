{"seed":3762732563,"processedDockerfileHash":"d4c6d3a91d86c61588ae09f44ed051f2","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","have-a-healthcheck","have-a-user"],"processedDockerfile":"#   Build stage for BerkeleyDB\nFROM alpine AS berkeleydb\nRUN sed -i 's/http\\:\\/\\/dl-cdn.alpinelinux.org/https\\:\\/\\/alpine.global.ssl.fastly.net/g' /etc/apk/repositories\nRUN apk add autoconf=2.71-r1 --no-cache\nRUN apk add automake=1.16.5-r1 --no-cache\nRUN apk add build-base=0.5-r3 --no-cache\nRUN apk add libressl=3.6.2-r0 --no-cache\nENV BERKELEYDB_VERSION=\"db-4.8.30.NC\"\nENV BERKELEYDB_PREFIX=\"/opt/${BERKELEYDB_VERSION}\"\nRUN wget https://download.oracle.com/berkeley-db/${BERKELEYDB_VERSION}.tar.gz\nRUN tar -xzf *.tar.gz\nRUN sed s/__atomic_compare_exchange/__atomic_compare_exchange_db/g -i ${BERKELEYDB_VERSION}/dbinc/atomic.h\nRUN mkdir -p ${BERKELEYDB_PREFIX}\nWORKDIR /${BERKELEYDB_VERSION}/build_unix\nRUN ../dist/configure --enable-cxx --disable-shared --with-pic --prefix=${BERKELEYDB_PREFIX}\nRUN make -j4\nRUN make install\nRUN rm -rf ${BERKELEYDB_PREFIX}/docs\n#   Build stage for Bitcoin Core\nFROM alpine AS bitcoin-core\nCOPY --from=berkeleydb /opt /opt\nRUN sed -i 's/http\\:\\/\\/dl-cdn.alpinelinux.org/https\\:\\/\\/alpine.global.ssl.fastly.net/g' /etc/apk/repositories\nRUN apk add autoconf=2.71-r1 --no-cache\nRUN apk add automake=1.16.5-r1 --no-cache\nRUN apk add boost-dev=1.80.0-r3 --no-cache\nRUN apk add build-base=0.5-r3 --no-cache\nRUN apk add chrpath=0.16-r3 --no-cache\nRUN apk add file=5.43-r0 --no-cache\nRUN apk add gnupg=2.2.40-r0 --no-cache\nRUN apk add libevent-dev=2.1.12-r5 --no-cache\nRUN apk add libressl=3.6.2-r0 --no-cache\nRUN apk add libressl-dev=3.6.2-r0 --no-cache\nRUN apk add libtool=2.4.7-r1 --no-cache\nRUN apk add linux-headers=5.19.5-r0 --no-cache\nRUN apk add protobuf-dev=3.21.9-r0 --no-cache\nRUN apk add zeromq-dev=4.3.4-r1 --no-cache\nRUN set -ex \\\n && for key in 90C8019E36C2E964; do gpg --batch --keyserver keyserver.ubuntu.com --recv-keys \"$key\" || gpg --batch --keyserver pgp.mit.edu --recv-keys \"$key\" || gpg --batch --keyserver keyserver.pgp.com --recv-keys \"$key\" || gpg --batch --keyserver ha.pool.sks-keyservers.net --recv-keys \"$key\" || gpg --batch --keyserver hkp://p80.pool.sks-keyservers.net:80 --recv-keys \"$key\" ; done\nENV BITCOIN_VERSION=\"0.17.1\"\nENV BITCOIN_PREFIX=\"/opt/bitcoin-${BITCOIN_VERSION}\"\nRUN wget https://bitcoin.org/bin/bitcoin-core-${BITCOIN_VERSION}/SHA256SUMS.asc\nRUN wget https://bitcoin.org/bin/bitcoin-core-${BITCOIN_VERSION}/bitcoin-${BITCOIN_VERSION}.tar.gz\nRUN gpg --verify SHA256SUMS.asc\nRUN grep \" bitcoin-${BITCOIN_VERSION}.tar.gz$\" SHA256SUMS.asc | sha256sum -c -\nRUN tar -xzf *.tar.gz\nWORKDIR /bitcoin-${BITCOIN_VERSION}\nRUN sed -i '/AC_PREREQ/a\\AR_FLAGS=cr' src/univalue/configure.ac\nRUN sed -i '/AX_PROG_CC_FOR_BUILD/a\\AR_FLAGS=cr' src/secp256k1/configure.ac\nRUN sed -i s:sys/fcntl.h:fcntl.h: src/compat.h\nRUN ./autogen.sh\nRUN ./configure LDFLAGS=-L`ls -d /opt/db* `/lib/ CPPFLAGS=-I`ls -d /opt/db* `/include/ --prefix=${BITCOIN_PREFIX} --mandir=/usr/share/man --disable-tests --disable-bench --disable-ccache --with-gui=no --with-utils --with-libs --with-daemon\nRUN make -j4\nRUN make install\nRUN strip ${BITCOIN_PREFIX}/bin/bitcoin-cli\nRUN strip ${BITCOIN_PREFIX}/bin/bitcoin-tx\nRUN strip ${BITCOIN_PREFIX}/bin/bitcoind\nRUN strip ${BITCOIN_PREFIX}/lib/libbitcoinconsensus.a\nRUN strip ${BITCOIN_PREFIX}/lib/libbitcoinconsensus.so.0.0.0\n#   Build stage for compiled artifacts\nFROM alpine\nLABEL maintainer.0=\"João Fonseca (@joaopaulofonseca)\" \\\n      maintainer.1=\"Pedro Branco (@pedrobranco)\" \\\n      maintainer.2=\"Rui Marinho (@ruimarinho)\"\nRUN adduser -S bitcoin\nRUN sed -i 's/http\\:\\/\\/dl-cdn.alpinelinux.org/https\\:\\/\\/alpine.global.ssl.fastly.net/g' /etc/apk/repositories\nRUN apk add boost boost-program_options libevent=2.1.12-r5 libressl=3.6.2-r0 libzmq=4.3.4-r1 su-exec=0.2-r2 --no-cache\nENV BITCOIN_DATA=\"/home/bitcoin/.bitcoin\"\nENV BITCOIN_VERSION=\"0.17.1\"\nENV BITCOIN_PREFIX=\"/opt/bitcoin-${BITCOIN_VERSION}\"\nENV PATH=\"${BITCOIN_PREFIX}/bin:$PATH\"\nCOPY --from=bitcoin-core /opt /opt\nCOPY docker-entrypoint.sh /entrypoint.sh\nVOLUME [\"/home/bitcoin/.bitcoin\"]\nEXPOSE 8332/tcp 8333/tcp 18332/tcp 18333/tcp 18444/tcp\nENTRYPOINT [\"/entrypoint.sh\"]\nCMD [\"bitcoind\"]\nRUN addgroup -S docker-user ; adduser -S -G docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  Build stage for BerkeleyDB\nFROM alpine AS berkeleydb\nRUN sed -i 's/http\\:\\/\\/dl-cdn.alpinelinux.org/https\\:\\/\\/alpine.global.ssl.fastly.net/g' /etc/apk/repositories\nRUN apk --no-cache add autoconf\nRUN apk --no-cache add automake\nRUN apk --no-cache add build-base\nRUN apk --no-cache add libressl\nENV BERKELEYDB_VERSION=\"db-4.8.30.NC\"\nENV BERKELEYDB_PREFIX=\"/opt/${BERKELEYDB_VERSION}\"\nRUN wget https://download.oracle.com/berkeley-db/${BERKELEYDB_VERSION}.tar.gz\nRUN tar -xzf *.tar.gz\nRUN sed s/__atomic_compare_exchange/__atomic_compare_exchange_db/g -i ${BERKELEYDB_VERSION}/dbinc/atomic.h\nRUN mkdir -p ${BERKELEYDB_PREFIX}\nWORKDIR /${BERKELEYDB_VERSION}/build_unix\nRUN ../dist/configure --enable-cxx --disable-shared --with-pic --prefix=${BERKELEYDB_PREFIX}\nRUN make -j4\nRUN make install\nRUN rm -rf ${BERKELEYDB_PREFIX}/docs\n#  Build stage for Bitcoin Core\nFROM alpine AS bitcoin-core\nCOPY --from=berkeleydb /opt /opt\nRUN sed -i 's/http\\:\\/\\/dl-cdn.alpinelinux.org/https\\:\\/\\/alpine.global.ssl.fastly.net/g' /etc/apk/repositories\nRUN apk --no-cache add autoconf\nRUN apk --no-cache add automake\nRUN apk --no-cache add boost-dev\nRUN apk --no-cache add build-base\nRUN apk --no-cache add chrpath\nRUN apk --no-cache add file\nRUN apk --no-cache add gnupg\nRUN apk --no-cache add libevent-dev\nRUN apk --no-cache add libressl\nRUN apk --no-cache add libressl-dev\nRUN apk --no-cache add libtool\nRUN apk --no-cache add linux-headers\nRUN apk --no-cache add protobuf-dev\nRUN apk --no-cache add zeromq-dev\nRUN set -ex \\\n && for key in 90C8019E36C2E964; do gpg --batch --keyserver keyserver.ubuntu.com --recv-keys \"$key\" || gpg --batch --keyserver pgp.mit.edu --recv-keys \"$key\" || gpg --batch --keyserver keyserver.pgp.com --recv-keys \"$key\" || gpg --batch --keyserver ha.pool.sks-keyservers.net --recv-keys \"$key\" || gpg --batch --keyserver hkp://p80.pool.sks-keyservers.net:80 --recv-keys \"$key\" ; done\nENV BITCOIN_VERSION=\"0.17.1\"\nENV BITCOIN_PREFIX=\"/opt/bitcoin-${BITCOIN_VERSION}\"\nRUN wget https://bitcoin.org/bin/bitcoin-core-${BITCOIN_VERSION}/SHA256SUMS.asc\nRUN wget https://bitcoin.org/bin/bitcoin-core-${BITCOIN_VERSION}/bitcoin-${BITCOIN_VERSION}.tar.gz\nRUN gpg --verify SHA256SUMS.asc\nRUN grep \" bitcoin-${BITCOIN_VERSION}.tar.gz$\" SHA256SUMS.asc | sha256sum -c -\nRUN tar -xzf *.tar.gz\nWORKDIR /bitcoin-${BITCOIN_VERSION}\nRUN sed -i '/AC_PREREQ/a\\AR_FLAGS=cr' src/univalue/configure.ac\nRUN sed -i '/AX_PROG_CC_FOR_BUILD/a\\AR_FLAGS=cr' src/secp256k1/configure.ac\nRUN sed -i s:sys/fcntl.h:fcntl.h: src/compat.h\nRUN ./autogen.sh\nRUN ./configure LDFLAGS=-L`ls -d /opt/db* `/lib/ CPPFLAGS=-I`ls -d /opt/db* `/include/ --prefix=${BITCOIN_PREFIX} --mandir=/usr/share/man --disable-tests --disable-bench --disable-ccache --with-gui=no --with-utils --with-libs --with-daemon\nRUN make -j4\nRUN make install\nRUN strip ${BITCOIN_PREFIX}/bin/bitcoin-cli\nRUN strip ${BITCOIN_PREFIX}/bin/bitcoin-tx\nRUN strip ${BITCOIN_PREFIX}/bin/bitcoind\nRUN strip ${BITCOIN_PREFIX}/lib/libbitcoinconsensus.a\nRUN strip ${BITCOIN_PREFIX}/lib/libbitcoinconsensus.so.0.0.0\n#  Build stage for compiled artifacts\nFROM alpine\nLABEL maintainer.0=\"João Fonseca (@joaopaulofonseca)\" \\\n      maintainer.1=\"Pedro Branco (@pedrobranco)\" \\\n      maintainer.2=\"Rui Marinho (@ruimarinho)\"\nRUN adduser -S bitcoin\nRUN sed -i 's/http\\:\\/\\/dl-cdn.alpinelinux.org/https\\:\\/\\/alpine.global.ssl.fastly.net/g' /etc/apk/repositories\nRUN apk --no-cache add boost boost-program_options libevent libressl libzmq su-exec\nENV BITCOIN_DATA=\"/home/bitcoin/.bitcoin\"\nENV BITCOIN_VERSION=\"0.17.1\"\nENV BITCOIN_PREFIX=\"/opt/bitcoin-${BITCOIN_VERSION}\"\nENV PATH=\"${BITCOIN_PREFIX}/bin:$PATH\"\nCOPY --from=bitcoin-core /opt /opt\nCOPY docker-entrypoint.sh /entrypoint.sh\nVOLUME [\"/home/bitcoin/.bitcoin\"]\nEXPOSE 8332/tcp 8333/tcp 18332/tcp 18333/tcp 18444/tcp\nENTRYPOINT [\"/entrypoint.sh\"]\nCMD [\"bitcoind\"]\n","injectedSmells":[],"originalDockerfileHash":"44f119b023e1973d42259d2ae046be13","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   Build stage for BerkeleyDB\nFROM alpine AS berkeleydb\nRUN sed -i 's/http\\:\\/\\/dl-cdn.alpinelinux.org/https\\:\\/\\/alpine.global.ssl.fastly.net/g' /etc/apk/repositories\nRUN apk --no-cache add autoconf\nRUN apk --no-cache add automake\nRUN apk --no-cache add build-base\nRUN apk --no-cache add libressl\nENV BERKELEYDB_VERSION=\"db-4.8.30.NC\"\nENV BERKELEYDB_PREFIX=\"/opt/${BERKELEYDB_VERSION}\"\nRUN wget https://download.oracle.com/berkeley-db/${BERKELEYDB_VERSION}.tar.gz\nRUN tar -xzf *.tar.gz\nRUN sed s/__atomic_compare_exchange/__atomic_compare_exchange_db/g -i ${BERKELEYDB_VERSION}/dbinc/atomic.h\nRUN mkdir -p ${BERKELEYDB_PREFIX}\nWORKDIR /${BERKELEYDB_VERSION}/build_unix\nRUN ../dist/configure --enable-cxx --disable-shared --with-pic --prefix=${BERKELEYDB_PREFIX}\nRUN make -j4\nRUN make install\nRUN rm -rf ${BERKELEYDB_PREFIX}/docs\n#   Build stage for Bitcoin Core\nFROM alpine AS bitcoin-core\nCOPY --from=berkeleydb /opt /opt\nRUN sed -i 's/http\\:\\/\\/dl-cdn.alpinelinux.org/https\\:\\/\\/alpine.global.ssl.fastly.net/g' /etc/apk/repositories\nRUN apk --no-cache add autoconf\nRUN apk --no-cache add automake\nRUN apk --no-cache add boost-dev\nRUN apk --no-cache add build-base\nRUN apk --no-cache add chrpath\nRUN apk --no-cache add file\nRUN apk --no-cache add gnupg\nRUN apk --no-cache add libevent-dev\nRUN apk --no-cache add libressl\nRUN apk --no-cache add libressl-dev\nRUN apk --no-cache add libtool\nRUN apk --no-cache add linux-headers\nRUN apk --no-cache add protobuf-dev\nRUN apk --no-cache add zeromq-dev\nRUN set -ex \\\n && for key in 90C8019E36C2E964; do gpg --batch --keyserver keyserver.ubuntu.com --recv-keys \"$key\" || gpg --batch --keyserver pgp.mit.edu --recv-keys \"$key\" || gpg --batch --keyserver keyserver.pgp.com --recv-keys \"$key\" || gpg --batch --keyserver ha.pool.sks-keyservers.net --recv-keys \"$key\" || gpg --batch --keyserver hkp://p80.pool.sks-keyservers.net:80 --recv-keys \"$key\" ; done\nENV BITCOIN_VERSION=\"0.17.1\"\nENV BITCOIN_PREFIX=\"/opt/bitcoin-${BITCOIN_VERSION}\"\nRUN wget https://bitcoin.org/bin/bitcoin-core-${BITCOIN_VERSION}/SHA256SUMS.asc\nRUN wget https://bitcoin.org/bin/bitcoin-core-${BITCOIN_VERSION}/bitcoin-${BITCOIN_VERSION}.tar.gz\nRUN gpg --verify SHA256SUMS.asc\nRUN grep \" bitcoin-${BITCOIN_VERSION}.tar.gz$\" SHA256SUMS.asc | sha256sum -c -\nRUN tar -xzf *.tar.gz\nWORKDIR /bitcoin-${BITCOIN_VERSION}\nRUN sed -i '/AC_PREREQ/a\\AR_FLAGS=cr' src/univalue/configure.ac\nRUN sed -i '/AX_PROG_CC_FOR_BUILD/a\\AR_FLAGS=cr' src/secp256k1/configure.ac\nRUN sed -i s:sys/fcntl.h:fcntl.h: src/compat.h\nRUN ./autogen.sh\nRUN ./configure LDFLAGS=-L`ls -d /opt/db* `/lib/ CPPFLAGS=-I`ls -d /opt/db* `/include/ --prefix=${BITCOIN_PREFIX} --mandir=/usr/share/man --disable-tests --disable-bench --disable-ccache --with-gui=no --with-utils --with-libs --with-daemon\nRUN make -j4\nRUN make install\nRUN strip ${BITCOIN_PREFIX}/bin/bitcoin-cli\nRUN strip ${BITCOIN_PREFIX}/bin/bitcoin-tx\nRUN strip ${BITCOIN_PREFIX}/bin/bitcoind\nRUN strip ${BITCOIN_PREFIX}/lib/libbitcoinconsensus.a\nRUN strip ${BITCOIN_PREFIX}/lib/libbitcoinconsensus.so.0.0.0\n#   Build stage for compiled artifacts\nFROM alpine\nLABEL maintainer.0=\"João Fonseca (@joaopaulofonseca)\" \\\n      maintainer.1=\"Pedro Branco (@pedrobranco)\" \\\n      maintainer.2=\"Rui Marinho (@ruimarinho)\"\nRUN adduser -S bitcoin\nRUN sed -i 's/http\\:\\/\\/dl-cdn.alpinelinux.org/https\\:\\/\\/alpine.global.ssl.fastly.net/g' /etc/apk/repositories\nRUN apk --no-cache add boost boost-program_options libevent libressl libzmq su-exec\nENV BITCOIN_DATA=\"/home/bitcoin/.bitcoin\"\nENV BITCOIN_VERSION=\"0.17.1\"\nENV BITCOIN_PREFIX=\"/opt/bitcoin-${BITCOIN_VERSION}\"\nENV PATH=\"${BITCOIN_PREFIX}/bin:$PATH\"\nCOPY --from=bitcoin-core /opt /opt\nCOPY docker-entrypoint.sh /entrypoint.sh\nVOLUME [\"/home/bitcoin/.bitcoin\"]\nEXPOSE 8332/tcp 8333/tcp 18332/tcp 18333/tcp 18444/tcp\nENTRYPOINT [\"/entrypoint.sh\"]\nCMD [\"bitcoind\"]\n","originalDockerfileUglifiedHash":"b4bf51d112941cbc3073511737462b05","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/83500bce0ce5f7541405e5d6bc187b94a9fffce7.dockerfile"}