{"seed":2808796735,"processedDockerfileHash":"9b3ba5faeecd6ccb771bfc1c6cea5d96","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","have-a-healthcheck","have-a-user"],"processedDockerfile":"#  ###############################################################################\n#   Base image\n#  ###############################################################################\nFROM debian:jessie\n#  ###############################################################################\n#   Build instructions\n#  ###############################################################################\n#   Remove default nginx configs.\nRUN rm -f /etc/nginx/conf.d/*\nRUN chmod o+r /etc/resolv.conf\n#   Install packages\nRUN echo deb http://ftp.br.debian.org/debian jessie main | tee /etc/apt/sources.list.d/debian.list\nRUN echo deb-src http://ftp.br.debian.org/debian jessie main | tee /etc/apt/sources.list.d/debian.list\nRUN echo deb http://ftp.br.debian.org/debian jessie-updates main | tee /etc/apt/sources.list.d/debian.list\nRUN echo deb-src http://ftp.br.debian.org/debian jessie-updates main | tee /etc/apt/sources.list.d/debian.list\nRUN echo deb http://security.debian.org/ jessie/updates main | tee /etc/apt/sources.list.d/debian.list\nRUN echo deb-src http://security.debian.org/ jessie/updates main | tee /etc/apt/sources.list.d/debian.list\nRUN : \\\n && apt-get upgrade -y\nRUN apt-cache search php5\nRUN (apt-get update ;apt-get install --no-install-recommends git supervisor curl wget php5-curl php5-fpm php5-gd php5-mongo php5-memcached php5-mysql php5-mcrypt php5-sqlite php5-xdebug php5-apcu nginx -my )\nRUN (apt-get update ;apt-get install --no-install-recommends pkg-config libssl-dev -my )\n#   Ensure that PHP5 FPM is run as root.\nRUN sed -i \"s/user = www-data/user = root/\" /etc/php5/fpm/pool.d/www.conf\nRUN sed -i \"s/group = www-data/group = root/\" /etc/php5/fpm/pool.d/www.conf\n#   Pass all docker environment\nRUN sed -i '/^;clear_env = no/s/^;//' /etc/php5/fpm/pool.d/www.conf\n#   Get access to FPM-ping page /ping\nRUN sed -i '/^;ping\\.path/s/^;//' /etc/php5/fpm/pool.d/www.conf\n#   Get access to FPM_Status page /status\nRUN sed -i '/^;pm\\.status_path/s/^;//' /etc/php5/fpm/pool.d/www.conf\n#   Prevent PHP Warning: 'xdebug' already loaded.\n#   XDebug loaded with the core\nRUN sed -i '/.*xdebug.so$/s/^/;/' /etc/php5/mods-available/xdebug.ini\n#   Install HHVM\n#  RUN apt-key adv --recv-keys --keyserver hkp://keyserver.ubuntu.com:80 0x5a16e7281be7a449\n#  RUN apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv 0C49F3730359A14518585931BC711F9BA15703C6\n#  RUN echo \"deb http://repo.mongodb.org/apt/debian jessie/mongodb-org/3.4 main\" | tee /etc/apt/sources.list.d/mongodb-org-3.4.list\nRUN apt-get update \\\n && (apt-get update ;apt-get install --no-install-recommends php5-dev php5-cli php-pear php5-mongo curl nano unzip -y )\n#  RUN pecl install mongo\n#  RUN pecl install mongodb-1.1.9\nRUN curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin --filename=composer\nRUN mkdir -p /session\nWORKDIR 'www/api'\nCOPY './www/api/composer.json' '/www/api'\nRUN composer install\n#   Add configuration files\nCOPY conf/nginx.conf /etc/nginx/\nCOPY conf/supervisord.conf /etc/supervisor/conf.d/\nCOPY conf/php.ini /etc/php5/fpm/conf.d/40-custom.ini\nRUN service nginx reload\n#  ###############################################################################\n#   Volumes\n#  ###############################################################################\nVOLUME [\"/var/www\", \"/etc/nginx/conf.d\"]\n#  ###############################################################################\n#   Ports\n#  ###############################################################################\nEXPOSE 80/tcp 443/tcp 9000/tcp\n#  ###############################################################################\n#   Entrypoint\n#  ###############################################################################\nENTRYPOINT [\"/usr/bin/supervisord\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"# ###############################################################################\n#  Base image\n# ###############################################################################\nFROM debian:jessie\n# ###############################################################################\n#  Build instructions\n# ###############################################################################\n#  Remove default nginx configs.\nRUN rm -f /etc/nginx/conf.d/*\nRUN chmod o+r /etc/resolv.conf\n#  Install packages\nRUN echo deb http://ftp.br.debian.org/debian jessie main | tee /etc/apt/sources.list.d/debian.list\nRUN echo deb-src http://ftp.br.debian.org/debian jessie main | tee /etc/apt/sources.list.d/debian.list\nRUN echo deb http://ftp.br.debian.org/debian jessie-updates main | tee /etc/apt/sources.list.d/debian.list\nRUN echo deb-src http://ftp.br.debian.org/debian jessie-updates main | tee /etc/apt/sources.list.d/debian.list\nRUN echo deb http://security.debian.org/ jessie/updates main | tee /etc/apt/sources.list.d/debian.list\nRUN echo deb-src http://security.debian.org/ jessie/updates main | tee /etc/apt/sources.list.d/debian.list\nRUN apt-get update \\\n && apt-get upgrade -y\nRUN apt-cache search php5\nRUN apt-get install git supervisor curl wget php5-curl php5-fpm php5-gd php5-mongo php5-memcached php5-mysql php5-mcrypt php5-sqlite php5-xdebug php5-apcu nginx -my\nRUN apt-get install pkg-config libssl-dev -my\n#  Ensure that PHP5 FPM is run as root.\nRUN sed -i \"s/user = www-data/user = root/\" /etc/php5/fpm/pool.d/www.conf\nRUN sed -i \"s/group = www-data/group = root/\" /etc/php5/fpm/pool.d/www.conf\n#  Pass all docker environment\nRUN sed -i '/^;clear_env = no/s/^;//' /etc/php5/fpm/pool.d/www.conf\n#  Get access to FPM-ping page /ping\nRUN sed -i '/^;ping\\.path/s/^;//' /etc/php5/fpm/pool.d/www.conf\n#  Get access to FPM_Status page /status\nRUN sed -i '/^;pm\\.status_path/s/^;//' /etc/php5/fpm/pool.d/www.conf\n#  Prevent PHP Warning: 'xdebug' already loaded.\n#  XDebug loaded with the core\nRUN sed -i '/.*xdebug.so$/s/^/;/' /etc/php5/mods-available/xdebug.ini\n#  Install HHVM\n# RUN apt-key adv --recv-keys --keyserver hkp://keyserver.ubuntu.com:80 0x5a16e7281be7a449\n# RUN apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv 0C49F3730359A14518585931BC711F9BA15703C6\n# RUN echo \"deb http://repo.mongodb.org/apt/debian jessie/mongodb-org/3.4 main\" | tee /etc/apt/sources.list.d/mongodb-org-3.4.list\nRUN apt-get update \\\n && apt-get install php5-dev php5-cli php-pear php5-mongo curl nano unzip -y\n# RUN pecl install mongo\n# RUN pecl install mongodb-1.1.9\nRUN curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin --filename=composer\nRUN mkdir -p /session\nWORKDIR 'www/api'\nCOPY './www/api/composer.json' '/www/api'\nRUN composer install\n#  Add configuration files\nCOPY conf/nginx.conf /etc/nginx/\nCOPY conf/supervisord.conf /etc/supervisor/conf.d/\nCOPY conf/php.ini /etc/php5/fpm/conf.d/40-custom.ini\nRUN service nginx reload\n# ###############################################################################\n#  Volumes\n# ###############################################################################\nVOLUME [\"/var/www\", \"/etc/nginx/conf.d\"]\n# ###############################################################################\n#  Ports\n# ###############################################################################\nEXPOSE 80/tcp 443/tcp 9000/tcp\n# ###############################################################################\n#  Entrypoint\n# ###############################################################################\nENTRYPOINT [\"/usr/bin/supervisord\"]\n","injectedSmells":[],"originalDockerfileHash":"5812e1179822d5c27cc0fb7ea76ad63f","successfullyInjectedSmells":[],"originalDockerfileUglified":"#  ###############################################################################\n#   Base image\n#  ###############################################################################\nFROM debian:jessie\n#  ###############################################################################\n#   Build instructions\n#  ###############################################################################\n#   Remove default nginx configs.\nRUN rm -f /etc/nginx/conf.d/*\nRUN chmod o+r /etc/resolv.conf\n#   Install packages\nRUN echo deb http://ftp.br.debian.org/debian jessie main | tee /etc/apt/sources.list.d/debian.list\nRUN echo deb-src http://ftp.br.debian.org/debian jessie main | tee /etc/apt/sources.list.d/debian.list\nRUN echo deb http://ftp.br.debian.org/debian jessie-updates main | tee /etc/apt/sources.list.d/debian.list\nRUN echo deb-src http://ftp.br.debian.org/debian jessie-updates main | tee /etc/apt/sources.list.d/debian.list\nRUN echo deb http://security.debian.org/ jessie/updates main | tee /etc/apt/sources.list.d/debian.list\nRUN echo deb-src http://security.debian.org/ jessie/updates main | tee /etc/apt/sources.list.d/debian.list\nRUN apt-get update \\\n && apt-get upgrade -y\nRUN apt-cache search php5\nRUN apt-get install git supervisor curl wget php5-curl php5-fpm php5-gd php5-mongo php5-memcached php5-mysql php5-mcrypt php5-sqlite php5-xdebug php5-apcu nginx -my\nRUN apt-get install pkg-config libssl-dev -my\n#   Ensure that PHP5 FPM is run as root.\nRUN sed -i \"s/user = www-data/user = root/\" /etc/php5/fpm/pool.d/www.conf\nRUN sed -i \"s/group = www-data/group = root/\" /etc/php5/fpm/pool.d/www.conf\n#   Pass all docker environment\nRUN sed -i '/^;clear_env = no/s/^;//' /etc/php5/fpm/pool.d/www.conf\n#   Get access to FPM-ping page /ping\nRUN sed -i '/^;ping\\.path/s/^;//' /etc/php5/fpm/pool.d/www.conf\n#   Get access to FPM_Status page /status\nRUN sed -i '/^;pm\\.status_path/s/^;//' /etc/php5/fpm/pool.d/www.conf\n#   Prevent PHP Warning: 'xdebug' already loaded.\n#   XDebug loaded with the core\nRUN sed -i '/.*xdebug.so$/s/^/;/' /etc/php5/mods-available/xdebug.ini\n#   Install HHVM\n#  RUN apt-key adv --recv-keys --keyserver hkp://keyserver.ubuntu.com:80 0x5a16e7281be7a449\n#  RUN apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv 0C49F3730359A14518585931BC711F9BA15703C6\n#  RUN echo \"deb http://repo.mongodb.org/apt/debian jessie/mongodb-org/3.4 main\" | tee /etc/apt/sources.list.d/mongodb-org-3.4.list\nRUN apt-get update \\\n && apt-get install php5-dev php5-cli php-pear php5-mongo curl nano unzip -y\n#  RUN pecl install mongo\n#  RUN pecl install mongodb-1.1.9\nRUN curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin --filename=composer\nRUN mkdir -p /session\nWORKDIR 'www/api'\nCOPY './www/api/composer.json' '/www/api'\nRUN composer install\n#   Add configuration files\nCOPY conf/nginx.conf /etc/nginx/\nCOPY conf/supervisord.conf /etc/supervisor/conf.d/\nCOPY conf/php.ini /etc/php5/fpm/conf.d/40-custom.ini\nRUN service nginx reload\n#  ###############################################################################\n#   Volumes\n#  ###############################################################################\nVOLUME [\"/var/www\", \"/etc/nginx/conf.d\"]\n#  ###############################################################################\n#   Ports\n#  ###############################################################################\nEXPOSE 80/tcp 443/tcp 9000/tcp\n#  ###############################################################################\n#   Entrypoint\n#  ###############################################################################\nENTRYPOINT [\"/usr/bin/supervisord\"]\n","originalDockerfileUglifiedHash":"209b320f9851287035a66c6dbc15e0e3","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/05b83b993d3e3aa668d610daa49a9c1f7e2b443c.dockerfile"}