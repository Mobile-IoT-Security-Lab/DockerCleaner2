{"seed":4016913169,"processedDockerfileHash":"060a8ba0534ba29636a712e8f3c4e324","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-npm","pin-package-manager-versions-apk","have-a-healthcheck"],"processedDockerfile":"FROM node:9-alpine AS build\nLABEL maintainer=\"arne@hilmann.de\"\nUSER root\nRUN apk update \\\n && apk add curl=7.61.1-r2 python cairo-dev=1.14.8-r0 pkgconf=1.3.7-r0 pixman-dev=0.34.0-r0 pango-dev=1.40.5-r0 g++=6.3.0-r4 make=4.2.1-r0 git=2.13.7-r2 php5=5.6.40-r0 php5-json=5.6.40-r0 libpng=1.6.37-r0 libjpeg-turbo-dev=1.5.3-r2 giflib-dev=5.1.4-r1 \\\n && rm -rf /var/cache/apk/*\nRUN npm -g config set user root\nRUN npm install canvas@2.11.2 -g --build-from-source\n#   RUN npm install -g canvas\nRUN npm install underscore@1.13.6 xpath@0.0.32 xmldom@0.6.0 express@4.18.2 body-parser@1.20.2 canvas-5-polyfill@0.1.5 svgo@3.0.2 sync-files@1.0.3 -g\nWORKDIR /\nRUN git clone https://github.com/dhobsd/asciitosvg.git\nRUN curl -OL https://cdn.jsdelivr.net/gh/pshihn/rough@9be60b1e/dist/rough.js\nRUN curl -OL https://github.com/ipython/xkcd-font/raw/master/xkcd-script/font/xkcd-script.ttf\nFROM node:9-alpine\nLABEL maintainer=\"arne@hilmann.de\"\nCOPY --from=build /asciitosvg /asciitosvg/\nRUN ln -sf /asciitosvg/a2s /usr/bin/a2s\nCOPY --from=build /usr/bin/php5 /usr/bin/php5\nRUN ln -sf /usr/bin/php5 /usr/bin/php\nCOPY --from=build /usr/lib/php5 /usr/lib/php5\nCOPY --from=build /etc/php5 /etc/php5\nCOPY --from=build /usr/bin/fc-* /usr/bin/\n#   ( ldd /usr/bin/fc-cache; ldd /usr/lib/libcairo.*; ldd /usr/lib/libpangocairo-*; ldd /usr/bin/php ) |  sed -n \"s/.* => /    /;T;s/ .*//;s/\\.so\\..*/.* \\\\\\/;p\"  | sort | uniq\nCOPY --from=build /lib/ld-musl-x86_64.* /lib/libcrypto.* /lib/libz.* /lib/\nCOPY --from=build /usr/lib/libX11.* /usr/lib/libXau.* /usr/lib/libXdmcp.* /usr/lib/libXext.* /usr/lib/libXrender.* /usr/lib/libbsd.* /usr/lib/libbz2.* /usr/lib/libcairo.* /usr/lib/libexpat.* /usr/lib/libffi.* /usr/lib/libfontconfig.* /usr/lib/libfreetype.* /usr/lib/libgif.* /usr/lib/libglib-2.0.* /usr/lib/libgobject-2.0.* /usr/lib/libgraphite2.* /usr/lib/libharfbuzz.* /usr/lib/libintl.* /usr/lib/libjpeg.* /usr/lib/libncursesw.* /usr/lib/libpango-1.0.* /usr/lib/libpangoft2-1.0.* /usr/lib/libpcre.* /usr/lib/libpixman-1.* /usr/lib/libpng16.* /usr/lib/libreadline.* /usr/lib/libxcb-render.* /usr/lib/libxcb-shm.* /usr/lib/libxcb.* /usr/lib/libxml2.* /usr/lib/libpangocairo-* /usr/lib/\nRUN /sbin/ldconfig || :\n#   xkcd font\nRUN mkdir -p /usr/share/fonts\nCOPY --from=build xkcd-script.ttf /usr/share/fonts/\nCOPY --from=build /etc/fonts /etc/fonts\nENV FONTCONFIG_PATH=\"/etc/fonts\"\nRUN fc-cache -v -f\nRUN fc-list\nRUN chmod a+rwx /asciitosvg/objects/\n#   node modules\nCOPY --from=build /usr/local/lib/node_modules /usr/local/lib/node_modules\n#   switch to non-root user\nUSER node\nWORKDIR /home/node\nRUN mkdir -p .a2s/\nRUN ln -sf /asciitosvg/objects /home/node/.a2s/objects\nCOPY addons/* /asciitosvg/objects/\nENV NODE_PATH=\"/usr/local/lib/node_modules/\"\nCOPY a2sketch.webserver .\nCOPY rough.js.patch .\nCOPY --from=build /rough.* ./\nRUN ls -al\nRUN cat rough.js\nRUN patch rough.js rough.js.patch\nVOLUME /custom-types\nENTRYPOINT [\"node\", \"a2sketch.webserver\"]\nHEALTHCHECK CMD curl --fail http://127.0.0.1:3000 || exit 1\n","originalDockerfile":"FROM node:9-alpine AS build\nLABEL maintainer=\"arne@hilmann.de\"\nUSER root\nRUN apk update \\\n && apk add curl python cairo-dev pkgconf pixman-dev pango-dev g++ make git php5 php5-json libpng libjpeg-turbo-dev giflib-dev \\\n && rm -rf /var/cache/apk/*\nRUN npm -g config set user root\nRUN npm install canvas -g --build-from-source\n#  RUN npm install -g canvas\nRUN npm install underscore xpath xmldom express body-parser canvas-5-polyfill svgo sync-files -g\nWORKDIR /\nRUN git clone https://github.com/dhobsd/asciitosvg.git\nRUN curl -OL https://cdn.jsdelivr.net/gh/pshihn/rough@9be60b1e/dist/rough.js\nRUN curl -OL https://github.com/ipython/xkcd-font/raw/master/xkcd-script/font/xkcd-script.ttf\nFROM node:9-alpine\nLABEL maintainer=\"arne@hilmann.de\"\nCOPY --from=build /asciitosvg /asciitosvg/\nRUN ln -sf /asciitosvg/a2s /usr/bin/a2s\nCOPY --from=build /usr/bin/php5 /usr/bin/php5\nRUN ln -sf /usr/bin/php5 /usr/bin/php\nCOPY --from=build /usr/lib/php5 /usr/lib/php5\nCOPY --from=build /etc/php5 /etc/php5\nCOPY --from=build /usr/bin/fc-* /usr/bin/\n#  ( ldd /usr/bin/fc-cache; ldd /usr/lib/libcairo.*; ldd /usr/lib/libpangocairo-*; ldd /usr/bin/php ) |  sed -n \"s/.* => /    /;T;s/ .*//;s/\\.so\\..*/.* \\\\\\/;p\"  | sort | uniq\nCOPY --from=build /lib/ld-musl-x86_64.* /lib/libcrypto.* /lib/libz.* /lib/\nCOPY --from=build /usr/lib/libX11.* /usr/lib/libXau.* /usr/lib/libXdmcp.* /usr/lib/libXext.* /usr/lib/libXrender.* /usr/lib/libbsd.* /usr/lib/libbz2.* /usr/lib/libcairo.* /usr/lib/libexpat.* /usr/lib/libffi.* /usr/lib/libfontconfig.* /usr/lib/libfreetype.* /usr/lib/libgif.* /usr/lib/libglib-2.0.* /usr/lib/libgobject-2.0.* /usr/lib/libgraphite2.* /usr/lib/libharfbuzz.* /usr/lib/libintl.* /usr/lib/libjpeg.* /usr/lib/libncursesw.* /usr/lib/libpango-1.0.* /usr/lib/libpangoft2-1.0.* /usr/lib/libpcre.* /usr/lib/libpixman-1.* /usr/lib/libpng16.* /usr/lib/libreadline.* /usr/lib/libxcb-render.* /usr/lib/libxcb-shm.* /usr/lib/libxcb.* /usr/lib/libxml2.* /usr/lib/libpangocairo-* /usr/lib/\nRUN /sbin/ldconfig || :\n#  xkcd font\nRUN mkdir -p /usr/share/fonts\nCOPY --from=build xkcd-script.ttf /usr/share/fonts/\nCOPY --from=build /etc/fonts /etc/fonts\nENV FONTCONFIG_PATH=\"/etc/fonts\"\nRUN fc-cache -v -f\nRUN fc-list\nRUN chmod a+rwx /asciitosvg/objects/\n#  node modules\nCOPY --from=build /usr/local/lib/node_modules /usr/local/lib/node_modules\n#  switch to non-root user\nUSER node\nWORKDIR /home/node\nRUN mkdir -p .a2s/\nRUN ln -sf /asciitosvg/objects /home/node/.a2s/objects\nCOPY addons/* /asciitosvg/objects/\nENV NODE_PATH=\"/usr/local/lib/node_modules/\"\nCOPY a2sketch.webserver .\nCOPY rough.js.patch .\nCOPY --from=build /rough.* ./\nRUN ls -al\nRUN cat rough.js\nRUN patch rough.js rough.js.patch\nVOLUME /custom-types\nENTRYPOINT [\"node\", \"a2sketch.webserver\"]\n","injectedSmells":[],"originalDockerfileHash":"22ceee539e4edfc70691053fef6d3b11","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM node:9-alpine AS build\nLABEL maintainer=\"arne@hilmann.de\"\nUSER root\nRUN apk update \\\n && apk add curl python cairo-dev pkgconf pixman-dev pango-dev g++ make git php5 php5-json libpng libjpeg-turbo-dev giflib-dev \\\n && rm -rf /var/cache/apk/*\nRUN npm -g config set user root\nRUN npm install canvas -g --build-from-source\n#   RUN npm install -g canvas\nRUN npm install underscore xpath xmldom express body-parser canvas-5-polyfill svgo sync-files -g\nWORKDIR /\nRUN git clone https://github.com/dhobsd/asciitosvg.git\nRUN curl -OL https://cdn.jsdelivr.net/gh/pshihn/rough@9be60b1e/dist/rough.js\nRUN curl -OL https://github.com/ipython/xkcd-font/raw/master/xkcd-script/font/xkcd-script.ttf\nFROM node:9-alpine\nLABEL maintainer=\"arne@hilmann.de\"\nCOPY --from=build /asciitosvg /asciitosvg/\nRUN ln -sf /asciitosvg/a2s /usr/bin/a2s\nCOPY --from=build /usr/bin/php5 /usr/bin/php5\nRUN ln -sf /usr/bin/php5 /usr/bin/php\nCOPY --from=build /usr/lib/php5 /usr/lib/php5\nCOPY --from=build /etc/php5 /etc/php5\nCOPY --from=build /usr/bin/fc-* /usr/bin/\n#   ( ldd /usr/bin/fc-cache; ldd /usr/lib/libcairo.*; ldd /usr/lib/libpangocairo-*; ldd /usr/bin/php ) |  sed -n \"s/.* => /    /;T;s/ .*//;s/\\.so\\..*/.* \\\\\\/;p\"  | sort | uniq\nCOPY --from=build /lib/ld-musl-x86_64.* /lib/libcrypto.* /lib/libz.* /lib/\nCOPY --from=build /usr/lib/libX11.* /usr/lib/libXau.* /usr/lib/libXdmcp.* /usr/lib/libXext.* /usr/lib/libXrender.* /usr/lib/libbsd.* /usr/lib/libbz2.* /usr/lib/libcairo.* /usr/lib/libexpat.* /usr/lib/libffi.* /usr/lib/libfontconfig.* /usr/lib/libfreetype.* /usr/lib/libgif.* /usr/lib/libglib-2.0.* /usr/lib/libgobject-2.0.* /usr/lib/libgraphite2.* /usr/lib/libharfbuzz.* /usr/lib/libintl.* /usr/lib/libjpeg.* /usr/lib/libncursesw.* /usr/lib/libpango-1.0.* /usr/lib/libpangoft2-1.0.* /usr/lib/libpcre.* /usr/lib/libpixman-1.* /usr/lib/libpng16.* /usr/lib/libreadline.* /usr/lib/libxcb-render.* /usr/lib/libxcb-shm.* /usr/lib/libxcb.* /usr/lib/libxml2.* /usr/lib/libpangocairo-* /usr/lib/\nRUN /sbin/ldconfig || :\n#   xkcd font\nRUN mkdir -p /usr/share/fonts\nCOPY --from=build xkcd-script.ttf /usr/share/fonts/\nCOPY --from=build /etc/fonts /etc/fonts\nENV FONTCONFIG_PATH=\"/etc/fonts\"\nRUN fc-cache -v -f\nRUN fc-list\nRUN chmod a+rwx /asciitosvg/objects/\n#   node modules\nCOPY --from=build /usr/local/lib/node_modules /usr/local/lib/node_modules\n#   switch to non-root user\nUSER node\nWORKDIR /home/node\nRUN mkdir -p .a2s/\nRUN ln -sf /asciitosvg/objects /home/node/.a2s/objects\nCOPY addons/* /asciitosvg/objects/\nENV NODE_PATH=\"/usr/local/lib/node_modules/\"\nCOPY a2sketch.webserver .\nCOPY rough.js.patch .\nCOPY --from=build /rough.* ./\nRUN ls -al\nRUN cat rough.js\nRUN patch rough.js rough.js.patch\nVOLUME /custom-types\nENTRYPOINT [\"node\", \"a2sketch.webserver\"]\n","originalDockerfileUglifiedHash":"1a34826e9dd80fae47f9ffb2eaf69270","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/28fcfbc418f57c986318eb4136bd75bec2059569.dockerfile"}