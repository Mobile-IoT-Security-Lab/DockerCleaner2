{"seed":2751518675,"processedDockerfileHash":"6073133a6a6b3bbb9abccf0005e23712","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM debian:8\nENV DEBIAN_FRONTEND=\"noninteractive\"\nRUN apt-get update \\\n && apt-get upgrade -y \\\n && apt-get install --no-install-recommends build-essential openssh-server apache2 mysql-server mysql-client bison flex php5 php5-curl php5-cli php5-mysql php-pear php5-gd curl sox libncurses5-dev libssl-dev libmysqlclient-dev mpg123 libxml2-dev libnewt-dev sqlite3 libsqlite3-dev pkg-config automake libtool autoconf git unixodbc-dev uuid uuid-dev libasound2-dev libogg-dev libvorbis-dev libicu-dev libcurl4-openssl-dev libical-dev libneon27-dev libsrtp0-dev libspandsp-dev sudo libmyodbc subversion libtool-bin python-dev aptitude cron fail2ban net-tools vim wget -y \\\n && rm -rf /var/lib/apt/lists/*\nRUN cd /usr/src \\\n && wget -O jansson.tar.gz https://github.com/akheron/jansson/archive/v2.7.tar.gz \\\n && tar xfz jansson.tar.gz \\\n && rm -f jansson.tar.gz \\\n && cd jansson-* \\\n && autoreconf -i \\\n && ./configure \\\n && make \\\n && make install \\\n && rm -r /usr/src/jansson*\nRUN cd /usr/src \\\n && wget http://downloads.asterisk.org/pub/telephony/asterisk/asterisk-15.7.2.tar.gz \\\n && tar xfz asterisk-15.7.2.tar.gz \\\n && rm -f asterisk-15.7.2.tar.gz \\\n && cd asterisk-* \\\n && contrib/scripts/install_prereq install \\\n && ./configure --with-pjproject-bundled \\\n && make menuselect.makeopts \\\n && sed -i \"s/BUILD_NATIVE //\" menuselect.makeopts \\\n && make \\\n && make install \\\n && make config \\\n && ldconfig \\\n && update-rc.d -f asterisk remove \\\n && rm -r /usr/src/asterisk*\nRUN useradd -m asterisk \\\n && chown asterisk. /var/run/asterisk \\\n && chown -R asterisk. /etc/asterisk \\\n && chown -R asterisk. /var/lib/asterisk \\\n && chown -R asterisk. /var/log/asterisk \\\n && chown -R asterisk. /var/spool/asterisk \\\n && chown -R asterisk. /usr/lib/asterisk \\\n && rm -rf /var/www/html\nRUN sed -i 's/^upload_max_filesize = 2M/upload_max_filesize = 120M/' /etc/php5/apache2/php.ini \\\n && sed -i 's/^memory_limit = 128M/memory_limit = 256M/' /etc/php5/apache2/php.ini \\\n && cp /etc/apache2/apache2.conf /etc/apache2/apache2.conf_orig \\\n && sed -i 's/^\\(User\\|Group\\).*/\\1 asterisk/' /etc/apache2/apache2.conf \\\n && sed -i 's/AllowOverride None/AllowOverride All/' /etc/apache2/apache2.conf\nCOPY ./config/odbcinst.ini /etc/odbcinst.ini\nCOPY ./config/odbc.ini /etc/odbc.ini\nRUN cd /usr/src \\\n && wget http://mirror.freepbx.org/modules/packages/freepbx/freepbx-14.0-latest.tgz \\\n && tar xfz freepbx-14.0-latest.tgz \\\n && rm -f freepbx-14.0-latest.tgz \\\n && cd freepbx \\\n && chown mysql:mysql -R /var/lib/mysql/* \\\n && /etc/init.d/mysql start \\\n && ./start_asterisk start \\\n && ./install -n \\\n && fwconsole chown \\\n && fwconsole ma upgradeall \\\n && fwconsole ma downloadinstall announcement backup bulkhandler ringgroups timeconditions ivr restapi cel \\\n && /etc/init.d/mysql stop \\\n && rm -rf /usr/src/freepbx*\nRUN a2enmod rewrite\n#  ### Add G729 Codecs\nRUN git clone https://github.com/BelledonneCommunications/bcg729 /usr/src/bcg729 ; cd /usr/src/bcg729 ; git checkout tags/$BCG729_VERSION ; ./autogen.sh ; ./configure --libdir=/lib ; make ; make install ; mkdir -p /usr/src/asterisk-g72x ; curl https://bitbucket.org/arkadi/asterisk-g72x/get/default.tar.gz | tar xvfz - --strip 1 -C /usr/src/asterisk-g72x ; cd /usr/src/asterisk-g72x ; ./autogen.sh ; ./configure --with-bcg729 --with-asterisk${ASTERISK_VERSION}0 --enable-penryn ; make ; make install\nRUN sed -i 's/^user = mysql/user = root/' /etc/mysql/my.cnf\nCOPY ./run /run\nRUN chmod +x /run/*\nRUN chown asterisk:asterisk -R /var/spool/asterisk\nCMD /run/startup.sh\nEXPOSE 80/tcp 3306/tcp 5060/tcp 5061/tcp 5160/tcp 5161/tcp 4569/tcp 10000-20000/udp\n#  recordings data\nVOLUME [ \"/var/spool/asterisk/monitor\" ]\n#  database data\nVOLUME [ \"/var/lib/mysql\" ]\n#  automatic backup\nVOLUME [ \"/backup\" ]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM debian:8\nENV DEBIAN_FRONTEND=\"noninteractive\"\nRUN apt-get update \\\n && apt-get upgrade -y \\\n && apt-get install build-essential openssh-server apache2 mysql-server mysql-client bison flex php5 php5-curl php5-cli php5-mysql php-pear php5-gd curl sox libncurses5-dev libssl-dev libmysqlclient-dev mpg123 libxml2-dev libnewt-dev sqlite3 libsqlite3-dev pkg-config automake libtool autoconf git unixodbc-dev uuid uuid-dev libasound2-dev libogg-dev libvorbis-dev libicu-dev libcurl4-openssl-dev libical-dev libneon27-dev libsrtp0-dev libspandsp-dev sudo libmyodbc subversion libtool-bin python-dev aptitude cron fail2ban net-tools vim wget -y \\\n && rm -rf /var/lib/apt/lists/*\nRUN cd /usr/src \\\n && wget -O jansson.tar.gz https://github.com/akheron/jansson/archive/v2.7.tar.gz \\\n && tar xfz jansson.tar.gz \\\n && rm -f jansson.tar.gz \\\n && cd jansson-* \\\n && autoreconf -i \\\n && ./configure \\\n && make \\\n && make install \\\n && rm -r /usr/src/jansson*\nRUN cd /usr/src \\\n && wget http://downloads.asterisk.org/pub/telephony/asterisk/asterisk-15.7.2.tar.gz \\\n && tar xfz asterisk-15.7.2.tar.gz \\\n && rm -f asterisk-15.7.2.tar.gz \\\n && cd asterisk-* \\\n && contrib/scripts/install_prereq install \\\n && ./configure --with-pjproject-bundled \\\n && make menuselect.makeopts \\\n && sed -i \"s/BUILD_NATIVE //\" menuselect.makeopts \\\n && make \\\n && make install \\\n && make config \\\n && ldconfig \\\n && update-rc.d -f asterisk remove \\\n && rm -r /usr/src/asterisk*\nRUN useradd -m asterisk \\\n && chown asterisk. /var/run/asterisk \\\n && chown -R asterisk. /etc/asterisk \\\n && chown -R asterisk. /var/lib/asterisk \\\n && chown -R asterisk. /var/log/asterisk \\\n && chown -R asterisk. /var/spool/asterisk \\\n && chown -R asterisk. /usr/lib/asterisk \\\n && rm -rf /var/www/html\nRUN sed -i 's/^upload_max_filesize = 2M/upload_max_filesize = 120M/' /etc/php5/apache2/php.ini \\\n && sed -i 's/^memory_limit = 128M/memory_limit = 256M/' /etc/php5/apache2/php.ini \\\n && cp /etc/apache2/apache2.conf /etc/apache2/apache2.conf_orig \\\n && sed -i 's/^\\(User\\|Group\\).*/\\1 asterisk/' /etc/apache2/apache2.conf \\\n && sed -i 's/AllowOverride None/AllowOverride All/' /etc/apache2/apache2.conf\nCOPY ./config/odbcinst.ini /etc/odbcinst.ini\nCOPY ./config/odbc.ini /etc/odbc.ini\nRUN cd /usr/src \\\n && wget http://mirror.freepbx.org/modules/packages/freepbx/freepbx-14.0-latest.tgz \\\n && tar xfz freepbx-14.0-latest.tgz \\\n && rm -f freepbx-14.0-latest.tgz \\\n && cd freepbx \\\n && chown mysql:mysql -R /var/lib/mysql/* \\\n && /etc/init.d/mysql start \\\n && ./start_asterisk start \\\n && ./install -n \\\n && fwconsole chown \\\n && fwconsole ma upgradeall \\\n && fwconsole ma downloadinstall announcement backup bulkhandler ringgroups timeconditions ivr restapi cel \\\n && /etc/init.d/mysql stop \\\n && rm -rf /usr/src/freepbx*\nRUN a2enmod rewrite\n# ### Add G729 Codecs\nRUN git clone https://github.com/BelledonneCommunications/bcg729 /usr/src/bcg729 ; cd /usr/src/bcg729 ; git checkout tags/$BCG729_VERSION ; ./autogen.sh ; ./configure --libdir=/lib ; make ; make install ; mkdir -p /usr/src/asterisk-g72x ; curl https://bitbucket.org/arkadi/asterisk-g72x/get/default.tar.gz | tar xvfz - --strip 1 -C /usr/src/asterisk-g72x ; cd /usr/src/asterisk-g72x ; ./autogen.sh ; ./configure --with-bcg729 --with-asterisk${ASTERISK_VERSION}0 --enable-penryn ; make ; make install\nRUN sed -i 's/^user = mysql/user = root/' /etc/mysql/my.cnf\nCOPY ./run /run\nRUN chmod +x /run/*\nRUN chown asterisk:asterisk -R /var/spool/asterisk\nCMD /run/startup.sh\nEXPOSE 80/tcp 3306/tcp 5060/tcp 5061/tcp 5160/tcp 5161/tcp 4569/tcp 10000-20000/udp\n# recordings data\nVOLUME [ \"/var/spool/asterisk/monitor\" ]\n# database data\nVOLUME [ \"/var/lib/mysql\" ]\n# automatic backup\nVOLUME [ \"/backup\" ]\n","injectedSmells":[],"originalDockerfileHash":"ac95e8e2525c2a14586075cea400d7d3","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM debian:8\nENV DEBIAN_FRONTEND=\"noninteractive\"\nRUN apt-get update \\\n && apt-get upgrade -y \\\n && apt-get install build-essential openssh-server apache2 mysql-server mysql-client bison flex php5 php5-curl php5-cli php5-mysql php-pear php5-gd curl sox libncurses5-dev libssl-dev libmysqlclient-dev mpg123 libxml2-dev libnewt-dev sqlite3 libsqlite3-dev pkg-config automake libtool autoconf git unixodbc-dev uuid uuid-dev libasound2-dev libogg-dev libvorbis-dev libicu-dev libcurl4-openssl-dev libical-dev libneon27-dev libsrtp0-dev libspandsp-dev sudo libmyodbc subversion libtool-bin python-dev aptitude cron fail2ban net-tools vim wget -y \\\n && rm -rf /var/lib/apt/lists/*\nRUN cd /usr/src \\\n && wget -O jansson.tar.gz https://github.com/akheron/jansson/archive/v2.7.tar.gz \\\n && tar xfz jansson.tar.gz \\\n && rm -f jansson.tar.gz \\\n && cd jansson-* \\\n && autoreconf -i \\\n && ./configure \\\n && make \\\n && make install \\\n && rm -r /usr/src/jansson*\nRUN cd /usr/src \\\n && wget http://downloads.asterisk.org/pub/telephony/asterisk/asterisk-15.7.2.tar.gz \\\n && tar xfz asterisk-15.7.2.tar.gz \\\n && rm -f asterisk-15.7.2.tar.gz \\\n && cd asterisk-* \\\n && contrib/scripts/install_prereq install \\\n && ./configure --with-pjproject-bundled \\\n && make menuselect.makeopts \\\n && sed -i \"s/BUILD_NATIVE //\" menuselect.makeopts \\\n && make \\\n && make install \\\n && make config \\\n && ldconfig \\\n && update-rc.d -f asterisk remove \\\n && rm -r /usr/src/asterisk*\nRUN useradd -m asterisk \\\n && chown asterisk. /var/run/asterisk \\\n && chown -R asterisk. /etc/asterisk \\\n && chown -R asterisk. /var/lib/asterisk \\\n && chown -R asterisk. /var/log/asterisk \\\n && chown -R asterisk. /var/spool/asterisk \\\n && chown -R asterisk. /usr/lib/asterisk \\\n && rm -rf /var/www/html\nRUN sed -i 's/^upload_max_filesize = 2M/upload_max_filesize = 120M/' /etc/php5/apache2/php.ini \\\n && sed -i 's/^memory_limit = 128M/memory_limit = 256M/' /etc/php5/apache2/php.ini \\\n && cp /etc/apache2/apache2.conf /etc/apache2/apache2.conf_orig \\\n && sed -i 's/^\\(User\\|Group\\).*/\\1 asterisk/' /etc/apache2/apache2.conf \\\n && sed -i 's/AllowOverride None/AllowOverride All/' /etc/apache2/apache2.conf\nCOPY ./config/odbcinst.ini /etc/odbcinst.ini\nCOPY ./config/odbc.ini /etc/odbc.ini\nRUN cd /usr/src \\\n && wget http://mirror.freepbx.org/modules/packages/freepbx/freepbx-14.0-latest.tgz \\\n && tar xfz freepbx-14.0-latest.tgz \\\n && rm -f freepbx-14.0-latest.tgz \\\n && cd freepbx \\\n && chown mysql:mysql -R /var/lib/mysql/* \\\n && /etc/init.d/mysql start \\\n && ./start_asterisk start \\\n && ./install -n \\\n && fwconsole chown \\\n && fwconsole ma upgradeall \\\n && fwconsole ma downloadinstall announcement backup bulkhandler ringgroups timeconditions ivr restapi cel \\\n && /etc/init.d/mysql stop \\\n && rm -rf /usr/src/freepbx*\nRUN a2enmod rewrite\n#  ### Add G729 Codecs\nRUN git clone https://github.com/BelledonneCommunications/bcg729 /usr/src/bcg729 ; cd /usr/src/bcg729 ; git checkout tags/$BCG729_VERSION ; ./autogen.sh ; ./configure --libdir=/lib ; make ; make install ; mkdir -p /usr/src/asterisk-g72x ; curl https://bitbucket.org/arkadi/asterisk-g72x/get/default.tar.gz | tar xvfz - --strip 1 -C /usr/src/asterisk-g72x ; cd /usr/src/asterisk-g72x ; ./autogen.sh ; ./configure --with-bcg729 --with-asterisk${ASTERISK_VERSION}0 --enable-penryn ; make ; make install\nRUN sed -i 's/^user = mysql/user = root/' /etc/mysql/my.cnf\nCOPY ./run /run\nRUN chmod +x /run/*\nRUN chown asterisk:asterisk -R /var/spool/asterisk\nCMD /run/startup.sh\nEXPOSE 80/tcp 3306/tcp 5060/tcp 5061/tcp 5160/tcp 5161/tcp 4569/tcp 10000-20000/udp\n#  recordings data\nVOLUME [ \"/var/spool/asterisk/monitor\" ]\n#  database data\nVOLUME [ \"/var/lib/mysql\" ]\n#  automatic backup\nVOLUME [ \"/backup\" ]\n","originalDockerfileUglifiedHash":"be1647e162f1df68858c212ab2808ab8","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/79940b358615eedd0403f7a7f7b22ab1a1bb77dd.dockerfile"}