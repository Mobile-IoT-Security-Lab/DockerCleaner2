{"seed":2889583209,"processedDockerfileHash":"e9f3e0d302836749d46ed0f7c635f2a2","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["do-not-have-secrets"],"processedDockerfile":"#   ------------------------------------------------------------------------------\n#   Dockerfile to build basic Oracle database images\n#   Based on the following:\n#     - Oracle Linux 7 - Slim\n#     - Oracle Database\n#         http://www.oracle.com/technetwork/database/enterprise-edition/downloads/index.html\n#     - Oracle Application Express (APEX)\n#         http://www.oracle.com/technetwork/developer-tools/apex/downloads/index.html\n#\n#   Example build and run.\n#\n#   docker build -t ol7_121:latest .\n#   docker build --squash -t ol7_121:latest .\n#\n#   Non-persistent storage.\n#   docker run -dit --name ol7_121_con -p 1521:1521 -p 5500:5500 --shm-size=\"1G\" ol7_121:latest\n#\n#   Persistent storage.\n#   docker run -dit --name ol7_121_con -p 1521:1521 -p 5500:5500 --shm-size=\"1G\" -v /u01/volumes/ol7_121_con_u02/:/u02 ol7_121:latest\n#\n#   Persistent storage and part of Docker network called \"my_network\".\n#   docker run -dit --name ol7_121_con -p 1521:1521 -p 5500:5500 --shm-size=\"1G\" --network=my_network -v /u01/volumes/ol7_121_con_u02/:/u02 ol7_121:latest\n#\n#   docker logs --follow ol7_121_con\n#   docker exec -it ol7_121_con bash\n#\n#   docker stop --time=30 ol7_121_con\n#   docker start ol7_121_con\n#   \n#   docker rm -vf ol7_121_con \n#\n#   ------------------------------------------------------------------------------\n#   Set the base image to Oracle Linux 7 - Slim\nFROM oraclelinux:7-slim\n#   File Author / Maintainer\n#   Use LABEL rather than deprecated MAINTAINER\n#   MAINTAINER Tim Hall (tim@oracle-base.com)\nLABEL maintainer=\"tim@oracle-base.com\"\n#   ------------------------------------------------------------------------------\n#   Define fixed (build time) environment variables.\n# A secret has been removed here. Please do not provide secrets from the Dockerfile as these will leak into the metadata of the resulting docker image. To provide secrets the --secret flag of the docker build command can be used (https://docs.docker.com/develop/develop-images/build_enhancements/#new-docker-build-secret-information).\nENV ORACLE_BASE=\"/u01/app/oracle\" \\\n    ORACLE_HOME=\"/u01/app/oracle/product/12.1.0.2/db_1\" \\\n    ORA_INVENTORY=\"/u01/app/oraInventory\" \\\n    SOFTWARE_DIR=\"/u01/software\" \\\n    DB_SOFTWARE=\"linuxamd64_12102_database_*of2.zip\" \\\n    APEX_SOFTWARE=\"apex_19.1_en.zip\" \\\n    SCRIPTS_DIR=\"/u01/scripts\" \\\n    ORAENV_ASK=\"NO\"\n#   Separate ENV call to allow existing variables to be referenced.\nENV PATH=\"${ORACLE_HOME}/bin:${PATH}\"\n#   ------------------------------------------------------------------------------\n#   Define config (runtime) environment variables.\n# A secret has been removed here. Please do not provide secrets from the Dockerfile as these will leak into the metadata of the resulting docker image. To provide secrets the --secret flag of the docker build command can be used (https://docs.docker.com/develop/develop-images/build_enhancements/#new-docker-build-secret-information).\nENV ORACLE_SID=\"cdb1\" \\\n    PDB_NAME=\"pdb1\" \\\n    INSTALL_APEX=\"true\" \\\n    APEX_EMAIL=\"me@example.com\"\n#   ------------------------------------------------------------------------------\n#   Get all the files for the build.\nCOPY software/* ${SOFTWARE_DIR}/\nCOPY scripts/* ${SCRIPTS_DIR}/\n#   ------------------------------------------------------------------------------\n#   Unpack all the software and remove the media.\n#   No config done in the build phase.\n#   \n#   Manually create user and group as preinstall package creates the with\n#   high IDs, which causes issues. Note 2 on link below.\n#   https://docs.docker.com/engine/userguide/eng-image/dockerfile_best-practices/#user\n#\nRUN groupadd -g 500 dba \\\n && groupadd -g 501 oinstall \\\n && groupadd -g 1042 docker_fg \\\n && useradd -d /home/oracle -u 500 -g dba -G oinstall,dba,docker_fg -m -s /bin/bash oracle \\\n && yum -y install unzip tar gzip \\\n && yum -y update \\\n && yum -y install oracle-rdbms-server-12cR1-preinstall \\\n && rm -Rf /var/cache/yum \\\n && mkdir -p ${ORACLE_HOME} \\\n && mkdir -p /u02/oradata \\\n && chown -R oracle.oinstall /u01 \\\n && chmod u+x ${SCRIPTS_DIR}/*.sh \\\n && chown oracle:docker_fg /u02 \\\n && chmod 775 /u02 \\\n && chmod g+s /u02\n#   Perform the following actions as the oracle user\nUSER oracle\n#   Unzip software\nRUN cd ${SOFTWARE_DIR} \\\n && unzip -oq \"${DB_SOFTWARE}\" \\\n && rm -f ${DB_SOFTWARE}\n#   Do software-only installation\nRUN ${SOFTWARE_DIR}/database/runInstaller -ignoreSysPrereqs -ignorePrereq -waitforcompletion -showProgress -silent -responseFile $SOFTWARE_DIR/database/response/db_install.rsp oracle.install.option=INSTALL_DB_SWONLY ORACLE_HOSTNAME=${HOSTNAME} UNIX_GROUP_NAME=oinstall INVENTORY_LOCATION=${ORA_INVENTORY} SELECTED_LANGUAGES=en,en_GB ORACLE_HOME=${ORACLE_HOME} ORACLE_BASE=${ORACLE_BASE} oracle.install.db.InstallEdition=EE oracle.install.db.DBA_GROUP=dba oracle.install.db.BACKUPDBA_GROUP=dba oracle.install.db.DGDBA_GROUP=dba oracle.install.db.KMDBA_GROUP=dba SECURITY_UPDATES_VIA_MYORACLESUPPORT=false DECLINE_SECURITY_UPDATES=true\n#   Remove source software\nRUN rm -Rf ${SOFTWARE_DIR}/database\n#   Run the root scripts\nUSER root\nRUN sh ${ORA_INVENTORY}/orainstRoot.sh \\\n && sh ${ORACLE_HOME}/root.sh\n#   Perform the following actions as the oracle user\nUSER oracle\nVOLUME [\"/u02\"]\nEXPOSE 1521/tcp 5500/tcp\nHEALTHCHECK --interval=300s --start-period=600s CMD ${SCRIPTS_DIR}/healthcheck.sh > /dev/null || exit 1\n#   ------------------------------------------------------------------------------\n#   The start script performs all config based on runtime environment variables.\n#   First run creates the database.\nCMD exec ${SCRIPTS_DIR}/start.sh\n#   End\n","originalDockerfile":"#  ------------------------------------------------------------------------------\n#  Dockerfile to build basic Oracle database images\n#  Based on the following:\n#    - Oracle Linux 7 - Slim\n#    - Oracle Database\n#        http://www.oracle.com/technetwork/database/enterprise-edition/downloads/index.html\n#    - Oracle Application Express (APEX)\n#        http://www.oracle.com/technetwork/developer-tools/apex/downloads/index.html\n#\n#  Example build and run.\n#\n#  docker build -t ol7_121:latest .\n#  docker build --squash -t ol7_121:latest .\n#\n#  Non-persistent storage.\n#  docker run -dit --name ol7_121_con -p 1521:1521 -p 5500:5500 --shm-size=\"1G\" ol7_121:latest\n#\n#  Persistent storage.\n#  docker run -dit --name ol7_121_con -p 1521:1521 -p 5500:5500 --shm-size=\"1G\" -v /u01/volumes/ol7_121_con_u02/:/u02 ol7_121:latest\n#\n#  Persistent storage and part of Docker network called \"my_network\".\n#  docker run -dit --name ol7_121_con -p 1521:1521 -p 5500:5500 --shm-size=\"1G\" --network=my_network -v /u01/volumes/ol7_121_con_u02/:/u02 ol7_121:latest\n#\n#  docker logs --follow ol7_121_con\n#  docker exec -it ol7_121_con bash\n#\n#  docker stop --time=30 ol7_121_con\n#  docker start ol7_121_con\n#  \n#  docker rm -vf ol7_121_con \n#\n#  ------------------------------------------------------------------------------\n#  Set the base image to Oracle Linux 7 - Slim\nFROM oraclelinux:7-slim\n#  File Author / Maintainer\n#  Use LABEL rather than deprecated MAINTAINER\n#  MAINTAINER Tim Hall (tim@oracle-base.com)\nLABEL maintainer=\"tim@oracle-base.com\"\n#  ------------------------------------------------------------------------------\n#  Define fixed (build time) environment variables.\nENV ORACLE_BASE=\"/u01/app/oracle\" \\\n    ORACLE_HOME=\"/u01/app/oracle/product/12.1.0.2/db_1\" \\\n    ORA_INVENTORY=\"/u01/app/oraInventory\" \\\n    SOFTWARE_DIR=\"/u01/software\" \\\n    DB_SOFTWARE=\"linuxamd64_12102_database_*of2.zip\" \\\n    APEX_SOFTWARE=\"apex_19.1_en.zip\" \\\n    ORACLE_PASSWORD=\"oracle\" \\\n    SCRIPTS_DIR=\"/u01/scripts\" \\\n    ORAENV_ASK=\"NO\"\n#  Separate ENV call to allow existing variables to be referenced.\nENV PATH=\"${ORACLE_HOME}/bin:${PATH}\"\n#  ------------------------------------------------------------------------------\n#  Define config (runtime) environment variables.\nENV ORACLE_SID=\"cdb1\" \\\n    SYS_PASSWORD=\"SysPassword1\" \\\n    PDB_NAME=\"pdb1\" \\\n    INSTALL_APEX=\"true\" \\\n    PDB_PASSWORD=\"PdbPassword1\" \\\n    APEX_EMAIL=\"me@example.com\" \\\n    APEX_PASSWORD=\"ApexPassword1\"\n#  ------------------------------------------------------------------------------\n#  Get all the files for the build.\nCOPY software/* ${SOFTWARE_DIR}/\nCOPY scripts/* ${SCRIPTS_DIR}/\n#  ------------------------------------------------------------------------------\n#  Unpack all the software and remove the media.\n#  No config done in the build phase.\n#  \n#  Manually create user and group as preinstall package creates the with\n#  high IDs, which causes issues. Note 2 on link below.\n#  https://docs.docker.com/engine/userguide/eng-image/dockerfile_best-practices/#user\n#\nRUN groupadd -g 500 dba \\\n && groupadd -g 501 oinstall \\\n && groupadd -g 1042 docker_fg \\\n && useradd -d /home/oracle -u 500 -g dba -G oinstall,dba,docker_fg -m -s /bin/bash oracle \\\n && yum -y install unzip tar gzip \\\n && yum -y update \\\n && yum -y install oracle-rdbms-server-12cR1-preinstall \\\n && rm -Rf /var/cache/yum \\\n && mkdir -p ${ORACLE_HOME} \\\n && mkdir -p /u02/oradata \\\n && chown -R oracle.oinstall /u01 \\\n && chmod u+x ${SCRIPTS_DIR}/*.sh \\\n && chown oracle:docker_fg /u02 \\\n && chmod 775 /u02 \\\n && chmod g+s /u02\n#  Perform the following actions as the oracle user\nUSER oracle\n#  Unzip software\nRUN cd ${SOFTWARE_DIR} \\\n && unzip -oq \"${DB_SOFTWARE}\" \\\n && rm -f ${DB_SOFTWARE}\n#  Do software-only installation\nRUN ${SOFTWARE_DIR}/database/runInstaller -ignoreSysPrereqs -ignorePrereq -waitforcompletion -showProgress -silent -responseFile $SOFTWARE_DIR/database/response/db_install.rsp oracle.install.option=INSTALL_DB_SWONLY ORACLE_HOSTNAME=${HOSTNAME} UNIX_GROUP_NAME=oinstall INVENTORY_LOCATION=${ORA_INVENTORY} SELECTED_LANGUAGES=en,en_GB ORACLE_HOME=${ORACLE_HOME} ORACLE_BASE=${ORACLE_BASE} oracle.install.db.InstallEdition=EE oracle.install.db.DBA_GROUP=dba oracle.install.db.BACKUPDBA_GROUP=dba oracle.install.db.DGDBA_GROUP=dba oracle.install.db.KMDBA_GROUP=dba SECURITY_UPDATES_VIA_MYORACLESUPPORT=false DECLINE_SECURITY_UPDATES=true\n#  Remove source software\nRUN rm -Rf ${SOFTWARE_DIR}/database\n#  Run the root scripts\nUSER root\nRUN sh ${ORA_INVENTORY}/orainstRoot.sh \\\n && sh ${ORACLE_HOME}/root.sh\n#  Perform the following actions as the oracle user\nUSER oracle\nVOLUME [\"/u02\"]\nEXPOSE 1521/tcp 5500/tcp\nHEALTHCHECK --interval=300s --start-period=600s CMD ${SCRIPTS_DIR}/healthcheck.sh > /dev/null || exit 1\n#  ------------------------------------------------------------------------------\n#  The start script performs all config based on runtime environment variables.\n#  First run creates the database.\nCMD exec ${SCRIPTS_DIR}/start.sh\n#  End\n","injectedSmells":[],"originalDockerfileHash":"517c14b1b881c55f2f6b61e0ac3b8a69","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   ------------------------------------------------------------------------------\n#   Dockerfile to build basic Oracle database images\n#   Based on the following:\n#     - Oracle Linux 7 - Slim\n#     - Oracle Database\n#         http://www.oracle.com/technetwork/database/enterprise-edition/downloads/index.html\n#     - Oracle Application Express (APEX)\n#         http://www.oracle.com/technetwork/developer-tools/apex/downloads/index.html\n#\n#   Example build and run.\n#\n#   docker build -t ol7_121:latest .\n#   docker build --squash -t ol7_121:latest .\n#\n#   Non-persistent storage.\n#   docker run -dit --name ol7_121_con -p 1521:1521 -p 5500:5500 --shm-size=\"1G\" ol7_121:latest\n#\n#   Persistent storage.\n#   docker run -dit --name ol7_121_con -p 1521:1521 -p 5500:5500 --shm-size=\"1G\" -v /u01/volumes/ol7_121_con_u02/:/u02 ol7_121:latest\n#\n#   Persistent storage and part of Docker network called \"my_network\".\n#   docker run -dit --name ol7_121_con -p 1521:1521 -p 5500:5500 --shm-size=\"1G\" --network=my_network -v /u01/volumes/ol7_121_con_u02/:/u02 ol7_121:latest\n#\n#   docker logs --follow ol7_121_con\n#   docker exec -it ol7_121_con bash\n#\n#   docker stop --time=30 ol7_121_con\n#   docker start ol7_121_con\n#   \n#   docker rm -vf ol7_121_con \n#\n#   ------------------------------------------------------------------------------\n#   Set the base image to Oracle Linux 7 - Slim\nFROM oraclelinux:7-slim\n#   File Author / Maintainer\n#   Use LABEL rather than deprecated MAINTAINER\n#   MAINTAINER Tim Hall (tim@oracle-base.com)\nLABEL maintainer=\"tim@oracle-base.com\"\n#   ------------------------------------------------------------------------------\n#   Define fixed (build time) environment variables.\nENV ORACLE_BASE=\"/u01/app/oracle\" \\\n    ORACLE_HOME=\"/u01/app/oracle/product/12.1.0.2/db_1\" \\\n    ORA_INVENTORY=\"/u01/app/oraInventory\" \\\n    SOFTWARE_DIR=\"/u01/software\" \\\n    DB_SOFTWARE=\"linuxamd64_12102_database_*of2.zip\" \\\n    APEX_SOFTWARE=\"apex_19.1_en.zip\" \\\n    ORACLE_PASSWORD=\"oracle\" \\\n    SCRIPTS_DIR=\"/u01/scripts\" \\\n    ORAENV_ASK=\"NO\"\n#   Separate ENV call to allow existing variables to be referenced.\nENV PATH=\"${ORACLE_HOME}/bin:${PATH}\"\n#   ------------------------------------------------------------------------------\n#   Define config (runtime) environment variables.\nENV ORACLE_SID=\"cdb1\" \\\n    SYS_PASSWORD=\"SysPassword1\" \\\n    PDB_NAME=\"pdb1\" \\\n    INSTALL_APEX=\"true\" \\\n    PDB_PASSWORD=\"PdbPassword1\" \\\n    APEX_EMAIL=\"me@example.com\" \\\n    APEX_PASSWORD=\"ApexPassword1\"\n#   ------------------------------------------------------------------------------\n#   Get all the files for the build.\nCOPY software/* ${SOFTWARE_DIR}/\nCOPY scripts/* ${SCRIPTS_DIR}/\n#   ------------------------------------------------------------------------------\n#   Unpack all the software and remove the media.\n#   No config done in the build phase.\n#   \n#   Manually create user and group as preinstall package creates the with\n#   high IDs, which causes issues. Note 2 on link below.\n#   https://docs.docker.com/engine/userguide/eng-image/dockerfile_best-practices/#user\n#\nRUN groupadd -g 500 dba \\\n && groupadd -g 501 oinstall \\\n && groupadd -g 1042 docker_fg \\\n && useradd -d /home/oracle -u 500 -g dba -G oinstall,dba,docker_fg -m -s /bin/bash oracle \\\n && yum -y install unzip tar gzip \\\n && yum -y update \\\n && yum -y install oracle-rdbms-server-12cR1-preinstall \\\n && rm -Rf /var/cache/yum \\\n && mkdir -p ${ORACLE_HOME} \\\n && mkdir -p /u02/oradata \\\n && chown -R oracle.oinstall /u01 \\\n && chmod u+x ${SCRIPTS_DIR}/*.sh \\\n && chown oracle:docker_fg /u02 \\\n && chmod 775 /u02 \\\n && chmod g+s /u02\n#   Perform the following actions as the oracle user\nUSER oracle\n#   Unzip software\nRUN cd ${SOFTWARE_DIR} \\\n && unzip -oq \"${DB_SOFTWARE}\" \\\n && rm -f ${DB_SOFTWARE}\n#   Do software-only installation\nRUN ${SOFTWARE_DIR}/database/runInstaller -ignoreSysPrereqs -ignorePrereq -waitforcompletion -showProgress -silent -responseFile $SOFTWARE_DIR/database/response/db_install.rsp oracle.install.option=INSTALL_DB_SWONLY ORACLE_HOSTNAME=${HOSTNAME} UNIX_GROUP_NAME=oinstall INVENTORY_LOCATION=${ORA_INVENTORY} SELECTED_LANGUAGES=en,en_GB ORACLE_HOME=${ORACLE_HOME} ORACLE_BASE=${ORACLE_BASE} oracle.install.db.InstallEdition=EE oracle.install.db.DBA_GROUP=dba oracle.install.db.BACKUPDBA_GROUP=dba oracle.install.db.DGDBA_GROUP=dba oracle.install.db.KMDBA_GROUP=dba SECURITY_UPDATES_VIA_MYORACLESUPPORT=false DECLINE_SECURITY_UPDATES=true\n#   Remove source software\nRUN rm -Rf ${SOFTWARE_DIR}/database\n#   Run the root scripts\nUSER root\nRUN sh ${ORA_INVENTORY}/orainstRoot.sh \\\n && sh ${ORACLE_HOME}/root.sh\n#   Perform the following actions as the oracle user\nUSER oracle\nVOLUME [\"/u02\"]\nEXPOSE 1521/tcp 5500/tcp\nHEALTHCHECK --interval=300s --start-period=600s CMD ${SCRIPTS_DIR}/healthcheck.sh > /dev/null || exit 1\n#   ------------------------------------------------------------------------------\n#   The start script performs all config based on runtime environment variables.\n#   First run creates the database.\nCMD exec ${SCRIPTS_DIR}/start.sh\n#   End\n","originalDockerfileUglifiedHash":"fc07b4bc74de4176902f8ed52469ec3c","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/db8e0fee371906b2782bb2232b5dcfd58e864acc.dockerfile"}