{"seed":562842447,"processedDockerfileHash":"bb018bfa3356d24359028ea8cf0641e1","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","pin-package-manager-versions-apt-get","have-a-healthcheck","have-a-user"],"processedDockerfile":"#   Dockerfile to build a whole instance of rasa and run the rasa `pytest`\n#    (created to test the changes needed for docker automation)\n#\n#    (so far) only used manually, via:\n#           `docker build -f docker/Dockerfile_test .` (from project root)\n#           `docker run -it [id-output-from-above]`\nFROM python:3.6-slim\nENV RASA_NLU_DOCKER=\"YES\" \\\n    RASA_NLU_HOME=\"/app\" \\\n    RASA_NLU_PYTHON_PACKAGES=\"/usr/local/lib/python3.6/dist-packages\"\n#   Run updates, install basics and cleanup\n#   - build-essential: Compile specific dependencies\n#   - git-core: Checkout git repos\nRUN apt-get update -qq \\\n && apt-get install --no-install-recommends build-essential=12.9 git-core openssl=1.1.1n-0+deb11u4 libssl-dev=1.1.1n-0+deb11u4 libffi6 libffi-dev=3.3-6 curl=7.74.0-1.3+deb11u7 vim=2:8.2.2434-3+deb11u1 -y \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*\nRUN apt-get update -qq \\\n && apt-get install --no-install-recommends wget=1.21-1+deb11u1 -y\nRUN pip install https://github.com/explosion/spacy-models/releases/download/en_core_web_md-2.0.0/en_core_web_md-2.0.0.tar.gz --no-cache-dir > /dev/null \\\n && python -m spacy link en_core_web_md en \\\n && pip install https://github.com/explosion/spacy-models/releases/download/de_core_news_sm-2.0.0/de_core_news_sm-2.0.0.tar.gz --no-cache-dir > /dev/null \\\n && python -m spacy link de_core_news_sm de\nWORKDIR ${RASA_NLU_HOME}\n#   use bash always\nRUN rm /bin/sh \\\n && ln -s /bin/bash /bin/sh\n#  # install java stuff\nRUN echo \"deb http://http.debian.net/debian jessie-backports main\" > /etc/apt/sources.list.d/jessie-backports.list\nRUN apt-get update \\\n && apt-get install --no-install-recommends bzip2=1.0.8-4 unzip=6.0-26+deb11u1 xz-utils=5.2.5-2.1~deb11u1 -y \\\n && rm -rf /var/lib/apt/lists/*\n#   Default to UTF-8 file.encoding\nENV LANG=\"C.UTF-8\"\n#   add a simple script that can auto-detect the appropriate JAVA_HOME value\n#   based on whether the JDK or only the JRE is installed\nRUN { echo '#!/bin/sh' ;echo 'set -e' ;echo ;echo 'dirname \"$(dirname \"$(readlink -f \"$(which javac || which java)\")\")\"' ; } > /usr/local/bin/docker-java-home \\\n && chmod +x /usr/local/bin/docker-java-home\n#   do some fancy footwork to create a JAVA_HOME that's cross-architecture-safe\nRUN ln -svT \"/usr/lib/jvm/java-8-openjdk-$( dpkg --print-architecture ;)\" /docker-java-home\nENV JAVA_HOME=\"/docker-java-home\"\nENV JAVA_VERSION=\"8u141\"\nENV JAVA_DEBIAN_VERSION=\"8u141-b15-1~deb9u1\"\n#   see https://bugs.debian.org/775775\n#   and https://github.com/docker-library/java/issues/19#issuecomment-70546872\nENV CA_CERTIFICATES_JAVA_VERSION=\"20170531+nmu1\"\nRUN set -ex ; if [ ! -d /usr/share/man/man1 ] ; then mkdir -p /usr/share/man/man1 ; fi ; apt-get update ; apt-get install --no-install-recommends jessie-backports openjdk-8-jdk ca-certificates-java=20190909 -y -t ; rm -rf /var/lib/apt/lists/* ; [ \"$( readlink -f \"$JAVA_HOME\" ;)\" = \"$( docker-java-home ;)\" ] ; update-alternatives --get-selections | awk -v home=\"$( readlink -f \"$JAVA_HOME\" ;)\" 'index($3, home) == 1 { $2 = \"manual\"; print | \"update-alternatives --set-selections\" }' ; update-alternatives --query java | grep -q 'Status: manual'\n#   see CA_CERTIFICATES_JAVA_VERSION notes above\nRUN /var/lib/dpkg/info/ca-certificates-java.postinst configure\n#  # done java\nCOPY . ${RASA_NLU_HOME}\nRUN wget -P data/ https://s3-eu-west-1.amazonaws.com/mitie/total_word_feature_extractor.dat\nRUN pip install -r alt_requirements/requirements_dev.txt\nRUN pip install -e .\nRUN sed -i -e 's/backend : tkagg/backend : PDF/' /usr/local/lib/python3.6/site-packages/matplotlib/mpl-data/matplotlibrc\nVOLUME [\"/app/projects\", \"/app/logs\", \"/app/data\"]\nEXPOSE 5000/tcp\nENTRYPOINT [\"/usr/local/bin/py.test\"]\nCMD [\"_pytest\", \"--cov\", \"rasa_nlu\", \"--pep8\", \"-v\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  Dockerfile to build a whole instance of rasa and run the rasa `pytest`\n#   (created to test the changes needed for docker automation)\n#\n#   (so far) only used manually, via:\n#          `docker build -f docker/Dockerfile_test .` (from project root)\n#          `docker run -it [id-output-from-above]`\nFROM python:3.6-slim\nENV RASA_NLU_DOCKER=\"YES\" \\\n    RASA_NLU_HOME=\"/app\" \\\n    RASA_NLU_PYTHON_PACKAGES=\"/usr/local/lib/python3.6/dist-packages\"\n#  Run updates, install basics and cleanup\n#  - build-essential: Compile specific dependencies\n#  - git-core: Checkout git repos\nRUN apt-get update -qq \\\n && apt-get install --no-install-recommends build-essential git-core openssl libssl-dev libffi6 libffi-dev curl vim -y \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*\nRUN apt-get update -qq \\\n && apt-get install --no-install-recommends wget -y\nRUN pip install https://github.com/explosion/spacy-models/releases/download/en_core_web_md-2.0.0/en_core_web_md-2.0.0.tar.gz --no-cache-dir > /dev/null \\\n && python -m spacy link en_core_web_md en \\\n && pip install https://github.com/explosion/spacy-models/releases/download/de_core_news_sm-2.0.0/de_core_news_sm-2.0.0.tar.gz --no-cache-dir > /dev/null \\\n && python -m spacy link de_core_news_sm de\nWORKDIR ${RASA_NLU_HOME}\n#  use bash always\nRUN rm /bin/sh \\\n && ln -s /bin/bash /bin/sh\n# # install java stuff\nRUN echo \"deb http://http.debian.net/debian jessie-backports main\" > /etc/apt/sources.list.d/jessie-backports.list\nRUN apt-get update \\\n && apt-get install --no-install-recommends bzip2 unzip xz-utils -y \\\n && rm -rf /var/lib/apt/lists/*\n#  Default to UTF-8 file.encoding\nENV LANG=\"C.UTF-8\"\n#  add a simple script that can auto-detect the appropriate JAVA_HOME value\n#  based on whether the JDK or only the JRE is installed\nRUN { echo '#!/bin/sh' ;echo 'set -e' ;echo ;echo 'dirname \"$(dirname \"$(readlink -f \"$(which javac || which java)\")\")\"' ; } > /usr/local/bin/docker-java-home \\\n && chmod +x /usr/local/bin/docker-java-home\n#  do some fancy footwork to create a JAVA_HOME that's cross-architecture-safe\nRUN ln -svT \"/usr/lib/jvm/java-8-openjdk-$( dpkg --print-architecture ;)\" /docker-java-home\nENV JAVA_HOME=\"/docker-java-home\"\nENV JAVA_VERSION=\"8u141\"\nENV JAVA_DEBIAN_VERSION=\"8u141-b15-1~deb9u1\"\n#  see https://bugs.debian.org/775775\n#  and https://github.com/docker-library/java/issues/19#issuecomment-70546872\nENV CA_CERTIFICATES_JAVA_VERSION=\"20170531+nmu1\"\nRUN set -ex ; if [ ! -d /usr/share/man/man1 ] ; then mkdir -p /usr/share/man/man1 ; fi ; apt-get update ; apt-get install jessie-backports openjdk-8-jdk ca-certificates-java -y -t ; rm -rf /var/lib/apt/lists/* ; [ \"$( readlink -f \"$JAVA_HOME\" ;)\" = \"$( docker-java-home ;)\" ] ; update-alternatives --get-selections | awk -v home=\"$( readlink -f \"$JAVA_HOME\" ;)\" 'index($3, home) == 1 { $2 = \"manual\"; print | \"update-alternatives --set-selections\" }' ; update-alternatives --query java | grep -q 'Status: manual'\n#  see CA_CERTIFICATES_JAVA_VERSION notes above\nRUN /var/lib/dpkg/info/ca-certificates-java.postinst configure\n# # done java\nCOPY . ${RASA_NLU_HOME}\nRUN wget -P data/ https://s3-eu-west-1.amazonaws.com/mitie/total_word_feature_extractor.dat\nRUN pip install -r alt_requirements/requirements_dev.txt\nRUN pip install -e .\nRUN sed -i -e 's/backend : tkagg/backend : PDF/' /usr/local/lib/python3.6/site-packages/matplotlib/mpl-data/matplotlibrc\nVOLUME [\"/app/projects\", \"/app/logs\", \"/app/data\"]\nEXPOSE 5000/tcp\nENTRYPOINT [\"/usr/local/bin/py.test\"]\nCMD [\"_pytest\", \"--cov\", \"rasa_nlu\", \"--pep8\", \"-v\"]\n","injectedSmells":[],"originalDockerfileHash":"f1cac73559dbd708974b2878218c4b4f","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   Dockerfile to build a whole instance of rasa and run the rasa `pytest`\n#    (created to test the changes needed for docker automation)\n#\n#    (so far) only used manually, via:\n#           `docker build -f docker/Dockerfile_test .` (from project root)\n#           `docker run -it [id-output-from-above]`\nFROM python:3.6-slim\nENV RASA_NLU_DOCKER=\"YES\" \\\n    RASA_NLU_HOME=\"/app\" \\\n    RASA_NLU_PYTHON_PACKAGES=\"/usr/local/lib/python3.6/dist-packages\"\n#   Run updates, install basics and cleanup\n#   - build-essential: Compile specific dependencies\n#   - git-core: Checkout git repos\nRUN apt-get update -qq \\\n && apt-get install --no-install-recommends build-essential git-core openssl libssl-dev libffi6 libffi-dev curl vim -y \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*\nRUN apt-get update -qq \\\n && apt-get install --no-install-recommends wget -y\nRUN pip install https://github.com/explosion/spacy-models/releases/download/en_core_web_md-2.0.0/en_core_web_md-2.0.0.tar.gz --no-cache-dir > /dev/null \\\n && python -m spacy link en_core_web_md en \\\n && pip install https://github.com/explosion/spacy-models/releases/download/de_core_news_sm-2.0.0/de_core_news_sm-2.0.0.tar.gz --no-cache-dir > /dev/null \\\n && python -m spacy link de_core_news_sm de\nWORKDIR ${RASA_NLU_HOME}\n#   use bash always\nRUN rm /bin/sh \\\n && ln -s /bin/bash /bin/sh\n#  # install java stuff\nRUN echo \"deb http://http.debian.net/debian jessie-backports main\" > /etc/apt/sources.list.d/jessie-backports.list\nRUN apt-get update \\\n && apt-get install --no-install-recommends bzip2 unzip xz-utils -y \\\n && rm -rf /var/lib/apt/lists/*\n#   Default to UTF-8 file.encoding\nENV LANG=\"C.UTF-8\"\n#   add a simple script that can auto-detect the appropriate JAVA_HOME value\n#   based on whether the JDK or only the JRE is installed\nRUN { echo '#!/bin/sh' ;echo 'set -e' ;echo ;echo 'dirname \"$(dirname \"$(readlink -f \"$(which javac || which java)\")\")\"' ; } > /usr/local/bin/docker-java-home \\\n && chmod +x /usr/local/bin/docker-java-home\n#   do some fancy footwork to create a JAVA_HOME that's cross-architecture-safe\nRUN ln -svT \"/usr/lib/jvm/java-8-openjdk-$( dpkg --print-architecture ;)\" /docker-java-home\nENV JAVA_HOME=\"/docker-java-home\"\nENV JAVA_VERSION=\"8u141\"\nENV JAVA_DEBIAN_VERSION=\"8u141-b15-1~deb9u1\"\n#   see https://bugs.debian.org/775775\n#   and https://github.com/docker-library/java/issues/19#issuecomment-70546872\nENV CA_CERTIFICATES_JAVA_VERSION=\"20170531+nmu1\"\nRUN set -ex ; if [ ! -d /usr/share/man/man1 ] ; then mkdir -p /usr/share/man/man1 ; fi ; apt-get update ; apt-get install jessie-backports openjdk-8-jdk ca-certificates-java -y -t ; rm -rf /var/lib/apt/lists/* ; [ \"$( readlink -f \"$JAVA_HOME\" ;)\" = \"$( docker-java-home ;)\" ] ; update-alternatives --get-selections | awk -v home=\"$( readlink -f \"$JAVA_HOME\" ;)\" 'index($3, home) == 1 { $2 = \"manual\"; print | \"update-alternatives --set-selections\" }' ; update-alternatives --query java | grep -q 'Status: manual'\n#   see CA_CERTIFICATES_JAVA_VERSION notes above\nRUN /var/lib/dpkg/info/ca-certificates-java.postinst configure\n#  # done java\nCOPY . ${RASA_NLU_HOME}\nRUN wget -P data/ https://s3-eu-west-1.amazonaws.com/mitie/total_word_feature_extractor.dat\nRUN pip install -r alt_requirements/requirements_dev.txt\nRUN pip install -e .\nRUN sed -i -e 's/backend : tkagg/backend : PDF/' /usr/local/lib/python3.6/site-packages/matplotlib/mpl-data/matplotlibrc\nVOLUME [\"/app/projects\", \"/app/logs\", \"/app/data\"]\nEXPOSE 5000/tcp\nENTRYPOINT [\"/usr/local/bin/py.test\"]\nCMD [\"_pytest\", \"--cov\", \"rasa_nlu\", \"--pep8\", \"-v\"]\n","originalDockerfileUglifiedHash":"c207b325db5a11227d07f72776092099","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/200fcca4f68474534d4cd33bc15e809ccecc4417.dockerfile"}