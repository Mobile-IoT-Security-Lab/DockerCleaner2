{"seed":2490515724,"processedDockerfileHash":"cf96ee4c843dda52055112bbd11fb62c","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","have-a-healthcheck","have-a-user"],"processedDockerfile":"#   Copyright (c) 2018-2019, NVIDIA CORPORATION. All rights reserved.\n#\n#   Redistribution and use in source and binary forms, with or without\n#   modification, are permitted provided that the following conditions\n#   are met:\n#    * Redistributions of source code must retain the above copyright\n#      notice, this list of conditions and the following disclaimer.\n#    * Redistributions in binary form must reproduce the above copyright\n#      notice, this list of conditions and the following disclaimer in the\n#      documentation and/or other materials provided with the distribution.\n#    * Neither the name of NVIDIA CORPORATION nor the names of its\n#      contributors may be used to endorse or promote products derived\n#      from this software without specific prior written permission.\n#\n#   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY\n#   EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n#   IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR\n#   PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR\n#   CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,\n#   EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,\n#   PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n#   PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY\n#   OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n#   (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n#   OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n#\n#   Multistage build.\n#\nARG BASE_IMAGE=tensorrtserver\nARG BUILD_IMAGE=tensorrtserver_build\nARG CBE_IMAGE=tensorrtserver_cbe\nARG CLIENT_IMAGE=tensorrtserver_client\n#  ###########################################################################\n#  # Build test utilities and custom backends in the BUILD_IMAGE since\n#  # it has already been configured correctly and has some existing\n#  # build artifacts. Copy artifacts into QA area.\n#  ###########################################################################\nFROM ${BUILD_IMAGE} AS build\n#   image_preprocess custom backend requires opencv\nRUN apt-get update \\\n && apt-get install --no-install-recommends libopencv-dev=4.6.0+dfsg-11 libopencv-core-dev=4.6.0+dfsg-11 -y\nWORKDIR /workspace\nRUN cd builddir \\\n && (make -j16 trtis-test-utils trtis-custom-backends || true ) \\\n && make -j16 trtis-test-utils trtis-custom-backends\n#   Update the qa/ directory with test executables, models, etc.\nWORKDIR /workspace\nRUN mkdir -p qa/common \\\n && mkdir qa/L0_simple_example/models \\\n && cp -r docs/examples/model_repository/simple qa/L0_simple_example/models/. \\\n && mkdir qa/L0_simple_callback_example/models \\\n && cp -r docs/examples/model_repository/simple qa/L0_simple_callback_example/models/. \\\n && mkdir qa/L0_simple_string_example/models \\\n && cp -r docs/examples/model_repository/simple_string qa/L0_simple_string_example/models/. \\\n && mkdir qa/L0_simple_lib/models \\\n && cp /opt/tensorrtserver/bin/simple qa/L0_simple_lib/. \\\n && cp -r docs/examples/model_repository/simple qa/L0_simple_lib/models/.\nRUN cp /workspace/builddir/trtis-test-utils/install/bin/caffe2plan qa/common/.\nRUN mkdir -p qa/custom_models/custom_int32_int32_int32/1 \\\n && cp builddir/trtis-custom-backends/install/lib/libaddsub.so qa/custom_models/custom_int32_int32_int32/1/. \\\n && mkdir -p qa/custom_models/custom_nobatch_int32_int32_int32/1 \\\n && cp builddir/trtis-custom-backends/install/lib/libaddsub.so qa/custom_models/custom_nobatch_int32_int32_int32/1/. \\\n && mkdir -p qa/custom_models/custom_float32_float32_float32/1 \\\n && cp builddir/trtis-custom-backends/install/lib/libaddsub.so qa/custom_models/custom_float32_float32_float32/1/. \\\n && mkdir -p qa/custom_models/custom_nobatch_float32_float32_float32/1 \\\n && cp builddir/trtis-custom-backends/install/lib/libaddsub.so qa/custom_models/custom_nobatch_float32_float32_float32/1/. \\\n && mkdir -p qa/L0_simple_custom_example/models/simple/1 \\\n && cp builddir/trtis-custom-backends/install/lib/libaddsub.so qa/L0_simple_custom_example/models/simple/1/. \\\n && mkdir -p qa/L0_simple_ensemble/models/simple/1 \\\n && cp builddir/trtis-custom-backends/install/lib/libaddsub.so qa/L0_simple_ensemble/models/simple/1/. \\\n && mkdir -p qa/L0_multiple_ports/models/simple/1 \\\n && cp builddir/trtis-custom-backends/install/lib/libaddsub.so qa/L0_multiple_ports/models/simple/1/.\nRUN mkdir -p qa/L0_custom_image_preprocess/models/image_preprocess_nhwc_224x224x3/1 \\\n && cp builddir/trtis-custom-backends/install/lib/libimagepreprocess.so qa/L0_custom_image_preprocess/models/image_preprocess_nhwc_224x224x3/1/.\nRUN mkdir -p qa/L0_custom_param/models/param/1 \\\n && cp builddir/trtis-custom-backends/install/lib/libparam.so qa/L0_custom_param/models/param/1/.\nRUN mkdir -p qa/L0_simple_sequence_example/models/simple_sequence/1 \\\n && cp builddir/trtis-custom-backends/install/lib/libsequence.so qa/L0_simple_sequence_example/models/simple_sequence/1/. \\\n && mkdir -p qa/custom_models/custom_sequence_int32/1 \\\n && cp builddir/trtis-custom-backends/install/lib/libsequence.so qa/custom_models/custom_sequence_int32/1/.\nRUN cp builddir/trtis-custom-backends/install/lib/libidentity.so qa/L0_infer/. \\\n && cp builddir/trtis-custom-backends/install/lib/libidentity.so qa/L0_infer_variable/. \\\n && cp builddir/trtis-custom-backends/install/lib/libidentity.so qa/L0_infer_reshape/. \\\n && cp builddir/trtis-custom-backends/install/lib/libidentity.so qa/L0_infer_zero/. \\\n && cp builddir/trtis-custom-backends/install/lib/libidentity.so qa/L0_sequence_batcher/. \\\n && cp builddir/trtis-custom-backends/install/lib/libidentity.so qa/L0_savedmodel_shape/. \\\n && cp builddir/trtis-custom-backends/install/lib/libidentity.so qa/L0_perflab_nomodel/.\n#   Generating the docs requires the docs source and the source code so\n#   copy that into L0_docs so that it is available when that test runs.\nRUN cp VERSION qa/L0_docs/. \\\n && cp README.rst qa/L0_docs/. \\\n && cp -r docs qa/L0_docs/. \\\n && cp -r src qa/L0_docs/.\n#  ###########################################################################\n#  # Copy artifacts from client container\n#  ###########################################################################\nFROM ${CLIENT_IMAGE} AS client\nWORKDIR /workspace\nCOPY --from=build /workspace/qa/ qa/\nRUN mkdir -p qa/clients \\\n && mkdir -p qa/pkgs \\\n && cp install/bin/* qa/clients/. \\\n && cp install/lib/librequest.so qa/clients/. \\\n && cp install/python/*.py qa/clients/. \\\n && cp install/python/tensorrtserver*.whl qa/pkgs/.\n#  ###########################################################################\n#  # Copy artifacts from custom backend container\n#  ###########################################################################\nFROM ${CBE_IMAGE} AS cbe\nWORKDIR /workspace\nCOPY --from=client /workspace/qa/ qa/\nRUN (cd qa/L0_custom_backend \\\n && tar xzf /workspace/*.custombackend.tar.gz )\n#  ###########################################################################\n#  # Create CI enabled image\n#  ###########################################################################\nFROM $BASE_IMAGE\nRUN apt-get update \\\n && apt-get install --no-install-recommends jmeter=2.13-5 jmeter-http=2.13-5 libcurl3 libopencv-dev=4.6.0+dfsg-11 libopencv-core-dev=4.6.0+dfsg-11 libpng12-dev libzmq3-dev=4.3.4-6 python python-protobuf swig=4.1.0-0.2 -y \\\n && rm -rf /var/lib/apt/lists/*\nRUN curl -O https://bootstrap.pypa.io/get-pip.py \\\n && python get-pip.py \\\n && rm get-pip.py\nRUN pip install numpy==1.24.2 pillow==9.5.0 future==0.18.3 grpcio==1.53.0 requests==2.28.2 gsutil==5.23 --upgrade\n#   CI expects tests in /opt/tensorrtserver/qa\nWORKDIR /opt/tensorrtserver\nCOPY --from=cbe /workspace/qa/ qa/\n#   Remove CI tests that are meant to run only on build image and\n#   install the tensorrtserver python client APIs.\nRUN rm -fr qa/L0_copyrights qa/L0_unit_test \\\n && pip install qa/pkgs/tensorrtserver-*.whl --upgrade\nENV LD_LIBRARY_PATH=\"/opt/tensorrtserver/qa/clients:${LD_LIBRARY_PATH}\"\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  Copyright (c) 2018-2019, NVIDIA CORPORATION. All rights reserved.\n#\n#  Redistribution and use in source and binary forms, with or without\n#  modification, are permitted provided that the following conditions\n#  are met:\n#   * Redistributions of source code must retain the above copyright\n#     notice, this list of conditions and the following disclaimer.\n#   * Redistributions in binary form must reproduce the above copyright\n#     notice, this list of conditions and the following disclaimer in the\n#     documentation and/or other materials provided with the distribution.\n#   * Neither the name of NVIDIA CORPORATION nor the names of its\n#     contributors may be used to endorse or promote products derived\n#     from this software without specific prior written permission.\n#\n#  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY\n#  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n#  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR\n#  PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR\n#  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,\n#  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,\n#  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n#  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY\n#  OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n#  (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n#  OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n#\n#  Multistage build.\n#\nARG BASE_IMAGE=tensorrtserver\nARG BUILD_IMAGE=tensorrtserver_build\nARG CBE_IMAGE=tensorrtserver_cbe\nARG CLIENT_IMAGE=tensorrtserver_client\n# ###########################################################################\n# # Build test utilities and custom backends in the BUILD_IMAGE since\n# # it has already been configured correctly and has some existing\n# # build artifacts. Copy artifacts into QA area.\n# ###########################################################################\nFROM ${BUILD_IMAGE} AS build\n#  image_preprocess custom backend requires opencv\nRUN apt-get update \\\n && apt-get install --no-install-recommends libopencv-dev libopencv-core-dev -y\nWORKDIR /workspace\nRUN cd builddir \\\n && (make -j16 trtis-test-utils trtis-custom-backends || true ) \\\n && make -j16 trtis-test-utils trtis-custom-backends\n#  Update the qa/ directory with test executables, models, etc.\nWORKDIR /workspace\nRUN mkdir -p qa/common \\\n && mkdir qa/L0_simple_example/models \\\n && cp -r docs/examples/model_repository/simple qa/L0_simple_example/models/. \\\n && mkdir qa/L0_simple_callback_example/models \\\n && cp -r docs/examples/model_repository/simple qa/L0_simple_callback_example/models/. \\\n && mkdir qa/L0_simple_string_example/models \\\n && cp -r docs/examples/model_repository/simple_string qa/L0_simple_string_example/models/. \\\n && mkdir qa/L0_simple_lib/models \\\n && cp /opt/tensorrtserver/bin/simple qa/L0_simple_lib/. \\\n && cp -r docs/examples/model_repository/simple qa/L0_simple_lib/models/.\nRUN cp /workspace/builddir/trtis-test-utils/install/bin/caffe2plan qa/common/.\nRUN mkdir -p qa/custom_models/custom_int32_int32_int32/1 \\\n && cp builddir/trtis-custom-backends/install/lib/libaddsub.so qa/custom_models/custom_int32_int32_int32/1/. \\\n && mkdir -p qa/custom_models/custom_nobatch_int32_int32_int32/1 \\\n && cp builddir/trtis-custom-backends/install/lib/libaddsub.so qa/custom_models/custom_nobatch_int32_int32_int32/1/. \\\n && mkdir -p qa/custom_models/custom_float32_float32_float32/1 \\\n && cp builddir/trtis-custom-backends/install/lib/libaddsub.so qa/custom_models/custom_float32_float32_float32/1/. \\\n && mkdir -p qa/custom_models/custom_nobatch_float32_float32_float32/1 \\\n && cp builddir/trtis-custom-backends/install/lib/libaddsub.so qa/custom_models/custom_nobatch_float32_float32_float32/1/. \\\n && mkdir -p qa/L0_simple_custom_example/models/simple/1 \\\n && cp builddir/trtis-custom-backends/install/lib/libaddsub.so qa/L0_simple_custom_example/models/simple/1/. \\\n && mkdir -p qa/L0_simple_ensemble/models/simple/1 \\\n && cp builddir/trtis-custom-backends/install/lib/libaddsub.so qa/L0_simple_ensemble/models/simple/1/. \\\n && mkdir -p qa/L0_multiple_ports/models/simple/1 \\\n && cp builddir/trtis-custom-backends/install/lib/libaddsub.so qa/L0_multiple_ports/models/simple/1/.\nRUN mkdir -p qa/L0_custom_image_preprocess/models/image_preprocess_nhwc_224x224x3/1 \\\n && cp builddir/trtis-custom-backends/install/lib/libimagepreprocess.so qa/L0_custom_image_preprocess/models/image_preprocess_nhwc_224x224x3/1/.\nRUN mkdir -p qa/L0_custom_param/models/param/1 \\\n && cp builddir/trtis-custom-backends/install/lib/libparam.so qa/L0_custom_param/models/param/1/.\nRUN mkdir -p qa/L0_simple_sequence_example/models/simple_sequence/1 \\\n && cp builddir/trtis-custom-backends/install/lib/libsequence.so qa/L0_simple_sequence_example/models/simple_sequence/1/. \\\n && mkdir -p qa/custom_models/custom_sequence_int32/1 \\\n && cp builddir/trtis-custom-backends/install/lib/libsequence.so qa/custom_models/custom_sequence_int32/1/.\nRUN cp builddir/trtis-custom-backends/install/lib/libidentity.so qa/L0_infer/. \\\n && cp builddir/trtis-custom-backends/install/lib/libidentity.so qa/L0_infer_variable/. \\\n && cp builddir/trtis-custom-backends/install/lib/libidentity.so qa/L0_infer_reshape/. \\\n && cp builddir/trtis-custom-backends/install/lib/libidentity.so qa/L0_infer_zero/. \\\n && cp builddir/trtis-custom-backends/install/lib/libidentity.so qa/L0_sequence_batcher/. \\\n && cp builddir/trtis-custom-backends/install/lib/libidentity.so qa/L0_savedmodel_shape/. \\\n && cp builddir/trtis-custom-backends/install/lib/libidentity.so qa/L0_perflab_nomodel/.\n#  Generating the docs requires the docs source and the source code so\n#  copy that into L0_docs so that it is available when that test runs.\nRUN cp VERSION qa/L0_docs/. \\\n && cp README.rst qa/L0_docs/. \\\n && cp -r docs qa/L0_docs/. \\\n && cp -r src qa/L0_docs/.\n# ###########################################################################\n# # Copy artifacts from client container\n# ###########################################################################\nFROM ${CLIENT_IMAGE} AS client\nWORKDIR /workspace\nCOPY --from=build /workspace/qa/ qa/\nRUN mkdir -p qa/clients \\\n && mkdir -p qa/pkgs \\\n && cp install/bin/* qa/clients/. \\\n && cp install/lib/librequest.so qa/clients/. \\\n && cp install/python/*.py qa/clients/. \\\n && cp install/python/tensorrtserver*.whl qa/pkgs/.\n# ###########################################################################\n# # Copy artifacts from custom backend container\n# ###########################################################################\nFROM ${CBE_IMAGE} AS cbe\nWORKDIR /workspace\nCOPY --from=client /workspace/qa/ qa/\nRUN (cd qa/L0_custom_backend \\\n && tar xzf /workspace/*.custombackend.tar.gz )\n# ###########################################################################\n# # Create CI enabled image\n# ###########################################################################\nFROM $BASE_IMAGE\nRUN apt-get update \\\n && apt-get install --no-install-recommends jmeter jmeter-http libcurl3 libopencv-dev libopencv-core-dev libpng12-dev libzmq3-dev python python-protobuf swig -y \\\n && rm -rf /var/lib/apt/lists/*\nRUN curl -O https://bootstrap.pypa.io/get-pip.py \\\n && python get-pip.py \\\n && rm get-pip.py\nRUN pip install numpy pillow future grpcio requests gsutil --upgrade\n#  CI expects tests in /opt/tensorrtserver/qa\nWORKDIR /opt/tensorrtserver\nCOPY --from=cbe /workspace/qa/ qa/\n#  Remove CI tests that are meant to run only on build image and\n#  install the tensorrtserver python client APIs.\nRUN rm -fr qa/L0_copyrights qa/L0_unit_test \\\n && pip install qa/pkgs/tensorrtserver-*.whl --upgrade\nENV LD_LIBRARY_PATH=\"/opt/tensorrtserver/qa/clients:${LD_LIBRARY_PATH}\"\n","injectedSmells":[],"originalDockerfileHash":"fbe256161e010821333e4d0a9472410c","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   Copyright (c) 2018-2019, NVIDIA CORPORATION. All rights reserved.\n#\n#   Redistribution and use in source and binary forms, with or without\n#   modification, are permitted provided that the following conditions\n#   are met:\n#    * Redistributions of source code must retain the above copyright\n#      notice, this list of conditions and the following disclaimer.\n#    * Redistributions in binary form must reproduce the above copyright\n#      notice, this list of conditions and the following disclaimer in the\n#      documentation and/or other materials provided with the distribution.\n#    * Neither the name of NVIDIA CORPORATION nor the names of its\n#      contributors may be used to endorse or promote products derived\n#      from this software without specific prior written permission.\n#\n#   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY\n#   EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n#   IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR\n#   PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR\n#   CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,\n#   EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,\n#   PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n#   PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY\n#   OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n#   (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n#   OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n#\n#   Multistage build.\n#\nARG BASE_IMAGE=tensorrtserver\nARG BUILD_IMAGE=tensorrtserver_build\nARG CBE_IMAGE=tensorrtserver_cbe\nARG CLIENT_IMAGE=tensorrtserver_client\n#  ###########################################################################\n#  # Build test utilities and custom backends in the BUILD_IMAGE since\n#  # it has already been configured correctly and has some existing\n#  # build artifacts. Copy artifacts into QA area.\n#  ###########################################################################\nFROM ${BUILD_IMAGE} AS build\n#   image_preprocess custom backend requires opencv\nRUN apt-get update \\\n && apt-get install --no-install-recommends libopencv-dev libopencv-core-dev -y\nWORKDIR /workspace\nRUN cd builddir \\\n && (make -j16 trtis-test-utils trtis-custom-backends || true ) \\\n && make -j16 trtis-test-utils trtis-custom-backends\n#   Update the qa/ directory with test executables, models, etc.\nWORKDIR /workspace\nRUN mkdir -p qa/common \\\n && mkdir qa/L0_simple_example/models \\\n && cp -r docs/examples/model_repository/simple qa/L0_simple_example/models/. \\\n && mkdir qa/L0_simple_callback_example/models \\\n && cp -r docs/examples/model_repository/simple qa/L0_simple_callback_example/models/. \\\n && mkdir qa/L0_simple_string_example/models \\\n && cp -r docs/examples/model_repository/simple_string qa/L0_simple_string_example/models/. \\\n && mkdir qa/L0_simple_lib/models \\\n && cp /opt/tensorrtserver/bin/simple qa/L0_simple_lib/. \\\n && cp -r docs/examples/model_repository/simple qa/L0_simple_lib/models/.\nRUN cp /workspace/builddir/trtis-test-utils/install/bin/caffe2plan qa/common/.\nRUN mkdir -p qa/custom_models/custom_int32_int32_int32/1 \\\n && cp builddir/trtis-custom-backends/install/lib/libaddsub.so qa/custom_models/custom_int32_int32_int32/1/. \\\n && mkdir -p qa/custom_models/custom_nobatch_int32_int32_int32/1 \\\n && cp builddir/trtis-custom-backends/install/lib/libaddsub.so qa/custom_models/custom_nobatch_int32_int32_int32/1/. \\\n && mkdir -p qa/custom_models/custom_float32_float32_float32/1 \\\n && cp builddir/trtis-custom-backends/install/lib/libaddsub.so qa/custom_models/custom_float32_float32_float32/1/. \\\n && mkdir -p qa/custom_models/custom_nobatch_float32_float32_float32/1 \\\n && cp builddir/trtis-custom-backends/install/lib/libaddsub.so qa/custom_models/custom_nobatch_float32_float32_float32/1/. \\\n && mkdir -p qa/L0_simple_custom_example/models/simple/1 \\\n && cp builddir/trtis-custom-backends/install/lib/libaddsub.so qa/L0_simple_custom_example/models/simple/1/. \\\n && mkdir -p qa/L0_simple_ensemble/models/simple/1 \\\n && cp builddir/trtis-custom-backends/install/lib/libaddsub.so qa/L0_simple_ensemble/models/simple/1/. \\\n && mkdir -p qa/L0_multiple_ports/models/simple/1 \\\n && cp builddir/trtis-custom-backends/install/lib/libaddsub.so qa/L0_multiple_ports/models/simple/1/.\nRUN mkdir -p qa/L0_custom_image_preprocess/models/image_preprocess_nhwc_224x224x3/1 \\\n && cp builddir/trtis-custom-backends/install/lib/libimagepreprocess.so qa/L0_custom_image_preprocess/models/image_preprocess_nhwc_224x224x3/1/.\nRUN mkdir -p qa/L0_custom_param/models/param/1 \\\n && cp builddir/trtis-custom-backends/install/lib/libparam.so qa/L0_custom_param/models/param/1/.\nRUN mkdir -p qa/L0_simple_sequence_example/models/simple_sequence/1 \\\n && cp builddir/trtis-custom-backends/install/lib/libsequence.so qa/L0_simple_sequence_example/models/simple_sequence/1/. \\\n && mkdir -p qa/custom_models/custom_sequence_int32/1 \\\n && cp builddir/trtis-custom-backends/install/lib/libsequence.so qa/custom_models/custom_sequence_int32/1/.\nRUN cp builddir/trtis-custom-backends/install/lib/libidentity.so qa/L0_infer/. \\\n && cp builddir/trtis-custom-backends/install/lib/libidentity.so qa/L0_infer_variable/. \\\n && cp builddir/trtis-custom-backends/install/lib/libidentity.so qa/L0_infer_reshape/. \\\n && cp builddir/trtis-custom-backends/install/lib/libidentity.so qa/L0_infer_zero/. \\\n && cp builddir/trtis-custom-backends/install/lib/libidentity.so qa/L0_sequence_batcher/. \\\n && cp builddir/trtis-custom-backends/install/lib/libidentity.so qa/L0_savedmodel_shape/. \\\n && cp builddir/trtis-custom-backends/install/lib/libidentity.so qa/L0_perflab_nomodel/.\n#   Generating the docs requires the docs source and the source code so\n#   copy that into L0_docs so that it is available when that test runs.\nRUN cp VERSION qa/L0_docs/. \\\n && cp README.rst qa/L0_docs/. \\\n && cp -r docs qa/L0_docs/. \\\n && cp -r src qa/L0_docs/.\n#  ###########################################################################\n#  # Copy artifacts from client container\n#  ###########################################################################\nFROM ${CLIENT_IMAGE} AS client\nWORKDIR /workspace\nCOPY --from=build /workspace/qa/ qa/\nRUN mkdir -p qa/clients \\\n && mkdir -p qa/pkgs \\\n && cp install/bin/* qa/clients/. \\\n && cp install/lib/librequest.so qa/clients/. \\\n && cp install/python/*.py qa/clients/. \\\n && cp install/python/tensorrtserver*.whl qa/pkgs/.\n#  ###########################################################################\n#  # Copy artifacts from custom backend container\n#  ###########################################################################\nFROM ${CBE_IMAGE} AS cbe\nWORKDIR /workspace\nCOPY --from=client /workspace/qa/ qa/\nRUN (cd qa/L0_custom_backend \\\n && tar xzf /workspace/*.custombackend.tar.gz )\n#  ###########################################################################\n#  # Create CI enabled image\n#  ###########################################################################\nFROM $BASE_IMAGE\nRUN apt-get update \\\n && apt-get install --no-install-recommends jmeter jmeter-http libcurl3 libopencv-dev libopencv-core-dev libpng12-dev libzmq3-dev python python-protobuf swig -y \\\n && rm -rf /var/lib/apt/lists/*\nRUN curl -O https://bootstrap.pypa.io/get-pip.py \\\n && python get-pip.py \\\n && rm get-pip.py\nRUN pip install numpy pillow future grpcio requests gsutil --upgrade\n#   CI expects tests in /opt/tensorrtserver/qa\nWORKDIR /opt/tensorrtserver\nCOPY --from=cbe /workspace/qa/ qa/\n#   Remove CI tests that are meant to run only on build image and\n#   install the tensorrtserver python client APIs.\nRUN rm -fr qa/L0_copyrights qa/L0_unit_test \\\n && pip install qa/pkgs/tensorrtserver-*.whl --upgrade\nENV LD_LIBRARY_PATH=\"/opt/tensorrtserver/qa/clients:${LD_LIBRARY_PATH}\"\n","originalDockerfileUglifiedHash":"669b327197bccf0f8d92bfc8fd0f0873","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/1bb5c3a3d0a75b293b2638b19ca67c7c1d20095d.dockerfile"}