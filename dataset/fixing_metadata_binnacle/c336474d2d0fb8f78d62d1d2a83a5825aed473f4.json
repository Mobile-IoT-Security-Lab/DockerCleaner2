{"seed":3318795697,"processedDockerfileHash":"aacb5dfe43db671fb51ac3685eb02465","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","have-a-healthcheck","have-a-user"],"processedDockerfile":"#\n#   MockServer Nginx Dockerfile\n#\n#   https://github.com/jamesdbloom/mockserver\n#   http://www.mock-server.com\n#\n#   pull base image\nFROM mockserver/base\n#   maintainer details\nMAINTAINER James Bloom \"jamesdbloom@gmail.com\"\n#  ################\n#   INSTALL NGINX #\n#  ################\n#   add nginx repository\nRUN add-apt-repository -y ppa:nginx/stable\n#   update local package index\nRUN :\n#   install nginx\nRUN (apt-get update ;apt-get install --no-install-recommends nginx=1.22.0-1ubuntu3 -y )\nRUN echo \"\\ndaemon off;\" >> /etc/nginx/nginx.conf\n#  #############################\n#   CONFIGURE NGINX TO JENKINS #\n#  #############################\n#   change to nginx configuration folder\nWORKDIR /etc/nginx/sites-available\n#   remove default nginx configuration\nRUN rm -rf default ../sites-enabled/default\n#   create new configuration for jenkins (add to tmp folder so that the correct values for jenkins port and ip can be inserted at runtime)\nRUN mkdir -p /etc/nginx/tmp \\\n && echo 'upstream app_server {' > /etc/nginx/tmp/jenkins \\\n && echo \" server CI_PORT_8080_TCP_ADDR:CI_PORT_8080_TCP_PORT fail_timeout=0;\" >> /etc/nginx/tmp/jenkins \\\n && echo '}' >> /etc/nginx/tmp/jenkins \\\n && echo ' ' >> /etc/nginx/tmp/jenkins \\\n && echo 'server {' >> /etc/nginx/tmp/jenkins \\\n && echo ' listen 80;' >> /etc/nginx/tmp/jenkins \\\n && echo ' listen [::]:80 default ipv6only=on;' >> /etc/nginx/tmp/jenkins \\\n && echo ' server_name ci.jamesdbloom.com;' >> /etc/nginx/tmp/jenkins \\\n && echo ' ' >> /etc/nginx/tmp/jenkins \\\n && echo ' location / {' >> /etc/nginx/tmp/jenkins \\\n && echo ' proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;' >> /etc/nginx/tmp/jenkins \\\n && echo ' proxy_set_header Host $http_host;' >> /etc/nginx/tmp/jenkins \\\n && echo ' proxy_redirect off;' >> /etc/nginx/tmp/jenkins \\\n && echo ' ' >> /etc/nginx/tmp/jenkins \\\n && echo ' if (!-f $request_filename) {' >> /etc/nginx/tmp/jenkins \\\n && echo ' proxy_pass http://app_server;' >> /etc/nginx/tmp/jenkins \\\n && echo ' break;' >> /etc/nginx/tmp/jenkins \\\n && echo ' }' >> /etc/nginx/tmp/jenkins \\\n && echo ' }' >> /etc/nginx/tmp/jenkins \\\n && echo '}' >> /etc/nginx/tmp/jenkins\n#   link new configuration\nRUN ln -s /etc/nginx/sites-available/jenkins /etc/nginx/sites-enabled/\n#   to build container run:\n#   docker build -t=\"mockserver/nginx\" https://raw.github.com/jamesdbloom/mockserver/master/ci/docker/nginx/Dockerfile\n#  #######################\n#   CONFIGURE SUPERVISOR #\n#  #######################\n#   add to supervisor\nRUN echo '[program:nginx]' > /etc/supervisor/conf.d/nginx \\\n && echo 'command=service nginx restart' >> /etc/supervisor/conf.d/nginx \\\n && echo 'redirect_stderr=true' >> /etc/supervisor/conf.d/nginx\n#   start supervisor daemon\nCMD sed \"s/CI_PORT_8080_TCP_ADDR/$CI_PORT_8080_TCP_ADDR/g\" /etc/nginx/tmp/jenkins | sed \"s/CI_PORT_8080_TCP_PORT/$CI_PORT_8080_TCP_PORT/g\" > /etc/nginx/sites-available/jenkins \\\n && supervisord -c /etc/supervisor/supervisor.conf\n#  ###############\n#   EXPORT PORTS #\n#  ###############\nEXPOSE 80/tcp\n#  ##############\n#   TO BUILD... #\n#  ##############\n#   to build container:\n#   docker build -t=\"mockserver/nginx\" https://raw.github.com/jamesdbloom/mockserver/master/ci/docker/nginx/Dockerfile\n#   to run container:\n#   docker run -name nginx -link jenkins:ci -p 80:80 -d mockserver/nginx\n#  ###########\n#   NOTES... #\n#  ###########\n#   The following files locations are used\n#   service: /etc/init.d/nginx\n#   config: /etc/nginx/nginx.conf\n#   access_logs: /var/log/nginx/access.log\n#   error_logs: /var/log/nginx/error.log\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#\n#  MockServer Nginx Dockerfile\n#\n#  https://github.com/jamesdbloom/mockserver\n#  http://www.mock-server.com\n#\n#  pull base image\nFROM mockserver/base\n#  maintainer details\nMAINTAINER James Bloom \"jamesdbloom@gmail.com\"\n# ################\n#  INSTALL NGINX #\n# ################\n#  add nginx repository\nRUN add-apt-repository -y ppa:nginx/stable\n#  update local package index\nRUN apt-get update\n#  install nginx\nRUN apt-get install nginx -y\nRUN echo \"\\ndaemon off;\" >> /etc/nginx/nginx.conf\n# #############################\n#  CONFIGURE NGINX TO JENKINS #\n# #############################\n#  change to nginx configuration folder\nWORKDIR /etc/nginx/sites-available\n#  remove default nginx configuration\nRUN rm -rf default ../sites-enabled/default\n#  create new configuration for jenkins (add to tmp folder so that the correct values for jenkins port and ip can be inserted at runtime)\nRUN mkdir -p /etc/nginx/tmp \\\n && echo 'upstream app_server {' > /etc/nginx/tmp/jenkins \\\n && echo \" server CI_PORT_8080_TCP_ADDR:CI_PORT_8080_TCP_PORT fail_timeout=0;\" >> /etc/nginx/tmp/jenkins \\\n && echo '}' >> /etc/nginx/tmp/jenkins \\\n && echo ' ' >> /etc/nginx/tmp/jenkins \\\n && echo 'server {' >> /etc/nginx/tmp/jenkins \\\n && echo ' listen 80;' >> /etc/nginx/tmp/jenkins \\\n && echo ' listen [::]:80 default ipv6only=on;' >> /etc/nginx/tmp/jenkins \\\n && echo ' server_name ci.jamesdbloom.com;' >> /etc/nginx/tmp/jenkins \\\n && echo ' ' >> /etc/nginx/tmp/jenkins \\\n && echo ' location / {' >> /etc/nginx/tmp/jenkins \\\n && echo ' proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;' >> /etc/nginx/tmp/jenkins \\\n && echo ' proxy_set_header Host $http_host;' >> /etc/nginx/tmp/jenkins \\\n && echo ' proxy_redirect off;' >> /etc/nginx/tmp/jenkins \\\n && echo ' ' >> /etc/nginx/tmp/jenkins \\\n && echo ' if (!-f $request_filename) {' >> /etc/nginx/tmp/jenkins \\\n && echo ' proxy_pass http://app_server;' >> /etc/nginx/tmp/jenkins \\\n && echo ' break;' >> /etc/nginx/tmp/jenkins \\\n && echo ' }' >> /etc/nginx/tmp/jenkins \\\n && echo ' }' >> /etc/nginx/tmp/jenkins \\\n && echo '}' >> /etc/nginx/tmp/jenkins\n#  link new configuration\nRUN ln -s /etc/nginx/sites-available/jenkins /etc/nginx/sites-enabled/\n#  to build container run:\n#  docker build -t=\"mockserver/nginx\" https://raw.github.com/jamesdbloom/mockserver/master/ci/docker/nginx/Dockerfile\n# #######################\n#  CONFIGURE SUPERVISOR #\n# #######################\n#  add to supervisor\nRUN echo '[program:nginx]' > /etc/supervisor/conf.d/nginx \\\n && echo 'command=service nginx restart' >> /etc/supervisor/conf.d/nginx \\\n && echo 'redirect_stderr=true' >> /etc/supervisor/conf.d/nginx\n#  start supervisor daemon\nCMD sed \"s/CI_PORT_8080_TCP_ADDR/$CI_PORT_8080_TCP_ADDR/g\" /etc/nginx/tmp/jenkins | sed \"s/CI_PORT_8080_TCP_PORT/$CI_PORT_8080_TCP_PORT/g\" > /etc/nginx/sites-available/jenkins \\\n && supervisord -c /etc/supervisor/supervisor.conf\n# ###############\n#  EXPORT PORTS #\n# ###############\nEXPOSE 80/tcp\n# ##############\n#  TO BUILD... #\n# ##############\n#  to build container:\n#  docker build -t=\"mockserver/nginx\" https://raw.github.com/jamesdbloom/mockserver/master/ci/docker/nginx/Dockerfile\n#  to run container:\n#  docker run -name nginx -link jenkins:ci -p 80:80 -d mockserver/nginx\n# ###########\n#  NOTES... #\n# ###########\n#  The following files locations are used\n#  service: /etc/init.d/nginx\n#  config: /etc/nginx/nginx.conf\n#  access_logs: /var/log/nginx/access.log\n#  error_logs: /var/log/nginx/error.log\n","injectedSmells":[],"originalDockerfileHash":"6d6230116c0ad54f76d90ae4c5d0cdb1","successfullyInjectedSmells":[],"originalDockerfileUglified":"#\n#   MockServer Nginx Dockerfile\n#\n#   https://github.com/jamesdbloom/mockserver\n#   http://www.mock-server.com\n#\n#   pull base image\nFROM mockserver/base\n#   maintainer details\nMAINTAINER James Bloom \"jamesdbloom@gmail.com\"\n#  ################\n#   INSTALL NGINX #\n#  ################\n#   add nginx repository\nRUN add-apt-repository -y ppa:nginx/stable\n#   update local package index\nRUN apt-get update\n#   install nginx\nRUN apt-get install nginx -y\nRUN echo \"\\ndaemon off;\" >> /etc/nginx/nginx.conf\n#  #############################\n#   CONFIGURE NGINX TO JENKINS #\n#  #############################\n#   change to nginx configuration folder\nWORKDIR /etc/nginx/sites-available\n#   remove default nginx configuration\nRUN rm -rf default ../sites-enabled/default\n#   create new configuration for jenkins (add to tmp folder so that the correct values for jenkins port and ip can be inserted at runtime)\nRUN mkdir -p /etc/nginx/tmp \\\n && echo 'upstream app_server {' > /etc/nginx/tmp/jenkins \\\n && echo \" server CI_PORT_8080_TCP_ADDR:CI_PORT_8080_TCP_PORT fail_timeout=0;\" >> /etc/nginx/tmp/jenkins \\\n && echo '}' >> /etc/nginx/tmp/jenkins \\\n && echo ' ' >> /etc/nginx/tmp/jenkins \\\n && echo 'server {' >> /etc/nginx/tmp/jenkins \\\n && echo ' listen 80;' >> /etc/nginx/tmp/jenkins \\\n && echo ' listen [::]:80 default ipv6only=on;' >> /etc/nginx/tmp/jenkins \\\n && echo ' server_name ci.jamesdbloom.com;' >> /etc/nginx/tmp/jenkins \\\n && echo ' ' >> /etc/nginx/tmp/jenkins \\\n && echo ' location / {' >> /etc/nginx/tmp/jenkins \\\n && echo ' proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;' >> /etc/nginx/tmp/jenkins \\\n && echo ' proxy_set_header Host $http_host;' >> /etc/nginx/tmp/jenkins \\\n && echo ' proxy_redirect off;' >> /etc/nginx/tmp/jenkins \\\n && echo ' ' >> /etc/nginx/tmp/jenkins \\\n && echo ' if (!-f $request_filename) {' >> /etc/nginx/tmp/jenkins \\\n && echo ' proxy_pass http://app_server;' >> /etc/nginx/tmp/jenkins \\\n && echo ' break;' >> /etc/nginx/tmp/jenkins \\\n && echo ' }' >> /etc/nginx/tmp/jenkins \\\n && echo ' }' >> /etc/nginx/tmp/jenkins \\\n && echo '}' >> /etc/nginx/tmp/jenkins\n#   link new configuration\nRUN ln -s /etc/nginx/sites-available/jenkins /etc/nginx/sites-enabled/\n#   to build container run:\n#   docker build -t=\"mockserver/nginx\" https://raw.github.com/jamesdbloom/mockserver/master/ci/docker/nginx/Dockerfile\n#  #######################\n#   CONFIGURE SUPERVISOR #\n#  #######################\n#   add to supervisor\nRUN echo '[program:nginx]' > /etc/supervisor/conf.d/nginx \\\n && echo 'command=service nginx restart' >> /etc/supervisor/conf.d/nginx \\\n && echo 'redirect_stderr=true' >> /etc/supervisor/conf.d/nginx\n#   start supervisor daemon\nCMD sed \"s/CI_PORT_8080_TCP_ADDR/$CI_PORT_8080_TCP_ADDR/g\" /etc/nginx/tmp/jenkins | sed \"s/CI_PORT_8080_TCP_PORT/$CI_PORT_8080_TCP_PORT/g\" > /etc/nginx/sites-available/jenkins \\\n && supervisord -c /etc/supervisor/supervisor.conf\n#  ###############\n#   EXPORT PORTS #\n#  ###############\nEXPOSE 80/tcp\n#  ##############\n#   TO BUILD... #\n#  ##############\n#   to build container:\n#   docker build -t=\"mockserver/nginx\" https://raw.github.com/jamesdbloom/mockserver/master/ci/docker/nginx/Dockerfile\n#   to run container:\n#   docker run -name nginx -link jenkins:ci -p 80:80 -d mockserver/nginx\n#  ###########\n#   NOTES... #\n#  ###########\n#   The following files locations are used\n#   service: /etc/init.d/nginx\n#   config: /etc/nginx/nginx.conf\n#   access_logs: /var/log/nginx/access.log\n#   error_logs: /var/log/nginx/error.log\n","originalDockerfileUglifiedHash":"baf8856a5a0fb9e9562b0a3474768adc","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/c336474d2d0fb8f78d62d1d2a83a5825aed473f4.dockerfile"}