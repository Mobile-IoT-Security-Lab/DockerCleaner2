{"seed":206888613,"processedDockerfileHash":"9b46e6bff04e146412c1323ba44ebba3","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM ubuntu:18.04\nMAINTAINER lhhung<lhhung@uw.edu>\n#  Dockerfile for widget development container\n#  comment to force rebuild\nENV DEBIAN_FRONTEND=\"noninteractive\"\nENV HOME=\"/root\"\n#  base files/utils to be used inside container\nRUN apt-get update \\\n && apt-get install --no-install-recommends supervisor=3.3.1-1.1 pwgen=2.08-1 sudo=1.8.21p2-3ubuntu1.5 nano=2.9.3-2 net-tools=1.60+git20161116.90da8a0-1ubuntu1 fluxbox=1.3.5-2build1 feh=2.23.2-1build1 xterm=330-1ubuntu2.2 x11vnc=0.9.13-3 xvfb=2:1.19.6-1ubuntu4.14 gtk2-engines-murrine=0.98.2-2ubuntu1 ttf-ubuntu-font-family=1:0.83-2 fonts-wqy-microhei=0.2.0-beta-3 language-pack-zh-hant=1:18.04+20180712 language-pack-gnome-zh-hant=1:18.04+20180712 nginx=1.14.0-0ubuntu1.11 mesa-utils=8.4.0-1 libgl1-mesa-dri=20.0.8-0ubuntu1~18.04.1 -y --force-yes \\\n && apt-get autoclean -y \\\n && apt-get autoremove -y \\\n && rm -rf /var/lib/apt/lists/*\n#  files for  vnc framebuffer\nRUN apt-get update \\\n && apt-get install --no-install-recommends wget=1.19.4-1ubuntu2.2 libssl1.0 -y \\\n && chdir /tmp \\\n && wget --no-check-certificate --content-disposition https://github.com/BioDepot/BioDepot-workflow-builder/blob/master/noVNC/x11vnc-data_0.9.14-1.1ubuntu1_all.deb?raw=true \\\n && wget --no-check-certificate --content-disposition https://github.com/BioDepot/BioDepot-workflow-builder/blob/master/noVNC/x11vnc_0.9.14-1.1ubuntu1_amd64.deb?raw=true \\\n && dpkg -i /tmp/x11vnc*.deb \\\n && apt-get autoclean -y \\\n && apt-get autoremove -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && chdir /root \\\n && rm /tmp/*.deb\n#  files for web interface noVNC\nCOPY web /web/\nRUN apt-get update \\\n && apt-get install --no-install-recommends build-essential=12.4ubuntu1 gcc=4:7.4.0-1ubuntu2.3 python-pip=9.0.1-2.3~ubuntu1.18.04.8 python-dev=2.7.15~rc1-1 python3-pip=9.0.1-2.3~ubuntu1.18.04.8 -y \\\n && pip install pip==9.0.3 --upgrade \\\n && pip install setuptools==67.6.1 -U \\\n && pip install -r /web/requirements.txt \\\n && pip3 install docker \\\n && apt-get remove -y gcc build-essential python-pip python-dev python3-pip \\\n && apt-get autoclean -y \\\n && apt-get autoremove -y \\\n && rm -rf /var/lib/apt/lists/*\nCOPY noVNC /noVNC/\n#  files for orange and biodepot\nRUN apt-get update \\\n && apt-get install --no-install-recommends virtualenv=15.1.0+ds-1.1 libssl-dev=1.1.1-1ubuntu2.1~18.04.21 libqt5webkit5-dev=5.212.0~alpha2-7ubuntu1 python3-pyqt5=5.10.1+dfsg-1ubuntu2 python3-pyqt5.qtsvg=5.10.1+dfsg-1ubuntu2 python3-pyqt5.qtwebkit=5.10.1+dfsg-1ubuntu2 -y\nRUN rm /bin/sh \\\n && ln -s /bin/bash /bin/sh\nRUN virtualenv --python=python3 --system-site-packages orange3venv\nRUN source orange3venv/bin/activate\nCOPY orange3 orange3\nRUN apt-get update \\\n && apt-get install --no-install-recommends build-essential=12.4ubuntu1 gcc=4:7.4.0-1ubuntu2.3 python-dev=2.7.15~rc1-1 python3-dev=3.6.7-1~18.04 python3-pip=9.0.1-2.3~ubuntu1.18.04.8 python-pip=9.0.1-2.3~ubuntu1.18.04.8 -y \\\n && pip3 install --upgrade pip==9.0.3 \\\n && pip install numpy==1.24.2 \\\n && pip3 install -U setuptools \\\n && pip3 install -r orange3/requirements-core.txt \\\n && pip3 install -r orange3/requirements-gui.txt \\\n && pip3 install docker pysam beautifulsoup4 \\\n && pip3 install -e orange3 \\\n && apt-get remove -y gcc build-essential \\\n && apt-get autoclean -y \\\n && apt-get autoremove -y \\\n && rm -rf /var/lib/apt/lists/*\n#  install Docker-ce\nRUN apt-get update \\\n && apt-get install --no-install-recommends apt-transport-https=1.6.14 ca-certificates=20211016ubuntu0.18.04.1 curl=7.58.0-2ubuntu3.24 software-properties-common=0.96.24.32.20 gnupg2=2.2.4-1ubuntu1.6 -y \\\n && curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add - \\\n && apt-get remove -y curl gnupg2 \\\n && apt-get autoclean -y \\\n && apt-get autoremove -y \\\n && rm -rf /var/lib/apt/lists/*\nRUN add-apt-repository -y \"deb [arch=amd64] https://download.docker.com/linux/ubuntu bionic stable\" \\\n && apt-get update \\\n && apt-get install --no-install-recommends docker-ce docker-ce-cli containerd.io -y \\\n && apt-get remove -y apt-transport-https software-properties-common \\\n && apt-get autoclean -y \\\n && apt-get autoremove -y \\\n && rm -rf /var/lib/apt/lists/*\n#  nginx and supervisor setup\nCOPY supervisord.conf /etc/supervisor/conf.d/\nCOPY nginx.conf /etc/nginx/sites-enabled/default\n#  jsonpickle\nRUN pip3 install --user jsonpickle\n#  put biodepot here and keep pip for rapid updates\nCOPY biodepot biodepot\nRUN pip3 install -e biodepot\nCOPY startup.sh /\nEXPOSE 6080/tcp\nWORKDIR /data\n#  install rsync\n#  install rsync curl and docker-compose\nRUN apt-get update \\\n && apt-get install --no-install-recommends rsync=3.1.2-2.1ubuntu1.6 curl=7.58.0-2ubuntu3.24 -y \\\n && curl -L \"https://github.com/docker/compose/releases/download/1.23.2/docker-compose-$( uname -s ;)-$( uname -m ;)\" -o /usr/local/bin/docker-compose \\\n && chmod +x /usr/local/bin/docker-compose \\\n && apt-get autoclean -y \\\n && apt-get autoremove -y \\\n && rm -rf /var/lib/apt/lists/**\n#  Change app name to Bwb\nRUN sed -i 's/\\\"Orange Canvas\\\"/\\\"Bwb\\\"/' /orange3/Orange/canvas/config.py\n#  set up some config files\nCOPY fluxbox_config/ /root/.fluxbox/\nCOPY user_config/ /root/\n#  patch orange3\nCOPY orangePatches/schemeedit.py /orange3/Orange/canvas/document/schemeedit.py\nCOPY orangePatches/canvasmain.py /orange3/Orange/canvas/application/canvasmain.py\nCOPY orangePatches/widgetsscheme.py /orange3/Orange/canvas/scheme/widgetsscheme.py\nCOPY orangePatches/signalmanager.py /orange3/Orange/canvas/scheme/signalmanager.py\nCOPY orangePatches/link.py /orange3/Orange/canvas/scheme/link.py\nCOPY orangePatches/signals.py /orange3/Orange/widgets/utils/signals.py\n#  add bwb start scripts\nCOPY scripts/startBwb.sh /bin/startBwb.sh\nCOPY scripts/runDockerJob.sh /bin/runDockerJob.sh\nCOPY scripts/startScheduler.sh /bin/startScheduler.sh\n#  add widgets and workflows\nCOPY widgets /widgets/\nCOPY workflows /workflows/\nCOPY notebooks /notebooks/\nCOPY templates /templates/\nCOPY coreutils /coreutils/\nCOPY icons /icons/\nCOPY tutorialFiles /tutorialFiles\nCOPY serverSettings.json /biodepot\n#  start it up\nCMD /startup.sh \\\n && /usr/bin/supervisord -n -c /etc/supervisor/supervisord.conf\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM ubuntu:18.04\nMAINTAINER lhhung<lhhung@uw.edu>\n# Dockerfile for widget development container\n# comment to force rebuild\nENV DEBIAN_FRONTEND=\"noninteractive\"\nENV HOME=\"/root\"\n# base files/utils to be used inside container\nRUN apt-get update \\\n && apt-get install --no-install-recommends supervisor pwgen sudo nano net-tools fluxbox feh xterm x11vnc xvfb gtk2-engines-murrine ttf-ubuntu-font-family fonts-wqy-microhei language-pack-zh-hant language-pack-gnome-zh-hant nginx mesa-utils libgl1-mesa-dri -y --force-yes \\\n && apt-get autoclean -y \\\n && apt-get autoremove -y \\\n && rm -rf /var/lib/apt/lists/*\n# files for  vnc framebuffer\nRUN apt-get update \\\n && apt-get install wget libssl1.0 -y \\\n && chdir /tmp \\\n && wget --no-check-certificate --content-disposition https://github.com/BioDepot/BioDepot-workflow-builder/blob/master/noVNC/x11vnc-data_0.9.14-1.1ubuntu1_all.deb?raw=true \\\n && wget --no-check-certificate --content-disposition https://github.com/BioDepot/BioDepot-workflow-builder/blob/master/noVNC/x11vnc_0.9.14-1.1ubuntu1_amd64.deb?raw=true \\\n && dpkg -i /tmp/x11vnc*.deb \\\n && apt-get autoclean -y \\\n && apt-get autoremove -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && chdir /root \\\n && rm /tmp/*.deb\n# files for web interface noVNC\nADD web /web/\nRUN apt-get update \\\n && apt-get install build-essential gcc python-pip python-dev python3-pip -y \\\n && pip install pip==9.0.3 --upgrade \\\n && pip install setuptools -U \\\n && pip install -r /web/requirements.txt \\\n && pip3 install docker \\\n && apt-get remove -y gcc build-essential python-pip python-dev python3-pip \\\n && apt-get autoclean -y \\\n && apt-get autoremove -y \\\n && rm -rf /var/lib/apt/lists/*\nADD noVNC /noVNC/\n# files for orange and biodepot\nRUN apt-get update \\\n && apt-get install --no-install-recommends virtualenv libssl-dev libqt5webkit5-dev python3-pyqt5 python3-pyqt5.qtsvg python3-pyqt5.qtwebkit -y\nRUN rm /bin/sh \\\n && ln -s /bin/bash /bin/sh\nRUN virtualenv --python=python3 --system-site-packages orange3venv\nRUN source orange3venv/bin/activate\nCOPY orange3 orange3\nRUN apt-get update \\\n && apt-get install build-essential gcc python-dev python3-dev python3-pip python-pip -y \\\n && pip3 install --upgrade pip==9.0.3 \\\n && pip install numpy \\\n && pip3 install -U setuptools \\\n && pip3 install -r orange3/requirements-core.txt \\\n && pip3 install -r orange3/requirements-gui.txt \\\n && pip3 install docker pysam beautifulsoup4 \\\n && pip3 install -e orange3 \\\n && apt-get remove -y gcc build-essential \\\n && apt-get autoclean -y \\\n && apt-get autoremove -y \\\n && rm -rf /var/lib/apt/lists/*\n# install Docker-ce\nRUN apt-get update \\\n && apt-get install apt-transport-https ca-certificates curl software-properties-common gnupg2 -y \\\n && curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add - \\\n && apt-get remove -y curl gnupg2 \\\n && apt-get autoclean -y \\\n && apt-get autoremove -y \\\n && rm -rf /var/lib/apt/lists/*\nRUN add-apt-repository -y \"deb [arch=amd64] https://download.docker.com/linux/ubuntu bionic stable\" \\\n && apt-get update \\\n && apt-get install docker-ce docker-ce-cli containerd.io -y \\\n && apt-get remove -y apt-transport-https software-properties-common \\\n && apt-get autoclean -y \\\n && apt-get autoremove -y \\\n && rm -rf /var/lib/apt/lists/*\n# nginx and supervisor setup\nADD supervisord.conf /etc/supervisor/conf.d/\nADD nginx.conf /etc/nginx/sites-enabled/default\n# jsonpickle\nRUN pip3 install --user jsonpickle\n# put biodepot here and keep pip for rapid updates\nADD biodepot biodepot\nRUN pip3 install -e biodepot\nADD startup.sh /\nEXPOSE 6080/tcp\nWORKDIR /data\n# install rsync\n# install rsync curl and docker-compose\nRUN apt-get update \\\n && apt-get install rsync curl -y \\\n && curl -L \"https://github.com/docker/compose/releases/download/1.23.2/docker-compose-$( uname -s ;)-$( uname -m ;)\" -o /usr/local/bin/docker-compose \\\n && chmod +x /usr/local/bin/docker-compose \\\n && apt-get autoclean -y \\\n && apt-get autoremove -y \\\n && rm -rf /var/lib/apt/lists/**\n# Change app name to Bwb\nRUN sed -i 's/\\\"Orange Canvas\\\"/\\\"Bwb\\\"/' /orange3/Orange/canvas/config.py\n# set up some config files\nCOPY fluxbox_config/ /root/.fluxbox/\nCOPY user_config/ /root/\n# patch orange3\nCOPY orangePatches/schemeedit.py /orange3/Orange/canvas/document/schemeedit.py\nCOPY orangePatches/canvasmain.py /orange3/Orange/canvas/application/canvasmain.py\nCOPY orangePatches/widgetsscheme.py /orange3/Orange/canvas/scheme/widgetsscheme.py\nCOPY orangePatches/signalmanager.py /orange3/Orange/canvas/scheme/signalmanager.py\nCOPY orangePatches/link.py /orange3/Orange/canvas/scheme/link.py\nCOPY orangePatches/signals.py /orange3/Orange/widgets/utils/signals.py\n# add bwb start scripts\nCOPY scripts/startBwb.sh /bin/startBwb.sh\nCOPY scripts/runDockerJob.sh /bin/runDockerJob.sh\nCOPY scripts/startScheduler.sh /bin/startScheduler.sh\n# add widgets and workflows\nADD widgets /widgets/\nADD workflows /workflows/\nADD notebooks /notebooks/\nADD templates /templates/\nADD coreutils /coreutils/\nADD icons /icons/\nADD tutorialFiles /tutorialFiles\nADD serverSettings.json /biodepot\n# start it up\nCMD /startup.sh \\\n && /usr/bin/supervisord -n -c /etc/supervisor/supervisord.conf\n","injectedSmells":[],"originalDockerfileHash":"17f30ca725d0bc17193843870c54dea5","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM ubuntu:18.04\nMAINTAINER lhhung<lhhung@uw.edu>\n#  Dockerfile for widget development container\n#  comment to force rebuild\nENV DEBIAN_FRONTEND=\"noninteractive\"\nENV HOME=\"/root\"\n#  base files/utils to be used inside container\nRUN apt-get update \\\n && apt-get install --no-install-recommends supervisor pwgen sudo nano net-tools fluxbox feh xterm x11vnc xvfb gtk2-engines-murrine ttf-ubuntu-font-family fonts-wqy-microhei language-pack-zh-hant language-pack-gnome-zh-hant nginx mesa-utils libgl1-mesa-dri -y --force-yes \\\n && apt-get autoclean -y \\\n && apt-get autoremove -y \\\n && rm -rf /var/lib/apt/lists/*\n#  files for  vnc framebuffer\nRUN apt-get update \\\n && apt-get install wget libssl1.0 -y \\\n && chdir /tmp \\\n && wget --no-check-certificate --content-disposition https://github.com/BioDepot/BioDepot-workflow-builder/blob/master/noVNC/x11vnc-data_0.9.14-1.1ubuntu1_all.deb?raw=true \\\n && wget --no-check-certificate --content-disposition https://github.com/BioDepot/BioDepot-workflow-builder/blob/master/noVNC/x11vnc_0.9.14-1.1ubuntu1_amd64.deb?raw=true \\\n && dpkg -i /tmp/x11vnc*.deb \\\n && apt-get autoclean -y \\\n && apt-get autoremove -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && chdir /root \\\n && rm /tmp/*.deb\n#  files for web interface noVNC\nADD web /web/\nRUN apt-get update \\\n && apt-get install build-essential gcc python-pip python-dev python3-pip -y \\\n && pip install pip==9.0.3 --upgrade \\\n && pip install setuptools -U \\\n && pip install -r /web/requirements.txt \\\n && pip3 install docker \\\n && apt-get remove -y gcc build-essential python-pip python-dev python3-pip \\\n && apt-get autoclean -y \\\n && apt-get autoremove -y \\\n && rm -rf /var/lib/apt/lists/*\nADD noVNC /noVNC/\n#  files for orange and biodepot\nRUN apt-get update \\\n && apt-get install --no-install-recommends virtualenv libssl-dev libqt5webkit5-dev python3-pyqt5 python3-pyqt5.qtsvg python3-pyqt5.qtwebkit -y\nRUN rm /bin/sh \\\n && ln -s /bin/bash /bin/sh\nRUN virtualenv --python=python3 --system-site-packages orange3venv\nRUN source orange3venv/bin/activate\nCOPY orange3 orange3\nRUN apt-get update \\\n && apt-get install build-essential gcc python-dev python3-dev python3-pip python-pip -y \\\n && pip3 install --upgrade pip==9.0.3 \\\n && pip install numpy \\\n && pip3 install -U setuptools \\\n && pip3 install -r orange3/requirements-core.txt \\\n && pip3 install -r orange3/requirements-gui.txt \\\n && pip3 install docker pysam beautifulsoup4 \\\n && pip3 install -e orange3 \\\n && apt-get remove -y gcc build-essential \\\n && apt-get autoclean -y \\\n && apt-get autoremove -y \\\n && rm -rf /var/lib/apt/lists/*\n#  install Docker-ce\nRUN apt-get update \\\n && apt-get install apt-transport-https ca-certificates curl software-properties-common gnupg2 -y \\\n && curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add - \\\n && apt-get remove -y curl gnupg2 \\\n && apt-get autoclean -y \\\n && apt-get autoremove -y \\\n && rm -rf /var/lib/apt/lists/*\nRUN add-apt-repository -y \"deb [arch=amd64] https://download.docker.com/linux/ubuntu bionic stable\" \\\n && apt-get update \\\n && apt-get install docker-ce docker-ce-cli containerd.io -y \\\n && apt-get remove -y apt-transport-https software-properties-common \\\n && apt-get autoclean -y \\\n && apt-get autoremove -y \\\n && rm -rf /var/lib/apt/lists/*\n#  nginx and supervisor setup\nADD supervisord.conf /etc/supervisor/conf.d/\nADD nginx.conf /etc/nginx/sites-enabled/default\n#  jsonpickle\nRUN pip3 install --user jsonpickle\n#  put biodepot here and keep pip for rapid updates\nADD biodepot biodepot\nRUN pip3 install -e biodepot\nADD startup.sh /\nEXPOSE 6080/tcp\nWORKDIR /data\n#  install rsync\n#  install rsync curl and docker-compose\nRUN apt-get update \\\n && apt-get install rsync curl -y \\\n && curl -L \"https://github.com/docker/compose/releases/download/1.23.2/docker-compose-$( uname -s ;)-$( uname -m ;)\" -o /usr/local/bin/docker-compose \\\n && chmod +x /usr/local/bin/docker-compose \\\n && apt-get autoclean -y \\\n && apt-get autoremove -y \\\n && rm -rf /var/lib/apt/lists/**\n#  Change app name to Bwb\nRUN sed -i 's/\\\"Orange Canvas\\\"/\\\"Bwb\\\"/' /orange3/Orange/canvas/config.py\n#  set up some config files\nCOPY fluxbox_config/ /root/.fluxbox/\nCOPY user_config/ /root/\n#  patch orange3\nCOPY orangePatches/schemeedit.py /orange3/Orange/canvas/document/schemeedit.py\nCOPY orangePatches/canvasmain.py /orange3/Orange/canvas/application/canvasmain.py\nCOPY orangePatches/widgetsscheme.py /orange3/Orange/canvas/scheme/widgetsscheme.py\nCOPY orangePatches/signalmanager.py /orange3/Orange/canvas/scheme/signalmanager.py\nCOPY orangePatches/link.py /orange3/Orange/canvas/scheme/link.py\nCOPY orangePatches/signals.py /orange3/Orange/widgets/utils/signals.py\n#  add bwb start scripts\nCOPY scripts/startBwb.sh /bin/startBwb.sh\nCOPY scripts/runDockerJob.sh /bin/runDockerJob.sh\nCOPY scripts/startScheduler.sh /bin/startScheduler.sh\n#  add widgets and workflows\nADD widgets /widgets/\nADD workflows /workflows/\nADD notebooks /notebooks/\nADD templates /templates/\nADD coreutils /coreutils/\nADD icons /icons/\nADD tutorialFiles /tutorialFiles\nADD serverSettings.json /biodepot\n#  start it up\nCMD /startup.sh \\\n && /usr/bin/supervisord -n -c /etc/supervisor/supervisord.conf\n","originalDockerfileUglifiedHash":"715f5bff0595d1306931715bebee4b51","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/49b401cd2197d3c515e439cc269ed4265d1fbe08.dockerfile"}