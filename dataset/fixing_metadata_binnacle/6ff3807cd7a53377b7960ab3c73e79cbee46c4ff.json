{"seed":2720752934,"processedDockerfileHash":"84dba080e81e3835409b72aa6996fe9e","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-pip","have-a-healthcheck"],"processedDockerfile":"#\n#   Copyright 2019, Intel Corporation\n#\n#   'recipe' for Docker to build an image of Leap-based\n#   environment for building the DAOS project.\n#\n#   Pull base image\nFROM suse/sles:12.3\nMAINTAINER Johann Lombardi <johann.lombardi@intel.com>\n#   Build arguments can be set via -build-arg\n#   use same UID as host and default value of 1000 if not specified\nARG UID=1000\n#   Update distribution\n#   It's better to put the zypper update in the same \"cache layer\" as the\n#   zypper install command so that the database is updated if/when the\n#   installed packages list below is updated\nRUN zypper --non-interactive update\nRUN zypper --non-interactive install boost-devel ca-certificates-mozilla cmake cunit-devel curl doxygen flex gcc gcc-c++ git go graphviz libaio-devel libevent-devel libiscsi-devel libltdl7 libtool libnuma-devel libopenssl-devel libuuid-devel libyaml-devel make man nasm ninja pandoc patch python python-xml python3 readline-devel rsync yasm valgrind\nRUN curl -ksS \"https://bootstrap.pypa.io/get-pip.py\" -o \"/tmp/git-pip.py\" ; python /tmp/git-pip.py pip ; python3 /tmp/git-pip.py pip ; cp /usr/bin/pip2 /usr/bin/pip ; rm /tmp/git-pip.py\nRUN pip install setuptools==67.6.1 -U\nRUN pip install wheel==0.40.0 -U\nRUN pip install scons==3.0.1 ; pip3 install -U \"meson<0.45.0\"\n#   No clang libcmocka-devel meson python2-pip sg3_utils\nRUN zypper install -y gzip which\nRUN curl -fsSL -o /tmp/libcmocka0-1.0.1-9.3.x86_64.rpm http://download.opensuse.org/distribution/leap/42.3/repo/oss/suse/x86_64/libcmocka0-1.0.1-9.3.x86_64.rpm\nRUN curl -fsSL -o /tmp/libcmocka-devel-1.0.1-9.3.x86_64.rpm http://download.opensuse.org/distribution/leap/42.3/repo/oss/suse/x86_64/libcmocka-devel-1.0.1-9.3.x86_64.rpm\nRUN zypper --non-interactive --no-gpg-checks install /tmp/libcmocka0-1.0.1-9.3.x86_64.rpm /tmp/libcmocka-devel-1.0.1-9.3.x86_64.rpm ; rm /tmp/libcmocka0-1.0.1-9.3.x86_64.rpm /tmp/libcmocka-devel-1.0.1-9.3.x86_64.rpm\nRUN curl -fsSL -o /tmp/go-1.10.4-40.1.x86_64.rpm http://download.opensuse.org/update/leap/42.3/oss/x86_64/go-1.10.4-40.1.x86_64.rpm\nRUN curl -fsSL -o /tmp/go1.10-1.10.4-2.2.x86_64.rpm http://download.opensuse.org/update/leap/42.3/oss/x86_64/go1.10-1.10.4-2.2.x86_64.rpm\nRUN curl -fsSL -o /tmp/go1.10-doc-1.10.4-2.2.x86_64.rpm http://download.opensuse.org/update/leap/42.3/oss/x86_64/go1.10-doc-1.10.4-2.2.x86_64.rpm\nRUN curl -fsSL -o /tmp/go1.10-race-1.10.4-2.2.x86_64.rpm http://download.opensuse.org/update/leap/42.3/oss/x86_64/go1.10-race-1.10.4-2.2.x86_64.rpm\nRUN curl -fsSL -o /tmp/go-doc-1.10.4-40.1.x86_64.rpm http://download.opensuse.org/update/leap/42.3/oss/x86_64/go-doc-1.10.4-40.1.x86_64.rpm\nRUN zypper --non-interactive --no-gpg-checks install /tmp/go-1.10.4-40.1.x86_64.rpm /tmp/go1.10-1.10.4-2.2.x86_64.rpm /tmp/go1.10-doc-1.10.4-2.2.x86_64.rpm /tmp/go1.10-race-1.10.4-2.2.x86_64.rpm ; rm /tmp/go-1.10.4-40.1.x86_64.rpm /tmp/go1.10-1.10.4-2.2.x86_64.rpm /tmp/go1.10-doc-1.10.4-2.2.x86_64.rpm /tmp/go1.10-race-1.10.4-2.2.x86_64.rpm\nRUN curl -fsSL -o /tmp/jhli.key https://download.opensuse.org/repositories/home:/jhli/SLE_15/repodata/repomd.xml.key\nRUN rpm --import /tmp/jhli.key\nRUN zypper --non-interactive addrepo https://download.opensuse.org/repositories/home:/jhli/SLE_15/home:jhli.repo\nRUN zypper --non-interactive refresh\nRUN zypper --non-interactive install -y ipmctl-devel\n#   Add DAOS user\nENV USER=\"daos\"\nENV PASSWD=\"daos\"\nRUN useradd -u $UID -ms /bin/bash $USER\n#   Create directory for DAOS backend storage\nRUN mkdir /mnt/daos\nRUN chown daos.daos /mnt/daos || { cat /etc/passwd ;cat /etc/group ;cat /etc/shadow ;chown daos /mnt/daos ;chgrp daos /mnt/daos ;ls -ld /mnt/daos ; }\n#   Switch to new user\nUSER $USER\nWORKDIR /home/$USER\n#   set NOBUILD to disable git clone & build\nARG NOBUILD\n#   Fetch DAOS code\nRUN if [ \"x$NOBUILD\" = \"x\" ] ; then git clone https://github.com/daos-stack/daos.git ; fi\nWORKDIR /home/$USER/daos\n#   Build DAOS & dependencies\nRUN if [ \"x$NOBUILD\" = \"x\" ] ; then git submodule init \\\n && git submodule update ; fi\nRUN if [ \"x$NOBUILD\" = \"x\" ] ; then scons --build-deps=yes USE_INSTALLED=all install ; fi\n#   Set environment variables\nENV PATH=\"/home/daos/daos/install/bin:$PATH\"\nENV LD_LIBRARY_PATH=\"/home/daos/daos/install/lib:/home/daos/daos/install/lib/daos_srv:$LD_LIBRARY_PATH\"\nENV CPATH=\"/home/daos/daos/install/include:$CPATH\"\nENV CRT_PHY_ADDR_STR=\"ofi+sockets\"\nENV OFI_INTERFACE=\"eth0\"\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#\n#  Copyright 2019, Intel Corporation\n#\n#  'recipe' for Docker to build an image of Leap-based\n#  environment for building the DAOS project.\n#\n#  Pull base image\nFROM suse/sles:12.3\nMAINTAINER Johann Lombardi <johann.lombardi@intel.com>\n#  Build arguments can be set via -build-arg\n#  use same UID as host and default value of 1000 if not specified\nARG UID=1000\n#  Update distribution\n#  It's better to put the zypper update in the same \"cache layer\" as the\n#  zypper install command so that the database is updated if/when the\n#  installed packages list below is updated\nRUN zypper --non-interactive update\nRUN zypper --non-interactive install boost-devel ca-certificates-mozilla cmake cunit-devel curl doxygen flex gcc gcc-c++ git go graphviz libaio-devel libevent-devel libiscsi-devel libltdl7 libtool libnuma-devel libopenssl-devel libuuid-devel libyaml-devel make man nasm ninja pandoc patch python python-xml python3 readline-devel rsync yasm valgrind\nRUN curl -ksS \"https://bootstrap.pypa.io/get-pip.py\" -o \"/tmp/git-pip.py\" ; python /tmp/git-pip.py pip ; python3 /tmp/git-pip.py pip ; cp /usr/bin/pip2 /usr/bin/pip ; rm /tmp/git-pip.py\nRUN pip install setuptools -U\nRUN pip install wheel -U\nRUN pip install scons==3.0.1 ; pip3 install -U \"meson<0.45.0\"\n#  No clang libcmocka-devel meson python2-pip sg3_utils\nRUN zypper install -y gzip which\nRUN curl -fsSL -o /tmp/libcmocka0-1.0.1-9.3.x86_64.rpm http://download.opensuse.org/distribution/leap/42.3/repo/oss/suse/x86_64/libcmocka0-1.0.1-9.3.x86_64.rpm\nRUN curl -fsSL -o /tmp/libcmocka-devel-1.0.1-9.3.x86_64.rpm http://download.opensuse.org/distribution/leap/42.3/repo/oss/suse/x86_64/libcmocka-devel-1.0.1-9.3.x86_64.rpm\nRUN zypper --non-interactive --no-gpg-checks install /tmp/libcmocka0-1.0.1-9.3.x86_64.rpm /tmp/libcmocka-devel-1.0.1-9.3.x86_64.rpm ; rm /tmp/libcmocka0-1.0.1-9.3.x86_64.rpm /tmp/libcmocka-devel-1.0.1-9.3.x86_64.rpm\nRUN curl -fsSL -o /tmp/go-1.10.4-40.1.x86_64.rpm http://download.opensuse.org/update/leap/42.3/oss/x86_64/go-1.10.4-40.1.x86_64.rpm\nRUN curl -fsSL -o /tmp/go1.10-1.10.4-2.2.x86_64.rpm http://download.opensuse.org/update/leap/42.3/oss/x86_64/go1.10-1.10.4-2.2.x86_64.rpm\nRUN curl -fsSL -o /tmp/go1.10-doc-1.10.4-2.2.x86_64.rpm http://download.opensuse.org/update/leap/42.3/oss/x86_64/go1.10-doc-1.10.4-2.2.x86_64.rpm\nRUN curl -fsSL -o /tmp/go1.10-race-1.10.4-2.2.x86_64.rpm http://download.opensuse.org/update/leap/42.3/oss/x86_64/go1.10-race-1.10.4-2.2.x86_64.rpm\nRUN curl -fsSL -o /tmp/go-doc-1.10.4-40.1.x86_64.rpm http://download.opensuse.org/update/leap/42.3/oss/x86_64/go-doc-1.10.4-40.1.x86_64.rpm\nRUN zypper --non-interactive --no-gpg-checks install /tmp/go-1.10.4-40.1.x86_64.rpm /tmp/go1.10-1.10.4-2.2.x86_64.rpm /tmp/go1.10-doc-1.10.4-2.2.x86_64.rpm /tmp/go1.10-race-1.10.4-2.2.x86_64.rpm ; rm /tmp/go-1.10.4-40.1.x86_64.rpm /tmp/go1.10-1.10.4-2.2.x86_64.rpm /tmp/go1.10-doc-1.10.4-2.2.x86_64.rpm /tmp/go1.10-race-1.10.4-2.2.x86_64.rpm\nRUN curl -fsSL -o /tmp/jhli.key https://download.opensuse.org/repositories/home:/jhli/SLE_15/repodata/repomd.xml.key\nRUN rpm --import /tmp/jhli.key\nRUN zypper --non-interactive addrepo https://download.opensuse.org/repositories/home:/jhli/SLE_15/home:jhli.repo\nRUN zypper --non-interactive refresh\nRUN zypper --non-interactive install -y ipmctl-devel\n#  Add DAOS user\nENV USER=\"daos\"\nENV PASSWD=\"daos\"\nRUN useradd -u $UID -ms /bin/bash $USER\n#  Create directory for DAOS backend storage\nRUN mkdir /mnt/daos\nRUN chown daos.daos /mnt/daos || { cat /etc/passwd ;cat /etc/group ;cat /etc/shadow ;chown daos /mnt/daos ;chgrp daos /mnt/daos ;ls -ld /mnt/daos ; }\n#  Switch to new user\nUSER $USER\nWORKDIR /home/$USER\n#  set NOBUILD to disable git clone & build\nARG NOBUILD\n#  Fetch DAOS code\nRUN if [ \"x$NOBUILD\" = \"x\" ] ; then git clone https://github.com/daos-stack/daos.git ; fi\nWORKDIR /home/$USER/daos\n#  Build DAOS & dependencies\nRUN if [ \"x$NOBUILD\" = \"x\" ] ; then git submodule init \\\n && git submodule update ; fi\nRUN if [ \"x$NOBUILD\" = \"x\" ] ; then scons --build-deps=yes USE_INSTALLED=all install ; fi\n#  Set environment variables\nENV PATH=\"/home/daos/daos/install/bin:$PATH\"\nENV LD_LIBRARY_PATH=\"/home/daos/daos/install/lib:/home/daos/daos/install/lib/daos_srv:$LD_LIBRARY_PATH\"\nENV CPATH=\"/home/daos/daos/install/include:$CPATH\"\nENV CRT_PHY_ADDR_STR=\"ofi+sockets\"\nENV OFI_INTERFACE=\"eth0\"\n","injectedSmells":[],"originalDockerfileHash":"d368617d760a2bfaaa2a9e19a22b6526","successfullyInjectedSmells":[],"originalDockerfileUglified":"#\n#   Copyright 2019, Intel Corporation\n#\n#   'recipe' for Docker to build an image of Leap-based\n#   environment for building the DAOS project.\n#\n#   Pull base image\nFROM suse/sles:12.3\nMAINTAINER Johann Lombardi <johann.lombardi@intel.com>\n#   Build arguments can be set via -build-arg\n#   use same UID as host and default value of 1000 if not specified\nARG UID=1000\n#   Update distribution\n#   It's better to put the zypper update in the same \"cache layer\" as the\n#   zypper install command so that the database is updated if/when the\n#   installed packages list below is updated\nRUN zypper --non-interactive update\nRUN zypper --non-interactive install boost-devel ca-certificates-mozilla cmake cunit-devel curl doxygen flex gcc gcc-c++ git go graphviz libaio-devel libevent-devel libiscsi-devel libltdl7 libtool libnuma-devel libopenssl-devel libuuid-devel libyaml-devel make man nasm ninja pandoc patch python python-xml python3 readline-devel rsync yasm valgrind\nRUN curl -ksS \"https://bootstrap.pypa.io/get-pip.py\" -o \"/tmp/git-pip.py\" ; python /tmp/git-pip.py pip ; python3 /tmp/git-pip.py pip ; cp /usr/bin/pip2 /usr/bin/pip ; rm /tmp/git-pip.py\nRUN pip install setuptools -U\nRUN pip install wheel -U\nRUN pip install scons==3.0.1 ; pip3 install -U \"meson<0.45.0\"\n#   No clang libcmocka-devel meson python2-pip sg3_utils\nRUN zypper install -y gzip which\nRUN curl -fsSL -o /tmp/libcmocka0-1.0.1-9.3.x86_64.rpm http://download.opensuse.org/distribution/leap/42.3/repo/oss/suse/x86_64/libcmocka0-1.0.1-9.3.x86_64.rpm\nRUN curl -fsSL -o /tmp/libcmocka-devel-1.0.1-9.3.x86_64.rpm http://download.opensuse.org/distribution/leap/42.3/repo/oss/suse/x86_64/libcmocka-devel-1.0.1-9.3.x86_64.rpm\nRUN zypper --non-interactive --no-gpg-checks install /tmp/libcmocka0-1.0.1-9.3.x86_64.rpm /tmp/libcmocka-devel-1.0.1-9.3.x86_64.rpm ; rm /tmp/libcmocka0-1.0.1-9.3.x86_64.rpm /tmp/libcmocka-devel-1.0.1-9.3.x86_64.rpm\nRUN curl -fsSL -o /tmp/go-1.10.4-40.1.x86_64.rpm http://download.opensuse.org/update/leap/42.3/oss/x86_64/go-1.10.4-40.1.x86_64.rpm\nRUN curl -fsSL -o /tmp/go1.10-1.10.4-2.2.x86_64.rpm http://download.opensuse.org/update/leap/42.3/oss/x86_64/go1.10-1.10.4-2.2.x86_64.rpm\nRUN curl -fsSL -o /tmp/go1.10-doc-1.10.4-2.2.x86_64.rpm http://download.opensuse.org/update/leap/42.3/oss/x86_64/go1.10-doc-1.10.4-2.2.x86_64.rpm\nRUN curl -fsSL -o /tmp/go1.10-race-1.10.4-2.2.x86_64.rpm http://download.opensuse.org/update/leap/42.3/oss/x86_64/go1.10-race-1.10.4-2.2.x86_64.rpm\nRUN curl -fsSL -o /tmp/go-doc-1.10.4-40.1.x86_64.rpm http://download.opensuse.org/update/leap/42.3/oss/x86_64/go-doc-1.10.4-40.1.x86_64.rpm\nRUN zypper --non-interactive --no-gpg-checks install /tmp/go-1.10.4-40.1.x86_64.rpm /tmp/go1.10-1.10.4-2.2.x86_64.rpm /tmp/go1.10-doc-1.10.4-2.2.x86_64.rpm /tmp/go1.10-race-1.10.4-2.2.x86_64.rpm ; rm /tmp/go-1.10.4-40.1.x86_64.rpm /tmp/go1.10-1.10.4-2.2.x86_64.rpm /tmp/go1.10-doc-1.10.4-2.2.x86_64.rpm /tmp/go1.10-race-1.10.4-2.2.x86_64.rpm\nRUN curl -fsSL -o /tmp/jhli.key https://download.opensuse.org/repositories/home:/jhli/SLE_15/repodata/repomd.xml.key\nRUN rpm --import /tmp/jhli.key\nRUN zypper --non-interactive addrepo https://download.opensuse.org/repositories/home:/jhli/SLE_15/home:jhli.repo\nRUN zypper --non-interactive refresh\nRUN zypper --non-interactive install -y ipmctl-devel\n#   Add DAOS user\nENV USER=\"daos\"\nENV PASSWD=\"daos\"\nRUN useradd -u $UID -ms /bin/bash $USER\n#   Create directory for DAOS backend storage\nRUN mkdir /mnt/daos\nRUN chown daos.daos /mnt/daos || { cat /etc/passwd ;cat /etc/group ;cat /etc/shadow ;chown daos /mnt/daos ;chgrp daos /mnt/daos ;ls -ld /mnt/daos ; }\n#   Switch to new user\nUSER $USER\nWORKDIR /home/$USER\n#   set NOBUILD to disable git clone & build\nARG NOBUILD\n#   Fetch DAOS code\nRUN if [ \"x$NOBUILD\" = \"x\" ] ; then git clone https://github.com/daos-stack/daos.git ; fi\nWORKDIR /home/$USER/daos\n#   Build DAOS & dependencies\nRUN if [ \"x$NOBUILD\" = \"x\" ] ; then git submodule init \\\n && git submodule update ; fi\nRUN if [ \"x$NOBUILD\" = \"x\" ] ; then scons --build-deps=yes USE_INSTALLED=all install ; fi\n#   Set environment variables\nENV PATH=\"/home/daos/daos/install/bin:$PATH\"\nENV LD_LIBRARY_PATH=\"/home/daos/daos/install/lib:/home/daos/daos/install/lib/daos_srv:$LD_LIBRARY_PATH\"\nENV CPATH=\"/home/daos/daos/install/include:$CPATH\"\nENV CRT_PHY_ADDR_STR=\"ofi+sockets\"\nENV OFI_INTERFACE=\"eth0\"\n","originalDockerfileUglifiedHash":"aa219d384274096c14b1009edf95b5ba","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/6ff3807cd7a53377b7960ab3c73e79cbee46c4ff.dockerfile"}