{"seed":3049972940,"processedDockerfileHash":"33130e614843df4f09580c21d901901d","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["have-a-healthcheck","have-a-user"],"processedDockerfile":"#   ---------------------------------------------------------------------------\n#   See the NOTICE file distributed with this work for additional\n#   information regarding copyright ownership.\n#\n#   This is free software; you can redistribute it and/or modify it\n#   under the terms of the GNU Lesser General Public License as\n#   published by the Free Software Foundation; either version 2.1 of\n#   the License, or (at your option) any later version.\n#\n#   This software is distributed in the hope that it will be useful,\n#   but WITHOUT ANY WARRANTY; without even the implied warranty of\n#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n#   Lesser General Public License for more details.\n#\n#   You should have received a copy of the GNU Lesser General Public\n#   License along with this software; if not, write to the Free\n#   Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n#   02110-1301 USA, or see the FSF site: http://www.fsf.org.\n#   ---------------------------------------------------------------------------\nFROM tomcat:8-jdk8-slim\n#      ____  ____  ____      ____  _   __        _\n#     |_  _||_  _||_  _|    |_  _|(_) [  |  _   (_)\n#       \\ \\  / /    \\ \\  /\\  / /  __   | | / ]  __\n#        > `' <      \\ \\/  \\/ /  [  |  | '' <  [  |\n#      _/ /'`\\ \\_     \\  /\\  /    | |  | |`\\ \\  | |\n#     |____||____|     \\/  \\/    [___][__|  \\_][___]\nMAINTAINER Vincent Massol <vincent@massol.net>\n#   Note: when using docker-compose, the ENV values below are overridden from the .env file.\n#   Install LibreOffice + other tools\n#   Note that procps is required to get ps which is used by JODConverter to start LibreOffice\nRUN apt-get update \\\n && apt-get install --no-install-recommends curl libreoffice unzip procps libpostgresql-jdbc-java -y \\\n && rm -rf /var/lib/apt/lists/*\n#   Install XWiki as the ROOT webapp context in Tomcat\n#   Create the Tomcat temporary directory\n#   Configure the XWiki permanent directory\nENV XWIKI_VERSION=\"11.4\"\nENV XWIKI_URL_PREFIX=\"\\\"https://maven.xwiki.org/releases/org/xwiki/platform/xwiki-platform-distribution-war/${XWIKI_VERSION}\\\"\"\nENV XWIKI_DOWNLOAD_SHA256=\"8a0d83edd44b2a73c079bc43672c88c096e28b59e50a69dd37391d6789ba4670\"\nRUN rm -rf /usr/local/tomcat/webapps/* \\\n && mkdir -p /usr/local/tomcat/temp \\\n && mkdir -p /usr/local/xwiki/data \\\n && curl -fSL \"${XWIKI_URL_PREFIX}/xwiki-platform-distribution-war-${XWIKI_VERSION}.war\" -o xwiki.war \\\n && echo \"$XWIKI_DOWNLOAD_SHA256 xwiki.war\" | sha256sum -c - \\\n && unzip -d /usr/local/tomcat/webapps/ROOT xwiki.war \\\n && rm -f xwiki.war\n#   Copy the JDBC driver in the XWiki webapp\nRUN cp /usr/share/java/postgresql-jdbc4.jar /usr/local/tomcat/webapps/ROOT/WEB-INF/lib/\n#   Configure Tomcat. For example set the memory for the Tomcat JVM since the default value is too small for XWiki\nCOPY tomcat/setenv.sh /usr/local/tomcat/bin/\n#   Setup the XWiki Hibernate configuration\nCOPY xwiki/hibernate.cfg.xml /usr/local/tomcat/webapps/ROOT/WEB-INF/hibernate.cfg.xml\n#   Set a specific distribution id in XWiki for this docker packaging.\nRUN sed -i 's/<id>org.xwiki.platform:xwiki-platform-distribution-war/<id>org.xwiki.platform:xwiki-platform-distribution-docker/' /usr/local/tomcat/webapps/ROOT/META-INF/extension.xed\n#   Add scripts required to make changes to XWiki configuration files at execution time\n#   Note: we don't run CHMOD since 1) it's not required since the executabe bit is already set in git and 2) running\n#   CHMOD after a COPY will sometimes fail, depending on different host-specific factors (especially on AUFS).\nCOPY xwiki/docker-entrypoint.sh /usr/local/bin/docker-entrypoint.sh\n#   Make the XWiki directory (the permanent directory is included in it) persist on the host (so that it's not recreated\n#   across runs)\nVOLUME /usr/local/xwiki\n#   At this point the image is done and what remains below are the runtime configuration used by the user to configure\n#   the container that will be created out of the image. Namely the user can override some environment variables with\n#     docker run -e \"var1=val1\" -e \"var2=val2\" ...\n#   The supported environment variables that can be overridden are:\n#   - DB_USER: the name of the user configured for XWiki in the DB. Default is \"xwiki\". This is used to configure\n#              xwiki's hibernate.cfg.xml file.\n#   - DB_PASSWORD: the password for the user configured for XWiki in the DB. Default is \"xwiki\". This is used to\n#                  configure xwiki's hibernate.cfg.xml file.\n#   - DB_DATABASE: the name of the database to use. Default is \"xwiki\". This is used to configure xwiki's\n#                  hibernate.cfg.xml file.\n#   - DB_HOST: The name of the host (or docker container) containing the database. Default is \"db\". This is used to\n#              configure xwiki's hibernate.cfg.xml file.\n#   Example:\n#     docker run -it -e \"DB_USER=xwiki\" -e \"DB_PASSWORD=xwiki\" <imagename>\n#   Starts XWiki by starting Tomcat. All options passed to \"docker run [OPTIONS] IMAGE[:TAG|@DIGEST] [COMMAND] [ARG...]\"\n#   are also passed to docker-entrypoint.sh. If \"xwiki\" is passed then XWiki will be configured the first time the\n#   container executes and Tomcat will be started. If some other parameter is passed then it'll be executed to comply\n#   with best practices defined at https://github.com/docker-library/official-images#consistency.\nENTRYPOINT [\"docker-entrypoint.sh\"]\nCMD [\"xwiki\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\nHEALTHCHECK CMD curl --fail http://127.0.0.1:8080 || exit 1\n","originalDockerfile":"#  ---------------------------------------------------------------------------\n#  See the NOTICE file distributed with this work for additional\n#  information regarding copyright ownership.\n#\n#  This is free software; you can redistribute it and/or modify it\n#  under the terms of the GNU Lesser General Public License as\n#  published by the Free Software Foundation; either version 2.1 of\n#  the License, or (at your option) any later version.\n#\n#  This software is distributed in the hope that it will be useful,\n#  but WITHOUT ANY WARRANTY; without even the implied warranty of\n#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n#  Lesser General Public License for more details.\n#\n#  You should have received a copy of the GNU Lesser General Public\n#  License along with this software; if not, write to the Free\n#  Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n#  02110-1301 USA, or see the FSF site: http://www.fsf.org.\n#  ---------------------------------------------------------------------------\nFROM tomcat:8-jdk8-slim\n#     ____  ____  ____      ____  _   __        _\n#    |_  _||_  _||_  _|    |_  _|(_) [  |  _   (_)\n#      \\ \\  / /    \\ \\  /\\  / /  __   | | / ]  __\n#       > `' <      \\ \\/  \\/ /  [  |  | '' <  [  |\n#     _/ /'`\\ \\_     \\  /\\  /    | |  | |`\\ \\  | |\n#    |____||____|     \\/  \\/    [___][__|  \\_][___]\nMAINTAINER Vincent Massol <vincent@massol.net>\n#  Note: when using docker-compose, the ENV values below are overridden from the .env file.\n#  Install LibreOffice + other tools\n#  Note that procps is required to get ps which is used by JODConverter to start LibreOffice\nRUN apt-get update \\\n && apt-get install --no-install-recommends curl libreoffice unzip procps libpostgresql-jdbc-java -y \\\n && rm -rf /var/lib/apt/lists/*\n#  Install XWiki as the ROOT webapp context in Tomcat\n#  Create the Tomcat temporary directory\n#  Configure the XWiki permanent directory\nENV XWIKI_VERSION=\"11.4\"\nENV XWIKI_URL_PREFIX=\"\\\"https://maven.xwiki.org/releases/org/xwiki/platform/xwiki-platform-distribution-war/${XWIKI_VERSION}\\\"\"\nENV XWIKI_DOWNLOAD_SHA256=\"8a0d83edd44b2a73c079bc43672c88c096e28b59e50a69dd37391d6789ba4670\"\nRUN rm -rf /usr/local/tomcat/webapps/* \\\n && mkdir -p /usr/local/tomcat/temp \\\n && mkdir -p /usr/local/xwiki/data \\\n && curl -fSL \"${XWIKI_URL_PREFIX}/xwiki-platform-distribution-war-${XWIKI_VERSION}.war\" -o xwiki.war \\\n && echo \"$XWIKI_DOWNLOAD_SHA256 xwiki.war\" | sha256sum -c - \\\n && unzip -d /usr/local/tomcat/webapps/ROOT xwiki.war \\\n && rm -f xwiki.war\n#  Copy the JDBC driver in the XWiki webapp\nRUN cp /usr/share/java/postgresql-jdbc4.jar /usr/local/tomcat/webapps/ROOT/WEB-INF/lib/\n#  Configure Tomcat. For example set the memory for the Tomcat JVM since the default value is too small for XWiki\nCOPY tomcat/setenv.sh /usr/local/tomcat/bin/\n#  Setup the XWiki Hibernate configuration\nCOPY xwiki/hibernate.cfg.xml /usr/local/tomcat/webapps/ROOT/WEB-INF/hibernate.cfg.xml\n#  Set a specific distribution id in XWiki for this docker packaging.\nRUN sed -i 's/<id>org.xwiki.platform:xwiki-platform-distribution-war/<id>org.xwiki.platform:xwiki-platform-distribution-docker/' /usr/local/tomcat/webapps/ROOT/META-INF/extension.xed\n#  Add scripts required to make changes to XWiki configuration files at execution time\n#  Note: we don't run CHMOD since 1) it's not required since the executabe bit is already set in git and 2) running\n#  CHMOD after a COPY will sometimes fail, depending on different host-specific factors (especially on AUFS).\nCOPY xwiki/docker-entrypoint.sh /usr/local/bin/docker-entrypoint.sh\n#  Make the XWiki directory (the permanent directory is included in it) persist on the host (so that it's not recreated\n#  across runs)\nVOLUME /usr/local/xwiki\n#  At this point the image is done and what remains below are the runtime configuration used by the user to configure\n#  the container that will be created out of the image. Namely the user can override some environment variables with\n#    docker run -e \"var1=val1\" -e \"var2=val2\" ...\n#  The supported environment variables that can be overridden are:\n#  - DB_USER: the name of the user configured for XWiki in the DB. Default is \"xwiki\". This is used to configure\n#             xwiki's hibernate.cfg.xml file.\n#  - DB_PASSWORD: the password for the user configured for XWiki in the DB. Default is \"xwiki\". This is used to\n#                 configure xwiki's hibernate.cfg.xml file.\n#  - DB_DATABASE: the name of the database to use. Default is \"xwiki\". This is used to configure xwiki's\n#                 hibernate.cfg.xml file.\n#  - DB_HOST: The name of the host (or docker container) containing the database. Default is \"db\". This is used to\n#             configure xwiki's hibernate.cfg.xml file.\n#  Example:\n#    docker run -it -e \"DB_USER=xwiki\" -e \"DB_PASSWORD=xwiki\" <imagename>\n#  Starts XWiki by starting Tomcat. All options passed to \"docker run [OPTIONS] IMAGE[:TAG|@DIGEST] [COMMAND] [ARG...]\"\n#  are also passed to docker-entrypoint.sh. If \"xwiki\" is passed then XWiki will be configured the first time the\n#  container executes and Tomcat will be started. If some other parameter is passed then it'll be executed to comply\n#  with best practices defined at https://github.com/docker-library/official-images#consistency.\nENTRYPOINT [\"docker-entrypoint.sh\"]\nCMD [\"xwiki\"]\n","injectedSmells":[],"originalDockerfileHash":"f3045589ca587ebfd96d8884b5cae4cc","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   ---------------------------------------------------------------------------\n#   See the NOTICE file distributed with this work for additional\n#   information regarding copyright ownership.\n#\n#   This is free software; you can redistribute it and/or modify it\n#   under the terms of the GNU Lesser General Public License as\n#   published by the Free Software Foundation; either version 2.1 of\n#   the License, or (at your option) any later version.\n#\n#   This software is distributed in the hope that it will be useful,\n#   but WITHOUT ANY WARRANTY; without even the implied warranty of\n#   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n#   Lesser General Public License for more details.\n#\n#   You should have received a copy of the GNU Lesser General Public\n#   License along with this software; if not, write to the Free\n#   Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n#   02110-1301 USA, or see the FSF site: http://www.fsf.org.\n#   ---------------------------------------------------------------------------\nFROM tomcat:8-jdk8-slim\n#      ____  ____  ____      ____  _   __        _\n#     |_  _||_  _||_  _|    |_  _|(_) [  |  _   (_)\n#       \\ \\  / /    \\ \\  /\\  / /  __   | | / ]  __\n#        > `' <      \\ \\/  \\/ /  [  |  | '' <  [  |\n#      _/ /'`\\ \\_     \\  /\\  /    | |  | |`\\ \\  | |\n#     |____||____|     \\/  \\/    [___][__|  \\_][___]\nMAINTAINER Vincent Massol <vincent@massol.net>\n#   Note: when using docker-compose, the ENV values below are overridden from the .env file.\n#   Install LibreOffice + other tools\n#   Note that procps is required to get ps which is used by JODConverter to start LibreOffice\nRUN apt-get update \\\n && apt-get install --no-install-recommends curl libreoffice unzip procps libpostgresql-jdbc-java -y \\\n && rm -rf /var/lib/apt/lists/*\n#   Install XWiki as the ROOT webapp context in Tomcat\n#   Create the Tomcat temporary directory\n#   Configure the XWiki permanent directory\nENV XWIKI_VERSION=\"11.4\"\nENV XWIKI_URL_PREFIX=\"\\\"https://maven.xwiki.org/releases/org/xwiki/platform/xwiki-platform-distribution-war/${XWIKI_VERSION}\\\"\"\nENV XWIKI_DOWNLOAD_SHA256=\"8a0d83edd44b2a73c079bc43672c88c096e28b59e50a69dd37391d6789ba4670\"\nRUN rm -rf /usr/local/tomcat/webapps/* \\\n && mkdir -p /usr/local/tomcat/temp \\\n && mkdir -p /usr/local/xwiki/data \\\n && curl -fSL \"${XWIKI_URL_PREFIX}/xwiki-platform-distribution-war-${XWIKI_VERSION}.war\" -o xwiki.war \\\n && echo \"$XWIKI_DOWNLOAD_SHA256 xwiki.war\" | sha256sum -c - \\\n && unzip -d /usr/local/tomcat/webapps/ROOT xwiki.war \\\n && rm -f xwiki.war\n#   Copy the JDBC driver in the XWiki webapp\nRUN cp /usr/share/java/postgresql-jdbc4.jar /usr/local/tomcat/webapps/ROOT/WEB-INF/lib/\n#   Configure Tomcat. For example set the memory for the Tomcat JVM since the default value is too small for XWiki\nCOPY tomcat/setenv.sh /usr/local/tomcat/bin/\n#   Setup the XWiki Hibernate configuration\nCOPY xwiki/hibernate.cfg.xml /usr/local/tomcat/webapps/ROOT/WEB-INF/hibernate.cfg.xml\n#   Set a specific distribution id in XWiki for this docker packaging.\nRUN sed -i 's/<id>org.xwiki.platform:xwiki-platform-distribution-war/<id>org.xwiki.platform:xwiki-platform-distribution-docker/' /usr/local/tomcat/webapps/ROOT/META-INF/extension.xed\n#   Add scripts required to make changes to XWiki configuration files at execution time\n#   Note: we don't run CHMOD since 1) it's not required since the executabe bit is already set in git and 2) running\n#   CHMOD after a COPY will sometimes fail, depending on different host-specific factors (especially on AUFS).\nCOPY xwiki/docker-entrypoint.sh /usr/local/bin/docker-entrypoint.sh\n#   Make the XWiki directory (the permanent directory is included in it) persist on the host (so that it's not recreated\n#   across runs)\nVOLUME /usr/local/xwiki\n#   At this point the image is done and what remains below are the runtime configuration used by the user to configure\n#   the container that will be created out of the image. Namely the user can override some environment variables with\n#     docker run -e \"var1=val1\" -e \"var2=val2\" ...\n#   The supported environment variables that can be overridden are:\n#   - DB_USER: the name of the user configured for XWiki in the DB. Default is \"xwiki\". This is used to configure\n#              xwiki's hibernate.cfg.xml file.\n#   - DB_PASSWORD: the password for the user configured for XWiki in the DB. Default is \"xwiki\". This is used to\n#                  configure xwiki's hibernate.cfg.xml file.\n#   - DB_DATABASE: the name of the database to use. Default is \"xwiki\". This is used to configure xwiki's\n#                  hibernate.cfg.xml file.\n#   - DB_HOST: The name of the host (or docker container) containing the database. Default is \"db\". This is used to\n#              configure xwiki's hibernate.cfg.xml file.\n#   Example:\n#     docker run -it -e \"DB_USER=xwiki\" -e \"DB_PASSWORD=xwiki\" <imagename>\n#   Starts XWiki by starting Tomcat. All options passed to \"docker run [OPTIONS] IMAGE[:TAG|@DIGEST] [COMMAND] [ARG...]\"\n#   are also passed to docker-entrypoint.sh. If \"xwiki\" is passed then XWiki will be configured the first time the\n#   container executes and Tomcat will be started. If some other parameter is passed then it'll be executed to comply\n#   with best practices defined at https://github.com/docker-library/official-images#consistency.\nENTRYPOINT [\"docker-entrypoint.sh\"]\nCMD [\"xwiki\"]\n","originalDockerfileUglifiedHash":"7740a7d46ef30f907eb3f9e4888b7a6a","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/412f293cca98c85dadb045f92c8d0fa071b8da63.dockerfile"}