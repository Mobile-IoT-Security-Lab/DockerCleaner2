{"seed":3580491070,"processedDockerfileHash":"9c82ef2f5a64c770395fe807ecf88ed7","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","have-a-healthcheck","have-a-user"],"processedDockerfile":"#   This Source Code Form is subject to the terms of the Mozilla Public\n#   License, v. 2.0. If a copy of the MPL was not distributed with this\n#   file, You can obtain one at http://mozilla.org/MPL/2.0/.\nFROM ubuntu:18.04\nMAINTAINER Sebastian Kaspari \"skaspari@mozilla.com\"\n#  ----------------------------------------------------------------------------------------------------------------------\n#  -- Configuration -----------------------------------------------------------------------------------------------------\n#  ----------------------------------------------------------------------------------------------------------------------\nENV ANDROID_BUILD_TOOLS=\"\\\"28.0.3\\\"\"\nENV ANDROID_SDK_VERSION=\"\\\"3859397\\\"\"\nENV ANDROID_PLATFORM_VERSION=\"\\\"28\\\"\"\nENV PROJECT_REPOSITORY=\"\\\"https://github.com/mozilla-mobile/android-components.git\\\"\"\nENV GOOGLE_SDK_VERSION=\"233\"\nENV LANG=\"en_US.UTF-8\"\n#   Do not use fancy output on taskcluster\nENV TERM=\"dumb\"\nENV GRADLE_OPTS=\"-Xmx4096m -Dorg.gradle.daemon=false\"\n#   Used to detect in scripts whether we are running on taskcluster\nENV CI_TASKCLUSTER=\"true\"\n#  ----------------------------------------------------------------------------------------------------------------------\n#  -- System ------------------------------------------------------------------------------------------------------------\n#  ----------------------------------------------------------------------------------------------------------------------\nRUN apt-get update -qq \\\n && apt-get install --no-install-recommends tzdata=2022g-0ubuntu0.18.04 -y \\\n && apt-get install --no-install-recommends openjdk-8-jdk=8u362-ga-0ubuntu1~18.04.1 wget=1.19.4-1ubuntu2.2 expect=5.45.4-1 git=1:2.17.1-1ubuntu0.17 curl=7.58.0-2ubuntu3.24 python=2.7.15~rc1-1 python-pip=9.0.1-2.3~ubuntu1.18.04.8 locales=2.27-3ubuntu1.6 unzip=6.0-21ubuntu1.2 -y \\\n && apt-get clean\nRUN pip install pip==23.1 --upgrade\nRUN pip install 'taskcluster>=4,<5'\nRUN pip install arrow==1.2.3\nRUN pip install pyyaml==6.0\nRUN locale-gen en_US.UTF-8\n#  ----------------------------------------------------------------------------------------------------------------------\n#  -- Android -----------------------------------------------------------------------------------------------------------\n#  ----------------------------------------------------------------------------------------------------------------------\nRUN mkdir -p /build/android-sdk\nWORKDIR /build\nENV ANDROID_HOME=\"/build/android-sdk\"\nENV ANDROID_SDK_HOME=\"/build/android-sdk\"\nENV PATH=\"${PATH}:${ANDROID_SDK_HOME}/tools:${ANDROID_SDK_HOME}/tools/bin:${ANDROID_SDK_HOME}/platform-tools:/opt/tools:${ANDROID_SDK_HOME}/build-tools/${ANDROID_BUILD_TOOLS}\"\nRUN curl -L https://dl.google.com/android/repository/sdk-tools-linux-${ANDROID_SDK_VERSION}.zip > sdk.zip \\\n && unzip sdk.zip -d ${ANDROID_SDK_HOME} \\\n && rm sdk.zip \\\n && mkdir -p /build/android-sdk/.android/ \\\n && touch /build/android-sdk/.android/repositories.cfg \\\n && yes | sdkmanager --licenses\n#  ----------------------------------------------------------------------------------------------------------------------\n#  -- Test tools --------------------------------------------------------------------------------------------------------\n#  ----------------------------------------------------------------------------------------------------------------------\nRUN mkdir -p /build/test-tools\nWORKDIR /build\nENV TEST_TOOLS=\"/build/test-tools\"\nENV GOOGLE_SDK_DOWNLOAD=\"./gcloud.tar.gz\"\nENV PATH=\"${PATH}:${TEST_TOOLS}:${TEST_TOOLS}/google-cloud-sdk/bin\"\nRUN curl https://dl.google.com/dl/cloudsdk/channels/rapid/downloads/google-cloud-sdk-${GOOGLE_SDK_VERSION}.0.0-linux-x86_64.tar.gz --output ${GOOGLE_SDK_DOWNLOAD} \\\n && tar -xvf ${GOOGLE_SDK_DOWNLOAD} -C ${TEST_TOOLS} \\\n && rm -f ${GOOGLE_SDK_DOWNLOAD} \\\n && ${TEST_TOOLS}/google-cloud-sdk/install.sh --quiet \\\n && ${TEST_TOOLS}/google-cloud-sdk/bin/gcloud --quiet components update\nRUN URL_FLANK_BIN=$( curl -s \"https://api.github.com/repos/TestArmada/flank/releases/latest\" | grep \"browser_download_url*\" | sed -r \"s/\\\"//g\" | cut -d \":\" -f3 ;) \\\n && wget \"https:${URL_FLANK_BIN}\" -O ${TEST_TOOLS}/flank.jar \\\n && chmod +x ${TEST_TOOLS}/flank.jar\n#  ----------------------------------------------------------------------------------------------------------------------\n#  -- Project -----------------------------------------------------------------------------------------------------------\n#  ----------------------------------------------------------------------------------------------------------------------\nRUN git clone --depth=1 $PROJECT_REPOSITORY\nWORKDIR /build/android-components\nRUN ./gradlew clean \\\n && ./gradlew dependencies \\\n && ./gradlew androidDependencies \\\n && ./gradlew --stop \\\n && ./gradlew --no-daemon assemble \\\n && ./gradlew --no-daemon -Pcoverage test \\\n && ./gradlew --no-daemon detekt \\\n && ./gradlew --no-daemon ktlint \\\n && ./gradlew --no-daemon docs \\\n && ./gradlew clean\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  This Source Code Form is subject to the terms of the Mozilla Public\n#  License, v. 2.0. If a copy of the MPL was not distributed with this\n#  file, You can obtain one at http://mozilla.org/MPL/2.0/.\nFROM ubuntu:18.04\nMAINTAINER Sebastian Kaspari \"skaspari@mozilla.com\"\n# ----------------------------------------------------------------------------------------------------------------------\n# -- Configuration -----------------------------------------------------------------------------------------------------\n# ----------------------------------------------------------------------------------------------------------------------\nENV ANDROID_BUILD_TOOLS=\"\\\"28.0.3\\\"\"\nENV ANDROID_SDK_VERSION=\"\\\"3859397\\\"\"\nENV ANDROID_PLATFORM_VERSION=\"\\\"28\\\"\"\nENV PROJECT_REPOSITORY=\"\\\"https://github.com/mozilla-mobile/android-components.git\\\"\"\nENV GOOGLE_SDK_VERSION=\"233\"\nENV LANG=\"en_US.UTF-8\"\n#  Do not use fancy output on taskcluster\nENV TERM=\"dumb\"\nENV GRADLE_OPTS=\"-Xmx4096m -Dorg.gradle.daemon=false\"\n#  Used to detect in scripts whether we are running on taskcluster\nENV CI_TASKCLUSTER=\"true\"\n# ----------------------------------------------------------------------------------------------------------------------\n# -- System ------------------------------------------------------------------------------------------------------------\n# ----------------------------------------------------------------------------------------------------------------------\nRUN apt-get update -qq \\\n && apt-get install tzdata -y \\\n && apt-get install openjdk-8-jdk wget expect git curl python python-pip locales unzip -y \\\n && apt-get clean\nRUN pip install pip --upgrade\nRUN pip install 'taskcluster>=4,<5'\nRUN pip install arrow\nRUN pip install pyyaml\nRUN locale-gen en_US.UTF-8\n# ----------------------------------------------------------------------------------------------------------------------\n# -- Android -----------------------------------------------------------------------------------------------------------\n# ----------------------------------------------------------------------------------------------------------------------\nRUN mkdir -p /build/android-sdk\nWORKDIR /build\nENV ANDROID_HOME=\"/build/android-sdk\"\nENV ANDROID_SDK_HOME=\"/build/android-sdk\"\nENV PATH=\"${PATH}:${ANDROID_SDK_HOME}/tools:${ANDROID_SDK_HOME}/tools/bin:${ANDROID_SDK_HOME}/platform-tools:/opt/tools:${ANDROID_SDK_HOME}/build-tools/${ANDROID_BUILD_TOOLS}\"\nRUN curl -L https://dl.google.com/android/repository/sdk-tools-linux-${ANDROID_SDK_VERSION}.zip > sdk.zip \\\n && unzip sdk.zip -d ${ANDROID_SDK_HOME} \\\n && rm sdk.zip \\\n && mkdir -p /build/android-sdk/.android/ \\\n && touch /build/android-sdk/.android/repositories.cfg \\\n && yes | sdkmanager --licenses\n# ----------------------------------------------------------------------------------------------------------------------\n# -- Test tools --------------------------------------------------------------------------------------------------------\n# ----------------------------------------------------------------------------------------------------------------------\nRUN mkdir -p /build/test-tools\nWORKDIR /build\nENV TEST_TOOLS=\"/build/test-tools\"\nENV GOOGLE_SDK_DOWNLOAD=\"./gcloud.tar.gz\"\nENV PATH=\"${PATH}:${TEST_TOOLS}:${TEST_TOOLS}/google-cloud-sdk/bin\"\nRUN curl https://dl.google.com/dl/cloudsdk/channels/rapid/downloads/google-cloud-sdk-${GOOGLE_SDK_VERSION}.0.0-linux-x86_64.tar.gz --output ${GOOGLE_SDK_DOWNLOAD} \\\n && tar -xvf ${GOOGLE_SDK_DOWNLOAD} -C ${TEST_TOOLS} \\\n && rm -f ${GOOGLE_SDK_DOWNLOAD} \\\n && ${TEST_TOOLS}/google-cloud-sdk/install.sh --quiet \\\n && ${TEST_TOOLS}/google-cloud-sdk/bin/gcloud --quiet components update\nRUN URL_FLANK_BIN=$( curl -s \"https://api.github.com/repos/TestArmada/flank/releases/latest\" | grep \"browser_download_url*\" | sed -r \"s/\\\"//g\" | cut -d \":\" -f3 ;) \\\n && wget \"https:${URL_FLANK_BIN}\" -O ${TEST_TOOLS}/flank.jar \\\n && chmod +x ${TEST_TOOLS}/flank.jar\n# ----------------------------------------------------------------------------------------------------------------------\n# -- Project -----------------------------------------------------------------------------------------------------------\n# ----------------------------------------------------------------------------------------------------------------------\nRUN git clone --depth=1 $PROJECT_REPOSITORY\nWORKDIR /build/android-components\nRUN ./gradlew clean \\\n && ./gradlew dependencies \\\n && ./gradlew androidDependencies \\\n && ./gradlew --stop \\\n && ./gradlew --no-daemon assemble \\\n && ./gradlew --no-daemon -Pcoverage test \\\n && ./gradlew --no-daemon detekt \\\n && ./gradlew --no-daemon ktlint \\\n && ./gradlew --no-daemon docs \\\n && ./gradlew clean\n","injectedSmells":[],"originalDockerfileHash":"e1593bdaf4f1fa2d97d4e891d569f53e","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   This Source Code Form is subject to the terms of the Mozilla Public\n#   License, v. 2.0. If a copy of the MPL was not distributed with this\n#   file, You can obtain one at http://mozilla.org/MPL/2.0/.\nFROM ubuntu:18.04\nMAINTAINER Sebastian Kaspari \"skaspari@mozilla.com\"\n#  ----------------------------------------------------------------------------------------------------------------------\n#  -- Configuration -----------------------------------------------------------------------------------------------------\n#  ----------------------------------------------------------------------------------------------------------------------\nENV ANDROID_BUILD_TOOLS=\"\\\"28.0.3\\\"\"\nENV ANDROID_SDK_VERSION=\"\\\"3859397\\\"\"\nENV ANDROID_PLATFORM_VERSION=\"\\\"28\\\"\"\nENV PROJECT_REPOSITORY=\"\\\"https://github.com/mozilla-mobile/android-components.git\\\"\"\nENV GOOGLE_SDK_VERSION=\"233\"\nENV LANG=\"en_US.UTF-8\"\n#   Do not use fancy output on taskcluster\nENV TERM=\"dumb\"\nENV GRADLE_OPTS=\"-Xmx4096m -Dorg.gradle.daemon=false\"\n#   Used to detect in scripts whether we are running on taskcluster\nENV CI_TASKCLUSTER=\"true\"\n#  ----------------------------------------------------------------------------------------------------------------------\n#  -- System ------------------------------------------------------------------------------------------------------------\n#  ----------------------------------------------------------------------------------------------------------------------\nRUN apt-get update -qq \\\n && apt-get install tzdata -y \\\n && apt-get install openjdk-8-jdk wget expect git curl python python-pip locales unzip -y \\\n && apt-get clean\nRUN pip install pip --upgrade\nRUN pip install 'taskcluster>=4,<5'\nRUN pip install arrow\nRUN pip install pyyaml\nRUN locale-gen en_US.UTF-8\n#  ----------------------------------------------------------------------------------------------------------------------\n#  -- Android -----------------------------------------------------------------------------------------------------------\n#  ----------------------------------------------------------------------------------------------------------------------\nRUN mkdir -p /build/android-sdk\nWORKDIR /build\nENV ANDROID_HOME=\"/build/android-sdk\"\nENV ANDROID_SDK_HOME=\"/build/android-sdk\"\nENV PATH=\"${PATH}:${ANDROID_SDK_HOME}/tools:${ANDROID_SDK_HOME}/tools/bin:${ANDROID_SDK_HOME}/platform-tools:/opt/tools:${ANDROID_SDK_HOME}/build-tools/${ANDROID_BUILD_TOOLS}\"\nRUN curl -L https://dl.google.com/android/repository/sdk-tools-linux-${ANDROID_SDK_VERSION}.zip > sdk.zip \\\n && unzip sdk.zip -d ${ANDROID_SDK_HOME} \\\n && rm sdk.zip \\\n && mkdir -p /build/android-sdk/.android/ \\\n && touch /build/android-sdk/.android/repositories.cfg \\\n && yes | sdkmanager --licenses\n#  ----------------------------------------------------------------------------------------------------------------------\n#  -- Test tools --------------------------------------------------------------------------------------------------------\n#  ----------------------------------------------------------------------------------------------------------------------\nRUN mkdir -p /build/test-tools\nWORKDIR /build\nENV TEST_TOOLS=\"/build/test-tools\"\nENV GOOGLE_SDK_DOWNLOAD=\"./gcloud.tar.gz\"\nENV PATH=\"${PATH}:${TEST_TOOLS}:${TEST_TOOLS}/google-cloud-sdk/bin\"\nRUN curl https://dl.google.com/dl/cloudsdk/channels/rapid/downloads/google-cloud-sdk-${GOOGLE_SDK_VERSION}.0.0-linux-x86_64.tar.gz --output ${GOOGLE_SDK_DOWNLOAD} \\\n && tar -xvf ${GOOGLE_SDK_DOWNLOAD} -C ${TEST_TOOLS} \\\n && rm -f ${GOOGLE_SDK_DOWNLOAD} \\\n && ${TEST_TOOLS}/google-cloud-sdk/install.sh --quiet \\\n && ${TEST_TOOLS}/google-cloud-sdk/bin/gcloud --quiet components update\nRUN URL_FLANK_BIN=$( curl -s \"https://api.github.com/repos/TestArmada/flank/releases/latest\" | grep \"browser_download_url*\" | sed -r \"s/\\\"//g\" | cut -d \":\" -f3 ;) \\\n && wget \"https:${URL_FLANK_BIN}\" -O ${TEST_TOOLS}/flank.jar \\\n && chmod +x ${TEST_TOOLS}/flank.jar\n#  ----------------------------------------------------------------------------------------------------------------------\n#  -- Project -----------------------------------------------------------------------------------------------------------\n#  ----------------------------------------------------------------------------------------------------------------------\nRUN git clone --depth=1 $PROJECT_REPOSITORY\nWORKDIR /build/android-components\nRUN ./gradlew clean \\\n && ./gradlew dependencies \\\n && ./gradlew androidDependencies \\\n && ./gradlew --stop \\\n && ./gradlew --no-daemon assemble \\\n && ./gradlew --no-daemon -Pcoverage test \\\n && ./gradlew --no-daemon detekt \\\n && ./gradlew --no-daemon ktlint \\\n && ./gradlew --no-daemon docs \\\n && ./gradlew clean\n","originalDockerfileUglifiedHash":"3e17f4add7e7845b3753f00775fd910e","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/98e60e18a5b7d9c75c16a0331cf0aadf7d4c1f4b.dockerfile"}