{"seed":2208963534,"processedDockerfileHash":"0d79c1d72d8605993f3fd76d5eeac2eb","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM php:7.1.13-fpm\nRUN echo \"Europe/Tallinn\" > /etc/timezone \\\n && dpkg-reconfigure -f noninteractive tzdata\nRUN apt-get update \\\n && apt-get install --no-install-recommends nano cron libfreetype6-dev libjpeg62-turbo-dev libpng12-dev libssl-dev libxml2-dev libpq-dev libcurl4-openssl-dev libmcrypt-dev libbz2-dev libpspell-dev libldap2-dev libedit-dev libreadline-dev libc-client-dev libkrb5-dev libmemcached-dev zlib1g-dev ssmtp mysql-client wget unzip imagemagick libmagickwand-dev libmagickcore-dev git -y \\\n && rm -rf /var/lib/apt/lists/*\nRUN docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ --with-png-dir==/usr/include/ \\\n && docker-php-ext-install gd\nRUN docker-php-ext-configure exif \\\n && docker-php-ext-install exif\nRUN docker-php-ext-configure ftp \\\n && docker-php-ext-install ftp\nRUN docker-php-ext-configure bcmath \\\n && docker-php-ext-install bcmath\nRUN docker-php-ext-configure sockets \\\n && docker-php-ext-install sockets\nRUN docker-php-ext-configure soap \\\n && docker-php-ext-install soap\nRUN docker-php-ext-configure calendar \\\n && docker-php-ext-install calendar\nRUN docker-php-ext-configure mbstring \\\n && docker-php-ext-install mbstring\nRUN docker-php-ext-configure pgsql \\\n && docker-php-ext-install pgsql\nRUN docker-php-ext-configure mysqli \\\n && docker-php-ext-install mysqli\nRUN docker-php-ext-configure pdo \\\n && docker-php-ext-install pdo pdo_pgsql pdo_mysql\nRUN docker-php-ext-configure curl \\\n && docker-php-ext-install curl\nRUN docker-php-ext-configure hash \\\n && docker-php-ext-install hash\nRUN docker-php-ext-configure mcrypt \\\n && docker-php-ext-install mcrypt\nRUN docker-php-ext-configure iconv \\\n && docker-php-ext-install iconv\nRUN docker-php-ext-configure bz2 \\\n && docker-php-ext-install bz2\nRUN docker-php-ext-configure gettext \\\n && docker-php-ext-install gettext\nRUN docker-php-ext-configure pspell \\\n && docker-php-ext-install pspell\nRUN docker-php-ext-configure readline \\\n && docker-php-ext-install readline\nRUN docker-php-ext-configure imap --with-kerberos --with-imap-ssl \\\n && docker-php-ext-install imap\nRUN docker-php-ext-configure zip \\\n && docker-php-ext-install zip\nRUN docker-php-ext-install opcache \\\n && docker-php-ext-enable opcache\nRUN docker-php-ext-configure openssl ; exit 0 \\\n && cp /usr/src/php/ext/openssl/config0.m4 /usr/src/php/ext/openssl/config.m4 \\\n && docker-php-ext-install openssl\nRUN docker-php-ext-configure zlib ; exit 0 \\\n && cp /usr/src/php/ext/zlib/config0.m4 /usr/src/php/ext/zlib/config.m4 \\\n && docker-php-ext-install zlib\nRUN ln -s /usr/lib/x86_64-linux-gnu/libldap.so /usr/lib/libldap.so \\\n && docker-php-ext-configure ldap \\\n && docker-php-ext-install ldap\nRUN pear install pecl/xdebug-2.5.5 \\\n && docker-php-ext-enable xdebug\nRUN pear install pecl/memcached-3.0.3 \\\n && docker-php-ext-enable memcached\nRUN pear install pecl/redis-3.1.3 \\\n && docker-php-ext-enable redis\nRUN pear install pecl/imagick-3.4.3 \\\n && docker-php-ext-enable imagick\nRUN version=$( php -r \"echo PHP_MAJOR_VERSION.PHP_MINOR_VERSION;\" ;) \\\n && curl -A \"Docker\" -o /tmp/blackfire-probe.tar.gz -D - -L -s https://blackfire.io/api/v1/releases/probe/php/linux/amd64/$version \\\n && tar zxpf /tmp/blackfire-probe.tar.gz -C /tmp \\\n && mv /tmp/blackfire-*.so $( php -r \"echo ini_get('extension_dir');\" ;)/blackfire.so \\\n && printf \"extension=blackfire.so\\nblackfire.agent_socket=tcp://blackfire:8707\\n\" > $PHP_INI_DIR/conf.d/blackfire.ini\nRUN git clone https://github.com/Jan-E/uploadprogress.git /tmp/php-uploadprogress \\\n && cd /tmp/php-uploadprogress \\\n && phpize \\\n && ./configure --prefix=/usr \\\n && make \\\n && make install \\\n && echo 'extension=uploadprogress.so' > $PHP_INI_DIR/conf.d/uploadprogress.ini \\\n && rm -rf /tmp/*\nRUN php -r \"copy('https://getcomposer.org/installer', 'composer-setup.php');\" \\\n && php composer-setup.php \\\n && php -r \"unlink('composer-setup.php');\" \\\n && mv composer.phar /usr/local/bin/composer \\\n && chmod +x /usr/local/bin/composer\nCOPY ./src/entrypoint.sh /\nCOPY ./src/etc/mysql/my.cnf /etc/mysql/my.cnf\nRUN chmod 644 /etc/mysql/my.cnf\nCOPY ./src/etc/ssmtp/ssmtp.conf /etc/ssmtp/ssmtp.conf\nCOPY ./src/etc/cron.d/drupalstack /etc/cron.d/drupalstack\nCOPY ./src/usr/local/etc/php/php.ini /usr/local/etc/php/php.ini\nCOPY ./src/etc/bash.bashrc /etc/bash.bashrc\nCOPY ./src/etc/bash.bashrc /etc/skel/.bashrc\n#   Give execution rights on the cron job\nRUN chmod 0644 /etc/cron.d/drupalstack\nWORKDIR /usr/local/apache2/htdocs\nENTRYPOINT [\"/entrypoint.sh\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\n","originalDockerfile":"FROM php:7.1.13-fpm\nRUN echo \"Europe/Tallinn\" > /etc/timezone \\\n && dpkg-reconfigure -f noninteractive tzdata\nRUN apt-get update \\\n && apt-get install nano cron libfreetype6-dev libjpeg62-turbo-dev libpng12-dev libssl-dev libxml2-dev libpq-dev libcurl4-openssl-dev libmcrypt-dev libbz2-dev libpspell-dev libldap2-dev libedit-dev libreadline-dev libc-client-dev libkrb5-dev libmemcached-dev zlib1g-dev ssmtp mysql-client wget unzip imagemagick libmagickwand-dev libmagickcore-dev git -y \\\n && rm -rf /var/lib/apt/lists/*\nRUN docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ --with-png-dir==/usr/include/ \\\n && docker-php-ext-install gd\nRUN docker-php-ext-configure exif \\\n && docker-php-ext-install exif\nRUN docker-php-ext-configure ftp \\\n && docker-php-ext-install ftp\nRUN docker-php-ext-configure bcmath \\\n && docker-php-ext-install bcmath\nRUN docker-php-ext-configure sockets \\\n && docker-php-ext-install sockets\nRUN docker-php-ext-configure soap \\\n && docker-php-ext-install soap\nRUN docker-php-ext-configure calendar \\\n && docker-php-ext-install calendar\nRUN docker-php-ext-configure mbstring \\\n && docker-php-ext-install mbstring\nRUN docker-php-ext-configure pgsql \\\n && docker-php-ext-install pgsql\nRUN docker-php-ext-configure mysqli \\\n && docker-php-ext-install mysqli\nRUN docker-php-ext-configure pdo \\\n && docker-php-ext-install pdo pdo_pgsql pdo_mysql\nRUN docker-php-ext-configure curl \\\n && docker-php-ext-install curl\nRUN docker-php-ext-configure hash \\\n && docker-php-ext-install hash\nRUN docker-php-ext-configure mcrypt \\\n && docker-php-ext-install mcrypt\nRUN docker-php-ext-configure iconv \\\n && docker-php-ext-install iconv\nRUN docker-php-ext-configure bz2 \\\n && docker-php-ext-install bz2\nRUN docker-php-ext-configure gettext \\\n && docker-php-ext-install gettext\nRUN docker-php-ext-configure pspell \\\n && docker-php-ext-install pspell\nRUN docker-php-ext-configure readline \\\n && docker-php-ext-install readline\nRUN docker-php-ext-configure imap --with-kerberos --with-imap-ssl \\\n && docker-php-ext-install imap\nRUN docker-php-ext-configure zip \\\n && docker-php-ext-install zip\nRUN docker-php-ext-install opcache \\\n && docker-php-ext-enable opcache\nRUN docker-php-ext-configure openssl ; exit 0 \\\n && cp /usr/src/php/ext/openssl/config0.m4 /usr/src/php/ext/openssl/config.m4 \\\n && docker-php-ext-install openssl\nRUN docker-php-ext-configure zlib ; exit 0 \\\n && cp /usr/src/php/ext/zlib/config0.m4 /usr/src/php/ext/zlib/config.m4 \\\n && docker-php-ext-install zlib\nRUN ln -s /usr/lib/x86_64-linux-gnu/libldap.so /usr/lib/libldap.so \\\n && docker-php-ext-configure ldap \\\n && docker-php-ext-install ldap\nRUN pear install pecl/xdebug-2.5.5 \\\n && docker-php-ext-enable xdebug\nRUN pear install pecl/memcached-3.0.3 \\\n && docker-php-ext-enable memcached\nRUN pear install pecl/redis-3.1.3 \\\n && docker-php-ext-enable redis\nRUN pear install pecl/imagick-3.4.3 \\\n && docker-php-ext-enable imagick\nRUN version=$( php -r \"echo PHP_MAJOR_VERSION.PHP_MINOR_VERSION;\" ;) \\\n && curl -A \"Docker\" -o /tmp/blackfire-probe.tar.gz -D - -L -s https://blackfire.io/api/v1/releases/probe/php/linux/amd64/$version \\\n && tar zxpf /tmp/blackfire-probe.tar.gz -C /tmp \\\n && mv /tmp/blackfire-*.so $( php -r \"echo ini_get('extension_dir');\" ;)/blackfire.so \\\n && printf \"extension=blackfire.so\\nblackfire.agent_socket=tcp://blackfire:8707\\n\" > $PHP_INI_DIR/conf.d/blackfire.ini\nRUN git clone https://github.com/Jan-E/uploadprogress.git /tmp/php-uploadprogress \\\n && cd /tmp/php-uploadprogress \\\n && phpize \\\n && ./configure --prefix=/usr \\\n && make \\\n && make install \\\n && echo 'extension=uploadprogress.so' > $PHP_INI_DIR/conf.d/uploadprogress.ini \\\n && rm -rf /tmp/*\nRUN php -r \"copy('https://getcomposer.org/installer', 'composer-setup.php');\" \\\n && php composer-setup.php \\\n && php -r \"unlink('composer-setup.php');\" \\\n && mv composer.phar /usr/local/bin/composer \\\n && chmod +x /usr/local/bin/composer\nCOPY ./src/entrypoint.sh /\nCOPY ./src/etc/mysql/my.cnf /etc/mysql/my.cnf\nRUN chmod 644 /etc/mysql/my.cnf\nCOPY ./src/etc/ssmtp/ssmtp.conf /etc/ssmtp/ssmtp.conf\nCOPY ./src/etc/cron.d/drupalstack /etc/cron.d/drupalstack\nCOPY ./src/usr/local/etc/php/php.ini /usr/local/etc/php/php.ini\nCOPY ./src/etc/bash.bashrc /etc/bash.bashrc\nCOPY ./src/etc/bash.bashrc /etc/skel/.bashrc\n#  Give execution rights on the cron job\nRUN chmod 0644 /etc/cron.d/drupalstack\nWORKDIR /usr/local/apache2/htdocs\nENTRYPOINT [\"/entrypoint.sh\"]\n","injectedSmells":[],"originalDockerfileHash":"65f3417c75e3b5b4d4a3072c83aa1bce","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM php:7.1.13-fpm\nRUN echo \"Europe/Tallinn\" > /etc/timezone \\\n && dpkg-reconfigure -f noninteractive tzdata\nRUN apt-get update \\\n && apt-get install nano cron libfreetype6-dev libjpeg62-turbo-dev libpng12-dev libssl-dev libxml2-dev libpq-dev libcurl4-openssl-dev libmcrypt-dev libbz2-dev libpspell-dev libldap2-dev libedit-dev libreadline-dev libc-client-dev libkrb5-dev libmemcached-dev zlib1g-dev ssmtp mysql-client wget unzip imagemagick libmagickwand-dev libmagickcore-dev git -y \\\n && rm -rf /var/lib/apt/lists/*\nRUN docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ --with-png-dir==/usr/include/ \\\n && docker-php-ext-install gd\nRUN docker-php-ext-configure exif \\\n && docker-php-ext-install exif\nRUN docker-php-ext-configure ftp \\\n && docker-php-ext-install ftp\nRUN docker-php-ext-configure bcmath \\\n && docker-php-ext-install bcmath\nRUN docker-php-ext-configure sockets \\\n && docker-php-ext-install sockets\nRUN docker-php-ext-configure soap \\\n && docker-php-ext-install soap\nRUN docker-php-ext-configure calendar \\\n && docker-php-ext-install calendar\nRUN docker-php-ext-configure mbstring \\\n && docker-php-ext-install mbstring\nRUN docker-php-ext-configure pgsql \\\n && docker-php-ext-install pgsql\nRUN docker-php-ext-configure mysqli \\\n && docker-php-ext-install mysqli\nRUN docker-php-ext-configure pdo \\\n && docker-php-ext-install pdo pdo_pgsql pdo_mysql\nRUN docker-php-ext-configure curl \\\n && docker-php-ext-install curl\nRUN docker-php-ext-configure hash \\\n && docker-php-ext-install hash\nRUN docker-php-ext-configure mcrypt \\\n && docker-php-ext-install mcrypt\nRUN docker-php-ext-configure iconv \\\n && docker-php-ext-install iconv\nRUN docker-php-ext-configure bz2 \\\n && docker-php-ext-install bz2\nRUN docker-php-ext-configure gettext \\\n && docker-php-ext-install gettext\nRUN docker-php-ext-configure pspell \\\n && docker-php-ext-install pspell\nRUN docker-php-ext-configure readline \\\n && docker-php-ext-install readline\nRUN docker-php-ext-configure imap --with-kerberos --with-imap-ssl \\\n && docker-php-ext-install imap\nRUN docker-php-ext-configure zip \\\n && docker-php-ext-install zip\nRUN docker-php-ext-install opcache \\\n && docker-php-ext-enable opcache\nRUN docker-php-ext-configure openssl ; exit 0 \\\n && cp /usr/src/php/ext/openssl/config0.m4 /usr/src/php/ext/openssl/config.m4 \\\n && docker-php-ext-install openssl\nRUN docker-php-ext-configure zlib ; exit 0 \\\n && cp /usr/src/php/ext/zlib/config0.m4 /usr/src/php/ext/zlib/config.m4 \\\n && docker-php-ext-install zlib\nRUN ln -s /usr/lib/x86_64-linux-gnu/libldap.so /usr/lib/libldap.so \\\n && docker-php-ext-configure ldap \\\n && docker-php-ext-install ldap\nRUN pear install pecl/xdebug-2.5.5 \\\n && docker-php-ext-enable xdebug\nRUN pear install pecl/memcached-3.0.3 \\\n && docker-php-ext-enable memcached\nRUN pear install pecl/redis-3.1.3 \\\n && docker-php-ext-enable redis\nRUN pear install pecl/imagick-3.4.3 \\\n && docker-php-ext-enable imagick\nRUN version=$( php -r \"echo PHP_MAJOR_VERSION.PHP_MINOR_VERSION;\" ;) \\\n && curl -A \"Docker\" -o /tmp/blackfire-probe.tar.gz -D - -L -s https://blackfire.io/api/v1/releases/probe/php/linux/amd64/$version \\\n && tar zxpf /tmp/blackfire-probe.tar.gz -C /tmp \\\n && mv /tmp/blackfire-*.so $( php -r \"echo ini_get('extension_dir');\" ;)/blackfire.so \\\n && printf \"extension=blackfire.so\\nblackfire.agent_socket=tcp://blackfire:8707\\n\" > $PHP_INI_DIR/conf.d/blackfire.ini\nRUN git clone https://github.com/Jan-E/uploadprogress.git /tmp/php-uploadprogress \\\n && cd /tmp/php-uploadprogress \\\n && phpize \\\n && ./configure --prefix=/usr \\\n && make \\\n && make install \\\n && echo 'extension=uploadprogress.so' > $PHP_INI_DIR/conf.d/uploadprogress.ini \\\n && rm -rf /tmp/*\nRUN php -r \"copy('https://getcomposer.org/installer', 'composer-setup.php');\" \\\n && php composer-setup.php \\\n && php -r \"unlink('composer-setup.php');\" \\\n && mv composer.phar /usr/local/bin/composer \\\n && chmod +x /usr/local/bin/composer\nCOPY ./src/entrypoint.sh /\nCOPY ./src/etc/mysql/my.cnf /etc/mysql/my.cnf\nRUN chmod 644 /etc/mysql/my.cnf\nCOPY ./src/etc/ssmtp/ssmtp.conf /etc/ssmtp/ssmtp.conf\nCOPY ./src/etc/cron.d/drupalstack /etc/cron.d/drupalstack\nCOPY ./src/usr/local/etc/php/php.ini /usr/local/etc/php/php.ini\nCOPY ./src/etc/bash.bashrc /etc/bash.bashrc\nCOPY ./src/etc/bash.bashrc /etc/skel/.bashrc\n#   Give execution rights on the cron job\nRUN chmod 0644 /etc/cron.d/drupalstack\nWORKDIR /usr/local/apache2/htdocs\nENTRYPOINT [\"/entrypoint.sh\"]\n","originalDockerfileUglifiedHash":"302915f7b9eafe0a9099aa13bf3280de","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/8cf7923ee44e842fafaf64b5c49ddfb06bbe4c0f.dockerfile"}