{"seed":3765843157,"processedDockerfileHash":"0c581074f21aa63b4ace11c3fe10bf21","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM perl:5.20\nMAINTAINER MacArthur Lab\n#   install commmon utilities\nRUN apt-get update \\\n && apt-get install --no-install-recommends apt-utils bzip2 cmake curl emacs g++ git htop less nano wget xterm -y --fix-missing\n#   install jdk-8 for running hail locally\nRUN echo deb http://ppa.launchpad.net/webupd8team/java/ubuntu trusty main >> /etc/apt/sources.list.d/java-8-debian.list\nRUN echo deb-src http://ppa.launchpad.net/webupd8team/java/ubuntu trusty main >> /etc/apt/sources.list.d/java-8-debian.list\nRUN echo debconf shared/accepted-oracle-license-v1-1 select true | debconf-set-selections\nRUN echo debconf shared/accepted-oracle-license-v1-1 seen true | debconf-set-selections\nRUN apt-key adv --keyserver keyserver.ubuntu.com --recv-keys EEA14886 \\\n && apt-get update \\\n && apt-get install --no-install-recommends oracle-java8-installer -y \\\n && apt-get install --no-install-recommends oracle-java8-set-default -y\n#   install python and gcloud utils\nRUN apt-get install --no-install-recommends python-dev -y \\\n && wget https://bootstrap.pypa.io/get-pip.py \\\n && python get-pip.py \\\n && pip install setuptools==67.6.1 --upgrade\nRUN CLOUDSDK_CORE_DISABLE_PROMPTS=1 \\\n && curl https://sdk.cloud.google.com | bash \\\n && apt-get install --no-install-recommends lsb gcc python-dev python-setuptools libffi-dev libssl-dev -y \\\n && pip install gsutil==5.23\nRUN CLOUDSDK_CORE_DISABLE_PROMPTS=1 \\\n && CLOUD_SDK_REPO=\"cloud-sdk-$( lsb_release -c -s ;)\" \\\n && echo \"deb http://packages.cloud.google.com/apt $CLOUD_SDK_REPO main\" > /etc/apt/sources.list.d/google-cloud-sdk.list \\\n && curl https://packages.cloud.google.com/apt/doc/apt-key.gpg | apt-key add - \\\n && apt-get update \\\n && apt-get install --no-install-recommends google-cloud-sdk -y\nRUN curl -LO https://storage.googleapis.com/kubernetes-release/release/$( curl -s https://storage.googleapis.com/kubernetes-release/release/stable.txt ;)/bin/linux/amd64/kubectl \\\n && chmod +x ./kubectl \\\n && mv ./kubectl /usr/local/bin/kubectl\n#   install google storage connector which allows hail to access vds in google buckets without downloading them first\nRUN cd /usr/local \\\n && wget -nv https://archive.apache.org/dist/spark/spark-2.0.2/spark-2.0.2-bin-hadoop2.7.tgz \\\n && tar xzf /usr/local/spark-2.0.2-bin-hadoop2.7.tgz\n#   fix http://discuss.hail.is/t/importerror-cannot-import-name-getargspec/468\nRUN pip install decorator==4.2.1\n#   install jupyter\nRUN pip install pip==23.1 jupyter==1.0.0 --upgrade\n#  RUN git clone --branch 0.1 https://github.com/broadinstitute/hail.git \\\n#      && cd /hail \\\n#      && ./gradlew -Dspark.version=2.0.2 shadowJar archiveZip\n#   install picard\n#  RUN mkdir /picard \\\n#      && cd /picard \\\n#      && wget https://github.com/broadinstitute/picard/releases/download/2.15.0/picard.jar\n#   download LiftoverChain files\n#  RUN mkdir -p /reference-data \\\n#      && cd /reference-data \\\n#      && wget http://hgdownload.cse.ucsc.edu/goldenPath/hg38/bigZips/hg38.fa.gz \\\n#      && wget http://hgdownload.cse.ucsc.edu/goldenPath/hg19/liftOver/hg19ToHg38.over.chain.gz\n#   download and install VEP - steps based on gs://hail-common/vep/vep/GRCh37/vep85-GRCh37-init.sh and gs://hail-common/vep/vep/GRCh38/vep85-GRCh38-init.sh\nRUN gsutil -m cp gs://hail-common/vep/htslib/* /usr/bin/ \\\n && gsutil -m cp gs://hail-common/vep/samtools /usr/bin/ \\\n && chmod a+rx /usr/bin/tabix /usr/bin/bgzip /usr/bin/htsfile /usr/bin/samtools\nRUN wget https://raw.github.com/miyagawa/cpanminus/master/cpanm -O /usr/bin/cpanm \\\n && chmod +x /usr/bin/cpanm\n#   VEP dependencies\nRUN /usr/bin/cpanm --notest Set::IntervalTree\nRUN /usr/bin/cpanm --notest PerlIO::gzip\nRUN /usr/bin/cpanm --notest DBI\nRUN /usr/bin/cpanm --notest CGI\nRUN /usr/bin/cpanm --notest JSON\n#   LoFTEE dependencies\nRUN /usr/bin/cpanm --notest DBD::SQLite\nRUN /usr/bin/cpanm --notest List::MoreUtils\n#   DISABLE_CACHE work-around to force git pull on every docker build, based on https://github.com/docker/docker/issues/1996\nARG DISABLE_CACHE=1\n#   clone hail-elasticsearch-pipelines\nRUN git clone https://github.com/macarthur-lab/hail-elasticsearch-pipelines.git /hail-elasticsearch-pipelines\n#   copy hail build\nRUN mkdir -p /hail/build/libs /hail/build/distributions \\\n && cp /hail-elasticsearch-pipelines/hail_builds/v01/hail-v01-10-8-2018-90c855449.zip /hail/build/distributions/hail-python.zip \\\n && cp /hail-elasticsearch-pipelines/hail_builds/v01/hail-v01-10-8-2018-90c855449.jar /hail/build/libs/hail-all-spark.jar \\\n && cp /hail-elasticsearch-pipelines/hail_builds/v01/gcs-connector-1.6.10-hadoop2.jar /usr/local/spark-2.0.2-bin-hadoop2.7/jars/\nENV TERM=\"xterm\"\nENV PYTHONPATH=\"$PYTHONPATH:/seqr:/seqr_settings:/hail-elasticsearch-pipelines\"\nCOPY config/gitconfig /root/.gitconfig\nCOPY bashrc /root/.bashrc\nCOPY config/run_hail_locally.sh /hail-elasticsearch-pipelines\nCOPY config/run_hail_on_dataproc.sh /hail-elasticsearch-pipelines\nCOPY config/core-site.xml /usr/local/spark-2.0.2-bin-hadoop2.7/conf/\nCOPY entrypoint.sh /\nWORKDIR /hail-elasticsearch-pipelines\nCMD [\"/entrypoint.sh\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM perl:5.20\nMAINTAINER MacArthur Lab\n#  install commmon utilities\nRUN apt-get update \\\n && apt-get install apt-utils bzip2 cmake curl emacs g++ git htop less nano wget xterm -y --fix-missing\n#  install jdk-8 for running hail locally\nRUN echo deb http://ppa.launchpad.net/webupd8team/java/ubuntu trusty main >> /etc/apt/sources.list.d/java-8-debian.list\nRUN echo deb-src http://ppa.launchpad.net/webupd8team/java/ubuntu trusty main >> /etc/apt/sources.list.d/java-8-debian.list\nRUN echo debconf shared/accepted-oracle-license-v1-1 select true | debconf-set-selections\nRUN echo debconf shared/accepted-oracle-license-v1-1 seen true | debconf-set-selections\nRUN apt-key adv --keyserver keyserver.ubuntu.com --recv-keys EEA14886 \\\n && apt-get update \\\n && apt-get install oracle-java8-installer -y \\\n && apt-get install oracle-java8-set-default -y\n#  install python and gcloud utils\nRUN apt-get install python-dev -y \\\n && wget https://bootstrap.pypa.io/get-pip.py \\\n && python get-pip.py \\\n && pip install setuptools --upgrade\nRUN CLOUDSDK_CORE_DISABLE_PROMPTS=1 \\\n && curl https://sdk.cloud.google.com | bash \\\n && apt-get install lsb gcc python-dev python-setuptools libffi-dev libssl-dev -y \\\n && pip install gsutil\nRUN CLOUDSDK_CORE_DISABLE_PROMPTS=1 \\\n && CLOUD_SDK_REPO=\"cloud-sdk-$( lsb_release -c -s ;)\" \\\n && echo \"deb http://packages.cloud.google.com/apt $CLOUD_SDK_REPO main\" > /etc/apt/sources.list.d/google-cloud-sdk.list \\\n && curl https://packages.cloud.google.com/apt/doc/apt-key.gpg | apt-key add - \\\n && apt-get update \\\n && apt-get install google-cloud-sdk -y\nRUN curl -LO https://storage.googleapis.com/kubernetes-release/release/$( curl -s https://storage.googleapis.com/kubernetes-release/release/stable.txt ;)/bin/linux/amd64/kubectl \\\n && chmod +x ./kubectl \\\n && mv ./kubectl /usr/local/bin/kubectl\n#  install google storage connector which allows hail to access vds in google buckets without downloading them first\nRUN cd /usr/local \\\n && wget -nv https://archive.apache.org/dist/spark/spark-2.0.2/spark-2.0.2-bin-hadoop2.7.tgz \\\n && tar xzf /usr/local/spark-2.0.2-bin-hadoop2.7.tgz\n#  fix http://discuss.hail.is/t/importerror-cannot-import-name-getargspec/468\nRUN pip install decorator==4.2.1\n#  install jupyter\nRUN pip install pip jupyter --upgrade\n# RUN git clone --branch 0.1 https://github.com/broadinstitute/hail.git \\\n#     && cd /hail \\\n#     && ./gradlew -Dspark.version=2.0.2 shadowJar archiveZip\n#  install picard\n# RUN mkdir /picard \\\n#     && cd /picard \\\n#     && wget https://github.com/broadinstitute/picard/releases/download/2.15.0/picard.jar\n#  download LiftoverChain files\n# RUN mkdir -p /reference-data \\\n#     && cd /reference-data \\\n#     && wget http://hgdownload.cse.ucsc.edu/goldenPath/hg38/bigZips/hg38.fa.gz \\\n#     && wget http://hgdownload.cse.ucsc.edu/goldenPath/hg19/liftOver/hg19ToHg38.over.chain.gz\n#  download and install VEP - steps based on gs://hail-common/vep/vep/GRCh37/vep85-GRCh37-init.sh and gs://hail-common/vep/vep/GRCh38/vep85-GRCh38-init.sh\nRUN gsutil -m cp gs://hail-common/vep/htslib/* /usr/bin/ \\\n && gsutil -m cp gs://hail-common/vep/samtools /usr/bin/ \\\n && chmod a+rx /usr/bin/tabix /usr/bin/bgzip /usr/bin/htsfile /usr/bin/samtools\nRUN wget https://raw.github.com/miyagawa/cpanminus/master/cpanm -O /usr/bin/cpanm \\\n && chmod +x /usr/bin/cpanm\n#  VEP dependencies\nRUN /usr/bin/cpanm --notest Set::IntervalTree\nRUN /usr/bin/cpanm --notest PerlIO::gzip\nRUN /usr/bin/cpanm --notest DBI\nRUN /usr/bin/cpanm --notest CGI\nRUN /usr/bin/cpanm --notest JSON\n#  LoFTEE dependencies\nRUN /usr/bin/cpanm --notest DBD::SQLite\nRUN /usr/bin/cpanm --notest List::MoreUtils\n#  DISABLE_CACHE work-around to force git pull on every docker build, based on https://github.com/docker/docker/issues/1996\nARG DISABLE_CACHE=1\n#  clone hail-elasticsearch-pipelines\nRUN git clone https://github.com/macarthur-lab/hail-elasticsearch-pipelines.git /hail-elasticsearch-pipelines\n#  copy hail build\nRUN mkdir -p /hail/build/libs /hail/build/distributions \\\n && cp /hail-elasticsearch-pipelines/hail_builds/v01/hail-v01-10-8-2018-90c855449.zip /hail/build/distributions/hail-python.zip \\\n && cp /hail-elasticsearch-pipelines/hail_builds/v01/hail-v01-10-8-2018-90c855449.jar /hail/build/libs/hail-all-spark.jar \\\n && cp /hail-elasticsearch-pipelines/hail_builds/v01/gcs-connector-1.6.10-hadoop2.jar /usr/local/spark-2.0.2-bin-hadoop2.7/jars/\nENV TERM=\"xterm\"\nENV PYTHONPATH=\"$PYTHONPATH:/seqr:/seqr_settings:/hail-elasticsearch-pipelines\"\nCOPY config/gitconfig /root/.gitconfig\nCOPY bashrc /root/.bashrc\nCOPY config/run_hail_locally.sh /hail-elasticsearch-pipelines\nCOPY config/run_hail_on_dataproc.sh /hail-elasticsearch-pipelines\nCOPY config/core-site.xml /usr/local/spark-2.0.2-bin-hadoop2.7/conf/\nCOPY entrypoint.sh /\nWORKDIR /hail-elasticsearch-pipelines\nCMD [\"/entrypoint.sh\"]\n","injectedSmells":[],"originalDockerfileHash":"b4861768bdccfb502c80c9fde07634d5","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM perl:5.20\nMAINTAINER MacArthur Lab\n#   install commmon utilities\nRUN apt-get update \\\n && apt-get install apt-utils bzip2 cmake curl emacs g++ git htop less nano wget xterm -y --fix-missing\n#   install jdk-8 for running hail locally\nRUN echo deb http://ppa.launchpad.net/webupd8team/java/ubuntu trusty main >> /etc/apt/sources.list.d/java-8-debian.list\nRUN echo deb-src http://ppa.launchpad.net/webupd8team/java/ubuntu trusty main >> /etc/apt/sources.list.d/java-8-debian.list\nRUN echo debconf shared/accepted-oracle-license-v1-1 select true | debconf-set-selections\nRUN echo debconf shared/accepted-oracle-license-v1-1 seen true | debconf-set-selections\nRUN apt-key adv --keyserver keyserver.ubuntu.com --recv-keys EEA14886 \\\n && apt-get update \\\n && apt-get install oracle-java8-installer -y \\\n && apt-get install oracle-java8-set-default -y\n#   install python and gcloud utils\nRUN apt-get install python-dev -y \\\n && wget https://bootstrap.pypa.io/get-pip.py \\\n && python get-pip.py \\\n && pip install setuptools --upgrade\nRUN CLOUDSDK_CORE_DISABLE_PROMPTS=1 \\\n && curl https://sdk.cloud.google.com | bash \\\n && apt-get install lsb gcc python-dev python-setuptools libffi-dev libssl-dev -y \\\n && pip install gsutil\nRUN CLOUDSDK_CORE_DISABLE_PROMPTS=1 \\\n && CLOUD_SDK_REPO=\"cloud-sdk-$( lsb_release -c -s ;)\" \\\n && echo \"deb http://packages.cloud.google.com/apt $CLOUD_SDK_REPO main\" > /etc/apt/sources.list.d/google-cloud-sdk.list \\\n && curl https://packages.cloud.google.com/apt/doc/apt-key.gpg | apt-key add - \\\n && apt-get update \\\n && apt-get install google-cloud-sdk -y\nRUN curl -LO https://storage.googleapis.com/kubernetes-release/release/$( curl -s https://storage.googleapis.com/kubernetes-release/release/stable.txt ;)/bin/linux/amd64/kubectl \\\n && chmod +x ./kubectl \\\n && mv ./kubectl /usr/local/bin/kubectl\n#   install google storage connector which allows hail to access vds in google buckets without downloading them first\nRUN cd /usr/local \\\n && wget -nv https://archive.apache.org/dist/spark/spark-2.0.2/spark-2.0.2-bin-hadoop2.7.tgz \\\n && tar xzf /usr/local/spark-2.0.2-bin-hadoop2.7.tgz\n#   fix http://discuss.hail.is/t/importerror-cannot-import-name-getargspec/468\nRUN pip install decorator==4.2.1\n#   install jupyter\nRUN pip install pip jupyter --upgrade\n#  RUN git clone --branch 0.1 https://github.com/broadinstitute/hail.git \\\n#      && cd /hail \\\n#      && ./gradlew -Dspark.version=2.0.2 shadowJar archiveZip\n#   install picard\n#  RUN mkdir /picard \\\n#      && cd /picard \\\n#      && wget https://github.com/broadinstitute/picard/releases/download/2.15.0/picard.jar\n#   download LiftoverChain files\n#  RUN mkdir -p /reference-data \\\n#      && cd /reference-data \\\n#      && wget http://hgdownload.cse.ucsc.edu/goldenPath/hg38/bigZips/hg38.fa.gz \\\n#      && wget http://hgdownload.cse.ucsc.edu/goldenPath/hg19/liftOver/hg19ToHg38.over.chain.gz\n#   download and install VEP - steps based on gs://hail-common/vep/vep/GRCh37/vep85-GRCh37-init.sh and gs://hail-common/vep/vep/GRCh38/vep85-GRCh38-init.sh\nRUN gsutil -m cp gs://hail-common/vep/htslib/* /usr/bin/ \\\n && gsutil -m cp gs://hail-common/vep/samtools /usr/bin/ \\\n && chmod a+rx /usr/bin/tabix /usr/bin/bgzip /usr/bin/htsfile /usr/bin/samtools\nRUN wget https://raw.github.com/miyagawa/cpanminus/master/cpanm -O /usr/bin/cpanm \\\n && chmod +x /usr/bin/cpanm\n#   VEP dependencies\nRUN /usr/bin/cpanm --notest Set::IntervalTree\nRUN /usr/bin/cpanm --notest PerlIO::gzip\nRUN /usr/bin/cpanm --notest DBI\nRUN /usr/bin/cpanm --notest CGI\nRUN /usr/bin/cpanm --notest JSON\n#   LoFTEE dependencies\nRUN /usr/bin/cpanm --notest DBD::SQLite\nRUN /usr/bin/cpanm --notest List::MoreUtils\n#   DISABLE_CACHE work-around to force git pull on every docker build, based on https://github.com/docker/docker/issues/1996\nARG DISABLE_CACHE=1\n#   clone hail-elasticsearch-pipelines\nRUN git clone https://github.com/macarthur-lab/hail-elasticsearch-pipelines.git /hail-elasticsearch-pipelines\n#   copy hail build\nRUN mkdir -p /hail/build/libs /hail/build/distributions \\\n && cp /hail-elasticsearch-pipelines/hail_builds/v01/hail-v01-10-8-2018-90c855449.zip /hail/build/distributions/hail-python.zip \\\n && cp /hail-elasticsearch-pipelines/hail_builds/v01/hail-v01-10-8-2018-90c855449.jar /hail/build/libs/hail-all-spark.jar \\\n && cp /hail-elasticsearch-pipelines/hail_builds/v01/gcs-connector-1.6.10-hadoop2.jar /usr/local/spark-2.0.2-bin-hadoop2.7/jars/\nENV TERM=\"xterm\"\nENV PYTHONPATH=\"$PYTHONPATH:/seqr:/seqr_settings:/hail-elasticsearch-pipelines\"\nCOPY config/gitconfig /root/.gitconfig\nCOPY bashrc /root/.bashrc\nCOPY config/run_hail_locally.sh /hail-elasticsearch-pipelines\nCOPY config/run_hail_on_dataproc.sh /hail-elasticsearch-pipelines\nCOPY config/core-site.xml /usr/local/spark-2.0.2-bin-hadoop2.7/conf/\nCOPY entrypoint.sh /\nWORKDIR /hail-elasticsearch-pipelines\nCMD [\"/entrypoint.sh\"]\n","originalDockerfileUglifiedHash":"cb7c6734fe5de3194b50633ee1afbd45","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/5b2b80b1a0c2175cff3a657b5529495bcc57fd51.dockerfile"}