{"seed":2946848356,"processedDockerfileHash":"e117e21e801b6a681419addb5a16d95f","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM google/debian:jessie\n#   Set the default timezone to EST.\nENV TZ=\"America/New_York\"\nRUN echo $TZ | tee /etc/timezone \\\n && dpkg-reconfigure --frontend noninteractive tzdata\n#   Add all the image files to the root.\nCOPY infra/docker/db/files /\n#   TODO(skeswa): probably don't need to cleanup this early.\n#   Install Java 8 and clean up after.\nRUN mv /java.list /etc/apt/sources.list.d/java.list \\\n && apt-get update \\\n && apt-get install --no-install-recommends procps openjdk-8-jre-headless libjemalloc1 curl localepurge -qq -y \\\n && curl -L https://github.com/Yelp/dumb-init/releases/download/v1.0.3/dumb-init_1.0.3_amd64 > /dumb-init \\\n && chmod a+rx /dumb-init \\\n && apt-get -y purge localepurge curl \\\n && apt-get clean \\\n && rm -rf doc man info locale /var/lib/apt/lists/* /var/log/* /var/cache/debconf/* common-licenses ~/.bashrc /etc/systemd /lib/lsb /lib/udev /usr/share/doc/ /usr/share/doc-base/ /usr/share/man/ /tmp/*\n#   Configure env. before installing Cassandra.\nENV DEBUG=\"true\"\nENV CASSANDRA_SERVICE=\"db-svc\"\nENV CASSANDRA_CLUSTER_NAME=\"gophr-cassandra-cluster\"\nENV CASSANDRA_AUTO_BOOTSTRAP=\"false\"\nENV LOCAL_JMX=\"no\"\n#   Install Cassandra and clean up after.\nRUN mv /cassandra.list /etc/apt/sources.list.d/cassandra.list \\\n && gpg --keyserver pgp.mit.edu --recv-keys F758CE318D77295D \\\n && gpg --export --armor F758CE318D77295D | apt-key add - \\\n && gpg --keyserver pgp.mit.edu --recv-keys 2B5C1B00 \\\n && gpg --export --armor 2B5C1B00 | apt-key add - \\\n && gpg --keyserver pgp.mit.edu --recv-keys 0353B12C \\\n && gpg --export --armor 0353B12C | apt-key add - \\\n && apt-get update \\\n && apt-get install --no-install-recommends curl cassandra localepurge -qq -y \\\n && chmod a+rx /run.sh /dumb-init /ready-probe.sh \\\n && mkdir -p /cassandra_data/data \\\n && mv /logback.xml /cassandra.yaml /etc/cassandra/ \\\n && find /usr/share/cassandra/lib/sigar-bin -type f | grep -v libsigar-x86-linux.so | xargs rm \\\n && apt-get -y purge curl localepurge \\\n && apt-get clean \\\n && rm -rf doc man info locale /var/lib/apt/lists/* /var/log/* /var/cache/debconf/* common-licenses ~/.bashrc /etc/systemd /lib/lsb /lib/udev /usr/share/doc/ /usr/share/doc-base/ /usr/share/man/ /tmp/*\n#   Install the Lucene plugin.\nRUN mv /cassandra-lucene-plugin-3.7.1/* /usr/share/cassandra/lib/ \\\n && rm -rf /cassandra-lucene-plugin-3.7.1\n#   https://issues.apache.org/jira/browse/CASSANDRA-11661\nRUN sed -ri 's/^(JVM_PATCH_VERSION)=.*/\\1=25/' /etc/cassandra/cassandra-env.sh\nVOLUME [\"/cassandra_data/data\"]\n#   7000: intra-node communication\n#   7001: TLS intra-node communication\n#   7199: JMX\n#   9042: CQL\n#   9160: thrift service not included cause it is going away\nEXPOSE 7000/tcp 7001/tcp 7199/tcp 9042/tcp\n#   Not able to do this until https://github.com/kubernetes/kubernetes/issues/2630 is resolved\n#   if you are using attached storage\n#   USER cassandra\nCMD [\"/dumb-init\", \"/bin/bash\", \"/run.sh\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM google/debian:jessie\n#  Set the default timezone to EST.\nENV TZ=\"America/New_York\"\nRUN echo $TZ | tee /etc/timezone \\\n && dpkg-reconfigure --frontend noninteractive tzdata\n#  Add all the image files to the root.\nADD infra/docker/db/files /\n#  TODO(skeswa): probably don't need to cleanup this early.\n#  Install Java 8 and clean up after.\nRUN mv /java.list /etc/apt/sources.list.d/java.list \\\n && apt-get update \\\n && apt-get install --no-install-recommends procps openjdk-8-jre-headless libjemalloc1 curl localepurge -qq -y \\\n && curl -L https://github.com/Yelp/dumb-init/releases/download/v1.0.3/dumb-init_1.0.3_amd64 > /dumb-init \\\n && chmod a+rx /dumb-init \\\n && apt-get -y purge localepurge curl \\\n && apt-get clean \\\n && rm -rf doc man info locale /var/lib/apt/lists/* /var/log/* /var/cache/debconf/* common-licenses ~/.bashrc /etc/systemd /lib/lsb /lib/udev /usr/share/doc/ /usr/share/doc-base/ /usr/share/man/ /tmp/*\n#  Configure env. before installing Cassandra.\nENV DEBUG=\"true\"\nENV CASSANDRA_SERVICE=\"db-svc\"\nENV CASSANDRA_CLUSTER_NAME=\"gophr-cassandra-cluster\"\nENV CASSANDRA_AUTO_BOOTSTRAP=\"false\"\nENV LOCAL_JMX=\"no\"\n#  Install Cassandra and clean up after.\nRUN mv /cassandra.list /etc/apt/sources.list.d/cassandra.list \\\n && gpg --keyserver pgp.mit.edu --recv-keys F758CE318D77295D \\\n && gpg --export --armor F758CE318D77295D | apt-key add - \\\n && gpg --keyserver pgp.mit.edu --recv-keys 2B5C1B00 \\\n && gpg --export --armor 2B5C1B00 | apt-key add - \\\n && gpg --keyserver pgp.mit.edu --recv-keys 0353B12C \\\n && gpg --export --armor 0353B12C | apt-key add - \\\n && apt-get update \\\n && apt-get install --no-install-recommends curl cassandra localepurge -qq -y \\\n && chmod a+rx /run.sh /dumb-init /ready-probe.sh \\\n && mkdir -p /cassandra_data/data \\\n && mv /logback.xml /cassandra.yaml /etc/cassandra/ \\\n && find /usr/share/cassandra/lib/sigar-bin -type f | grep -v libsigar-x86-linux.so | xargs rm \\\n && apt-get -y purge curl localepurge \\\n && apt-get clean \\\n && rm -rf doc man info locale /var/lib/apt/lists/* /var/log/* /var/cache/debconf/* common-licenses ~/.bashrc /etc/systemd /lib/lsb /lib/udev /usr/share/doc/ /usr/share/doc-base/ /usr/share/man/ /tmp/*\n#  Install the Lucene plugin.\nRUN mv /cassandra-lucene-plugin-3.7.1/* /usr/share/cassandra/lib/ \\\n && rm -rf /cassandra-lucene-plugin-3.7.1\n#  https://issues.apache.org/jira/browse/CASSANDRA-11661\nRUN sed -ri 's/^(JVM_PATCH_VERSION)=.*/\\1=25/' /etc/cassandra/cassandra-env.sh\nVOLUME [\"/cassandra_data/data\"]\n#  7000: intra-node communication\n#  7001: TLS intra-node communication\n#  7199: JMX\n#  9042: CQL\n#  9160: thrift service not included cause it is going away\nEXPOSE 7000/tcp 7001/tcp 7199/tcp 9042/tcp\n#  Not able to do this until https://github.com/kubernetes/kubernetes/issues/2630 is resolved\n#  if you are using attached storage\n#  USER cassandra\nCMD [\"/dumb-init\", \"/bin/bash\", \"/run.sh\"]\n","injectedSmells":[],"originalDockerfileHash":"43ae63307256b3fd7a1ba392afa55664","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM google/debian:jessie\n#   Set the default timezone to EST.\nENV TZ=\"America/New_York\"\nRUN echo $TZ | tee /etc/timezone \\\n && dpkg-reconfigure --frontend noninteractive tzdata\n#   Add all the image files to the root.\nADD infra/docker/db/files /\n#   TODO(skeswa): probably don't need to cleanup this early.\n#   Install Java 8 and clean up after.\nRUN mv /java.list /etc/apt/sources.list.d/java.list \\\n && apt-get update \\\n && apt-get install --no-install-recommends procps openjdk-8-jre-headless libjemalloc1 curl localepurge -qq -y \\\n && curl -L https://github.com/Yelp/dumb-init/releases/download/v1.0.3/dumb-init_1.0.3_amd64 > /dumb-init \\\n && chmod a+rx /dumb-init \\\n && apt-get -y purge localepurge curl \\\n && apt-get clean \\\n && rm -rf doc man info locale /var/lib/apt/lists/* /var/log/* /var/cache/debconf/* common-licenses ~/.bashrc /etc/systemd /lib/lsb /lib/udev /usr/share/doc/ /usr/share/doc-base/ /usr/share/man/ /tmp/*\n#   Configure env. before installing Cassandra.\nENV DEBUG=\"true\"\nENV CASSANDRA_SERVICE=\"db-svc\"\nENV CASSANDRA_CLUSTER_NAME=\"gophr-cassandra-cluster\"\nENV CASSANDRA_AUTO_BOOTSTRAP=\"false\"\nENV LOCAL_JMX=\"no\"\n#   Install Cassandra and clean up after.\nRUN mv /cassandra.list /etc/apt/sources.list.d/cassandra.list \\\n && gpg --keyserver pgp.mit.edu --recv-keys F758CE318D77295D \\\n && gpg --export --armor F758CE318D77295D | apt-key add - \\\n && gpg --keyserver pgp.mit.edu --recv-keys 2B5C1B00 \\\n && gpg --export --armor 2B5C1B00 | apt-key add - \\\n && gpg --keyserver pgp.mit.edu --recv-keys 0353B12C \\\n && gpg --export --armor 0353B12C | apt-key add - \\\n && apt-get update \\\n && apt-get install --no-install-recommends curl cassandra localepurge -qq -y \\\n && chmod a+rx /run.sh /dumb-init /ready-probe.sh \\\n && mkdir -p /cassandra_data/data \\\n && mv /logback.xml /cassandra.yaml /etc/cassandra/ \\\n && find /usr/share/cassandra/lib/sigar-bin -type f | grep -v libsigar-x86-linux.so | xargs rm \\\n && apt-get -y purge curl localepurge \\\n && apt-get clean \\\n && rm -rf doc man info locale /var/lib/apt/lists/* /var/log/* /var/cache/debconf/* common-licenses ~/.bashrc /etc/systemd /lib/lsb /lib/udev /usr/share/doc/ /usr/share/doc-base/ /usr/share/man/ /tmp/*\n#   Install the Lucene plugin.\nRUN mv /cassandra-lucene-plugin-3.7.1/* /usr/share/cassandra/lib/ \\\n && rm -rf /cassandra-lucene-plugin-3.7.1\n#   https://issues.apache.org/jira/browse/CASSANDRA-11661\nRUN sed -ri 's/^(JVM_PATCH_VERSION)=.*/\\1=25/' /etc/cassandra/cassandra-env.sh\nVOLUME [\"/cassandra_data/data\"]\n#   7000: intra-node communication\n#   7001: TLS intra-node communication\n#   7199: JMX\n#   9042: CQL\n#   9160: thrift service not included cause it is going away\nEXPOSE 7000/tcp 7001/tcp 7199/tcp 9042/tcp\n#   Not able to do this until https://github.com/kubernetes/kubernetes/issues/2630 is resolved\n#   if you are using attached storage\n#   USER cassandra\nCMD [\"/dumb-init\", \"/bin/bash\", \"/run.sh\"]\n","originalDockerfileUglifiedHash":"f8e3301e2b3623632aaebd27829fcafe","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/f8010279ca7d7a075a175b810a60f209cdd1326e.dockerfile"}