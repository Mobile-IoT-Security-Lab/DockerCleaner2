{"seed":2260843886,"processedDockerfileHash":"018392abce209fe76e251faa3f0b8ca9","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM php:5.6-apache\nRUN a2enmod rewrite\n#   Install the PHP extensions we need, and other packages\nRUN set -ex \\\n && apt-get update \\\n && apt-get install --no-install-recommends curl jq less libjpeg-dev libmemcached-dev libpng12-dev nfs-common unzip -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && pecl install memcached-2.2.0 \\\n && docker-php-ext-configure gd --with-png-dir=/usr --with-jpeg-dir=/usr \\\n && docker-php-ext-install gd mysqli opcache \\\n && docker-php-ext-enable memcached \\\n && { echo 'opcache.memory_consumption=128' ;echo 'opcache.interned_strings_buffer=8' ;echo 'opcache.max_accelerated_files=4000' ;echo 'opcache.revalidate_freq=60' ;echo 'opcache.fast_shutdown=1' ;echo 'opcache.enable_cli=1' ; } > /usr/local/etc/php/conf.d/opcache-recommended.ini\n#   The our helper/glue scripts and configuration for this specific app\nCOPY bin /usr/local/bin\nCOPY etc /etc\n#   Add Containerpilot and its configuration\n#   Releases at https://github.com/joyent/containerpilot/releases\nENV CONTAINERPILOT_VER=\"2.7.3\"\nENV CONTAINERPILOT=\"file:///etc/containerpilot.json\"\nRUN set -ex \\\n && export CONTAINERPILOT_CHECKSUM=2511fdfed9c6826481a9048e8d34158e1d7728bf \\\n && curl --retry 7 --fail -Lso /tmp/containerpilot.tar.gz \"https://github.com/joyent/containerpilot/releases/download/${CONTAINERPILOT_VER}/containerpilot-${CONTAINERPILOT_VER}.tar.gz\" \\\n && echo \"${CONTAINERPILOT_CHECKSUM} /tmp/containerpilot.tar.gz\" | sha1sum -c \\\n && tar zxf /tmp/containerpilot.tar.gz -C /usr/local/bin \\\n && rm /tmp/containerpilot.tar.gz\n#   Install Consul\n#   Releases at https://releases.hashicorp.com/consul\nRUN set -ex \\\n && export CONSUL_VERSION=0.7.5 \\\n && export CONSUL_CHECKSUM=40ce7175535551882ecdff21fdd276cef6eaab96be8a8260e0599fadb6f1f5b8 \\\n && curl --retry 7 --fail -vo /tmp/consul.zip \"https://releases.hashicorp.com/consul/${CONSUL_VERSION}/consul_${CONSUL_VERSION}_linux_amd64.zip\" \\\n && echo \"${CONSUL_CHECKSUM} /tmp/consul.zip\" | sha256sum -c \\\n && unzip /tmp/consul -d /usr/local/bin \\\n && rm /tmp/consul.zip \\\n && mkdir /config\n#   Install Consul template\n#   Releases at https://releases.hashicorp.com/consul-template/\nRUN set -ex \\\n && export CONSUL_TEMPLATE_VERSION=0.18.3 \\\n && export CONSUL_TEMPLATE_CHECKSUM=caf6018d7489d97d6cc2a1ac5f1cbd574c6db4cd61ed04b22b8db7b4bde64542 \\\n && curl --retry 7 --fail -Lso /tmp/consul-template.zip \"https://releases.hashicorp.com/consul-template/${CONSUL_TEMPLATE_VERSION}/consul-template_${CONSUL_TEMPLATE_VERSION}_linux_amd64.zip\" \\\n && echo \"${CONSUL_TEMPLATE_CHECKSUM} /tmp/consul-template.zip\" | sha256sum -c \\\n && unzip /tmp/consul-template.zip -d /usr/local/bin \\\n && rm /tmp/consul-template.zip\n#   Install wp-cli, http://wp-cli.org\nENV WP_CLI_CONFIG_PATH=\"/var/www/html/wp-cli.yml\"\nRUN set -ex \\\n && curl --retry 7 --fail -Ls -O https://raw.githubusercontent.com/wp-cli/builds/gh-pages/phar/wp-cli.phar \\\n && chmod +x wp-cli.phar \\\n && mv wp-cli.phar /usr/local/bin/wp \\\n && wp --info --allow-root\n#   Copy the WordPress skeleton from this repo into the container\n#   This includes any themes and/or plugins we've added to the content/themes and content/plugins directories.\nCOPY /var/www/html /var/www/html\nRUN chown -R www-data:www-data /var/www/html/*\n#   Install WordPress via wp-cli & move the default themes to our content dir\n#   Releases at https://core.svn.wordpress.org/tags/ and https://wordpress.org/news/category/releases/\nENV WORDPRESS_VERSION=\"4.7.5\"\nRUN set -ex \\\n && wp --allow-root core download --version=${WORDPRESS_VERSION} \\\n && mv /var/www/html/wordpress/wp-content/themes/* /var/www/html/content/themes/\n#   Install HyperDB, https://wordpress.org/plugins/hyperdb\n#   Releases at https://wordpress.org/plugins/hyperdb/developers/ , though no SHA1 fingerprints are published\nRUN set -ex \\\n && export HYPERDB_VERSION=1.1 \\\n && curl --retry 7 --fail -Ls -o /var/www/html/hyperdb.zip https://downloads.wordpress.org/plugin/hyperdb.${HYPERDB_VERSION}.zip \\\n && unzip hyperdb.zip \\\n && chown -R www-data:www-data /var/www/html/hyperdb \\\n && mv hyperdb/db.php /var/www/html/content/. \\\n && rm -rf /var/www/html/hyperdb.zip /var/www/html/hyperdb \\\n && touch /var/www/html/content/db-config.php\n#   Install ztollman's object-cache.php or object caching to memcached\nRUN set -ex \\\n && curl --retry 7 --fail -Ls -o /var/www/html/content/object-cache.php https://raw.githubusercontent.com/tollmanz/wordpress-pecl-memcached-object-cache/master/object-cache.php\n#   The volume is defined after we install everything\nVOLUME /var/www/html\nCMD [\"/usr/local/bin/containerpilot\", \"apache2-foreground\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\n","originalDockerfile":"FROM php:5.6-apache\nRUN a2enmod rewrite\n#  Install the PHP extensions we need, and other packages\nRUN set -ex \\\n && apt-get update \\\n && apt-get install --no-install-recommends curl jq less libjpeg-dev libmemcached-dev libpng12-dev nfs-common unzip -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && pecl install memcached-2.2.0 \\\n && docker-php-ext-configure gd --with-png-dir=/usr --with-jpeg-dir=/usr \\\n && docker-php-ext-install gd mysqli opcache \\\n && docker-php-ext-enable memcached \\\n && { echo 'opcache.memory_consumption=128' ;echo 'opcache.interned_strings_buffer=8' ;echo 'opcache.max_accelerated_files=4000' ;echo 'opcache.revalidate_freq=60' ;echo 'opcache.fast_shutdown=1' ;echo 'opcache.enable_cli=1' ; } > /usr/local/etc/php/conf.d/opcache-recommended.ini\n#  The our helper/glue scripts and configuration for this specific app\nCOPY bin /usr/local/bin\nCOPY etc /etc\n#  Add Containerpilot and its configuration\n#  Releases at https://github.com/joyent/containerpilot/releases\nENV CONTAINERPILOT_VER=\"2.7.3\"\nENV CONTAINERPILOT=\"file:///etc/containerpilot.json\"\nRUN set -ex \\\n && export CONTAINERPILOT_CHECKSUM=2511fdfed9c6826481a9048e8d34158e1d7728bf \\\n && curl --retry 7 --fail -Lso /tmp/containerpilot.tar.gz \"https://github.com/joyent/containerpilot/releases/download/${CONTAINERPILOT_VER}/containerpilot-${CONTAINERPILOT_VER}.tar.gz\" \\\n && echo \"${CONTAINERPILOT_CHECKSUM} /tmp/containerpilot.tar.gz\" | sha1sum -c \\\n && tar zxf /tmp/containerpilot.tar.gz -C /usr/local/bin \\\n && rm /tmp/containerpilot.tar.gz\n#  Install Consul\n#  Releases at https://releases.hashicorp.com/consul\nRUN set -ex \\\n && export CONSUL_VERSION=0.7.5 \\\n && export CONSUL_CHECKSUM=40ce7175535551882ecdff21fdd276cef6eaab96be8a8260e0599fadb6f1f5b8 \\\n && curl --retry 7 --fail -vo /tmp/consul.zip \"https://releases.hashicorp.com/consul/${CONSUL_VERSION}/consul_${CONSUL_VERSION}_linux_amd64.zip\" \\\n && echo \"${CONSUL_CHECKSUM} /tmp/consul.zip\" | sha256sum -c \\\n && unzip /tmp/consul -d /usr/local/bin \\\n && rm /tmp/consul.zip \\\n && mkdir /config\n#  Install Consul template\n#  Releases at https://releases.hashicorp.com/consul-template/\nRUN set -ex \\\n && export CONSUL_TEMPLATE_VERSION=0.18.3 \\\n && export CONSUL_TEMPLATE_CHECKSUM=caf6018d7489d97d6cc2a1ac5f1cbd574c6db4cd61ed04b22b8db7b4bde64542 \\\n && curl --retry 7 --fail -Lso /tmp/consul-template.zip \"https://releases.hashicorp.com/consul-template/${CONSUL_TEMPLATE_VERSION}/consul-template_${CONSUL_TEMPLATE_VERSION}_linux_amd64.zip\" \\\n && echo \"${CONSUL_TEMPLATE_CHECKSUM} /tmp/consul-template.zip\" | sha256sum -c \\\n && unzip /tmp/consul-template.zip -d /usr/local/bin \\\n && rm /tmp/consul-template.zip\n#  Install wp-cli, http://wp-cli.org\nENV WP_CLI_CONFIG_PATH=\"/var/www/html/wp-cli.yml\"\nRUN set -ex \\\n && curl --retry 7 --fail -Ls -O https://raw.githubusercontent.com/wp-cli/builds/gh-pages/phar/wp-cli.phar \\\n && chmod +x wp-cli.phar \\\n && mv wp-cli.phar /usr/local/bin/wp \\\n && wp --info --allow-root\n#  Copy the WordPress skeleton from this repo into the container\n#  This includes any themes and/or plugins we've added to the content/themes and content/plugins directories.\nCOPY /var/www/html /var/www/html\nRUN chown -R www-data:www-data /var/www/html/*\n#  Install WordPress via wp-cli & move the default themes to our content dir\n#  Releases at https://core.svn.wordpress.org/tags/ and https://wordpress.org/news/category/releases/\nENV WORDPRESS_VERSION=\"4.7.5\"\nRUN set -ex \\\n && wp --allow-root core download --version=${WORDPRESS_VERSION} \\\n && mv /var/www/html/wordpress/wp-content/themes/* /var/www/html/content/themes/\n#  Install HyperDB, https://wordpress.org/plugins/hyperdb\n#  Releases at https://wordpress.org/plugins/hyperdb/developers/ , though no SHA1 fingerprints are published\nRUN set -ex \\\n && export HYPERDB_VERSION=1.1 \\\n && curl --retry 7 --fail -Ls -o /var/www/html/hyperdb.zip https://downloads.wordpress.org/plugin/hyperdb.${HYPERDB_VERSION}.zip \\\n && unzip hyperdb.zip \\\n && chown -R www-data:www-data /var/www/html/hyperdb \\\n && mv hyperdb/db.php /var/www/html/content/. \\\n && rm -rf /var/www/html/hyperdb.zip /var/www/html/hyperdb \\\n && touch /var/www/html/content/db-config.php\n#  Install ztollman's object-cache.php or object caching to memcached\nRUN set -ex \\\n && curl --retry 7 --fail -Ls -o /var/www/html/content/object-cache.php https://raw.githubusercontent.com/tollmanz/wordpress-pecl-memcached-object-cache/master/object-cache.php\n#  The volume is defined after we install everything\nVOLUME /var/www/html\nCMD [\"/usr/local/bin/containerpilot\", \"apache2-foreground\"]\n","injectedSmells":[],"originalDockerfileHash":"cf974f4526dfb64475f7a1f686c1bd6e","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM php:5.6-apache\nRUN a2enmod rewrite\n#   Install the PHP extensions we need, and other packages\nRUN set -ex \\\n && apt-get update \\\n && apt-get install --no-install-recommends curl jq less libjpeg-dev libmemcached-dev libpng12-dev nfs-common unzip -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && pecl install memcached-2.2.0 \\\n && docker-php-ext-configure gd --with-png-dir=/usr --with-jpeg-dir=/usr \\\n && docker-php-ext-install gd mysqli opcache \\\n && docker-php-ext-enable memcached \\\n && { echo 'opcache.memory_consumption=128' ;echo 'opcache.interned_strings_buffer=8' ;echo 'opcache.max_accelerated_files=4000' ;echo 'opcache.revalidate_freq=60' ;echo 'opcache.fast_shutdown=1' ;echo 'opcache.enable_cli=1' ; } > /usr/local/etc/php/conf.d/opcache-recommended.ini\n#   The our helper/glue scripts and configuration for this specific app\nCOPY bin /usr/local/bin\nCOPY etc /etc\n#   Add Containerpilot and its configuration\n#   Releases at https://github.com/joyent/containerpilot/releases\nENV CONTAINERPILOT_VER=\"2.7.3\"\nENV CONTAINERPILOT=\"file:///etc/containerpilot.json\"\nRUN set -ex \\\n && export CONTAINERPILOT_CHECKSUM=2511fdfed9c6826481a9048e8d34158e1d7728bf \\\n && curl --retry 7 --fail -Lso /tmp/containerpilot.tar.gz \"https://github.com/joyent/containerpilot/releases/download/${CONTAINERPILOT_VER}/containerpilot-${CONTAINERPILOT_VER}.tar.gz\" \\\n && echo \"${CONTAINERPILOT_CHECKSUM} /tmp/containerpilot.tar.gz\" | sha1sum -c \\\n && tar zxf /tmp/containerpilot.tar.gz -C /usr/local/bin \\\n && rm /tmp/containerpilot.tar.gz\n#   Install Consul\n#   Releases at https://releases.hashicorp.com/consul\nRUN set -ex \\\n && export CONSUL_VERSION=0.7.5 \\\n && export CONSUL_CHECKSUM=40ce7175535551882ecdff21fdd276cef6eaab96be8a8260e0599fadb6f1f5b8 \\\n && curl --retry 7 --fail -vo /tmp/consul.zip \"https://releases.hashicorp.com/consul/${CONSUL_VERSION}/consul_${CONSUL_VERSION}_linux_amd64.zip\" \\\n && echo \"${CONSUL_CHECKSUM} /tmp/consul.zip\" | sha256sum -c \\\n && unzip /tmp/consul -d /usr/local/bin \\\n && rm /tmp/consul.zip \\\n && mkdir /config\n#   Install Consul template\n#   Releases at https://releases.hashicorp.com/consul-template/\nRUN set -ex \\\n && export CONSUL_TEMPLATE_VERSION=0.18.3 \\\n && export CONSUL_TEMPLATE_CHECKSUM=caf6018d7489d97d6cc2a1ac5f1cbd574c6db4cd61ed04b22b8db7b4bde64542 \\\n && curl --retry 7 --fail -Lso /tmp/consul-template.zip \"https://releases.hashicorp.com/consul-template/${CONSUL_TEMPLATE_VERSION}/consul-template_${CONSUL_TEMPLATE_VERSION}_linux_amd64.zip\" \\\n && echo \"${CONSUL_TEMPLATE_CHECKSUM} /tmp/consul-template.zip\" | sha256sum -c \\\n && unzip /tmp/consul-template.zip -d /usr/local/bin \\\n && rm /tmp/consul-template.zip\n#   Install wp-cli, http://wp-cli.org\nENV WP_CLI_CONFIG_PATH=\"/var/www/html/wp-cli.yml\"\nRUN set -ex \\\n && curl --retry 7 --fail -Ls -O https://raw.githubusercontent.com/wp-cli/builds/gh-pages/phar/wp-cli.phar \\\n && chmod +x wp-cli.phar \\\n && mv wp-cli.phar /usr/local/bin/wp \\\n && wp --info --allow-root\n#   Copy the WordPress skeleton from this repo into the container\n#   This includes any themes and/or plugins we've added to the content/themes and content/plugins directories.\nCOPY /var/www/html /var/www/html\nRUN chown -R www-data:www-data /var/www/html/*\n#   Install WordPress via wp-cli & move the default themes to our content dir\n#   Releases at https://core.svn.wordpress.org/tags/ and https://wordpress.org/news/category/releases/\nENV WORDPRESS_VERSION=\"4.7.5\"\nRUN set -ex \\\n && wp --allow-root core download --version=${WORDPRESS_VERSION} \\\n && mv /var/www/html/wordpress/wp-content/themes/* /var/www/html/content/themes/\n#   Install HyperDB, https://wordpress.org/plugins/hyperdb\n#   Releases at https://wordpress.org/plugins/hyperdb/developers/ , though no SHA1 fingerprints are published\nRUN set -ex \\\n && export HYPERDB_VERSION=1.1 \\\n && curl --retry 7 --fail -Ls -o /var/www/html/hyperdb.zip https://downloads.wordpress.org/plugin/hyperdb.${HYPERDB_VERSION}.zip \\\n && unzip hyperdb.zip \\\n && chown -R www-data:www-data /var/www/html/hyperdb \\\n && mv hyperdb/db.php /var/www/html/content/. \\\n && rm -rf /var/www/html/hyperdb.zip /var/www/html/hyperdb \\\n && touch /var/www/html/content/db-config.php\n#   Install ztollman's object-cache.php or object caching to memcached\nRUN set -ex \\\n && curl --retry 7 --fail -Ls -o /var/www/html/content/object-cache.php https://raw.githubusercontent.com/tollmanz/wordpress-pecl-memcached-object-cache/master/object-cache.php\n#   The volume is defined after we install everything\nVOLUME /var/www/html\nCMD [\"/usr/local/bin/containerpilot\", \"apache2-foreground\"]\n","originalDockerfileUglifiedHash":"0706e9f76854182c107ac48a39ff0202","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/a10f5380806455fa6ea2335aa4153076345d47ad.dockerfile"}