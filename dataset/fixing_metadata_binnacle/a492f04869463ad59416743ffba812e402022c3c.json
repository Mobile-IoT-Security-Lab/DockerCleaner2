{"seed":3905922657,"processedDockerfileHash":"d6d3e7423d0f6c73d2719ac755d1980b","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","pin-package-manager-versions-apt-get","pin-package-manager-versions-npm","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM debian:stretch\nRUN DEBIAN_FRONTEND=noninteractive bash -c 'echo -e \"deb http://deb.debian.org/debian stretch main contrib\\ndeb http://deb.debian.org/debian stretch-updates main\\ndeb http://security.debian.org/debian-security stretch/updates main\\ndeb http://ftp.debian.org/debian stretch-backports main\" > /etc/apt/sources.list&& apt-get -y update'\nRUN DEBIAN_FRONTEND=noninteractive bash -c \"until apt-get -q -y install apt-utils tzdata python python-dev wget unzip git locales apache2 postgresql libapache2-mod-xsendfile libffi-dev libffi6 gcc supervisor s3cmd make perl libinline-perl libparallel-forkmanager-perl autoconf automake libjpeg-dev zlib1g-dev libpq-dev logrotate nodejs cron libxml2 libxslt1.1 libxml2-dev libxslt1-dev libcurl4-openssl-dev libssl-dev redis-server rabbitmq-server libtool libtool-bin syslog-ng rsync curl mktemp dnsutils build-essential libsvm3 libsvm-dev liblinear3 liblinear-dev libzbar-dev libzbar0 libgs-dev default-libmysqlclient-dev libgmp-dev python-passlib libsasl2-dev libldap2-dev python3 exim4-daemon-heavy python3-venv python3-dev imagemagick pdftk pacpl pandoc texlive texlive-luatex texlive-latex-recommended texlive-latex-extra texlive-font-utils texlive-lang-cyrillic texlive-lang-french texlive-lang-italian texlive-lang-portuguese texlive-lang-german texlive-lang-european texlive-lang-spanish texlive-extra-utils poppler-utils libaudio-flac-header-perl libaudio-musepack-perl libmp3-tag-perl libogg-vorbis-header-pureperl-perl libvorbis-dev libcddb-perl libcddb-get-perl libmp3-tag-perl libaudio-scan-perl libaudio-flac-header-perl libav-tools tesseract-ocr tesseract-ocr-dev tesseract-ocr-afr tesseract-ocr-ara tesseract-ocr-aze tesseract-ocr-bel tesseract-ocr-ben tesseract-ocr-bul tesseract-ocr-cat tesseract-ocr-ces tesseract-ocr-chi-sim tesseract-ocr-chi-tra tesseract-ocr-chr tesseract-ocr-dan tesseract-ocr-deu tesseract-ocr-deu-frak tesseract-ocr-ell tesseract-ocr-eng tesseract-ocr-enm tesseract-ocr-epo tesseract-ocr-equ tesseract-ocr-est tesseract-ocr-eus tesseract-ocr-fin tesseract-ocr-fra tesseract-ocr-frk tesseract-ocr-frm tesseract-ocr-glg tesseract-ocr-grc tesseract-ocr-heb tesseract-ocr-hin tesseract-ocr-hrv tesseract-ocr-hun tesseract-ocr-ind tesseract-ocr-isl tesseract-ocr-ita tesseract-ocr-ita-old tesseract-ocr-jpn tesseract-ocr-kan tesseract-ocr-kor tesseract-ocr-lav tesseract-ocr-lit tesseract-ocr-mal tesseract-ocr-mkd tesseract-ocr-mlt tesseract-ocr-msa tesseract-ocr-nld tesseract-ocr-nor tesseract-ocr-osd tesseract-ocr-pol tesseract-ocr-por tesseract-ocr-ron tesseract-ocr-rus tesseract-ocr-slk tesseract-ocr-slk-frak tesseract-ocr-slv tesseract-ocr-spa tesseract-ocr-spa-old tesseract-ocr-sqi tesseract-ocr-srp tesseract-ocr-swa tesseract-ocr-swe tesseract-ocr-tam tesseract-ocr-tel tesseract-ocr-tgl tesseract-ocr-tha tesseract-ocr-tur tesseract-ocr-ukr tesseract-ocr-vie ttf-mscorefonts-installer fonts-ebgaramond-extra ghostscript ttf-liberation fonts-liberation cm-super qpdf; do sleep 5; done; apt-get -q -y install -t stretch-backports libreoffice &> /dev/null\"\nRUN DEBIAN_FRONTEND=noninteractive TERM=xterm cd /tmp \\\n && mkdir -p /etc/ssl/docassemble /usr/share/docassemble/local /usr/share/docassemble/local3.5 /usr/share/docassemble/certs /usr/share/docassemble/backup /usr/share/docassemble/config /usr/share/docassemble/webapp /usr/share/docassemble/files /var/www/.pip /var/www/.cache /usr/share/docassemble/log /tmp/docassemble /var/www/html/log \\\n && echo '{ \"args\": [\"--no-sandbox\"] }' > /var/www/puppeteer-config.json \\\n && chown -R www-data.www-data /var/www \\\n && chsh -s /bin/bash www-data \\\n && update-alternatives --install /usr/bin/node node /usr/bin/nodejs 10 \\\n && wget -qO- https://deb.nodesource.com/setup_6.x | bash - \\\n && apt-get install --no-install-recommends nodejs=4.8.2~dfsg-1 -y \\\n && npm install azure-storage-cmd@0.0.4 -g \\\n && npm install mermaid.cli@0.5.1 -g\nRUN DEBIAN_FRONTEND=noninteractive TERM=xterm cd /usr/share/docassemble \\\n && git clone https://github.com/letsencrypt/letsencrypt \\\n && cd letsencrypt \\\n && ./letsencrypt-auto --help \\\n && echo \"host all all 0.0.0.0/0 md5\" >> /etc/postgresql/9.6/main/pg_hba.conf \\\n && echo \"listen_addresses = '*'\" >> /etc/postgresql/9.6/main/postgresql.conf\nCOPY . /tmp/docassemble/\nRUN DEBIAN_FRONTEND=noninteractive TERM=xterm ln -s /var/mail/mail /var/mail/root \\\n && cp /tmp/docassemble/docassemble_webapp/docassemble.wsgi /usr/share/docassemble/webapp/ \\\n && cp /tmp/docassemble/Docker/*.sh /usr/share/docassemble/webapp/ \\\n && cp /tmp/docassemble/Docker/VERSION /usr/share/docassemble/webapp/ \\\n && cp /tmp/docassemble/Docker/pip.conf /usr/share/docassemble/local/ \\\n && cp /tmp/docassemble/Docker/pip.conf /usr/share/docassemble/local3.5/ \\\n && cp /tmp/docassemble/Docker/config/* /usr/share/docassemble/config/ \\\n && cp /tmp/docassemble/Docker/cgi-bin/index.sh /usr/lib/cgi-bin/ \\\n && cp /tmp/docassemble/Docker/syslog-ng.conf /usr/share/docassemble/webapp/syslog-ng.conf \\\n && cp /tmp/docassemble/Docker/syslog-ng-docker.conf /usr/share/docassemble/webapp/syslog-ng-docker.conf \\\n && cp /tmp/docassemble/Docker/docassemble-syslog-ng.conf /usr/share/docassemble/webapp/docassemble-syslog-ng.conf \\\n && cp /tmp/docassemble/Docker/apache.logrotate /etc/logrotate.d/apache2 \\\n && cp /tmp/docassemble/Docker/docassemble.logrotate /etc/logrotate.d/docassemble \\\n && cp /tmp/docassemble/Docker/cron/docassemble-cron-monthly.sh /etc/cron.monthly/docassemble \\\n && cp /tmp/docassemble/Docker/cron/docassemble-cron-weekly.sh /etc/cron.weekly/docassemble \\\n && cp /tmp/docassemble/Docker/cron/docassemble-cron-daily.sh /etc/cron.daily/docassemble \\\n && cp /tmp/docassemble/Docker/cron/docassemble-cron-hourly.sh /etc/cron.hourly/docassemble \\\n && cp /tmp/docassemble/Docker/docassemble.conf /etc/apache2/conf-available/ \\\n && cp /tmp/docassemble/Docker/docassemble-behindlb.conf /etc/apache2/conf-available/ \\\n && cp /tmp/docassemble/Docker/docassemble-supervisor.conf /etc/supervisor/conf.d/docassemble.conf \\\n && cp /tmp/docassemble/Docker/ssl/* /usr/share/docassemble/certs/ \\\n && cp /tmp/docassemble/Docker/rabbitmq.config /etc/rabbitmq/ \\\n && cp /tmp/docassemble/Docker/config/exim4-router /etc/exim4/conf.d/router/101_docassemble \\\n && cp /tmp/docassemble/Docker/config/exim4-filter /etc/exim4/docassemble-filter \\\n && cp /tmp/docassemble/Docker/config/exim4-main /etc/exim4/conf.d/main/01_docassemble \\\n && cp /tmp/docassemble/Docker/config/exim4-acl /etc/exim4/conf.d/acl/29_docassemble \\\n && cp /tmp/docassemble/Docker/config/exim4-update /etc/exim4/update-exim4.conf.conf \\\n && update-exim4.conf \\\n && bash -c \"chown www-data.www-data /usr/share/docassemble/config \\\n && chown www-data.www-data /usr/share/docassemble/config/config.yml.dist /usr/share/docassemble/webapp/docassemble.wsgi \\\n && chown -R www-data.www-data /tmp/docassemble /usr/share/docassemble/local /usr/share/docassemble/local3.5 /usr/share/docassemble/log /usr/share/docassemble/files \\\n && chmod ogu+r /usr/share/docassemble/config/config.yml.dist \\\n && chmod 755 /etc/ssl/docassemble \\\n && cd /tmp \\\n && wget https://bootstrap.pypa.io/get-pip.py \\\n && python get-pip.py \\\n && rm -f get-pip.py \\\n && pip install --upgrade virtualenv\" \\\n && echo \"en_US.UTF-8 UTF-8\" >> /etc/locale.gen \\\n && locale-gen \\\n && update-locale\nUSER www-data\nRUN LC_CTYPE=C.UTF-8 LANG=C.UTF-8 bash -c \"cd /tmp \\\n && virtualenv /usr/share/docassemble/local \\\n && source /usr/share/docassemble/local/bin/activate \\\n && pip install --upgrade pip \\\n && pip install 3to2 bcrypt flask flask-login flask-mail flask-sqlalchemy flask-wtf distutils2 passlib pycrypto six \\\n && pip install --upgrade 'git+https://github.com/euske/pdfminer.git' simplekv==0.10.0 /tmp/docassemble/docassemble /tmp/docassemble/docassemble_base /tmp/docassemble/docassemble_demo /tmp/docassemble/docassemble_webapp \\\n && pip uninstall --yes mysqlclient MySQL-python &> /dev/null\"\nUSER www-data\nRUN LC_CTYPE=C.UTF-8 LANG=C.UTF-8 bash -c \"cd /tmp \\\n && python3 -m venv --copies /usr/share/docassemble/local3.5 \\\n && source /usr/share/docassemble/local3.5/bin/activate \\\n && pip3 install --upgrade pip \\\n && pip3 install --upgrade 3to2 bcrypt flask flask-login flask-mail flask-sqlalchemy flask-wtf passlib pycryptodome pycryptodomex six setuptools \\\n && pip3 install --upgrade simplekv==0.10.0 /tmp/docassemble/docassemble /tmp/docassemble/docassemble_base /tmp/docassemble/docassemble_demo /tmp/docassemble/docassemble_webapp \\\n && pip3 uninstall --yes mysqlclient MySQL-python &> /dev/null\"\nUSER root\nRUN rm -rf /tmp/docassemble \\\n && rm -f /etc/cron.daily/apt-compat \\\n && sed -i -e 's/^\\(daemonize\\s*\\)yes\\s*$/\\1no/g' -e 's/^bind 127.0.0.1/bind 0.0.0.0/g' /etc/redis/redis.conf \\\n && sed -i -e 's/#APACHE_ULIMIT_MAX_FILES/APACHE_ULIMIT_MAX_FILES/' -e 's/ulimit -n 65536/ulimit -n 8192/' /etc/apache2/envvars \\\n && sed -i '/session required pam_loginuid.so/c\\#session required pam_loginuid.so' /etc/pam.d/cron \\\n && LANG=en_US.UTF-8 \\\n && a2dismod ssl ; a2enmod rewrite ; a2enmod xsendfile ; a2enmod proxy ; a2enmod proxy_http ; a2enmod proxy_wstunnel ; a2enmod headers ; a2enconf docassemble ; echo 'export TERM=xterm' >> /etc/bash.bashrc\nEXPOSE 80/tcp 443/tcp 9001/tcp 514/tcp 25/tcp 465/tcp 8080/tcp 8081/tcp 5432/tcp 6379/tcp 4369/tcp 5671/tcp 5672/tcp 25672/tcp\nENV CONTAINERROLE=\"all\" \\\n    LOCALE=\"en_US.UTF-8 UTF-8\" \\\n    TIMEZONE=\"America/New_York\" \\\n    EC2=\"\" \\\n    S3ENABLE=\"\" \\\n    S3BUCKET=\"\" \\\n    S3ACCESSKEY=\"\" \\\n    S3SECRETACCESSKEY=\"\" \\\n    DAHOSTNAME=\"\" \\\n    USEHTTPS=\"\" \\\n    USELETSENCRYPT=\"\" \\\n    LETSENCRYPTEMAIL=\"\" \\\n    DBHOST=\"\" \\\n    LOGSERVER=\"\" \\\n    REDIS=\"\" \\\n    RABBITMQ=\"\"\nCMD [\"/usr/bin/supervisord\", \"-n\", \"-c\", \"/etc/supervisor/supervisord.conf\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM debian:stretch\nRUN DEBIAN_FRONTEND=noninteractive bash -c 'echo -e \"deb http://deb.debian.org/debian stretch main contrib\\ndeb http://deb.debian.org/debian stretch-updates main\\ndeb http://security.debian.org/debian-security stretch/updates main\\ndeb http://ftp.debian.org/debian stretch-backports main\" > /etc/apt/sources.list&& apt-get -y update'\nRUN DEBIAN_FRONTEND=noninteractive bash -c \"until apt-get -q -y install apt-utils tzdata python python-dev wget unzip git locales apache2 postgresql libapache2-mod-xsendfile libffi-dev libffi6 gcc supervisor s3cmd make perl libinline-perl libparallel-forkmanager-perl autoconf automake libjpeg-dev zlib1g-dev libpq-dev logrotate nodejs cron libxml2 libxslt1.1 libxml2-dev libxslt1-dev libcurl4-openssl-dev libssl-dev redis-server rabbitmq-server libtool libtool-bin syslog-ng rsync curl mktemp dnsutils build-essential libsvm3 libsvm-dev liblinear3 liblinear-dev libzbar-dev libzbar0 libgs-dev default-libmysqlclient-dev libgmp-dev python-passlib libsasl2-dev libldap2-dev python3 exim4-daemon-heavy python3-venv python3-dev imagemagick pdftk pacpl pandoc texlive texlive-luatex texlive-latex-recommended texlive-latex-extra texlive-font-utils texlive-lang-cyrillic texlive-lang-french texlive-lang-italian texlive-lang-portuguese texlive-lang-german texlive-lang-european texlive-lang-spanish texlive-extra-utils poppler-utils libaudio-flac-header-perl libaudio-musepack-perl libmp3-tag-perl libogg-vorbis-header-pureperl-perl libvorbis-dev libcddb-perl libcddb-get-perl libmp3-tag-perl libaudio-scan-perl libaudio-flac-header-perl libav-tools tesseract-ocr tesseract-ocr-dev tesseract-ocr-afr tesseract-ocr-ara tesseract-ocr-aze tesseract-ocr-bel tesseract-ocr-ben tesseract-ocr-bul tesseract-ocr-cat tesseract-ocr-ces tesseract-ocr-chi-sim tesseract-ocr-chi-tra tesseract-ocr-chr tesseract-ocr-dan tesseract-ocr-deu tesseract-ocr-deu-frak tesseract-ocr-ell tesseract-ocr-eng tesseract-ocr-enm tesseract-ocr-epo tesseract-ocr-equ tesseract-ocr-est tesseract-ocr-eus tesseract-ocr-fin tesseract-ocr-fra tesseract-ocr-frk tesseract-ocr-frm tesseract-ocr-glg tesseract-ocr-grc tesseract-ocr-heb tesseract-ocr-hin tesseract-ocr-hrv tesseract-ocr-hun tesseract-ocr-ind tesseract-ocr-isl tesseract-ocr-ita tesseract-ocr-ita-old tesseract-ocr-jpn tesseract-ocr-kan tesseract-ocr-kor tesseract-ocr-lav tesseract-ocr-lit tesseract-ocr-mal tesseract-ocr-mkd tesseract-ocr-mlt tesseract-ocr-msa tesseract-ocr-nld tesseract-ocr-nor tesseract-ocr-osd tesseract-ocr-pol tesseract-ocr-por tesseract-ocr-ron tesseract-ocr-rus tesseract-ocr-slk tesseract-ocr-slk-frak tesseract-ocr-slv tesseract-ocr-spa tesseract-ocr-spa-old tesseract-ocr-sqi tesseract-ocr-srp tesseract-ocr-swa tesseract-ocr-swe tesseract-ocr-tam tesseract-ocr-tel tesseract-ocr-tgl tesseract-ocr-tha tesseract-ocr-tur tesseract-ocr-ukr tesseract-ocr-vie ttf-mscorefonts-installer fonts-ebgaramond-extra ghostscript ttf-liberation fonts-liberation cm-super qpdf; do sleep 5; done; apt-get -q -y install -t stretch-backports libreoffice &> /dev/null\"\nRUN DEBIAN_FRONTEND=noninteractive TERM=xterm cd /tmp \\\n && mkdir -p /etc/ssl/docassemble /usr/share/docassemble/local /usr/share/docassemble/local3.5 /usr/share/docassemble/certs /usr/share/docassemble/backup /usr/share/docassemble/config /usr/share/docassemble/webapp /usr/share/docassemble/files /var/www/.pip /var/www/.cache /usr/share/docassemble/log /tmp/docassemble /var/www/html/log \\\n && echo '{ \"args\": [\"--no-sandbox\"] }' > /var/www/puppeteer-config.json \\\n && chown -R www-data.www-data /var/www \\\n && chsh -s /bin/bash www-data \\\n && update-alternatives --install /usr/bin/node node /usr/bin/nodejs 10 \\\n && wget -qO- https://deb.nodesource.com/setup_6.x | bash - \\\n && apt-get install nodejs -y \\\n && npm install azure-storage-cmd -g \\\n && npm install mermaid.cli -g\nRUN DEBIAN_FRONTEND=noninteractive TERM=xterm cd /usr/share/docassemble \\\n && git clone https://github.com/letsencrypt/letsencrypt \\\n && cd letsencrypt \\\n && ./letsencrypt-auto --help \\\n && echo \"host all all 0.0.0.0/0 md5\" >> /etc/postgresql/9.6/main/pg_hba.conf \\\n && echo \"listen_addresses = '*'\" >> /etc/postgresql/9.6/main/postgresql.conf\nCOPY . /tmp/docassemble/\nRUN DEBIAN_FRONTEND=noninteractive TERM=xterm ln -s /var/mail/mail /var/mail/root \\\n && cp /tmp/docassemble/docassemble_webapp/docassemble.wsgi /usr/share/docassemble/webapp/ \\\n && cp /tmp/docassemble/Docker/*.sh /usr/share/docassemble/webapp/ \\\n && cp /tmp/docassemble/Docker/VERSION /usr/share/docassemble/webapp/ \\\n && cp /tmp/docassemble/Docker/pip.conf /usr/share/docassemble/local/ \\\n && cp /tmp/docassemble/Docker/pip.conf /usr/share/docassemble/local3.5/ \\\n && cp /tmp/docassemble/Docker/config/* /usr/share/docassemble/config/ \\\n && cp /tmp/docassemble/Docker/cgi-bin/index.sh /usr/lib/cgi-bin/ \\\n && cp /tmp/docassemble/Docker/syslog-ng.conf /usr/share/docassemble/webapp/syslog-ng.conf \\\n && cp /tmp/docassemble/Docker/syslog-ng-docker.conf /usr/share/docassemble/webapp/syslog-ng-docker.conf \\\n && cp /tmp/docassemble/Docker/docassemble-syslog-ng.conf /usr/share/docassemble/webapp/docassemble-syslog-ng.conf \\\n && cp /tmp/docassemble/Docker/apache.logrotate /etc/logrotate.d/apache2 \\\n && cp /tmp/docassemble/Docker/docassemble.logrotate /etc/logrotate.d/docassemble \\\n && cp /tmp/docassemble/Docker/cron/docassemble-cron-monthly.sh /etc/cron.monthly/docassemble \\\n && cp /tmp/docassemble/Docker/cron/docassemble-cron-weekly.sh /etc/cron.weekly/docassemble \\\n && cp /tmp/docassemble/Docker/cron/docassemble-cron-daily.sh /etc/cron.daily/docassemble \\\n && cp /tmp/docassemble/Docker/cron/docassemble-cron-hourly.sh /etc/cron.hourly/docassemble \\\n && cp /tmp/docassemble/Docker/docassemble.conf /etc/apache2/conf-available/ \\\n && cp /tmp/docassemble/Docker/docassemble-behindlb.conf /etc/apache2/conf-available/ \\\n && cp /tmp/docassemble/Docker/docassemble-supervisor.conf /etc/supervisor/conf.d/docassemble.conf \\\n && cp /tmp/docassemble/Docker/ssl/* /usr/share/docassemble/certs/ \\\n && cp /tmp/docassemble/Docker/rabbitmq.config /etc/rabbitmq/ \\\n && cp /tmp/docassemble/Docker/config/exim4-router /etc/exim4/conf.d/router/101_docassemble \\\n && cp /tmp/docassemble/Docker/config/exim4-filter /etc/exim4/docassemble-filter \\\n && cp /tmp/docassemble/Docker/config/exim4-main /etc/exim4/conf.d/main/01_docassemble \\\n && cp /tmp/docassemble/Docker/config/exim4-acl /etc/exim4/conf.d/acl/29_docassemble \\\n && cp /tmp/docassemble/Docker/config/exim4-update /etc/exim4/update-exim4.conf.conf \\\n && update-exim4.conf \\\n && bash -c \"chown www-data.www-data /usr/share/docassemble/config \\\n && chown www-data.www-data /usr/share/docassemble/config/config.yml.dist /usr/share/docassemble/webapp/docassemble.wsgi \\\n && chown -R www-data.www-data /tmp/docassemble /usr/share/docassemble/local /usr/share/docassemble/local3.5 /usr/share/docassemble/log /usr/share/docassemble/files \\\n && chmod ogu+r /usr/share/docassemble/config/config.yml.dist \\\n && chmod 755 /etc/ssl/docassemble \\\n && cd /tmp \\\n && wget https://bootstrap.pypa.io/get-pip.py \\\n && python get-pip.py \\\n && rm -f get-pip.py \\\n && pip install --upgrade virtualenv\" \\\n && echo \"en_US.UTF-8 UTF-8\" >> /etc/locale.gen \\\n && locale-gen \\\n && update-locale\nUSER www-data\nRUN LC_CTYPE=C.UTF-8 LANG=C.UTF-8 bash -c \"cd /tmp \\\n && virtualenv /usr/share/docassemble/local \\\n && source /usr/share/docassemble/local/bin/activate \\\n && pip install --upgrade pip \\\n && pip install 3to2 bcrypt flask flask-login flask-mail flask-sqlalchemy flask-wtf distutils2 passlib pycrypto six \\\n && pip install --upgrade 'git+https://github.com/euske/pdfminer.git' simplekv==0.10.0 /tmp/docassemble/docassemble /tmp/docassemble/docassemble_base /tmp/docassemble/docassemble_demo /tmp/docassemble/docassemble_webapp \\\n && pip uninstall --yes mysqlclient MySQL-python &> /dev/null\"\nUSER www-data\nRUN LC_CTYPE=C.UTF-8 LANG=C.UTF-8 bash -c \"cd /tmp \\\n && python3 -m venv --copies /usr/share/docassemble/local3.5 \\\n && source /usr/share/docassemble/local3.5/bin/activate \\\n && pip3 install --upgrade pip \\\n && pip3 install --upgrade 3to2 bcrypt flask flask-login flask-mail flask-sqlalchemy flask-wtf passlib pycryptodome pycryptodomex six setuptools \\\n && pip3 install --upgrade simplekv==0.10.0 /tmp/docassemble/docassemble /tmp/docassemble/docassemble_base /tmp/docassemble/docassemble_demo /tmp/docassemble/docassemble_webapp \\\n && pip3 uninstall --yes mysqlclient MySQL-python &> /dev/null\"\nUSER root\nRUN rm -rf /tmp/docassemble \\\n && rm -f /etc/cron.daily/apt-compat \\\n && sed -i -e 's/^\\(daemonize\\s*\\)yes\\s*$/\\1no/g' -e 's/^bind 127.0.0.1/bind 0.0.0.0/g' /etc/redis/redis.conf \\\n && sed -i -e 's/#APACHE_ULIMIT_MAX_FILES/APACHE_ULIMIT_MAX_FILES/' -e 's/ulimit -n 65536/ulimit -n 8192/' /etc/apache2/envvars \\\n && sed -i '/session required pam_loginuid.so/c\\#session required pam_loginuid.so' /etc/pam.d/cron \\\n && LANG=en_US.UTF-8 \\\n && a2dismod ssl ; a2enmod rewrite ; a2enmod xsendfile ; a2enmod proxy ; a2enmod proxy_http ; a2enmod proxy_wstunnel ; a2enmod headers ; a2enconf docassemble ; echo 'export TERM=xterm' >> /etc/bash.bashrc\nEXPOSE 80/tcp 443/tcp 9001/tcp 514/tcp 25/tcp 465/tcp 8080/tcp 8081/tcp 5432/tcp 6379/tcp 4369/tcp 5671/tcp 5672/tcp 25672/tcp\nENV CONTAINERROLE=\"all\" \\\n    LOCALE=\"en_US.UTF-8 UTF-8\" \\\n    TIMEZONE=\"America/New_York\" \\\n    EC2=\"\" \\\n    S3ENABLE=\"\" \\\n    S3BUCKET=\"\" \\\n    S3ACCESSKEY=\"\" \\\n    S3SECRETACCESSKEY=\"\" \\\n    DAHOSTNAME=\"\" \\\n    USEHTTPS=\"\" \\\n    USELETSENCRYPT=\"\" \\\n    LETSENCRYPTEMAIL=\"\" \\\n    DBHOST=\"\" \\\n    LOGSERVER=\"\" \\\n    REDIS=\"\" \\\n    RABBITMQ=\"\"\nCMD [\"/usr/bin/supervisord\", \"-n\", \"-c\", \"/etc/supervisor/supervisord.conf\"]\n","injectedSmells":[],"originalDockerfileHash":"96c67d97af60ff91e67be4ede8cfa661","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM debian:stretch\nRUN DEBIAN_FRONTEND=noninteractive bash -c 'echo -e \"deb http://deb.debian.org/debian stretch main contrib\\ndeb http://deb.debian.org/debian stretch-updates main\\ndeb http://security.debian.org/debian-security stretch/updates main\\ndeb http://ftp.debian.org/debian stretch-backports main\" > /etc/apt/sources.list&& apt-get -y update'\nRUN DEBIAN_FRONTEND=noninteractive bash -c \"until apt-get -q -y install apt-utils tzdata python python-dev wget unzip git locales apache2 postgresql libapache2-mod-xsendfile libffi-dev libffi6 gcc supervisor s3cmd make perl libinline-perl libparallel-forkmanager-perl autoconf automake libjpeg-dev zlib1g-dev libpq-dev logrotate nodejs cron libxml2 libxslt1.1 libxml2-dev libxslt1-dev libcurl4-openssl-dev libssl-dev redis-server rabbitmq-server libtool libtool-bin syslog-ng rsync curl mktemp dnsutils build-essential libsvm3 libsvm-dev liblinear3 liblinear-dev libzbar-dev libzbar0 libgs-dev default-libmysqlclient-dev libgmp-dev python-passlib libsasl2-dev libldap2-dev python3 exim4-daemon-heavy python3-venv python3-dev imagemagick pdftk pacpl pandoc texlive texlive-luatex texlive-latex-recommended texlive-latex-extra texlive-font-utils texlive-lang-cyrillic texlive-lang-french texlive-lang-italian texlive-lang-portuguese texlive-lang-german texlive-lang-european texlive-lang-spanish texlive-extra-utils poppler-utils libaudio-flac-header-perl libaudio-musepack-perl libmp3-tag-perl libogg-vorbis-header-pureperl-perl libvorbis-dev libcddb-perl libcddb-get-perl libmp3-tag-perl libaudio-scan-perl libaudio-flac-header-perl libav-tools tesseract-ocr tesseract-ocr-dev tesseract-ocr-afr tesseract-ocr-ara tesseract-ocr-aze tesseract-ocr-bel tesseract-ocr-ben tesseract-ocr-bul tesseract-ocr-cat tesseract-ocr-ces tesseract-ocr-chi-sim tesseract-ocr-chi-tra tesseract-ocr-chr tesseract-ocr-dan tesseract-ocr-deu tesseract-ocr-deu-frak tesseract-ocr-ell tesseract-ocr-eng tesseract-ocr-enm tesseract-ocr-epo tesseract-ocr-equ tesseract-ocr-est tesseract-ocr-eus tesseract-ocr-fin tesseract-ocr-fra tesseract-ocr-frk tesseract-ocr-frm tesseract-ocr-glg tesseract-ocr-grc tesseract-ocr-heb tesseract-ocr-hin tesseract-ocr-hrv tesseract-ocr-hun tesseract-ocr-ind tesseract-ocr-isl tesseract-ocr-ita tesseract-ocr-ita-old tesseract-ocr-jpn tesseract-ocr-kan tesseract-ocr-kor tesseract-ocr-lav tesseract-ocr-lit tesseract-ocr-mal tesseract-ocr-mkd tesseract-ocr-mlt tesseract-ocr-msa tesseract-ocr-nld tesseract-ocr-nor tesseract-ocr-osd tesseract-ocr-pol tesseract-ocr-por tesseract-ocr-ron tesseract-ocr-rus tesseract-ocr-slk tesseract-ocr-slk-frak tesseract-ocr-slv tesseract-ocr-spa tesseract-ocr-spa-old tesseract-ocr-sqi tesseract-ocr-srp tesseract-ocr-swa tesseract-ocr-swe tesseract-ocr-tam tesseract-ocr-tel tesseract-ocr-tgl tesseract-ocr-tha tesseract-ocr-tur tesseract-ocr-ukr tesseract-ocr-vie ttf-mscorefonts-installer fonts-ebgaramond-extra ghostscript ttf-liberation fonts-liberation cm-super qpdf; do sleep 5; done; apt-get -q -y install -t stretch-backports libreoffice &> /dev/null\"\nRUN DEBIAN_FRONTEND=noninteractive TERM=xterm cd /tmp \\\n && mkdir -p /etc/ssl/docassemble /usr/share/docassemble/local /usr/share/docassemble/local3.5 /usr/share/docassemble/certs /usr/share/docassemble/backup /usr/share/docassemble/config /usr/share/docassemble/webapp /usr/share/docassemble/files /var/www/.pip /var/www/.cache /usr/share/docassemble/log /tmp/docassemble /var/www/html/log \\\n && echo '{ \"args\": [\"--no-sandbox\"] }' > /var/www/puppeteer-config.json \\\n && chown -R www-data.www-data /var/www \\\n && chsh -s /bin/bash www-data \\\n && update-alternatives --install /usr/bin/node node /usr/bin/nodejs 10 \\\n && wget -qO- https://deb.nodesource.com/setup_6.x | bash - \\\n && apt-get install nodejs -y \\\n && npm install azure-storage-cmd -g \\\n && npm install mermaid.cli -g\nRUN DEBIAN_FRONTEND=noninteractive TERM=xterm cd /usr/share/docassemble \\\n && git clone https://github.com/letsencrypt/letsencrypt \\\n && cd letsencrypt \\\n && ./letsencrypt-auto --help \\\n && echo \"host all all 0.0.0.0/0 md5\" >> /etc/postgresql/9.6/main/pg_hba.conf \\\n && echo \"listen_addresses = '*'\" >> /etc/postgresql/9.6/main/postgresql.conf\nCOPY . /tmp/docassemble/\nRUN DEBIAN_FRONTEND=noninteractive TERM=xterm ln -s /var/mail/mail /var/mail/root \\\n && cp /tmp/docassemble/docassemble_webapp/docassemble.wsgi /usr/share/docassemble/webapp/ \\\n && cp /tmp/docassemble/Docker/*.sh /usr/share/docassemble/webapp/ \\\n && cp /tmp/docassemble/Docker/VERSION /usr/share/docassemble/webapp/ \\\n && cp /tmp/docassemble/Docker/pip.conf /usr/share/docassemble/local/ \\\n && cp /tmp/docassemble/Docker/pip.conf /usr/share/docassemble/local3.5/ \\\n && cp /tmp/docassemble/Docker/config/* /usr/share/docassemble/config/ \\\n && cp /tmp/docassemble/Docker/cgi-bin/index.sh /usr/lib/cgi-bin/ \\\n && cp /tmp/docassemble/Docker/syslog-ng.conf /usr/share/docassemble/webapp/syslog-ng.conf \\\n && cp /tmp/docassemble/Docker/syslog-ng-docker.conf /usr/share/docassemble/webapp/syslog-ng-docker.conf \\\n && cp /tmp/docassemble/Docker/docassemble-syslog-ng.conf /usr/share/docassemble/webapp/docassemble-syslog-ng.conf \\\n && cp /tmp/docassemble/Docker/apache.logrotate /etc/logrotate.d/apache2 \\\n && cp /tmp/docassemble/Docker/docassemble.logrotate /etc/logrotate.d/docassemble \\\n && cp /tmp/docassemble/Docker/cron/docassemble-cron-monthly.sh /etc/cron.monthly/docassemble \\\n && cp /tmp/docassemble/Docker/cron/docassemble-cron-weekly.sh /etc/cron.weekly/docassemble \\\n && cp /tmp/docassemble/Docker/cron/docassemble-cron-daily.sh /etc/cron.daily/docassemble \\\n && cp /tmp/docassemble/Docker/cron/docassemble-cron-hourly.sh /etc/cron.hourly/docassemble \\\n && cp /tmp/docassemble/Docker/docassemble.conf /etc/apache2/conf-available/ \\\n && cp /tmp/docassemble/Docker/docassemble-behindlb.conf /etc/apache2/conf-available/ \\\n && cp /tmp/docassemble/Docker/docassemble-supervisor.conf /etc/supervisor/conf.d/docassemble.conf \\\n && cp /tmp/docassemble/Docker/ssl/* /usr/share/docassemble/certs/ \\\n && cp /tmp/docassemble/Docker/rabbitmq.config /etc/rabbitmq/ \\\n && cp /tmp/docassemble/Docker/config/exim4-router /etc/exim4/conf.d/router/101_docassemble \\\n && cp /tmp/docassemble/Docker/config/exim4-filter /etc/exim4/docassemble-filter \\\n && cp /tmp/docassemble/Docker/config/exim4-main /etc/exim4/conf.d/main/01_docassemble \\\n && cp /tmp/docassemble/Docker/config/exim4-acl /etc/exim4/conf.d/acl/29_docassemble \\\n && cp /tmp/docassemble/Docker/config/exim4-update /etc/exim4/update-exim4.conf.conf \\\n && update-exim4.conf \\\n && bash -c \"chown www-data.www-data /usr/share/docassemble/config \\\n && chown www-data.www-data /usr/share/docassemble/config/config.yml.dist /usr/share/docassemble/webapp/docassemble.wsgi \\\n && chown -R www-data.www-data /tmp/docassemble /usr/share/docassemble/local /usr/share/docassemble/local3.5 /usr/share/docassemble/log /usr/share/docassemble/files \\\n && chmod ogu+r /usr/share/docassemble/config/config.yml.dist \\\n && chmod 755 /etc/ssl/docassemble \\\n && cd /tmp \\\n && wget https://bootstrap.pypa.io/get-pip.py \\\n && python get-pip.py \\\n && rm -f get-pip.py \\\n && pip install --upgrade virtualenv\" \\\n && echo \"en_US.UTF-8 UTF-8\" >> /etc/locale.gen \\\n && locale-gen \\\n && update-locale\nUSER www-data\nRUN LC_CTYPE=C.UTF-8 LANG=C.UTF-8 bash -c \"cd /tmp \\\n && virtualenv /usr/share/docassemble/local \\\n && source /usr/share/docassemble/local/bin/activate \\\n && pip install --upgrade pip \\\n && pip install 3to2 bcrypt flask flask-login flask-mail flask-sqlalchemy flask-wtf distutils2 passlib pycrypto six \\\n && pip install --upgrade 'git+https://github.com/euske/pdfminer.git' simplekv==0.10.0 /tmp/docassemble/docassemble /tmp/docassemble/docassemble_base /tmp/docassemble/docassemble_demo /tmp/docassemble/docassemble_webapp \\\n && pip uninstall --yes mysqlclient MySQL-python &> /dev/null\"\nUSER www-data\nRUN LC_CTYPE=C.UTF-8 LANG=C.UTF-8 bash -c \"cd /tmp \\\n && python3 -m venv --copies /usr/share/docassemble/local3.5 \\\n && source /usr/share/docassemble/local3.5/bin/activate \\\n && pip3 install --upgrade pip \\\n && pip3 install --upgrade 3to2 bcrypt flask flask-login flask-mail flask-sqlalchemy flask-wtf passlib pycryptodome pycryptodomex six setuptools \\\n && pip3 install --upgrade simplekv==0.10.0 /tmp/docassemble/docassemble /tmp/docassemble/docassemble_base /tmp/docassemble/docassemble_demo /tmp/docassemble/docassemble_webapp \\\n && pip3 uninstall --yes mysqlclient MySQL-python &> /dev/null\"\nUSER root\nRUN rm -rf /tmp/docassemble \\\n && rm -f /etc/cron.daily/apt-compat \\\n && sed -i -e 's/^\\(daemonize\\s*\\)yes\\s*$/\\1no/g' -e 's/^bind 127.0.0.1/bind 0.0.0.0/g' /etc/redis/redis.conf \\\n && sed -i -e 's/#APACHE_ULIMIT_MAX_FILES/APACHE_ULIMIT_MAX_FILES/' -e 's/ulimit -n 65536/ulimit -n 8192/' /etc/apache2/envvars \\\n && sed -i '/session required pam_loginuid.so/c\\#session required pam_loginuid.so' /etc/pam.d/cron \\\n && LANG=en_US.UTF-8 \\\n && a2dismod ssl ; a2enmod rewrite ; a2enmod xsendfile ; a2enmod proxy ; a2enmod proxy_http ; a2enmod proxy_wstunnel ; a2enmod headers ; a2enconf docassemble ; echo 'export TERM=xterm' >> /etc/bash.bashrc\nEXPOSE 80/tcp 443/tcp 9001/tcp 514/tcp 25/tcp 465/tcp 8080/tcp 8081/tcp 5432/tcp 6379/tcp 4369/tcp 5671/tcp 5672/tcp 25672/tcp\nENV CONTAINERROLE=\"all\" \\\n    LOCALE=\"en_US.UTF-8 UTF-8\" \\\n    TIMEZONE=\"America/New_York\" \\\n    EC2=\"\" \\\n    S3ENABLE=\"\" \\\n    S3BUCKET=\"\" \\\n    S3ACCESSKEY=\"\" \\\n    S3SECRETACCESSKEY=\"\" \\\n    DAHOSTNAME=\"\" \\\n    USEHTTPS=\"\" \\\n    USELETSENCRYPT=\"\" \\\n    LETSENCRYPTEMAIL=\"\" \\\n    DBHOST=\"\" \\\n    LOGSERVER=\"\" \\\n    REDIS=\"\" \\\n    RABBITMQ=\"\"\nCMD [\"/usr/bin/supervisord\", \"-n\", \"-c\", \"/etc/supervisor/supervisord.conf\"]\n","originalDockerfileUglifiedHash":"96c67d97af60ff91e67be4ede8cfa661","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/a492f04869463ad59416743ffba812e402022c3c.dockerfile"}