{"seed":3829363606,"processedDockerfileHash":"04cfea96abdf5fd97ec50387d1201b12","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-gem","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM hysds/pge-base:latest\n#   Set an encoding to make things work smoothly.\nENV LANG=\"en_US.UTF-8\"\n#   Set ISCE repo\nENV ISCE_ORG=\"isce-framework\"\n#   set to root user\nUSER root\n#   install tools for RPM generation\nRUN set -ex \\\n && yum update -y \\\n && yum groupinstall -y \"development tools\" \\\n && yum install -y make ruby-devel rpm-build rubygems \\\n && gem install fpm --version 1.15.1 --no-ri --no-rdoc\n#   install isce requirements\nRUN set -ex \\\n && . /opt/conda/bin/activate root \\\n && conda install --yes cython gdal git h5py libgdal pytest numpy fftw scipy basemap scons opencv hdf4 hdf5 netcdf4 libgcc libstdcxx-ng cmake \\\n && yum install -y uuid-devel x11-devel motif-devel jq \\\n && ln -sf /opt/conda/bin/cython /opt/conda/bin/cython3\n#   link system libuuid\nRUN set -ex \\\n && cd /opt/conda/lib \\\n && unlink libuuid.so \\\n && unlink libuuid.so.1 \\\n && ln -s /lib64/libuuid.so.1.3.0 libuuid.so \\\n && ln -s /lib64/libuuid.so.1.3.0 libuuid.so.1\n#   install libgfortran.so.3 and create missing link\nRUN set -ex \\\n && yum install -y gcc-gfortran \\\n && cd /lib64 \\\n && (test -f libgfortran.so || ln -sv libgfortran.so.*.* libgfortran.so )\n#   copy repo\nCOPY . /root/isce2\n#   build ISCE\nRUN set -ex \\\n && . /opt/conda/bin/activate root \\\n && cd /root \\\n && source isce2/docker/build_env.sh \\\n && mkdir -p $BUILD_DIR \\\n && cp isce2/docker/SConfigISCE isce2/configuration/ \\\n && cd isce2 \\\n && scons install \\\n && cp docker/isce_env.sh $ISCE_INSTALL_ROOT \\\n && mkdir -p rpm-build/opt \\\n && mv $ISCE_INSTALL_ROOT rpm-build/opt \\\n && curl -s https://api.github.com/repos/$ISCE_ORG/isce2/git/refs/heads/master > rpm-build/opt/isce2/version.json \\\n && hash=$( cat rpm-build/opt/isce2/version.json | jq -r .object.sha ;) \\\n && short_hash=$( echo $hash | cut -c1-5 ;) \\\n && fpm -s dir -t rpm -C rpm-build --name isce --prefix=/ --version=2.0 --provides=isce --maintainer=piyush.agram@jpl.nasa.gov --description=\"InSAR Scientific Computing Environment v2 (${hash})\"\nFROM hysds/pge-base:latest\n#   Set an encoding to make things work smoothly.\nENV LANG=\"en_US.UTF-8\"\n#   install ISCE from RPM\nCOPY --from=0 /root/isce2/isce-2.0-1.x86_64.rpm /tmp/isce-2.0-1.x86_64.rpm\n#   install isce and its minimal requirements\nRUN set -ex \\\n && sudo /opt/conda/bin/conda install --yes gdal h5py libgdal pytest numpy fftw scipy basemap opencv hdf4 hdf5 netcdf4 \\\n && sudo yum update -y \\\n && sudo yum install -y uuid-devel x11-devel motif-devel gcc-gfortran \\\n && cd /opt/conda/lib \\\n && sudo unlink libuuid.so \\\n && sudo unlink libuuid.so.1 \\\n && sudo ln -s /lib64/libuuid.so.1.3.0 libuuid.so \\\n && sudo ln -s /lib64/libuuid.so.1.3.0 libuuid.so.1 \\\n && cd /lib64 \\\n && (test -f libgfortran.so || sudo ln -sv libgfortran.so.*.* libgfortran.so ) \\\n && sudo yum install -y /tmp/isce-2.0-1.x86_64.rpm \\\n && sudo yum clean all \\\n && sudo rm -rf /var/cache/yum \\\n && sudo rm /tmp/isce-2.0-1.x86_64.rpm\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM hysds/pge-base:latest\n#  Set an encoding to make things work smoothly.\nENV LANG=\"en_US.UTF-8\"\n#  Set ISCE repo\nENV ISCE_ORG=\"isce-framework\"\n#  set to root user\nUSER root\n#  install tools for RPM generation\nRUN set -ex \\\n && yum update -y \\\n && yum groupinstall -y \"development tools\" \\\n && yum install -y make ruby-devel rpm-build rubygems \\\n && gem install fpm --no-ri --no-rdoc\n#  install isce requirements\nRUN set -ex \\\n && . /opt/conda/bin/activate root \\\n && conda install --yes cython gdal git h5py libgdal pytest numpy fftw scipy basemap scons opencv hdf4 hdf5 netcdf4 libgcc libstdcxx-ng cmake \\\n && yum install -y uuid-devel x11-devel motif-devel jq \\\n && ln -sf /opt/conda/bin/cython /opt/conda/bin/cython3\n#  link system libuuid\nRUN set -ex \\\n && cd /opt/conda/lib \\\n && unlink libuuid.so \\\n && unlink libuuid.so.1 \\\n && ln -s /lib64/libuuid.so.1.3.0 libuuid.so \\\n && ln -s /lib64/libuuid.so.1.3.0 libuuid.so.1\n#  install libgfortran.so.3 and create missing link\nRUN set -ex \\\n && yum install -y gcc-gfortran \\\n && cd /lib64 \\\n && (test -f libgfortran.so || ln -sv libgfortran.so.*.* libgfortran.so )\n#  copy repo\nCOPY . /root/isce2\n#  build ISCE\nRUN set -ex \\\n && . /opt/conda/bin/activate root \\\n && cd /root \\\n && source isce2/docker/build_env.sh \\\n && mkdir -p $BUILD_DIR \\\n && cp isce2/docker/SConfigISCE isce2/configuration/ \\\n && cd isce2 \\\n && scons install \\\n && cp docker/isce_env.sh $ISCE_INSTALL_ROOT \\\n && mkdir -p rpm-build/opt \\\n && mv $ISCE_INSTALL_ROOT rpm-build/opt \\\n && curl -s https://api.github.com/repos/$ISCE_ORG/isce2/git/refs/heads/master > rpm-build/opt/isce2/version.json \\\n && hash=$( cat rpm-build/opt/isce2/version.json | jq -r .object.sha ;) \\\n && short_hash=$( echo $hash | cut -c1-5 ;) \\\n && fpm -s dir -t rpm -C rpm-build --name isce --prefix=/ --version=2.0 --provides=isce --maintainer=piyush.agram@jpl.nasa.gov --description=\"InSAR Scientific Computing Environment v2 (${hash})\"\nFROM hysds/pge-base:latest\n#  Set an encoding to make things work smoothly.\nENV LANG=\"en_US.UTF-8\"\n#  install ISCE from RPM\nCOPY --from=0 /root/isce2/isce-2.0-1.x86_64.rpm /tmp/isce-2.0-1.x86_64.rpm\n#  install isce and its minimal requirements\nRUN set -ex \\\n && sudo /opt/conda/bin/conda install --yes gdal h5py libgdal pytest numpy fftw scipy basemap opencv hdf4 hdf5 netcdf4 \\\n && sudo yum update -y \\\n && sudo yum install -y uuid-devel x11-devel motif-devel gcc-gfortran \\\n && cd /opt/conda/lib \\\n && sudo unlink libuuid.so \\\n && sudo unlink libuuid.so.1 \\\n && sudo ln -s /lib64/libuuid.so.1.3.0 libuuid.so \\\n && sudo ln -s /lib64/libuuid.so.1.3.0 libuuid.so.1 \\\n && cd /lib64 \\\n && (test -f libgfortran.so || sudo ln -sv libgfortran.so.*.* libgfortran.so ) \\\n && sudo yum install -y /tmp/isce-2.0-1.x86_64.rpm \\\n && sudo yum clean all \\\n && sudo rm -rf /var/cache/yum \\\n && sudo rm /tmp/isce-2.0-1.x86_64.rpm\n","injectedSmells":[],"originalDockerfileHash":"7d9e343538299b611ae72f13e43f7396","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM hysds/pge-base:latest\n#   Set an encoding to make things work smoothly.\nENV LANG=\"en_US.UTF-8\"\n#   Set ISCE repo\nENV ISCE_ORG=\"isce-framework\"\n#   set to root user\nUSER root\n#   install tools for RPM generation\nRUN set -ex \\\n && yum update -y \\\n && yum groupinstall -y \"development tools\" \\\n && yum install -y make ruby-devel rpm-build rubygems \\\n && gem install fpm --no-ri --no-rdoc\n#   install isce requirements\nRUN set -ex \\\n && . /opt/conda/bin/activate root \\\n && conda install --yes cython gdal git h5py libgdal pytest numpy fftw scipy basemap scons opencv hdf4 hdf5 netcdf4 libgcc libstdcxx-ng cmake \\\n && yum install -y uuid-devel x11-devel motif-devel jq \\\n && ln -sf /opt/conda/bin/cython /opt/conda/bin/cython3\n#   link system libuuid\nRUN set -ex \\\n && cd /opt/conda/lib \\\n && unlink libuuid.so \\\n && unlink libuuid.so.1 \\\n && ln -s /lib64/libuuid.so.1.3.0 libuuid.so \\\n && ln -s /lib64/libuuid.so.1.3.0 libuuid.so.1\n#   install libgfortran.so.3 and create missing link\nRUN set -ex \\\n && yum install -y gcc-gfortran \\\n && cd /lib64 \\\n && (test -f libgfortran.so || ln -sv libgfortran.so.*.* libgfortran.so )\n#   copy repo\nCOPY . /root/isce2\n#   build ISCE\nRUN set -ex \\\n && . /opt/conda/bin/activate root \\\n && cd /root \\\n && source isce2/docker/build_env.sh \\\n && mkdir -p $BUILD_DIR \\\n && cp isce2/docker/SConfigISCE isce2/configuration/ \\\n && cd isce2 \\\n && scons install \\\n && cp docker/isce_env.sh $ISCE_INSTALL_ROOT \\\n && mkdir -p rpm-build/opt \\\n && mv $ISCE_INSTALL_ROOT rpm-build/opt \\\n && curl -s https://api.github.com/repos/$ISCE_ORG/isce2/git/refs/heads/master > rpm-build/opt/isce2/version.json \\\n && hash=$( cat rpm-build/opt/isce2/version.json | jq -r .object.sha ;) \\\n && short_hash=$( echo $hash | cut -c1-5 ;) \\\n && fpm -s dir -t rpm -C rpm-build --name isce --prefix=/ --version=2.0 --provides=isce --maintainer=piyush.agram@jpl.nasa.gov --description=\"InSAR Scientific Computing Environment v2 (${hash})\"\nFROM hysds/pge-base:latest\n#   Set an encoding to make things work smoothly.\nENV LANG=\"en_US.UTF-8\"\n#   install ISCE from RPM\nCOPY --from=0 /root/isce2/isce-2.0-1.x86_64.rpm /tmp/isce-2.0-1.x86_64.rpm\n#   install isce and its minimal requirements\nRUN set -ex \\\n && sudo /opt/conda/bin/conda install --yes gdal h5py libgdal pytest numpy fftw scipy basemap opencv hdf4 hdf5 netcdf4 \\\n && sudo yum update -y \\\n && sudo yum install -y uuid-devel x11-devel motif-devel gcc-gfortran \\\n && cd /opt/conda/lib \\\n && sudo unlink libuuid.so \\\n && sudo unlink libuuid.so.1 \\\n && sudo ln -s /lib64/libuuid.so.1.3.0 libuuid.so \\\n && sudo ln -s /lib64/libuuid.so.1.3.0 libuuid.so.1 \\\n && cd /lib64 \\\n && (test -f libgfortran.so || sudo ln -sv libgfortran.so.*.* libgfortran.so ) \\\n && sudo yum install -y /tmp/isce-2.0-1.x86_64.rpm \\\n && sudo yum clean all \\\n && sudo rm -rf /var/cache/yum \\\n && sudo rm /tmp/isce-2.0-1.x86_64.rpm\n","originalDockerfileUglifiedHash":"e71aef9b1aac0a3fb465fc8730e1268c","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/7b9c0a841b84471c1d5a72786b55119dc6c65ec8.dockerfile"}