{"seed":2447495676,"processedDockerfileHash":"c0233a1741ba8e2453a8db74e65712b6","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","pin-package-manager-versions-apt-get","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM debian:wheezy\nLABEL maintainer=\"Alterway <iac@alterway.fr>\"\nRUN apt-get update \\\n && apt-get install --no-install-recommends ca-certificates curl libpcre3 librecode0 libsqlite3-0 libxml2 autoconf file g++ gcc libc-dev make pkg-config re2c -y \\\n && rm -r /var/lib/apt/lists/*\nENV PHP_INI_DIR=\"/usr/local/etc/php\"\nRUN mkdir -p $PHP_INI_DIR/conf.d\nENV PHP_EXTRA_CONFIGURE_ARGS=\"--enable-fpm --with-fpm-user=www-data --with-fpm-group=www-data\"\nENV GPG_KEYS=\"0A95E9A026542D53835E3F3A7DEC4E69FC9C83D7\"\nRUN set -xe \\\n && for key in $GPG_KEYS; do gpg --keyserver ha.pool.sks-keyservers.net --recv-keys \"$key\" ; done\nENV PHP_VERSION=\"5.3.29\"\nRUN buildDeps=\" $PHP_EXTRA_BUILD_DEPS bzip2 libcurl4-openssl-dev libpcre3-dev libreadline6-dev librecode-dev libsqlite3-dev libssl-dev libxml2-dev \" \\\n && set -x \\\n && apt-get update \\\n && apt-get install --no-install-recommends $buildDeps -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && curl -SL \"http://php.net/get/php-$PHP_VERSION.tar.bz2/from/this/mirror\" -o php.tar.bz2 \\\n && curl -SL \"http://php.net/get/php-$PHP_VERSION.tar.bz2.asc/from/this/mirror\" -o php.tar.bz2.asc \\\n && gpg --verify php.tar.bz2.asc \\\n && mkdir -p /usr/src/php \\\n && tar -xof php.tar.bz2 -C /usr/src/php --strip-components=1 \\\n && rm php.tar.bz2*\nRUN cd /usr/src/php \\\n && ./configure --with-config-file-path=\"$PHP_INI_DIR\" --with-config-file-scan-dir=\"$PHP_INI_DIR/conf.d\" $PHP_EXTRA_CONFIGURE_ARGS --disable-cgi --enable-mysqlnd --with-curl --with-openssl --with-pcre --with-readline --with-recode --with-zlib \\\n && make -j\"$( nproc ;)\" \\\n && make install \\\n && { find /usr/local/bin /usr/local/sbin -type f -executable -exec strip --strip-all '{}' + || true ; } \\\n && apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false -o APT::AutoRemove::SuggestsImportant=false $buildDeps \\\n && make clean\nCOPY docker-php-ext-* /usr/local/bin/\nWORKDIR /var/www/html\nCOPY php-fpm.conf /usr/local/etc/\nEXPOSE 9000/tcp\nCMD [\"php-fpm\"]\nRUN apt-get update \\\n && apt-get install --no-install-recommends libfreetype6-dev libmcrypt-dev libpng12-dev libjpeg-dev libgmp-dev libxml2-dev zlib1g-dev libncurses5-dev libldap2-dev libicu-dev libmemcached-dev libcurl4-openssl-dev libssl-dev php-pear curl ssmtp mysql-client git subversion wget -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && wget https://getcomposer.org/download/1.2.4/composer.phar -O /usr/local/bin/composer \\\n && chmod a+rx /usr/local/bin/composer\nRUN docker-php-ext-configure ldap --with-libdir=lib/x86_64-linux-gnu/ \\\n && docker-php-ext-configure pdo_mysql --with-pdo-mysql=mysqlnd \\\n && docker-php-ext-configure mysql --with-mysql=mysqlnd \\\n && docker-php-ext-configure mysqli --with-mysqli=mysqlnd \\\n && docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/lib \\\n && docker-php-ext-install pdo_mysql \\\n && docker-php-ext-install mysqli \\\n && docker-php-ext-install mysql \\\n && docker-php-ext-install ldap \\\n && docker-php-ext-install soap \\\n && docker-php-ext-install intl \\\n && docker-php-ext-install mcrypt \\\n && docker-php-ext-install gd \\\n && docker-php-ext-install gmp \\\n && docker-php-ext-install bcmath \\\n && docker-php-ext-install mbstring \\\n && docker-php-ext-install zip \\\n && docker-php-ext-install pcntl \\\n && docker-php-ext-install ftp \\\n && docker-php-ext-install sockets \\\n && pecl install mongo \\\n && pecl install memcached-1.0.2 \\\n && pecl install redis\nENV LOCALTIME=\"Europe/Paris\"\nENV PHPFPM__access.format=\"'\\\"%R - %u [%t] \\\"%m %r\\\" %s %l %Q %f\\\"'\"\nRUN rm $PHP_INI_DIR/conf.d/docker-php-ext* \\\n && echo 'sendmail_path = /usr/sbin/ssmtp -t' >> $PHP_INI_DIR/conf.d/00-default.ini \\\n && echo \"\\ninclude=/usr/local/etc/php-fpm.d/*.conf\" >> /usr/local/etc/php-fpm.conf \\\n && mkdir -p /usr/local/etc/php-fpm.d \\\n && chmod a+w -R $PHP_INI_DIR/conf.d/ /etc/ssmtp /usr/local/etc/php-fpm.d\nRUN which wget &> /dev/null || apt-get install --no-install-recommends wget=1.20.3 ; wget --no-verbose --output-document /tmp/blackfire-probe.tar.gz https://blackfire.io/api/v1/releases/probe/php/linux/amd64/53\nRUN tar zxpf /tmp/blackfire-probe.tar.gz -C /tmp \\\n && mv /tmp/blackfire-*.so `php -r \"echo ini_get('extension_dir');\" `/blackfire.so \\\n && rm /tmp/blackfire-probe.tar.gz\nCOPY docker-entrypoint.sh /entrypoint.sh\nWORKDIR /var/www\nENTRYPOINT [\"/entrypoint.sh\"]\nCMD [\"php-fpm\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM debian:wheezy\nLABEL maintainer=\"Alterway <iac@alterway.fr>\"\nRUN apt-get update \\\n && apt-get install --no-install-recommends ca-certificates curl libpcre3 librecode0 libsqlite3-0 libxml2 autoconf file g++ gcc libc-dev make pkg-config re2c -y \\\n && rm -r /var/lib/apt/lists/*\nENV PHP_INI_DIR=\"/usr/local/etc/php\"\nRUN mkdir -p $PHP_INI_DIR/conf.d\nENV PHP_EXTRA_CONFIGURE_ARGS=\"--enable-fpm --with-fpm-user=www-data --with-fpm-group=www-data\"\nENV GPG_KEYS=\"0A95E9A026542D53835E3F3A7DEC4E69FC9C83D7\"\nRUN set -xe \\\n && for key in $GPG_KEYS; do gpg --keyserver ha.pool.sks-keyservers.net --recv-keys \"$key\" ; done\nENV PHP_VERSION=\"5.3.29\"\nRUN buildDeps=\" $PHP_EXTRA_BUILD_DEPS bzip2 libcurl4-openssl-dev libpcre3-dev libreadline6-dev librecode-dev libsqlite3-dev libssl-dev libxml2-dev \" \\\n && set -x \\\n && apt-get update \\\n && apt-get install --no-install-recommends $buildDeps -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && curl -SL \"http://php.net/get/php-$PHP_VERSION.tar.bz2/from/this/mirror\" -o php.tar.bz2 \\\n && curl -SL \"http://php.net/get/php-$PHP_VERSION.tar.bz2.asc/from/this/mirror\" -o php.tar.bz2.asc \\\n && gpg --verify php.tar.bz2.asc \\\n && mkdir -p /usr/src/php \\\n && tar -xof php.tar.bz2 -C /usr/src/php --strip-components=1 \\\n && rm php.tar.bz2*\nRUN cd /usr/src/php \\\n && ./configure --with-config-file-path=\"$PHP_INI_DIR\" --with-config-file-scan-dir=\"$PHP_INI_DIR/conf.d\" $PHP_EXTRA_CONFIGURE_ARGS --disable-cgi --enable-mysqlnd --with-curl --with-openssl --with-pcre --with-readline --with-recode --with-zlib \\\n && make -j\"$( nproc ;)\" \\\n && make install \\\n && { find /usr/local/bin /usr/local/sbin -type f -executable -exec strip --strip-all '{}' + || true ; } \\\n && apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false -o APT::AutoRemove::SuggestsImportant=false $buildDeps \\\n && make clean\nCOPY docker-php-ext-* /usr/local/bin/\nWORKDIR /var/www/html\nCOPY php-fpm.conf /usr/local/etc/\nEXPOSE 9000/tcp\nCMD [\"php-fpm\"]\nRUN apt-get update \\\n && apt-get install libfreetype6-dev libmcrypt-dev libpng12-dev libjpeg-dev libgmp-dev libxml2-dev zlib1g-dev libncurses5-dev libldap2-dev libicu-dev libmemcached-dev libcurl4-openssl-dev libssl-dev php-pear curl ssmtp mysql-client git subversion wget -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && wget https://getcomposer.org/download/1.2.4/composer.phar -O /usr/local/bin/composer \\\n && chmod a+rx /usr/local/bin/composer\nRUN docker-php-ext-configure ldap --with-libdir=lib/x86_64-linux-gnu/ \\\n && docker-php-ext-configure pdo_mysql --with-pdo-mysql=mysqlnd \\\n && docker-php-ext-configure mysql --with-mysql=mysqlnd \\\n && docker-php-ext-configure mysqli --with-mysqli=mysqlnd \\\n && docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/lib \\\n && docker-php-ext-install pdo_mysql \\\n && docker-php-ext-install mysqli \\\n && docker-php-ext-install mysql \\\n && docker-php-ext-install ldap \\\n && docker-php-ext-install soap \\\n && docker-php-ext-install intl \\\n && docker-php-ext-install mcrypt \\\n && docker-php-ext-install gd \\\n && docker-php-ext-install gmp \\\n && docker-php-ext-install bcmath \\\n && docker-php-ext-install mbstring \\\n && docker-php-ext-install zip \\\n && docker-php-ext-install pcntl \\\n && docker-php-ext-install ftp \\\n && docker-php-ext-install sockets \\\n && pecl install mongo \\\n && pecl install memcached-1.0.2 \\\n && pecl install redis\nENV LOCALTIME=\"Europe/Paris\"\nENV PHPFPM__access.format=\"'\\\"%R - %u [%t] \\\"%m %r\\\" %s %l %Q %f\\\"'\"\nRUN rm $PHP_INI_DIR/conf.d/docker-php-ext* \\\n && echo 'sendmail_path = /usr/sbin/ssmtp -t' >> $PHP_INI_DIR/conf.d/00-default.ini \\\n && echo \"\\ninclude=/usr/local/etc/php-fpm.d/*.conf\" >> /usr/local/etc/php-fpm.conf \\\n && mkdir -p /usr/local/etc/php-fpm.d \\\n && chmod a+w -R $PHP_INI_DIR/conf.d/ /etc/ssmtp /usr/local/etc/php-fpm.d\nADD https://blackfire.io/api/v1/releases/probe/php/linux/amd64/53 /tmp/blackfire-probe.tar.gz\nRUN tar zxpf /tmp/blackfire-probe.tar.gz -C /tmp \\\n && mv /tmp/blackfire-*.so `php -r \"echo ini_get('extension_dir');\" `/blackfire.so \\\n && rm /tmp/blackfire-probe.tar.gz\nCOPY docker-entrypoint.sh /entrypoint.sh\nWORKDIR /var/www\nENTRYPOINT [\"/entrypoint.sh\"]\nCMD [\"php-fpm\"]\n","injectedSmells":[],"originalDockerfileHash":"b2529ff0dc8674a119a8439491e1d1fc","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM debian:wheezy\nLABEL maintainer=\"Alterway <iac@alterway.fr>\"\nRUN apt-get update \\\n && apt-get install --no-install-recommends ca-certificates curl libpcre3 librecode0 libsqlite3-0 libxml2 autoconf file g++ gcc libc-dev make pkg-config re2c -y \\\n && rm -r /var/lib/apt/lists/*\nENV PHP_INI_DIR=\"/usr/local/etc/php\"\nRUN mkdir -p $PHP_INI_DIR/conf.d\nENV PHP_EXTRA_CONFIGURE_ARGS=\"--enable-fpm --with-fpm-user=www-data --with-fpm-group=www-data\"\nENV GPG_KEYS=\"0A95E9A026542D53835E3F3A7DEC4E69FC9C83D7\"\nRUN set -xe \\\n && for key in $GPG_KEYS; do gpg --keyserver ha.pool.sks-keyservers.net --recv-keys \"$key\" ; done\nENV PHP_VERSION=\"5.3.29\"\nRUN buildDeps=\" $PHP_EXTRA_BUILD_DEPS bzip2 libcurl4-openssl-dev libpcre3-dev libreadline6-dev librecode-dev libsqlite3-dev libssl-dev libxml2-dev \" \\\n && set -x \\\n && apt-get update \\\n && apt-get install --no-install-recommends $buildDeps -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && curl -SL \"http://php.net/get/php-$PHP_VERSION.tar.bz2/from/this/mirror\" -o php.tar.bz2 \\\n && curl -SL \"http://php.net/get/php-$PHP_VERSION.tar.bz2.asc/from/this/mirror\" -o php.tar.bz2.asc \\\n && gpg --verify php.tar.bz2.asc \\\n && mkdir -p /usr/src/php \\\n && tar -xof php.tar.bz2 -C /usr/src/php --strip-components=1 \\\n && rm php.tar.bz2*\nRUN cd /usr/src/php \\\n && ./configure --with-config-file-path=\"$PHP_INI_DIR\" --with-config-file-scan-dir=\"$PHP_INI_DIR/conf.d\" $PHP_EXTRA_CONFIGURE_ARGS --disable-cgi --enable-mysqlnd --with-curl --with-openssl --with-pcre --with-readline --with-recode --with-zlib \\\n && make -j\"$( nproc ;)\" \\\n && make install \\\n && { find /usr/local/bin /usr/local/sbin -type f -executable -exec strip --strip-all '{}' + || true ; } \\\n && apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false -o APT::AutoRemove::SuggestsImportant=false $buildDeps \\\n && make clean\nCOPY docker-php-ext-* /usr/local/bin/\nWORKDIR /var/www/html\nCOPY php-fpm.conf /usr/local/etc/\nEXPOSE 9000/tcp\nCMD [\"php-fpm\"]\nRUN apt-get update \\\n && apt-get install libfreetype6-dev libmcrypt-dev libpng12-dev libjpeg-dev libgmp-dev libxml2-dev zlib1g-dev libncurses5-dev libldap2-dev libicu-dev libmemcached-dev libcurl4-openssl-dev libssl-dev php-pear curl ssmtp mysql-client git subversion wget -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && wget https://getcomposer.org/download/1.2.4/composer.phar -O /usr/local/bin/composer \\\n && chmod a+rx /usr/local/bin/composer\nRUN docker-php-ext-configure ldap --with-libdir=lib/x86_64-linux-gnu/ \\\n && docker-php-ext-configure pdo_mysql --with-pdo-mysql=mysqlnd \\\n && docker-php-ext-configure mysql --with-mysql=mysqlnd \\\n && docker-php-ext-configure mysqli --with-mysqli=mysqlnd \\\n && docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/lib \\\n && docker-php-ext-install pdo_mysql \\\n && docker-php-ext-install mysqli \\\n && docker-php-ext-install mysql \\\n && docker-php-ext-install ldap \\\n && docker-php-ext-install soap \\\n && docker-php-ext-install intl \\\n && docker-php-ext-install mcrypt \\\n && docker-php-ext-install gd \\\n && docker-php-ext-install gmp \\\n && docker-php-ext-install bcmath \\\n && docker-php-ext-install mbstring \\\n && docker-php-ext-install zip \\\n && docker-php-ext-install pcntl \\\n && docker-php-ext-install ftp \\\n && docker-php-ext-install sockets \\\n && pecl install mongo \\\n && pecl install memcached-1.0.2 \\\n && pecl install redis\nENV LOCALTIME=\"Europe/Paris\"\nENV PHPFPM__access.format=\"'\\\"%R - %u [%t] \\\"%m %r\\\" %s %l %Q %f\\\"'\"\nRUN rm $PHP_INI_DIR/conf.d/docker-php-ext* \\\n && echo 'sendmail_path = /usr/sbin/ssmtp -t' >> $PHP_INI_DIR/conf.d/00-default.ini \\\n && echo \"\\ninclude=/usr/local/etc/php-fpm.d/*.conf\" >> /usr/local/etc/php-fpm.conf \\\n && mkdir -p /usr/local/etc/php-fpm.d \\\n && chmod a+w -R $PHP_INI_DIR/conf.d/ /etc/ssmtp /usr/local/etc/php-fpm.d\nADD https://blackfire.io/api/v1/releases/probe/php/linux/amd64/53 /tmp/blackfire-probe.tar.gz\nRUN tar zxpf /tmp/blackfire-probe.tar.gz -C /tmp \\\n && mv /tmp/blackfire-*.so `php -r \"echo ini_get('extension_dir');\" `/blackfire.so \\\n && rm /tmp/blackfire-probe.tar.gz\nCOPY docker-entrypoint.sh /entrypoint.sh\nWORKDIR /var/www\nENTRYPOINT [\"/entrypoint.sh\"]\nCMD [\"php-fpm\"]\n","originalDockerfileUglifiedHash":"b2529ff0dc8674a119a8439491e1d1fc","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/15b41e254c6b2cb81ff00dc3a2eaecbef354f37f.dockerfile"}