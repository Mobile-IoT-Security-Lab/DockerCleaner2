{"seed":2671053029,"processedDockerfileHash":"1e19ccf206ff274b104e2cedba16e625","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","pin-package-manager-versions-apt-get","have-a-healthcheck"],"processedDockerfile":"#   Name:         Dockerfile\n#   Description:  build the mercuryiss/kali docker image\n#   Date:         2018-01-09\n#   Author:       Alexi Chiotis - Mercury ISS\nFROM kalilinux/kali-linux-docker\n#   HACK: prepend AARNet mirror so as to circumvent apt-get 404s\nRUN sed -i \"s/https\\.kali\\.org/mirror\\.aarnet\\.edu\\.au\\/pub\\/kali/g\" /etc/apt/sources.list\n#   update the archive keyring \n#   https://unix.stackexchange.com/questions/421985/invalid-signature-when-trying-to-apt-get-update-on-kali\nRUN apt-get update \\\n && apt-get install --no-install-recommends gnupg=2.2.40-1ubuntu2 curl=7.88.1-7ubuntu1 -y\n#  RUN wget -q -O - https://archive.kali.org/archive-key.asc  | apt-key add\nRUN curl https://archive.kali.org/archive-key.asc | apt-key add\n#   get faster mirrors into apt/sources.list\n#  RUN apt-get update && apt-get install -y netselect-apt\n#  RUN cp /etc/apt/sources.list /etc/apt/sources.list.bak\n#  RUN netselect-apt\n#  RUN cp sources.list /etc/apt/sources.list\n#   default install is bare, install some tools \nRUN apt-get update \\\n && apt-get install --no-install-recommends arachni beef-xss cutycapt=0.0~svn10-0.1build1 dirbuster exploitdb fierce=1.5.0-1 firefox-esr git=1:2.39.2-1ubuntu1 gpp-decrypt hydra=9.4-1 john=1.8.0-4ubuntu3 locate=4.9.0-3ubuntu1 man metasploit-framework nbtscan=1.7.2-2 netselect-apt nikto=1:2.1.5-3.1 nmap=7.93+dfsg1-1 python-pip responder skipfish sparta sqlitebrowser=3.12.2-1 sqlmap=1.7.3-1 unicornscan vim=2:9.0.1000-4ubuntu2 virtualenv=20.19.0+ds-1 websploit=4.0.4-3 whois=5.5.16 wordlists wpscan zenmap -y\n#   install those packages that have interactive installation method\nWORKDIR /tmp\n#   set up powershell-empire\nRUN apt-get install --no-install-recommends multiarch-support -y\nRUN wget http://http.us.debian.org/debian/pool/main/o/openssl/libssl1.0.0_1.0.1t-1+deb8u7_amd64.deb\nRUN dpkg -i libssl1.0.0_1.0.1t-1+deb8u7_amd64.deb\nWORKDIR /usr/share\nRUN git clone https://github.com/EmpireProject/Empire empire\nWORKDIR empire/setup\nRUN printf \"Y\\n\\n\" | ./install.sh\nWORKDIR /usr/bin\nRUN echo 'cd /usr/share/empire/ \\\n && /usr/share/empire/empire' > empire \\\n && chmod +x empire\n#   use our custom .bashrc, used for different colour prompt string\nCOPY bashrc /root/.bashrc\n#   TODO append localhost entry to container /etc/hosts for sudo\nCOPY hosts /etc/hosts\n#   Set local timezone\nRUN cp /usr/share/zoneinfo/Australia/Sydney /etc/localtime\n#   accept --build-arg arguments\nARG USERNAME\nARG UID\nARG GID\n#   copy these host environment variables into the container environment\nENV USERNAME=\"$USERNAME\"\nENV UID=\"$UID\"\nENV GID=\"$GID\"\nENV COLUMNS=\"$COLUMNS\"\nENV LINES=\"$LINES\"\n#   add pentest user within kali and run as non-privileged, in sudo group\n#   note that if you use --net to start container, the username passed should be\n#   available in the host's /etc/passwd\n#   http://wiki.ros.org/docker/Tutorials/GUI \nRUN useradd -m $USERNAME \\\n && echo \"$USERNAME:$USERNAME\" | chpasswd \\\n && usermod --shell /bin/bash $USERNAME \\\n && usermod -aG sudo $USERNAME \\\n && echo \"$USERNAME ALL=(ALL) NOPASSWD:ALL\" >> /etc/sudoers.d/$USERNAME \\\n && chmod 0440 /etc/sudoers.d/$USERNAME \\\n && usermod --uid $UID $USERNAME \\\n && groupmod --gid $GID $USERNAME\nUSER $USERNAME\nENV HOME=\"/home/$USERNAME\"\nWORKDIR $HOME\nRUN ln -s /usr/share/wordlists/\nRUN ln -s /var/www/html/ www\nRUN ln -s /data\nRUN ln -s /scripts\nRUN ln -s /installers\nCOPY bashrc .bashrc\n#   https://raw.githubusercontent.com/makefu/dnsmap/master/wordlist_TLAs.txt\nCOPY dnsmap.txt wordlists/\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  Name:         Dockerfile\n#  Description:  build the mercuryiss/kali docker image\n#  Date:         2018-01-09\n#  Author:       Alexi Chiotis - Mercury ISS\nFROM kalilinux/kali-linux-docker\n#  HACK: prepend AARNet mirror so as to circumvent apt-get 404s\nRUN sed -i \"s/https\\.kali\\.org/mirror\\.aarnet\\.edu\\.au\\/pub\\/kali/g\" /etc/apt/sources.list\n#  update the archive keyring \n#  https://unix.stackexchange.com/questions/421985/invalid-signature-when-trying-to-apt-get-update-on-kali\nRUN apt-get update \\\n && apt-get install gnupg curl -y\n# RUN wget -q -O - https://archive.kali.org/archive-key.asc  | apt-key add\nRUN curl https://archive.kali.org/archive-key.asc | apt-key add\n#  get faster mirrors into apt/sources.list\n# RUN apt-get update && apt-get install -y netselect-apt\n# RUN cp /etc/apt/sources.list /etc/apt/sources.list.bak\n# RUN netselect-apt\n# RUN cp sources.list /etc/apt/sources.list\n#  default install is bare, install some tools \nRUN apt-get update \\\n && apt-get install arachni beef-xss cutycapt dirbuster exploitdb fierce firefox-esr git gpp-decrypt hydra john locate man metasploit-framework nbtscan netselect-apt nikto nmap python-pip responder skipfish sparta sqlitebrowser sqlmap unicornscan vim virtualenv websploit whois wordlists wpscan zenmap -y\n#  install those packages that have interactive installation method\nWORKDIR /tmp\n#  set up powershell-empire\nRUN apt-get install multiarch-support -y\nRUN wget http://http.us.debian.org/debian/pool/main/o/openssl/libssl1.0.0_1.0.1t-1+deb8u7_amd64.deb\nRUN dpkg -i libssl1.0.0_1.0.1t-1+deb8u7_amd64.deb\nWORKDIR /usr/share\nRUN git clone https://github.com/EmpireProject/Empire empire\nWORKDIR empire/setup\nRUN printf \"Y\\n\\n\" | ./install.sh\nWORKDIR /usr/bin\nRUN echo 'cd /usr/share/empire/ \\\n && /usr/share/empire/empire' > empire \\\n && chmod +x empire\n#  use our custom .bashrc, used for different colour prompt string\nCOPY bashrc /root/.bashrc\n#  TODO append localhost entry to container /etc/hosts for sudo\nCOPY hosts /etc/hosts\n#  Set local timezone\nRUN cp /usr/share/zoneinfo/Australia/Sydney /etc/localtime\n#  accept --build-arg arguments\nARG USERNAME\nARG UID\nARG GID\n#  copy these host environment variables into the container environment\nENV USERNAME=\"$USERNAME\"\nENV UID=\"$UID\"\nENV GID=\"$GID\"\nENV COLUMNS=\"$COLUMNS\"\nENV LINES=\"$LINES\"\n#  add pentest user within kali and run as non-privileged, in sudo group\n#  note that if you use --net to start container, the username passed should be\n#  available in the host's /etc/passwd\n#  http://wiki.ros.org/docker/Tutorials/GUI \nRUN useradd -m $USERNAME \\\n && echo \"$USERNAME:$USERNAME\" | chpasswd \\\n && usermod --shell /bin/bash $USERNAME \\\n && usermod -aG sudo $USERNAME \\\n && echo \"$USERNAME ALL=(ALL) NOPASSWD:ALL\" >> /etc/sudoers.d/$USERNAME \\\n && chmod 0440 /etc/sudoers.d/$USERNAME \\\n && usermod --uid $UID $USERNAME \\\n && groupmod --gid $GID $USERNAME\nUSER $USERNAME\nENV HOME=\"/home/$USERNAME\"\nWORKDIR $HOME\nRUN ln -s /usr/share/wordlists/\nRUN ln -s /var/www/html/ www\nRUN ln -s /data\nRUN ln -s /scripts\nRUN ln -s /installers\nCOPY bashrc .bashrc\n#  https://raw.githubusercontent.com/makefu/dnsmap/master/wordlist_TLAs.txt\nCOPY dnsmap.txt wordlists/\n","injectedSmells":[],"originalDockerfileHash":"28562b14c36b35c6e11d57799f3508e5","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   Name:         Dockerfile\n#   Description:  build the mercuryiss/kali docker image\n#   Date:         2018-01-09\n#   Author:       Alexi Chiotis - Mercury ISS\nFROM kalilinux/kali-linux-docker\n#   HACK: prepend AARNet mirror so as to circumvent apt-get 404s\nRUN sed -i \"s/https\\.kali\\.org/mirror\\.aarnet\\.edu\\.au\\/pub\\/kali/g\" /etc/apt/sources.list\n#   update the archive keyring \n#   https://unix.stackexchange.com/questions/421985/invalid-signature-when-trying-to-apt-get-update-on-kali\nRUN apt-get update \\\n && apt-get install gnupg curl -y\n#  RUN wget -q -O - https://archive.kali.org/archive-key.asc  | apt-key add\nRUN curl https://archive.kali.org/archive-key.asc | apt-key add\n#   get faster mirrors into apt/sources.list\n#  RUN apt-get update && apt-get install -y netselect-apt\n#  RUN cp /etc/apt/sources.list /etc/apt/sources.list.bak\n#  RUN netselect-apt\n#  RUN cp sources.list /etc/apt/sources.list\n#   default install is bare, install some tools \nRUN apt-get update \\\n && apt-get install arachni beef-xss cutycapt dirbuster exploitdb fierce firefox-esr git gpp-decrypt hydra john locate man metasploit-framework nbtscan netselect-apt nikto nmap python-pip responder skipfish sparta sqlitebrowser sqlmap unicornscan vim virtualenv websploit whois wordlists wpscan zenmap -y\n#   install those packages that have interactive installation method\nWORKDIR /tmp\n#   set up powershell-empire\nRUN apt-get install multiarch-support -y\nRUN wget http://http.us.debian.org/debian/pool/main/o/openssl/libssl1.0.0_1.0.1t-1+deb8u7_amd64.deb\nRUN dpkg -i libssl1.0.0_1.0.1t-1+deb8u7_amd64.deb\nWORKDIR /usr/share\nRUN git clone https://github.com/EmpireProject/Empire empire\nWORKDIR empire/setup\nRUN printf \"Y\\n\\n\" | ./install.sh\nWORKDIR /usr/bin\nRUN echo 'cd /usr/share/empire/ \\\n && /usr/share/empire/empire' > empire \\\n && chmod +x empire\n#   use our custom .bashrc, used for different colour prompt string\nCOPY bashrc /root/.bashrc\n#   TODO append localhost entry to container /etc/hosts for sudo\nCOPY hosts /etc/hosts\n#   Set local timezone\nRUN cp /usr/share/zoneinfo/Australia/Sydney /etc/localtime\n#   accept --build-arg arguments\nARG USERNAME\nARG UID\nARG GID\n#   copy these host environment variables into the container environment\nENV USERNAME=\"$USERNAME\"\nENV UID=\"$UID\"\nENV GID=\"$GID\"\nENV COLUMNS=\"$COLUMNS\"\nENV LINES=\"$LINES\"\n#   add pentest user within kali and run as non-privileged, in sudo group\n#   note that if you use --net to start container, the username passed should be\n#   available in the host's /etc/passwd\n#   http://wiki.ros.org/docker/Tutorials/GUI \nRUN useradd -m $USERNAME \\\n && echo \"$USERNAME:$USERNAME\" | chpasswd \\\n && usermod --shell /bin/bash $USERNAME \\\n && usermod -aG sudo $USERNAME \\\n && echo \"$USERNAME ALL=(ALL) NOPASSWD:ALL\" >> /etc/sudoers.d/$USERNAME \\\n && chmod 0440 /etc/sudoers.d/$USERNAME \\\n && usermod --uid $UID $USERNAME \\\n && groupmod --gid $GID $USERNAME\nUSER $USERNAME\nENV HOME=\"/home/$USERNAME\"\nWORKDIR $HOME\nRUN ln -s /usr/share/wordlists/\nRUN ln -s /var/www/html/ www\nRUN ln -s /data\nRUN ln -s /scripts\nRUN ln -s /installers\nCOPY bashrc .bashrc\n#   https://raw.githubusercontent.com/makefu/dnsmap/master/wordlist_TLAs.txt\nCOPY dnsmap.txt wordlists/\n","originalDockerfileUglifiedHash":"5f034e03126d14e7bf7efdb74dece4cf","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/dd8b96895f1acb7626caa2e393b6411fab85ceaf.dockerfile"}