{"seed":495912132,"processedDockerfileHash":"78c72bbc2856f95fd78c75c63a9b64ba","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apt-get","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM debian:stretch AS buildstage\nARG KODI_NAME=\"Leia\"\nARG KODI_VERSION=\"18.2\"\nARG DEBIAN_FRONTEND=\"noninteractive\"\nCOPY dpkg_excludes /etc/dpkg/dpkg.cfg.d/excludes\nRUN apt-get update \\\n && apt-get install --no-install-recommends ant=1.9.9-1+deb9u1 git-core=1:2.11.0-3+deb9u7 build-essential=12.3 autoconf=2.69-10 automake=1:1.15-6 cmake=3.7.2-1 pkg-config=0.29-4+b1 autopoint=0.19.8.1-2+deb9u1 libtool=2.4.6-2 swig=3.0.10-1.1 doxygen=1.8.13-4+b1 default-jdk-headless=2:1.8-58+deb9u1 libbz2-dev=1.0.6-8.1 liblzo2-dev=2.08-1.2+b2 libtinyxml-dev=2.6.2-4+deb9u1 libmariadbclient-dev-compat=10.1.48-0+deb9u2 libcurl4-openssl-dev=7.52.1-5+deb9u16 libssl-dev=1.1.0l-1~deb9u6 libyajl-dev=2.1.0-2+b3 libxml2-dev=2.9.4+dfsg1-2.2+deb9u7 libxslt-dev libsqlite3-dev=3.16.2-5+deb9u3 libnfs-dev=1.11.0-2 libpcre3-dev=2:8.39-3 libtag1-dev=1.11.1+dfsg.1-0.3+deb9u1 libsmbclient-dev=2:4.5.16+dfsg-1+deb9u4 libmicrohttpd-dev=0.9.51-1 libgnutls28-dev=3.5.8-5+deb9u6 libass-dev=1:0.13.4-2 libxrandr-dev=2:1.5.1-1 libegl1-mesa-dev=13.0.6-1+b2 libgif-dev=5.1.4-0.4 libjpeg-dev=1:1.5.1-2+deb9u2 libglu1-mesa-dev=9.0.0-2.1 gawk=1:4.1.4+dfsg-1 gperf=3.0.4-2+b1 curl=7.52.1-5+deb9u16 m4=1.4.18-1 python-dev=2.7.13-2 uuid-dev=2.29.2-1+deb9u1 yasm=1.3.0-2+b1 unzip=6.0-21+deb9u2 libiso9660-dev=0.83-4.3+b1 libfstrcmp-dev=0.7.D001-1.1+b2 zip=3.0-11+b1 -y\nCOPY kodi-headless.patch /tmp/kodi-headless.patch\nRUN mkdir -p /tmp/kodi_src \\\n && curl -o /tmp/kodi.tar.gz -L \"https://github.com/xbmc/xbmc/archive/${KODI_VERSION}-${KODI_NAME}.tar.gz\" \\\n && tar xf /tmp/kodi.tar.gz -C /tmp/kodi_src --strip-components=1 \\\n && cd /tmp/kodi_src \\\n && git apply /tmp/kodi-headless.patch\nRUN mkdir /tmp/kodi_src/build \\\n && cd /tmp/kodi_src/build \\\n && cmake ../ -DCMAKE_INSTALL_LIBDIR=/usr/lib -DCMAKE_INSTALL_PREFIX=/usr -DENABLE_INTERNAL_FLATBUFFERS=ON -DENABLE_INTERNAL_FMT=ON -DENABLE_INTERNAL_RapidJSON=ON -DENABLE_SMBCLIENT=ON -DENABLE_MYSQLCLIENT=ON -DENABLE_NFS=ON -DENABLE_UPNP=ON -DENABLE_LCMS2=OFF -DENABLE_AIRTUNES=OFF -DENABLE_CAP=OFF -DENABLE_DVDCSS=OFF -DENABLE_LIBUSB=OFF -DENABLE_EVENTCLIENTS=OFF -DENABLE_OPTICAL=OFF -DENABLE_CEC=OFF -DENABLE_BLURAY=OFF -DENABLE_BLUETOOTH=OFF -DENABLE_PULSEAUDIO=OFF -DENABLE_AVAHI=OFF -DENABLE_ALSA=OFF -DENABLE_DBUS=OFF -DENABLE_UDEV=OFF -DENABLE_VAAPI=OFF -DENABLE_VDPAU=OFF -DENABLE_GLX=OFF -DENABLE_SNDIO=OFF -DENABLE_LIRCCLIENT=OFF \\\n && make -j$( nproc --all ;) \\\n && make DESTDIR=/tmp/kodi_build install\nRUN cp /tmp/kodi_src/tools/EventClients/Clients/KodiSend/kodi-send.py /tmp/kodi_build/usr/bin/kodi-send \\\n && mkdir -p /tmp/kodi_build/usr/lib/python2.7/ \\\n && cp /tmp/kodi_src/tools/EventClients/lib/python/xbmcclient.py /tmp/kodi_build/usr/lib/python2.7/xbmcclient.py\nFROM debian:stretch\nMAINTAINER milaq\nLABEL build_version=\"Build-date:- ${BUILD_DATE}\"\nCOPY --from=buildstage /tmp/kodi_build/usr/ /usr/\nARG DEBIAN_FRONTEND=\"noninteractive\"\nCOPY dpkg_excludes /etc/dpkg/dpkg.cfg.d/excludes\nRUN apt-get update \\\n && apt-get install --no-install-recommends libcurl3=7.52.1-5+deb9u16 libegl1-mesa=13.0.6-1+b2 libglu1-mesa=9.0.0-2.1 libfreetype6=2.6.3-3.2+deb9u2 libfribidi0=0.19.7-1+deb9u2 libglew2.0=2.0.0-3+b1 liblzo2-2=2.08-1.2+b2 libmicrohttpd12=0.9.51-1 libmariadbclient18=10.1.48-0+deb9u2 libnfs8=1.11.0-2 libpcrecpp0v5=2:8.39-3 libpython2.7=2.7.13-2+deb9u6 libsmbclient=2:4.5.16+dfsg-1+deb9u4 libtag1v5=1.11.1+dfsg.1-0.3+deb9u1 libtinyxml2.6.2v5=2.6.2-4+deb9u1 libxml2=2.9.4+dfsg1-2.2+deb9u7 libcdio13=0.83-4.3+b1 libxcb-shape0=1.12-1 libxrandr2=2:1.5.1-1 libxslt1.1=1.1.29-2.1+deb9u2 libyajl2=2.1.0-2+b3 libass5=1:0.13.4-2 libiso9660-8=0.83-4.3+b1 libfstrcmp0=0.7.D001-1.1+b2 ca-certificates=20200601~deb9u2 -y \\\n && apt-get clean\nRUN mkdir /var/cache/samba\nRUN mkdir -p /config/userdata\nCOPY advancedsettings.xml.default /usr/local/share/kodi/advancedsettings.xml.default\nCOPY smb.conf /config/.smb/user.conf\nCOPY kodi_init /sbin/kodi_init\nRUN useradd -m -u 10000 kodi \\\n && chown kodi. -R /config \\\n && ln -s /config /usr/share/kodi/portable_data\nVOLUME /config\nWORKDIR /config\nEXPOSE 8080/tcp 9090/tcp 9777/udp\nCMD [\"/sbin/kodi_init\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM debian:stretch AS buildstage\nARG KODI_NAME=\"Leia\"\nARG KODI_VERSION=\"18.2\"\nARG DEBIAN_FRONTEND=\"noninteractive\"\nCOPY dpkg_excludes /etc/dpkg/dpkg.cfg.d/excludes\nRUN apt-get update \\\n && apt-get install --no-install-recommends ant git-core build-essential autoconf automake cmake pkg-config autopoint libtool swig doxygen default-jdk-headless libbz2-dev liblzo2-dev libtinyxml-dev libmariadbclient-dev-compat libcurl4-openssl-dev libssl-dev libyajl-dev libxml2-dev libxslt-dev libsqlite3-dev libnfs-dev libpcre3-dev libtag1-dev libsmbclient-dev libmicrohttpd-dev libgnutls28-dev libass-dev libxrandr-dev libegl1-mesa-dev libgif-dev libjpeg-dev libglu1-mesa-dev gawk gperf curl m4 python-dev uuid-dev yasm unzip libiso9660-dev libfstrcmp-dev zip -y\nCOPY kodi-headless.patch /tmp/kodi-headless.patch\nRUN mkdir -p /tmp/kodi_src \\\n && curl -o /tmp/kodi.tar.gz -L \"https://github.com/xbmc/xbmc/archive/${KODI_VERSION}-${KODI_NAME}.tar.gz\" \\\n && tar xf /tmp/kodi.tar.gz -C /tmp/kodi_src --strip-components=1 \\\n && cd /tmp/kodi_src \\\n && git apply /tmp/kodi-headless.patch\nRUN mkdir /tmp/kodi_src/build \\\n && cd /tmp/kodi_src/build \\\n && cmake ../ -DCMAKE_INSTALL_LIBDIR=/usr/lib -DCMAKE_INSTALL_PREFIX=/usr -DENABLE_INTERNAL_FLATBUFFERS=ON -DENABLE_INTERNAL_FMT=ON -DENABLE_INTERNAL_RapidJSON=ON -DENABLE_SMBCLIENT=ON -DENABLE_MYSQLCLIENT=ON -DENABLE_NFS=ON -DENABLE_UPNP=ON -DENABLE_LCMS2=OFF -DENABLE_AIRTUNES=OFF -DENABLE_CAP=OFF -DENABLE_DVDCSS=OFF -DENABLE_LIBUSB=OFF -DENABLE_EVENTCLIENTS=OFF -DENABLE_OPTICAL=OFF -DENABLE_CEC=OFF -DENABLE_BLURAY=OFF -DENABLE_BLUETOOTH=OFF -DENABLE_PULSEAUDIO=OFF -DENABLE_AVAHI=OFF -DENABLE_ALSA=OFF -DENABLE_DBUS=OFF -DENABLE_UDEV=OFF -DENABLE_VAAPI=OFF -DENABLE_VDPAU=OFF -DENABLE_GLX=OFF -DENABLE_SNDIO=OFF -DENABLE_LIRCCLIENT=OFF \\\n && make -j$( nproc --all ;) \\\n && make DESTDIR=/tmp/kodi_build install\nRUN cp /tmp/kodi_src/tools/EventClients/Clients/KodiSend/kodi-send.py /tmp/kodi_build/usr/bin/kodi-send \\\n && mkdir -p /tmp/kodi_build/usr/lib/python2.7/ \\\n && cp /tmp/kodi_src/tools/EventClients/lib/python/xbmcclient.py /tmp/kodi_build/usr/lib/python2.7/xbmcclient.py\nFROM debian:stretch\nMAINTAINER milaq\nLABEL build_version=\"Build-date:- ${BUILD_DATE}\"\nCOPY --from=buildstage /tmp/kodi_build/usr/ /usr/\nARG DEBIAN_FRONTEND=\"noninteractive\"\nCOPY dpkg_excludes /etc/dpkg/dpkg.cfg.d/excludes\nRUN apt-get update \\\n && apt-get install --no-install-recommends libcurl3 libegl1-mesa libglu1-mesa libfreetype6 libfribidi0 libglew2.0 liblzo2-2 libmicrohttpd12 libmariadbclient18 libnfs8 libpcrecpp0v5 libpython2.7 libsmbclient libtag1v5 libtinyxml2.6.2v5 libxml2 libcdio13 libxcb-shape0 libxrandr2 libxslt1.1 libyajl2 libass5 libiso9660-8 libfstrcmp0 ca-certificates -y \\\n && apt-get clean\nRUN mkdir /var/cache/samba\nRUN mkdir -p /config/userdata\nCOPY advancedsettings.xml.default /usr/local/share/kodi/advancedsettings.xml.default\nCOPY smb.conf /config/.smb/user.conf\nCOPY kodi_init /sbin/kodi_init\nRUN useradd -m -u 10000 kodi \\\n && chown kodi. -R /config \\\n && ln -s /config /usr/share/kodi/portable_data\nVOLUME /config\nWORKDIR /config\nEXPOSE 8080/tcp 9090/tcp 9777/udp\nCMD [\"/sbin/kodi_init\"]\n","injectedSmells":[],"originalDockerfileHash":"11965a33e3ae7c835250ae581d8f04c4","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM debian:stretch AS buildstage\nARG KODI_NAME=\"Leia\"\nARG KODI_VERSION=\"18.2\"\nARG DEBIAN_FRONTEND=\"noninteractive\"\nCOPY dpkg_excludes /etc/dpkg/dpkg.cfg.d/excludes\nRUN apt-get update \\\n && apt-get install --no-install-recommends ant git-core build-essential autoconf automake cmake pkg-config autopoint libtool swig doxygen default-jdk-headless libbz2-dev liblzo2-dev libtinyxml-dev libmariadbclient-dev-compat libcurl4-openssl-dev libssl-dev libyajl-dev libxml2-dev libxslt-dev libsqlite3-dev libnfs-dev libpcre3-dev libtag1-dev libsmbclient-dev libmicrohttpd-dev libgnutls28-dev libass-dev libxrandr-dev libegl1-mesa-dev libgif-dev libjpeg-dev libglu1-mesa-dev gawk gperf curl m4 python-dev uuid-dev yasm unzip libiso9660-dev libfstrcmp-dev zip -y\nCOPY kodi-headless.patch /tmp/kodi-headless.patch\nRUN mkdir -p /tmp/kodi_src \\\n && curl -o /tmp/kodi.tar.gz -L \"https://github.com/xbmc/xbmc/archive/${KODI_VERSION}-${KODI_NAME}.tar.gz\" \\\n && tar xf /tmp/kodi.tar.gz -C /tmp/kodi_src --strip-components=1 \\\n && cd /tmp/kodi_src \\\n && git apply /tmp/kodi-headless.patch\nRUN mkdir /tmp/kodi_src/build \\\n && cd /tmp/kodi_src/build \\\n && cmake ../ -DCMAKE_INSTALL_LIBDIR=/usr/lib -DCMAKE_INSTALL_PREFIX=/usr -DENABLE_INTERNAL_FLATBUFFERS=ON -DENABLE_INTERNAL_FMT=ON -DENABLE_INTERNAL_RapidJSON=ON -DENABLE_SMBCLIENT=ON -DENABLE_MYSQLCLIENT=ON -DENABLE_NFS=ON -DENABLE_UPNP=ON -DENABLE_LCMS2=OFF -DENABLE_AIRTUNES=OFF -DENABLE_CAP=OFF -DENABLE_DVDCSS=OFF -DENABLE_LIBUSB=OFF -DENABLE_EVENTCLIENTS=OFF -DENABLE_OPTICAL=OFF -DENABLE_CEC=OFF -DENABLE_BLURAY=OFF -DENABLE_BLUETOOTH=OFF -DENABLE_PULSEAUDIO=OFF -DENABLE_AVAHI=OFF -DENABLE_ALSA=OFF -DENABLE_DBUS=OFF -DENABLE_UDEV=OFF -DENABLE_VAAPI=OFF -DENABLE_VDPAU=OFF -DENABLE_GLX=OFF -DENABLE_SNDIO=OFF -DENABLE_LIRCCLIENT=OFF \\\n && make -j$( nproc --all ;) \\\n && make DESTDIR=/tmp/kodi_build install\nRUN cp /tmp/kodi_src/tools/EventClients/Clients/KodiSend/kodi-send.py /tmp/kodi_build/usr/bin/kodi-send \\\n && mkdir -p /tmp/kodi_build/usr/lib/python2.7/ \\\n && cp /tmp/kodi_src/tools/EventClients/lib/python/xbmcclient.py /tmp/kodi_build/usr/lib/python2.7/xbmcclient.py\nFROM debian:stretch\nMAINTAINER milaq\nLABEL build_version=\"Build-date:- ${BUILD_DATE}\"\nCOPY --from=buildstage /tmp/kodi_build/usr/ /usr/\nARG DEBIAN_FRONTEND=\"noninteractive\"\nCOPY dpkg_excludes /etc/dpkg/dpkg.cfg.d/excludes\nRUN apt-get update \\\n && apt-get install --no-install-recommends libcurl3 libegl1-mesa libglu1-mesa libfreetype6 libfribidi0 libglew2.0 liblzo2-2 libmicrohttpd12 libmariadbclient18 libnfs8 libpcrecpp0v5 libpython2.7 libsmbclient libtag1v5 libtinyxml2.6.2v5 libxml2 libcdio13 libxcb-shape0 libxrandr2 libxslt1.1 libyajl2 libass5 libiso9660-8 libfstrcmp0 ca-certificates -y \\\n && apt-get clean\nRUN mkdir /var/cache/samba\nRUN mkdir -p /config/userdata\nCOPY advancedsettings.xml.default /usr/local/share/kodi/advancedsettings.xml.default\nCOPY smb.conf /config/.smb/user.conf\nCOPY kodi_init /sbin/kodi_init\nRUN useradd -m -u 10000 kodi \\\n && chown kodi. -R /config \\\n && ln -s /config /usr/share/kodi/portable_data\nVOLUME /config\nWORKDIR /config\nEXPOSE 8080/tcp 9090/tcp 9777/udp\nCMD [\"/sbin/kodi_init\"]\n","originalDockerfileUglifiedHash":"11965a33e3ae7c835250ae581d8f04c4","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/3a7c8b20891f13008eb5d82ff7c4fcb49a6e1fe2.dockerfile"}