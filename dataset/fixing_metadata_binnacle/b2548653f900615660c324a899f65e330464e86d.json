{"seed":3923739238,"processedDockerfileHash":"5a3cf88ac596768134298104643850b5","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM rocker/r-ver:3.5.2\nARG RSTUDIO_VERSION\nENV RSTUDIO_VERSION=\"${RSTUDIO_VERSION:-1.1.463}\"\nARG S6_VERSION\nARG PANDOC_TEMPLATES_VERSION\nENV S6_VERSION=\"${S6_VERSION:-v1.21.7.0}\"\nENV S6_BEHAVIOUR_IF_STAGE2_FAILS=\"2\"\nENV PATH=\"/usr/lib/rstudio-server/bin:$PATH\"\nENV PANDOC_TEMPLATES_VERSION=\"${PANDOC_TEMPLATES_VERSION:-2.6}\"\n#  # Download and install RStudio server & dependencies\n#  # Attempts to get detect latest version, otherwise falls back to version given in $VER\n#  # Symlink pandoc, pandoc-citeproc so they are available system-wide\nRUN apt-get update \\\n && apt-get install --no-install-recommends file git libapparmor1 libcurl4-openssl-dev libedit2 libssl-dev lsb-release psmisc procps python-setuptools sudo wget -y \\\n && wget -O libssl1.0.0.deb http://ftp.debian.org/debian/pool/main/o/openssl/libssl1.0.0_1.0.1t-1+deb8u8_amd64.deb \\\n && dpkg -i libssl1.0.0.deb \\\n && rm libssl1.0.0.deb \\\n && RSTUDIO_LATEST=$( wget --no-check-certificate -qO- https://s3.amazonaws.com/rstudio-server/current.ver ;) \\\n && [ -z \"$RSTUDIO_VERSION\" ] \\\n && RSTUDIO_VERSION=$RSTUDIO_LATEST || true \\\n && wget -q http://download2.rstudio.org/rstudio-server-${RSTUDIO_VERSION}-amd64.deb \\\n && dpkg -i rstudio-server-${RSTUDIO_VERSION}-amd64.deb \\\n && rm rstudio-server-*-amd64.deb \\\n && ln -s /usr/lib/rstudio-server/bin/pandoc/pandoc /usr/local/bin \\\n && ln -s /usr/lib/rstudio-server/bin/pandoc/pandoc-citeproc /usr/local/bin \\\n && git clone --recursive --branch ${PANDOC_TEMPLATES_VERSION} https://github.com/jgm/pandoc-templates \\\n && mkdir -p /opt/pandoc/templates \\\n && cp -r pandoc-templates*/* /opt/pandoc/templates \\\n && rm -rf pandoc-templates* \\\n && mkdir /root/.pandoc \\\n && ln -s /opt/pandoc/templates /root/.pandoc/templates \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/ \\\n && mkdir -p /etc/R \\\n && echo '\\n \\n# Configure httr to perform out-of-band authentication if HTTR_LOCALHOST \\n# is not set since a redirect to localhost may not work depending upon \\n# where this Docker container is running. \\nif(is.na(Sys.getenv(\"HTTR_LOCALHOST\", unset=NA))) { \\n options(httr_oob_default = TRUE) \\n}' >> /usr/local/lib/R/etc/Rprofile.site \\\n && echo \"PATH=${PATH}\" >> /usr/local/lib/R/etc/Renviron \\\n && useradd rstudio \\\n && echo \"rstudio:rstudio\" | chpasswd \\\n && mkdir /home/rstudio \\\n && chown rstudio:rstudio /home/rstudio \\\n && addgroup rstudio staff \\\n && echo 'rsession-which-r=/usr/local/bin/R' >> /etc/rstudio/rserver.conf \\\n && echo 'lock-type=advisory' >> /etc/rstudio/file-locks \\\n && git config --system credential.helper 'cache --timeout=3600' \\\n && git config --system push.default simple \\\n && wget -P /tmp/ https://github.com/just-containers/s6-overlay/releases/download/${S6_VERSION}/s6-overlay-amd64.tar.gz \\\n && tar xzf /tmp/s6-overlay-amd64.tar.gz -C / \\\n && mkdir -p /etc/services.d/rstudio \\\n && echo '#!/usr/bin/with-contenv bash \\n## load /etc/environment vars first: \\n for line in $( cat /etc/environment ) ; do export $line ; done \\n exec /usr/lib/rstudio-server/bin/rserver --server-daemonize 0' > /etc/services.d/rstudio/run \\\n && echo '#!/bin/bash \\n rstudio-server stop' > /etc/services.d/rstudio/finish \\\n && mkdir -p /home/rstudio/.rstudio/monitored/user-settings \\\n && echo 'alwaysSaveHistory=\"0\" \\nloadRData=\"0\" \\nsaveAction=\"0\"' > /home/rstudio/.rstudio/monitored/user-settings/user-settings \\\n && chown -R rstudio:rstudio /home/rstudio/.rstudio\nCOPY userconf.sh /etc/cont-init.d/userconf\n#  # running with \"-e ADD=shiny\" adds shiny server\nCOPY add_shiny.sh /etc/cont-init.d/add\nCOPY disable_auth_rserver.conf /etc/rstudio/disable_auth_rserver.conf\nCOPY pam-helper.sh /usr/lib/rstudio-server/bin/pam-helper\nEXPOSE 8787/tcp\n#  # automatically link a shared volume for kitematic users\nVOLUME /home/rstudio/kitematic\nCMD [\"/init\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM rocker/r-ver:3.5.2\nARG RSTUDIO_VERSION\nENV RSTUDIO_VERSION=\"${RSTUDIO_VERSION:-1.1.463}\"\nARG S6_VERSION\nARG PANDOC_TEMPLATES_VERSION\nENV S6_VERSION=\"${S6_VERSION:-v1.21.7.0}\"\nENV S6_BEHAVIOUR_IF_STAGE2_FAILS=\"2\"\nENV PATH=\"/usr/lib/rstudio-server/bin:$PATH\"\nENV PANDOC_TEMPLATES_VERSION=\"${PANDOC_TEMPLATES_VERSION:-2.6}\"\n# # Download and install RStudio server & dependencies\n# # Attempts to get detect latest version, otherwise falls back to version given in $VER\n# # Symlink pandoc, pandoc-citeproc so they are available system-wide\nRUN apt-get update \\\n && apt-get install --no-install-recommends file git libapparmor1 libcurl4-openssl-dev libedit2 libssl-dev lsb-release psmisc procps python-setuptools sudo wget -y \\\n && wget -O libssl1.0.0.deb http://ftp.debian.org/debian/pool/main/o/openssl/libssl1.0.0_1.0.1t-1+deb8u8_amd64.deb \\\n && dpkg -i libssl1.0.0.deb \\\n && rm libssl1.0.0.deb \\\n && RSTUDIO_LATEST=$( wget --no-check-certificate -qO- https://s3.amazonaws.com/rstudio-server/current.ver ;) \\\n && [ -z \"$RSTUDIO_VERSION\" ] \\\n && RSTUDIO_VERSION=$RSTUDIO_LATEST || true \\\n && wget -q http://download2.rstudio.org/rstudio-server-${RSTUDIO_VERSION}-amd64.deb \\\n && dpkg -i rstudio-server-${RSTUDIO_VERSION}-amd64.deb \\\n && rm rstudio-server-*-amd64.deb \\\n && ln -s /usr/lib/rstudio-server/bin/pandoc/pandoc /usr/local/bin \\\n && ln -s /usr/lib/rstudio-server/bin/pandoc/pandoc-citeproc /usr/local/bin \\\n && git clone --recursive --branch ${PANDOC_TEMPLATES_VERSION} https://github.com/jgm/pandoc-templates \\\n && mkdir -p /opt/pandoc/templates \\\n && cp -r pandoc-templates*/* /opt/pandoc/templates \\\n && rm -rf pandoc-templates* \\\n && mkdir /root/.pandoc \\\n && ln -s /opt/pandoc/templates /root/.pandoc/templates \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/ \\\n && mkdir -p /etc/R \\\n && echo '\\n \\n# Configure httr to perform out-of-band authentication if HTTR_LOCALHOST \\n# is not set since a redirect to localhost may not work depending upon \\n# where this Docker container is running. \\nif(is.na(Sys.getenv(\"HTTR_LOCALHOST\", unset=NA))) { \\n options(httr_oob_default = TRUE) \\n}' >> /usr/local/lib/R/etc/Rprofile.site \\\n && echo \"PATH=${PATH}\" >> /usr/local/lib/R/etc/Renviron \\\n && useradd rstudio \\\n && echo \"rstudio:rstudio\" | chpasswd \\\n && mkdir /home/rstudio \\\n && chown rstudio:rstudio /home/rstudio \\\n && addgroup rstudio staff \\\n && echo 'rsession-which-r=/usr/local/bin/R' >> /etc/rstudio/rserver.conf \\\n && echo 'lock-type=advisory' >> /etc/rstudio/file-locks \\\n && git config --system credential.helper 'cache --timeout=3600' \\\n && git config --system push.default simple \\\n && wget -P /tmp/ https://github.com/just-containers/s6-overlay/releases/download/${S6_VERSION}/s6-overlay-amd64.tar.gz \\\n && tar xzf /tmp/s6-overlay-amd64.tar.gz -C / \\\n && mkdir -p /etc/services.d/rstudio \\\n && echo '#!/usr/bin/with-contenv bash \\n## load /etc/environment vars first: \\n for line in $( cat /etc/environment ) ; do export $line ; done \\n exec /usr/lib/rstudio-server/bin/rserver --server-daemonize 0' > /etc/services.d/rstudio/run \\\n && echo '#!/bin/bash \\n rstudio-server stop' > /etc/services.d/rstudio/finish \\\n && mkdir -p /home/rstudio/.rstudio/monitored/user-settings \\\n && echo 'alwaysSaveHistory=\"0\" \\nloadRData=\"0\" \\nsaveAction=\"0\"' > /home/rstudio/.rstudio/monitored/user-settings/user-settings \\\n && chown -R rstudio:rstudio /home/rstudio/.rstudio\nCOPY userconf.sh /etc/cont-init.d/userconf\n# # running with \"-e ADD=shiny\" adds shiny server\nCOPY add_shiny.sh /etc/cont-init.d/add\nCOPY disable_auth_rserver.conf /etc/rstudio/disable_auth_rserver.conf\nCOPY pam-helper.sh /usr/lib/rstudio-server/bin/pam-helper\nEXPOSE 8787/tcp\n# # automatically link a shared volume for kitematic users\nVOLUME /home/rstudio/kitematic\nCMD [\"/init\"]\n","injectedSmells":[],"originalDockerfileHash":"015ab6e50e1de689d35b20a7e9df8266","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM rocker/r-ver:3.5.2\nARG RSTUDIO_VERSION\nENV RSTUDIO_VERSION=\"${RSTUDIO_VERSION:-1.1.463}\"\nARG S6_VERSION\nARG PANDOC_TEMPLATES_VERSION\nENV S6_VERSION=\"${S6_VERSION:-v1.21.7.0}\"\nENV S6_BEHAVIOUR_IF_STAGE2_FAILS=\"2\"\nENV PATH=\"/usr/lib/rstudio-server/bin:$PATH\"\nENV PANDOC_TEMPLATES_VERSION=\"${PANDOC_TEMPLATES_VERSION:-2.6}\"\n#  # Download and install RStudio server & dependencies\n#  # Attempts to get detect latest version, otherwise falls back to version given in $VER\n#  # Symlink pandoc, pandoc-citeproc so they are available system-wide\nRUN apt-get update \\\n && apt-get install --no-install-recommends file git libapparmor1 libcurl4-openssl-dev libedit2 libssl-dev lsb-release psmisc procps python-setuptools sudo wget -y \\\n && wget -O libssl1.0.0.deb http://ftp.debian.org/debian/pool/main/o/openssl/libssl1.0.0_1.0.1t-1+deb8u8_amd64.deb \\\n && dpkg -i libssl1.0.0.deb \\\n && rm libssl1.0.0.deb \\\n && RSTUDIO_LATEST=$( wget --no-check-certificate -qO- https://s3.amazonaws.com/rstudio-server/current.ver ;) \\\n && [ -z \"$RSTUDIO_VERSION\" ] \\\n && RSTUDIO_VERSION=$RSTUDIO_LATEST || true \\\n && wget -q http://download2.rstudio.org/rstudio-server-${RSTUDIO_VERSION}-amd64.deb \\\n && dpkg -i rstudio-server-${RSTUDIO_VERSION}-amd64.deb \\\n && rm rstudio-server-*-amd64.deb \\\n && ln -s /usr/lib/rstudio-server/bin/pandoc/pandoc /usr/local/bin \\\n && ln -s /usr/lib/rstudio-server/bin/pandoc/pandoc-citeproc /usr/local/bin \\\n && git clone --recursive --branch ${PANDOC_TEMPLATES_VERSION} https://github.com/jgm/pandoc-templates \\\n && mkdir -p /opt/pandoc/templates \\\n && cp -r pandoc-templates*/* /opt/pandoc/templates \\\n && rm -rf pandoc-templates* \\\n && mkdir /root/.pandoc \\\n && ln -s /opt/pandoc/templates /root/.pandoc/templates \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/ \\\n && mkdir -p /etc/R \\\n && echo '\\n \\n# Configure httr to perform out-of-band authentication if HTTR_LOCALHOST \\n# is not set since a redirect to localhost may not work depending upon \\n# where this Docker container is running. \\nif(is.na(Sys.getenv(\"HTTR_LOCALHOST\", unset=NA))) { \\n options(httr_oob_default = TRUE) \\n}' >> /usr/local/lib/R/etc/Rprofile.site \\\n && echo \"PATH=${PATH}\" >> /usr/local/lib/R/etc/Renviron \\\n && useradd rstudio \\\n && echo \"rstudio:rstudio\" | chpasswd \\\n && mkdir /home/rstudio \\\n && chown rstudio:rstudio /home/rstudio \\\n && addgroup rstudio staff \\\n && echo 'rsession-which-r=/usr/local/bin/R' >> /etc/rstudio/rserver.conf \\\n && echo 'lock-type=advisory' >> /etc/rstudio/file-locks \\\n && git config --system credential.helper 'cache --timeout=3600' \\\n && git config --system push.default simple \\\n && wget -P /tmp/ https://github.com/just-containers/s6-overlay/releases/download/${S6_VERSION}/s6-overlay-amd64.tar.gz \\\n && tar xzf /tmp/s6-overlay-amd64.tar.gz -C / \\\n && mkdir -p /etc/services.d/rstudio \\\n && echo '#!/usr/bin/with-contenv bash \\n## load /etc/environment vars first: \\n for line in $( cat /etc/environment ) ; do export $line ; done \\n exec /usr/lib/rstudio-server/bin/rserver --server-daemonize 0' > /etc/services.d/rstudio/run \\\n && echo '#!/bin/bash \\n rstudio-server stop' > /etc/services.d/rstudio/finish \\\n && mkdir -p /home/rstudio/.rstudio/monitored/user-settings \\\n && echo 'alwaysSaveHistory=\"0\" \\nloadRData=\"0\" \\nsaveAction=\"0\"' > /home/rstudio/.rstudio/monitored/user-settings/user-settings \\\n && chown -R rstudio:rstudio /home/rstudio/.rstudio\nCOPY userconf.sh /etc/cont-init.d/userconf\n#  # running with \"-e ADD=shiny\" adds shiny server\nCOPY add_shiny.sh /etc/cont-init.d/add\nCOPY disable_auth_rserver.conf /etc/rstudio/disable_auth_rserver.conf\nCOPY pam-helper.sh /usr/lib/rstudio-server/bin/pam-helper\nEXPOSE 8787/tcp\n#  # automatically link a shared volume for kitematic users\nVOLUME /home/rstudio/kitematic\nCMD [\"/init\"]\n","originalDockerfileUglifiedHash":"d5f06632ed7e6c49289f6ce8b0ca1642","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/b2548653f900615660c324a899f65e330464e86d.dockerfile"}