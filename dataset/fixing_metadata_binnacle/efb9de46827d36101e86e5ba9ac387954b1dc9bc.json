{"seed":4026163254,"processedDockerfileHash":"a482208f75aa2166a932aa43df0547a1","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-npm","have-a-healthcheck"],"processedDockerfile":"FROM ubuntu:disco\nLABEL maintainer=\"wekan\"\n#   Set the environment variables (defaults where required)\n#   DOES NOT WORK: paxctl fix for alpine linux: https://github.com/wekan/wekan/issues/1303\n#   ENV BUILD_DEPS=\"paxctl\"\nENV BUILD_DEPS=\"apt-utils bsdtar gnupg gosu wget curl bzip2 build-essential python3 python3-pip git ca-certificates gcc-8\" \\\n    DEBUG=\"false\" \\\n    NODE_VERSION=\"v8.16.0\" \\\n    METEOR_RELEASE=\"1.6.0.1\" \\\n    USE_EDGE=\"false\" \\\n    METEOR_EDGE=\"1.5-beta.17\" \\\n    NPM_VERSION=\"latest\" \\\n    FIBERS_VERSION=\"2.0.0\" \\\n    ARCHITECTURE=\"linux-x64\" \\\n    SRC_PATH=\"./\" \\\n    WITH_API=\"true\" \\\n    ACCOUNTS_LOCKOUT_KNOWN_USERS_FAILURES_BEFORE=\"3\" \\\n    ACCOUNTS_LOCKOUT_KNOWN_USERS_PERIOD=\"60\" \\\n    ACCOUNTS_LOCKOUT_KNOWN_USERS_FAILURE_WINDOW=\"15\" \\\n    ACCOUNTS_LOCKOUT_UNKNOWN_USERS_FAILURES_BERORE=\"3\" \\\n    ACCOUNTS_LOCKOUT_UNKNOWN_USERS_LOCKOUT_PERIOD=\"60\" \\\n    ACCOUNTS_LOCKOUT_UNKNOWN_USERS_FAILURE_WINDOW=\"15\" \\\n    EMAIL_NOTIFICATION_TIMEOUT=\"30000\" \\\n    MATOMO_ADDRESS=\"\" \\\n    MATOMO_SITE_ID=\"\" \\\n    MATOMO_DO_NOT_TRACK=\"true\" \\\n    MATOMO_WITH_USERNAME=\"false\" \\\n    BROWSER_POLICY_ENABLED=\"true\" \\\n    TRUSTED_URL=\"\" \\\n    WEBHOOKS_ATTRIBUTES=\"\" \\\n    OAUTH2_ENABLED=\"false\" \\\n    OAUTH2_LOGIN_STYLE=\"redirect\" \\\n    OAUTH2_CLIENT_ID=\"\" \\\n    OAUTH2_SECRET=\"\" \\\n    OAUTH2_SERVER_URL=\"\" \\\n    OAUTH2_AUTH_ENDPOINT=\"\" \\\n    OAUTH2_USERINFO_ENDPOINT=\"\" \\\n    OAUTH2_TOKEN_ENDPOINT=\"\" \\\n    OAUTH2_ID_MAP=\"\" \\\n    OAUTH2_USERNAME_MAP=\"\" \\\n    OAUTH2_FULLNAME_MAP=\"\" \\\n    OAUTH2_ID_TOKEN_WHITELIST_FIELDS=\"\" \\\n    OAUTH2_REQUEST_PERMISSIONS=\"openid profile email\" \\\n    OAUTH2_EMAIL_MAP=\"\" \\\n    LDAP_ENABLE=\"false\" \\\n    LDAP_PORT=\"389\" \\\n    LDAP_HOST=\"\" \\\n    LDAP_BASEDN=\"\" \\\n    LDAP_LOGIN_FALLBACK=\"false\" \\\n    LDAP_RECONNECT=\"true\" \\\n    LDAP_TIMEOUT=\"10000\" \\\n    LDAP_IDLE_TIMEOUT=\"10000\" \\\n    LDAP_CONNECT_TIMEOUT=\"10000\" \\\n    LDAP_AUTHENTIFICATION=\"false\" \\\n    LDAP_AUTHENTIFICATION_USERDN=\"\" \\\n    LDAP_AUTHENTIFICATION_PASSWORD=\"\" \\\n    LDAP_LOG_ENABLED=\"false\" \\\n    LDAP_BACKGROUND_SYNC=\"false\" \\\n    LDAP_BACKGROUND_SYNC_INTERVAL=\"100\" \\\n    LDAP_BACKGROUND_SYNC_KEEP_EXISTANT_USERS_UPDATED=\"false\" \\\n    LDAP_BACKGROUND_SYNC_IMPORT_NEW_USERS=\"false\" \\\n    LDAP_ENCRYPTION=\"false\" \\\n    LDAP_CA_CERT=\"\" \\\n    LDAP_REJECT_UNAUTHORIZED=\"false\" \\\n    LDAP_USER_AUTHENTICATION=\"false\" \\\n    LDAP_USER_SEARCH_FILTER=\"\" \\\n    LDAP_USER_SEARCH_SCOPE=\"\" \\\n    LDAP_USER_SEARCH_FIELD=\"\" \\\n    LDAP_SEARCH_PAGE_SIZE=\"0\" \\\n    LDAP_SEARCH_SIZE_LIMIT=\"0\" \\\n    LDAP_GROUP_FILTER_ENABLE=\"false\" \\\n    LDAP_GROUP_FILTER_OBJECTCLASS=\"\" \\\n    LDAP_GROUP_FILTER_GROUP_ID_ATTRIBUTE=\"\" \\\n    LDAP_GROUP_FILTER_GROUP_MEMBER_ATTRIBUTE=\"\" \\\n    LDAP_GROUP_FILTER_GROUP_MEMBER_FORMAT=\"\" \\\n    LDAP_GROUP_FILTER_GROUP_NAME=\"\" \\\n    LDAP_UNIQUE_IDENTIFIER_FIELD=\"\" \\\n    LDAP_UTF8_NAMES_SLUGIFY=\"true\" \\\n    LDAP_USERNAME_FIELD=\"\" \\\n    LDAP_FULLNAME_FIELD=\"\" \\\n    LDAP_MERGE_EXISTING_USERS=\"false\" \\\n    LDAP_EMAIL_FIELD=\"\" \\\n    LDAP_EMAIL_MATCH_ENABLE=\"false\" \\\n    LDAP_EMAIL_MATCH_REQUIRE=\"false\" \\\n    LDAP_EMAIL_MATCH_VERIFIED=\"false\" \\\n    LDAP_SYNC_USER_DATA=\"false\" \\\n    LDAP_SYNC_USER_DATA_FIELDMAP=\"\" \\\n    LDAP_SYNC_GROUP_ROLES=\"\" \\\n    LDAP_DEFAULT_DOMAIN=\"\" \\\n    LDAP_SYNC_ADMIN_STATUS=\"\" \\\n    LDAP_SYNC_ADMIN_GROUPS=\"\" \\\n    HEADER_LOGIN_ID=\"\" \\\n    HEADER_LOGIN_FIRSTNAME=\"\" \\\n    HEADER_LOGIN_LASTNAME=\"\" \\\n    HEADER_LOGIN_EMAIL=\"\" \\\n    LOGOUT_WITH_TIMER=\"false\" \\\n    LOGOUT_IN=\"\" \\\n    LOGOUT_ON_HOURS=\"\" \\\n    LOGOUT_ON_MINUTES=\"\" \\\n    CORS=\"\" \\\n    CORS_ALLOW_HEADERS=\"\" \\\n    CORS_EXPOSE_HEADERS=\"\" \\\n    DEFAULT_AUTHENTICATION_METHOD=\"\"\n#   Copy the app to the image\nCOPY ${SRC_PATH} /home/wekan/app\nRUN set -o xtrace \\\n && useradd --user-group --system --home-dir /home/wekan wekan \\\n && apt-get update -y \\\n && apt-get install --no-install-recommends ${BUILD_DEPS} -y \\\n && pip3 install -U pip setuptools wheel \\\n && cp $( which tar ;) $( which tar ;)~ \\\n && ln -sf $( which bsdtar ;) $( which tar ;) \\\n && wget https://nodejs.org/dist/${NODE_VERSION}/node-${NODE_VERSION}-${ARCHITECTURE}.tar.gz \\\n && wget https://nodejs.org/dist/${NODE_VERSION}/SHASUMS256.txt.asc \\\n && grep ${NODE_VERSION}-${ARCHITECTURE}.tar.gz SHASUMS256.txt.asc | shasum -a 256 -c - \\\n && rm -f SHASUMS256.txt.asc \\\n && tar xvzf node-${NODE_VERSION}-${ARCHITECTURE}.tar.gz \\\n && rm node-${NODE_VERSION}-${ARCHITECTURE}.tar.gz \\\n && mv node-${NODE_VERSION}-${ARCHITECTURE} /opt/nodejs \\\n && ln -s /opt/nodejs/bin/node /usr/bin/node \\\n && ln -s /opt/nodejs/bin/npm /usr/bin/npm \\\n && npm install npm@${NPM_VERSION} -g \\\n && npm install node-gyp@9.3.1 -g \\\n && npm install fibers@${FIBERS_VERSION} -g \\\n && cd /home/wekan/ \\\n && chown wekan:wekan --recursive /home/wekan \\\n && curl \"https://install.meteor.com\" -o /home/wekan/install_meteor.sh \\\n && sed -i 's/VERBOSITY=\"--silent\"/VERBOSITY=\"--progress-bar\"/' ./install_meteor.sh \\\n && echo \"Starting meteor ${METEOR_RELEASE} installation... \\n\" \\\n && chown wekan:wekan /home/wekan/install_meteor.sh \\\n && if [ \"$USE_EDGE\" = false ] ; then gosu wekan:wekan sh /home/wekan/install_meteor.sh ; else gosu wekan:wekan git clone --recursive --depth 1 -b release/METEOR@${METEOR_EDGE} git://github.com/meteor/meteor.git /home/wekan/.meteor ; fi ; sed -i 's/api\\.versionsFrom/\\/\\/api.versionsFrom/' /home/wekan/app/packages/meteor-useraccounts-core/package.js \\\n && cd /home/wekan/.meteor \\\n && gosu wekan:wekan /home/wekan/.meteor/meteor -- help ; npm install api2html@0.3.3 -g \\\n && mkdir -p /home/wekan/python \\\n && chown wekan:wekan --recursive /home/wekan/python \\\n && cd /home/wekan/python \\\n && gosu wekan:wekan git clone --depth 1 -b master https://github.com/Kronuz/esprima-python \\\n && cd /home/wekan/python/esprima-python \\\n && python3 setup.py install --record files.txt \\\n && cd /home/wekan/app \\\n && gosu wekan:wekan mkdir -p ./public/api \\\n && gosu wekan:wekan python3 ./openapi/generate_openapi.py --release $( git describe --tags --abbrev=0 ;) > ./public/api/wekan.yml \\\n && gosu wekan:wekan /opt/nodejs/bin/api2html -c ./public/logo-header.png -o ./public/api/wekan.html ./public/api/wekan.yml ; cd /home/wekan/app \\\n && gosu wekan:wekan /home/wekan/.meteor/meteor add standard-minifier-js \\\n && gosu wekan:wekan /home/wekan/.meteor/meteor npm install \\\n && gosu wekan:wekan /home/wekan/.meteor/meteor build --directory /home/wekan/app_build \\\n && cp /home/wekan/app/fix-download-unicode/cfs_access-point.txt /home/wekan/app_build/bundle/programs/server/packages/cfs_access-point.js \\\n && rm /home/wekan/app_build/bundle/programs/server/npm/node_modules/meteor/rajit_bootstrap3-datepicker/lib/bootstrap-datepicker/node_modules/phantomjs-prebuilt/lib/phantom/bin/phantomjs \\\n && chown wekan:wekan /home/wekan/app_build/bundle/programs/server/packages/cfs_access-point.js \\\n && cd /home/wekan/app_build/bundle/programs/server/ \\\n && gosu wekan:wekan npm install \\\n && mv /home/wekan/app_build/bundle /build \\\n && mv $( which tar ;)~ $( which tar ;) \\\n && apt-get remove --purge -y ${BUILD_DEPS} \\\n && apt-get autoremove -y \\\n && npm uninstall -g api2html \\\n && rm -R /var/lib/apt/lists/* \\\n && rm -R /home/wekan/.meteor \\\n && rm -R /home/wekan/app \\\n && rm -R /home/wekan/app_build \\\n && cat /home/wekan/python/esprima-python/files.txt | xargs rm -R \\\n && rm -R /home/wekan/python \\\n && rm /home/wekan/install_meteor.sh\nENV PORT=\"8080\"\nEXPOSE $PORT\nUSER wekan\nCMD [\"node\", \"/build/main.js\"]\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM ubuntu:disco\nLABEL maintainer=\"wekan\"\n#  Set the environment variables (defaults where required)\n#  DOES NOT WORK: paxctl fix for alpine linux: https://github.com/wekan/wekan/issues/1303\n#  ENV BUILD_DEPS=\"paxctl\"\nENV BUILD_DEPS=\"apt-utils bsdtar gnupg gosu wget curl bzip2 build-essential python3 python3-pip git ca-certificates gcc-8\" \\\n    DEBUG=\"false\" \\\n    NODE_VERSION=\"v8.16.0\" \\\n    METEOR_RELEASE=\"1.6.0.1\" \\\n    USE_EDGE=\"false\" \\\n    METEOR_EDGE=\"1.5-beta.17\" \\\n    NPM_VERSION=\"latest\" \\\n    FIBERS_VERSION=\"2.0.0\" \\\n    ARCHITECTURE=\"linux-x64\" \\\n    SRC_PATH=\"./\" \\\n    WITH_API=\"true\" \\\n    ACCOUNTS_LOCKOUT_KNOWN_USERS_FAILURES_BEFORE=\"3\" \\\n    ACCOUNTS_LOCKOUT_KNOWN_USERS_PERIOD=\"60\" \\\n    ACCOUNTS_LOCKOUT_KNOWN_USERS_FAILURE_WINDOW=\"15\" \\\n    ACCOUNTS_LOCKOUT_UNKNOWN_USERS_FAILURES_BERORE=\"3\" \\\n    ACCOUNTS_LOCKOUT_UNKNOWN_USERS_LOCKOUT_PERIOD=\"60\" \\\n    ACCOUNTS_LOCKOUT_UNKNOWN_USERS_FAILURE_WINDOW=\"15\" \\\n    EMAIL_NOTIFICATION_TIMEOUT=\"30000\" \\\n    MATOMO_ADDRESS=\"\" \\\n    MATOMO_SITE_ID=\"\" \\\n    MATOMO_DO_NOT_TRACK=\"true\" \\\n    MATOMO_WITH_USERNAME=\"false\" \\\n    BROWSER_POLICY_ENABLED=\"true\" \\\n    TRUSTED_URL=\"\" \\\n    WEBHOOKS_ATTRIBUTES=\"\" \\\n    OAUTH2_ENABLED=\"false\" \\\n    OAUTH2_LOGIN_STYLE=\"redirect\" \\\n    OAUTH2_CLIENT_ID=\"\" \\\n    OAUTH2_SECRET=\"\" \\\n    OAUTH2_SERVER_URL=\"\" \\\n    OAUTH2_AUTH_ENDPOINT=\"\" \\\n    OAUTH2_USERINFO_ENDPOINT=\"\" \\\n    OAUTH2_TOKEN_ENDPOINT=\"\" \\\n    OAUTH2_ID_MAP=\"\" \\\n    OAUTH2_USERNAME_MAP=\"\" \\\n    OAUTH2_FULLNAME_MAP=\"\" \\\n    OAUTH2_ID_TOKEN_WHITELIST_FIELDS=\"\" \\\n    OAUTH2_REQUEST_PERMISSIONS=\"openid profile email\" \\\n    OAUTH2_EMAIL_MAP=\"\" \\\n    LDAP_ENABLE=\"false\" \\\n    LDAP_PORT=\"389\" \\\n    LDAP_HOST=\"\" \\\n    LDAP_BASEDN=\"\" \\\n    LDAP_LOGIN_FALLBACK=\"false\" \\\n    LDAP_RECONNECT=\"true\" \\\n    LDAP_TIMEOUT=\"10000\" \\\n    LDAP_IDLE_TIMEOUT=\"10000\" \\\n    LDAP_CONNECT_TIMEOUT=\"10000\" \\\n    LDAP_AUTHENTIFICATION=\"false\" \\\n    LDAP_AUTHENTIFICATION_USERDN=\"\" \\\n    LDAP_AUTHENTIFICATION_PASSWORD=\"\" \\\n    LDAP_LOG_ENABLED=\"false\" \\\n    LDAP_BACKGROUND_SYNC=\"false\" \\\n    LDAP_BACKGROUND_SYNC_INTERVAL=\"100\" \\\n    LDAP_BACKGROUND_SYNC_KEEP_EXISTANT_USERS_UPDATED=\"false\" \\\n    LDAP_BACKGROUND_SYNC_IMPORT_NEW_USERS=\"false\" \\\n    LDAP_ENCRYPTION=\"false\" \\\n    LDAP_CA_CERT=\"\" \\\n    LDAP_REJECT_UNAUTHORIZED=\"false\" \\\n    LDAP_USER_AUTHENTICATION=\"false\" \\\n    LDAP_USER_SEARCH_FILTER=\"\" \\\n    LDAP_USER_SEARCH_SCOPE=\"\" \\\n    LDAP_USER_SEARCH_FIELD=\"\" \\\n    LDAP_SEARCH_PAGE_SIZE=\"0\" \\\n    LDAP_SEARCH_SIZE_LIMIT=\"0\" \\\n    LDAP_GROUP_FILTER_ENABLE=\"false\" \\\n    LDAP_GROUP_FILTER_OBJECTCLASS=\"\" \\\n    LDAP_GROUP_FILTER_GROUP_ID_ATTRIBUTE=\"\" \\\n    LDAP_GROUP_FILTER_GROUP_MEMBER_ATTRIBUTE=\"\" \\\n    LDAP_GROUP_FILTER_GROUP_MEMBER_FORMAT=\"\" \\\n    LDAP_GROUP_FILTER_GROUP_NAME=\"\" \\\n    LDAP_UNIQUE_IDENTIFIER_FIELD=\"\" \\\n    LDAP_UTF8_NAMES_SLUGIFY=\"true\" \\\n    LDAP_USERNAME_FIELD=\"\" \\\n    LDAP_FULLNAME_FIELD=\"\" \\\n    LDAP_MERGE_EXISTING_USERS=\"false\" \\\n    LDAP_EMAIL_FIELD=\"\" \\\n    LDAP_EMAIL_MATCH_ENABLE=\"false\" \\\n    LDAP_EMAIL_MATCH_REQUIRE=\"false\" \\\n    LDAP_EMAIL_MATCH_VERIFIED=\"false\" \\\n    LDAP_SYNC_USER_DATA=\"false\" \\\n    LDAP_SYNC_USER_DATA_FIELDMAP=\"\" \\\n    LDAP_SYNC_GROUP_ROLES=\"\" \\\n    LDAP_DEFAULT_DOMAIN=\"\" \\\n    LDAP_SYNC_ADMIN_STATUS=\"\" \\\n    LDAP_SYNC_ADMIN_GROUPS=\"\" \\\n    HEADER_LOGIN_ID=\"\" \\\n    HEADER_LOGIN_FIRSTNAME=\"\" \\\n    HEADER_LOGIN_LASTNAME=\"\" \\\n    HEADER_LOGIN_EMAIL=\"\" \\\n    LOGOUT_WITH_TIMER=\"false\" \\\n    LOGOUT_IN=\"\" \\\n    LOGOUT_ON_HOURS=\"\" \\\n    LOGOUT_ON_MINUTES=\"\" \\\n    CORS=\"\" \\\n    CORS_ALLOW_HEADERS=\"\" \\\n    CORS_EXPOSE_HEADERS=\"\" \\\n    DEFAULT_AUTHENTICATION_METHOD=\"\"\n#  Copy the app to the image\nCOPY ${SRC_PATH} /home/wekan/app\nRUN set -o xtrace \\\n && useradd --user-group --system --home-dir /home/wekan wekan \\\n && apt-get update -y \\\n && apt-get install --no-install-recommends ${BUILD_DEPS} -y \\\n && pip3 install -U pip setuptools wheel \\\n && cp $( which tar ;) $( which tar ;)~ \\\n && ln -sf $( which bsdtar ;) $( which tar ;) \\\n && wget https://nodejs.org/dist/${NODE_VERSION}/node-${NODE_VERSION}-${ARCHITECTURE}.tar.gz \\\n && wget https://nodejs.org/dist/${NODE_VERSION}/SHASUMS256.txt.asc \\\n && grep ${NODE_VERSION}-${ARCHITECTURE}.tar.gz SHASUMS256.txt.asc | shasum -a 256 -c - \\\n && rm -f SHASUMS256.txt.asc \\\n && tar xvzf node-${NODE_VERSION}-${ARCHITECTURE}.tar.gz \\\n && rm node-${NODE_VERSION}-${ARCHITECTURE}.tar.gz \\\n && mv node-${NODE_VERSION}-${ARCHITECTURE} /opt/nodejs \\\n && ln -s /opt/nodejs/bin/node /usr/bin/node \\\n && ln -s /opt/nodejs/bin/npm /usr/bin/npm \\\n && npm install npm@${NPM_VERSION} -g \\\n && npm install node-gyp -g \\\n && npm install fibers@${FIBERS_VERSION} -g \\\n && cd /home/wekan/ \\\n && chown wekan:wekan --recursive /home/wekan \\\n && curl \"https://install.meteor.com\" -o /home/wekan/install_meteor.sh \\\n && sed -i 's/VERBOSITY=\"--silent\"/VERBOSITY=\"--progress-bar\"/' ./install_meteor.sh \\\n && echo \"Starting meteor ${METEOR_RELEASE} installation... \\n\" \\\n && chown wekan:wekan /home/wekan/install_meteor.sh \\\n && if [ \"$USE_EDGE\" = false ] ; then gosu wekan:wekan sh /home/wekan/install_meteor.sh ; else gosu wekan:wekan git clone --recursive --depth 1 -b release/METEOR@${METEOR_EDGE} git://github.com/meteor/meteor.git /home/wekan/.meteor ; fi ; sed -i 's/api\\.versionsFrom/\\/\\/api.versionsFrom/' /home/wekan/app/packages/meteor-useraccounts-core/package.js \\\n && cd /home/wekan/.meteor \\\n && gosu wekan:wekan /home/wekan/.meteor/meteor -- help ; npm install api2html@0.3.3 -g \\\n && mkdir -p /home/wekan/python \\\n && chown wekan:wekan --recursive /home/wekan/python \\\n && cd /home/wekan/python \\\n && gosu wekan:wekan git clone --depth 1 -b master https://github.com/Kronuz/esprima-python \\\n && cd /home/wekan/python/esprima-python \\\n && python3 setup.py install --record files.txt \\\n && cd /home/wekan/app \\\n && gosu wekan:wekan mkdir -p ./public/api \\\n && gosu wekan:wekan python3 ./openapi/generate_openapi.py --release $( git describe --tags --abbrev=0 ;) > ./public/api/wekan.yml \\\n && gosu wekan:wekan /opt/nodejs/bin/api2html -c ./public/logo-header.png -o ./public/api/wekan.html ./public/api/wekan.yml ; cd /home/wekan/app \\\n && gosu wekan:wekan /home/wekan/.meteor/meteor add standard-minifier-js \\\n && gosu wekan:wekan /home/wekan/.meteor/meteor npm install \\\n && gosu wekan:wekan /home/wekan/.meteor/meteor build --directory /home/wekan/app_build \\\n && cp /home/wekan/app/fix-download-unicode/cfs_access-point.txt /home/wekan/app_build/bundle/programs/server/packages/cfs_access-point.js \\\n && rm /home/wekan/app_build/bundle/programs/server/npm/node_modules/meteor/rajit_bootstrap3-datepicker/lib/bootstrap-datepicker/node_modules/phantomjs-prebuilt/lib/phantom/bin/phantomjs \\\n && chown wekan:wekan /home/wekan/app_build/bundle/programs/server/packages/cfs_access-point.js \\\n && cd /home/wekan/app_build/bundle/programs/server/ \\\n && gosu wekan:wekan npm install \\\n && mv /home/wekan/app_build/bundle /build \\\n && mv $( which tar ;)~ $( which tar ;) \\\n && apt-get remove --purge -y ${BUILD_DEPS} \\\n && apt-get autoremove -y \\\n && npm uninstall -g api2html \\\n && rm -R /var/lib/apt/lists/* \\\n && rm -R /home/wekan/.meteor \\\n && rm -R /home/wekan/app \\\n && rm -R /home/wekan/app_build \\\n && cat /home/wekan/python/esprima-python/files.txt | xargs rm -R \\\n && rm -R /home/wekan/python \\\n && rm /home/wekan/install_meteor.sh\nENV PORT=\"8080\"\nEXPOSE $PORT\nUSER wekan\nCMD [\"node\", \"/build/main.js\"]\n","injectedSmells":[],"originalDockerfileHash":"900aec7ff4ddd428bbc142e6effa6036","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM ubuntu:disco\nLABEL maintainer=\"wekan\"\n#   Set the environment variables (defaults where required)\n#   DOES NOT WORK: paxctl fix for alpine linux: https://github.com/wekan/wekan/issues/1303\n#   ENV BUILD_DEPS=\"paxctl\"\nENV BUILD_DEPS=\"apt-utils bsdtar gnupg gosu wget curl bzip2 build-essential python3 python3-pip git ca-certificates gcc-8\" \\\n    DEBUG=\"false\" \\\n    NODE_VERSION=\"v8.16.0\" \\\n    METEOR_RELEASE=\"1.6.0.1\" \\\n    USE_EDGE=\"false\" \\\n    METEOR_EDGE=\"1.5-beta.17\" \\\n    NPM_VERSION=\"latest\" \\\n    FIBERS_VERSION=\"2.0.0\" \\\n    ARCHITECTURE=\"linux-x64\" \\\n    SRC_PATH=\"./\" \\\n    WITH_API=\"true\" \\\n    ACCOUNTS_LOCKOUT_KNOWN_USERS_FAILURES_BEFORE=\"3\" \\\n    ACCOUNTS_LOCKOUT_KNOWN_USERS_PERIOD=\"60\" \\\n    ACCOUNTS_LOCKOUT_KNOWN_USERS_FAILURE_WINDOW=\"15\" \\\n    ACCOUNTS_LOCKOUT_UNKNOWN_USERS_FAILURES_BERORE=\"3\" \\\n    ACCOUNTS_LOCKOUT_UNKNOWN_USERS_LOCKOUT_PERIOD=\"60\" \\\n    ACCOUNTS_LOCKOUT_UNKNOWN_USERS_FAILURE_WINDOW=\"15\" \\\n    EMAIL_NOTIFICATION_TIMEOUT=\"30000\" \\\n    MATOMO_ADDRESS=\"\" \\\n    MATOMO_SITE_ID=\"\" \\\n    MATOMO_DO_NOT_TRACK=\"true\" \\\n    MATOMO_WITH_USERNAME=\"false\" \\\n    BROWSER_POLICY_ENABLED=\"true\" \\\n    TRUSTED_URL=\"\" \\\n    WEBHOOKS_ATTRIBUTES=\"\" \\\n    OAUTH2_ENABLED=\"false\" \\\n    OAUTH2_LOGIN_STYLE=\"redirect\" \\\n    OAUTH2_CLIENT_ID=\"\" \\\n    OAUTH2_SECRET=\"\" \\\n    OAUTH2_SERVER_URL=\"\" \\\n    OAUTH2_AUTH_ENDPOINT=\"\" \\\n    OAUTH2_USERINFO_ENDPOINT=\"\" \\\n    OAUTH2_TOKEN_ENDPOINT=\"\" \\\n    OAUTH2_ID_MAP=\"\" \\\n    OAUTH2_USERNAME_MAP=\"\" \\\n    OAUTH2_FULLNAME_MAP=\"\" \\\n    OAUTH2_ID_TOKEN_WHITELIST_FIELDS=\"\" \\\n    OAUTH2_REQUEST_PERMISSIONS=\"openid profile email\" \\\n    OAUTH2_EMAIL_MAP=\"\" \\\n    LDAP_ENABLE=\"false\" \\\n    LDAP_PORT=\"389\" \\\n    LDAP_HOST=\"\" \\\n    LDAP_BASEDN=\"\" \\\n    LDAP_LOGIN_FALLBACK=\"false\" \\\n    LDAP_RECONNECT=\"true\" \\\n    LDAP_TIMEOUT=\"10000\" \\\n    LDAP_IDLE_TIMEOUT=\"10000\" \\\n    LDAP_CONNECT_TIMEOUT=\"10000\" \\\n    LDAP_AUTHENTIFICATION=\"false\" \\\n    LDAP_AUTHENTIFICATION_USERDN=\"\" \\\n    LDAP_AUTHENTIFICATION_PASSWORD=\"\" \\\n    LDAP_LOG_ENABLED=\"false\" \\\n    LDAP_BACKGROUND_SYNC=\"false\" \\\n    LDAP_BACKGROUND_SYNC_INTERVAL=\"100\" \\\n    LDAP_BACKGROUND_SYNC_KEEP_EXISTANT_USERS_UPDATED=\"false\" \\\n    LDAP_BACKGROUND_SYNC_IMPORT_NEW_USERS=\"false\" \\\n    LDAP_ENCRYPTION=\"false\" \\\n    LDAP_CA_CERT=\"\" \\\n    LDAP_REJECT_UNAUTHORIZED=\"false\" \\\n    LDAP_USER_AUTHENTICATION=\"false\" \\\n    LDAP_USER_SEARCH_FILTER=\"\" \\\n    LDAP_USER_SEARCH_SCOPE=\"\" \\\n    LDAP_USER_SEARCH_FIELD=\"\" \\\n    LDAP_SEARCH_PAGE_SIZE=\"0\" \\\n    LDAP_SEARCH_SIZE_LIMIT=\"0\" \\\n    LDAP_GROUP_FILTER_ENABLE=\"false\" \\\n    LDAP_GROUP_FILTER_OBJECTCLASS=\"\" \\\n    LDAP_GROUP_FILTER_GROUP_ID_ATTRIBUTE=\"\" \\\n    LDAP_GROUP_FILTER_GROUP_MEMBER_ATTRIBUTE=\"\" \\\n    LDAP_GROUP_FILTER_GROUP_MEMBER_FORMAT=\"\" \\\n    LDAP_GROUP_FILTER_GROUP_NAME=\"\" \\\n    LDAP_UNIQUE_IDENTIFIER_FIELD=\"\" \\\n    LDAP_UTF8_NAMES_SLUGIFY=\"true\" \\\n    LDAP_USERNAME_FIELD=\"\" \\\n    LDAP_FULLNAME_FIELD=\"\" \\\n    LDAP_MERGE_EXISTING_USERS=\"false\" \\\n    LDAP_EMAIL_FIELD=\"\" \\\n    LDAP_EMAIL_MATCH_ENABLE=\"false\" \\\n    LDAP_EMAIL_MATCH_REQUIRE=\"false\" \\\n    LDAP_EMAIL_MATCH_VERIFIED=\"false\" \\\n    LDAP_SYNC_USER_DATA=\"false\" \\\n    LDAP_SYNC_USER_DATA_FIELDMAP=\"\" \\\n    LDAP_SYNC_GROUP_ROLES=\"\" \\\n    LDAP_DEFAULT_DOMAIN=\"\" \\\n    LDAP_SYNC_ADMIN_STATUS=\"\" \\\n    LDAP_SYNC_ADMIN_GROUPS=\"\" \\\n    HEADER_LOGIN_ID=\"\" \\\n    HEADER_LOGIN_FIRSTNAME=\"\" \\\n    HEADER_LOGIN_LASTNAME=\"\" \\\n    HEADER_LOGIN_EMAIL=\"\" \\\n    LOGOUT_WITH_TIMER=\"false\" \\\n    LOGOUT_IN=\"\" \\\n    LOGOUT_ON_HOURS=\"\" \\\n    LOGOUT_ON_MINUTES=\"\" \\\n    CORS=\"\" \\\n    CORS_ALLOW_HEADERS=\"\" \\\n    CORS_EXPOSE_HEADERS=\"\" \\\n    DEFAULT_AUTHENTICATION_METHOD=\"\"\n#   Copy the app to the image\nCOPY ${SRC_PATH} /home/wekan/app\nRUN set -o xtrace \\\n && useradd --user-group --system --home-dir /home/wekan wekan \\\n && apt-get update -y \\\n && apt-get install --no-install-recommends ${BUILD_DEPS} -y \\\n && pip3 install -U pip setuptools wheel \\\n && cp $( which tar ;) $( which tar ;)~ \\\n && ln -sf $( which bsdtar ;) $( which tar ;) \\\n && wget https://nodejs.org/dist/${NODE_VERSION}/node-${NODE_VERSION}-${ARCHITECTURE}.tar.gz \\\n && wget https://nodejs.org/dist/${NODE_VERSION}/SHASUMS256.txt.asc \\\n && grep ${NODE_VERSION}-${ARCHITECTURE}.tar.gz SHASUMS256.txt.asc | shasum -a 256 -c - \\\n && rm -f SHASUMS256.txt.asc \\\n && tar xvzf node-${NODE_VERSION}-${ARCHITECTURE}.tar.gz \\\n && rm node-${NODE_VERSION}-${ARCHITECTURE}.tar.gz \\\n && mv node-${NODE_VERSION}-${ARCHITECTURE} /opt/nodejs \\\n && ln -s /opt/nodejs/bin/node /usr/bin/node \\\n && ln -s /opt/nodejs/bin/npm /usr/bin/npm \\\n && npm install npm@${NPM_VERSION} -g \\\n && npm install node-gyp -g \\\n && npm install fibers@${FIBERS_VERSION} -g \\\n && cd /home/wekan/ \\\n && chown wekan:wekan --recursive /home/wekan \\\n && curl \"https://install.meteor.com\" -o /home/wekan/install_meteor.sh \\\n && sed -i 's/VERBOSITY=\"--silent\"/VERBOSITY=\"--progress-bar\"/' ./install_meteor.sh \\\n && echo \"Starting meteor ${METEOR_RELEASE} installation... \\n\" \\\n && chown wekan:wekan /home/wekan/install_meteor.sh \\\n && if [ \"$USE_EDGE\" = false ] ; then gosu wekan:wekan sh /home/wekan/install_meteor.sh ; else gosu wekan:wekan git clone --recursive --depth 1 -b release/METEOR@${METEOR_EDGE} git://github.com/meteor/meteor.git /home/wekan/.meteor ; fi ; sed -i 's/api\\.versionsFrom/\\/\\/api.versionsFrom/' /home/wekan/app/packages/meteor-useraccounts-core/package.js \\\n && cd /home/wekan/.meteor \\\n && gosu wekan:wekan /home/wekan/.meteor/meteor -- help ; npm install api2html@0.3.3 -g \\\n && mkdir -p /home/wekan/python \\\n && chown wekan:wekan --recursive /home/wekan/python \\\n && cd /home/wekan/python \\\n && gosu wekan:wekan git clone --depth 1 -b master https://github.com/Kronuz/esprima-python \\\n && cd /home/wekan/python/esprima-python \\\n && python3 setup.py install --record files.txt \\\n && cd /home/wekan/app \\\n && gosu wekan:wekan mkdir -p ./public/api \\\n && gosu wekan:wekan python3 ./openapi/generate_openapi.py --release $( git describe --tags --abbrev=0 ;) > ./public/api/wekan.yml \\\n && gosu wekan:wekan /opt/nodejs/bin/api2html -c ./public/logo-header.png -o ./public/api/wekan.html ./public/api/wekan.yml ; cd /home/wekan/app \\\n && gosu wekan:wekan /home/wekan/.meteor/meteor add standard-minifier-js \\\n && gosu wekan:wekan /home/wekan/.meteor/meteor npm install \\\n && gosu wekan:wekan /home/wekan/.meteor/meteor build --directory /home/wekan/app_build \\\n && cp /home/wekan/app/fix-download-unicode/cfs_access-point.txt /home/wekan/app_build/bundle/programs/server/packages/cfs_access-point.js \\\n && rm /home/wekan/app_build/bundle/programs/server/npm/node_modules/meteor/rajit_bootstrap3-datepicker/lib/bootstrap-datepicker/node_modules/phantomjs-prebuilt/lib/phantom/bin/phantomjs \\\n && chown wekan:wekan /home/wekan/app_build/bundle/programs/server/packages/cfs_access-point.js \\\n && cd /home/wekan/app_build/bundle/programs/server/ \\\n && gosu wekan:wekan npm install \\\n && mv /home/wekan/app_build/bundle /build \\\n && mv $( which tar ;)~ $( which tar ;) \\\n && apt-get remove --purge -y ${BUILD_DEPS} \\\n && apt-get autoremove -y \\\n && npm uninstall -g api2html \\\n && rm -R /var/lib/apt/lists/* \\\n && rm -R /home/wekan/.meteor \\\n && rm -R /home/wekan/app \\\n && rm -R /home/wekan/app_build \\\n && cat /home/wekan/python/esprima-python/files.txt | xargs rm -R \\\n && rm -R /home/wekan/python \\\n && rm /home/wekan/install_meteor.sh\nENV PORT=\"8080\"\nEXPOSE $PORT\nUSER wekan\nCMD [\"node\", \"/build/main.js\"]\n","originalDockerfileUglifiedHash":"c482a83a6c403e8ad670df3c70ef1a32","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/efb9de46827d36101e86e5ba9ac387954b1dc9bc.dockerfile"}