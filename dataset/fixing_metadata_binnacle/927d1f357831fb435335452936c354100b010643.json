{"seed":508406862,"processedDockerfileHash":"c02e959bfe346ac356fd3e467e8939e3","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","have-a-healthcheck","have-a-user"],"processedDockerfile":"#   Build stage for BerkeleyDB\nFROM alpine:3.7 AS berkeleydb\nRUN sed -i 's/http\\:\\/\\/dl-cdn.alpinelinux.org/https\\:\\/\\/alpine.global.ssl.fastly.net/g' /etc/apk/repositories\nRUN apk add autoconf=2.69-r0 --no-cache\nRUN apk add automake=1.15.1-r0 --no-cache\nRUN apk add build-base=0.5-r0 --no-cache\nRUN apk add openssl=1.0.2t-r0 --no-cache\nENV BERKELEYDB_VERSION=\"db-4.8.30.NC\"\nENV BERKELEYDB_PREFIX=\"/opt/${BERKELEYDB_VERSION}\"\nRUN wget https://download.oracle.com/berkeley-db/${BERKELEYDB_VERSION}.tar.gz\nRUN tar -xzf *.tar.gz\nRUN sed s/__atomic_compare_exchange/__atomic_compare_exchange_db/g -i ${BERKELEYDB_VERSION}/dbinc/atomic.h\nRUN mkdir -p ${BERKELEYDB_PREFIX}\nWORKDIR /${BERKELEYDB_VERSION}/build_unix\nRUN ../dist/configure --enable-cxx --disable-shared --with-pic --prefix=${BERKELEYDB_PREFIX}\nRUN make -j4\nRUN make install\nRUN rm -rf ${BERKELEYDB_PREFIX}/docs\n#   Build stage for Bitcoin Core\nFROM alpine:3.7 AS bitcoin-core\nCOPY --from=berkeleydb /opt /opt\nRUN sed -i 's/http\\:\\/\\/dl-cdn.alpinelinux.org/https\\:\\/\\/alpine.global.ssl.fastly.net/g' /etc/apk/repositories\nRUN apk add autoconf=2.69-r0 --no-cache\nRUN apk add automake=1.15.1-r0 --no-cache\nRUN apk add boost-dev=1.62.0-r5 --no-cache\nRUN apk add build-base=0.5-r0 --no-cache\nRUN apk add chrpath=0.16-r1 --no-cache\nRUN apk add file=5.32-r2 --no-cache\nRUN apk add gnupg=2.2.3-r1 --no-cache\nRUN apk add libevent-dev=2.1.8-r2 --no-cache\nRUN apk add openssl=1.0.2t-r0 --no-cache\nRUN apk add openssl-dev=1.0.2t-r0 --no-cache\nRUN apk add libtool=2.4.6-r4 --no-cache\nRUN apk add linux-headers=4.4.6-r2 --no-cache\nRUN apk add protobuf-dev=3.4.1-r1 --no-cache\nRUN apk add zeromq-dev=4.2.5-r1 --no-cache\nRUN set -ex \\\n && for key in 90C8019E36C2E964; do gpg --batch --keyserver keyserver.ubuntu.com --recv-keys \"$key\" || gpg --batch --keyserver pgp.mit.edu --recv-keys \"$key\" || gpg --batch --keyserver keyserver.pgp.com --recv-keys \"$key\" || gpg --batch --keyserver ha.pool.sks-keyservers.net --recv-keys \"$key\" || gpg --batch --keyserver hkp://p80.pool.sks-keyservers.net:80 --recv-keys \"$key\" ; done\nENV BITCOIN_VERSION=\"0.11.2\"\nENV BITCOIN_PREFIX=\"/opt/bitcoin-${BITCOIN_VERSION}\"\nRUN wget https://bitcoin.org/bin/bitcoin-core-${BITCOIN_VERSION}/SHA256SUMS.asc\nRUN wget https://bitcoin.org/bin/bitcoin-core-${BITCOIN_VERSION}/bitcoin-${BITCOIN_VERSION}.tar.gz\nRUN gpg --verify SHA256SUMS.asc\nRUN grep \" bitcoin-${BITCOIN_VERSION}.tar.gz$\" SHA256SUMS.asc | sha256sum -c -\nRUN tar -xzf *.tar.gz\nWORKDIR /bitcoin-${BITCOIN_VERSION}\nCOPY patches/warnings.patch /warnings.patch\nRUN patch -p0 < /warnings.patch\nRUN ./autogen.sh\nRUN ./configure LDFLAGS=-L`ls -d /opt/db* `/lib/ CPPFLAGS=-I`ls -d /opt/db* `/include/ --prefix=${BITCOIN_PREFIX} --mandir=/usr/share/man --disable-tests --disable-bench --disable-ccache --with-gui=no --with-utils --with-libs --with-daemon\nRUN make -j4\nRUN make install\nRUN strip ${BITCOIN_PREFIX}/bin/bitcoin-cli\nRUN strip ${BITCOIN_PREFIX}/bin/bitcoin-tx\nRUN strip ${BITCOIN_PREFIX}/bin/bitcoind\nRUN strip ${BITCOIN_PREFIX}/lib/libbitcoinconsensus.a\nRUN strip ${BITCOIN_PREFIX}/lib/libbitcoinconsensus.so.0.0.0\n#   Build stage for compiled artifacts\nFROM alpine:3.7\nLABEL maintainer.0=\"João Fonseca (@joaopaulofonseca)\" \\\n      maintainer.1=\"Pedro Branco (@pedrobranco)\" \\\n      maintainer.2=\"Rui Marinho (@ruimarinho)\"\nRUN adduser -S bitcoin\nRUN sed -i 's/http\\:\\/\\/dl-cdn.alpinelinux.org/https\\:\\/\\/alpine.global.ssl.fastly.net/g' /etc/apk/repositories\nRUN apk add boost=1.62.0-r5 boost-program_options=1.62.0-r5 libevent=2.1.8-r2 openssl=1.0.2t-r0 libzmq=4.2.5-r1 su-exec=0.2-r0 --no-cache\nENV BITCOIN_DATA=\"/home/bitcoin/.bitcoin\"\nENV BITCOIN_VERSION=\"0.11.2\"\nENV BITCOIN_PREFIX=\"/opt/bitcoin-${BITCOIN_VERSION}\"\nENV PATH=\"${BITCOIN_PREFIX}/bin:$PATH\"\nCOPY --from=bitcoin-core /opt /opt\nCOPY docker-entrypoint.sh /entrypoint.sh\nVOLUME [\"/home/bitcoin/.bitcoin\"]\nEXPOSE 8332/tcp 8333/tcp 18332/tcp 18333/tcp 18444/tcp\nENTRYPOINT [\"/entrypoint.sh\"]\nCMD [\"bitcoind\"]\nRUN addgroup -S docker-user ; adduser -S -G docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  Build stage for BerkeleyDB\nFROM alpine:3.7 AS berkeleydb\nRUN sed -i 's/http\\:\\/\\/dl-cdn.alpinelinux.org/https\\:\\/\\/alpine.global.ssl.fastly.net/g' /etc/apk/repositories\nRUN apk --no-cache add autoconf\nRUN apk --no-cache add automake\nRUN apk --no-cache add build-base\nRUN apk --no-cache add openssl\nENV BERKELEYDB_VERSION=\"db-4.8.30.NC\"\nENV BERKELEYDB_PREFIX=\"/opt/${BERKELEYDB_VERSION}\"\nRUN wget https://download.oracle.com/berkeley-db/${BERKELEYDB_VERSION}.tar.gz\nRUN tar -xzf *.tar.gz\nRUN sed s/__atomic_compare_exchange/__atomic_compare_exchange_db/g -i ${BERKELEYDB_VERSION}/dbinc/atomic.h\nRUN mkdir -p ${BERKELEYDB_PREFIX}\nWORKDIR /${BERKELEYDB_VERSION}/build_unix\nRUN ../dist/configure --enable-cxx --disable-shared --with-pic --prefix=${BERKELEYDB_PREFIX}\nRUN make -j4\nRUN make install\nRUN rm -rf ${BERKELEYDB_PREFIX}/docs\n#  Build stage for Bitcoin Core\nFROM alpine:3.7 AS bitcoin-core\nCOPY --from=berkeleydb /opt /opt\nRUN sed -i 's/http\\:\\/\\/dl-cdn.alpinelinux.org/https\\:\\/\\/alpine.global.ssl.fastly.net/g' /etc/apk/repositories\nRUN apk --no-cache add autoconf\nRUN apk --no-cache add automake\nRUN apk --no-cache add boost-dev\nRUN apk --no-cache add build-base\nRUN apk --no-cache add chrpath\nRUN apk --no-cache add file\nRUN apk --no-cache add gnupg\nRUN apk --no-cache add libevent-dev\nRUN apk --no-cache add openssl\nRUN apk --no-cache add openssl-dev\nRUN apk --no-cache add libtool\nRUN apk --no-cache add linux-headers\nRUN apk --no-cache add protobuf-dev\nRUN apk --no-cache add zeromq-dev\nRUN set -ex \\\n && for key in 90C8019E36C2E964; do gpg --batch --keyserver keyserver.ubuntu.com --recv-keys \"$key\" || gpg --batch --keyserver pgp.mit.edu --recv-keys \"$key\" || gpg --batch --keyserver keyserver.pgp.com --recv-keys \"$key\" || gpg --batch --keyserver ha.pool.sks-keyservers.net --recv-keys \"$key\" || gpg --batch --keyserver hkp://p80.pool.sks-keyservers.net:80 --recv-keys \"$key\" ; done\nENV BITCOIN_VERSION=\"0.11.2\"\nENV BITCOIN_PREFIX=\"/opt/bitcoin-${BITCOIN_VERSION}\"\nRUN wget https://bitcoin.org/bin/bitcoin-core-${BITCOIN_VERSION}/SHA256SUMS.asc\nRUN wget https://bitcoin.org/bin/bitcoin-core-${BITCOIN_VERSION}/bitcoin-${BITCOIN_VERSION}.tar.gz\nRUN gpg --verify SHA256SUMS.asc\nRUN grep \" bitcoin-${BITCOIN_VERSION}.tar.gz$\" SHA256SUMS.asc | sha256sum -c -\nRUN tar -xzf *.tar.gz\nWORKDIR /bitcoin-${BITCOIN_VERSION}\nCOPY patches/warnings.patch /warnings.patch\nRUN patch -p0 < /warnings.patch\nRUN ./autogen.sh\nRUN ./configure LDFLAGS=-L`ls -d /opt/db* `/lib/ CPPFLAGS=-I`ls -d /opt/db* `/include/ --prefix=${BITCOIN_PREFIX} --mandir=/usr/share/man --disable-tests --disable-bench --disable-ccache --with-gui=no --with-utils --with-libs --with-daemon\nRUN make -j4\nRUN make install\nRUN strip ${BITCOIN_PREFIX}/bin/bitcoin-cli\nRUN strip ${BITCOIN_PREFIX}/bin/bitcoin-tx\nRUN strip ${BITCOIN_PREFIX}/bin/bitcoind\nRUN strip ${BITCOIN_PREFIX}/lib/libbitcoinconsensus.a\nRUN strip ${BITCOIN_PREFIX}/lib/libbitcoinconsensus.so.0.0.0\n#  Build stage for compiled artifacts\nFROM alpine:3.7\nLABEL maintainer.0=\"João Fonseca (@joaopaulofonseca)\" \\\n      maintainer.1=\"Pedro Branco (@pedrobranco)\" \\\n      maintainer.2=\"Rui Marinho (@ruimarinho)\"\nRUN adduser -S bitcoin\nRUN sed -i 's/http\\:\\/\\/dl-cdn.alpinelinux.org/https\\:\\/\\/alpine.global.ssl.fastly.net/g' /etc/apk/repositories\nRUN apk --no-cache add boost boost-program_options libevent openssl libzmq su-exec\nENV BITCOIN_DATA=\"/home/bitcoin/.bitcoin\"\nENV BITCOIN_VERSION=\"0.11.2\"\nENV BITCOIN_PREFIX=\"/opt/bitcoin-${BITCOIN_VERSION}\"\nENV PATH=\"${BITCOIN_PREFIX}/bin:$PATH\"\nCOPY --from=bitcoin-core /opt /opt\nCOPY docker-entrypoint.sh /entrypoint.sh\nVOLUME [\"/home/bitcoin/.bitcoin\"]\nEXPOSE 8332/tcp 8333/tcp 18332/tcp 18333/tcp 18444/tcp\nENTRYPOINT [\"/entrypoint.sh\"]\nCMD [\"bitcoind\"]\n","injectedSmells":[],"originalDockerfileHash":"f896821a0de44522c6f7a3e51e4dac4e","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   Build stage for BerkeleyDB\nFROM alpine:3.7 AS berkeleydb\nRUN sed -i 's/http\\:\\/\\/dl-cdn.alpinelinux.org/https\\:\\/\\/alpine.global.ssl.fastly.net/g' /etc/apk/repositories\nRUN apk --no-cache add autoconf\nRUN apk --no-cache add automake\nRUN apk --no-cache add build-base\nRUN apk --no-cache add openssl\nENV BERKELEYDB_VERSION=\"db-4.8.30.NC\"\nENV BERKELEYDB_PREFIX=\"/opt/${BERKELEYDB_VERSION}\"\nRUN wget https://download.oracle.com/berkeley-db/${BERKELEYDB_VERSION}.tar.gz\nRUN tar -xzf *.tar.gz\nRUN sed s/__atomic_compare_exchange/__atomic_compare_exchange_db/g -i ${BERKELEYDB_VERSION}/dbinc/atomic.h\nRUN mkdir -p ${BERKELEYDB_PREFIX}\nWORKDIR /${BERKELEYDB_VERSION}/build_unix\nRUN ../dist/configure --enable-cxx --disable-shared --with-pic --prefix=${BERKELEYDB_PREFIX}\nRUN make -j4\nRUN make install\nRUN rm -rf ${BERKELEYDB_PREFIX}/docs\n#   Build stage for Bitcoin Core\nFROM alpine:3.7 AS bitcoin-core\nCOPY --from=berkeleydb /opt /opt\nRUN sed -i 's/http\\:\\/\\/dl-cdn.alpinelinux.org/https\\:\\/\\/alpine.global.ssl.fastly.net/g' /etc/apk/repositories\nRUN apk --no-cache add autoconf\nRUN apk --no-cache add automake\nRUN apk --no-cache add boost-dev\nRUN apk --no-cache add build-base\nRUN apk --no-cache add chrpath\nRUN apk --no-cache add file\nRUN apk --no-cache add gnupg\nRUN apk --no-cache add libevent-dev\nRUN apk --no-cache add openssl\nRUN apk --no-cache add openssl-dev\nRUN apk --no-cache add libtool\nRUN apk --no-cache add linux-headers\nRUN apk --no-cache add protobuf-dev\nRUN apk --no-cache add zeromq-dev\nRUN set -ex \\\n && for key in 90C8019E36C2E964; do gpg --batch --keyserver keyserver.ubuntu.com --recv-keys \"$key\" || gpg --batch --keyserver pgp.mit.edu --recv-keys \"$key\" || gpg --batch --keyserver keyserver.pgp.com --recv-keys \"$key\" || gpg --batch --keyserver ha.pool.sks-keyservers.net --recv-keys \"$key\" || gpg --batch --keyserver hkp://p80.pool.sks-keyservers.net:80 --recv-keys \"$key\" ; done\nENV BITCOIN_VERSION=\"0.11.2\"\nENV BITCOIN_PREFIX=\"/opt/bitcoin-${BITCOIN_VERSION}\"\nRUN wget https://bitcoin.org/bin/bitcoin-core-${BITCOIN_VERSION}/SHA256SUMS.asc\nRUN wget https://bitcoin.org/bin/bitcoin-core-${BITCOIN_VERSION}/bitcoin-${BITCOIN_VERSION}.tar.gz\nRUN gpg --verify SHA256SUMS.asc\nRUN grep \" bitcoin-${BITCOIN_VERSION}.tar.gz$\" SHA256SUMS.asc | sha256sum -c -\nRUN tar -xzf *.tar.gz\nWORKDIR /bitcoin-${BITCOIN_VERSION}\nCOPY patches/warnings.patch /warnings.patch\nRUN patch -p0 < /warnings.patch\nRUN ./autogen.sh\nRUN ./configure LDFLAGS=-L`ls -d /opt/db* `/lib/ CPPFLAGS=-I`ls -d /opt/db* `/include/ --prefix=${BITCOIN_PREFIX} --mandir=/usr/share/man --disable-tests --disable-bench --disable-ccache --with-gui=no --with-utils --with-libs --with-daemon\nRUN make -j4\nRUN make install\nRUN strip ${BITCOIN_PREFIX}/bin/bitcoin-cli\nRUN strip ${BITCOIN_PREFIX}/bin/bitcoin-tx\nRUN strip ${BITCOIN_PREFIX}/bin/bitcoind\nRUN strip ${BITCOIN_PREFIX}/lib/libbitcoinconsensus.a\nRUN strip ${BITCOIN_PREFIX}/lib/libbitcoinconsensus.so.0.0.0\n#   Build stage for compiled artifacts\nFROM alpine:3.7\nLABEL maintainer.0=\"João Fonseca (@joaopaulofonseca)\" \\\n      maintainer.1=\"Pedro Branco (@pedrobranco)\" \\\n      maintainer.2=\"Rui Marinho (@ruimarinho)\"\nRUN adduser -S bitcoin\nRUN sed -i 's/http\\:\\/\\/dl-cdn.alpinelinux.org/https\\:\\/\\/alpine.global.ssl.fastly.net/g' /etc/apk/repositories\nRUN apk --no-cache add boost boost-program_options libevent openssl libzmq su-exec\nENV BITCOIN_DATA=\"/home/bitcoin/.bitcoin\"\nENV BITCOIN_VERSION=\"0.11.2\"\nENV BITCOIN_PREFIX=\"/opt/bitcoin-${BITCOIN_VERSION}\"\nENV PATH=\"${BITCOIN_PREFIX}/bin:$PATH\"\nCOPY --from=bitcoin-core /opt /opt\nCOPY docker-entrypoint.sh /entrypoint.sh\nVOLUME [\"/home/bitcoin/.bitcoin\"]\nEXPOSE 8332/tcp 8333/tcp 18332/tcp 18333/tcp 18444/tcp\nENTRYPOINT [\"/entrypoint.sh\"]\nCMD [\"bitcoind\"]\n","originalDockerfileUglifiedHash":"c85e1f182ef8bf085f7738d2119c5540","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/927d1f357831fb435335452936c354100b010643.dockerfile"}