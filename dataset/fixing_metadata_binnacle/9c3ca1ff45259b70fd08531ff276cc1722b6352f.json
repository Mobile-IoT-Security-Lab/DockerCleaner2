{"seed":3944173645,"processedDockerfileHash":"f2333778548428a994ef7706f30c180a","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["have-a-healthcheck","have-a-user"],"processedDockerfile":"#  #\n#   Use Java base image and setup required RPMS as cacheable image.\n#  #\nARG BASE_IMAGE=\"opennms/openjdk\"\nARG BASE_IMAGE_VERSION=\"11\"\nFROM ${BASE_IMAGE}:${BASE_IMAGE_VERSION} AS horizon-base\nARG REQUIRED_RPMS=\"rrdtool jrrd2 jicmp jicmp6 R-core rsync perl-XML-Twig perl-libwww-perl\"\nARG REPO_KEY_URL=\"https://yum.opennms.org/OPENNMS-GPG-KEY\"\nARG REPO_RPM=\"https://yum.opennms.org/repofiles/opennms-repo-stable-rhel7.noarch.rpm\"\nSHELL [\"/bin/bash\", \"-c\"]\n#   Collect generic steps in a layer for caching\nRUN rpm --import \"${REPO_KEY_URL}\" \\\n && yum install -y epel-release \\\n && yum -y install \"${REPO_RPM}\" \\\n && yum -y install ${REQUIRED_RPMS} \\\n && yum clean all -y \\\n && rm -rf /var/cache/yum\n#  #\n#   Install and setup OpenNMS RPMS\n#  #\nFROM horizon-base\n#   A default which installs the required OpenNMS Horizon packages\nARG ONMS_PACKAGES=\"opennms-core opennms-webapp-jetty opennms-webapp-remoting opennms-webapp-hawtio\"\n#   Allow to install optional packages via YUM\nARG ADD_YUM_PACKAGES\nCOPY ./rpms /tmp/rpms\nSHELL [\"/bin/bash\", \"-c\"]\n#   Install repositories, system and OpenNMS packages and do some cleanup\nRUN if [[ \"$( ls -1 /tmp/rpms/*.rpm 2> /dev/null | wc -l ;)\" != 0 ]] ; then yum -y localinstall /tmp/rpms/*.rpm ; else yum install -y ${ONMS_PACKAGES} ; fi \\\n && if [[ -n ${ADD_YUM_PACKAGES} ]] ; then yum -y install ${ADD_YUM_PACKAGES} ; fi \\\n && rm -rf /tmp/rpms \\\n && yum clean all \\\n && rm -rf /var/cache/yum \\\n && rm -rf /opt/opennms/logs /var/opennms/rrd /var/opennms/reports \\\n && mkdir -p /opennms-data/logs /opennms-data/rrd /opennms-data/reports \\\n && ln -s /opennms-data/logs /opt/opennms/logs \\\n && ln -s /opennms-data/rrd /var/opennms/rrd \\\n && ln -s /opennms-data/reports /var/opennms/reports\n#   Add templates replaced at runtime and entrypoint\nCOPY ./assets/*.tpl /root/\nCOPY ./assets/entrypoint.sh /\n#   Arguments for labels should not invalidate caches\nARG BUILD_DATE=\"1970-01-01T00:00:00+0000\"\nARG VERSION=${BASE_IMAGE_VERSION}\nARG BUILD_NUMBER\nARG BUILD_URL\nARG BUILD_BRANCH\nARG BUILD_SHA1\nLABEL maintainer=\"The OpenNMS Group\" \\\n      license=\"AGPLv3\" \\\n      name=\"Horizon\" \\\n      version=\"${VERSION}\" \\\n      vendor=\"OpenNMS Community\" \\\n      cicd.build.date=\"${BUILD_DATE}\" \\\n      cicd.build.number=\"${BUILD_NUMBER}\" \\\n      cicd.build.url=\"${BUILD_URL}\" \\\n      cicd.build.branch=\"${BUILD_BRANCH}\" \\\n      cicd.build.sha1=\"${CIRCLE_SHA1}\"\nWORKDIR /opt/opennms\nENTRYPOINT [\"/entrypoint.sh\"]\nSTOPSIGNAL SIGTERM\nCMD [\"-h\"]\n#  ## Runtime information and not relevant at build time\nENV OPENNMS_KARAF_SSH_HOST=\"0.0.0.0\" \\\n    OPENNMS_KARAF_SSH_PORT=\"8101\" \\\n    JAVA_OPTS=\"\"\n#   Volumes for storing data outside of the container\nVOLUME [ \"/opt/opennms/etc\", \"/opt/opennms-etc-overlay\", \"/opennms-data\" ]\n#  #------------------------------------------------------------------------------\n#  # EXPOSED PORTS\n#  #------------------------------------------------------------------------------\n#  # -- OpenNMS HTTP        8980/TCP\n#  # -- OpenNMS JMX        18980/TCP\n#  # -- OpenNMS KARAF RMI   1099/TCP\n#  # -- OpenNMS KARAF SSH   8101/TCP\n#  # -- OpenNMS MQ         61616/TCP\n#  # -- OpenNMS Eventd      5817/TCP\n#  # -- SNMP Trapd           162/UDP\n#  # -- Syslog Receiver      514/UDP\nEXPOSE 8980/tcp 8101/tcp 61616/tcp 162/udp 514/udp\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"# #\n#  Use Java base image and setup required RPMS as cacheable image.\n# #\nARG BASE_IMAGE=\"opennms/openjdk\"\nARG BASE_IMAGE_VERSION=\"11\"\nFROM ${BASE_IMAGE}:${BASE_IMAGE_VERSION} AS horizon-base\nARG REQUIRED_RPMS=\"rrdtool jrrd2 jicmp jicmp6 R-core rsync perl-XML-Twig perl-libwww-perl\"\nARG REPO_KEY_URL=\"https://yum.opennms.org/OPENNMS-GPG-KEY\"\nARG REPO_RPM=\"https://yum.opennms.org/repofiles/opennms-repo-stable-rhel7.noarch.rpm\"\nSHELL [\"/bin/bash\", \"-c\"]\n#  Collect generic steps in a layer for caching\nRUN rpm --import \"${REPO_KEY_URL}\" \\\n && yum install -y epel-release \\\n && yum -y install \"${REPO_RPM}\" \\\n && yum -y install ${REQUIRED_RPMS} \\\n && yum clean all -y \\\n && rm -rf /var/cache/yum\n# #\n#  Install and setup OpenNMS RPMS\n# #\nFROM horizon-base\n#  A default which installs the required OpenNMS Horizon packages\nARG ONMS_PACKAGES=\"opennms-core opennms-webapp-jetty opennms-webapp-remoting opennms-webapp-hawtio\"\n#  Allow to install optional packages via YUM\nARG ADD_YUM_PACKAGES\nCOPY ./rpms /tmp/rpms\nSHELL [\"/bin/bash\", \"-c\"]\n#  Install repositories, system and OpenNMS packages and do some cleanup\nRUN if [[ \"$( ls -1 /tmp/rpms/*.rpm 2> /dev/null | wc -l ;)\" != 0 ]] ; then yum -y localinstall /tmp/rpms/*.rpm ; else yum install -y ${ONMS_PACKAGES} ; fi \\\n && if [[ -n ${ADD_YUM_PACKAGES} ]] ; then yum -y install ${ADD_YUM_PACKAGES} ; fi \\\n && rm -rf /tmp/rpms \\\n && yum clean all \\\n && rm -rf /var/cache/yum \\\n && rm -rf /opt/opennms/logs /var/opennms/rrd /var/opennms/reports \\\n && mkdir -p /opennms-data/logs /opennms-data/rrd /opennms-data/reports \\\n && ln -s /opennms-data/logs /opt/opennms/logs \\\n && ln -s /opennms-data/rrd /var/opennms/rrd \\\n && ln -s /opennms-data/reports /var/opennms/reports\n#  Add templates replaced at runtime and entrypoint\nCOPY ./assets/*.tpl /root/\nCOPY ./assets/entrypoint.sh /\n#  Arguments for labels should not invalidate caches\nARG BUILD_DATE=\"1970-01-01T00:00:00+0000\"\nARG VERSION=${BASE_IMAGE_VERSION}\nARG BUILD_NUMBER\nARG BUILD_URL\nARG BUILD_BRANCH\nARG BUILD_SHA1\nLABEL maintainer=\"The OpenNMS Group\" \\\n      license=\"AGPLv3\" \\\n      name=\"Horizon\" \\\n      version=\"${VERSION}\" \\\n      vendor=\"OpenNMS Community\" \\\n      cicd.build.date=\"${BUILD_DATE}\" \\\n      cicd.build.number=\"${BUILD_NUMBER}\" \\\n      cicd.build.url=\"${BUILD_URL}\" \\\n      cicd.build.branch=\"${BUILD_BRANCH}\" \\\n      cicd.build.sha1=\"${CIRCLE_SHA1}\"\nWORKDIR /opt/opennms\nENTRYPOINT [\"/entrypoint.sh\"]\nSTOPSIGNAL SIGTERM\nCMD [\"-h\"]\n# ## Runtime information and not relevant at build time\nENV OPENNMS_KARAF_SSH_HOST=\"0.0.0.0\" \\\n    OPENNMS_KARAF_SSH_PORT=\"8101\" \\\n    JAVA_OPTS=\"\"\n#  Volumes for storing data outside of the container\nVOLUME [ \"/opt/opennms/etc\", \"/opt/opennms-etc-overlay\", \"/opennms-data\" ]\n# #------------------------------------------------------------------------------\n# # EXPOSED PORTS\n# #------------------------------------------------------------------------------\n# # -- OpenNMS HTTP        8980/TCP\n# # -- OpenNMS JMX        18980/TCP\n# # -- OpenNMS KARAF RMI   1099/TCP\n# # -- OpenNMS KARAF SSH   8101/TCP\n# # -- OpenNMS MQ         61616/TCP\n# # -- OpenNMS Eventd      5817/TCP\n# # -- SNMP Trapd           162/UDP\n# # -- Syslog Receiver      514/UDP\nEXPOSE 8980/tcp 8101/tcp 61616/tcp 162/udp 514/udp\n","injectedSmells":[],"originalDockerfileHash":"d9c26d7acfc8595b2b8978b2eb17504d","successfullyInjectedSmells":[],"originalDockerfileUglified":"#  #\n#   Use Java base image and setup required RPMS as cacheable image.\n#  #\nARG BASE_IMAGE=\"opennms/openjdk\"\nARG BASE_IMAGE_VERSION=\"11\"\nFROM ${BASE_IMAGE}:${BASE_IMAGE_VERSION} AS horizon-base\nARG REQUIRED_RPMS=\"rrdtool jrrd2 jicmp jicmp6 R-core rsync perl-XML-Twig perl-libwww-perl\"\nARG REPO_KEY_URL=\"https://yum.opennms.org/OPENNMS-GPG-KEY\"\nARG REPO_RPM=\"https://yum.opennms.org/repofiles/opennms-repo-stable-rhel7.noarch.rpm\"\nSHELL [\"/bin/bash\", \"-c\"]\n#   Collect generic steps in a layer for caching\nRUN rpm --import \"${REPO_KEY_URL}\" \\\n && yum install -y epel-release \\\n && yum -y install \"${REPO_RPM}\" \\\n && yum -y install ${REQUIRED_RPMS} \\\n && yum clean all -y \\\n && rm -rf /var/cache/yum\n#  #\n#   Install and setup OpenNMS RPMS\n#  #\nFROM horizon-base\n#   A default which installs the required OpenNMS Horizon packages\nARG ONMS_PACKAGES=\"opennms-core opennms-webapp-jetty opennms-webapp-remoting opennms-webapp-hawtio\"\n#   Allow to install optional packages via YUM\nARG ADD_YUM_PACKAGES\nCOPY ./rpms /tmp/rpms\nSHELL [\"/bin/bash\", \"-c\"]\n#   Install repositories, system and OpenNMS packages and do some cleanup\nRUN if [[ \"$( ls -1 /tmp/rpms/*.rpm 2> /dev/null | wc -l ;)\" != 0 ]] ; then yum -y localinstall /tmp/rpms/*.rpm ; else yum install -y ${ONMS_PACKAGES} ; fi \\\n && if [[ -n ${ADD_YUM_PACKAGES} ]] ; then yum -y install ${ADD_YUM_PACKAGES} ; fi \\\n && rm -rf /tmp/rpms \\\n && yum clean all \\\n && rm -rf /var/cache/yum \\\n && rm -rf /opt/opennms/logs /var/opennms/rrd /var/opennms/reports \\\n && mkdir -p /opennms-data/logs /opennms-data/rrd /opennms-data/reports \\\n && ln -s /opennms-data/logs /opt/opennms/logs \\\n && ln -s /opennms-data/rrd /var/opennms/rrd \\\n && ln -s /opennms-data/reports /var/opennms/reports\n#   Add templates replaced at runtime and entrypoint\nCOPY ./assets/*.tpl /root/\nCOPY ./assets/entrypoint.sh /\n#   Arguments for labels should not invalidate caches\nARG BUILD_DATE=\"1970-01-01T00:00:00+0000\"\nARG VERSION=${BASE_IMAGE_VERSION}\nARG BUILD_NUMBER\nARG BUILD_URL\nARG BUILD_BRANCH\nARG BUILD_SHA1\nLABEL maintainer=\"The OpenNMS Group\" \\\n      license=\"AGPLv3\" \\\n      name=\"Horizon\" \\\n      version=\"${VERSION}\" \\\n      vendor=\"OpenNMS Community\" \\\n      cicd.build.date=\"${BUILD_DATE}\" \\\n      cicd.build.number=\"${BUILD_NUMBER}\" \\\n      cicd.build.url=\"${BUILD_URL}\" \\\n      cicd.build.branch=\"${BUILD_BRANCH}\" \\\n      cicd.build.sha1=\"${CIRCLE_SHA1}\"\nWORKDIR /opt/opennms\nENTRYPOINT [\"/entrypoint.sh\"]\nSTOPSIGNAL SIGTERM\nCMD [\"-h\"]\n#  ## Runtime information and not relevant at build time\nENV OPENNMS_KARAF_SSH_HOST=\"0.0.0.0\" \\\n    OPENNMS_KARAF_SSH_PORT=\"8101\" \\\n    JAVA_OPTS=\"\"\n#   Volumes for storing data outside of the container\nVOLUME [ \"/opt/opennms/etc\", \"/opt/opennms-etc-overlay\", \"/opennms-data\" ]\n#  #------------------------------------------------------------------------------\n#  # EXPOSED PORTS\n#  #------------------------------------------------------------------------------\n#  # -- OpenNMS HTTP        8980/TCP\n#  # -- OpenNMS JMX        18980/TCP\n#  # -- OpenNMS KARAF RMI   1099/TCP\n#  # -- OpenNMS KARAF SSH   8101/TCP\n#  # -- OpenNMS MQ         61616/TCP\n#  # -- OpenNMS Eventd      5817/TCP\n#  # -- SNMP Trapd           162/UDP\n#  # -- Syslog Receiver      514/UDP\nEXPOSE 8980/tcp 8101/tcp 61616/tcp 162/udp 514/udp\n","originalDockerfileUglifiedHash":"f37743b4fe5ff7935b639788b4ca442d","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/9c3ca1ff45259b70fd08531ff276cc1722b6352f.dockerfile"}