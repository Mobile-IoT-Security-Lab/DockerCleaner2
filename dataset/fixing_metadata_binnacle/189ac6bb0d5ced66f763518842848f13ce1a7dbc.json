{"seed":4122397343,"processedDockerfileHash":"50bc6538db403283ffd134eef13dd05b","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","have-a-healthcheck","have-a-user"],"processedDockerfile":"#   Build stage for BerkeleyDB\nFROM alpine:3.8 AS berkeleydb\nRUN apk add autoconf=2.69-r2 --no-cache\nRUN apk add automake=1.16.1-r0 --no-cache\nRUN apk add build-base=0.5-r1 --no-cache\nRUN apk add libressl=2.7.5-r0 --no-cache\nENV BERKELEYDB_VERSION=\"db-4.8.30.NC\"\nENV BERKELEYDB_PREFIX=\"/opt/${BERKELEYDB_VERSION}\"\nRUN wget https://download.oracle.com/berkeley-db/${BERKELEYDB_VERSION}.tar.gz\nRUN tar -xzf *.tar.gz\nRUN sed s/__atomic_compare_exchange/__atomic_compare_exchange_db/g -i ${BERKELEYDB_VERSION}/dbinc/atomic.h\nRUN mkdir -p ${BERKELEYDB_PREFIX}\nWORKDIR /${BERKELEYDB_VERSION}/build_unix\nRUN ../dist/configure --enable-cxx --disable-shared --with-pic --prefix=${BERKELEYDB_PREFIX}\nRUN make -j4\nRUN make install\nRUN rm -rf ${BERKELEYDB_PREFIX}/docs\n#   Build stage for Bitcoin ABC\nFROM alpine:3.8 AS bitcoin-abc\nCOPY --from=berkeleydb /opt /opt\nRUN apk add autoconf=2.69-r2 --no-cache\nRUN apk add automake=1.16.1-r0 --no-cache\nRUN apk add boost-dev=1.66.0-r0 --no-cache\nRUN apk add build-base=0.5-r1 --no-cache\nRUN apk add chrpath=0.16-r1 --no-cache\nRUN apk add file=5.32-r2 --no-cache\nRUN apk add gnupg=2.2.19-r0 --no-cache\nRUN apk add libevent-dev=2.1.8-r5 --no-cache\nRUN apk add libressl=2.7.5-r0 --no-cache\nRUN apk add libressl-dev=2.7.5-r0 --no-cache\nRUN apk add libtool=2.4.6-r5 --no-cache\nRUN apk add linux-headers=4.4.6-r2 --no-cache\nRUN apk add protobuf-dev=3.5.2-r0 --no-cache\nRUN apk add zeromq-dev=4.2.5-r1 --no-cache\nRUN set -ex \\\n && for key in 90C8019E36C2E964; do gpg --keyserver pgp.mit.edu --recv-keys \"$key\" || gpg --keyserver keyserver.pgp.com --recv-keys \"$key\" || gpg --keyserver ha.pool.sks-keyservers.net --recv-keys \"$key\" || gpg --keyserver hkp://p80.pool.sks-keyservers.net:80 --recv-keys \"$key\" ; done\nENV BITCOIN_ABC_VERSION=\"0.17.1\"\nENV BITCOIN_ABC_SHASUM=\"8baaedfb868fdbbde2a074b6396fb00dec28df35a0f6f29e9995778d3e08535a  bitcoin-abc-${BITCOIN_ABC_VERSION}.tar.gz\"\nENV BITCOIN_ABC_PREFIX=\"/opt/bitcoin-abc-${BITCOIN_ABC_VERSION}\"\nRUN wget https://download.bitcoinabc.org/${BITCOIN_ABC_VERSION}/linux/src/bitcoin-abc-${BITCOIN_ABC_VERSION}.tar.gz\nRUN echo \"${BITCOIN_ABC_SHASUM}\" | sha256sum -c\nRUN tar -xzf *.tar.gz\nWORKDIR /bitcoin-abc-${BITCOIN_ABC_VERSION}\nRUN sed -i '/AC_PREREQ/a\\AR_FLAGS=cr' src/univalue/configure.ac\nRUN sed -i '/AX_PROG_CC_FOR_BUILD/a\\AR_FLAGS=cr' src/secp256k1/configure.ac\nRUN sed -i s:sys/fcntl.h:fcntl.h: src/compat.h\nRUN ./autogen.sh\nRUN ./configure LDFLAGS=-L`ls -d /opt/db* `/lib/ CPPFLAGS=-I`ls -d /opt/db* `/include/ --prefix=${BITCOIN_ABC_PREFIX} --mandir=/usr/share/man --disable-tests --disable-bench --disable-ccache --with-gui=no --with-utils --with-libs --with-daemon --without-seeder\nRUN make -j4\nRUN make install\nRUN strip ${BITCOIN_ABC_PREFIX}/bin/bitcoin-cli\nRUN strip ${BITCOIN_ABC_PREFIX}/bin/bitcoin-tx\nRUN strip ${BITCOIN_ABC_PREFIX}/bin/bitcoind\nRUN strip ${BITCOIN_ABC_PREFIX}/lib/libbitcoinconsensus.a\nRUN strip ${BITCOIN_ABC_PREFIX}/lib/libbitcoinconsensus.so.0.0.0\n#   Build stage for compiled artifacts\nFROM alpine:3.8\nLABEL maintainer.0=\"João Fonseca (@joaopaulofonseca)\" \\\n      maintainer.1=\"Pedro Branco (@pedrobranco)\" \\\n      maintainer.2=\"Rui Marinho (@ruimarinho)\"\nRUN adduser -S bitcoin\nRUN apk add boost=1.66.0-r0 boost-program_options=1.66.0-r0 curl=7.61.1-r3 libevent=2.1.8-r5 libressl=2.7.5-r0 libzmq=4.2.5-r1 su-exec=0.2-r0 --no-cache\nENV BITCOIN_ABC_DATA=\"/home/bitcoin/.bitcoin\"\nENV BITCOIN_ABC_VERSION=\"0.17.1\"\nENV BITCOIN_ABC_PREFIX=\"/opt/bitcoin-abc-${BITCOIN_ABC_VERSION}\"\nENV PATH=\"${BITCOIN_ABC_PREFIX}/bin:$PATH\"\nCOPY --from=bitcoin-abc /opt /opt\nCOPY docker-entrypoint.sh /entrypoint.sh\nVOLUME [\"/home/bitcoin/.bitcoin\"]\nEXPOSE 8332/tcp 8333/tcp 18332/tcp 18333/tcp 18444/tcp\nENTRYPOINT [\"/entrypoint.sh\"]\nCMD [\"bitcoind\"]\nRUN addgroup -S docker-user ; adduser -S -G docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  Build stage for BerkeleyDB\nFROM alpine:3.8 AS berkeleydb\nRUN apk --no-cache add autoconf\nRUN apk --no-cache add automake\nRUN apk --no-cache add build-base\nRUN apk --no-cache add libressl\nENV BERKELEYDB_VERSION=\"db-4.8.30.NC\"\nENV BERKELEYDB_PREFIX=\"/opt/${BERKELEYDB_VERSION}\"\nRUN wget https://download.oracle.com/berkeley-db/${BERKELEYDB_VERSION}.tar.gz\nRUN tar -xzf *.tar.gz\nRUN sed s/__atomic_compare_exchange/__atomic_compare_exchange_db/g -i ${BERKELEYDB_VERSION}/dbinc/atomic.h\nRUN mkdir -p ${BERKELEYDB_PREFIX}\nWORKDIR /${BERKELEYDB_VERSION}/build_unix\nRUN ../dist/configure --enable-cxx --disable-shared --with-pic --prefix=${BERKELEYDB_PREFIX}\nRUN make -j4\nRUN make install\nRUN rm -rf ${BERKELEYDB_PREFIX}/docs\n#  Build stage for Bitcoin ABC\nFROM alpine:3.8 AS bitcoin-abc\nCOPY --from=berkeleydb /opt /opt\nRUN apk --no-cache add autoconf\nRUN apk --no-cache add automake\nRUN apk --no-cache add boost-dev\nRUN apk --no-cache add build-base\nRUN apk --no-cache add chrpath\nRUN apk --no-cache add file\nRUN apk --no-cache add gnupg\nRUN apk --no-cache add libevent-dev\nRUN apk --no-cache add libressl\nRUN apk --no-cache add libressl-dev\nRUN apk --no-cache add libtool\nRUN apk --no-cache add linux-headers\nRUN apk --no-cache add protobuf-dev\nRUN apk --no-cache add zeromq-dev\nRUN set -ex \\\n && for key in 90C8019E36C2E964; do gpg --keyserver pgp.mit.edu --recv-keys \"$key\" || gpg --keyserver keyserver.pgp.com --recv-keys \"$key\" || gpg --keyserver ha.pool.sks-keyservers.net --recv-keys \"$key\" || gpg --keyserver hkp://p80.pool.sks-keyservers.net:80 --recv-keys \"$key\" ; done\nENV BITCOIN_ABC_VERSION=\"0.17.1\"\nENV BITCOIN_ABC_SHASUM=\"8baaedfb868fdbbde2a074b6396fb00dec28df35a0f6f29e9995778d3e08535a  bitcoin-abc-${BITCOIN_ABC_VERSION}.tar.gz\"\nENV BITCOIN_ABC_PREFIX=\"/opt/bitcoin-abc-${BITCOIN_ABC_VERSION}\"\nRUN wget https://download.bitcoinabc.org/${BITCOIN_ABC_VERSION}/linux/src/bitcoin-abc-${BITCOIN_ABC_VERSION}.tar.gz\nRUN echo \"${BITCOIN_ABC_SHASUM}\" | sha256sum -c\nRUN tar -xzf *.tar.gz\nWORKDIR /bitcoin-abc-${BITCOIN_ABC_VERSION}\nRUN sed -i '/AC_PREREQ/a\\AR_FLAGS=cr' src/univalue/configure.ac\nRUN sed -i '/AX_PROG_CC_FOR_BUILD/a\\AR_FLAGS=cr' src/secp256k1/configure.ac\nRUN sed -i s:sys/fcntl.h:fcntl.h: src/compat.h\nRUN ./autogen.sh\nRUN ./configure LDFLAGS=-L`ls -d /opt/db* `/lib/ CPPFLAGS=-I`ls -d /opt/db* `/include/ --prefix=${BITCOIN_ABC_PREFIX} --mandir=/usr/share/man --disable-tests --disable-bench --disable-ccache --with-gui=no --with-utils --with-libs --with-daemon --without-seeder\nRUN make -j4\nRUN make install\nRUN strip ${BITCOIN_ABC_PREFIX}/bin/bitcoin-cli\nRUN strip ${BITCOIN_ABC_PREFIX}/bin/bitcoin-tx\nRUN strip ${BITCOIN_ABC_PREFIX}/bin/bitcoind\nRUN strip ${BITCOIN_ABC_PREFIX}/lib/libbitcoinconsensus.a\nRUN strip ${BITCOIN_ABC_PREFIX}/lib/libbitcoinconsensus.so.0.0.0\n#  Build stage for compiled artifacts\nFROM alpine:3.8\nLABEL maintainer.0=\"João Fonseca (@joaopaulofonseca)\" \\\n      maintainer.1=\"Pedro Branco (@pedrobranco)\" \\\n      maintainer.2=\"Rui Marinho (@ruimarinho)\"\nRUN adduser -S bitcoin\nRUN apk --no-cache add boost boost-program_options curl libevent libressl libzmq su-exec\nENV BITCOIN_ABC_DATA=\"/home/bitcoin/.bitcoin\"\nENV BITCOIN_ABC_VERSION=\"0.17.1\"\nENV BITCOIN_ABC_PREFIX=\"/opt/bitcoin-abc-${BITCOIN_ABC_VERSION}\"\nENV PATH=\"${BITCOIN_ABC_PREFIX}/bin:$PATH\"\nCOPY --from=bitcoin-abc /opt /opt\nCOPY docker-entrypoint.sh /entrypoint.sh\nVOLUME [\"/home/bitcoin/.bitcoin\"]\nEXPOSE 8332/tcp 8333/tcp 18332/tcp 18333/tcp 18444/tcp\nENTRYPOINT [\"/entrypoint.sh\"]\nCMD [\"bitcoind\"]\n","injectedSmells":[],"originalDockerfileHash":"a87d17f2812cd51da188da36f5b6ca9f","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   Build stage for BerkeleyDB\nFROM alpine:3.8 AS berkeleydb\nRUN apk --no-cache add autoconf\nRUN apk --no-cache add automake\nRUN apk --no-cache add build-base\nRUN apk --no-cache add libressl\nENV BERKELEYDB_VERSION=\"db-4.8.30.NC\"\nENV BERKELEYDB_PREFIX=\"/opt/${BERKELEYDB_VERSION}\"\nRUN wget https://download.oracle.com/berkeley-db/${BERKELEYDB_VERSION}.tar.gz\nRUN tar -xzf *.tar.gz\nRUN sed s/__atomic_compare_exchange/__atomic_compare_exchange_db/g -i ${BERKELEYDB_VERSION}/dbinc/atomic.h\nRUN mkdir -p ${BERKELEYDB_PREFIX}\nWORKDIR /${BERKELEYDB_VERSION}/build_unix\nRUN ../dist/configure --enable-cxx --disable-shared --with-pic --prefix=${BERKELEYDB_PREFIX}\nRUN make -j4\nRUN make install\nRUN rm -rf ${BERKELEYDB_PREFIX}/docs\n#   Build stage for Bitcoin ABC\nFROM alpine:3.8 AS bitcoin-abc\nCOPY --from=berkeleydb /opt /opt\nRUN apk --no-cache add autoconf\nRUN apk --no-cache add automake\nRUN apk --no-cache add boost-dev\nRUN apk --no-cache add build-base\nRUN apk --no-cache add chrpath\nRUN apk --no-cache add file\nRUN apk --no-cache add gnupg\nRUN apk --no-cache add libevent-dev\nRUN apk --no-cache add libressl\nRUN apk --no-cache add libressl-dev\nRUN apk --no-cache add libtool\nRUN apk --no-cache add linux-headers\nRUN apk --no-cache add protobuf-dev\nRUN apk --no-cache add zeromq-dev\nRUN set -ex \\\n && for key in 90C8019E36C2E964; do gpg --keyserver pgp.mit.edu --recv-keys \"$key\" || gpg --keyserver keyserver.pgp.com --recv-keys \"$key\" || gpg --keyserver ha.pool.sks-keyservers.net --recv-keys \"$key\" || gpg --keyserver hkp://p80.pool.sks-keyservers.net:80 --recv-keys \"$key\" ; done\nENV BITCOIN_ABC_VERSION=\"0.17.1\"\nENV BITCOIN_ABC_SHASUM=\"8baaedfb868fdbbde2a074b6396fb00dec28df35a0f6f29e9995778d3e08535a  bitcoin-abc-${BITCOIN_ABC_VERSION}.tar.gz\"\nENV BITCOIN_ABC_PREFIX=\"/opt/bitcoin-abc-${BITCOIN_ABC_VERSION}\"\nRUN wget https://download.bitcoinabc.org/${BITCOIN_ABC_VERSION}/linux/src/bitcoin-abc-${BITCOIN_ABC_VERSION}.tar.gz\nRUN echo \"${BITCOIN_ABC_SHASUM}\" | sha256sum -c\nRUN tar -xzf *.tar.gz\nWORKDIR /bitcoin-abc-${BITCOIN_ABC_VERSION}\nRUN sed -i '/AC_PREREQ/a\\AR_FLAGS=cr' src/univalue/configure.ac\nRUN sed -i '/AX_PROG_CC_FOR_BUILD/a\\AR_FLAGS=cr' src/secp256k1/configure.ac\nRUN sed -i s:sys/fcntl.h:fcntl.h: src/compat.h\nRUN ./autogen.sh\nRUN ./configure LDFLAGS=-L`ls -d /opt/db* `/lib/ CPPFLAGS=-I`ls -d /opt/db* `/include/ --prefix=${BITCOIN_ABC_PREFIX} --mandir=/usr/share/man --disable-tests --disable-bench --disable-ccache --with-gui=no --with-utils --with-libs --with-daemon --without-seeder\nRUN make -j4\nRUN make install\nRUN strip ${BITCOIN_ABC_PREFIX}/bin/bitcoin-cli\nRUN strip ${BITCOIN_ABC_PREFIX}/bin/bitcoin-tx\nRUN strip ${BITCOIN_ABC_PREFIX}/bin/bitcoind\nRUN strip ${BITCOIN_ABC_PREFIX}/lib/libbitcoinconsensus.a\nRUN strip ${BITCOIN_ABC_PREFIX}/lib/libbitcoinconsensus.so.0.0.0\n#   Build stage for compiled artifacts\nFROM alpine:3.8\nLABEL maintainer.0=\"João Fonseca (@joaopaulofonseca)\" \\\n      maintainer.1=\"Pedro Branco (@pedrobranco)\" \\\n      maintainer.2=\"Rui Marinho (@ruimarinho)\"\nRUN adduser -S bitcoin\nRUN apk --no-cache add boost boost-program_options curl libevent libressl libzmq su-exec\nENV BITCOIN_ABC_DATA=\"/home/bitcoin/.bitcoin\"\nENV BITCOIN_ABC_VERSION=\"0.17.1\"\nENV BITCOIN_ABC_PREFIX=\"/opt/bitcoin-abc-${BITCOIN_ABC_VERSION}\"\nENV PATH=\"${BITCOIN_ABC_PREFIX}/bin:$PATH\"\nCOPY --from=bitcoin-abc /opt /opt\nCOPY docker-entrypoint.sh /entrypoint.sh\nVOLUME [\"/home/bitcoin/.bitcoin\"]\nEXPOSE 8332/tcp 8333/tcp 18332/tcp 18333/tcp 18444/tcp\nENTRYPOINT [\"/entrypoint.sh\"]\nCMD [\"bitcoind\"]\n","originalDockerfileUglifiedHash":"7e4967bb42f095cc459766d5720500b7","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/189ac6bb0d5ced66f763518842848f13ce1a7dbc.dockerfile"}