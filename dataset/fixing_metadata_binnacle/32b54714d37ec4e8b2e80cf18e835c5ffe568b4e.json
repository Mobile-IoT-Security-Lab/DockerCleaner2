{"seed":265250378,"processedDockerfileHash":"edc7e44304296de88d503356a7fb72f5","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","use-copy-instead-of-add","have-a-healthcheck"],"processedDockerfile":"#   Name: webrtcDocker\n#   Description: installs webrtc in ubuntu trusty 14.04 environment\n#\n#   VERSION       1.0\n#\n#   Use the ubuntu base image\nFROM ubuntu:trusty\nMAINTAINER Oleg Blinnikov, osblinnikov@gmail.com\n#   make sure the package repository is up to date\nRUN :\nRUN apt-get -y upgrade\n#   Adding vnc server\n#   no Upstart or DBus\n#   https://github.com/dotcloud/docker/issues/1724#issuecomment-26294856\nRUN apt-mark hold initscripts udev plymouth mountall\nRUN dpkg-divert --local --rename --add /sbin/initctl \\\n && ln -sf /bin/true /sbin/initctl\nRUN (apt-get update ;apt-get install --no-install-recommends supervisor=3.0b2-1ubuntu0.1 openssh-server=1:6.6p1-2ubuntu2.13 pwgen=2.06-1ubuntu4 sudo=1.8.9p5-1ubuntu1.4 vim-tiny=2:7.4.052-1ubuntu3.1 net-tools=1.60-25ubuntu2.1 lxde=0.5.0-4ubuntu4 x11vnc=0.9.13-1.1 xvfb=2:1.15.1-0ubuntu2.11 gtk2-engines-murrine=0.98.2-0ubuntu2 ttf-ubuntu-font-family=0.80-0ubuntu6 nodejs=0.10.25~dfsg2-2ubuntu1.2 wget=1.15-1ubuntu1.14.04.5 curl=7.35.0-1ubuntu2.20 -y --force-yes )\nRUN (apt-get update ;apt-get install --no-install-recommends git=1:1.9.1-1ubuntu0.10 git-svn=1:1.9.1-1ubuntu0.10 subversion=1.8.8-1ubuntu3.3 -y )\nRUN (apt-get update ;apt-get install --no-install-recommends openjdk-7-jdk=7u211-2.6.17-0ubuntu0.1 -y )\n#   Now create the webrtc user itself\nRUN adduser --gecos \"webRTC User\" --disabled-password webrtc\nRUN usermod -a -G dialout webrtc\nCOPY 99_aptget /etc/sudoers.d/99_aptget\nRUN chmod 0440 /etc/sudoers.d/99_aptget \\\n && chown root:root /etc/sudoers.d/99_aptget\nRUN echo \" ForwardX11Trusted yes\\n\" >> /etc/ssh/ssh_config\nRUN mkdir -p /home/webrtc \\\n && chown webrtc:webrtc /home/webrtc\n#   And, as that user...\nUSER webrtc\n#   clone depot tools from chromium project\nRUN cd /home/webrtc \\\n && git clone https://chromium.googlesource.com/chromium/tools/depot_tools.git\nRUN mkdir -p /home/webrtc/webrtc.googlecode.com\nRUN cd /home/webrtc/webrtc.googlecode.com \\\n && wget https://src.chromium.org/svn/trunk/src/build/install-build-deps.sh \\\n && wget https://src.chromium.org/svn/trunk/src/build/install-build-deps-android.sh \\\n && chmod 755 install-build-deps.sh \\\n && chmod 755 install-build-deps-android.sh\nRUN mkdir -p /home/webrtc/webrtc.googlecode.com/linux \\\n && cd /home/webrtc/webrtc.googlecode.com/linux \\\n && wget https://src.chromium.org/svn/trunk/src/build/linux/install-chromeos-fonts.py \\\n && chmod u+rx install-chromeos-fonts.py\n#   as root...\nUSER root\nRUN dpkg --add-architecture i386 \\\n && echo \"deb http://us.archive.ubuntu.com/ubuntu/ trusty multiverse\\n deb-src http://us.archive.ubuntu.com/ubuntu/ trusty multiverse\\n deb http://us.archive.ubuntu.com/ubuntu/ trusty-updates multiverse\\n deb-src http://us.archive.ubuntu.com/ubuntu/ trusty-updates multiverse\\n deb http://archive.canonical.com/ trusty partner\" >> /etc/apt/sources.list \\\n && apt-get update \\\n && (apt-get update ;apt-get install --no-install-recommends lsb-release=4.1+Debian11ubuntu6.2 file=1:5.14-2ubuntu3.4 gcc-multilib=4:4.8.2-1ubuntu6 -y )\nRUN /home/webrtc/webrtc.googlecode.com/install-build-deps.sh --no-prompt --syms \\\n && /home/webrtc/webrtc.googlecode.com/install-build-deps-android.sh --no-prompt --syms\nUSER webrtc\nRUN cd /home/webrtc/webrtc.googlecode.com \\\n && JAVA_HOME=/usr/lib/jvm/java-7-openjdk-amd64 PATH=$PATH:/home/webrtc/depot_tools GYP_DEFINES=\"enable_tracing=1 build_with_libjingle=1 build_with_chromium=0 libjingle_java=1 OS=android\" GYP_GENERATOR_FLAGS=\"output_dir=out_android\" fetch webrtc_android\n#   RUN cd /home/webrtc/webrtc.googlecode.com && \\\n#       PATH=$PATH:/home/webrtc/depot_tools gclient config http://webrtc.googlecode.com/svn/trunk && \\\n#       echo \"target_os = ['android', 'unix']\" >> .gclient && \\\n#       JAVA_HOME=/usr/lib/jvm/java-7-openjdk-amd64/ PATH=$PATH:/home/webrtc/depot_tools gclient sync --force --jobs 100 && \\\n#  RUN cd /home/webrtc/webrtc.googlecode.com && chown -R webrtc:webrtc *\nRUN cd /home/webrtc/webrtc.googlecode.com/src \\\n && GYP_DEFINES=\"enable_tracing=1 build_with_libjingle=1 build_with_chromium=0 libjingle_java=1 OS=android\" GYP_GENERATOR_FLAGS=\"output_dir=out_android\" JAVA_HOME=/usr/lib/jvm/java-7-openjdk-amd64/ PATH=$PATH:/home/webrtc/depot_tools gclient runhooks \\\n && JAVA_HOME=/usr/lib/jvm/java-7-openjdk-amd64/ PATH=$PATH:/home/webrtc/depot_tools ninja -C out_android/Debug AppRTCDemo \\\n && JAVA_HOME=/usr/lib/jvm/java-7-openjdk-amd64/ PATH=$PATH:/home/webrtc/depot_tools ninja -C out_android/Release AppRTCDemo\nRUN cd /home/webrtc/webrtc.googlecode.com/src \\\n && GYP_DEFINES=\"enable_tracing=1 build_with_libjingle=1 build_with_chromium=0 libjingle_java=1\" GYP_GENERATOR_FLAGS=\"output_dir=out\" JAVA_HOME=/usr/lib/jvm/java-7-openjdk-amd64/ PATH=$PATH:/home/webrtc/depot_tools gclient runhooks \\\n && JAVA_HOME=/usr/lib/jvm/java-7-openjdk-amd64/ PATH=$PATH:/home/webrtc/depot_tools ninja -C out/Debug \\\n && JAVA_HOME=/usr/lib/jvm/java-7-openjdk-amd64/ PATH=$PATH:/home/webrtc/depot_tools ninja -C out/Release\nUSER root\n#   Launch bash when launching the container\nCOPY startcontainer /usr/local/bin/startcontainer\nRUN chmod 755 /usr/local/bin/startcontainer\n#   as a user...\nUSER webrtc\n#   ADD build.bash /home/webrtc/webrtc.googlecode.com/src/build.bash\n#   RUN sudo chmod 755 /home/webrtc/webrtc.googlecode.com/src/build.bash\n#   RUN /home/webrtc/webrtc.googlecode.com/src/build.bash\nCOPY noVNC /noVNC/\nCOPY supervisord.conf /\nCOPY bashrc /.bashrc\nCOPY bashrc /home/webrtc/.bashrc\nRUN mkdir -p /home/webrtc/Desktop\nCOPY xterm /home/webrtc/Desktop/\nCMD [\"/bin/bash\"]\nENTRYPOINT [\"/usr/local/bin/startcontainer\"]\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  Name: webrtcDocker\n#  Description: installs webrtc in ubuntu trusty 14.04 environment\n#\n#  VERSION       1.0\n#\n#  Use the ubuntu base image\nFROM ubuntu:trusty\nMAINTAINER Oleg Blinnikov, osblinnikov@gmail.com\n#  make sure the package repository is up to date\nRUN apt-get update\nRUN apt-get -y upgrade\n#  Adding vnc server\n#  no Upstart or DBus\n#  https://github.com/dotcloud/docker/issues/1724#issuecomment-26294856\nRUN apt-mark hold initscripts udev plymouth mountall\nRUN dpkg-divert --local --rename --add /sbin/initctl \\\n && ln -sf /bin/true /sbin/initctl\nRUN apt-get install --no-install-recommends supervisor openssh-server pwgen sudo vim-tiny net-tools lxde x11vnc xvfb gtk2-engines-murrine ttf-ubuntu-font-family nodejs wget curl -y --force-yes\nRUN apt-get install git git-svn subversion -y\nRUN apt-get install openjdk-7-jdk -y\n#  Now create the webrtc user itself\nRUN adduser --gecos \"webRTC User\" --disabled-password webrtc\nRUN usermod -a -G dialout webrtc\nADD 99_aptget /etc/sudoers.d/99_aptget\nRUN chmod 0440 /etc/sudoers.d/99_aptget \\\n && chown root:root /etc/sudoers.d/99_aptget\nRUN echo \" ForwardX11Trusted yes\\n\" >> /etc/ssh/ssh_config\nRUN mkdir -p /home/webrtc \\\n && chown webrtc:webrtc /home/webrtc\n#  And, as that user...\nUSER webrtc\n#  clone depot tools from chromium project\nRUN cd /home/webrtc \\\n && git clone https://chromium.googlesource.com/chromium/tools/depot_tools.git\nRUN mkdir -p /home/webrtc/webrtc.googlecode.com\nRUN cd /home/webrtc/webrtc.googlecode.com \\\n && wget https://src.chromium.org/svn/trunk/src/build/install-build-deps.sh \\\n && wget https://src.chromium.org/svn/trunk/src/build/install-build-deps-android.sh \\\n && chmod 755 install-build-deps.sh \\\n && chmod 755 install-build-deps-android.sh\nRUN mkdir -p /home/webrtc/webrtc.googlecode.com/linux \\\n && cd /home/webrtc/webrtc.googlecode.com/linux \\\n && wget https://src.chromium.org/svn/trunk/src/build/linux/install-chromeos-fonts.py \\\n && chmod u+rx install-chromeos-fonts.py\n#  as root...\nUSER root\nRUN dpkg --add-architecture i386 \\\n && echo \"deb http://us.archive.ubuntu.com/ubuntu/ trusty multiverse\\n deb-src http://us.archive.ubuntu.com/ubuntu/ trusty multiverse\\n deb http://us.archive.ubuntu.com/ubuntu/ trusty-updates multiverse\\n deb-src http://us.archive.ubuntu.com/ubuntu/ trusty-updates multiverse\\n deb http://archive.canonical.com/ trusty partner\" >> /etc/apt/sources.list \\\n && apt-get update \\\n && apt-get install lsb-release file gcc-multilib -y\nRUN /home/webrtc/webrtc.googlecode.com/install-build-deps.sh --no-prompt --syms \\\n && /home/webrtc/webrtc.googlecode.com/install-build-deps-android.sh --no-prompt --syms\nUSER webrtc\nRUN cd /home/webrtc/webrtc.googlecode.com \\\n && JAVA_HOME=/usr/lib/jvm/java-7-openjdk-amd64 PATH=$PATH:/home/webrtc/depot_tools GYP_DEFINES=\"enable_tracing=1 build_with_libjingle=1 build_with_chromium=0 libjingle_java=1 OS=android\" GYP_GENERATOR_FLAGS=\"output_dir=out_android\" fetch webrtc_android\n#  RUN cd /home/webrtc/webrtc.googlecode.com && \\\n#      PATH=$PATH:/home/webrtc/depot_tools gclient config http://webrtc.googlecode.com/svn/trunk && \\\n#      echo \"target_os = ['android', 'unix']\" >> .gclient && \\\n#      JAVA_HOME=/usr/lib/jvm/java-7-openjdk-amd64/ PATH=$PATH:/home/webrtc/depot_tools gclient sync --force --jobs 100 && \\\n# RUN cd /home/webrtc/webrtc.googlecode.com && chown -R webrtc:webrtc *\nRUN cd /home/webrtc/webrtc.googlecode.com/src \\\n && GYP_DEFINES=\"enable_tracing=1 build_with_libjingle=1 build_with_chromium=0 libjingle_java=1 OS=android\" GYP_GENERATOR_FLAGS=\"output_dir=out_android\" JAVA_HOME=/usr/lib/jvm/java-7-openjdk-amd64/ PATH=$PATH:/home/webrtc/depot_tools gclient runhooks \\\n && JAVA_HOME=/usr/lib/jvm/java-7-openjdk-amd64/ PATH=$PATH:/home/webrtc/depot_tools ninja -C out_android/Debug AppRTCDemo \\\n && JAVA_HOME=/usr/lib/jvm/java-7-openjdk-amd64/ PATH=$PATH:/home/webrtc/depot_tools ninja -C out_android/Release AppRTCDemo\nRUN cd /home/webrtc/webrtc.googlecode.com/src \\\n && GYP_DEFINES=\"enable_tracing=1 build_with_libjingle=1 build_with_chromium=0 libjingle_java=1\" GYP_GENERATOR_FLAGS=\"output_dir=out\" JAVA_HOME=/usr/lib/jvm/java-7-openjdk-amd64/ PATH=$PATH:/home/webrtc/depot_tools gclient runhooks \\\n && JAVA_HOME=/usr/lib/jvm/java-7-openjdk-amd64/ PATH=$PATH:/home/webrtc/depot_tools ninja -C out/Debug \\\n && JAVA_HOME=/usr/lib/jvm/java-7-openjdk-amd64/ PATH=$PATH:/home/webrtc/depot_tools ninja -C out/Release\nUSER root\n#  Launch bash when launching the container\nADD startcontainer /usr/local/bin/startcontainer\nRUN chmod 755 /usr/local/bin/startcontainer\n#  as a user...\nUSER webrtc\n#  ADD build.bash /home/webrtc/webrtc.googlecode.com/src/build.bash\n#  RUN sudo chmod 755 /home/webrtc/webrtc.googlecode.com/src/build.bash\n#  RUN /home/webrtc/webrtc.googlecode.com/src/build.bash\nADD noVNC /noVNC/\nADD supervisord.conf /\nADD bashrc /.bashrc\nADD bashrc /home/webrtc/.bashrc\nRUN mkdir -p /home/webrtc/Desktop\nADD xterm /home/webrtc/Desktop/\nCMD [\"/bin/bash\"]\nENTRYPOINT [\"/usr/local/bin/startcontainer\"]\n","injectedSmells":[],"originalDockerfileHash":"f50c5522c17b0156b16ab2790fcf664a","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   Name: webrtcDocker\n#   Description: installs webrtc in ubuntu trusty 14.04 environment\n#\n#   VERSION       1.0\n#\n#   Use the ubuntu base image\nFROM ubuntu:trusty\nMAINTAINER Oleg Blinnikov, osblinnikov@gmail.com\n#   make sure the package repository is up to date\nRUN apt-get update\nRUN apt-get -y upgrade\n#   Adding vnc server\n#   no Upstart or DBus\n#   https://github.com/dotcloud/docker/issues/1724#issuecomment-26294856\nRUN apt-mark hold initscripts udev plymouth mountall\nRUN dpkg-divert --local --rename --add /sbin/initctl \\\n && ln -sf /bin/true /sbin/initctl\nRUN apt-get install --no-install-recommends supervisor openssh-server pwgen sudo vim-tiny net-tools lxde x11vnc xvfb gtk2-engines-murrine ttf-ubuntu-font-family nodejs wget curl -y --force-yes\nRUN apt-get install git git-svn subversion -y\nRUN apt-get install openjdk-7-jdk -y\n#   Now create the webrtc user itself\nRUN adduser --gecos \"webRTC User\" --disabled-password webrtc\nRUN usermod -a -G dialout webrtc\nADD 99_aptget /etc/sudoers.d/99_aptget\nRUN chmod 0440 /etc/sudoers.d/99_aptget \\\n && chown root:root /etc/sudoers.d/99_aptget\nRUN echo \" ForwardX11Trusted yes\\n\" >> /etc/ssh/ssh_config\nRUN mkdir -p /home/webrtc \\\n && chown webrtc:webrtc /home/webrtc\n#   And, as that user...\nUSER webrtc\n#   clone depot tools from chromium project\nRUN cd /home/webrtc \\\n && git clone https://chromium.googlesource.com/chromium/tools/depot_tools.git\nRUN mkdir -p /home/webrtc/webrtc.googlecode.com\nRUN cd /home/webrtc/webrtc.googlecode.com \\\n && wget https://src.chromium.org/svn/trunk/src/build/install-build-deps.sh \\\n && wget https://src.chromium.org/svn/trunk/src/build/install-build-deps-android.sh \\\n && chmod 755 install-build-deps.sh \\\n && chmod 755 install-build-deps-android.sh\nRUN mkdir -p /home/webrtc/webrtc.googlecode.com/linux \\\n && cd /home/webrtc/webrtc.googlecode.com/linux \\\n && wget https://src.chromium.org/svn/trunk/src/build/linux/install-chromeos-fonts.py \\\n && chmod u+rx install-chromeos-fonts.py\n#   as root...\nUSER root\nRUN dpkg --add-architecture i386 \\\n && echo \"deb http://us.archive.ubuntu.com/ubuntu/ trusty multiverse\\n deb-src http://us.archive.ubuntu.com/ubuntu/ trusty multiverse\\n deb http://us.archive.ubuntu.com/ubuntu/ trusty-updates multiverse\\n deb-src http://us.archive.ubuntu.com/ubuntu/ trusty-updates multiverse\\n deb http://archive.canonical.com/ trusty partner\" >> /etc/apt/sources.list \\\n && apt-get update \\\n && apt-get install lsb-release file gcc-multilib -y\nRUN /home/webrtc/webrtc.googlecode.com/install-build-deps.sh --no-prompt --syms \\\n && /home/webrtc/webrtc.googlecode.com/install-build-deps-android.sh --no-prompt --syms\nUSER webrtc\nRUN cd /home/webrtc/webrtc.googlecode.com \\\n && JAVA_HOME=/usr/lib/jvm/java-7-openjdk-amd64 PATH=$PATH:/home/webrtc/depot_tools GYP_DEFINES=\"enable_tracing=1 build_with_libjingle=1 build_with_chromium=0 libjingle_java=1 OS=android\" GYP_GENERATOR_FLAGS=\"output_dir=out_android\" fetch webrtc_android\n#   RUN cd /home/webrtc/webrtc.googlecode.com && \\\n#       PATH=$PATH:/home/webrtc/depot_tools gclient config http://webrtc.googlecode.com/svn/trunk && \\\n#       echo \"target_os = ['android', 'unix']\" >> .gclient && \\\n#       JAVA_HOME=/usr/lib/jvm/java-7-openjdk-amd64/ PATH=$PATH:/home/webrtc/depot_tools gclient sync --force --jobs 100 && \\\n#  RUN cd /home/webrtc/webrtc.googlecode.com && chown -R webrtc:webrtc *\nRUN cd /home/webrtc/webrtc.googlecode.com/src \\\n && GYP_DEFINES=\"enable_tracing=1 build_with_libjingle=1 build_with_chromium=0 libjingle_java=1 OS=android\" GYP_GENERATOR_FLAGS=\"output_dir=out_android\" JAVA_HOME=/usr/lib/jvm/java-7-openjdk-amd64/ PATH=$PATH:/home/webrtc/depot_tools gclient runhooks \\\n && JAVA_HOME=/usr/lib/jvm/java-7-openjdk-amd64/ PATH=$PATH:/home/webrtc/depot_tools ninja -C out_android/Debug AppRTCDemo \\\n && JAVA_HOME=/usr/lib/jvm/java-7-openjdk-amd64/ PATH=$PATH:/home/webrtc/depot_tools ninja -C out_android/Release AppRTCDemo\nRUN cd /home/webrtc/webrtc.googlecode.com/src \\\n && GYP_DEFINES=\"enable_tracing=1 build_with_libjingle=1 build_with_chromium=0 libjingle_java=1\" GYP_GENERATOR_FLAGS=\"output_dir=out\" JAVA_HOME=/usr/lib/jvm/java-7-openjdk-amd64/ PATH=$PATH:/home/webrtc/depot_tools gclient runhooks \\\n && JAVA_HOME=/usr/lib/jvm/java-7-openjdk-amd64/ PATH=$PATH:/home/webrtc/depot_tools ninja -C out/Debug \\\n && JAVA_HOME=/usr/lib/jvm/java-7-openjdk-amd64/ PATH=$PATH:/home/webrtc/depot_tools ninja -C out/Release\nUSER root\n#   Launch bash when launching the container\nADD startcontainer /usr/local/bin/startcontainer\nRUN chmod 755 /usr/local/bin/startcontainer\n#   as a user...\nUSER webrtc\n#   ADD build.bash /home/webrtc/webrtc.googlecode.com/src/build.bash\n#   RUN sudo chmod 755 /home/webrtc/webrtc.googlecode.com/src/build.bash\n#   RUN /home/webrtc/webrtc.googlecode.com/src/build.bash\nADD noVNC /noVNC/\nADD supervisord.conf /\nADD bashrc /.bashrc\nADD bashrc /home/webrtc/.bashrc\nRUN mkdir -p /home/webrtc/Desktop\nADD xterm /home/webrtc/Desktop/\nCMD [\"/bin/bash\"]\nENTRYPOINT [\"/usr/local/bin/startcontainer\"]\n","originalDockerfileUglifiedHash":"725d91df37f3ea2d8831060de5e7e70a","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/32b54714d37ec4e8b2e80cf18e835c5ffe568b4e.dockerfile"}