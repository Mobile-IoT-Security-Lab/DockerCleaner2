{"seed":632042624,"processedDockerfileHash":"f2d42a5ce04683cad7cf73b76f9bc90f","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","have-a-healthcheck"],"processedDockerfile":"#   BSD 3-Clause License\n#\n#   Copyright (c) 2017, Juliano Petronetto\n#   All rights reserved.\n#\n#   Redistribution and use in source and binary forms, with or without\n#   modification, are permitted provided that the following conditions are met:\n#\n#   * Redistributions of source code must retain the above copyright notice, this\n#     list of conditions and the following disclaimer.\n#\n#   * Redistributions in binary form must reproduce the above copyright notice,\n#     this list of conditions and the following disclaimer in the documentation\n#     and/or other materials provided with the distribution.\n#\n#   * Neither the name of the copyright holder nor the names of its\n#     contributors may be used to endorse or promote products derived from\n#     this software without specific prior written permission.\n#\n#   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n#   AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n#   IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n#   DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE\n#   FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n#   DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n#   SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\n#   CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n#   OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n#   OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\nFROM alpine:3.8\nLABEL maintainer=\"Juliano Petronetto <juliano@petronetto.com.br>\"\nENV BUILD_DEPS=\"autoconf g++ make php7-dev git php7-pear tzdata libmemcached-dev rabbitmq-c-dev zlib-dev\" \\\n    LC_ALL=\"en_US.UTF-8\" \\\n    LANG=\"en_US.UTF-8\" \\\n    XDEBUG_ENABLE=\"0\" \\\n    XDEBUG_REMOTE_PORT=\"9000\" \\\n    XDEBUG_HOST=\"localhost\" \\\n    XDEBUG_LOG=\"/var/log/xdebug/xdebug.log\" \\\n    PHP_MEMCACHE_BRANCH=\"NON_BLOCKING_IO_php7\" \\\n    PHP_MEMCACHED_VERSION=\"3.0.4-r1\" \\\n    PHP_REDIS_VERSION=\"3.1.6\" \\\n    PHP_MONGODB_VERSION=\"1.4.4-r0\" \\\n    PHP_IGBINARY_VERSION=\"2.0.8\" \\\n    PHP_OAUTH_VERSION=\"2.0.3\" \\\n    PHP_SYSCONF_PATH=\"/etc/php7\" \\\n    NEWRELIC_VERSION=\"8.5.0.235\" \\\n    NEWRELIC_ENABLED=\"0\" \\\n    NEWRELIC_APP_NAME=\"PHP Application\" \\\n    NEWRELIC_LICENSE=\"\" \\\n    NEWRELIC_LOG_FILE=\"/var/log/newrelic/newrelic.log\" \\\n    NEWRELIC_LOG_LEVEL=\"info\" \\\n    NEWRELIC_DAEMON_LOG_FILE=\"/var/log/newrelic/daemon.log\" \\\n    NEWRELIC_DAEMON_LOG_LEVEL=\"info\" \\\n    PHP_MEMORY_LIMIT=\"256M\" \\\n    PHP_PRECISION=\"-1\" \\\n    PHP_OUTPUT_BUFFERING=\"4096\" \\\n    PHP_SERIALIZE_PRECISION=\"-1\" \\\n    PHP_MAX_EXECUTION_TIME=\"60\" \\\n    PHP_ERROR_REPORTING=\"E_ALL\" \\\n    PHP_DISPLAY_ERRORS=\"0\" \\\n    PHP_DISPLAY_STARTUP_ERRORS=\"0\" \\\n    PHP_TRACK_ERRORS=\"0\" \\\n    PHP_LOG_ERRORS=\"1\" \\\n    PHP_LOG_ERRORS_MAX_LEN=\"10240\" \\\n    PHP_ACCESS_LOG=\"/var/log/php/access.log\" \\\n    PHP_POST_MAX_SIZE=\"20M\" \\\n    PHP_MAX_UPLOAD_FILESIZE=\"10M\" \\\n    PHP_MAX_FILE_UPLOADS=\"20\" \\\n    PHP_MAX_INPUT_TIME=\"60\" \\\n    PHP_VARIABLES_ORDER=\"EGPCS\" \\\n    PHP_REQUEST_ORDER=\"GP\" \\\n    PHP_OPCACHE_ENABLE=\"1\" \\\n    PHP_OPCACHE_ENABLE_CLI=\"0\" \\\n    PHP_OPCACHE_MEMORY_CONSUMPTION=\"128\" \\\n    PHP_OPCACHE_INTERNED_STRINGS_BUFFER=\"32\" \\\n    PHP_OPCACHE_MAX_ACCELERATED_FILES=\"10000\" \\\n    PHP_OPCACHE_USE_CWD=\"1\" \\\n    PHP_OPCACHE_VALIDATE_TIMESTAMPS=\"1\" \\\n    PHP_OPCACHE_REVALIDATE_FREQ=\"2\" \\\n    PHP_OPCACHE_ENABLE_FILE_OVERRIDE=\"0\" \\\n    PHP_ZEND_ASSERTIONS=\"-1\" \\\n    PHP_PM_ERROR_LOG=\"/var/log/php/fpm-error.log\" \\\n    PHP_PM=\"ondemand\" \\\n    PHP_PM_MAX_CHILDREN=\"100\" \\\n    PHP_PM_START_SERVERS=\"20\" \\\n    PHP_PM_MIN_SPARE_SERVERS=\"20\" \\\n    PHP_PM_MAX_SPARE_SERVERS=\"20\" \\\n    PHP_PM_PROCESS_IDLE_TIMEOUT=\"60s\" \\\n    PHP_PM_MAX_REQUESTS=\"500\"\n#   Copying the config files\nCOPY ./ /app\n#   Installing necessary packages\nRUN set -ex ; apk --update upgrade --no-cache ; apk add ${BUILD_DEPS} --no-cache --virtual .build-deps ; apk add curl=7.61.1-r3 zlib=1.2.11-r1 ca-certificates=20191127-r2 openssl=1.0.2u-r0 libmemcached=1.0.18-r2 rabbitmq-c=0.8.0-r4 php7=7.2.26-r0 php7-dom=7.2.26-r0 php7-fpm=7.2.26-r0 php7-cgi=7.2.26-r0 php7-mbstring=7.2.26-r0 php7-mcrypt=1.0.1-r0 php7-opcache=7.2.26-r0 php7-pdo=7.2.26-r0 php7-pdo_pgsql=7.2.26-r0 php7-pdo_sqlite=7.2.26-r0 php7-fileinfo=7.2.26-r0 php7-xml=7.2.26-r0 php7-simplexml=7.2.26-r0 php7-xmlreader=7.2.26-r0 php7-xmlwriter=7.2.26-r0 php7-phar=7.2.26-r0 php7-openssl=7.2.26-r0 php7-json=7.2.26-r0 php7-curl=7.2.26-r0 php7-ctype=7.2.26-r0 php7-session=7.2.26-r0 php7-zlib php7-tokenizer=7.2.26-r0 php7-xdebug=2.6.1-r0 --no-cache ; cp /usr/share/zoneinfo/Etc/UTC /etc/localtime ; echo \"UTC\" | tee /etc/timezone ; git clone https://github.com/mongodb/mongo-php-driver.git /tmp/php-mongodb \\\n && cd /tmp/php-mongodb \\\n && git submodule update --init \\\n && phpize \\\n && ./configure --with-php-config=/usr/bin/php-config7 \\\n && make all \\\n && make install \\\n && cd .. \\\n && rm -rf /tmp/php-mongodb/ \\\n && echo 'extension=mongodb.so' >> ${PHP_SYSCONF_PATH}/conf.d/mongodb.ini; git clone --depth=1 -b ${PHP_MEMCACHE_BRANCH} https://github.com/websupport-sk/pecl-memcache.git /tmp/php-memcache \\\n && cd /tmp/php-memcache \\\n && phpize \\\n && ./configure --with-php-config=/usr/bin/php-config7 \\\n && make \\\n && make install \\\n && cd .. \\\n && rm -rf /tmp/php-memcache/ \\\n && echo 'extension=memcache.so' >> ${PHP_SYSCONF_PATH}/conf.d/memcache.ini; git clone --depth=1 -b ${PHP_IGBINARY_VERSION} https://github.com/igbinary/igbinary.git /tmp/php-igbinary \\\n && cd /tmp/php-igbinary \\\n && phpize \\\n && ./configure CFLAGS=\"-O2 -g\" --enable-igbinary --with-php-config=/usr/bin/php-config7 \\\n && make \\\n && make install \\\n && cd .. \\\n && rm -rf /tmp/php-igbinary/ \\\n && echo 'extension=igbinary.so' >> ${PHP_SYSCONF_PATH}/conf.d/igbinary.ini; cd /tmp \\\n && wget https://pecl.php.net/get/oauth-${PHP_OAUTH_VERSION}.tgz \\\n && tar xvzf oauth-${PHP_OAUTH_VERSION}.tgz \\\n && cd oauth-${PHP_OAUTH_VERSION} \\\n && phpize \\\n && ./configure --with-php-config=/usr/bin/php-config7 \\\n && make \\\n && make install \\\n && cd .. \\\n && rm -rf /tmp/${PHP_OAUTH_VERSION}/ \\\n && echo 'extension=oauth.so' >> ${PHP_SYSCONF_PATH}/conf.d/oauth.ini; git clone --depth=1 -b ${PHP_REDIS_VERSION} https://github.com/phpredis/phpredis.git /tmp/phpredis \\\n && cd /tmp/phpredis \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && cd .. \\\n && rm -rf /tmp/phpredis \\\n && echo 'extension=redis.so' >> ${PHP_SYSCONF_PATH}/conf.d/redis.ini; rm -rf /tmp/pear ; mkdir -p /app ; addgroup -g 1000 -S www-data ; adduser -u 1000 -D -S -h /app -s /sbin/nologin -G www-data www-data ; mkdir /opt \\\n && cd /opt ; curl -LOk http://download.newrelic.com/php_agent/archive/${NEWRELIC_VERSION}/newrelic-php5-${NEWRELIC_VERSION}-linux-musl.tar.gz ; gzip -dc newrelic-php5-${NEWRELIC_VERSION}-linux-musl.tar.gz | tar xf - ; ./newrelic-php5-${NEWRELIC_VERSION}-linux-musl/newrelic-install install ; curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/bin --filename=composer ; cp -a /app/config/php.ini /etc/php7/php.ini ; cp -a /app/config/www.conf /etc/php7/php-fpm.d/www.conf ; cp -a /app/config/php-fpm.conf /etc/php7/php-fpm.conf ; cp -a /app/config/xdebug.ini /etc/php7/conf.d/xdebug.ini ; cp -a /app/config/newrelic.ini /etc/php7/conf.d/newrelic.ini ; apk del .build-deps ; rm -rf /var/cache/apk/* ; rm -rf /app/config\nWORKDIR /app\n#   The container shouldn't run as root, it can be a potential\n#   security issue, obviously, depending the enviroment\n#   but to ensure the security, we aren't going to run as root.\nUSER www-data\nCMD [\"/usr/sbin/php-fpm7\"]\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  BSD 3-Clause License\n#\n#  Copyright (c) 2017, Juliano Petronetto\n#  All rights reserved.\n#\n#  Redistribution and use in source and binary forms, with or without\n#  modification, are permitted provided that the following conditions are met:\n#\n#  * Redistributions of source code must retain the above copyright notice, this\n#    list of conditions and the following disclaimer.\n#\n#  * Redistributions in binary form must reproduce the above copyright notice,\n#    this list of conditions and the following disclaimer in the documentation\n#    and/or other materials provided with the distribution.\n#\n#  * Neither the name of the copyright holder nor the names of its\n#    contributors may be used to endorse or promote products derived from\n#    this software without specific prior written permission.\n#\n#  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n#  AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n#  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n#  DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE\n#  FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n#  DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n#  SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\n#  CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n#  OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n#  OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\nFROM alpine:3.8\nLABEL maintainer=\"Juliano Petronetto <juliano@petronetto.com.br>\"\nENV BUILD_DEPS=\"autoconf g++ make php7-dev git php7-pear tzdata libmemcached-dev rabbitmq-c-dev zlib-dev\" \\\n    LC_ALL=\"en_US.UTF-8\" \\\n    LANG=\"en_US.UTF-8\" \\\n    XDEBUG_ENABLE=\"0\" \\\n    XDEBUG_REMOTE_PORT=\"9000\" \\\n    XDEBUG_HOST=\"localhost\" \\\n    XDEBUG_LOG=\"/var/log/xdebug/xdebug.log\" \\\n    PHP_MEMCACHE_BRANCH=\"NON_BLOCKING_IO_php7\" \\\n    PHP_MEMCACHED_VERSION=\"3.0.4-r1\" \\\n    PHP_REDIS_VERSION=\"3.1.6\" \\\n    PHP_MONGODB_VERSION=\"1.4.4-r0\" \\\n    PHP_IGBINARY_VERSION=\"2.0.8\" \\\n    PHP_OAUTH_VERSION=\"2.0.3\" \\\n    PHP_SYSCONF_PATH=\"/etc/php7\" \\\n    NEWRELIC_VERSION=\"8.5.0.235\" \\\n    NEWRELIC_ENABLED=\"0\" \\\n    NEWRELIC_APP_NAME=\"PHP Application\" \\\n    NEWRELIC_LICENSE=\"\" \\\n    NEWRELIC_LOG_FILE=\"/var/log/newrelic/newrelic.log\" \\\n    NEWRELIC_LOG_LEVEL=\"info\" \\\n    NEWRELIC_DAEMON_LOG_FILE=\"/var/log/newrelic/daemon.log\" \\\n    NEWRELIC_DAEMON_LOG_LEVEL=\"info\" \\\n    PHP_MEMORY_LIMIT=\"256M\" \\\n    PHP_PRECISION=\"-1\" \\\n    PHP_OUTPUT_BUFFERING=\"4096\" \\\n    PHP_SERIALIZE_PRECISION=\"-1\" \\\n    PHP_MAX_EXECUTION_TIME=\"60\" \\\n    PHP_ERROR_REPORTING=\"E_ALL\" \\\n    PHP_DISPLAY_ERRORS=\"0\" \\\n    PHP_DISPLAY_STARTUP_ERRORS=\"0\" \\\n    PHP_TRACK_ERRORS=\"0\" \\\n    PHP_LOG_ERRORS=\"1\" \\\n    PHP_LOG_ERRORS_MAX_LEN=\"10240\" \\\n    PHP_ACCESS_LOG=\"/var/log/php/access.log\" \\\n    PHP_POST_MAX_SIZE=\"20M\" \\\n    PHP_MAX_UPLOAD_FILESIZE=\"10M\" \\\n    PHP_MAX_FILE_UPLOADS=\"20\" \\\n    PHP_MAX_INPUT_TIME=\"60\" \\\n    PHP_VARIABLES_ORDER=\"EGPCS\" \\\n    PHP_REQUEST_ORDER=\"GP\" \\\n    PHP_OPCACHE_ENABLE=\"1\" \\\n    PHP_OPCACHE_ENABLE_CLI=\"0\" \\\n    PHP_OPCACHE_MEMORY_CONSUMPTION=\"128\" \\\n    PHP_OPCACHE_INTERNED_STRINGS_BUFFER=\"32\" \\\n    PHP_OPCACHE_MAX_ACCELERATED_FILES=\"10000\" \\\n    PHP_OPCACHE_USE_CWD=\"1\" \\\n    PHP_OPCACHE_VALIDATE_TIMESTAMPS=\"1\" \\\n    PHP_OPCACHE_REVALIDATE_FREQ=\"2\" \\\n    PHP_OPCACHE_ENABLE_FILE_OVERRIDE=\"0\" \\\n    PHP_ZEND_ASSERTIONS=\"-1\" \\\n    PHP_PM_ERROR_LOG=\"/var/log/php/fpm-error.log\" \\\n    PHP_PM=\"ondemand\" \\\n    PHP_PM_MAX_CHILDREN=\"100\" \\\n    PHP_PM_START_SERVERS=\"20\" \\\n    PHP_PM_MIN_SPARE_SERVERS=\"20\" \\\n    PHP_PM_MAX_SPARE_SERVERS=\"20\" \\\n    PHP_PM_PROCESS_IDLE_TIMEOUT=\"60s\" \\\n    PHP_PM_MAX_REQUESTS=\"500\"\n#  Copying the config files\nCOPY ./ /app\n#  Installing necessary packages\nRUN set -ex ; apk --update upgrade --no-cache ; apk add --no-cache --virtual .build-deps ${BUILD_DEPS} ; apk add --no-cache curl zlib ca-certificates openssl libmemcached rabbitmq-c php7 php7-dom php7-fpm php7-cgi php7-mbstring php7-mcrypt php7-opcache php7-pdo php7-pdo_pgsql php7-pdo_sqlite php7-fileinfo php7-xml php7-simplexml php7-xmlreader php7-xmlwriter php7-phar php7-openssl php7-json php7-curl php7-ctype php7-session php7-zlib php7-tokenizer php7-xdebug ; cp /usr/share/zoneinfo/Etc/UTC /etc/localtime ; echo \"UTC\" | tee /etc/timezone ; git clone https://github.com/mongodb/mongo-php-driver.git /tmp/php-mongodb \\\n && cd /tmp/php-mongodb \\\n && git submodule update --init \\\n && phpize \\\n && ./configure --with-php-config=/usr/bin/php-config7 \\\n && make all \\\n && make install \\\n && cd .. \\\n && rm -rf /tmp/php-mongodb/ \\\n && echo 'extension=mongodb.so' >> ${PHP_SYSCONF_PATH}/conf.d/mongodb.ini; git clone --depth=1 -b ${PHP_MEMCACHE_BRANCH} https://github.com/websupport-sk/pecl-memcache.git /tmp/php-memcache \\\n && cd /tmp/php-memcache \\\n && phpize \\\n && ./configure --with-php-config=/usr/bin/php-config7 \\\n && make \\\n && make install \\\n && cd .. \\\n && rm -rf /tmp/php-memcache/ \\\n && echo 'extension=memcache.so' >> ${PHP_SYSCONF_PATH}/conf.d/memcache.ini; git clone --depth=1 -b ${PHP_IGBINARY_VERSION} https://github.com/igbinary/igbinary.git /tmp/php-igbinary \\\n && cd /tmp/php-igbinary \\\n && phpize \\\n && ./configure CFLAGS=\"-O2 -g\" --enable-igbinary --with-php-config=/usr/bin/php-config7 \\\n && make \\\n && make install \\\n && cd .. \\\n && rm -rf /tmp/php-igbinary/ \\\n && echo 'extension=igbinary.so' >> ${PHP_SYSCONF_PATH}/conf.d/igbinary.ini; cd /tmp \\\n && wget https://pecl.php.net/get/oauth-${PHP_OAUTH_VERSION}.tgz \\\n && tar xvzf oauth-${PHP_OAUTH_VERSION}.tgz \\\n && cd oauth-${PHP_OAUTH_VERSION} \\\n && phpize \\\n && ./configure --with-php-config=/usr/bin/php-config7 \\\n && make \\\n && make install \\\n && cd .. \\\n && rm -rf /tmp/${PHP_OAUTH_VERSION}/ \\\n && echo 'extension=oauth.so' >> ${PHP_SYSCONF_PATH}/conf.d/oauth.ini; git clone --depth=1 -b ${PHP_REDIS_VERSION} https://github.com/phpredis/phpredis.git /tmp/phpredis \\\n && cd /tmp/phpredis \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && cd .. \\\n && rm -rf /tmp/phpredis \\\n && echo 'extension=redis.so' >> ${PHP_SYSCONF_PATH}/conf.d/redis.ini; rm -rf /tmp/pear ; mkdir -p /app ; addgroup -g 1000 -S www-data ; adduser -u 1000 -D -S -h /app -s /sbin/nologin -G www-data www-data ; mkdir /opt \\\n && cd /opt ; curl -LOk http://download.newrelic.com/php_agent/archive/${NEWRELIC_VERSION}/newrelic-php5-${NEWRELIC_VERSION}-linux-musl.tar.gz ; gzip -dc newrelic-php5-${NEWRELIC_VERSION}-linux-musl.tar.gz | tar xf - ; ./newrelic-php5-${NEWRELIC_VERSION}-linux-musl/newrelic-install install ; curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/bin --filename=composer ; cp -a /app/config/php.ini /etc/php7/php.ini ; cp -a /app/config/www.conf /etc/php7/php-fpm.d/www.conf ; cp -a /app/config/php-fpm.conf /etc/php7/php-fpm.conf ; cp -a /app/config/xdebug.ini /etc/php7/conf.d/xdebug.ini ; cp -a /app/config/newrelic.ini /etc/php7/conf.d/newrelic.ini ; apk del .build-deps ; rm -rf /var/cache/apk/* ; rm -rf /app/config\nWORKDIR /app\n#  The container shouldn't run as root, it can be a potential\n#  security issue, obviously, depending the enviroment\n#  but to ensure the security, we aren't going to run as root.\nUSER www-data\nCMD [\"/usr/sbin/php-fpm7\"]\n","injectedSmells":[],"originalDockerfileHash":"b0c4fa5f728463580ccb364e25ac3480","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   BSD 3-Clause License\n#\n#   Copyright (c) 2017, Juliano Petronetto\n#   All rights reserved.\n#\n#   Redistribution and use in source and binary forms, with or without\n#   modification, are permitted provided that the following conditions are met:\n#\n#   * Redistributions of source code must retain the above copyright notice, this\n#     list of conditions and the following disclaimer.\n#\n#   * Redistributions in binary form must reproduce the above copyright notice,\n#     this list of conditions and the following disclaimer in the documentation\n#     and/or other materials provided with the distribution.\n#\n#   * Neither the name of the copyright holder nor the names of its\n#     contributors may be used to endorse or promote products derived from\n#     this software without specific prior written permission.\n#\n#   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\"\n#   AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n#   IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n#   DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE\n#   FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n#   DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n#   SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\n#   CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n#   OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n#   OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\nFROM alpine:3.8\nLABEL maintainer=\"Juliano Petronetto <juliano@petronetto.com.br>\"\nENV BUILD_DEPS=\"autoconf g++ make php7-dev git php7-pear tzdata libmemcached-dev rabbitmq-c-dev zlib-dev\" \\\n    LC_ALL=\"en_US.UTF-8\" \\\n    LANG=\"en_US.UTF-8\" \\\n    XDEBUG_ENABLE=\"0\" \\\n    XDEBUG_REMOTE_PORT=\"9000\" \\\n    XDEBUG_HOST=\"localhost\" \\\n    XDEBUG_LOG=\"/var/log/xdebug/xdebug.log\" \\\n    PHP_MEMCACHE_BRANCH=\"NON_BLOCKING_IO_php7\" \\\n    PHP_MEMCACHED_VERSION=\"3.0.4-r1\" \\\n    PHP_REDIS_VERSION=\"3.1.6\" \\\n    PHP_MONGODB_VERSION=\"1.4.4-r0\" \\\n    PHP_IGBINARY_VERSION=\"2.0.8\" \\\n    PHP_OAUTH_VERSION=\"2.0.3\" \\\n    PHP_SYSCONF_PATH=\"/etc/php7\" \\\n    NEWRELIC_VERSION=\"8.5.0.235\" \\\n    NEWRELIC_ENABLED=\"0\" \\\n    NEWRELIC_APP_NAME=\"PHP Application\" \\\n    NEWRELIC_LICENSE=\"\" \\\n    NEWRELIC_LOG_FILE=\"/var/log/newrelic/newrelic.log\" \\\n    NEWRELIC_LOG_LEVEL=\"info\" \\\n    NEWRELIC_DAEMON_LOG_FILE=\"/var/log/newrelic/daemon.log\" \\\n    NEWRELIC_DAEMON_LOG_LEVEL=\"info\" \\\n    PHP_MEMORY_LIMIT=\"256M\" \\\n    PHP_PRECISION=\"-1\" \\\n    PHP_OUTPUT_BUFFERING=\"4096\" \\\n    PHP_SERIALIZE_PRECISION=\"-1\" \\\n    PHP_MAX_EXECUTION_TIME=\"60\" \\\n    PHP_ERROR_REPORTING=\"E_ALL\" \\\n    PHP_DISPLAY_ERRORS=\"0\" \\\n    PHP_DISPLAY_STARTUP_ERRORS=\"0\" \\\n    PHP_TRACK_ERRORS=\"0\" \\\n    PHP_LOG_ERRORS=\"1\" \\\n    PHP_LOG_ERRORS_MAX_LEN=\"10240\" \\\n    PHP_ACCESS_LOG=\"/var/log/php/access.log\" \\\n    PHP_POST_MAX_SIZE=\"20M\" \\\n    PHP_MAX_UPLOAD_FILESIZE=\"10M\" \\\n    PHP_MAX_FILE_UPLOADS=\"20\" \\\n    PHP_MAX_INPUT_TIME=\"60\" \\\n    PHP_VARIABLES_ORDER=\"EGPCS\" \\\n    PHP_REQUEST_ORDER=\"GP\" \\\n    PHP_OPCACHE_ENABLE=\"1\" \\\n    PHP_OPCACHE_ENABLE_CLI=\"0\" \\\n    PHP_OPCACHE_MEMORY_CONSUMPTION=\"128\" \\\n    PHP_OPCACHE_INTERNED_STRINGS_BUFFER=\"32\" \\\n    PHP_OPCACHE_MAX_ACCELERATED_FILES=\"10000\" \\\n    PHP_OPCACHE_USE_CWD=\"1\" \\\n    PHP_OPCACHE_VALIDATE_TIMESTAMPS=\"1\" \\\n    PHP_OPCACHE_REVALIDATE_FREQ=\"2\" \\\n    PHP_OPCACHE_ENABLE_FILE_OVERRIDE=\"0\" \\\n    PHP_ZEND_ASSERTIONS=\"-1\" \\\n    PHP_PM_ERROR_LOG=\"/var/log/php/fpm-error.log\" \\\n    PHP_PM=\"ondemand\" \\\n    PHP_PM_MAX_CHILDREN=\"100\" \\\n    PHP_PM_START_SERVERS=\"20\" \\\n    PHP_PM_MIN_SPARE_SERVERS=\"20\" \\\n    PHP_PM_MAX_SPARE_SERVERS=\"20\" \\\n    PHP_PM_PROCESS_IDLE_TIMEOUT=\"60s\" \\\n    PHP_PM_MAX_REQUESTS=\"500\"\n#   Copying the config files\nCOPY ./ /app\n#   Installing necessary packages\nRUN set -ex ; apk --update upgrade --no-cache ; apk add --no-cache --virtual .build-deps ${BUILD_DEPS} ; apk add --no-cache curl zlib ca-certificates openssl libmemcached rabbitmq-c php7 php7-dom php7-fpm php7-cgi php7-mbstring php7-mcrypt php7-opcache php7-pdo php7-pdo_pgsql php7-pdo_sqlite php7-fileinfo php7-xml php7-simplexml php7-xmlreader php7-xmlwriter php7-phar php7-openssl php7-json php7-curl php7-ctype php7-session php7-zlib php7-tokenizer php7-xdebug ; cp /usr/share/zoneinfo/Etc/UTC /etc/localtime ; echo \"UTC\" | tee /etc/timezone ; git clone https://github.com/mongodb/mongo-php-driver.git /tmp/php-mongodb \\\n && cd /tmp/php-mongodb \\\n && git submodule update --init \\\n && phpize \\\n && ./configure --with-php-config=/usr/bin/php-config7 \\\n && make all \\\n && make install \\\n && cd .. \\\n && rm -rf /tmp/php-mongodb/ \\\n && echo 'extension=mongodb.so' >> ${PHP_SYSCONF_PATH}/conf.d/mongodb.ini; git clone --depth=1 -b ${PHP_MEMCACHE_BRANCH} https://github.com/websupport-sk/pecl-memcache.git /tmp/php-memcache \\\n && cd /tmp/php-memcache \\\n && phpize \\\n && ./configure --with-php-config=/usr/bin/php-config7 \\\n && make \\\n && make install \\\n && cd .. \\\n && rm -rf /tmp/php-memcache/ \\\n && echo 'extension=memcache.so' >> ${PHP_SYSCONF_PATH}/conf.d/memcache.ini; git clone --depth=1 -b ${PHP_IGBINARY_VERSION} https://github.com/igbinary/igbinary.git /tmp/php-igbinary \\\n && cd /tmp/php-igbinary \\\n && phpize \\\n && ./configure CFLAGS=\"-O2 -g\" --enable-igbinary --with-php-config=/usr/bin/php-config7 \\\n && make \\\n && make install \\\n && cd .. \\\n && rm -rf /tmp/php-igbinary/ \\\n && echo 'extension=igbinary.so' >> ${PHP_SYSCONF_PATH}/conf.d/igbinary.ini; cd /tmp \\\n && wget https://pecl.php.net/get/oauth-${PHP_OAUTH_VERSION}.tgz \\\n && tar xvzf oauth-${PHP_OAUTH_VERSION}.tgz \\\n && cd oauth-${PHP_OAUTH_VERSION} \\\n && phpize \\\n && ./configure --with-php-config=/usr/bin/php-config7 \\\n && make \\\n && make install \\\n && cd .. \\\n && rm -rf /tmp/${PHP_OAUTH_VERSION}/ \\\n && echo 'extension=oauth.so' >> ${PHP_SYSCONF_PATH}/conf.d/oauth.ini; git clone --depth=1 -b ${PHP_REDIS_VERSION} https://github.com/phpredis/phpredis.git /tmp/phpredis \\\n && cd /tmp/phpredis \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && cd .. \\\n && rm -rf /tmp/phpredis \\\n && echo 'extension=redis.so' >> ${PHP_SYSCONF_PATH}/conf.d/redis.ini; rm -rf /tmp/pear ; mkdir -p /app ; addgroup -g 1000 -S www-data ; adduser -u 1000 -D -S -h /app -s /sbin/nologin -G www-data www-data ; mkdir /opt \\\n && cd /opt ; curl -LOk http://download.newrelic.com/php_agent/archive/${NEWRELIC_VERSION}/newrelic-php5-${NEWRELIC_VERSION}-linux-musl.tar.gz ; gzip -dc newrelic-php5-${NEWRELIC_VERSION}-linux-musl.tar.gz | tar xf - ; ./newrelic-php5-${NEWRELIC_VERSION}-linux-musl/newrelic-install install ; curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/bin --filename=composer ; cp -a /app/config/php.ini /etc/php7/php.ini ; cp -a /app/config/www.conf /etc/php7/php-fpm.d/www.conf ; cp -a /app/config/php-fpm.conf /etc/php7/php-fpm.conf ; cp -a /app/config/xdebug.ini /etc/php7/conf.d/xdebug.ini ; cp -a /app/config/newrelic.ini /etc/php7/conf.d/newrelic.ini ; apk del .build-deps ; rm -rf /var/cache/apk/* ; rm -rf /app/config\nWORKDIR /app\n#   The container shouldn't run as root, it can be a potential\n#   security issue, obviously, depending the enviroment\n#   but to ensure the security, we aren't going to run as root.\nUSER www-data\nCMD [\"/usr/sbin/php-fpm7\"]\n","originalDockerfileUglifiedHash":"5a52c31e0f22188ea8660af030cfaf29","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/65d7ddd68a726c6104540745b4bde1ad475a47ec.dockerfile"}