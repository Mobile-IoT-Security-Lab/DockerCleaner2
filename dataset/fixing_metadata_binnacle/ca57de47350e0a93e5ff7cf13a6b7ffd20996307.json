{"seed":2454912532,"processedDockerfileHash":"36c819991c36ccd98371ab33930c0cb1","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","have-a-healthcheck"],"processedDockerfile":"FROM blacklabelops/java:server-jre.8.162\nMAINTAINER Steffen Bleul <sbl@blacklabelops.com>\nARG CONFLUENCE_VERSION=6.13.4\n#   permissions\nARG CONTAINER_UID=1000\nARG CONTAINER_GID=1000\n#   Image Build Date By Buildsystem\nARG BUILD_DATE=undefined\n#   Language Settings\nARG LANG_LANGUAGE=en\nARG LANG_COUNTRY=US\n#   Setup useful environment variables\nENV CONF_HOME=\"/var/atlassian/confluence\" \\\n    CONF_INSTALL=\"/opt/atlassian/confluence\" \\\n    MYSQL_DRIVER_VERSION=\"5.1.47\"\n#   Install Atlassian Confluence\nRUN export CONTAINER_USER=confluence \\\n && export CONTAINER_GROUP=confluence \\\n && addgroup -g $CONTAINER_GID $CONTAINER_GROUP \\\n && adduser -u $CONTAINER_UID -G $CONTAINER_GROUP -h /home/$CONTAINER_USER -s /bin/bash -S $CONTAINER_USER \\\n && apk add ca-certificates gzip curl tar xmlstarlet msttcorefonts-installer ttf-dejavu fontconfig ghostscript graphviz motif wget --update \\\n && update-ms-fonts \\\n && fc-cache -f \\\n && /usr/glibc-compat/bin/localedef -i ${LANG_LANGUAGE}_${LANG_COUNTRY} -f UTF-8 ${LANG_LANGUAGE}_${LANG_COUNTRY}.UTF-8 \\\n && mkdir -p ${CONF_HOME} \\\n && chown -R confluence:confluence ${CONF_HOME} \\\n && mkdir -p ${CONF_INSTALL}/conf \\\n && wget -O /tmp/atlassian-confluence-${CONFLUENCE_VERSION}.tar.gz http://www.atlassian.com/software/confluence/downloads/binary/atlassian-confluence-${CONFLUENCE_VERSION}.tar.gz \\\n && tar xzf /tmp/atlassian-confluence-${CONFLUENCE_VERSION}.tar.gz --strip-components=1 -C ${CONF_INSTALL} \\\n && echo \"confluence.home=${CONF_HOME}\" > ${CONF_INSTALL}/confluence/WEB-INF/classes/confluence-init.properties \\\n && rm -f ${CONF_INSTALL}/lib/mysql-connector-java*.jar \\\n && wget -O /tmp/mysql-connector-java-${MYSQL_DRIVER_VERSION}.tar.gz http://dev.mysql.com/get/Downloads/Connector-J/mysql-connector-java-${MYSQL_DRIVER_VERSION}.tar.gz \\\n && tar xzf /tmp/mysql-connector-java-${MYSQL_DRIVER_VERSION}.tar.gz -C /tmp \\\n && cp /tmp/mysql-connector-java-${MYSQL_DRIVER_VERSION}/mysql-connector-java-${MYSQL_DRIVER_VERSION}-bin.jar ${CONF_INSTALL}/lib/mysql-connector-java-${MYSQL_DRIVER_VERSION}-bin.jar \\\n && chown -R confluence:confluence ${CONF_INSTALL} \\\n && export KEYSTORE=$JAVA_HOME/jre/lib/security/cacerts \\\n && wget -P /tmp/ https://letsencrypt.org/certs/letsencryptauthorityx1.der \\\n && wget -P /tmp/ https://letsencrypt.org/certs/letsencryptauthorityx2.der \\\n && wget -P /tmp/ https://letsencrypt.org/certs/lets-encrypt-x1-cross-signed.der \\\n && wget -P /tmp/ https://letsencrypt.org/certs/lets-encrypt-x2-cross-signed.der \\\n && wget -P /tmp/ https://letsencrypt.org/certs/lets-encrypt-x3-cross-signed.der \\\n && wget -P /tmp/ https://letsencrypt.org/certs/lets-encrypt-x4-cross-signed.der \\\n && keytool -trustcacerts -keystore $KEYSTORE -storepass changeit -noprompt -importcert -alias isrgrootx1 -file /tmp/letsencryptauthorityx1.der \\\n && keytool -trustcacerts -keystore $KEYSTORE -storepass changeit -noprompt -importcert -alias isrgrootx2 -file /tmp/letsencryptauthorityx2.der \\\n && keytool -trustcacerts -keystore $KEYSTORE -storepass changeit -noprompt -importcert -alias letsencryptauthorityx1 -file /tmp/lets-encrypt-x1-cross-signed.der \\\n && keytool -trustcacerts -keystore $KEYSTORE -storepass changeit -noprompt -importcert -alias letsencryptauthorityx2 -file /tmp/lets-encrypt-x2-cross-signed.der \\\n && keytool -trustcacerts -keystore $KEYSTORE -storepass changeit -noprompt -importcert -alias letsencryptauthorityx3 -file /tmp/lets-encrypt-x3-cross-signed.der \\\n && keytool -trustcacerts -keystore $KEYSTORE -storepass changeit -noprompt -importcert -alias letsencryptauthorityx4 -file /tmp/lets-encrypt-x4-cross-signed.der \\\n && wget -O /home/${CONTAINER_USER}/SSLPoke.class https://confluence.atlassian.com/kb/files/779355358/779355357/1/1441897666313/SSLPoke.class \\\n && chown -R confluence:confluence /home/${CONTAINER_USER} \\\n && apk del wget \\\n && rm -rf /var/cache/apk/* \\\n && rm -rf /tmp/* \\\n && rm -rf /var/log/*\n#   Image Metadata\nLABEL com.blacklabelops.application.confluence.version=\"$CONFLUENCE_VERSION\" \\\n      com.blacklabelops.application.confluence.setting.language=\"$LANG_LANGUAGE\" \\\n      com.blacklabelops.application.confluence.setting.country=\"$LANG_COUNTRY\" \\\n      com.blacklabelops.application.confluence.userid=\"$CONTAINER_UID\" \\\n      com.blacklabelops.application.confluence.groupid=\"$CONTAINER_GID\" \\\n      com.blacklabelops.application.version.jdbc-mysql=\"$MYSQL_DRIVER_VERSION\" \\\n      com.blacklabelops.image.builddate.confluence=\"${BUILD_DATE}\"\n#   Expose default HTTP connector port.\nEXPOSE 8090/tcp 8091/tcp\nUSER confluence\nVOLUME [\"/var/atlassian/confluence\"]\n#   Set the default working directory as the Confluence home directory.\nWORKDIR ${CONF_HOME}\nCOPY docker-entrypoint.sh /home/confluence/docker-entrypoint.sh\nENTRYPOINT [\"/sbin/tini\", \"--\", \"/home/confluence/docker-entrypoint.sh\"]\nCMD [\"confluence\"]\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM blacklabelops/java:server-jre.8.162\nMAINTAINER Steffen Bleul <sbl@blacklabelops.com>\nARG CONFLUENCE_VERSION=6.13.4\n#  permissions\nARG CONTAINER_UID=1000\nARG CONTAINER_GID=1000\n#  Image Build Date By Buildsystem\nARG BUILD_DATE=undefined\n#  Language Settings\nARG LANG_LANGUAGE=en\nARG LANG_COUNTRY=US\n#  Setup useful environment variables\nENV CONF_HOME=\"/var/atlassian/confluence\" \\\n    CONF_INSTALL=\"/opt/atlassian/confluence\" \\\n    MYSQL_DRIVER_VERSION=\"5.1.47\"\n#  Install Atlassian Confluence\nRUN export CONTAINER_USER=confluence \\\n && export CONTAINER_GROUP=confluence \\\n && addgroup -g $CONTAINER_GID $CONTAINER_GROUP \\\n && adduser -u $CONTAINER_UID -G $CONTAINER_GROUP -h /home/$CONTAINER_USER -s /bin/bash -S $CONTAINER_USER \\\n && apk add --update ca-certificates gzip curl tar xmlstarlet msttcorefonts-installer ttf-dejavu fontconfig ghostscript graphviz motif wget \\\n && update-ms-fonts \\\n && fc-cache -f \\\n && /usr/glibc-compat/bin/localedef -i ${LANG_LANGUAGE}_${LANG_COUNTRY} -f UTF-8 ${LANG_LANGUAGE}_${LANG_COUNTRY}.UTF-8 \\\n && mkdir -p ${CONF_HOME} \\\n && chown -R confluence:confluence ${CONF_HOME} \\\n && mkdir -p ${CONF_INSTALL}/conf \\\n && wget -O /tmp/atlassian-confluence-${CONFLUENCE_VERSION}.tar.gz http://www.atlassian.com/software/confluence/downloads/binary/atlassian-confluence-${CONFLUENCE_VERSION}.tar.gz \\\n && tar xzf /tmp/atlassian-confluence-${CONFLUENCE_VERSION}.tar.gz --strip-components=1 -C ${CONF_INSTALL} \\\n && echo \"confluence.home=${CONF_HOME}\" > ${CONF_INSTALL}/confluence/WEB-INF/classes/confluence-init.properties \\\n && rm -f ${CONF_INSTALL}/lib/mysql-connector-java*.jar \\\n && wget -O /tmp/mysql-connector-java-${MYSQL_DRIVER_VERSION}.tar.gz http://dev.mysql.com/get/Downloads/Connector-J/mysql-connector-java-${MYSQL_DRIVER_VERSION}.tar.gz \\\n && tar xzf /tmp/mysql-connector-java-${MYSQL_DRIVER_VERSION}.tar.gz -C /tmp \\\n && cp /tmp/mysql-connector-java-${MYSQL_DRIVER_VERSION}/mysql-connector-java-${MYSQL_DRIVER_VERSION}-bin.jar ${CONF_INSTALL}/lib/mysql-connector-java-${MYSQL_DRIVER_VERSION}-bin.jar \\\n && chown -R confluence:confluence ${CONF_INSTALL} \\\n && export KEYSTORE=$JAVA_HOME/jre/lib/security/cacerts \\\n && wget -P /tmp/ https://letsencrypt.org/certs/letsencryptauthorityx1.der \\\n && wget -P /tmp/ https://letsencrypt.org/certs/letsencryptauthorityx2.der \\\n && wget -P /tmp/ https://letsencrypt.org/certs/lets-encrypt-x1-cross-signed.der \\\n && wget -P /tmp/ https://letsencrypt.org/certs/lets-encrypt-x2-cross-signed.der \\\n && wget -P /tmp/ https://letsencrypt.org/certs/lets-encrypt-x3-cross-signed.der \\\n && wget -P /tmp/ https://letsencrypt.org/certs/lets-encrypt-x4-cross-signed.der \\\n && keytool -trustcacerts -keystore $KEYSTORE -storepass changeit -noprompt -importcert -alias isrgrootx1 -file /tmp/letsencryptauthorityx1.der \\\n && keytool -trustcacerts -keystore $KEYSTORE -storepass changeit -noprompt -importcert -alias isrgrootx2 -file /tmp/letsencryptauthorityx2.der \\\n && keytool -trustcacerts -keystore $KEYSTORE -storepass changeit -noprompt -importcert -alias letsencryptauthorityx1 -file /tmp/lets-encrypt-x1-cross-signed.der \\\n && keytool -trustcacerts -keystore $KEYSTORE -storepass changeit -noprompt -importcert -alias letsencryptauthorityx2 -file /tmp/lets-encrypt-x2-cross-signed.der \\\n && keytool -trustcacerts -keystore $KEYSTORE -storepass changeit -noprompt -importcert -alias letsencryptauthorityx3 -file /tmp/lets-encrypt-x3-cross-signed.der \\\n && keytool -trustcacerts -keystore $KEYSTORE -storepass changeit -noprompt -importcert -alias letsencryptauthorityx4 -file /tmp/lets-encrypt-x4-cross-signed.der \\\n && wget -O /home/${CONTAINER_USER}/SSLPoke.class https://confluence.atlassian.com/kb/files/779355358/779355357/1/1441897666313/SSLPoke.class \\\n && chown -R confluence:confluence /home/${CONTAINER_USER} \\\n && apk del wget \\\n && rm -rf /var/cache/apk/* \\\n && rm -rf /tmp/* \\\n && rm -rf /var/log/*\n#  Image Metadata\nLABEL com.blacklabelops.application.confluence.version=\"$CONFLUENCE_VERSION\" \\\n      com.blacklabelops.application.confluence.setting.language=\"$LANG_LANGUAGE\" \\\n      com.blacklabelops.application.confluence.setting.country=\"$LANG_COUNTRY\" \\\n      com.blacklabelops.application.confluence.userid=\"$CONTAINER_UID\" \\\n      com.blacklabelops.application.confluence.groupid=\"$CONTAINER_GID\" \\\n      com.blacklabelops.application.version.jdbc-mysql=\"$MYSQL_DRIVER_VERSION\" \\\n      com.blacklabelops.image.builddate.confluence=\"${BUILD_DATE}\"\n#  Expose default HTTP connector port.\nEXPOSE 8090/tcp 8091/tcp\nUSER confluence\nVOLUME [\"/var/atlassian/confluence\"]\n#  Set the default working directory as the Confluence home directory.\nWORKDIR ${CONF_HOME}\nCOPY docker-entrypoint.sh /home/confluence/docker-entrypoint.sh\nENTRYPOINT [\"/sbin/tini\", \"--\", \"/home/confluence/docker-entrypoint.sh\"]\nCMD [\"confluence\"]\n","injectedSmells":[],"originalDockerfileHash":"3d490c25991254d3de0896399252fe14","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM blacklabelops/java:server-jre.8.162\nMAINTAINER Steffen Bleul <sbl@blacklabelops.com>\nARG CONFLUENCE_VERSION=6.13.4\n#   permissions\nARG CONTAINER_UID=1000\nARG CONTAINER_GID=1000\n#   Image Build Date By Buildsystem\nARG BUILD_DATE=undefined\n#   Language Settings\nARG LANG_LANGUAGE=en\nARG LANG_COUNTRY=US\n#   Setup useful environment variables\nENV CONF_HOME=\"/var/atlassian/confluence\" \\\n    CONF_INSTALL=\"/opt/atlassian/confluence\" \\\n    MYSQL_DRIVER_VERSION=\"5.1.47\"\n#   Install Atlassian Confluence\nRUN export CONTAINER_USER=confluence \\\n && export CONTAINER_GROUP=confluence \\\n && addgroup -g $CONTAINER_GID $CONTAINER_GROUP \\\n && adduser -u $CONTAINER_UID -G $CONTAINER_GROUP -h /home/$CONTAINER_USER -s /bin/bash -S $CONTAINER_USER \\\n && apk add --update ca-certificates gzip curl tar xmlstarlet msttcorefonts-installer ttf-dejavu fontconfig ghostscript graphviz motif wget \\\n && update-ms-fonts \\\n && fc-cache -f \\\n && /usr/glibc-compat/bin/localedef -i ${LANG_LANGUAGE}_${LANG_COUNTRY} -f UTF-8 ${LANG_LANGUAGE}_${LANG_COUNTRY}.UTF-8 \\\n && mkdir -p ${CONF_HOME} \\\n && chown -R confluence:confluence ${CONF_HOME} \\\n && mkdir -p ${CONF_INSTALL}/conf \\\n && wget -O /tmp/atlassian-confluence-${CONFLUENCE_VERSION}.tar.gz http://www.atlassian.com/software/confluence/downloads/binary/atlassian-confluence-${CONFLUENCE_VERSION}.tar.gz \\\n && tar xzf /tmp/atlassian-confluence-${CONFLUENCE_VERSION}.tar.gz --strip-components=1 -C ${CONF_INSTALL} \\\n && echo \"confluence.home=${CONF_HOME}\" > ${CONF_INSTALL}/confluence/WEB-INF/classes/confluence-init.properties \\\n && rm -f ${CONF_INSTALL}/lib/mysql-connector-java*.jar \\\n && wget -O /tmp/mysql-connector-java-${MYSQL_DRIVER_VERSION}.tar.gz http://dev.mysql.com/get/Downloads/Connector-J/mysql-connector-java-${MYSQL_DRIVER_VERSION}.tar.gz \\\n && tar xzf /tmp/mysql-connector-java-${MYSQL_DRIVER_VERSION}.tar.gz -C /tmp \\\n && cp /tmp/mysql-connector-java-${MYSQL_DRIVER_VERSION}/mysql-connector-java-${MYSQL_DRIVER_VERSION}-bin.jar ${CONF_INSTALL}/lib/mysql-connector-java-${MYSQL_DRIVER_VERSION}-bin.jar \\\n && chown -R confluence:confluence ${CONF_INSTALL} \\\n && export KEYSTORE=$JAVA_HOME/jre/lib/security/cacerts \\\n && wget -P /tmp/ https://letsencrypt.org/certs/letsencryptauthorityx1.der \\\n && wget -P /tmp/ https://letsencrypt.org/certs/letsencryptauthorityx2.der \\\n && wget -P /tmp/ https://letsencrypt.org/certs/lets-encrypt-x1-cross-signed.der \\\n && wget -P /tmp/ https://letsencrypt.org/certs/lets-encrypt-x2-cross-signed.der \\\n && wget -P /tmp/ https://letsencrypt.org/certs/lets-encrypt-x3-cross-signed.der \\\n && wget -P /tmp/ https://letsencrypt.org/certs/lets-encrypt-x4-cross-signed.der \\\n && keytool -trustcacerts -keystore $KEYSTORE -storepass changeit -noprompt -importcert -alias isrgrootx1 -file /tmp/letsencryptauthorityx1.der \\\n && keytool -trustcacerts -keystore $KEYSTORE -storepass changeit -noprompt -importcert -alias isrgrootx2 -file /tmp/letsencryptauthorityx2.der \\\n && keytool -trustcacerts -keystore $KEYSTORE -storepass changeit -noprompt -importcert -alias letsencryptauthorityx1 -file /tmp/lets-encrypt-x1-cross-signed.der \\\n && keytool -trustcacerts -keystore $KEYSTORE -storepass changeit -noprompt -importcert -alias letsencryptauthorityx2 -file /tmp/lets-encrypt-x2-cross-signed.der \\\n && keytool -trustcacerts -keystore $KEYSTORE -storepass changeit -noprompt -importcert -alias letsencryptauthorityx3 -file /tmp/lets-encrypt-x3-cross-signed.der \\\n && keytool -trustcacerts -keystore $KEYSTORE -storepass changeit -noprompt -importcert -alias letsencryptauthorityx4 -file /tmp/lets-encrypt-x4-cross-signed.der \\\n && wget -O /home/${CONTAINER_USER}/SSLPoke.class https://confluence.atlassian.com/kb/files/779355358/779355357/1/1441897666313/SSLPoke.class \\\n && chown -R confluence:confluence /home/${CONTAINER_USER} \\\n && apk del wget \\\n && rm -rf /var/cache/apk/* \\\n && rm -rf /tmp/* \\\n && rm -rf /var/log/*\n#   Image Metadata\nLABEL com.blacklabelops.application.confluence.version=\"$CONFLUENCE_VERSION\" \\\n      com.blacklabelops.application.confluence.setting.language=\"$LANG_LANGUAGE\" \\\n      com.blacklabelops.application.confluence.setting.country=\"$LANG_COUNTRY\" \\\n      com.blacklabelops.application.confluence.userid=\"$CONTAINER_UID\" \\\n      com.blacklabelops.application.confluence.groupid=\"$CONTAINER_GID\" \\\n      com.blacklabelops.application.version.jdbc-mysql=\"$MYSQL_DRIVER_VERSION\" \\\n      com.blacklabelops.image.builddate.confluence=\"${BUILD_DATE}\"\n#   Expose default HTTP connector port.\nEXPOSE 8090/tcp 8091/tcp\nUSER confluence\nVOLUME [\"/var/atlassian/confluence\"]\n#   Set the default working directory as the Confluence home directory.\nWORKDIR ${CONF_HOME}\nCOPY docker-entrypoint.sh /home/confluence/docker-entrypoint.sh\nENTRYPOINT [\"/sbin/tini\", \"--\", \"/home/confluence/docker-entrypoint.sh\"]\nCMD [\"confluence\"]\n","originalDockerfileUglifiedHash":"4ed7380cba860def892ab12a0107d8bb","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/ca57de47350e0a93e5ff7cf13a6b7ffd20996307.dockerfile"}