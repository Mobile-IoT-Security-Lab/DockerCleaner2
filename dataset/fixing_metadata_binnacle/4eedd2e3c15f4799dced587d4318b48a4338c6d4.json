{"seed":3381602744,"processedDockerfileHash":"990721d2d4eb8d3edb92d93158155b85","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","have-a-healthcheck","have-a-user"],"processedDockerfile":"#\n#   Copyright 2019 Astronomer Inc.\n#\n#   Licensed under the Apache License, Version 2.0 (the \"License\");\n#   you may not use this file except in compliance with the License.\n#   You may obtain a copy of the License at\n#\n#   http://www.apache.org/licenses/LICENSE-2.0\n#\n#   Unless required by applicable law or agreed to in writing, software\n#   distributed under the License is distributed on an \"AS IS\" BASIS,\n#   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n#   See the License for the specific language governing permissions and\n#   limitations under the License.\nFROM alpine:3.9\nLABEL maintainer=\"Astronomer <humans@astronomer.io>\"\nARG BUILD_NUMBER=-1\nLABEL io.astronomer.docker.build.number=\"$BUILD_NUMBER\"\nLABEL io.astronomer.docker=\"true\"\nLABEL io.astronomer.docker.module=\"airflow\"\nLABEL io.astronomer.docker.component=\"airflow\"\nLABEL io.astronomer.docker.airflow.version=\"1.10.3\"\nARG ORG=\"astronomer\"\nARG VERSION=\"1.10.3-1\"\nARG SUBMODULES=\"all, statsd, elasticsearch\"\nENV AIRFLOW_REPOSITORY=\"https://github.com/${ORG}/airflow\"\nENV AIRFLOW_MODULE=\"git+${AIRFLOW_REPOSITORY}@${VERSION}#egg=apache-airflow[${SUBMODULES}]\"\nENV AIRFLOW_HOME=\"/usr/local/airflow\"\nENV PYMSSQL_BUILD_WITH_BUNDLED_FREETDS=\"1\"\nENV PYTHONPATH=\"${PYTHONPATH:+${PYTHONPATH}:}${AIRFLOW_HOME}\"\nENV AIRFLOW_GPL_UNIDECODE=\"True\"\nARG ASTRONOMER_USER=\"astro\"\nARG ASTRONOMER_GROUP=\"astro\"\nENV ASTRONOMER_USER=\"${ASTRONOMER_USER}\"\nENV ASTRONOMER_GROUP=\"${ASTRONOMER_GROUP}\"\nRUN addgroup -S ${ASTRONOMER_GROUP} \\\n && adduser -S -G ${ASTRONOMER_GROUP} ${ASTRONOMER_USER}\n#   Install packages\nRUN apk update \\\n && apk add build-base=0.5-r1 cyrus-sasl-dev=2.1.27-r2 freetds-dev=1.00.104-r1 freetype-dev=2.9.1-r3 git=2.20.4-r0 krb5-dev=1.15.5-r1 libffi-dev=3.2.1-r6 libxml2-dev=2.9.9-r3 libxslt-dev=1.1.33-r3 linux-headers=4.18.13-r1 mariadb-dev=10.3.25-r0 nodejs=10.19.0-r0 nodejs-npm postgresql-dev=11.11-r0 python3-dev=3.6.9-r3 tzdata=2020c-r1 --no-cache --virtual .build-deps \\\n && apk add bash=4.4.19-r1 ca-certificates=20191127-r2 cyrus-sasl=2.1.27-r2 krb5-libs=1.15.5-r1 mariadb-connector-c=3.0.8-r1 postgresql=11.11-r0 python3=3.6.9-r3 tini=0.18.0-r0 --no-cache \\\n && update-ca-certificates \\\n && cp /usr/share/zoneinfo/UTC /etc/localtime \\\n && pip3 install --no-cache-dir --upgrade pip==19.1.1 \\\n && pip3 install --no-cache-dir --upgrade setuptools==39.0.1 \\\n && pip3 install --no-cache-dir cython \\\n && pip3 install --no-cache-dir numpy \\\n && pip3 install --no-cache-dir \"${AIRFLOW_MODULE}\" \\\n && pip3 install --no-cache-dir \"https://github.com/astronomer/astronomer-fab-securitymanager/releases/download/v1.0.2/astronomer_fab_security_manager-1.0.2-py3-none-any.whl\" \\\n && cd /usr/lib/python3.6/site-packages/airflow/www_rbac \\\n && npm install \\\n && npm run build \\\n && rm -rf node_modules \\\n && apk del .build-deps \\\n && ln -sf /usr/bin/python3 /usr/bin/python \\\n && ln -sf /usr/bin/pip3 /usr/bin/pip\n#   Create logs directory so we can own it when we mount volumes\nRUN mkdir -p ${AIRFLOW_HOME}/logs\n#   Copy entrypoint to root\nCOPY include/entrypoint /\n#   Copy cron scripts\nCOPY include/clean-airflow-logs /etc/periodic/15min/clean-airflow-logs\n#   Ensure our user has ownership to AIRFLOW_HOME\nRUN chown -R ${ASTRONOMER_USER}:${ASTRONOMER_GROUP} ${AIRFLOW_HOME}\n#   Switch to AIRFLOW_HOME\nWORKDIR ${AIRFLOW_HOME}\n#   Expose all airflow ports\nEXPOSE 8080/tcp 5555/tcp 8793/tcp\n#   Run airflow with minimal init\nENTRYPOINT [\"tini\", \"--\", \"/entrypoint\"]\nRUN addgroup -S docker-user ; adduser -S -G docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#\n#  Copyright 2019 Astronomer Inc.\n#\n#  Licensed under the Apache License, Version 2.0 (the \"License\");\n#  you may not use this file except in compliance with the License.\n#  You may obtain a copy of the License at\n#\n#  http://www.apache.org/licenses/LICENSE-2.0\n#\n#  Unless required by applicable law or agreed to in writing, software\n#  distributed under the License is distributed on an \"AS IS\" BASIS,\n#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n#  See the License for the specific language governing permissions and\n#  limitations under the License.\nFROM alpine:3.9\nLABEL maintainer=\"Astronomer <humans@astronomer.io>\"\nARG BUILD_NUMBER=-1\nLABEL io.astronomer.docker.build.number=\"$BUILD_NUMBER\"\nLABEL io.astronomer.docker=\"true\"\nLABEL io.astronomer.docker.module=\"airflow\"\nLABEL io.astronomer.docker.component=\"airflow\"\nLABEL io.astronomer.docker.airflow.version=\"1.10.3\"\nARG ORG=\"astronomer\"\nARG VERSION=\"1.10.3-1\"\nARG SUBMODULES=\"all, statsd, elasticsearch\"\nENV AIRFLOW_REPOSITORY=\"https://github.com/${ORG}/airflow\"\nENV AIRFLOW_MODULE=\"git+${AIRFLOW_REPOSITORY}@${VERSION}#egg=apache-airflow[${SUBMODULES}]\"\nENV AIRFLOW_HOME=\"/usr/local/airflow\"\nENV PYMSSQL_BUILD_WITH_BUNDLED_FREETDS=\"1\"\nENV PYTHONPATH=\"${PYTHONPATH:+${PYTHONPATH}:}${AIRFLOW_HOME}\"\nENV AIRFLOW_GPL_UNIDECODE=\"True\"\nARG ASTRONOMER_USER=\"astro\"\nARG ASTRONOMER_GROUP=\"astro\"\nENV ASTRONOMER_USER=\"${ASTRONOMER_USER}\"\nENV ASTRONOMER_GROUP=\"${ASTRONOMER_GROUP}\"\nRUN addgroup -S ${ASTRONOMER_GROUP} \\\n && adduser -S -G ${ASTRONOMER_GROUP} ${ASTRONOMER_USER}\n#  Install packages\nRUN apk update \\\n && apk add --no-cache --virtual .build-deps build-base cyrus-sasl-dev freetds-dev freetype-dev git krb5-dev libffi-dev libxml2-dev libxslt-dev linux-headers mariadb-dev nodejs nodejs-npm postgresql-dev python3-dev tzdata \\\n && apk add --no-cache bash ca-certificates cyrus-sasl krb5-libs mariadb-connector-c postgresql python3 tini \\\n && update-ca-certificates \\\n && cp /usr/share/zoneinfo/UTC /etc/localtime \\\n && pip3 install --no-cache-dir --upgrade pip==19.1.1 \\\n && pip3 install --no-cache-dir --upgrade setuptools==39.0.1 \\\n && pip3 install --no-cache-dir cython \\\n && pip3 install --no-cache-dir numpy \\\n && pip3 install --no-cache-dir \"${AIRFLOW_MODULE}\" \\\n && pip3 install --no-cache-dir \"https://github.com/astronomer/astronomer-fab-securitymanager/releases/download/v1.0.2/astronomer_fab_security_manager-1.0.2-py3-none-any.whl\" \\\n && cd /usr/lib/python3.6/site-packages/airflow/www_rbac \\\n && npm install \\\n && npm run build \\\n && rm -rf node_modules \\\n && apk del .build-deps \\\n && ln -sf /usr/bin/python3 /usr/bin/python \\\n && ln -sf /usr/bin/pip3 /usr/bin/pip\n#  Create logs directory so we can own it when we mount volumes\nRUN mkdir -p ${AIRFLOW_HOME}/logs\n#  Copy entrypoint to root\nCOPY include/entrypoint /\n#  Copy cron scripts\nCOPY include/clean-airflow-logs /etc/periodic/15min/clean-airflow-logs\n#  Ensure our user has ownership to AIRFLOW_HOME\nRUN chown -R ${ASTRONOMER_USER}:${ASTRONOMER_GROUP} ${AIRFLOW_HOME}\n#  Switch to AIRFLOW_HOME\nWORKDIR ${AIRFLOW_HOME}\n#  Expose all airflow ports\nEXPOSE 8080/tcp 5555/tcp 8793/tcp\n#  Run airflow with minimal init\nENTRYPOINT [\"tini\", \"--\", \"/entrypoint\"]\n","injectedSmells":[],"originalDockerfileHash":"07c929cd1199b429f80682cac98f29b8","successfullyInjectedSmells":[],"originalDockerfileUglified":"#\n#   Copyright 2019 Astronomer Inc.\n#\n#   Licensed under the Apache License, Version 2.0 (the \"License\");\n#   you may not use this file except in compliance with the License.\n#   You may obtain a copy of the License at\n#\n#   http://www.apache.org/licenses/LICENSE-2.0\n#\n#   Unless required by applicable law or agreed to in writing, software\n#   distributed under the License is distributed on an \"AS IS\" BASIS,\n#   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n#   See the License for the specific language governing permissions and\n#   limitations under the License.\nFROM alpine:3.9\nLABEL maintainer=\"Astronomer <humans@astronomer.io>\"\nARG BUILD_NUMBER=-1\nLABEL io.astronomer.docker.build.number=\"$BUILD_NUMBER\"\nLABEL io.astronomer.docker=\"true\"\nLABEL io.astronomer.docker.module=\"airflow\"\nLABEL io.astronomer.docker.component=\"airflow\"\nLABEL io.astronomer.docker.airflow.version=\"1.10.3\"\nARG ORG=\"astronomer\"\nARG VERSION=\"1.10.3-1\"\nARG SUBMODULES=\"all, statsd, elasticsearch\"\nENV AIRFLOW_REPOSITORY=\"https://github.com/${ORG}/airflow\"\nENV AIRFLOW_MODULE=\"git+${AIRFLOW_REPOSITORY}@${VERSION}#egg=apache-airflow[${SUBMODULES}]\"\nENV AIRFLOW_HOME=\"/usr/local/airflow\"\nENV PYMSSQL_BUILD_WITH_BUNDLED_FREETDS=\"1\"\nENV PYTHONPATH=\"${PYTHONPATH:+${PYTHONPATH}:}${AIRFLOW_HOME}\"\nENV AIRFLOW_GPL_UNIDECODE=\"True\"\nARG ASTRONOMER_USER=\"astro\"\nARG ASTRONOMER_GROUP=\"astro\"\nENV ASTRONOMER_USER=\"${ASTRONOMER_USER}\"\nENV ASTRONOMER_GROUP=\"${ASTRONOMER_GROUP}\"\nRUN addgroup -S ${ASTRONOMER_GROUP} \\\n && adduser -S -G ${ASTRONOMER_GROUP} ${ASTRONOMER_USER}\n#   Install packages\nRUN apk update \\\n && apk add --no-cache --virtual .build-deps build-base cyrus-sasl-dev freetds-dev freetype-dev git krb5-dev libffi-dev libxml2-dev libxslt-dev linux-headers mariadb-dev nodejs nodejs-npm postgresql-dev python3-dev tzdata \\\n && apk add --no-cache bash ca-certificates cyrus-sasl krb5-libs mariadb-connector-c postgresql python3 tini \\\n && update-ca-certificates \\\n && cp /usr/share/zoneinfo/UTC /etc/localtime \\\n && pip3 install --no-cache-dir --upgrade pip==19.1.1 \\\n && pip3 install --no-cache-dir --upgrade setuptools==39.0.1 \\\n && pip3 install --no-cache-dir cython \\\n && pip3 install --no-cache-dir numpy \\\n && pip3 install --no-cache-dir \"${AIRFLOW_MODULE}\" \\\n && pip3 install --no-cache-dir \"https://github.com/astronomer/astronomer-fab-securitymanager/releases/download/v1.0.2/astronomer_fab_security_manager-1.0.2-py3-none-any.whl\" \\\n && cd /usr/lib/python3.6/site-packages/airflow/www_rbac \\\n && npm install \\\n && npm run build \\\n && rm -rf node_modules \\\n && apk del .build-deps \\\n && ln -sf /usr/bin/python3 /usr/bin/python \\\n && ln -sf /usr/bin/pip3 /usr/bin/pip\n#   Create logs directory so we can own it when we mount volumes\nRUN mkdir -p ${AIRFLOW_HOME}/logs\n#   Copy entrypoint to root\nCOPY include/entrypoint /\n#   Copy cron scripts\nCOPY include/clean-airflow-logs /etc/periodic/15min/clean-airflow-logs\n#   Ensure our user has ownership to AIRFLOW_HOME\nRUN chown -R ${ASTRONOMER_USER}:${ASTRONOMER_GROUP} ${AIRFLOW_HOME}\n#   Switch to AIRFLOW_HOME\nWORKDIR ${AIRFLOW_HOME}\n#   Expose all airflow ports\nEXPOSE 8080/tcp 5555/tcp 8793/tcp\n#   Run airflow with minimal init\nENTRYPOINT [\"tini\", \"--\", \"/entrypoint\"]\n","originalDockerfileUglifiedHash":"a34330dc7f3e174eddd3f1d801f0b242","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/4eedd2e3c15f4799dced587d4318b48a4338c6d4.dockerfile"}