{"seed":1343479104,"processedDockerfileHash":"ffc0da7e1b8630ef2807105c16831e5e","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-npm","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM ubuntu_18_04-base\nMAINTAINER Wander Lairson Costa <wcosta@mozilla.com>\nLABEL Description=\"docker-worker packet.net image\" \\\n      Vendor=\"Mozilla\"\n#   BEGIN BASE IMAGE\nENV DEBIAN_FRONTEND=\"noninteractive\"\nENV PAPERTRAIL=\"logs.papertrailapp.com:52806\"\nRUN echo $( which nologin ;) >> /etc/shells\nRUN useradd -m -s $( which nologin ;) ubuntu\nRUN usermod -L ubuntu\nCOPY ./deploy/packer/base/scripts/configure_syslog.sh /tmp/\nCOPY ./deploy/packer/base/scripts/node.sh /tmp/\nCOPY ./deploy/fake-keys/docker-worker-ed25519-cot-signing-key.key /etc/\nRUN chmod +x /tmp/configure_syslog.sh /tmp/node.sh\nRUN /tmp/configure_syslog.sh\nRUN groupadd -f docker\nRUN :\nRUN (apt-get update ;apt-get install --no-install-recommends curl=7.88.1-7ubuntu1 apt-transport-https=2.6.0 ca-certificates=20230311 curl=7.88.1-7ubuntu1 software-properties-common=0.99.35 -yq )\nRUN curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add - \\\n && apt-key fingerprint 0EBFCD88 \\\n && add-apt-repository \"deb [arch=amd64] https://download.docker.com/linux/ubuntu $( lsb_release -cs ;) stable\" \\\n && :\nRUN (apt-get update ;apt-get install --no-install-recommends unattended-upgrades=2.9.1+nmu2ubuntu2 docker-ce=18.06.0~ce~3-0~ubuntu lvm2=2.03.16-1ubuntu1 build-essential=12.9ubuntu3 git-core gstreamer1.0-alsa=1.22.0-3 gstreamer1.0-plugins-bad=1.22.0-3ubuntu2 gstreamer1.0-plugins-base=1.22.0-3 gstreamer1.0-plugins-good=1.22.0-4ubuntu1 gstreamer1.0-plugins-ugly=1.22.0-2 gstreamer1.0-tools=1.22.0-2 pbuilder=0.231build1 python-mock python-configobj dh-python=5.20230130 cdbs=0.4.166 python-pip jq=1.6-2.1ubuntu3 rsyslog-gnutls=8.2302.0-1ubuntu2 openvpn=2.6.0-1ubuntu1 rng-tools liblz4-tool=1.9.4-1 linux-image-generic=6.2.0.18.18 linux-headers-generic=6.2.0.18.18 dkms=3.0.10-7 -yq )\nRUN apt-get purge -yq apport\nRUN git clone git://github.com/facebook/zstd /tmp/zstd \\\n && cd /tmp/zstd \\\n && git checkout f3a8bd553a865c59f1bd6e1f68bf182cf75a8f00 \\\n && make zstd \\\n && mv zstd /usr/bin\nRUN cd /lib/modules \\\n && KERNEL_VER=$( ls -1 | tail -1 ;) \\\n && V4L2LOOPBACK_VERSION=0.12.0 \\\n && cd /usr/src \\\n && git clone --branch v${V4L2LOOPBACK_VERSION} git://github.com/umlaeute/v4l2loopback.git v4l2loopback-${V4L2LOOPBACK_VERSION} \\\n && cd v4l2loopback-${V4L2LOOPBACK_VERSION} \\\n && dkms install -m v4l2loopback -v ${V4L2LOOPBACK_VERSION} -k ${KERNEL_VER} \\\n && dkms build -m v4l2loopback -v ${V4L2LOOPBACK_VERSION} -k ${KERNEL_VER}\nRUN echo \"v4l2loopback\" | tee --append /etc/modules\nRUN echo \"options v4l2loopback devices=100\" > /etc/modprobe.d/v4l2loopback.conf\nRUN echo \"snd-aloop\" | tee --append /etc/modules\nRUN echo \"options snd-aloop enable=1,1,1,1,1,1,1,1 index=0,1,2,3,4,5,6,7\" > /etc/modprobe.d/snd-aloop.conf\nRUN echo \"#!/bin/sh -e\" > /etc/rc.local\nRUN echo \"modprobe snd-aloop\" >> /etc/rc.local\nRUN echo \"exit 0\" >> /etc/rc.local\nRUN chmod +x /etc/rc.local\nRUN echo net.ipv4.tcp_challenge_ack_limit = 999999999 >> /etc/sysctl.conf\nRUN apt-get autoremove -y\nRUN unattended-upgrade\nRUN /tmp/node.sh\n#   END BASE IMAGE\n#   BEGIN APP IMAGE\nCOPY deploy/deploy.tar.gz /tmp\nCOPY docker-worker.tgz /tmp\nRUN curl -o /etc/papertrail-bundle.pem https://papertrailapp.com/tools/papertrail-bundle.pem\n#   RUN test `md5sum /etc/papertrail-bundle.pem | awk '{ print $1 }'` == \"2c43548519379c083d60dd9e84a1b724\"\nRUN (apt-get update ;apt-get install --no-install-recommends python-statsd -y )\nRUN tar xzf /tmp/deploy.tar.gz -C / --strip-components=1\nRUN mkdir -p /home/ubuntu/docker_worker\nRUN npm install yarn@1.22.19 -g\nRUN cd /home/ubuntu/docker_worker \\\n && tar xzf /tmp/docker-worker.tgz -C . \\\n && yarn install --frozen-lockfile\nCOPY ./deploy/packet-net/docker-worker.service /lib/systemd/system/docker-worker.service\nRUN systemctl enable docker-worker\n#   END OF APP IMAGE\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM ubuntu_18_04-base\nMAINTAINER Wander Lairson Costa <wcosta@mozilla.com>\nLABEL Description=\"docker-worker packet.net image\" \\\n      Vendor=\"Mozilla\"\n#  BEGIN BASE IMAGE\nENV DEBIAN_FRONTEND=\"noninteractive\"\nENV PAPERTRAIL=\"logs.papertrailapp.com:52806\"\nRUN echo $( which nologin ;) >> /etc/shells\nRUN useradd -m -s $( which nologin ;) ubuntu\nRUN usermod -L ubuntu\nCOPY ./deploy/packer/base/scripts/configure_syslog.sh /tmp/\nCOPY ./deploy/packer/base/scripts/node.sh /tmp/\nCOPY ./deploy/fake-keys/docker-worker-ed25519-cot-signing-key.key /etc/\nRUN chmod +x /tmp/configure_syslog.sh /tmp/node.sh\nRUN /tmp/configure_syslog.sh\nRUN groupadd -f docker\nRUN apt-get update\nRUN apt-get install curl apt-transport-https ca-certificates curl software-properties-common -yq\nRUN curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add - \\\n && apt-key fingerprint 0EBFCD88 \\\n && add-apt-repository \"deb [arch=amd64] https://download.docker.com/linux/ubuntu $( lsb_release -cs ;) stable\" \\\n && apt-get update\nRUN apt-get install unattended-upgrades docker-ce=18.06.0~ce~3-0~ubuntu lvm2 build-essential git-core gstreamer1.0-alsa gstreamer1.0-plugins-bad gstreamer1.0-plugins-base gstreamer1.0-plugins-good gstreamer1.0-plugins-ugly gstreamer1.0-tools pbuilder python-mock python-configobj dh-python cdbs python-pip jq rsyslog-gnutls openvpn rng-tools liblz4-tool linux-image-generic linux-headers-generic dkms -yq\nRUN apt-get purge -yq apport\nRUN git clone git://github.com/facebook/zstd /tmp/zstd \\\n && cd /tmp/zstd \\\n && git checkout f3a8bd553a865c59f1bd6e1f68bf182cf75a8f00 \\\n && make zstd \\\n && mv zstd /usr/bin\nRUN cd /lib/modules \\\n && KERNEL_VER=$( ls -1 | tail -1 ;) \\\n && V4L2LOOPBACK_VERSION=0.12.0 \\\n && cd /usr/src \\\n && git clone --branch v${V4L2LOOPBACK_VERSION} git://github.com/umlaeute/v4l2loopback.git v4l2loopback-${V4L2LOOPBACK_VERSION} \\\n && cd v4l2loopback-${V4L2LOOPBACK_VERSION} \\\n && dkms install -m v4l2loopback -v ${V4L2LOOPBACK_VERSION} -k ${KERNEL_VER} \\\n && dkms build -m v4l2loopback -v ${V4L2LOOPBACK_VERSION} -k ${KERNEL_VER}\nRUN echo \"v4l2loopback\" | tee --append /etc/modules\nRUN echo \"options v4l2loopback devices=100\" > /etc/modprobe.d/v4l2loopback.conf\nRUN echo \"snd-aloop\" | tee --append /etc/modules\nRUN echo \"options snd-aloop enable=1,1,1,1,1,1,1,1 index=0,1,2,3,4,5,6,7\" > /etc/modprobe.d/snd-aloop.conf\nRUN echo \"#!/bin/sh -e\" > /etc/rc.local\nRUN echo \"modprobe snd-aloop\" >> /etc/rc.local\nRUN echo \"exit 0\" >> /etc/rc.local\nRUN chmod +x /etc/rc.local\nRUN echo net.ipv4.tcp_challenge_ack_limit = 999999999 >> /etc/sysctl.conf\nRUN apt-get autoremove -y\nRUN unattended-upgrade\nRUN /tmp/node.sh\n#  END BASE IMAGE\n#  BEGIN APP IMAGE\nCOPY deploy/deploy.tar.gz /tmp\nCOPY docker-worker.tgz /tmp\nRUN curl -o /etc/papertrail-bundle.pem https://papertrailapp.com/tools/papertrail-bundle.pem\n#  RUN test `md5sum /etc/papertrail-bundle.pem | awk '{ print $1 }'` == \"2c43548519379c083d60dd9e84a1b724\"\nRUN apt-get install python-statsd -y\nRUN tar xzf /tmp/deploy.tar.gz -C / --strip-components=1\nRUN mkdir -p /home/ubuntu/docker_worker\nRUN npm install yarn -g\nRUN cd /home/ubuntu/docker_worker \\\n && tar xzf /tmp/docker-worker.tgz -C . \\\n && yarn install --frozen-lockfile\nCOPY ./deploy/packet-net/docker-worker.service /lib/systemd/system/docker-worker.service\nRUN systemctl enable docker-worker\n#  END OF APP IMAGE\n","injectedSmells":[],"originalDockerfileHash":"72cc6d14cec8699252e824245013dd40","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM ubuntu_18_04-base\nMAINTAINER Wander Lairson Costa <wcosta@mozilla.com>\nLABEL Description=\"docker-worker packet.net image\" \\\n      Vendor=\"Mozilla\"\n#   BEGIN BASE IMAGE\nENV DEBIAN_FRONTEND=\"noninteractive\"\nENV PAPERTRAIL=\"logs.papertrailapp.com:52806\"\nRUN echo $( which nologin ;) >> /etc/shells\nRUN useradd -m -s $( which nologin ;) ubuntu\nRUN usermod -L ubuntu\nCOPY ./deploy/packer/base/scripts/configure_syslog.sh /tmp/\nCOPY ./deploy/packer/base/scripts/node.sh /tmp/\nCOPY ./deploy/fake-keys/docker-worker-ed25519-cot-signing-key.key /etc/\nRUN chmod +x /tmp/configure_syslog.sh /tmp/node.sh\nRUN /tmp/configure_syslog.sh\nRUN groupadd -f docker\nRUN apt-get update\nRUN apt-get install curl apt-transport-https ca-certificates curl software-properties-common -yq\nRUN curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add - \\\n && apt-key fingerprint 0EBFCD88 \\\n && add-apt-repository \"deb [arch=amd64] https://download.docker.com/linux/ubuntu $( lsb_release -cs ;) stable\" \\\n && apt-get update\nRUN apt-get install unattended-upgrades docker-ce=18.06.0~ce~3-0~ubuntu lvm2 build-essential git-core gstreamer1.0-alsa gstreamer1.0-plugins-bad gstreamer1.0-plugins-base gstreamer1.0-plugins-good gstreamer1.0-plugins-ugly gstreamer1.0-tools pbuilder python-mock python-configobj dh-python cdbs python-pip jq rsyslog-gnutls openvpn rng-tools liblz4-tool linux-image-generic linux-headers-generic dkms -yq\nRUN apt-get purge -yq apport\nRUN git clone git://github.com/facebook/zstd /tmp/zstd \\\n && cd /tmp/zstd \\\n && git checkout f3a8bd553a865c59f1bd6e1f68bf182cf75a8f00 \\\n && make zstd \\\n && mv zstd /usr/bin\nRUN cd /lib/modules \\\n && KERNEL_VER=$( ls -1 | tail -1 ;) \\\n && V4L2LOOPBACK_VERSION=0.12.0 \\\n && cd /usr/src \\\n && git clone --branch v${V4L2LOOPBACK_VERSION} git://github.com/umlaeute/v4l2loopback.git v4l2loopback-${V4L2LOOPBACK_VERSION} \\\n && cd v4l2loopback-${V4L2LOOPBACK_VERSION} \\\n && dkms install -m v4l2loopback -v ${V4L2LOOPBACK_VERSION} -k ${KERNEL_VER} \\\n && dkms build -m v4l2loopback -v ${V4L2LOOPBACK_VERSION} -k ${KERNEL_VER}\nRUN echo \"v4l2loopback\" | tee --append /etc/modules\nRUN echo \"options v4l2loopback devices=100\" > /etc/modprobe.d/v4l2loopback.conf\nRUN echo \"snd-aloop\" | tee --append /etc/modules\nRUN echo \"options snd-aloop enable=1,1,1,1,1,1,1,1 index=0,1,2,3,4,5,6,7\" > /etc/modprobe.d/snd-aloop.conf\nRUN echo \"#!/bin/sh -e\" > /etc/rc.local\nRUN echo \"modprobe snd-aloop\" >> /etc/rc.local\nRUN echo \"exit 0\" >> /etc/rc.local\nRUN chmod +x /etc/rc.local\nRUN echo net.ipv4.tcp_challenge_ack_limit = 999999999 >> /etc/sysctl.conf\nRUN apt-get autoremove -y\nRUN unattended-upgrade\nRUN /tmp/node.sh\n#   END BASE IMAGE\n#   BEGIN APP IMAGE\nCOPY deploy/deploy.tar.gz /tmp\nCOPY docker-worker.tgz /tmp\nRUN curl -o /etc/papertrail-bundle.pem https://papertrailapp.com/tools/papertrail-bundle.pem\n#   RUN test `md5sum /etc/papertrail-bundle.pem | awk '{ print $1 }'` == \"2c43548519379c083d60dd9e84a1b724\"\nRUN apt-get install python-statsd -y\nRUN tar xzf /tmp/deploy.tar.gz -C / --strip-components=1\nRUN mkdir -p /home/ubuntu/docker_worker\nRUN npm install yarn -g\nRUN cd /home/ubuntu/docker_worker \\\n && tar xzf /tmp/docker-worker.tgz -C . \\\n && yarn install --frozen-lockfile\nCOPY ./deploy/packet-net/docker-worker.service /lib/systemd/system/docker-worker.service\nRUN systemctl enable docker-worker\n#   END OF APP IMAGE\n","originalDockerfileUglifiedHash":"bcf4bf42d9c9d4d7392ab9a70e578422","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/ed840636daddc8e1105f6749cf9a02233ee0b8d2.dockerfile"}