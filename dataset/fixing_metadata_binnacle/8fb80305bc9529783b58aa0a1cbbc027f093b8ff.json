{"seed":2639845810,"processedDockerfileHash":"abb14d51377dd0358446e22662947515","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM alpine:%%UPSTREAM%%\nARG S6_VERSION=v1.21.4.0\nARG POSTGIS_VERSION=2.4.4\nARG POSTGRES_VERSION=9.6.8-r0\n#   Parse arguments for the build command.\nARG VERSION\nARG VCS_URL\nARG VCS_REF\nARG BUILD_DATE\n#   A little bit of metadata management.\n#   See http://label-schema.org/\nLABEL org.label-schema.schema-version=\"1.0\" \\\n      org.label-schema.build-date=\"$BUILD_DATE\" \\\n      org.label-schema.vendor=\"UN-OCHA\" \\\n      org.label-schema.version=\"$VERSION\" \\\n      org.label-schema.vcs-url=\"$VCS_URL\" \\\n      org.label-schema.vcs-ref=\"$VCS_REF\" \\\n      org.label-schema.name=\"postgis\" \\\n      org.label-schema.description=\"This service provides a postgresql service using postgres and postgis\" \\\n      org.label-schema.architecture=\"x86_64\" \\\n      org.label-schema.distribution=\"Alpine Linux\" \\\n      org.label-schema.distribution-version=\"%%UPSTREAM%%\" \\\n      info.humanitarianresponse.s6=\"$S6_VERSION\" \\\n      info.humanitarianresponse.postgis=\"$POSTGIS_VERSION\" \\\n      info.humanitarianresponse.postgresql=\"$POSTGRES_VERSION\"\nENV LANG=\"en_US.utf8\" \\\n    PGDATA=\"/var/lib/pgsql\" \\\n    PG_CONFIG_FILE=\"/etc/pgsql/postgresql.conf\" \\\n    PGSQL_DB=\"testdb\" \\\n    PGSQL_USER=\"testuser\" \\\n    PGSQL_PASS=\"testpass\"\nCOPY fix_pgsql_dirs pg_hba.conf postgresql.conf recovery run_postgres /tmp/\nRUN apk update \\\n && apk upgrade \\\n && apk add curl nano postgresql postgresql-client postgresql-contrib \\\n && curl -sL https://github.com/just-containers/s6-overlay/releases/download/${S6_VERSION}/s6-overlay-amd64.tar.gz -o /tmp/s6.tgz \\\n && tar xzf /tmp/s6.tgz -C / \\\n && rm -f /tmp/s6.tgz \\\n && mkdir -p /etc/services.d/postgres /etc/fix-attrs.d /etc/pgsql /run/postgresql \\\n && cp /tmp/fix_pgsql_dirs /etc/fix-attrs.d/ \\\n && mv /tmp/run_postgres /etc/services.d/postgres/run \\\n && mv /tmp/pg_hba.conf /etc/pgsql/ \\\n && mv /tmp/postgresql.conf /etc/pgsql/ \\\n && mv /tmp/recovery /etc/pgsql/ \\\n && touch /etc/pgsql/pg_ident.conf \\\n && echo \"@testing http://dl-cdn.alpinelinux.org/alpine/edge/testing\" >> /etc/apk/repositories \\\n && apk add postgresql-dev perl file geos@testing geos-dev@testing libxml2-dev gdal@testing gdal-dev@testing proj4@testing proj4-dev@testing gcc make libgcc g++ --update-cache \\\n && cd /tmp \\\n && wget http://download.osgeo.org/postgis/source/postgis-${POSTGIS_VERSION}.tar.gz -O - | tar -xz \\\n && chown root:root -R postgis-${POSTGIS_VERSION} \\\n && cd /tmp/postgis-${POSTGIS_VERSION} \\\n && ./configure \\\n && echo \"PERL = /usr/bin/perl\" >> extensions/postgis/Makefile \\\n && echo \"PERL = /usr/bin/perl\" >> extensions/postgis_topology/Makefile \\\n && make -s \\\n && make -s install \\\n && cd / \\\n && rm -rf /tmp/postgis-${POSTGIS_VERSION} \\\n && apk del postgresql-dev perl file geos-dev libxml2-dev gdal-dev proj4-dev gcc make libgcc g++ \\\n && rm -rf /var/cache/apk/* \\\n && echo \"removing useless, duplicates postgis sql files\" \\\n && find /usr/share/postgresql/extension -iname \"postgis*--2.[0-9].[0-9]--${POSTGIS_VERSION}.sql\" ! -iname \"postgis*--2.4.4--${POSTGIS_VERSION}.psql\" -print -delete\nENTRYPOINT [\"/init\"]\nCMD []\nEXPOSE 5432/tcp\nVOLUME [\"/var/lib/pgsql\"]\nRUN addgroup -S docker-user ; adduser -S -G docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM alpine:%%UPSTREAM%%\nARG S6_VERSION=v1.21.4.0\nARG POSTGIS_VERSION=2.4.4\nARG POSTGRES_VERSION=9.6.8-r0\n#  Parse arguments for the build command.\nARG VERSION\nARG VCS_URL\nARG VCS_REF\nARG BUILD_DATE\n#  A little bit of metadata management.\n#  See http://label-schema.org/\nLABEL org.label-schema.schema-version=\"1.0\" \\\n      org.label-schema.build-date=\"$BUILD_DATE\" \\\n      org.label-schema.vendor=\"UN-OCHA\" \\\n      org.label-schema.version=\"$VERSION\" \\\n      org.label-schema.vcs-url=\"$VCS_URL\" \\\n      org.label-schema.vcs-ref=\"$VCS_REF\" \\\n      org.label-schema.name=\"postgis\" \\\n      org.label-schema.description=\"This service provides a postgresql service using postgres and postgis\" \\\n      org.label-schema.architecture=\"x86_64\" \\\n      org.label-schema.distribution=\"Alpine Linux\" \\\n      org.label-schema.distribution-version=\"%%UPSTREAM%%\" \\\n      info.humanitarianresponse.s6=\"$S6_VERSION\" \\\n      info.humanitarianresponse.postgis=\"$POSTGIS_VERSION\" \\\n      info.humanitarianresponse.postgresql=\"$POSTGRES_VERSION\"\nENV LANG=\"en_US.utf8\" \\\n    PGDATA=\"/var/lib/pgsql\" \\\n    PG_CONFIG_FILE=\"/etc/pgsql/postgresql.conf\" \\\n    PGSQL_DB=\"testdb\" \\\n    PGSQL_USER=\"testuser\" \\\n    PGSQL_PASS=\"testpass\"\nCOPY fix_pgsql_dirs pg_hba.conf postgresql.conf recovery run_postgres /tmp/\nRUN apk update \\\n && apk upgrade \\\n && apk add curl nano postgresql postgresql-client postgresql-contrib \\\n && curl -sL https://github.com/just-containers/s6-overlay/releases/download/${S6_VERSION}/s6-overlay-amd64.tar.gz -o /tmp/s6.tgz \\\n && tar xzf /tmp/s6.tgz -C / \\\n && rm -f /tmp/s6.tgz \\\n && mkdir -p /etc/services.d/postgres /etc/fix-attrs.d /etc/pgsql /run/postgresql \\\n && cp /tmp/fix_pgsql_dirs /etc/fix-attrs.d/ \\\n && mv /tmp/run_postgres /etc/services.d/postgres/run \\\n && mv /tmp/pg_hba.conf /etc/pgsql/ \\\n && mv /tmp/postgresql.conf /etc/pgsql/ \\\n && mv /tmp/recovery /etc/pgsql/ \\\n && touch /etc/pgsql/pg_ident.conf \\\n && echo \"@testing http://dl-cdn.alpinelinux.org/alpine/edge/testing\" >> /etc/apk/repositories \\\n && apk add --update-cache postgresql-dev perl file geos@testing geos-dev@testing libxml2-dev gdal@testing gdal-dev@testing proj4@testing proj4-dev@testing gcc make libgcc g++ \\\n && cd /tmp \\\n && wget http://download.osgeo.org/postgis/source/postgis-${POSTGIS_VERSION}.tar.gz -O - | tar -xz \\\n && chown root:root -R postgis-${POSTGIS_VERSION} \\\n && cd /tmp/postgis-${POSTGIS_VERSION} \\\n && ./configure \\\n && echo \"PERL = /usr/bin/perl\" >> extensions/postgis/Makefile \\\n && echo \"PERL = /usr/bin/perl\" >> extensions/postgis_topology/Makefile \\\n && make -s \\\n && make -s install \\\n && cd / \\\n && rm -rf /tmp/postgis-${POSTGIS_VERSION} \\\n && apk del postgresql-dev perl file geos-dev libxml2-dev gdal-dev proj4-dev gcc make libgcc g++ \\\n && rm -rf /var/cache/apk/* \\\n && echo \"removing useless, duplicates postgis sql files\" \\\n && find /usr/share/postgresql/extension -iname \"postgis*--2.[0-9].[0-9]--${POSTGIS_VERSION}.sql\" ! -iname \"postgis*--2.4.4--${POSTGIS_VERSION}.psql\" -print -delete\nENTRYPOINT [\"/init\"]\nCMD []\nEXPOSE 5432/tcp\nVOLUME [\"/var/lib/pgsql\"]\n","injectedSmells":[],"originalDockerfileHash":"d20623a27c212acd695a00d49d58d9b2","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM alpine:%%UPSTREAM%%\nARG S6_VERSION=v1.21.4.0\nARG POSTGIS_VERSION=2.4.4\nARG POSTGRES_VERSION=9.6.8-r0\n#   Parse arguments for the build command.\nARG VERSION\nARG VCS_URL\nARG VCS_REF\nARG BUILD_DATE\n#   A little bit of metadata management.\n#   See http://label-schema.org/\nLABEL org.label-schema.schema-version=\"1.0\" \\\n      org.label-schema.build-date=\"$BUILD_DATE\" \\\n      org.label-schema.vendor=\"UN-OCHA\" \\\n      org.label-schema.version=\"$VERSION\" \\\n      org.label-schema.vcs-url=\"$VCS_URL\" \\\n      org.label-schema.vcs-ref=\"$VCS_REF\" \\\n      org.label-schema.name=\"postgis\" \\\n      org.label-schema.description=\"This service provides a postgresql service using postgres and postgis\" \\\n      org.label-schema.architecture=\"x86_64\" \\\n      org.label-schema.distribution=\"Alpine Linux\" \\\n      org.label-schema.distribution-version=\"%%UPSTREAM%%\" \\\n      info.humanitarianresponse.s6=\"$S6_VERSION\" \\\n      info.humanitarianresponse.postgis=\"$POSTGIS_VERSION\" \\\n      info.humanitarianresponse.postgresql=\"$POSTGRES_VERSION\"\nENV LANG=\"en_US.utf8\" \\\n    PGDATA=\"/var/lib/pgsql\" \\\n    PG_CONFIG_FILE=\"/etc/pgsql/postgresql.conf\" \\\n    PGSQL_DB=\"testdb\" \\\n    PGSQL_USER=\"testuser\" \\\n    PGSQL_PASS=\"testpass\"\nCOPY fix_pgsql_dirs pg_hba.conf postgresql.conf recovery run_postgres /tmp/\nRUN apk update \\\n && apk upgrade \\\n && apk add curl nano postgresql postgresql-client postgresql-contrib \\\n && curl -sL https://github.com/just-containers/s6-overlay/releases/download/${S6_VERSION}/s6-overlay-amd64.tar.gz -o /tmp/s6.tgz \\\n && tar xzf /tmp/s6.tgz -C / \\\n && rm -f /tmp/s6.tgz \\\n && mkdir -p /etc/services.d/postgres /etc/fix-attrs.d /etc/pgsql /run/postgresql \\\n && cp /tmp/fix_pgsql_dirs /etc/fix-attrs.d/ \\\n && mv /tmp/run_postgres /etc/services.d/postgres/run \\\n && mv /tmp/pg_hba.conf /etc/pgsql/ \\\n && mv /tmp/postgresql.conf /etc/pgsql/ \\\n && mv /tmp/recovery /etc/pgsql/ \\\n && touch /etc/pgsql/pg_ident.conf \\\n && echo \"@testing http://dl-cdn.alpinelinux.org/alpine/edge/testing\" >> /etc/apk/repositories \\\n && apk add --update-cache postgresql-dev perl file geos@testing geos-dev@testing libxml2-dev gdal@testing gdal-dev@testing proj4@testing proj4-dev@testing gcc make libgcc g++ \\\n && cd /tmp \\\n && wget http://download.osgeo.org/postgis/source/postgis-${POSTGIS_VERSION}.tar.gz -O - | tar -xz \\\n && chown root:root -R postgis-${POSTGIS_VERSION} \\\n && cd /tmp/postgis-${POSTGIS_VERSION} \\\n && ./configure \\\n && echo \"PERL = /usr/bin/perl\" >> extensions/postgis/Makefile \\\n && echo \"PERL = /usr/bin/perl\" >> extensions/postgis_topology/Makefile \\\n && make -s \\\n && make -s install \\\n && cd / \\\n && rm -rf /tmp/postgis-${POSTGIS_VERSION} \\\n && apk del postgresql-dev perl file geos-dev libxml2-dev gdal-dev proj4-dev gcc make libgcc g++ \\\n && rm -rf /var/cache/apk/* \\\n && echo \"removing useless, duplicates postgis sql files\" \\\n && find /usr/share/postgresql/extension -iname \"postgis*--2.[0-9].[0-9]--${POSTGIS_VERSION}.sql\" ! -iname \"postgis*--2.4.4--${POSTGIS_VERSION}.psql\" -print -delete\nENTRYPOINT [\"/init\"]\nCMD []\nEXPOSE 5432/tcp\nVOLUME [\"/var/lib/pgsql\"]\n","originalDockerfileUglifiedHash":"4fb7aaeabb69d7b403be0cbb50cf5c4e","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/8fb80305bc9529783b58aa0a1cbbc027f093b8ff.dockerfile"}