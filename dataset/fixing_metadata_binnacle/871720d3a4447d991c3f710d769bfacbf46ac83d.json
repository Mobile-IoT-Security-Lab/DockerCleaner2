{"seed":1307979022,"processedDockerfileHash":"90e5d7c8188eea443cfff50aa55761cd","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","pin-package-manager-versions-apt-get","have-a-healthcheck"],"processedDockerfile":"#   Copyright 2018 The Chromium Authors. All rights reserved.\n#   Use of this source code is governed by a BSD-style license that can be\n#   found in the LICENSE file.\n#\n#   Defines a docker image that can build sound open firmware\n#\n#   Usage:\n#   check out sof\n#   build docker image:\n#   docker build --build-arg UID=$(id -u) -t sof .\n#   docker run -it  -v <insert sof dir here>:/home/sof/workdir --user `id -u` sof\n#\n#   For incremental builds:\n#   docker run -it  -v <insert sof dir here>:/home/sof/work/sof.git --user `id -u` sof ./incremental.sh\n#\nFROM ubuntu:18.04\nARG UID=1000\n#   Set up proxy from host\nCOPY apt.conf /etc/apt/\nARG host_http_proxy\nARG host_https_proxy\nENV http_proxy=\"$host_http_proxy\"\nENV https_proxy=\"$host_https_proxy\"\nRUN apt-get update -y \\\n && apt-get install --no-install-recommends autoconf=2.69-11 bison=2:3.0.4.dfsg-1build1 build-essential=12.4ubuntu1 flex=2.6.4-6 gawk=1:4.1.4+dfsg-1build1 gettext=0.19.8.1-6ubuntu0.3 git=1:2.17.1-1ubuntu0.17 gperf=3.1-1 help2man=1.47.6 libncurses5-dev=6.1-1ubuntu1.18.04 libssl-dev=1.1.1-1ubuntu2.1~18.04.21 libtool=2.4.6-2 libtool-bin=2.4.6-2 pkg-config=0.29.1-0ubuntu2 software-properties-common=0.96.24.32.20 sudo=1.8.21p2-3ubuntu1.5 texinfo=6.5.0.dfsg.1-2 udev=237-3ubuntu10.57 wget=1.19.4-1ubuntu2.2 unzip=6.0-21ubuntu1.2 cmake=3.10.2-1ubuntu2.18.04.2 python3=3.6.7-1~18.04 -y\n#   Use ToT alsa utils for the latest topology patches.\nRUN mkdir -p /root/alsa-build \\\n && cd /root/alsa-build \\\n && git clone https://github.com/thesofproject/alsa-lib.git \\\n && git clone https://github.com/thesofproject/alsa-utils.git \\\n && cd /root/alsa-build/alsa-lib \\\n && ./gitcompile \\\n && make install \\\n && cd /root/alsa-build/alsa-utils \\\n && ./gitcompile \\\n && make install \\\n && cd /root/ \\\n && rm -rf alsa-build\n#   Set up sof user\nRUN useradd --create-home -d /home/sof -u $UID -G sudo sof \\\n && echo \"sof:test0000\" | chpasswd \\\n && adduser sof sudo\nENV HOME=\"/home/sof\"\n#   build cross compiler\nUSER sof\nRUN cd /home/sof \\\n && git clone https://github.com/thesofproject/xtensa-overlay.git \\\n && cd xtensa-overlay \\\n && git checkout sof-gcc8.1 \\\n && cd ../ \\\n && git clone https://github.com/thesofproject/crosstool-ng.git \\\n && mkdir -p /home/sof/work/ \\\n && cd crosstool-ng \\\n && git checkout sof-gcc8.1 \\\n && ./bootstrap \\\n && ./configure --prefix=`pwd ` \\\n && make \\\n && make install \\\n && for arch in byt hsw apl cnl imx; do cp config-${arch}-gcc8.1-gdb8.1 .config \\\n && sed -i 's#${CT_TOP_DIR}\\/builds#\\/home\\/sof\\/work#g' .config \\\n && gl_cv_func_getcwd_path_max=yes ./ct-ng build \\\n && ./ct-ng distclean ; done \\\n && cd /home/sof/ \\\n && rm -rf xtensa-overlay \\\n && rm -rf crosstool-ng\nENV PATH=\"/home/sof/work/xtensa-byt-elf/bin:${PATH}\"\nENV PATH=\"/home/sof/work/xtensa-hsw-elf/bin:${PATH}\"\nENV PATH=\"/home/sof/work/xtensa-apl-elf/bin:${PATH}\"\nENV PATH=\"/home/sof/work/xtensa-cnl-elf/bin:${PATH}\"\nENV PATH=\"/home/sof/work/xtensa-imx-elf/bin:${PATH}\"\nRUN cd /home/sof \\\n && git clone https://github.com/jcmvbkbc/newlib-xtensa.git newlib-xtensa.git \\\n && cd newlib-xtensa.git \\\n && git checkout -b xtensa origin/xtensa \\\n && for arch in byt hsw apl cnl imx; do ./configure --target=xtensa-${arch}-elf --prefix=/home/sof/work/xtensa-root \\\n && make \\\n && make install \\\n && rm -rf etc/config.cache ; done \\\n && cd /home/sof/ \\\n && rm -rf newlib-xtensa.git\n#   Create direcroties for the host machines sof directories to be mounted.\nRUN mkdir -p /home/sof/work/sof.git\nUSER sof\nWORKDIR /home/sof/work/sof.git/\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  Copyright 2018 The Chromium Authors. All rights reserved.\n#  Use of this source code is governed by a BSD-style license that can be\n#  found in the LICENSE file.\n#\n#  Defines a docker image that can build sound open firmware\n#\n#  Usage:\n#  check out sof\n#  build docker image:\n#  docker build --build-arg UID=$(id -u) -t sof .\n#  docker run -it  -v <insert sof dir here>:/home/sof/workdir --user `id -u` sof\n#\n#  For incremental builds:\n#  docker run -it  -v <insert sof dir here>:/home/sof/work/sof.git --user `id -u` sof ./incremental.sh\n#\nFROM ubuntu:18.04\nARG UID=1000\n#  Set up proxy from host\nCOPY apt.conf /etc/apt/\nARG host_http_proxy\nARG host_https_proxy\nENV http_proxy=\"$host_http_proxy\"\nENV https_proxy=\"$host_https_proxy\"\nRUN apt-get update -y \\\n && apt-get install autoconf bison build-essential flex gawk gettext git gperf help2man libncurses5-dev libssl-dev libtool libtool-bin pkg-config software-properties-common sudo texinfo udev wget unzip cmake python3 -y\n#  Use ToT alsa utils for the latest topology patches.\nRUN mkdir -p /root/alsa-build \\\n && cd /root/alsa-build \\\n && git clone https://github.com/thesofproject/alsa-lib.git \\\n && git clone https://github.com/thesofproject/alsa-utils.git \\\n && cd /root/alsa-build/alsa-lib \\\n && ./gitcompile \\\n && make install \\\n && cd /root/alsa-build/alsa-utils \\\n && ./gitcompile \\\n && make install \\\n && cd /root/ \\\n && rm -rf alsa-build\n#  Set up sof user\nRUN useradd --create-home -d /home/sof -u $UID -G sudo sof \\\n && echo \"sof:test0000\" | chpasswd \\\n && adduser sof sudo\nENV HOME=\"/home/sof\"\n#  build cross compiler\nUSER sof\nRUN cd /home/sof \\\n && git clone https://github.com/thesofproject/xtensa-overlay.git \\\n && cd xtensa-overlay \\\n && git checkout sof-gcc8.1 \\\n && cd ../ \\\n && git clone https://github.com/thesofproject/crosstool-ng.git \\\n && mkdir -p /home/sof/work/ \\\n && cd crosstool-ng \\\n && git checkout sof-gcc8.1 \\\n && ./bootstrap \\\n && ./configure --prefix=`pwd ` \\\n && make \\\n && make install \\\n && for arch in byt hsw apl cnl imx; do cp config-${arch}-gcc8.1-gdb8.1 .config \\\n && sed -i 's#${CT_TOP_DIR}\\/builds#\\/home\\/sof\\/work#g' .config \\\n && gl_cv_func_getcwd_path_max=yes ./ct-ng build \\\n && ./ct-ng distclean ; done \\\n && cd /home/sof/ \\\n && rm -rf xtensa-overlay \\\n && rm -rf crosstool-ng\nENV PATH=\"/home/sof/work/xtensa-byt-elf/bin:${PATH}\"\nENV PATH=\"/home/sof/work/xtensa-hsw-elf/bin:${PATH}\"\nENV PATH=\"/home/sof/work/xtensa-apl-elf/bin:${PATH}\"\nENV PATH=\"/home/sof/work/xtensa-cnl-elf/bin:${PATH}\"\nENV PATH=\"/home/sof/work/xtensa-imx-elf/bin:${PATH}\"\nRUN cd /home/sof \\\n && git clone https://github.com/jcmvbkbc/newlib-xtensa.git newlib-xtensa.git \\\n && cd newlib-xtensa.git \\\n && git checkout -b xtensa origin/xtensa \\\n && for arch in byt hsw apl cnl imx; do ./configure --target=xtensa-${arch}-elf --prefix=/home/sof/work/xtensa-root \\\n && make \\\n && make install \\\n && rm -rf etc/config.cache ; done \\\n && cd /home/sof/ \\\n && rm -rf newlib-xtensa.git\n#  Create direcroties for the host machines sof directories to be mounted.\nRUN mkdir -p /home/sof/work/sof.git\nUSER sof\nWORKDIR /home/sof/work/sof.git/\n","injectedSmells":[],"originalDockerfileHash":"dd7ecf4c433a9bf29d25e0e54df62d0e","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   Copyright 2018 The Chromium Authors. All rights reserved.\n#   Use of this source code is governed by a BSD-style license that can be\n#   found in the LICENSE file.\n#\n#   Defines a docker image that can build sound open firmware\n#\n#   Usage:\n#   check out sof\n#   build docker image:\n#   docker build --build-arg UID=$(id -u) -t sof .\n#   docker run -it  -v <insert sof dir here>:/home/sof/workdir --user `id -u` sof\n#\n#   For incremental builds:\n#   docker run -it  -v <insert sof dir here>:/home/sof/work/sof.git --user `id -u` sof ./incremental.sh\n#\nFROM ubuntu:18.04\nARG UID=1000\n#   Set up proxy from host\nCOPY apt.conf /etc/apt/\nARG host_http_proxy\nARG host_https_proxy\nENV http_proxy=\"$host_http_proxy\"\nENV https_proxy=\"$host_https_proxy\"\nRUN apt-get update -y \\\n && apt-get install autoconf bison build-essential flex gawk gettext git gperf help2man libncurses5-dev libssl-dev libtool libtool-bin pkg-config software-properties-common sudo texinfo udev wget unzip cmake python3 -y\n#   Use ToT alsa utils for the latest topology patches.\nRUN mkdir -p /root/alsa-build \\\n && cd /root/alsa-build \\\n && git clone https://github.com/thesofproject/alsa-lib.git \\\n && git clone https://github.com/thesofproject/alsa-utils.git \\\n && cd /root/alsa-build/alsa-lib \\\n && ./gitcompile \\\n && make install \\\n && cd /root/alsa-build/alsa-utils \\\n && ./gitcompile \\\n && make install \\\n && cd /root/ \\\n && rm -rf alsa-build\n#   Set up sof user\nRUN useradd --create-home -d /home/sof -u $UID -G sudo sof \\\n && echo \"sof:test0000\" | chpasswd \\\n && adduser sof sudo\nENV HOME=\"/home/sof\"\n#   build cross compiler\nUSER sof\nRUN cd /home/sof \\\n && git clone https://github.com/thesofproject/xtensa-overlay.git \\\n && cd xtensa-overlay \\\n && git checkout sof-gcc8.1 \\\n && cd ../ \\\n && git clone https://github.com/thesofproject/crosstool-ng.git \\\n && mkdir -p /home/sof/work/ \\\n && cd crosstool-ng \\\n && git checkout sof-gcc8.1 \\\n && ./bootstrap \\\n && ./configure --prefix=`pwd ` \\\n && make \\\n && make install \\\n && for arch in byt hsw apl cnl imx; do cp config-${arch}-gcc8.1-gdb8.1 .config \\\n && sed -i 's#${CT_TOP_DIR}\\/builds#\\/home\\/sof\\/work#g' .config \\\n && gl_cv_func_getcwd_path_max=yes ./ct-ng build \\\n && ./ct-ng distclean ; done \\\n && cd /home/sof/ \\\n && rm -rf xtensa-overlay \\\n && rm -rf crosstool-ng\nENV PATH=\"/home/sof/work/xtensa-byt-elf/bin:${PATH}\"\nENV PATH=\"/home/sof/work/xtensa-hsw-elf/bin:${PATH}\"\nENV PATH=\"/home/sof/work/xtensa-apl-elf/bin:${PATH}\"\nENV PATH=\"/home/sof/work/xtensa-cnl-elf/bin:${PATH}\"\nENV PATH=\"/home/sof/work/xtensa-imx-elf/bin:${PATH}\"\nRUN cd /home/sof \\\n && git clone https://github.com/jcmvbkbc/newlib-xtensa.git newlib-xtensa.git \\\n && cd newlib-xtensa.git \\\n && git checkout -b xtensa origin/xtensa \\\n && for arch in byt hsw apl cnl imx; do ./configure --target=xtensa-${arch}-elf --prefix=/home/sof/work/xtensa-root \\\n && make \\\n && make install \\\n && rm -rf etc/config.cache ; done \\\n && cd /home/sof/ \\\n && rm -rf newlib-xtensa.git\n#   Create direcroties for the host machines sof directories to be mounted.\nRUN mkdir -p /home/sof/work/sof.git\nUSER sof\nWORKDIR /home/sof/work/sof.git/\n","originalDockerfileUglifiedHash":"01c2cf25560e47b9b755e12402d8baf9","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/871720d3a4447d991c3f710d769bfacbf46ac83d.dockerfile"}