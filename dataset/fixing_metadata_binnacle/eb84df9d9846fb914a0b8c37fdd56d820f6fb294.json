{"seed":2183029019,"processedDockerfileHash":"862f49925b755aa7f027fd208a87db0b","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM ubuntu:latest\nMAINTAINER Muhammad Surya Ihsanuddin<surya.kejawen@gmail.com>\nENV DEBIAN_FRONTEND=\"noninteractive\"\nRUN sed -i 's/http:\\/\\/archive.ubuntu.com/http:\\/\\/buaya.klas.or.id/g' /etc/apt/sources.list\n#   Install Software\nRUN : \\\n && apt-get upgrade -y\nRUN (apt-get update ;apt-get install --no-install-recommends nginx-full=1.22.0-1ubuntu3 supervisor=4.2.1-1ubuntu1 vim=2:9.0.1000-4ubuntu2 varnish=7.1.1-1.1ubuntu1 -y )\nRUN (apt-get update ;apt-get install --no-install-recommends software-properties-common=0.99.35 python-software-properties -y )\nRUN (apt-get update ;apt-get install --no-install-recommends curl=7.88.1-7ubuntu1 ca-certificates=20230311 -y )\nRUN touch /etc/apt/sources.list.d/ondrej-php.list\nRUN echo \"deb http://ppa.launchpad.net/ondrej/php/ubuntu xenial main\" >> /etc/apt/sources.list.d/ondrej-php.list\nRUN echo \"deb-src http://ppa.launchpad.net/ondrej/php/ubuntu xenial main\" >> /etc/apt/sources.list.d/ondrej-php.list\nRUN apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys 4F4EA0AAE5267A6C\nRUN :\nRUN (apt-get update ;apt-get install --no-install-recommends php7.1 php7.1-cli php7.1-curl php7.1-intl php7.1-mbstring php7.1-xml php7.1-zip php7.1-bcmath php7.1-cli php7.1-fpm php7.1-imap php7.1-json php7.1-mcrypt php7.1-opcache php7.1-apcu php7.1-xmlrpc php7.1-bz2 php7.1-common php7.1-gd php7.1-ldap php7.1-mysql php7.1-readline php7.1-soap php7.1-tidy php7.1-xsl php-mongodb=1.15.0+1.11.1+1.9.2+1.7.5-1 php-apcu=5.1.22+4.0.11-2 -y )\nRUN curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin --filename=composer\nRUN apt-get remove --purge -y software-properties-common python-software-properties \\\n && apt-get autoremove -y \\\n && apt-get clean \\\n && apt-get autoclean\nRUN rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* /usr/share/doc/* ~/.composer\n#   Setup Environment\nENV NGINX_WEBROOT=\"/bigerp/web\"\nENV SYMFONY_ENV=\"dev\"\nENV VARNISH_CONFIG=\"/etc/varnish/default.vcl\"\nENV CACHE_SIZE=\"512m\"\nENV VARNISHD_PARAMS=\"-p default_ttl=3600 -p default_grace=3600\"\nENV VARNISH_PORT=\"80\"\nENV BACKEND_HOST=\"localhost\"\nENV BACKEND_PORT=\"8080\"\n#   Supervisor Configuration\nCOPY docker/supervisor/supervisor.conf /etc/supervisord.conf\n#   Nginx Configuration\nCOPY docker/nginx/sites-enabled/site.conf /etc/nginx/conf.d/default.conf\nCOPY docker/nginx/sites-enabled/php-fpm.conf /etc/nginx/conf.d/php-fpm.conf\nCOPY docker/nginx/nginx.conf /etc/nginx/nginx.conf\nCOPY docker/nginx/fastcgi_cache /etc/nginx/fastcgi_cache\nCOPY docker/nginx/static_files.conf /etc/nginx/static_files.conf\nCOPY docker/nginx/logs/site.access.log /var/log/nginx/site.access.log\nCOPY docker/nginx/logs/site.error.log /var/log/nginx/site.error.log\nCOPY docker/nginx/etc/sysctl.conf /etc/sysctl.conf\nCOPY docker/nginx/etc/security/limits.conf /etc/security/limits.conf\nRUN mkdir -p /tmp/nginx/cache\nRUN chmod 777 -R /tmp/nginx\nRUN chmod 777 /var/log/nginx/site.access.log\nRUN chmod 777 /var/log/nginx/site.error.log\n#   PHP Configuration\nCOPY docker/php/php.ini /etc/php/7.1/fpm/php.ini\nCOPY docker/php/php.ini /etc/php/7.1/cli/php.ini\nCOPY docker/php/php-fpm.conf /etc/php/7.1/fpm/php-fpm.conf\nRUN mkdir /run/php\nRUN touch /run/php/php7.1-fpm.sock\nRUN chmod 777 /run/php/php7.1-fpm.sock\n#   Varnish Configuration\nCOPY docker/varnish/default.vcl /etc/varnish/default.vcl\n#   Setup Application\nENV COMPOSER_ALLOW_SUPERUSER=\"1\"\nRUN composer global require \"hirak/prestissimo:^0.3\" \"alcaeus/mongo-php-adapter:^1.0\" --prefer-dist --no-progress --no-suggest --optimize-autoloader --classmap-authoritative \\\n && composer clear-cache\nWORKDIR /bigerp\nCOPY composer.json ./\nCOPY composer.lock ./\nRUN mkdir -p var/cache var/logs var/sessions \\\n && chmod 777 -R var/ \\\n && composer install --prefer-dist --no-autoloader --no-scripts --no-progress --no-suggest \\\n && composer clear-cache\nCOPY app app/\nCOPY bin bin/\nCOPY web web/\nCOPY src src/\nRUN composer dump-autoload --optimize --classmap-authoritative\n#   Here we go\nCOPY docker/start.sh /start.sh\nRUN chmod +x /start.sh\nEXPOSE 443/tcp 80/tcp\nCMD [\"/start.sh\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM ubuntu:latest\nMAINTAINER Muhammad Surya Ihsanuddin<surya.kejawen@gmail.com>\nENV DEBIAN_FRONTEND=\"noninteractive\"\nRUN sed -i 's/http:\\/\\/archive.ubuntu.com/http:\\/\\/buaya.klas.or.id/g' /etc/apt/sources.list\n#  Install Software\nRUN apt-get update \\\n && apt-get upgrade -y\nRUN apt-get install nginx-full supervisor vim varnish -y\nRUN apt-get install software-properties-common python-software-properties -y\nRUN apt-get install curl ca-certificates -y\nRUN touch /etc/apt/sources.list.d/ondrej-php.list\nRUN echo \"deb http://ppa.launchpad.net/ondrej/php/ubuntu xenial main\" >> /etc/apt/sources.list.d/ondrej-php.list\nRUN echo \"deb-src http://ppa.launchpad.net/ondrej/php/ubuntu xenial main\" >> /etc/apt/sources.list.d/ondrej-php.list\nRUN apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys 4F4EA0AAE5267A6C\nRUN apt-get update\nRUN apt-get install php7.1 php7.1-cli php7.1-curl php7.1-intl php7.1-mbstring php7.1-xml php7.1-zip php7.1-bcmath php7.1-cli php7.1-fpm php7.1-imap php7.1-json php7.1-mcrypt php7.1-opcache php7.1-apcu php7.1-xmlrpc php7.1-bz2 php7.1-common php7.1-gd php7.1-ldap php7.1-mysql php7.1-readline php7.1-soap php7.1-tidy php7.1-xsl php-mongodb php-apcu -y\nRUN curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin --filename=composer\nRUN apt-get remove --purge -y software-properties-common python-software-properties \\\n && apt-get autoremove -y \\\n && apt-get clean \\\n && apt-get autoclean\nRUN rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* /usr/share/doc/* ~/.composer\n#  Setup Environment\nENV NGINX_WEBROOT=\"/bigerp/web\"\nENV SYMFONY_ENV=\"dev\"\nENV VARNISH_CONFIG=\"/etc/varnish/default.vcl\"\nENV CACHE_SIZE=\"512m\"\nENV VARNISHD_PARAMS=\"-p default_ttl=3600 -p default_grace=3600\"\nENV VARNISH_PORT=\"80\"\nENV BACKEND_HOST=\"localhost\"\nENV BACKEND_PORT=\"8080\"\n#  Supervisor Configuration\nADD docker/supervisor/supervisor.conf /etc/supervisord.conf\n#  Nginx Configuration\nADD docker/nginx/sites-enabled/site.conf /etc/nginx/conf.d/default.conf\nADD docker/nginx/sites-enabled/php-fpm.conf /etc/nginx/conf.d/php-fpm.conf\nADD docker/nginx/nginx.conf /etc/nginx/nginx.conf\nADD docker/nginx/fastcgi_cache /etc/nginx/fastcgi_cache\nADD docker/nginx/static_files.conf /etc/nginx/static_files.conf\nADD docker/nginx/logs/site.access.log /var/log/nginx/site.access.log\nADD docker/nginx/logs/site.error.log /var/log/nginx/site.error.log\nADD docker/nginx/etc/sysctl.conf /etc/sysctl.conf\nADD docker/nginx/etc/security/limits.conf /etc/security/limits.conf\nRUN mkdir -p /tmp/nginx/cache\nRUN chmod 777 -R /tmp/nginx\nRUN chmod 777 /var/log/nginx/site.access.log\nRUN chmod 777 /var/log/nginx/site.error.log\n#  PHP Configuration\nADD docker/php/php.ini /etc/php/7.1/fpm/php.ini\nADD docker/php/php.ini /etc/php/7.1/cli/php.ini\nADD docker/php/php-fpm.conf /etc/php/7.1/fpm/php-fpm.conf\nRUN mkdir /run/php\nRUN touch /run/php/php7.1-fpm.sock\nRUN chmod 777 /run/php/php7.1-fpm.sock\n#  Varnish Configuration\nADD docker/varnish/default.vcl /etc/varnish/default.vcl\n#  Setup Application\nENV COMPOSER_ALLOW_SUPERUSER=\"1\"\nRUN composer global require \"hirak/prestissimo:^0.3\" \"alcaeus/mongo-php-adapter:^1.0\" --prefer-dist --no-progress --no-suggest --optimize-autoloader --classmap-authoritative \\\n && composer clear-cache\nWORKDIR /bigerp\nCOPY composer.json ./\nCOPY composer.lock ./\nRUN mkdir -p var/cache var/logs var/sessions \\\n && chmod 777 -R var/ \\\n && composer install --prefer-dist --no-autoloader --no-scripts --no-progress --no-suggest \\\n && composer clear-cache\nCOPY app app/\nCOPY bin bin/\nCOPY web web/\nCOPY src src/\nRUN composer dump-autoload --optimize --classmap-authoritative\n#  Here we go\nADD docker/start.sh /start.sh\nRUN chmod +x /start.sh\nEXPOSE 443/tcp 80/tcp\nCMD [\"/start.sh\"]\n","injectedSmells":[],"originalDockerfileHash":"ba812c6d3203461881213b03821e611b","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM ubuntu:latest\nMAINTAINER Muhammad Surya Ihsanuddin<surya.kejawen@gmail.com>\nENV DEBIAN_FRONTEND=\"noninteractive\"\nRUN sed -i 's/http:\\/\\/archive.ubuntu.com/http:\\/\\/buaya.klas.or.id/g' /etc/apt/sources.list\n#   Install Software\nRUN apt-get update \\\n && apt-get upgrade -y\nRUN apt-get install nginx-full supervisor vim varnish -y\nRUN apt-get install software-properties-common python-software-properties -y\nRUN apt-get install curl ca-certificates -y\nRUN touch /etc/apt/sources.list.d/ondrej-php.list\nRUN echo \"deb http://ppa.launchpad.net/ondrej/php/ubuntu xenial main\" >> /etc/apt/sources.list.d/ondrej-php.list\nRUN echo \"deb-src http://ppa.launchpad.net/ondrej/php/ubuntu xenial main\" >> /etc/apt/sources.list.d/ondrej-php.list\nRUN apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys 4F4EA0AAE5267A6C\nRUN apt-get update\nRUN apt-get install php7.1 php7.1-cli php7.1-curl php7.1-intl php7.1-mbstring php7.1-xml php7.1-zip php7.1-bcmath php7.1-cli php7.1-fpm php7.1-imap php7.1-json php7.1-mcrypt php7.1-opcache php7.1-apcu php7.1-xmlrpc php7.1-bz2 php7.1-common php7.1-gd php7.1-ldap php7.1-mysql php7.1-readline php7.1-soap php7.1-tidy php7.1-xsl php-mongodb php-apcu -y\nRUN curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin --filename=composer\nRUN apt-get remove --purge -y software-properties-common python-software-properties \\\n && apt-get autoremove -y \\\n && apt-get clean \\\n && apt-get autoclean\nRUN rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* /usr/share/doc/* ~/.composer\n#   Setup Environment\nENV NGINX_WEBROOT=\"/bigerp/web\"\nENV SYMFONY_ENV=\"dev\"\nENV VARNISH_CONFIG=\"/etc/varnish/default.vcl\"\nENV CACHE_SIZE=\"512m\"\nENV VARNISHD_PARAMS=\"-p default_ttl=3600 -p default_grace=3600\"\nENV VARNISH_PORT=\"80\"\nENV BACKEND_HOST=\"localhost\"\nENV BACKEND_PORT=\"8080\"\n#   Supervisor Configuration\nADD docker/supervisor/supervisor.conf /etc/supervisord.conf\n#   Nginx Configuration\nADD docker/nginx/sites-enabled/site.conf /etc/nginx/conf.d/default.conf\nADD docker/nginx/sites-enabled/php-fpm.conf /etc/nginx/conf.d/php-fpm.conf\nADD docker/nginx/nginx.conf /etc/nginx/nginx.conf\nADD docker/nginx/fastcgi_cache /etc/nginx/fastcgi_cache\nADD docker/nginx/static_files.conf /etc/nginx/static_files.conf\nADD docker/nginx/logs/site.access.log /var/log/nginx/site.access.log\nADD docker/nginx/logs/site.error.log /var/log/nginx/site.error.log\nADD docker/nginx/etc/sysctl.conf /etc/sysctl.conf\nADD docker/nginx/etc/security/limits.conf /etc/security/limits.conf\nRUN mkdir -p /tmp/nginx/cache\nRUN chmod 777 -R /tmp/nginx\nRUN chmod 777 /var/log/nginx/site.access.log\nRUN chmod 777 /var/log/nginx/site.error.log\n#   PHP Configuration\nADD docker/php/php.ini /etc/php/7.1/fpm/php.ini\nADD docker/php/php.ini /etc/php/7.1/cli/php.ini\nADD docker/php/php-fpm.conf /etc/php/7.1/fpm/php-fpm.conf\nRUN mkdir /run/php\nRUN touch /run/php/php7.1-fpm.sock\nRUN chmod 777 /run/php/php7.1-fpm.sock\n#   Varnish Configuration\nADD docker/varnish/default.vcl /etc/varnish/default.vcl\n#   Setup Application\nENV COMPOSER_ALLOW_SUPERUSER=\"1\"\nRUN composer global require \"hirak/prestissimo:^0.3\" \"alcaeus/mongo-php-adapter:^1.0\" --prefer-dist --no-progress --no-suggest --optimize-autoloader --classmap-authoritative \\\n && composer clear-cache\nWORKDIR /bigerp\nCOPY composer.json ./\nCOPY composer.lock ./\nRUN mkdir -p var/cache var/logs var/sessions \\\n && chmod 777 -R var/ \\\n && composer install --prefer-dist --no-autoloader --no-scripts --no-progress --no-suggest \\\n && composer clear-cache\nCOPY app app/\nCOPY bin bin/\nCOPY web web/\nCOPY src src/\nRUN composer dump-autoload --optimize --classmap-authoritative\n#   Here we go\nADD docker/start.sh /start.sh\nRUN chmod +x /start.sh\nEXPOSE 443/tcp 80/tcp\nCMD [\"/start.sh\"]\n","originalDockerfileUglifiedHash":"8027ed1d6fc6222808b5a657ee226f69","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/eb84df9d9846fb914a0b8c37fdd56d820f6fb294.dockerfile"}