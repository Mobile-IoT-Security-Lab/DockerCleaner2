{"seed":1242132563,"processedDockerfileHash":"ea58cd3e4beeef010294eb703d239808","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","pin-package-manager-versions-npm","pin-package-manager-versions-gem","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM phusion/baseimage:0.9.18\nENV DEBIAN_FRONTEND=\"noninteractive\"\nRUN apt-get update \\\n && rm -f /etc/service/sshd/down \\\n && locale-gen en_US.UTF-8 \\\n && locale-gen nl_BE.UTF-8 \\\n && locale-gen nl_NL.UTF-8 \\\n && locale-gen de_DE.UTF-8 \\\n && locale-gen fr_FR.UTF-8 \\\n && dpkg-reconfigure locales \\\n && export LANG=en_US.UTF-8 \\\n && apt-get install --no-install-recommends nano wget curl python htop git locate zip unzip telnet zsh python-software-properties software-properties-common build-essential libpcre3-dev nodejs npm ant -y \\\n && add-apt-repository -y ppa:ondrej/php5-5.6 \\\n && add-apt-repository -y ppa:brightbox/ruby-ng \\\n && apt-get update \\\n && apt-get dist-upgrade -y \\\n && apt-get install --no-install-recommends php5-cli php5-fpm php5-mysql php5-pgsql php5-sqlite php5-curl php5-gd php5-gmp php5-mcrypt php5-intl php5-dev php5-xsl php5-imap php5-ldap php5-imagick php5-memcache php5-memcached php-pear xvfb libsqlite3-dev ruby2.2 ruby2.2-dev libxext6 xfonts-75dpi fontconfig libxrender1 xfonts-base -y\nRUN yes '' | pecl install xdebug \\\n && yes '' | pecl install apcu-4.0.7\n#   Fix php session dir and error log\nRUN mkdir -p /var/lib/php5/sessions \\\n && chown -R www-data:www-data /var/lib/php5/sessions \\\n && chmod 0777 -R /var/lib/php5/sessions/ \\\n && mkdir -p /var/log/php/ \\\n && touch /var/log/php/error.log \\\n && chmod 0755 /var/log/php/error.log \\\n && chown -R www-data:www-data /var/log/php/ \\\n && chmod 0777 -R /var/log/php/\n#   Install ruby dependencies\nRUN ruby -v \\\n && gem install mailcatcher --version 0.8.2 --no-ri --no-rdoc \\\n && gem list\nENV HOME=\"/root\"\n#   PHP module configs\nCOPY conf/mods-available/apcu.ini /etc/php5/mods-available/apcu.ini\nCOPY conf/mods-available/xdebug.ini /etc/php5/mods-available/xdebug.ini\nCOPY conf/mods-available/mailcatcher.ini /etc/php5/mods-available/mailcatcher.ini\nRUN php5dismod xdebug \\\n && php5dismod mailcatcher \\\n && php5dismod apcu\n#   Composer + PHPUnit + Phing\nRUN curl -sS https://getcomposer.org/installer | php \\\n && mv composer.phar /usr/local/bin/composer \\\n && composer config -g github-oauth.github.com aeff6491f52163a011cba0b6b6286f5492e25ab6 \\\n && wget -qq -O phpunit.phar https://phar.phpunit.de/phpunit.phar \\\n && chmod +x phpunit.phar \\\n && mv phpunit.phar /usr/local/bin/phpunit \\\n && wget -qq -O phing.phar http://www.phing.info/get/phing-latest.phar \\\n && chmod +x phing.phar \\\n && mv phing.phar /usr/local/bin/phing \\\n && php -v \\\n && phpunit --version \\\n && phing -v\n#   Npm + Bower + grunt\nRUN npm install bower@1.8.14 grunt@1.6.1 grunt-cli@1.4.3 -g \\\n && ln -s /usr/bin/nodejs /usr/bin/node \\\n && bower -version \\\n && grunt --version\nRUN chown -R www-data ~/.npm\n#   WKHTMLTOPDF\nRUN wget -qq http://download.gna.org/wkhtmltopdf/0.12/0.12.2.1/wkhtmltox-0.12.2.1_linux-trusty-amd64.deb \\\n && dpkg -i wkhtmltox-0.12.2.1_linux-trusty-amd64.deb \\\n && apt-get install --no-install-recommends -f -y \\\n && apt-get install --no-install-recommends xvfb -y \\\n && echo 'xvfb-run --server-args=\"-screen 0, 1024x768x24\" /usr/local/bin/wkhtmltopdf $*' > /usr/bin/wkhtmltopdf.sh \\\n && chmod a+rx /usr/bin/wkhtmltopdf.sh \\\n && sudo ln -s /usr/bin/wkhtmltopdf.sh /usr/bin/wkhtmltopdf \\\n && wkhtmltopdf --version\nRUN sed -i \"s/;date.timezone =.*/date.timezone = UTC/\" /etc/php5/fpm/php.ini \\\n && sed -i \"s/;date.timezone =.*/date.timezone = UTC/\" /etc/php5/cli/php.ini \\\n && sed -i \"s/;cgi.fix_pathinfo=1/cgi.fix_pathinfo=0/\" /etc/php5/fpm/php.ini \\\n && sed -i \"s/;cgi.fix_pathinfo=1/cgi.fix_pathinfo=0/\" /etc/php5/cli/php.ini \\\n && sed -i \"s/short_open_tag.*=.*/short_open_tag = On/\" /etc/php5/fpm/php.ini \\\n && sed -i \"s/short_open_tag.*=.*/short_open_tag = On/\" /etc/php5/cli/php.ini \\\n && sed -i -e \"s/;daemonize\\s*=\\s*yes/daemonize = no/g\" /etc/php5/fpm/php-fpm.conf\nRUN sudo curl -LsS https://symfony.com/installer -o /usr/local/bin/symfony \\\n && sudo chmod a+x /usr/local/bin/symfony \\\n && symfony --version\nRUN apt-get clean \\\n && apt-get autoremove -y \\\n && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*\nENV TERM=\"xterm\"\nENV PHP_ENV=\"production\"\nENV PHP_APCU_ENABLED=\"false\"\nENV PHP_XDEBUG_ENABLED=\"false\"\nENV PHP_MAILCATCHER_ENABLED=\"false\"\n#   Allow su www-data\nCOPY conf/dot-bash-rc /home/www-data/.bashrc\nRUN chsh -s /bin/bash www-data \\\n && groupmod -g 1000 www-data \\\n && usermod -u 1000 www-data \\\n && chown -vR 1000:1000 /home/www-data \\\n && usermod -d /home/www-data/ www-data\n#   Runit/init\nCOPY my_init.d /etc/my_init.d\nCOPY runit/php /etc/service/php/run\n#   XDebug/ssh port\nEXPOSE 9000/tcp\nEXPOSE 22/tcp\nVOLUME /app\nWORKDIR /app\nCMD [\"/sbin/my_init\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM phusion/baseimage:0.9.18\nENV DEBIAN_FRONTEND=\"noninteractive\"\nRUN apt-get update \\\n && rm -f /etc/service/sshd/down \\\n && locale-gen en_US.UTF-8 \\\n && locale-gen nl_BE.UTF-8 \\\n && locale-gen nl_NL.UTF-8 \\\n && locale-gen de_DE.UTF-8 \\\n && locale-gen fr_FR.UTF-8 \\\n && dpkg-reconfigure locales \\\n && export LANG=en_US.UTF-8 \\\n && apt-get install nano wget curl python htop git locate zip unzip telnet zsh python-software-properties software-properties-common build-essential libpcre3-dev nodejs npm ant -y \\\n && add-apt-repository -y ppa:ondrej/php5-5.6 \\\n && add-apt-repository -y ppa:brightbox/ruby-ng \\\n && apt-get update \\\n && apt-get dist-upgrade -y \\\n && apt-get install php5-cli php5-fpm php5-mysql php5-pgsql php5-sqlite php5-curl php5-gd php5-gmp php5-mcrypt php5-intl php5-dev php5-xsl php5-imap php5-ldap php5-imagick php5-memcache php5-memcached php-pear xvfb libsqlite3-dev ruby2.2 ruby2.2-dev libxext6 xfonts-75dpi fontconfig libxrender1 xfonts-base -y\nRUN yes '' | pecl install xdebug \\\n && yes '' | pecl install apcu-4.0.7\n#  Fix php session dir and error log\nRUN mkdir -p /var/lib/php5/sessions \\\n && chown -R www-data:www-data /var/lib/php5/sessions \\\n && chmod 0777 -R /var/lib/php5/sessions/ \\\n && mkdir -p /var/log/php/ \\\n && touch /var/log/php/error.log \\\n && chmod 0755 /var/log/php/error.log \\\n && chown -R www-data:www-data /var/log/php/ \\\n && chmod 0777 -R /var/log/php/\n#  Install ruby dependencies\nRUN ruby -v \\\n && gem install mailcatcher --no-ri --no-rdoc \\\n && gem list\nENV HOME=\"/root\"\n#  PHP module configs\nADD conf/mods-available/apcu.ini /etc/php5/mods-available/apcu.ini\nADD conf/mods-available/xdebug.ini /etc/php5/mods-available/xdebug.ini\nADD conf/mods-available/mailcatcher.ini /etc/php5/mods-available/mailcatcher.ini\nRUN php5dismod xdebug \\\n && php5dismod mailcatcher \\\n && php5dismod apcu\n#  Composer + PHPUnit + Phing\nRUN curl -sS https://getcomposer.org/installer | php \\\n && mv composer.phar /usr/local/bin/composer \\\n && composer config -g github-oauth.github.com aeff6491f52163a011cba0b6b6286f5492e25ab6 \\\n && wget -qq -O phpunit.phar https://phar.phpunit.de/phpunit.phar \\\n && chmod +x phpunit.phar \\\n && mv phpunit.phar /usr/local/bin/phpunit \\\n && wget -qq -O phing.phar http://www.phing.info/get/phing-latest.phar \\\n && chmod +x phing.phar \\\n && mv phing.phar /usr/local/bin/phing \\\n && php -v \\\n && phpunit --version \\\n && phing -v\n#  Npm + Bower + grunt\nRUN npm install bower grunt grunt-cli -g \\\n && ln -s /usr/bin/nodejs /usr/bin/node \\\n && bower -version \\\n && grunt --version\nRUN chown -R www-data ~/.npm\n#  WKHTMLTOPDF\nRUN wget -qq http://download.gna.org/wkhtmltopdf/0.12/0.12.2.1/wkhtmltox-0.12.2.1_linux-trusty-amd64.deb \\\n && dpkg -i wkhtmltox-0.12.2.1_linux-trusty-amd64.deb \\\n && apt-get install -f -y \\\n && apt-get install xvfb -y \\\n && echo 'xvfb-run --server-args=\"-screen 0, 1024x768x24\" /usr/local/bin/wkhtmltopdf $*' > /usr/bin/wkhtmltopdf.sh \\\n && chmod a+rx /usr/bin/wkhtmltopdf.sh \\\n && sudo ln -s /usr/bin/wkhtmltopdf.sh /usr/bin/wkhtmltopdf \\\n && wkhtmltopdf --version\nRUN sed -i \"s/;date.timezone =.*/date.timezone = UTC/\" /etc/php5/fpm/php.ini \\\n && sed -i \"s/;date.timezone =.*/date.timezone = UTC/\" /etc/php5/cli/php.ini \\\n && sed -i \"s/;cgi.fix_pathinfo=1/cgi.fix_pathinfo=0/\" /etc/php5/fpm/php.ini \\\n && sed -i \"s/;cgi.fix_pathinfo=1/cgi.fix_pathinfo=0/\" /etc/php5/cli/php.ini \\\n && sed -i \"s/short_open_tag.*=.*/short_open_tag = On/\" /etc/php5/fpm/php.ini \\\n && sed -i \"s/short_open_tag.*=.*/short_open_tag = On/\" /etc/php5/cli/php.ini \\\n && sed -i -e \"s/;daemonize\\s*=\\s*yes/daemonize = no/g\" /etc/php5/fpm/php-fpm.conf\nRUN sudo curl -LsS https://symfony.com/installer -o /usr/local/bin/symfony \\\n && sudo chmod a+x /usr/local/bin/symfony \\\n && symfony --version\nRUN apt-get clean \\\n && apt-get autoremove -y \\\n && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*\nENV TERM=\"xterm\"\nENV PHP_ENV=\"production\"\nENV PHP_APCU_ENABLED=\"false\"\nENV PHP_XDEBUG_ENABLED=\"false\"\nENV PHP_MAILCATCHER_ENABLED=\"false\"\n#  Allow su www-data\nADD conf/dot-bash-rc /home/www-data/.bashrc\nRUN chsh -s /bin/bash www-data \\\n && groupmod -g 1000 www-data \\\n && usermod -u 1000 www-data \\\n && chown -vR 1000:1000 /home/www-data \\\n && usermod -d /home/www-data/ www-data\n#  Runit/init\nADD my_init.d /etc/my_init.d\nADD runit/php /etc/service/php/run\n#  XDebug/ssh port\nEXPOSE 9000/tcp\nEXPOSE 22/tcp\nVOLUME /app\nWORKDIR /app\nCMD [\"/sbin/my_init\"]\n","injectedSmells":[],"originalDockerfileHash":"625a57e5c9294a9dba11382c4a097053","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM phusion/baseimage:0.9.18\nENV DEBIAN_FRONTEND=\"noninteractive\"\nRUN apt-get update \\\n && rm -f /etc/service/sshd/down \\\n && locale-gen en_US.UTF-8 \\\n && locale-gen nl_BE.UTF-8 \\\n && locale-gen nl_NL.UTF-8 \\\n && locale-gen de_DE.UTF-8 \\\n && locale-gen fr_FR.UTF-8 \\\n && dpkg-reconfigure locales \\\n && export LANG=en_US.UTF-8 \\\n && apt-get install nano wget curl python htop git locate zip unzip telnet zsh python-software-properties software-properties-common build-essential libpcre3-dev nodejs npm ant -y \\\n && add-apt-repository -y ppa:ondrej/php5-5.6 \\\n && add-apt-repository -y ppa:brightbox/ruby-ng \\\n && apt-get update \\\n && apt-get dist-upgrade -y \\\n && apt-get install php5-cli php5-fpm php5-mysql php5-pgsql php5-sqlite php5-curl php5-gd php5-gmp php5-mcrypt php5-intl php5-dev php5-xsl php5-imap php5-ldap php5-imagick php5-memcache php5-memcached php-pear xvfb libsqlite3-dev ruby2.2 ruby2.2-dev libxext6 xfonts-75dpi fontconfig libxrender1 xfonts-base -y\nRUN yes '' | pecl install xdebug \\\n && yes '' | pecl install apcu-4.0.7\n#   Fix php session dir and error log\nRUN mkdir -p /var/lib/php5/sessions \\\n && chown -R www-data:www-data /var/lib/php5/sessions \\\n && chmod 0777 -R /var/lib/php5/sessions/ \\\n && mkdir -p /var/log/php/ \\\n && touch /var/log/php/error.log \\\n && chmod 0755 /var/log/php/error.log \\\n && chown -R www-data:www-data /var/log/php/ \\\n && chmod 0777 -R /var/log/php/\n#   Install ruby dependencies\nRUN ruby -v \\\n && gem install mailcatcher --no-ri --no-rdoc \\\n && gem list\nENV HOME=\"/root\"\n#   PHP module configs\nADD conf/mods-available/apcu.ini /etc/php5/mods-available/apcu.ini\nADD conf/mods-available/xdebug.ini /etc/php5/mods-available/xdebug.ini\nADD conf/mods-available/mailcatcher.ini /etc/php5/mods-available/mailcatcher.ini\nRUN php5dismod xdebug \\\n && php5dismod mailcatcher \\\n && php5dismod apcu\n#   Composer + PHPUnit + Phing\nRUN curl -sS https://getcomposer.org/installer | php \\\n && mv composer.phar /usr/local/bin/composer \\\n && composer config -g github-oauth.github.com aeff6491f52163a011cba0b6b6286f5492e25ab6 \\\n && wget -qq -O phpunit.phar https://phar.phpunit.de/phpunit.phar \\\n && chmod +x phpunit.phar \\\n && mv phpunit.phar /usr/local/bin/phpunit \\\n && wget -qq -O phing.phar http://www.phing.info/get/phing-latest.phar \\\n && chmod +x phing.phar \\\n && mv phing.phar /usr/local/bin/phing \\\n && php -v \\\n && phpunit --version \\\n && phing -v\n#   Npm + Bower + grunt\nRUN npm install bower grunt grunt-cli -g \\\n && ln -s /usr/bin/nodejs /usr/bin/node \\\n && bower -version \\\n && grunt --version\nRUN chown -R www-data ~/.npm\n#   WKHTMLTOPDF\nRUN wget -qq http://download.gna.org/wkhtmltopdf/0.12/0.12.2.1/wkhtmltox-0.12.2.1_linux-trusty-amd64.deb \\\n && dpkg -i wkhtmltox-0.12.2.1_linux-trusty-amd64.deb \\\n && apt-get install -f -y \\\n && apt-get install xvfb -y \\\n && echo 'xvfb-run --server-args=\"-screen 0, 1024x768x24\" /usr/local/bin/wkhtmltopdf $*' > /usr/bin/wkhtmltopdf.sh \\\n && chmod a+rx /usr/bin/wkhtmltopdf.sh \\\n && sudo ln -s /usr/bin/wkhtmltopdf.sh /usr/bin/wkhtmltopdf \\\n && wkhtmltopdf --version\nRUN sed -i \"s/;date.timezone =.*/date.timezone = UTC/\" /etc/php5/fpm/php.ini \\\n && sed -i \"s/;date.timezone =.*/date.timezone = UTC/\" /etc/php5/cli/php.ini \\\n && sed -i \"s/;cgi.fix_pathinfo=1/cgi.fix_pathinfo=0/\" /etc/php5/fpm/php.ini \\\n && sed -i \"s/;cgi.fix_pathinfo=1/cgi.fix_pathinfo=0/\" /etc/php5/cli/php.ini \\\n && sed -i \"s/short_open_tag.*=.*/short_open_tag = On/\" /etc/php5/fpm/php.ini \\\n && sed -i \"s/short_open_tag.*=.*/short_open_tag = On/\" /etc/php5/cli/php.ini \\\n && sed -i -e \"s/;daemonize\\s*=\\s*yes/daemonize = no/g\" /etc/php5/fpm/php-fpm.conf\nRUN sudo curl -LsS https://symfony.com/installer -o /usr/local/bin/symfony \\\n && sudo chmod a+x /usr/local/bin/symfony \\\n && symfony --version\nRUN apt-get clean \\\n && apt-get autoremove -y \\\n && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*\nENV TERM=\"xterm\"\nENV PHP_ENV=\"production\"\nENV PHP_APCU_ENABLED=\"false\"\nENV PHP_XDEBUG_ENABLED=\"false\"\nENV PHP_MAILCATCHER_ENABLED=\"false\"\n#   Allow su www-data\nADD conf/dot-bash-rc /home/www-data/.bashrc\nRUN chsh -s /bin/bash www-data \\\n && groupmod -g 1000 www-data \\\n && usermod -u 1000 www-data \\\n && chown -vR 1000:1000 /home/www-data \\\n && usermod -d /home/www-data/ www-data\n#   Runit/init\nADD my_init.d /etc/my_init.d\nADD runit/php /etc/service/php/run\n#   XDebug/ssh port\nEXPOSE 9000/tcp\nEXPOSE 22/tcp\nVOLUME /app\nWORKDIR /app\nCMD [\"/sbin/my_init\"]\n","originalDockerfileUglifiedHash":"26943be397c5550e5e99ed0cc9ce44a6","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/f65282e33adea86915506158dd114ab6215a1072.dockerfile"}