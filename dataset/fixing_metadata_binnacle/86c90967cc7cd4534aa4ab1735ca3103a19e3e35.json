{"seed":3341770134,"processedDockerfileHash":"5337043b08a7548ebd5bfe725a11f9ab","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apt-get","have-a-healthcheck","have-a-user"],"processedDockerfile":"#   Build target: lablup/common-tensorflow:1.5-py36\nFROM ubuntu:18.04\nLABEL maintainer=\"Mario Cho <m.cho@lablup.com>\"\n#   The TensorFlow version\nENV TF_VERSION=\"r1.5\"\nENV BAZEL_VERSION=\"0.11.0\"\nENV PYTHON_BIN_PATH=\"/usr/bin/python\"\nENV PYTHON_LIB_PATH=\"/usr/local/lib/python3.6/site-packages \"\nENV GCC_HOST_COMPILER_PATH=\"/usr/bin/gcc \"\nENV CC_OPT_FLAGS=\"\\\"-march=x86-64 -mavx -mavx2 -mfma -mfpmath=both -msse4.1 -msse4.2\\\" \"\nENV TF_NEED_JEMALLOC=\"1\"\nENV TF_NEED_GCP=\"1\"\nENV TF_NEED_HDFS=\"1\"\nENV TF_NEED_VERBS=\"0\"\nENV TF_NEED_MPI=\"0\"\nENV TF_NEED_GDR=\"0\"\nENV TF_NEED_S3=\"1 \"\nENV TF_NEED_KAFKA=\"0 \"\n#   Install system package dependencies\n#   NOTE: running bazel requires JDK, not JRE!\nRUN apt-get update \\\n && apt-get install --no-install-recommends openjdk-8-jdk-headless=8u362-ga-0ubuntu1~18.04.1 -y \\\n && apt-get install --no-install-recommends gcc=4:7.4.0-1ubuntu2.3 g++=4:7.4.0-1ubuntu2.3 make=4.1-9.1ubuntu1 libssl-dev=1.1.1-1ubuntu2.1~18.04.21 libfreetype6-dev=2.8.1-2ubuntu2.2 libhdf5-serial-dev=1.10.0-patch1+docs-4 libzmq3-dev=4.2.5-1ubuntu0.2 pkg-config=0.29.1-0ubuntu2 rsync=3.1.2-2.1ubuntu1.6 software-properties-common=0.96.24.32.20 zip=3.0-11build1 unzip=6.0-21ubuntu1.2 zlib1g-dev=1:1.2.11.dfsg-0ubuntu2.2 wget=1.19.4-1ubuntu2.2 imagemagick=8:6.9.7.4+dfsg-16ubuntu6.15 graphviz=2.40.1-2 cmake=3.10.2-1ubuntu2.18.04.2 curl=7.58.0-2ubuntu3.24 wget=1.19.4-1ubuntu2.2 rsync=3.1.2-2.1ubuntu1.6 sed=4.4-2 swig=3.0.12-1 git-core libcurl3-dev zip=3.0-11build1 -y \\\n && rm -rf /var/lib/apt/lists/*\n#  install Python 3\nRUN curl https://www.python.org/ftp/python/3.6.8/Python-3.6.8.tar.xz -o /opt/python.tar.xz \\\n && cd /opt \\\n && tar xvf python.tar.xz \\\n && cd /opt/*/ \\\n && ./configure \\\n && make \\\n && make install \\\n && ln -s -f /usr/local/bin/python3.6 /usr/bin/python\nRUN curl -fSsL -O https://bootstrap.pypa.io/get-pip.py \\\n && python get-pip.py \\\n && rm get-pip.py\n#   Check Bazel/Python is runnable.\nRUN bazel version ; python -c \"import sys; print(sys.prefix); print(sys.version_info)\"\n#   Prepare for building TensorFlwo wheel\nRUN python -m pip install -U setuptools pip \\\n && python -m pip install --no-cache-dir wheel numpy scipy keras_applications keras_preprocessing \\\n && rm -f /tmp/*.whl\nRUN mkdir /bazel \\\n && cd /bazel \\\n && curl -H \"User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.2987.133 Safari/537.36\" -fSsL -O https://github.com/bazelbuild/bazel/releases/download/$BAZEL_VERSION/bazel-$BAZEL_VERSION-installer-linux-x86_64.sh \\\n && curl -H \"User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.2987.133 Safari/537.36\" -fSsL -o /bazel/LICENSE.txt https://raw.githubusercontent.com/bazelbuild/bazel/master/LICENSE \\\n && chmod +x bazel-*.sh \\\n && ./bazel-$BAZEL_VERSION-installer-linux-x86_64.sh \\\n && cd / \\\n && rm -f /bazel/bazel-$BAZEL_VERSION-installer-linux-x86_64.sh\n#   NOTE: python should be linked to python3\nRUN : build TensorFlow pip package \\\n && cd /tmp \\\n && git clone --branch=${TF_VERSION} --depth=1 https://github.com/tensorflow/tensorflow.git tensorflow-${TF_VERSION} \\\n && ldconfig\nRUN cd /tmp/tensorflow-${TF_VERSION} \\\n && CC_OPT_FLAGS=\"-march=x86-64 -mavx -mavx2 -mfma -mfpmath=both -msse4.1 -msse4.2\" tensorflow/tools/ci_build/builds/configured CPU bazel build --config=opt --config=mkl --cxxopt=\"-D_GLIBCXX_USE_CXX11_ABI=0\" //tensorflow/tools/pip_package:build_pip_package \\\n && ./bazel-bin/tensorflow/tools/pip_package/build_pip_package /tmp/tensorflow_pkg\nRUN ls -l /tmp/tensorflow_pkg\n#   vim: ft=dockerfile sts=4 sw=4 et tw=0\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  Build target: lablup/common-tensorflow:1.5-py36\nFROM ubuntu:18.04\nLABEL maintainer=\"Mario Cho <m.cho@lablup.com>\"\n#  The TensorFlow version\nENV TF_VERSION=\"r1.5\"\nENV BAZEL_VERSION=\"0.11.0\"\nENV PYTHON_BIN_PATH=\"/usr/bin/python\"\nENV PYTHON_LIB_PATH=\"/usr/local/lib/python3.6/site-packages \"\nENV GCC_HOST_COMPILER_PATH=\"/usr/bin/gcc \"\nENV CC_OPT_FLAGS=\"\\\"-march=x86-64 -mavx -mavx2 -mfma -mfpmath=both -msse4.1 -msse4.2\\\" \"\nENV TF_NEED_JEMALLOC=\"1\"\nENV TF_NEED_GCP=\"1\"\nENV TF_NEED_HDFS=\"1\"\nENV TF_NEED_VERBS=\"0\"\nENV TF_NEED_MPI=\"0\"\nENV TF_NEED_GDR=\"0\"\nENV TF_NEED_S3=\"1 \"\nENV TF_NEED_KAFKA=\"0 \"\n#  Install system package dependencies\n#  NOTE: running bazel requires JDK, not JRE!\nRUN apt-get update \\\n && apt-get install --no-install-recommends openjdk-8-jdk-headless -y \\\n && apt-get install --no-install-recommends gcc g++ make libssl-dev libfreetype6-dev libhdf5-serial-dev libzmq3-dev pkg-config rsync software-properties-common zip unzip zlib1g-dev wget imagemagick graphviz cmake curl wget rsync sed swig git-core libcurl3-dev zip -y \\\n && rm -rf /var/lib/apt/lists/*\n# install Python 3\nRUN curl https://www.python.org/ftp/python/3.6.8/Python-3.6.8.tar.xz -o /opt/python.tar.xz \\\n && cd /opt \\\n && tar xvf python.tar.xz \\\n && cd /opt/*/ \\\n && ./configure \\\n && make \\\n && make install \\\n && ln -s -f /usr/local/bin/python3.6 /usr/bin/python\nRUN curl -fSsL -O https://bootstrap.pypa.io/get-pip.py \\\n && python get-pip.py \\\n && rm get-pip.py\n#  Check Bazel/Python is runnable.\nRUN bazel version ; python -c \"import sys; print(sys.prefix); print(sys.version_info)\"\n#  Prepare for building TensorFlwo wheel\nRUN python -m pip install -U setuptools pip \\\n && python -m pip install --no-cache-dir wheel numpy scipy keras_applications keras_preprocessing \\\n && rm -f /tmp/*.whl\nRUN mkdir /bazel \\\n && cd /bazel \\\n && curl -H \"User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.2987.133 Safari/537.36\" -fSsL -O https://github.com/bazelbuild/bazel/releases/download/$BAZEL_VERSION/bazel-$BAZEL_VERSION-installer-linux-x86_64.sh \\\n && curl -H \"User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.2987.133 Safari/537.36\" -fSsL -o /bazel/LICENSE.txt https://raw.githubusercontent.com/bazelbuild/bazel/master/LICENSE \\\n && chmod +x bazel-*.sh \\\n && ./bazel-$BAZEL_VERSION-installer-linux-x86_64.sh \\\n && cd / \\\n && rm -f /bazel/bazel-$BAZEL_VERSION-installer-linux-x86_64.sh\n#  NOTE: python should be linked to python3\nRUN : build TensorFlow pip package \\\n && cd /tmp \\\n && git clone --branch=${TF_VERSION} --depth=1 https://github.com/tensorflow/tensorflow.git tensorflow-${TF_VERSION} \\\n && ldconfig\nRUN cd /tmp/tensorflow-${TF_VERSION} \\\n && CC_OPT_FLAGS=\"-march=x86-64 -mavx -mavx2 -mfma -mfpmath=both -msse4.1 -msse4.2\" tensorflow/tools/ci_build/builds/configured CPU bazel build --config=opt --config=mkl --cxxopt=\"-D_GLIBCXX_USE_CXX11_ABI=0\" //tensorflow/tools/pip_package:build_pip_package \\\n && ./bazel-bin/tensorflow/tools/pip_package/build_pip_package /tmp/tensorflow_pkg\nRUN ls -l /tmp/tensorflow_pkg\n#  vim: ft=dockerfile sts=4 sw=4 et tw=0\n","injectedSmells":[],"originalDockerfileHash":"031a02a1a1cebc66a96f9857c72f5d96","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   Build target: lablup/common-tensorflow:1.5-py36\nFROM ubuntu:18.04\nLABEL maintainer=\"Mario Cho <m.cho@lablup.com>\"\n#   The TensorFlow version\nENV TF_VERSION=\"r1.5\"\nENV BAZEL_VERSION=\"0.11.0\"\nENV PYTHON_BIN_PATH=\"/usr/bin/python\"\nENV PYTHON_LIB_PATH=\"/usr/local/lib/python3.6/site-packages \"\nENV GCC_HOST_COMPILER_PATH=\"/usr/bin/gcc \"\nENV CC_OPT_FLAGS=\"\\\"-march=x86-64 -mavx -mavx2 -mfma -mfpmath=both -msse4.1 -msse4.2\\\" \"\nENV TF_NEED_JEMALLOC=\"1\"\nENV TF_NEED_GCP=\"1\"\nENV TF_NEED_HDFS=\"1\"\nENV TF_NEED_VERBS=\"0\"\nENV TF_NEED_MPI=\"0\"\nENV TF_NEED_GDR=\"0\"\nENV TF_NEED_S3=\"1 \"\nENV TF_NEED_KAFKA=\"0 \"\n#   Install system package dependencies\n#   NOTE: running bazel requires JDK, not JRE!\nRUN apt-get update \\\n && apt-get install --no-install-recommends openjdk-8-jdk-headless -y \\\n && apt-get install --no-install-recommends gcc g++ make libssl-dev libfreetype6-dev libhdf5-serial-dev libzmq3-dev pkg-config rsync software-properties-common zip unzip zlib1g-dev wget imagemagick graphviz cmake curl wget rsync sed swig git-core libcurl3-dev zip -y \\\n && rm -rf /var/lib/apt/lists/*\n#  install Python 3\nRUN curl https://www.python.org/ftp/python/3.6.8/Python-3.6.8.tar.xz -o /opt/python.tar.xz \\\n && cd /opt \\\n && tar xvf python.tar.xz \\\n && cd /opt/*/ \\\n && ./configure \\\n && make \\\n && make install \\\n && ln -s -f /usr/local/bin/python3.6 /usr/bin/python\nRUN curl -fSsL -O https://bootstrap.pypa.io/get-pip.py \\\n && python get-pip.py \\\n && rm get-pip.py\n#   Check Bazel/Python is runnable.\nRUN bazel version ; python -c \"import sys; print(sys.prefix); print(sys.version_info)\"\n#   Prepare for building TensorFlwo wheel\nRUN python -m pip install -U setuptools pip \\\n && python -m pip install --no-cache-dir wheel numpy scipy keras_applications keras_preprocessing \\\n && rm -f /tmp/*.whl\nRUN mkdir /bazel \\\n && cd /bazel \\\n && curl -H \"User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.2987.133 Safari/537.36\" -fSsL -O https://github.com/bazelbuild/bazel/releases/download/$BAZEL_VERSION/bazel-$BAZEL_VERSION-installer-linux-x86_64.sh \\\n && curl -H \"User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/57.0.2987.133 Safari/537.36\" -fSsL -o /bazel/LICENSE.txt https://raw.githubusercontent.com/bazelbuild/bazel/master/LICENSE \\\n && chmod +x bazel-*.sh \\\n && ./bazel-$BAZEL_VERSION-installer-linux-x86_64.sh \\\n && cd / \\\n && rm -f /bazel/bazel-$BAZEL_VERSION-installer-linux-x86_64.sh\n#   NOTE: python should be linked to python3\nRUN : build TensorFlow pip package \\\n && cd /tmp \\\n && git clone --branch=${TF_VERSION} --depth=1 https://github.com/tensorflow/tensorflow.git tensorflow-${TF_VERSION} \\\n && ldconfig\nRUN cd /tmp/tensorflow-${TF_VERSION} \\\n && CC_OPT_FLAGS=\"-march=x86-64 -mavx -mavx2 -mfma -mfpmath=both -msse4.1 -msse4.2\" tensorflow/tools/ci_build/builds/configured CPU bazel build --config=opt --config=mkl --cxxopt=\"-D_GLIBCXX_USE_CXX11_ABI=0\" //tensorflow/tools/pip_package:build_pip_package \\\n && ./bazel-bin/tensorflow/tools/pip_package/build_pip_package /tmp/tensorflow_pkg\nRUN ls -l /tmp/tensorflow_pkg\n#   vim: ft=dockerfile sts=4 sw=4 et tw=0\n","originalDockerfileUglifiedHash":"730c1968fab3594f1737342fc40cc2fa","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/86c90967cc7cd4534aa4ab1735ca3103a19e3e35.dockerfile"}