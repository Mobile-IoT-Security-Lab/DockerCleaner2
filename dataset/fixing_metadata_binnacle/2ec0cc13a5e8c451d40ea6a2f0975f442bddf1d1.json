{"seed":582315041,"processedDockerfileHash":"c0aab672a4643f1759d9f4cf7354e9a3","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM oso-rhel7-ops-base:latest\n#       ___ ___ _  _ ___ ___    _ _____ ___ ___         \n#      / __| __| \\| | __| _ \\  /_\\_   _| __|   \\        \n#     | (_ | _|| .` | _||   / / _ \\| | | _|| |) |       \n#      \\___|___|_|\\_|___|_|_\\/_/_\\_\\_|_|___|___/_ _____ \n#     |   \\ / _ \\  | \\| |/ _ \\_   _| | __|   \\_ _|_   _|\n#     | |) | (_) | | .` | (_) || |   | _|| |) | |  | |  \n#     |___/ \\___/  |_|\\_|\\___/ |_|   |___|___/___| |_|  \n#   \n#   Pause indefinitely if asked to do so.\nARG OO_PAUSE_ON_BUILD\nRUN test \"$OO_PAUSE_ON_BUILD\" = \"true\" \\\n && while sleep 10 ; do true ; done || :\n#   PCP\n#  #################\n#   install pcp-collector and it's dependencies, clean the cache.\nRUN yum-install-check.sh -y pcp pcp-conf pcp-collector xz \\\n && yum clean all\n#   Run in the container as root - avoids PCP_USER mismatches\nRUN sed -i -e 's/PCP_USER=.*$/PCP_USER=root/' -e 's/PCP_GROUP=.*$/PCP_GROUP=root/' /etc/pcp.conf\n#   Disable service advertising - no avahi daemon in the container\n#   (dodges warnings from pmcd attempting to connect during startup)\nRUN . /etc/pcp.conf \\\n && echo \"-A\" >> $PCP_PMCDOPTIONS_PATH\n#   denote this as a container environment, for rc scripts\nENV PCP_CONTAINER_IMAGE=\"pcp-collector\"\nENV NAME=\"pcp-collector\"\nENV IMAGE=\"pcp-collector\"\nENV PATH=\"/usr/share/pcp/lib:/usr/libexec/pcp/bin:$PATH\"\n#   script to watch health of pmcd\nCOPY check-pmcd-status.sh /usr/local/bin/check-pmcd-status.sh\n#  #################\n#   /usr/bin/oc workaround\n#   python-openshift-tools-monitoring-openshift depends on /usr/bin/oc\n#   since origin-clients and atomic-openshift-clients provide the binary\n#   for Origin/OpenShift respectively. yum isn't happy that a package named 'openshift'\n#   used to provide /usr/bin/oc, and 'openshift' has been replaced by\n#   'atomic-openshift', but 'atomic-openshift' doesn't provide /usr/bin/oc.\n#   So just install atomic-openshift-clients before python-openshift-tools-monitoring-openshift\n#   until the yum repo is cleared of the older packages.\nRUN yum-install-check.sh -y atomic-openshift-clients openshift-hypercc \\\n && yum clean metadata\n#   Add google-cloud-sdk repo\nCOPY google-cloud-sdk.repo /etc/yum.repos.d/\nRUN yum clean metadata \\\n && yum-install-check.sh -y python2-pip pcp pcp-conf pcp-testsuite python-requests pyOpenSSL python-openshift-tools python-openshift-tools-monitoring-pcp python-openshift-tools-monitoring-docker python-openshift-tools-monitoring-zagg python-openshift-tools-monitoring-openshift python-openshift-tools-ansible python-openshift-tools-web openshift-tools-scripts-cloud-aws openshift-tools-scripts-cloud-gcp openshift-tools-scripts-monitoring-pcp openshift-tools-scripts-monitoring-docker openshift-tools-scripts-monitoring-aws openshift-tools-scripts-monitoring-gcp openshift-tools-scripts-monitoring-openshift openshift-tools-scripts-monitoring-autoheal pcp-manager pcp-webapi python-pcp python-httplib2 python2-pyasn1 python2-pyasn1-modules python2-rsa python-configobj python2-psutil pylint tito python-devel libyaml-devel oso-simplesamlphp python2-ruamel-yaml rpm-sign createrepo python2-boto3 python-lxml rkhunter python-hawkular-client python-docker \\\n && yum-install-check.sh -y google-cloud-sdk python2-uritemplate python2-google-api-client python2-oauth2client --disablerepo=\"rhel-server-releases-optional\" --enablerepo=\"google-cloud-sdk\" \\\n && yum clean all\nCOPY urllib3-connectionpool-patch /root/\nRUN yum-install-check.sh -y patch \\\n && yum clean all \\\n && cd /usr/lib/python2.7/site-packages/ \\\n && patch -p1 < /root/urllib3-connectionpool-patch\n#   make mount points for security update count check, and make a circular symlink because yum is dumb about its root\nRUN mkdir -p /host /var/local/hostpkg/etc/rhsm/ca /var/local/hostpkg/etc/rpm /var/local/hostpkg/etc/pki/entitlement /var/local/hostpkg/etc/pki/rpm-gpg /var/local/hostpkg/var/local /var/local/hostpkg/var/cache/yum /var/local/hostpkg/var/lib/yum \\\n && ln -s /var/local/hostpkg /var/local/hostpkg/var/local/hostpkg\n#   Make mount points for rkhunter files, and configure rkhunter to work with this structure\nRUN mkdir -p /var/local/rkhunter_chroot /var/local/rkhunter_tmp /var/local/rkhunter_tmp/rkhunter /var/local/rkhunter_tmp/rkhunter/bin /var/local/rkhunter_tmp/rkhunter/db /var/local/rkhunter_tmp/rkhunter/etc /var/local/rkhunter_tmp/rkhunter/scripts \\\n && sed -i 's/\\/var\\/log\\/rkhunter\\/rkhunter.log/\\/var\\/local\\/rkhunter_tmp\\/rkhunter\\/rkhunter.log/' /etc/logrotate.d/rkhunter \\\n && sed -r -e 's%^(SCRIPTDIR)=.*%\\1=/tmp/rkhunter/scripts%; s%^(LOGFILE)=.*%\\1=/tmp/rkhunter/rkhunter.log%' /etc/rkhunter.conf > /var/local/rkhunter_tmp/rkhunter/etc/rkhunter.conf\n#   Ansible startup configuration playbook\nCOPY root /root\nRUN cat bash_aliases >> /root/.bashrc\n#   FIXME: These are vendor libs that need to be packaged and installed via RPM.\nCOPY vendor/prometheus_client /usr/lib/python2.7/site-packages/prometheus_client/\n#   Create ops-runner.log file with proper permissions\nRUN touch /var/log/ops-runner.log \\\n && chmod 664 /var/log/ops-runner.log\n#   Setup the AWS credentials file so that we can populate it on startup.\nRUN mkdir -p /root/.aws \\\n && touch /root/.aws/credentials \\\n && chmod g+rw /root/.aws/credentials\n#   Add container-build-env-fingerprint\nCOPY container-build-env-fingerprint.output /etc/oso-container-build-env-fingerprint\n#   Add the start script and tell the container to run it by default\nCOPY start.sh /usr/local/bin/\nCMD /usr/local/bin/start.sh\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM oso-rhel7-ops-base:latest\n#      ___ ___ _  _ ___ ___    _ _____ ___ ___         \n#     / __| __| \\| | __| _ \\  /_\\_   _| __|   \\        \n#    | (_ | _|| .` | _||   / / _ \\| | | _|| |) |       \n#     \\___|___|_|\\_|___|_|_\\/_/_\\_\\_|_|___|___/_ _____ \n#    |   \\ / _ \\  | \\| |/ _ \\_   _| | __|   \\_ _|_   _|\n#    | |) | (_) | | .` | (_) || |   | _|| |) | |  | |  \n#    |___/ \\___/  |_|\\_|\\___/ |_|   |___|___/___| |_|  \n#  \n#  Pause indefinitely if asked to do so.\nARG OO_PAUSE_ON_BUILD\nRUN test \"$OO_PAUSE_ON_BUILD\" = \"true\" \\\n && while sleep 10 ; do true ; done || :\n#  PCP\n# #################\n#  install pcp-collector and it's dependencies, clean the cache.\nRUN yum-install-check.sh -y pcp pcp-conf pcp-collector xz \\\n && yum clean all\n#  Run in the container as root - avoids PCP_USER mismatches\nRUN sed -i -e 's/PCP_USER=.*$/PCP_USER=root/' -e 's/PCP_GROUP=.*$/PCP_GROUP=root/' /etc/pcp.conf\n#  Disable service advertising - no avahi daemon in the container\n#  (dodges warnings from pmcd attempting to connect during startup)\nRUN . /etc/pcp.conf \\\n && echo \"-A\" >> $PCP_PMCDOPTIONS_PATH\n#  denote this as a container environment, for rc scripts\nENV PCP_CONTAINER_IMAGE=\"pcp-collector\"\nENV NAME=\"pcp-collector\"\nENV IMAGE=\"pcp-collector\"\nENV PATH=\"/usr/share/pcp/lib:/usr/libexec/pcp/bin:$PATH\"\n#  script to watch health of pmcd\nCOPY check-pmcd-status.sh /usr/local/bin/check-pmcd-status.sh\n# #################\n#  /usr/bin/oc workaround\n#  python-openshift-tools-monitoring-openshift depends on /usr/bin/oc\n#  since origin-clients and atomic-openshift-clients provide the binary\n#  for Origin/OpenShift respectively. yum isn't happy that a package named 'openshift'\n#  used to provide /usr/bin/oc, and 'openshift' has been replaced by\n#  'atomic-openshift', but 'atomic-openshift' doesn't provide /usr/bin/oc.\n#  So just install atomic-openshift-clients before python-openshift-tools-monitoring-openshift\n#  until the yum repo is cleared of the older packages.\nRUN yum-install-check.sh -y atomic-openshift-clients openshift-hypercc \\\n && yum clean metadata\n#  Add google-cloud-sdk repo\nCOPY google-cloud-sdk.repo /etc/yum.repos.d/\nRUN yum clean metadata \\\n && yum-install-check.sh -y python2-pip pcp pcp-conf pcp-testsuite python-requests pyOpenSSL python-openshift-tools python-openshift-tools-monitoring-pcp python-openshift-tools-monitoring-docker python-openshift-tools-monitoring-zagg python-openshift-tools-monitoring-openshift python-openshift-tools-ansible python-openshift-tools-web openshift-tools-scripts-cloud-aws openshift-tools-scripts-cloud-gcp openshift-tools-scripts-monitoring-pcp openshift-tools-scripts-monitoring-docker openshift-tools-scripts-monitoring-aws openshift-tools-scripts-monitoring-gcp openshift-tools-scripts-monitoring-openshift openshift-tools-scripts-monitoring-autoheal pcp-manager pcp-webapi python-pcp python-httplib2 python2-pyasn1 python2-pyasn1-modules python2-rsa python-configobj python2-psutil pylint tito python-devel libyaml-devel oso-simplesamlphp python2-ruamel-yaml rpm-sign createrepo python2-boto3 python-lxml rkhunter python-hawkular-client python-docker \\\n && yum-install-check.sh -y google-cloud-sdk python2-uritemplate python2-google-api-client python2-oauth2client --disablerepo=\"rhel-server-releases-optional\" --enablerepo=\"google-cloud-sdk\" \\\n && yum clean all\nCOPY urllib3-connectionpool-patch /root/\nRUN yum-install-check.sh -y patch \\\n && yum clean all \\\n && cd /usr/lib/python2.7/site-packages/ \\\n && patch -p1 < /root/urllib3-connectionpool-patch\n#  make mount points for security update count check, and make a circular symlink because yum is dumb about its root\nRUN mkdir -p /host /var/local/hostpkg/etc/rhsm/ca /var/local/hostpkg/etc/rpm /var/local/hostpkg/etc/pki/entitlement /var/local/hostpkg/etc/pki/rpm-gpg /var/local/hostpkg/var/local /var/local/hostpkg/var/cache/yum /var/local/hostpkg/var/lib/yum \\\n && ln -s /var/local/hostpkg /var/local/hostpkg/var/local/hostpkg\n#  Make mount points for rkhunter files, and configure rkhunter to work with this structure\nRUN mkdir -p /var/local/rkhunter_chroot /var/local/rkhunter_tmp /var/local/rkhunter_tmp/rkhunter /var/local/rkhunter_tmp/rkhunter/bin /var/local/rkhunter_tmp/rkhunter/db /var/local/rkhunter_tmp/rkhunter/etc /var/local/rkhunter_tmp/rkhunter/scripts \\\n && sed -i 's/\\/var\\/log\\/rkhunter\\/rkhunter.log/\\/var\\/local\\/rkhunter_tmp\\/rkhunter\\/rkhunter.log/' /etc/logrotate.d/rkhunter \\\n && sed -r -e 's%^(SCRIPTDIR)=.*%\\1=/tmp/rkhunter/scripts%; s%^(LOGFILE)=.*%\\1=/tmp/rkhunter/rkhunter.log%' /etc/rkhunter.conf > /var/local/rkhunter_tmp/rkhunter/etc/rkhunter.conf\n#  Ansible startup configuration playbook\nCOPY root /root\nRUN cat bash_aliases >> /root/.bashrc\n#  FIXME: These are vendor libs that need to be packaged and installed via RPM.\nCOPY vendor/prometheus_client /usr/lib/python2.7/site-packages/prometheus_client/\n#  Create ops-runner.log file with proper permissions\nRUN touch /var/log/ops-runner.log \\\n && chmod 664 /var/log/ops-runner.log\n#  Setup the AWS credentials file so that we can populate it on startup.\nRUN mkdir -p /root/.aws \\\n && touch /root/.aws/credentials \\\n && chmod g+rw /root/.aws/credentials\n#  Add container-build-env-fingerprint\nCOPY container-build-env-fingerprint.output /etc/oso-container-build-env-fingerprint\n#  Add the start script and tell the container to run it by default\nCOPY start.sh /usr/local/bin/\nCMD /usr/local/bin/start.sh\n","injectedSmells":[],"originalDockerfileHash":"b3cafc57f9d6dc46f00ffa4b22b56c21","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM oso-rhel7-ops-base:latest\n#       ___ ___ _  _ ___ ___    _ _____ ___ ___         \n#      / __| __| \\| | __| _ \\  /_\\_   _| __|   \\        \n#     | (_ | _|| .` | _||   / / _ \\| | | _|| |) |       \n#      \\___|___|_|\\_|___|_|_\\/_/_\\_\\_|_|___|___/_ _____ \n#     |   \\ / _ \\  | \\| |/ _ \\_   _| | __|   \\_ _|_   _|\n#     | |) | (_) | | .` | (_) || |   | _|| |) | |  | |  \n#     |___/ \\___/  |_|\\_|\\___/ |_|   |___|___/___| |_|  \n#   \n#   Pause indefinitely if asked to do so.\nARG OO_PAUSE_ON_BUILD\nRUN test \"$OO_PAUSE_ON_BUILD\" = \"true\" \\\n && while sleep 10 ; do true ; done || :\n#   PCP\n#  #################\n#   install pcp-collector and it's dependencies, clean the cache.\nRUN yum-install-check.sh -y pcp pcp-conf pcp-collector xz \\\n && yum clean all\n#   Run in the container as root - avoids PCP_USER mismatches\nRUN sed -i -e 's/PCP_USER=.*$/PCP_USER=root/' -e 's/PCP_GROUP=.*$/PCP_GROUP=root/' /etc/pcp.conf\n#   Disable service advertising - no avahi daemon in the container\n#   (dodges warnings from pmcd attempting to connect during startup)\nRUN . /etc/pcp.conf \\\n && echo \"-A\" >> $PCP_PMCDOPTIONS_PATH\n#   denote this as a container environment, for rc scripts\nENV PCP_CONTAINER_IMAGE=\"pcp-collector\"\nENV NAME=\"pcp-collector\"\nENV IMAGE=\"pcp-collector\"\nENV PATH=\"/usr/share/pcp/lib:/usr/libexec/pcp/bin:$PATH\"\n#   script to watch health of pmcd\nCOPY check-pmcd-status.sh /usr/local/bin/check-pmcd-status.sh\n#  #################\n#   /usr/bin/oc workaround\n#   python-openshift-tools-monitoring-openshift depends on /usr/bin/oc\n#   since origin-clients and atomic-openshift-clients provide the binary\n#   for Origin/OpenShift respectively. yum isn't happy that a package named 'openshift'\n#   used to provide /usr/bin/oc, and 'openshift' has been replaced by\n#   'atomic-openshift', but 'atomic-openshift' doesn't provide /usr/bin/oc.\n#   So just install atomic-openshift-clients before python-openshift-tools-monitoring-openshift\n#   until the yum repo is cleared of the older packages.\nRUN yum-install-check.sh -y atomic-openshift-clients openshift-hypercc \\\n && yum clean metadata\n#   Add google-cloud-sdk repo\nCOPY google-cloud-sdk.repo /etc/yum.repos.d/\nRUN yum clean metadata \\\n && yum-install-check.sh -y python2-pip pcp pcp-conf pcp-testsuite python-requests pyOpenSSL python-openshift-tools python-openshift-tools-monitoring-pcp python-openshift-tools-monitoring-docker python-openshift-tools-monitoring-zagg python-openshift-tools-monitoring-openshift python-openshift-tools-ansible python-openshift-tools-web openshift-tools-scripts-cloud-aws openshift-tools-scripts-cloud-gcp openshift-tools-scripts-monitoring-pcp openshift-tools-scripts-monitoring-docker openshift-tools-scripts-monitoring-aws openshift-tools-scripts-monitoring-gcp openshift-tools-scripts-monitoring-openshift openshift-tools-scripts-monitoring-autoheal pcp-manager pcp-webapi python-pcp python-httplib2 python2-pyasn1 python2-pyasn1-modules python2-rsa python-configobj python2-psutil pylint tito python-devel libyaml-devel oso-simplesamlphp python2-ruamel-yaml rpm-sign createrepo python2-boto3 python-lxml rkhunter python-hawkular-client python-docker \\\n && yum-install-check.sh -y google-cloud-sdk python2-uritemplate python2-google-api-client python2-oauth2client --disablerepo=\"rhel-server-releases-optional\" --enablerepo=\"google-cloud-sdk\" \\\n && yum clean all\nCOPY urllib3-connectionpool-patch /root/\nRUN yum-install-check.sh -y patch \\\n && yum clean all \\\n && cd /usr/lib/python2.7/site-packages/ \\\n && patch -p1 < /root/urllib3-connectionpool-patch\n#   make mount points for security update count check, and make a circular symlink because yum is dumb about its root\nRUN mkdir -p /host /var/local/hostpkg/etc/rhsm/ca /var/local/hostpkg/etc/rpm /var/local/hostpkg/etc/pki/entitlement /var/local/hostpkg/etc/pki/rpm-gpg /var/local/hostpkg/var/local /var/local/hostpkg/var/cache/yum /var/local/hostpkg/var/lib/yum \\\n && ln -s /var/local/hostpkg /var/local/hostpkg/var/local/hostpkg\n#   Make mount points for rkhunter files, and configure rkhunter to work with this structure\nRUN mkdir -p /var/local/rkhunter_chroot /var/local/rkhunter_tmp /var/local/rkhunter_tmp/rkhunter /var/local/rkhunter_tmp/rkhunter/bin /var/local/rkhunter_tmp/rkhunter/db /var/local/rkhunter_tmp/rkhunter/etc /var/local/rkhunter_tmp/rkhunter/scripts \\\n && sed -i 's/\\/var\\/log\\/rkhunter\\/rkhunter.log/\\/var\\/local\\/rkhunter_tmp\\/rkhunter\\/rkhunter.log/' /etc/logrotate.d/rkhunter \\\n && sed -r -e 's%^(SCRIPTDIR)=.*%\\1=/tmp/rkhunter/scripts%; s%^(LOGFILE)=.*%\\1=/tmp/rkhunter/rkhunter.log%' /etc/rkhunter.conf > /var/local/rkhunter_tmp/rkhunter/etc/rkhunter.conf\n#   Ansible startup configuration playbook\nCOPY root /root\nRUN cat bash_aliases >> /root/.bashrc\n#   FIXME: These are vendor libs that need to be packaged and installed via RPM.\nCOPY vendor/prometheus_client /usr/lib/python2.7/site-packages/prometheus_client/\n#   Create ops-runner.log file with proper permissions\nRUN touch /var/log/ops-runner.log \\\n && chmod 664 /var/log/ops-runner.log\n#   Setup the AWS credentials file so that we can populate it on startup.\nRUN mkdir -p /root/.aws \\\n && touch /root/.aws/credentials \\\n && chmod g+rw /root/.aws/credentials\n#   Add container-build-env-fingerprint\nCOPY container-build-env-fingerprint.output /etc/oso-container-build-env-fingerprint\n#   Add the start script and tell the container to run it by default\nCOPY start.sh /usr/local/bin/\nCMD /usr/local/bin/start.sh\n","originalDockerfileUglifiedHash":"24d357d94de926ee2e713767e1e777b9","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/2ec0cc13a5e8c451d40ea6a2f0975f442bddf1d1.dockerfile"}