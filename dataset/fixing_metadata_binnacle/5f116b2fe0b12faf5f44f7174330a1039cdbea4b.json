{"seed":3914667423,"processedDockerfileHash":"411fd75ea54087b669cc9fb8848b85f6","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","do-not-have-secrets","have-a-healthcheck"],"processedDockerfile":"#   Lobsters\n#\n#   VERSION latest\nFROM ruby:2.3-alpine\n#   Setting this to true will retain linux\n#   build tools and dev packages.\nARG developer_build=false\n#   Args for labels.\nARG VCS_REF\nARG BUILD_DATE\n#  Labels\nLABEL maintainer=\"James Brink, brink.james@gmail.com\" \\\n      decription=\"Lobsters Rails Project\" \\\n      version=\"latest\" \\\n      org.label-schema.name=\"lobsters\" \\\n      org.label-schema.build-date=\"$BUILD_DATE\" \\\n      org.label-schema.vcs-ref=\"$VCS_REF\" \\\n      org.label-schema.vcs-url=\"https://github.com/jamesbrink/docker-lobsters\" \\\n      org.label-schema.schema-version=\"1.0.0-rc1\"\n#   Create lobsters user and group.\nRUN addgroup -S lobsters \\\n && adduser -S -h /lobsters -s /bin/sh -G lobsters lobsters\n#   Copy Gemfile to container.\nCOPY ./lobsters/Gemfile ./lobsters/Gemfile.lock /lobsters/\n#   Install needed runtime & development dependencies. If this is a developer_build we don't remove\n#   the build-deps after doing a bundle install.\nRUN set -xe ; chown -R lobsters:lobsters /lobsters ; apk add mariadb-connector-c nodejs npm sqlite-libs tzdata --no-cache --update --virtual .runtime-deps ; apk add bash build-base curl gcc git gnupg linux-headers mariadb-connector-c-dev mariadb-dev sqlite-dev --no-cache --virtual .build-deps ; export PATH=/lobsters/.gem/ruby/2.3.0/bin:$PATH ; export GEM_HOME=\"/lobsters/.gem\" ; export GEM_PATH=\"/lobsters/.gem\" ; export BUNDLE_PATH=\"/lobsters/.bundle\" ; cd /lobsters ; su lobsters -c \"gem install bundler --user-install\" ; su lobsters -c \"bundle install --no-cache\" ; su lobsters -c \"bundle add puma\" ; if [ \"$developer_build\" != \"true\" ] ; then apk del .build-deps ; fi ; mv /lobsters/Gemfile /lobsters/Gemfile.bak ; mv /lobsters/Gemfile.lock /lobsters/Gemfile.lock.bak\n#   Copy lobsters into the container.\nCOPY ./lobsters ./docker-assets /lobsters/\n#   Set proper permissions and move assets and configs.\nRUN set -xe ; mv /lobsters/Gemfile.bak /lobsters/Gemfile ; mv /lobsters/Gemfile.lock.bak /lobsters/Gemfile.lock ; chown -R lobsters:lobsters /lobsters ; mv /lobsters/docker-entrypoint.sh /usr/local/bin/ ; chmod 755 /usr/local/bin/docker-entrypoint.sh ; rm /lobsters/Gemfile.lock\n#   Drop down to unprivileged users\nUSER lobsters\n#   Set our working directory.\nWORKDIR /lobsters/\n#   Set environment variables.\n# A secret has been removed here. Please do not provide secrets from the Dockerfile as these will leak into the metadata of the resulting docker image. To provide secrets the --secret flag of the docker build command can be used (https://docs.docker.com/develop/develop-images/build_enhancements/#new-docker-build-secret-information).\nENV MARIADB_HOST=\"mariadb\" \\\n    MARIADB_PORT=\"3306\" \\\n    MARIADB_USER=\"root\" \\\n    LOBSTER_DATABASE=\"lobsters\" \\\n    LOBSTER_HOSTNAME=\"localhost\" \\\n    LOBSTER_SITE_NAME=\"Example News\" \\\n    RAILS_ENV=\"development\" \\\n    GEM_HOME=\"/lobsters/.gem\" \\\n    GEM_PATH=\"/lobsters/.gem\" \\\n    BUNDLE_PATH=\"/lobsters/.bundle\" \\\n    RAILS_MAX_THREADS=\"5\" \\\n    SMTP_HOST=\"127.0.0.1\" \\\n    SMTP_PORT=\"25\" \\\n    SMTP_STARTTLS_AUTO=\"true\" \\\n    SMTP_USERNAME=\"lobsters\" \\\n    RAILS_LOG_TO_STDOUT=\"1\" \\\n    PATH=\"/lobsters/.gem/ruby/2.3.0/bin:$PATH\"\n#   Expose HTTP port.\nEXPOSE 3000/tcp\n#   Execute our entry script.\nCMD [\"/usr/local/bin/docker-entrypoint.sh\"]\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  Lobsters\n#\n#  VERSION latest\nFROM ruby:2.3-alpine\n#  Setting this to true will retain linux\n#  build tools and dev packages.\nARG developer_build=false\n#  Args for labels.\nARG VCS_REF\nARG BUILD_DATE\n# Labels\nLABEL maintainer=\"James Brink, brink.james@gmail.com\" \\\n      decription=\"Lobsters Rails Project\" \\\n      version=\"latest\" \\\n      org.label-schema.name=\"lobsters\" \\\n      org.label-schema.build-date=\"$BUILD_DATE\" \\\n      org.label-schema.vcs-ref=\"$VCS_REF\" \\\n      org.label-schema.vcs-url=\"https://github.com/jamesbrink/docker-lobsters\" \\\n      org.label-schema.schema-version=\"1.0.0-rc1\"\n#  Create lobsters user and group.\nRUN addgroup -S lobsters \\\n && adduser -S -h /lobsters -s /bin/sh -G lobsters lobsters\n#  Copy Gemfile to container.\nCOPY ./lobsters/Gemfile ./lobsters/Gemfile.lock /lobsters/\n#  Install needed runtime & development dependencies. If this is a developer_build we don't remove\n#  the build-deps after doing a bundle install.\nRUN set -xe ; chown -R lobsters:lobsters /lobsters ; apk add --no-cache --update --virtual .runtime-deps mariadb-connector-c nodejs npm sqlite-libs tzdata ; apk add --no-cache --virtual .build-deps bash build-base curl gcc git gnupg linux-headers mariadb-connector-c-dev mariadb-dev sqlite-dev ; export PATH=/lobsters/.gem/ruby/2.3.0/bin:$PATH ; export GEM_HOME=\"/lobsters/.gem\" ; export GEM_PATH=\"/lobsters/.gem\" ; export BUNDLE_PATH=\"/lobsters/.bundle\" ; cd /lobsters ; su lobsters -c \"gem install bundler --user-install\" ; su lobsters -c \"bundle install --no-cache\" ; su lobsters -c \"bundle add puma\" ; if [ \"$developer_build\" != \"true\" ] ; then apk del .build-deps ; fi ; mv /lobsters/Gemfile /lobsters/Gemfile.bak ; mv /lobsters/Gemfile.lock /lobsters/Gemfile.lock.bak\n#  Copy lobsters into the container.\nCOPY ./lobsters ./docker-assets /lobsters/\n#  Set proper permissions and move assets and configs.\nRUN set -xe ; mv /lobsters/Gemfile.bak /lobsters/Gemfile ; mv /lobsters/Gemfile.lock.bak /lobsters/Gemfile.lock ; chown -R lobsters:lobsters /lobsters ; mv /lobsters/docker-entrypoint.sh /usr/local/bin/ ; chmod 755 /usr/local/bin/docker-entrypoint.sh ; rm /lobsters/Gemfile.lock\n#  Drop down to unprivileged users\nUSER lobsters\n#  Set our working directory.\nWORKDIR /lobsters/\n#  Set environment variables.\nENV MARIADB_HOST=\"mariadb\" \\\n    MARIADB_PORT=\"3306\" \\\n    MARIADB_PASSWORD=\"password\" \\\n    MARIADB_USER=\"root\" \\\n    LOBSTER_DATABASE=\"lobsters\" \\\n    LOBSTER_HOSTNAME=\"localhost\" \\\n    LOBSTER_SITE_NAME=\"Example News\" \\\n    RAILS_ENV=\"development\" \\\n    SECRET_KEY=\"\" \\\n    GEM_HOME=\"/lobsters/.gem\" \\\n    GEM_PATH=\"/lobsters/.gem\" \\\n    BUNDLE_PATH=\"/lobsters/.bundle\" \\\n    RAILS_MAX_THREADS=\"5\" \\\n    SMTP_HOST=\"127.0.0.1\" \\\n    SMTP_PORT=\"25\" \\\n    SMTP_STARTTLS_AUTO=\"true\" \\\n    SMTP_USERNAME=\"lobsters\" \\\n    SMTP_PASSWORD=\"lobsters\" \\\n    RAILS_LOG_TO_STDOUT=\"1\" \\\n    PATH=\"/lobsters/.gem/ruby/2.3.0/bin:$PATH\"\n#  Expose HTTP port.\nEXPOSE 3000/tcp\n#  Execute our entry script.\nCMD [\"/usr/local/bin/docker-entrypoint.sh\"]\n","injectedSmells":[],"originalDockerfileHash":"b6b410cb1f540ee68d518f75e955159f","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   Lobsters\n#\n#   VERSION latest\nFROM ruby:2.3-alpine\n#   Setting this to true will retain linux\n#   build tools and dev packages.\nARG developer_build=false\n#   Args for labels.\nARG VCS_REF\nARG BUILD_DATE\n#  Labels\nLABEL maintainer=\"James Brink, brink.james@gmail.com\" \\\n      decription=\"Lobsters Rails Project\" \\\n      version=\"latest\" \\\n      org.label-schema.name=\"lobsters\" \\\n      org.label-schema.build-date=\"$BUILD_DATE\" \\\n      org.label-schema.vcs-ref=\"$VCS_REF\" \\\n      org.label-schema.vcs-url=\"https://github.com/jamesbrink/docker-lobsters\" \\\n      org.label-schema.schema-version=\"1.0.0-rc1\"\n#   Create lobsters user and group.\nRUN addgroup -S lobsters \\\n && adduser -S -h /lobsters -s /bin/sh -G lobsters lobsters\n#   Copy Gemfile to container.\nCOPY ./lobsters/Gemfile ./lobsters/Gemfile.lock /lobsters/\n#   Install needed runtime & development dependencies. If this is a developer_build we don't remove\n#   the build-deps after doing a bundle install.\nRUN set -xe ; chown -R lobsters:lobsters /lobsters ; apk add --no-cache --update --virtual .runtime-deps mariadb-connector-c nodejs npm sqlite-libs tzdata ; apk add --no-cache --virtual .build-deps bash build-base curl gcc git gnupg linux-headers mariadb-connector-c-dev mariadb-dev sqlite-dev ; export PATH=/lobsters/.gem/ruby/2.3.0/bin:$PATH ; export GEM_HOME=\"/lobsters/.gem\" ; export GEM_PATH=\"/lobsters/.gem\" ; export BUNDLE_PATH=\"/lobsters/.bundle\" ; cd /lobsters ; su lobsters -c \"gem install bundler --user-install\" ; su lobsters -c \"bundle install --no-cache\" ; su lobsters -c \"bundle add puma\" ; if [ \"$developer_build\" != \"true\" ] ; then apk del .build-deps ; fi ; mv /lobsters/Gemfile /lobsters/Gemfile.bak ; mv /lobsters/Gemfile.lock /lobsters/Gemfile.lock.bak\n#   Copy lobsters into the container.\nCOPY ./lobsters ./docker-assets /lobsters/\n#   Set proper permissions and move assets and configs.\nRUN set -xe ; mv /lobsters/Gemfile.bak /lobsters/Gemfile ; mv /lobsters/Gemfile.lock.bak /lobsters/Gemfile.lock ; chown -R lobsters:lobsters /lobsters ; mv /lobsters/docker-entrypoint.sh /usr/local/bin/ ; chmod 755 /usr/local/bin/docker-entrypoint.sh ; rm /lobsters/Gemfile.lock\n#   Drop down to unprivileged users\nUSER lobsters\n#   Set our working directory.\nWORKDIR /lobsters/\n#   Set environment variables.\nENV MARIADB_HOST=\"mariadb\" \\\n    MARIADB_PORT=\"3306\" \\\n    MARIADB_PASSWORD=\"password\" \\\n    MARIADB_USER=\"root\" \\\n    LOBSTER_DATABASE=\"lobsters\" \\\n    LOBSTER_HOSTNAME=\"localhost\" \\\n    LOBSTER_SITE_NAME=\"Example News\" \\\n    RAILS_ENV=\"development\" \\\n    SECRET_KEY=\"\" \\\n    GEM_HOME=\"/lobsters/.gem\" \\\n    GEM_PATH=\"/lobsters/.gem\" \\\n    BUNDLE_PATH=\"/lobsters/.bundle\" \\\n    RAILS_MAX_THREADS=\"5\" \\\n    SMTP_HOST=\"127.0.0.1\" \\\n    SMTP_PORT=\"25\" \\\n    SMTP_STARTTLS_AUTO=\"true\" \\\n    SMTP_USERNAME=\"lobsters\" \\\n    SMTP_PASSWORD=\"lobsters\" \\\n    RAILS_LOG_TO_STDOUT=\"1\" \\\n    PATH=\"/lobsters/.gem/ruby/2.3.0/bin:$PATH\"\n#   Expose HTTP port.\nEXPOSE 3000/tcp\n#   Execute our entry script.\nCMD [\"/usr/local/bin/docker-entrypoint.sh\"]\n","originalDockerfileUglifiedHash":"72fdea0d7488ecdb1eeb0c6f611c7f56","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/5f116b2fe0b12faf5f44f7174330a1039cdbea4b.dockerfile"}