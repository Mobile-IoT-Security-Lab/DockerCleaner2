{"seed":2544214404,"processedDockerfileHash":"7989bded842a4dc6d4ef744a82b63598","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","pin-package-manager-versions-apt-get","pin-package-manager-versions-npm","pin-package-manager-versions-gem","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM appsvctest/php-build-5.6:latest AS php5.6-build\nFROM appsvctest/php-build-7.0:latest AS php7.0-build\nFROM appsvctest/php-build-7.2:latest AS php7.2-build\nFROM appsvctest/python-3.6-build:latest AS python-3.6-build\nFROM appsvctest/python-3.7-build:latest AS python-3.7-build\nFROM buildpack-deps:jessie-curl AS main\nMAINTAINER Nazim Lala <naziml@microsoft.com>\nENV DEBIAN_FRONTEND=\"noninteractive\"\nCOPY mod_mono.tar /tmp\n#   Install dependencies\nRUN apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys 3FA7E0328081BFF6A14DA29AA6A19B38D3D831EF \\\n && echo \"deb http://download.mono-project.com/repo/debian jessie/snapshots/5.0.0.100/. main\" > /etc/apt/sources.list.d/mono-xamarin.list \\\n && echo \"deb http://deb.debian.org/debian/ jessie main\" >> /etc/apt/sources.list \\\n && echo \"deb-src http://deb.debian.org/debian/ jessie main\" >> /etc/apt/sources.list \\\n && echo \"deb http://security.debian.org/ jessie/updates main\" >> /etc/apt/sources.list \\\n && echo \"deb-src http://security.debian.org/ jessie/updates main\" >> /etc/apt/sources.list \\\n && echo \"deb http://archive.debian.org/debian jessie-backports main\" >> /etc/apt/sources.list \\\n && echo \"deb-src http://archive.debian.org/debian jessie-backports main\" >> /etc/apt/sources.list \\\n && echo \"Acquire::Check-Valid-Until \\\"false\\\";\" > /etc/apt/apt.conf \\\n && apt-get update \\\n && apt-get install --no-install-recommends apt-utils=2.6.0 -y \\\n && apt-get install --no-install-recommends unzip=6.0-27ubuntu1 -y \\\n && apt-get install --no-install-recommends xz-utils=5.4.1-0.2 -y \\\n && apt-get install --no-install-recommends mono-complete=6.8.0.105+dfsg-3.3 -y \\\n && apt-get install --no-install-recommends mono-apache-server4=4.2-2.4 -y \\\n && apt-get install --no-install-recommends libapache2-mod-mono=3.8-3 -y \\\n && apt-get install --no-install-recommends git=1:2.39.2-1ubuntu1 -y \\\n && apt-get install --no-install-recommends openssh-client=1:9.0p1-1ubuntu8 -y \\\n && apt-get install --no-install-recommends vim=2:9.0.1000-4ubuntu2 tree=2.1.0-1 -y \\\n && apt-get install --no-install-recommends tcptraceroute=1.5beta7+debian-4.1 -y \\\n && wget -O /tmp/node-v4.4.7-linux-x64.tar.xz https://nodejs.org/dist/v4.4.7/node-v4.4.7-linux-x64.tar.xz \\\n && wget -O /tmp/node-v4.5.0-linux-x64.tar.xz https://nodejs.org/dist/v4.5.0/node-v4.5.0-linux-x64.tar.xz \\\n && wget -O /tmp/node-v6.2.2-linux-x64.tar.xz https://nodejs.org/dist/v6.2.2/node-v6.2.2-linux-x64.tar.xz \\\n && wget -O /tmp/node-v6.6.0-linux-x64.tar.xz https://nodejs.org/dist/v6.6.0/node-v6.6.0-linux-x64.tar.xz \\\n && wget -O /tmp/node-v6.9.3-linux-x64.tar.xz https://nodejs.org/dist/v6.9.3/node-v6.9.3-linux-x64.tar.xz \\\n && wget -O /tmp/node-v6.10.3-linux-x64.tar.xz https://nodejs.org/dist/v6.10.3/node-v6.10.3-linux-x64.tar.xz \\\n && wget -O /tmp/node-v6.11.0-linux-x64.tar.xz https://nodejs.org/dist/v6.11.0/node-v6.11.0-linux-x64.tar.xz \\\n && wget -O /tmp/node-v8.0.0-linux-x64.tar.xz https://nodejs.org/dist/v8.0.0/node-v8.0.0-linux-x64.tar.xz \\\n && wget -O /tmp/node-v8.1.0-linux-x64.tar.xz https://nodejs.org/dist/v8.1.0/node-v8.1.0-linux-x64.tar.xz \\\n && wget -O /tmp/node-v8.2.1-linux-x64.tar.xz https://nodejs.org/dist/v8.2.1/node-v8.2.1-linux-x64.tar.xz \\\n && wget -O /tmp/node-v8.8.1-linux-x64.tar.xz https://nodejs.org/dist/v8.8.1/node-v8.8.1-linux-x64.tar.xz \\\n && wget -O /tmp/node-v8.9.4-linux-x64.tar.xz https://nodejs.org/dist/v8.9.4/node-v8.9.4-linux-x64.tar.xz \\\n && wget -O /tmp/node-v8.11.2-linux-x64.tar.xz https://nodejs.org/dist/v8.11.2/node-v8.11.2-linux-x64.tar.xz \\\n && wget -O /tmp/node-v9.4.0-linux-x64.tar.xz https://nodejs.org/dist/v9.4.0/node-v9.4.0-linux-x64.tar.xz \\\n && wget -O /tmp/node-v10.1.0-linux-x64.tar.xz https://nodejs.org/dist/v10.1.0/node-v10.1.0-linux-x64.tar.xz \\\n && wget -O /tmp/npm-2.15.8.zip https://github.com/npm/npm/archive/v2.15.8.zip \\\n && wget -O /tmp/npm-2.15.9.zip https://github.com/npm/npm/archive/v2.15.9.zip \\\n && wget -O /tmp/npm-3.9.5.zip https://github.com/npm/npm/archive/v3.9.5.zip \\\n && wget -O /tmp/npm-3.10.3.zip https://github.com/npm/npm/archive/v3.10.3.zip \\\n && wget -O /tmp/npm-3.10.10.zip https://github.com/npm/npm/archive/v3.10.10.zip \\\n && wget -O /tmp/npm-5.0.3.zip https://github.com/npm/npm/archive/v5.0.3.zip \\\n && wget -O /tmp/npm-5.4.2.zip https://github.com/npm/npm/archive/v5.4.2.zip \\\n && wget -O /tmp/npm-5.6.0.zip https://github.com/npm/npm/archive/v5.6.0.zip \\\n && wget -O /tmp/npm-6.0.1.zip https://github.com/npm/npm/archive/v6.0.1.zip \\\n && ln -s ../mods-available/xml2enc.load /etc/apache2/mods-enabled \\\n && a2enmod proxy \\\n && a2enmod proxy_http \\\n && a2enmod proxy_wstunnel \\\n && a2enmod rewrite \\\n && a2enmod proxy_ajp \\\n && a2enmod deflate \\\n && a2enmod headers \\\n && a2enmod proxy_balancer \\\n && a2enmod proxy_connect \\\n && a2enmod proxy_html \\\n && tar -xf /tmp/mod_mono.tar \\\n && cp mod_mono.so.0.0.0 /usr/lib/apache2/modules/mod_mono.so.0.0.0\n#   Install npm and node\nRUN mkdir -p /opt/npm/2.15.8/node_modules \\\n && unzip -q /tmp/npm-2.15.8.zip -d /opt/npm/2.15.8/node_modules \\\n && mv /opt/npm/2.15.8/node_modules/npm-2.15.8 /opt/npm/2.15.8/node_modules/npm \\\n && ln -s /opt/npm/2.15.8/node_modules/npm/bin/npm /opt/npm/2.15.8/npm \\\n && chmod -R 755 /opt/npm/2.15.8/node_modules/npm/bin \\\n && mkdir -p /opt/npm/2.15.9/node_modules \\\n && unzip -q /tmp/npm-2.15.9.zip -d /opt/npm/2.15.9/node_modules \\\n && mv /opt/npm/2.15.9/node_modules/npm-2.15.9 /opt/npm/2.15.9/node_modules/npm \\\n && ln -s /opt/npm/2.15.9/node_modules/npm/bin/npm /opt/npm/2.15.9/npm \\\n && chmod -R 755 /opt/npm/2.15.9/node_modules/npm/bin \\\n && mkdir -p /opt/npm/3.9.5/node_modules \\\n && unzip -q /tmp/npm-3.9.5.zip -d /opt/npm/3.9.5/node_modules \\\n && mv /opt/npm/3.9.5/node_modules/npm-3.9.5 /opt/npm/3.9.5/node_modules/npm \\\n && ln -s /opt/npm/3.9.5/node_modules/npm/bin/npm /opt/npm/3.9.5/npm \\\n && chmod -R 755 /opt/npm/3.9.5/node_modules/npm/bin \\\n && mkdir -p /opt/npm/3.10.3/node_modules \\\n && unzip -q /tmp/npm-3.10.3.zip -d /opt/npm/3.10.3/node_modules \\\n && mv /opt/npm/3.10.3/node_modules/npm-3.10.3 /opt/npm/3.10.3/node_modules/npm \\\n && ln -s /opt/npm/3.10.3/node_modules/npm/bin/npm /opt/npm/3.10.3/npm \\\n && chmod -R 755 /opt/npm/3.10.3/node_modules/npm/bin \\\n && mkdir -p /opt/npm/3.10.10/node_modules \\\n && unzip -q /tmp/npm-3.10.10.zip -d /opt/npm/3.10.10/node_modules \\\n && mv /opt/npm/3.10.10/node_modules/npm-3.10.10 /opt/npm/3.10.10/node_modules/npm \\\n && ln -s /opt/npm/3.10.10/node_modules/npm/bin/npm /opt/npm/3.10.10/npm \\\n && chmod -R 755 /opt/npm/3.10.10/node_modules/npm/bin \\\n && mkdir -p /opt/npm/5.0.3/node_modules \\\n && unzip -q /tmp/npm-5.0.3.zip -d /opt/npm/5.0.3/node_modules \\\n && mv /opt/npm/5.0.3/node_modules/npm-5.0.3 /opt/npm/5.0.3/node_modules/npm \\\n && ln -s /opt/npm/5.0.3/node_modules/npm/bin/npm /opt/npm/5.0.3/npm \\\n && chmod -R 755 /opt/npm/5.0.3/node_modules/npm/bin \\\n && mkdir -p /opt/npm/5.4.2/node_modules \\\n && unzip -q /tmp/npm-5.4.2.zip -d /opt/npm/5.4.2/node_modules \\\n && mv /opt/npm/5.4.2/node_modules/npm-5.4.2 /opt/npm/5.4.2/node_modules/npm \\\n && ln -s /opt/npm/5.4.2/node_modules/npm/bin/npm /opt/npm/5.4.2/npm \\\n && chmod -R 755 /opt/npm/5.4.2/node_modules/npm/bin \\\n && mkdir -p /opt/npm/5.6.0/node_modules \\\n && unzip -q /tmp/npm-5.6.0.zip -d /opt/npm/5.6.0/node_modules \\\n && mv /opt/npm/5.6.0/node_modules/npm-5.6.0 /opt/npm/5.6.0/node_modules/npm \\\n && ln -s /opt/npm/5.6.0/node_modules/npm/bin/npm /opt/npm/5.6.0/npm \\\n && chmod -R 755 /opt/npm/5.6.0/node_modules/npm/bin \\\n && mkdir -p /opt/npm/6.0.1/node_modules \\\n && unzip -q /tmp/npm-6.0.1.zip -d /opt/npm/6.0.1/node_modules \\\n && mv /opt/npm/6.0.1/node_modules/npm-6.0.1 /opt/npm/6.0.1/node_modules/npm \\\n && ln -s /opt/npm/6.0.1/node_modules/npm/bin/npm /opt/npm/6.0.1/npm \\\n && chmod -R 755 /opt/npm/6.0.1/node_modules/npm/bin \\\n && chown -R root:root /opt/npm \\\n && mkdir -p /opt/nodejs \\\n && tar xfJ /tmp/node-v4.4.7-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v4.4.7-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v4.4.7-linux-x64 /opt/nodejs/4.4.7 \\\n && echo \"2.15.8\" > /opt/nodejs/4.4.7/npm.txt \\\n && mkdir -p /opt/nodejs \\\n && tar xfJ /tmp/node-v4.5.0-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v4.5.0-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v4.5.0-linux-x64 /opt/nodejs/4.5.0 \\\n && echo \"2.15.9\" > /opt/nodejs/4.5.0/npm.txt \\\n && tar xfJ /tmp/node-v6.2.2-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v6.2.2-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v6.2.2-linux-x64 /opt/nodejs/6.2.2 \\\n && echo \"3.9.5\" > /opt/nodejs/6.2.2/npm.txt \\\n && tar xfJ /tmp/node-v6.6.0-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v6.6.0-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v6.6.0-linux-x64 /opt/nodejs/6.6.0 \\\n && echo \"3.10.3\" > /opt/nodejs/6.6.0/npm.txt \\\n && tar xfJ /tmp/node-v6.9.3-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v6.9.3-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v6.9.3-linux-x64 /opt/nodejs/6.9.3 \\\n && echo \"3.10.10\" > /opt/nodejs/6.9.3/npm.txt \\\n && tar xfJ /tmp/node-v6.10.3-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v6.10.3-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v6.10.3-linux-x64 /opt/nodejs/6.10.3 \\\n && echo \"3.10.10\" > /opt/nodejs/6.10.3/npm.txt \\\n && tar xfJ /tmp/node-v6.11.0-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v6.11.0-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v6.11.0-linux-x64 /opt/nodejs/6.11.0 \\\n && echo \"3.10.10\" > /opt/nodejs/6.11.0/npm.txt \\\n && tar xfJ /tmp/node-v8.0.0-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v8.0.0-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v8.0.0-linux-x64 /opt/nodejs/8.0.0 \\\n && echo \"5.0.3\" > /opt/nodejs/8.0.0/npm.txt \\\n && tar xfJ /tmp/node-v8.1.0-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v8.1.0-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v8.1.0-linux-x64 /opt/nodejs/8.1.0 \\\n && echo \"5.0.3\" > /opt/nodejs/8.1.0/npm.txt \\\n && tar xfJ /tmp/node-v8.2.1-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v8.2.1-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v8.2.1-linux-x64 /opt/nodejs/8.2.1 \\\n && echo \"5.4.2\" > /opt/nodejs/8.2.1/npm.txt \\\n && tar xfJ /tmp/node-v8.8.1-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v8.8.1-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v8.8.1-linux-x64 /opt/nodejs/8.8.1 \\\n && echo \"5.4.2\" > /opt/nodejs/8.8.1/npm.txt \\\n && tar xfJ /tmp/node-v8.9.4-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v8.9.4-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v8.9.4-linux-x64 /opt/nodejs/8.9.4 \\\n && echo \"5.6.0\" > /opt/nodejs/8.9.4/npm.txt \\\n && tar xfJ /tmp/node-v8.11.2-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v8.11.2-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v8.11.2-linux-x64 /opt/nodejs/8.11.2 \\\n && echo \"5.6.0\" > /opt/nodejs/8.11.2/npm.txt \\\n && tar xfJ /tmp/node-v9.4.0-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v9.4.0-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v9.4.0-linux-x64 /opt/nodejs/9.4.0 \\\n && echo \"5.6.0\" > /opt/nodejs/9.4.0/npm.txt \\\n && tar xfJ /tmp/node-v10.1.0-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v10.1.0-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v10.1.0-linux-x64 /opt/nodejs/10.1.0 \\\n && echo \"6.0.1\" > /opt/nodejs/10.1.0/npm.txt \\\n && chown -R root:root /opt/nodejs \\\n && ln -s /opt/nodejs/6.11.0/bin/node /opt/nodejs/node \\\n && ln -s /opt/nodejs/6.11.0/npm.txt /opt/nodejs/npm.txt \\\n && rm -f /usr/bin/node \\\n && ln -s /opt/nodejs/6.11.0/bin/node /usr/bin/node \\\n && rm -f /opt/nodejs/6.11.0/bin/npm \\\n && ln -s /opt/npm/3.10.10/node_modules/npm/bin/npm /opt/nodejs/npm \\\n && ln -s /opt/npm/3.10.10/node_modules /opt/nodejs/node_modules \\\n && rm -rf /usr/bin/npm \\\n && ln -s /opt/npm/3.10.10/node_modules/npm/bin/npm /usr/bin/npm \\\n && ln -s /opt/npm/3.10.10/node_modules/npm/bin/npm-cli.js /usr/bin/npm-cli.js \\\n && ln -s /opt/npm/3.10.10/node_modules /usr/bin/node_modules\nENV PATH=\"$PATH:/opt/nodejs/6.11.0/bin\"\n#   Upgrade mono\nRUN echo \"deb http://download.mono-project.com/repo/debian beta/. main\" | tee /etc/apt/sources.list.d/mono-xamarin-c7-ms.list \\\n && apt-get update \\\n && apt-get install --no-install-recommends libmono-system-net-http-webrequest4.0-cil=6.8.0.105+dfsg-3.3 -y\n#   Ruby installations\n#   Dependencies for various ruby and rubygem installations\nRUN apt-get install --no-install-recommends libreadline-dev=8.2-1.3 bzip2=1.0.8-5build1 build-essential=12.9ubuntu3 libssl-dev=3.0.8-1ubuntu1 zlib1g-dev=1:1.2.13.dfsg-1ubuntu4 libpq-dev=15.2-1 libsqlite3-dev=3.40.1-1 curl=7.88.1-7ubuntu1 patch=2.7.6-7build2 gawk=1:5.2.1-2 g++=4:12.2.0-3ubuntu1 gcc=4:12.2.0-3ubuntu1 make=4.3-4.1build1 libc6-dev=2.37-0ubuntu2 patch=2.7.6-7build2 libreadline6-dev libyaml-dev=0.2.5-1 sqlite3=3.40.1-1 autoconf=2.71-3 libgdbm-dev=1.23-3 libncurses5-dev=6.4-2 automake=1:1.16.5-1.3 libtool=2.4.7-5 bison=2:3.8.2+dfsg-1build1 pkg-config=1.8.1-1ubuntu2 libffi-dev=3.4.4-1 bison=2:3.8.2+dfsg-1build1 libxslt-dev libxml2-dev=2.9.14+dfsg-1.1build2 libmysqlclient-dev=8.0.32-0ubuntu4 -y\n#   rbenv\nRUN git clone https://github.com/rbenv/rbenv.git /usr/local/.rbenv\nRUN chmod -R 777 /usr/local/.rbenv\nENV RBENV_ROOT=\"/usr/local/.rbenv\"\nENV PATH=\"$RBENV_ROOT/bin:/usr/local:$PATH\"\nRUN git clone https://github.com/rbenv/ruby-build.git /usr/local/.rbenv/plugins/ruby-build\nRUN chmod -R 777 /usr/local/.rbenv/plugins/ruby-build\nRUN /usr/local/.rbenv/plugins/ruby-build/install.sh\n#   Install ruby 2.3.3 (default), 2.3.8, 2.4.5\nENV RUBY_CONFIGURE_OPTS=\"--disable-install-doc\"\nENV RUBY_CFLAGS=\"-O3\"\nRUN eval \"$( rbenv init - ;)\" \\\n && export WEBSITES_DEFAULT_RUBY_VERSION=\"2.3.3\" \\\n && rbenv install $WEBSITES_DEFAULT_RUBY_VERSION \\\n && rbenv install \"2.3.8\" \\\n && rbenv install \"2.4.5\" \\\n && rbenv install \"2.5.5\" \\\n && rbenv install \"2.6.2\" \\\n && rbenv rehash \\\n && rbenv global $WEBSITES_DEFAULT_RUBY_VERSION \\\n && ls /usr/local -a \\\n && rbenv local $WEBSITES_DEFAULT_RUBY_VERSION \\\n && gem install bundler --version 2.4.12 \\\n && rbenv local 2.3.8 \\\n && gem install bundler --version 2.4.12 \\\n && rbenv local 2.4.5 \\\n && gem install bundler --version 2.4.12 \\\n && rbenv local 2.5.5 \\\n && gem install bundler --version 2.4.12 \\\n && rbenv local 2.6.2 \\\n && gem install bundler --version 2.4.12 \\\n && rbenv local $WEBSITES_DEFAULT_RUBY_VERSION \\\n && chmod -R 777 /usr/local/.rbenv/versions \\\n && chmod -R 777 /usr/local/.rbenv/version\nRUN eval \"$( rbenv init - ;)\" \\\n && rbenv global $WEBSITES_DEFAULT_RUBY_VERSION \\\n && bundle config --global build.nokogiri -- --use-system-libraries\n#   Because Nokogiri tries to build libraries on its own otherwise\nENV NOKOGIRI_USE_SYSTEM_LIBRARIES=\"true\"\n#   SQL Server gem support\nRUN apt-get install --no-install-recommends unixodbc-dev=2.3.11-2 freetds-dev=1.3.17+ds-2 freetds-bin=1.3.17+ds-2 -y\n#   Install .NET Core\nRUN apt-get update \\\n && apt-get install --no-install-recommends libc6=2.37-0ubuntu2 libcurl3 libgcc1 libgssapi-krb5-2=1.20.1-1build1 libicu52 liblttng-ust0 libssl1.0.0 libstdc++6=13-20230320-1ubuntu1 libunwind8=1.6.2-3 libuuid1=2.38.1-4ubuntu1 zlib1g=1:1.2.13.dfsg-1ubuntu4 -y \\\n && rm -rf /var/lib/apt/lists/*\n#   Install .NET Core SDK\nENV DOTNET_SDK_VERSION=\"2.1.300\"\nENV DOTNET_SDK_DOWNLOAD_URL=\"https://dotnetcli.blob.core.windows.net/dotnet/Sdk/$DOTNET_SDK_VERSION/dotnet-sdk-$DOTNET_SDK_VERSION-linux-x64.tar.gz\"\nENV DOTNET_SDK_DOWNLOAD_SHA=\"80a6bfb1db5862804e90f819c1adeebe3d624eae0d6147e5d6694333f0458afd7d34ce73623964752971495a310ff7fcc266030ce5aef82d5de7293d94d13770\"\nRUN curl -SL $DOTNET_SDK_DOWNLOAD_URL --output dotnet.tar.gz \\\n && echo \"$DOTNET_SDK_DOWNLOAD_SHA dotnet.tar.gz\" | sha512sum -c - \\\n && mkdir -p /usr/share/dotnet \\\n && tar -zxf dotnet.tar.gz -C /usr/share/dotnet \\\n && rm dotnet.tar.gz \\\n && ln -s /usr/share/dotnet/dotnet /usr/bin/dotnet\n#   Moving the package cache to the container image will require user packages to be repopulated\n#   for each new build done in a new container instance, but it's *much* faster than\n#   using a location on the user's site volume and does not require them to use their storage, and\n#   lets us warm the caches with standard packages\nENV NUGET_PACKAGES=\"/var/nuget\"\n#   Trigger the population of the local package cache and NuGetFallbackFolder\n#   We install the 1.x web templates just so we can create and restore 1.0 and 1.1 MVC apps here\n#   See https://github.com/aspnet/Tooling/blob/master/missing-template.md\n#   Note that after populating the cache we need to chmod 777 every directory underneath\n#   so the Kudu user can access them; this can be removed if we run Kudu as root later.\nENV NUGET_XMLDOC_MODE=\"skip\"\nENV DOTNET_SKIP_FIRST_TIME_EXPERIENCE=\"1\"\nRUN mkdir /var/nuget \\\n && chmod a+rw /var/nuget \\\n && dotnet new -i \"Microsoft.DotNet.Web.ProjectTemplates.1.x::1.0.0-*\" \\\n && mkdir warmup \\\n && cd warmup \\\n && dotnet new \\\n && cd .. \\\n && rm -rf warmup \\\n && mkdir warmup \\\n && cd warmup \\\n && dotnet new mvc -f netcoreapp1.1 \\\n && dotnet restore \\\n && cd .. \\\n && rm -rf warmup \\\n && mkdir warmup \\\n && cd warmup \\\n && dotnet new mvc -f netcoreapp1.0 \\\n && dotnet restore \\\n && cd .. \\\n && rm -rf warmup \\\n && mkdir warmup \\\n && cd warmup \\\n && dotnet new mvc \\\n && dotnet restore \\\n && cd .. \\\n && rm -rf warmup \\\n && rm -rf /tmp/NuGetScratch \\\n && find /var/nuget -type d -exec chmod 777 {}\n#   install apache2\nRUN apt-get install --no-install-recommends apache2=2.4.55-1ubuntu2 -y\nRUN service apache2 restart\n#   Section PHP\nRUN apt-get update ; apt-get install --no-install-recommends libcurl4-openssl-dev=7.88.1-7ubuntu1 libssl-dev=3.0.8-1ubuntu1 zlib1g-dev=1:1.2.13.dfsg-1ubuntu4 libpng-dev=1.6.39-2 libpq-dev=15.2-1 libc-client-dev libsqlite3-dev=3.40.1-1 libgmp-dev=2:6.2.1+dfsg1-1.1ubuntu1 libmcrypt-dev=2.5.8-7 libldap2-dev=2.6.3+dfsg-1~exp1ubuntu2 libtidy-dev=2:5.6.0-11build2 libkrb5-dev=1.20.1-1build1 libicu-dev=72.1-3ubuntu1 libedit-dev=3.1-20221030-2 libxml2-dev=2.9.14+dfsg-1.1build2 libxslt-dev unixodbc-dev=2.3.11-2 libmagickwand-dev=8:6.9.11.60+dfsg-1.6 dpkg-dev=1.21.21ubuntu1 file=1:5.44-3 g++=4:12.2.0-3ubuntu1 gcc=4:12.2.0-3ubuntu1 libc-dev libsodium-dev=1.0.18-1build2 libsodium18 -y \\\n && ln -s /usr/lib/x86_64-linux-gnu/libldap.so /usr/lib/libldap.so\nRUN mkdir -p /usr/local/php/5.6\nCOPY --from=php5.6-build /usr/local/php/5.6 /usr/local/php/5.6\nRUN mkdir -p /usr/local/php/7.0\nCOPY --from=php7.0-build /usr/local/php/7.0 /usr/local/php/7.0\nRUN mkdir -p /usr/local/php/7.2\nCOPY --from=php7.2-build /usr/local/php/7.2 /usr/local/php/7.2\nENV PATH=\"/usr/local/php/7.2/bin:$PATH\"\nENV PHP_5_6_PATH=\"/usr/local/php/5.6/bin\"\nENV PHP_7_0_PATH=\"/usr/local/php/7.0/bin\"\nENV PHP_7_2_PATH=\"/usr/local/php/7.2/bin\"\n#   PHP Composer\nRUN php -r \"copy('https://getcomposer.org/installer', '/tmp/composer-setup.php');\" \\\n && php /tmp/composer-setup.php --install-dir=/usr/local/bin --filename=composer --quiet \\\n && rm -f /tmp/composer-setup.php\nENV PHP_VERSION=\"7.2\"\nENV COMPOSER_VENDOR_DIR=\"/home/site/wwwroot/vendor\"\n#   Golang and musl for cross compiling for alpine.\nENV GOLANG_VERSION=\"1.10\"\nENV GOLANG_DOWNLOAD_URL=\"https://golang.org/dl/go$GOLANG_VERSION.linux-amd64.tar.gz\"\nENV GOLANG_DOWNLOAD_SHA=\"b5a64335f1490277b585832d1f6c7f8c6c11206cba5cd3f771dcb87b98ad1a33\"\nRUN curl -SL $GOLANG_DOWNLOAD_URL --output golang.tar.gz \\\n && echo \"$GOLANG_DOWNLOAD_SHA golang.tar.gz\" | sha256sum -c - \\\n && tar -zxf golang.tar.gz -C /usr/local \\\n && rm golang.tar.gz \\\n && apt-get install --no-install-recommends musl-tools=1.2.3-1 -y\nENV PATH=\"/usr/local/go/bin:$PATH\"\n#   Download Dep executable\nENV DEP_VERSION=\"0.4.1\"\nENV DEP_DOWNLOAD_URL=\"https://github.com/golang/dep/releases/download/v$DEP_VERSION/dep-linux-amd64\"\nENV DEP_DOWNLOAD_SHA=\"31144e465e52ffbc0035248a10ddea61a09bf28b00784fd3fdd9882c8cbb2315\"\nRUN curl -fL -o /usr/local/go/bin/dep $DEP_DOWNLOAD_URL \\\n && echo \"$DEP_DOWNLOAD_SHA /usr/local/go/bin/dep\" | sha256sum -c - \\\n && chmod +x /usr/local/go/bin/dep\n#   Section PYTHON\nRUN set -ex \\\n && savedAptMark=\"$( apt-mark showmanual ;)\" \\\n && apt-get update \\\n && apt-get install --no-install-recommends dpkg-dev=1.21.21ubuntu1 gcc=4:12.2.0-3ubuntu1 libbz2-dev=1.0.8-5build1 libc6-dev=2.37-0ubuntu2 libexpat1-dev=2.5.0-1 libffi-dev=3.4.4-1 libgdbm-dev=1.23-3 liblzma-dev=5.4.1-0.2 libncursesw5-dev=6.4-2 libreadline-dev=8.2-1.3 libsqlite3-dev=3.40.1-1 libssl-dev=3.0.8-1ubuntu1 apt-transport-https=2.6.0 lsb-release=12.0-1ubuntu1 ca-certificates=20230311 make=4.3-4.1build1 tk-dev=8.6.13 tcl-dev=8.6.13 uuid-dev=2.38.1-4ubuntu1 wget=1.21.3-1ubuntu1 xz-utils=5.4.1-0.2 zlib1g-dev=1:1.2.13.dfsg-1ubuntu4 $( command -v gpg > /dev/null || echo 'gnupg dirmngr' ;) -y\nCOPY --from=python-3.6-build /usr/local/python/3.6.6 /usr/local/python/3.6.6\nCOPY --from=python-3.7-build /usr/local/openssl /usr/local/openssl\nCOPY --from=python-3.7-build /usr/local/python/3.7.0 /usr/local/python/3.7.0\nENV PATH=\"/usr/local/python/3.7.0/bin:$PATH\"\nENV PYTHON_3_7_PATH=\"/usr/local/python/3.7.0/bin\"\nENV PYTHON_3_6_PATH=\"/usr/local/python/3.6.6/bin\"\n#   Install Kudu\nCOPY kudu.conf /tmp\nCOPY apache2.conf /tmp\nCOPY Kudu.82.10506.3895.zip /tmp/Kudu.zip\nENV KUDU_VERSION=\"82.10506.3895\"\nRUN npm install kudusync@0.3.0 -g \\\n && cp /tmp/kudu.conf /etc/apache2/sites-available/kudu.conf \\\n && cp /tmp/apache2.conf /etc/apache2/apache2.conf \\\n && unzip -q -o /tmp/Kudu.zip \\\n && mkdir /opt/Kudu \\\n && cp -rf ./$KUDU_VERSION/* /opt/Kudu \\\n && rm -f /tmp/Kudu.zip \\\n && rm -f /tmp/apache2.conf \\\n && rm -f /tmp/kudu.conf \\\n && rm -rf ./$KUDU_VERSION \\\n && cat /opt/Kudu/Web.config | sed 's| <location path=\".\" inheritInChildApplications=\"false\">| <location path=\"~/../../../opt/Kudu\" inheritInChildApplications=\"false\">|' > /opt/Kudu/Web.config2 \\\n && mv /opt/Kudu/Web.config2 /opt/Kudu/Web.config \\\n && chmod 755 /opt/Kudu/bin/kudu.exe \\\n && chmod 755 /opt/Kudu/bin/node_modules/.bin/kuduscript \\\n && chmod 755 /opt/Kudu/bin/Scripts/starter.sh \\\n && mkdir -p /opt/Kudu/local \\\n && chmod 755 /opt/Kudu/local\n#   Install pm2 and pm2-logrotate\nRUN npm install pm2@latest -g \\\n && pm2 install pm2-logrotate \\\n && pm2 set pm2-logrotate:retain 7\n#   Install LogAnalyzer\nCOPY LogAnalyzer.zip /tmp\nRUN mkdir /opt/LogAnalyzer \\\n && unzip /tmp/LogAnalyzer.zip -d /opt/LogAnalyzer \\\n && rm -f /tmp/LogAnalyzer.zip\nCOPY startup.sh /\nRUN chmod 755 /startup.sh \\\n && mkdir -p /home/LogFiles\n#   Remove extraneous config mono config load that starts up\n#   an unnecessary mono process\nRUN sed -i '$d' /etc/apache2/mods-enabled/mod_mono.conf\n#   Install TunnelExtension\nCOPY TunnelExtension.zip /tmp\nRUN mkdir /opt/tunnelext \\\n && unzip /tmp/TunnelExtension.zip -d /opt/tunnelext \\\n && chmod 777 /opt/tunnelext/tunnelwatcher.sh\n#   Install webssh\nCOPY webssh.zip /tmp\nRUN mkdir /opt/webssh \\\n && unzip /tmp/webssh.zip -d /opt/webssh\n#   Replace ssh with wrapper script for CIFS mount permissions workaround\nCOPY ssh /tmp\nRUN mv /usr/bin/ssh /usr/bin/ssh.original \\\n && mv /tmp/ssh /usr/bin/ssh \\\n && chown root:root /usr/bin/ssh \\\n && chmod 755 /usr/bin/ssh\nCOPY hostingstart.html /home/site/wwwroot/hostingstart.html\nCOPY KuduStaticFiles/503.html /opt/Kudu/503.html\nCOPY KuduStaticFiles/_Layout.cshtml /opt/Kudu/_Layout.cshtml\nCOPY KuduStaticFiles/AppService.png /opt/Kudu/Content/Images/AppService.png\nCOPY KuduStaticFiles/linux_favicon.ico /opt/Kudu/linux_favicon.ico\nCOPY deploy.bash.python.template /opt/Kudu/bin/node_modules/kuduscript/lib/templates/deploy.bash.python.template\nCOPY deploy.bash.ruby.template /opt/Kudu/bin/node_modules/kuduscript/lib/templates/deploy.bash.ruby.template\nRUN chmod -R 777 /home \\\n && rm -rf /tmp/*\nEXPOSE 8181/tcp\nENV PORT=\"8181\"\nENTRYPOINT [\"/startup.sh\"]\nCMD [\"1002\", \"kudu_group\", \"1001\", \"kudu_user\", \"localsite\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM appsvctest/php-build-5.6:latest AS php5.6-build\nFROM appsvctest/php-build-7.0:latest AS php7.0-build\nFROM appsvctest/php-build-7.2:latest AS php7.2-build\nFROM appsvctest/python-3.6-build:latest AS python-3.6-build\nFROM appsvctest/python-3.7-build:latest AS python-3.7-build\nFROM buildpack-deps:jessie-curl AS main\nMAINTAINER Nazim Lala <naziml@microsoft.com>\nENV DEBIAN_FRONTEND=\"noninteractive\"\nCOPY mod_mono.tar /tmp\n#  Install dependencies\nRUN apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys 3FA7E0328081BFF6A14DA29AA6A19B38D3D831EF \\\n && echo \"deb http://download.mono-project.com/repo/debian jessie/snapshots/5.0.0.100/. main\" > /etc/apt/sources.list.d/mono-xamarin.list \\\n && echo \"deb http://deb.debian.org/debian/ jessie main\" >> /etc/apt/sources.list \\\n && echo \"deb-src http://deb.debian.org/debian/ jessie main\" >> /etc/apt/sources.list \\\n && echo \"deb http://security.debian.org/ jessie/updates main\" >> /etc/apt/sources.list \\\n && echo \"deb-src http://security.debian.org/ jessie/updates main\" >> /etc/apt/sources.list \\\n && echo \"deb http://archive.debian.org/debian jessie-backports main\" >> /etc/apt/sources.list \\\n && echo \"deb-src http://archive.debian.org/debian jessie-backports main\" >> /etc/apt/sources.list \\\n && echo \"Acquire::Check-Valid-Until \\\"false\\\";\" > /etc/apt/apt.conf \\\n && apt-get update \\\n && apt-get install --no-install-recommends apt-utils -y \\\n && apt-get install --no-install-recommends unzip -y \\\n && apt-get install --no-install-recommends xz-utils -y \\\n && apt-get install --no-install-recommends mono-complete -y \\\n && apt-get install --no-install-recommends mono-apache-server4 -y \\\n && apt-get install --no-install-recommends libapache2-mod-mono -y \\\n && apt-get install --no-install-recommends git -y \\\n && apt-get install --no-install-recommends openssh-client -y \\\n && apt-get install --no-install-recommends vim tree -y \\\n && apt-get install tcptraceroute -y \\\n && wget -O /tmp/node-v4.4.7-linux-x64.tar.xz https://nodejs.org/dist/v4.4.7/node-v4.4.7-linux-x64.tar.xz \\\n && wget -O /tmp/node-v4.5.0-linux-x64.tar.xz https://nodejs.org/dist/v4.5.0/node-v4.5.0-linux-x64.tar.xz \\\n && wget -O /tmp/node-v6.2.2-linux-x64.tar.xz https://nodejs.org/dist/v6.2.2/node-v6.2.2-linux-x64.tar.xz \\\n && wget -O /tmp/node-v6.6.0-linux-x64.tar.xz https://nodejs.org/dist/v6.6.0/node-v6.6.0-linux-x64.tar.xz \\\n && wget -O /tmp/node-v6.9.3-linux-x64.tar.xz https://nodejs.org/dist/v6.9.3/node-v6.9.3-linux-x64.tar.xz \\\n && wget -O /tmp/node-v6.10.3-linux-x64.tar.xz https://nodejs.org/dist/v6.10.3/node-v6.10.3-linux-x64.tar.xz \\\n && wget -O /tmp/node-v6.11.0-linux-x64.tar.xz https://nodejs.org/dist/v6.11.0/node-v6.11.0-linux-x64.tar.xz \\\n && wget -O /tmp/node-v8.0.0-linux-x64.tar.xz https://nodejs.org/dist/v8.0.0/node-v8.0.0-linux-x64.tar.xz \\\n && wget -O /tmp/node-v8.1.0-linux-x64.tar.xz https://nodejs.org/dist/v8.1.0/node-v8.1.0-linux-x64.tar.xz \\\n && wget -O /tmp/node-v8.2.1-linux-x64.tar.xz https://nodejs.org/dist/v8.2.1/node-v8.2.1-linux-x64.tar.xz \\\n && wget -O /tmp/node-v8.8.1-linux-x64.tar.xz https://nodejs.org/dist/v8.8.1/node-v8.8.1-linux-x64.tar.xz \\\n && wget -O /tmp/node-v8.9.4-linux-x64.tar.xz https://nodejs.org/dist/v8.9.4/node-v8.9.4-linux-x64.tar.xz \\\n && wget -O /tmp/node-v8.11.2-linux-x64.tar.xz https://nodejs.org/dist/v8.11.2/node-v8.11.2-linux-x64.tar.xz \\\n && wget -O /tmp/node-v9.4.0-linux-x64.tar.xz https://nodejs.org/dist/v9.4.0/node-v9.4.0-linux-x64.tar.xz \\\n && wget -O /tmp/node-v10.1.0-linux-x64.tar.xz https://nodejs.org/dist/v10.1.0/node-v10.1.0-linux-x64.tar.xz \\\n && wget -O /tmp/npm-2.15.8.zip https://github.com/npm/npm/archive/v2.15.8.zip \\\n && wget -O /tmp/npm-2.15.9.zip https://github.com/npm/npm/archive/v2.15.9.zip \\\n && wget -O /tmp/npm-3.9.5.zip https://github.com/npm/npm/archive/v3.9.5.zip \\\n && wget -O /tmp/npm-3.10.3.zip https://github.com/npm/npm/archive/v3.10.3.zip \\\n && wget -O /tmp/npm-3.10.10.zip https://github.com/npm/npm/archive/v3.10.10.zip \\\n && wget -O /tmp/npm-5.0.3.zip https://github.com/npm/npm/archive/v5.0.3.zip \\\n && wget -O /tmp/npm-5.4.2.zip https://github.com/npm/npm/archive/v5.4.2.zip \\\n && wget -O /tmp/npm-5.6.0.zip https://github.com/npm/npm/archive/v5.6.0.zip \\\n && wget -O /tmp/npm-6.0.1.zip https://github.com/npm/npm/archive/v6.0.1.zip \\\n && ln -s ../mods-available/xml2enc.load /etc/apache2/mods-enabled \\\n && a2enmod proxy \\\n && a2enmod proxy_http \\\n && a2enmod proxy_wstunnel \\\n && a2enmod rewrite \\\n && a2enmod proxy_ajp \\\n && a2enmod deflate \\\n && a2enmod headers \\\n && a2enmod proxy_balancer \\\n && a2enmod proxy_connect \\\n && a2enmod proxy_html \\\n && tar -xf /tmp/mod_mono.tar \\\n && cp mod_mono.so.0.0.0 /usr/lib/apache2/modules/mod_mono.so.0.0.0\n#  Install npm and node\nRUN mkdir -p /opt/npm/2.15.8/node_modules \\\n && unzip -q /tmp/npm-2.15.8.zip -d /opt/npm/2.15.8/node_modules \\\n && mv /opt/npm/2.15.8/node_modules/npm-2.15.8 /opt/npm/2.15.8/node_modules/npm \\\n && ln -s /opt/npm/2.15.8/node_modules/npm/bin/npm /opt/npm/2.15.8/npm \\\n && chmod -R 755 /opt/npm/2.15.8/node_modules/npm/bin \\\n && mkdir -p /opt/npm/2.15.9/node_modules \\\n && unzip -q /tmp/npm-2.15.9.zip -d /opt/npm/2.15.9/node_modules \\\n && mv /opt/npm/2.15.9/node_modules/npm-2.15.9 /opt/npm/2.15.9/node_modules/npm \\\n && ln -s /opt/npm/2.15.9/node_modules/npm/bin/npm /opt/npm/2.15.9/npm \\\n && chmod -R 755 /opt/npm/2.15.9/node_modules/npm/bin \\\n && mkdir -p /opt/npm/3.9.5/node_modules \\\n && unzip -q /tmp/npm-3.9.5.zip -d /opt/npm/3.9.5/node_modules \\\n && mv /opt/npm/3.9.5/node_modules/npm-3.9.5 /opt/npm/3.9.5/node_modules/npm \\\n && ln -s /opt/npm/3.9.5/node_modules/npm/bin/npm /opt/npm/3.9.5/npm \\\n && chmod -R 755 /opt/npm/3.9.5/node_modules/npm/bin \\\n && mkdir -p /opt/npm/3.10.3/node_modules \\\n && unzip -q /tmp/npm-3.10.3.zip -d /opt/npm/3.10.3/node_modules \\\n && mv /opt/npm/3.10.3/node_modules/npm-3.10.3 /opt/npm/3.10.3/node_modules/npm \\\n && ln -s /opt/npm/3.10.3/node_modules/npm/bin/npm /opt/npm/3.10.3/npm \\\n && chmod -R 755 /opt/npm/3.10.3/node_modules/npm/bin \\\n && mkdir -p /opt/npm/3.10.10/node_modules \\\n && unzip -q /tmp/npm-3.10.10.zip -d /opt/npm/3.10.10/node_modules \\\n && mv /opt/npm/3.10.10/node_modules/npm-3.10.10 /opt/npm/3.10.10/node_modules/npm \\\n && ln -s /opt/npm/3.10.10/node_modules/npm/bin/npm /opt/npm/3.10.10/npm \\\n && chmod -R 755 /opt/npm/3.10.10/node_modules/npm/bin \\\n && mkdir -p /opt/npm/5.0.3/node_modules \\\n && unzip -q /tmp/npm-5.0.3.zip -d /opt/npm/5.0.3/node_modules \\\n && mv /opt/npm/5.0.3/node_modules/npm-5.0.3 /opt/npm/5.0.3/node_modules/npm \\\n && ln -s /opt/npm/5.0.3/node_modules/npm/bin/npm /opt/npm/5.0.3/npm \\\n && chmod -R 755 /opt/npm/5.0.3/node_modules/npm/bin \\\n && mkdir -p /opt/npm/5.4.2/node_modules \\\n && unzip -q /tmp/npm-5.4.2.zip -d /opt/npm/5.4.2/node_modules \\\n && mv /opt/npm/5.4.2/node_modules/npm-5.4.2 /opt/npm/5.4.2/node_modules/npm \\\n && ln -s /opt/npm/5.4.2/node_modules/npm/bin/npm /opt/npm/5.4.2/npm \\\n && chmod -R 755 /opt/npm/5.4.2/node_modules/npm/bin \\\n && mkdir -p /opt/npm/5.6.0/node_modules \\\n && unzip -q /tmp/npm-5.6.0.zip -d /opt/npm/5.6.0/node_modules \\\n && mv /opt/npm/5.6.0/node_modules/npm-5.6.0 /opt/npm/5.6.0/node_modules/npm \\\n && ln -s /opt/npm/5.6.0/node_modules/npm/bin/npm /opt/npm/5.6.0/npm \\\n && chmod -R 755 /opt/npm/5.6.0/node_modules/npm/bin \\\n && mkdir -p /opt/npm/6.0.1/node_modules \\\n && unzip -q /tmp/npm-6.0.1.zip -d /opt/npm/6.0.1/node_modules \\\n && mv /opt/npm/6.0.1/node_modules/npm-6.0.1 /opt/npm/6.0.1/node_modules/npm \\\n && ln -s /opt/npm/6.0.1/node_modules/npm/bin/npm /opt/npm/6.0.1/npm \\\n && chmod -R 755 /opt/npm/6.0.1/node_modules/npm/bin \\\n && chown -R root:root /opt/npm \\\n && mkdir -p /opt/nodejs \\\n && tar xfJ /tmp/node-v4.4.7-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v4.4.7-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v4.4.7-linux-x64 /opt/nodejs/4.4.7 \\\n && echo \"2.15.8\" > /opt/nodejs/4.4.7/npm.txt \\\n && mkdir -p /opt/nodejs \\\n && tar xfJ /tmp/node-v4.5.0-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v4.5.0-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v4.5.0-linux-x64 /opt/nodejs/4.5.0 \\\n && echo \"2.15.9\" > /opt/nodejs/4.5.0/npm.txt \\\n && tar xfJ /tmp/node-v6.2.2-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v6.2.2-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v6.2.2-linux-x64 /opt/nodejs/6.2.2 \\\n && echo \"3.9.5\" > /opt/nodejs/6.2.2/npm.txt \\\n && tar xfJ /tmp/node-v6.6.0-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v6.6.0-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v6.6.0-linux-x64 /opt/nodejs/6.6.0 \\\n && echo \"3.10.3\" > /opt/nodejs/6.6.0/npm.txt \\\n && tar xfJ /tmp/node-v6.9.3-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v6.9.3-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v6.9.3-linux-x64 /opt/nodejs/6.9.3 \\\n && echo \"3.10.10\" > /opt/nodejs/6.9.3/npm.txt \\\n && tar xfJ /tmp/node-v6.10.3-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v6.10.3-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v6.10.3-linux-x64 /opt/nodejs/6.10.3 \\\n && echo \"3.10.10\" > /opt/nodejs/6.10.3/npm.txt \\\n && tar xfJ /tmp/node-v6.11.0-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v6.11.0-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v6.11.0-linux-x64 /opt/nodejs/6.11.0 \\\n && echo \"3.10.10\" > /opt/nodejs/6.11.0/npm.txt \\\n && tar xfJ /tmp/node-v8.0.0-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v8.0.0-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v8.0.0-linux-x64 /opt/nodejs/8.0.0 \\\n && echo \"5.0.3\" > /opt/nodejs/8.0.0/npm.txt \\\n && tar xfJ /tmp/node-v8.1.0-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v8.1.0-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v8.1.0-linux-x64 /opt/nodejs/8.1.0 \\\n && echo \"5.0.3\" > /opt/nodejs/8.1.0/npm.txt \\\n && tar xfJ /tmp/node-v8.2.1-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v8.2.1-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v8.2.1-linux-x64 /opt/nodejs/8.2.1 \\\n && echo \"5.4.2\" > /opt/nodejs/8.2.1/npm.txt \\\n && tar xfJ /tmp/node-v8.8.1-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v8.8.1-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v8.8.1-linux-x64 /opt/nodejs/8.8.1 \\\n && echo \"5.4.2\" > /opt/nodejs/8.8.1/npm.txt \\\n && tar xfJ /tmp/node-v8.9.4-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v8.9.4-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v8.9.4-linux-x64 /opt/nodejs/8.9.4 \\\n && echo \"5.6.0\" > /opt/nodejs/8.9.4/npm.txt \\\n && tar xfJ /tmp/node-v8.11.2-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v8.11.2-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v8.11.2-linux-x64 /opt/nodejs/8.11.2 \\\n && echo \"5.6.0\" > /opt/nodejs/8.11.2/npm.txt \\\n && tar xfJ /tmp/node-v9.4.0-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v9.4.0-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v9.4.0-linux-x64 /opt/nodejs/9.4.0 \\\n && echo \"5.6.0\" > /opt/nodejs/9.4.0/npm.txt \\\n && tar xfJ /tmp/node-v10.1.0-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v10.1.0-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v10.1.0-linux-x64 /opt/nodejs/10.1.0 \\\n && echo \"6.0.1\" > /opt/nodejs/10.1.0/npm.txt \\\n && chown -R root:root /opt/nodejs \\\n && ln -s /opt/nodejs/6.11.0/bin/node /opt/nodejs/node \\\n && ln -s /opt/nodejs/6.11.0/npm.txt /opt/nodejs/npm.txt \\\n && rm -f /usr/bin/node \\\n && ln -s /opt/nodejs/6.11.0/bin/node /usr/bin/node \\\n && rm -f /opt/nodejs/6.11.0/bin/npm \\\n && ln -s /opt/npm/3.10.10/node_modules/npm/bin/npm /opt/nodejs/npm \\\n && ln -s /opt/npm/3.10.10/node_modules /opt/nodejs/node_modules \\\n && rm -rf /usr/bin/npm \\\n && ln -s /opt/npm/3.10.10/node_modules/npm/bin/npm /usr/bin/npm \\\n && ln -s /opt/npm/3.10.10/node_modules/npm/bin/npm-cli.js /usr/bin/npm-cli.js \\\n && ln -s /opt/npm/3.10.10/node_modules /usr/bin/node_modules\nENV PATH=\"$PATH:/opt/nodejs/6.11.0/bin\"\n#  Upgrade mono\nRUN echo \"deb http://download.mono-project.com/repo/debian beta/. main\" | tee /etc/apt/sources.list.d/mono-xamarin-c7-ms.list \\\n && apt-get update \\\n && apt-get install --no-install-recommends libmono-system-net-http-webrequest4.0-cil -y\n#  Ruby installations\n#  Dependencies for various ruby and rubygem installations\nRUN apt-get install --no-install-recommends libreadline-dev bzip2 build-essential libssl-dev zlib1g-dev libpq-dev libsqlite3-dev curl patch gawk g++ gcc make libc6-dev patch libreadline6-dev libyaml-dev sqlite3 autoconf libgdbm-dev libncurses5-dev automake libtool bison pkg-config libffi-dev bison libxslt-dev libxml2-dev libmysqlclient-dev -y\n#  rbenv\nRUN git clone https://github.com/rbenv/rbenv.git /usr/local/.rbenv\nRUN chmod -R 777 /usr/local/.rbenv\nENV RBENV_ROOT=\"/usr/local/.rbenv\"\nENV PATH=\"$RBENV_ROOT/bin:/usr/local:$PATH\"\nRUN git clone https://github.com/rbenv/ruby-build.git /usr/local/.rbenv/plugins/ruby-build\nRUN chmod -R 777 /usr/local/.rbenv/plugins/ruby-build\nRUN /usr/local/.rbenv/plugins/ruby-build/install.sh\n#  Install ruby 2.3.3 (default), 2.3.8, 2.4.5\nENV RUBY_CONFIGURE_OPTS=\"--disable-install-doc\"\nENV RUBY_CFLAGS=\"-O3\"\nRUN eval \"$( rbenv init - ;)\" \\\n && export WEBSITES_DEFAULT_RUBY_VERSION=\"2.3.3\" \\\n && rbenv install $WEBSITES_DEFAULT_RUBY_VERSION \\\n && rbenv install \"2.3.8\" \\\n && rbenv install \"2.4.5\" \\\n && rbenv install \"2.5.5\" \\\n && rbenv install \"2.6.2\" \\\n && rbenv rehash \\\n && rbenv global $WEBSITES_DEFAULT_RUBY_VERSION \\\n && ls /usr/local -a \\\n && rbenv local $WEBSITES_DEFAULT_RUBY_VERSION \\\n && gem install bundler \\\n && rbenv local 2.3.8 \\\n && gem install bundler \\\n && rbenv local 2.4.5 \\\n && gem install bundler \\\n && rbenv local 2.5.5 \\\n && gem install bundler \\\n && rbenv local 2.6.2 \\\n && gem install bundler \\\n && rbenv local $WEBSITES_DEFAULT_RUBY_VERSION \\\n && chmod -R 777 /usr/local/.rbenv/versions \\\n && chmod -R 777 /usr/local/.rbenv/version\nRUN eval \"$( rbenv init - ;)\" \\\n && rbenv global $WEBSITES_DEFAULT_RUBY_VERSION \\\n && bundle config --global build.nokogiri -- --use-system-libraries\n#  Because Nokogiri tries to build libraries on its own otherwise\nENV NOKOGIRI_USE_SYSTEM_LIBRARIES=\"true\"\n#  SQL Server gem support\nRUN apt-get install unixodbc-dev freetds-dev freetds-bin -y\n#  Install .NET Core\nRUN apt-get update \\\n && apt-get install --no-install-recommends libc6 libcurl3 libgcc1 libgssapi-krb5-2 libicu52 liblttng-ust0 libssl1.0.0 libstdc++6 libunwind8 libuuid1 zlib1g -y \\\n && rm -rf /var/lib/apt/lists/*\n#  Install .NET Core SDK\nENV DOTNET_SDK_VERSION=\"2.1.300\"\nENV DOTNET_SDK_DOWNLOAD_URL=\"https://dotnetcli.blob.core.windows.net/dotnet/Sdk/$DOTNET_SDK_VERSION/dotnet-sdk-$DOTNET_SDK_VERSION-linux-x64.tar.gz\"\nENV DOTNET_SDK_DOWNLOAD_SHA=\"80a6bfb1db5862804e90f819c1adeebe3d624eae0d6147e5d6694333f0458afd7d34ce73623964752971495a310ff7fcc266030ce5aef82d5de7293d94d13770\"\nRUN curl -SL $DOTNET_SDK_DOWNLOAD_URL --output dotnet.tar.gz \\\n && echo \"$DOTNET_SDK_DOWNLOAD_SHA dotnet.tar.gz\" | sha512sum -c - \\\n && mkdir -p /usr/share/dotnet \\\n && tar -zxf dotnet.tar.gz -C /usr/share/dotnet \\\n && rm dotnet.tar.gz \\\n && ln -s /usr/share/dotnet/dotnet /usr/bin/dotnet\n#  Moving the package cache to the container image will require user packages to be repopulated\n#  for each new build done in a new container instance, but it's *much* faster than\n#  using a location on the user's site volume and does not require them to use their storage, and\n#  lets us warm the caches with standard packages\nENV NUGET_PACKAGES=\"/var/nuget\"\n#  Trigger the population of the local package cache and NuGetFallbackFolder\n#  We install the 1.x web templates just so we can create and restore 1.0 and 1.1 MVC apps here\n#  See https://github.com/aspnet/Tooling/blob/master/missing-template.md\n#  Note that after populating the cache we need to chmod 777 every directory underneath\n#  so the Kudu user can access them; this can be removed if we run Kudu as root later.\nENV NUGET_XMLDOC_MODE=\"skip\"\nENV DOTNET_SKIP_FIRST_TIME_EXPERIENCE=\"1\"\nRUN mkdir /var/nuget \\\n && chmod a+rw /var/nuget \\\n && dotnet new -i \"Microsoft.DotNet.Web.ProjectTemplates.1.x::1.0.0-*\" \\\n && mkdir warmup \\\n && cd warmup \\\n && dotnet new \\\n && cd .. \\\n && rm -rf warmup \\\n && mkdir warmup \\\n && cd warmup \\\n && dotnet new mvc -f netcoreapp1.1 \\\n && dotnet restore \\\n && cd .. \\\n && rm -rf warmup \\\n && mkdir warmup \\\n && cd warmup \\\n && dotnet new mvc -f netcoreapp1.0 \\\n && dotnet restore \\\n && cd .. \\\n && rm -rf warmup \\\n && mkdir warmup \\\n && cd warmup \\\n && dotnet new mvc \\\n && dotnet restore \\\n && cd .. \\\n && rm -rf warmup \\\n && rm -rf /tmp/NuGetScratch \\\n && find /var/nuget -type d -exec chmod 777 {} ;\n#  install apache2\nRUN apt-get install apache2 -y\nRUN service apache2 restart\n#  Section PHP\nRUN apt-get update ; apt-get install --no-install-recommends libcurl4-openssl-dev libssl-dev zlib1g-dev libpng-dev libpq-dev libc-client-dev libsqlite3-dev libgmp-dev libmcrypt-dev libldap2-dev libtidy-dev libkrb5-dev libicu-dev libedit-dev libxml2-dev libxslt-dev unixodbc-dev libmagickwand-dev dpkg-dev file g++ gcc libc-dev libsodium-dev libsodium18 -y \\\n && ln -s /usr/lib/x86_64-linux-gnu/libldap.so /usr/lib/libldap.so\nRUN mkdir -p /usr/local/php/5.6\nCOPY --from=php5.6-build /usr/local/php/5.6 /usr/local/php/5.6\nRUN mkdir -p /usr/local/php/7.0\nCOPY --from=php7.0-build /usr/local/php/7.0 /usr/local/php/7.0\nRUN mkdir -p /usr/local/php/7.2\nCOPY --from=php7.2-build /usr/local/php/7.2 /usr/local/php/7.2\nENV PATH=\"/usr/local/php/7.2/bin:$PATH\"\nENV PHP_5_6_PATH=\"/usr/local/php/5.6/bin\"\nENV PHP_7_0_PATH=\"/usr/local/php/7.0/bin\"\nENV PHP_7_2_PATH=\"/usr/local/php/7.2/bin\"\n#  PHP Composer\nRUN php -r \"copy('https://getcomposer.org/installer', '/tmp/composer-setup.php');\" \\\n && php /tmp/composer-setup.php --install-dir=/usr/local/bin --filename=composer --quiet \\\n && rm -f /tmp/composer-setup.php\nENV PHP_VERSION=\"7.2\"\nENV COMPOSER_VENDOR_DIR=\"/home/site/wwwroot/vendor\"\n#  Golang and musl for cross compiling for alpine.\nENV GOLANG_VERSION=\"1.10\"\nENV GOLANG_DOWNLOAD_URL=\"https://golang.org/dl/go$GOLANG_VERSION.linux-amd64.tar.gz\"\nENV GOLANG_DOWNLOAD_SHA=\"b5a64335f1490277b585832d1f6c7f8c6c11206cba5cd3f771dcb87b98ad1a33\"\nRUN curl -SL $GOLANG_DOWNLOAD_URL --output golang.tar.gz \\\n && echo \"$GOLANG_DOWNLOAD_SHA golang.tar.gz\" | sha256sum -c - \\\n && tar -zxf golang.tar.gz -C /usr/local \\\n && rm golang.tar.gz \\\n && apt-get install musl-tools -y\nENV PATH=\"/usr/local/go/bin:$PATH\"\n#  Download Dep executable\nENV DEP_VERSION=\"0.4.1\"\nENV DEP_DOWNLOAD_URL=\"https://github.com/golang/dep/releases/download/v$DEP_VERSION/dep-linux-amd64\"\nENV DEP_DOWNLOAD_SHA=\"31144e465e52ffbc0035248a10ddea61a09bf28b00784fd3fdd9882c8cbb2315\"\nRUN curl -fL -o /usr/local/go/bin/dep $DEP_DOWNLOAD_URL \\\n && echo \"$DEP_DOWNLOAD_SHA /usr/local/go/bin/dep\" | sha256sum -c - \\\n && chmod +x /usr/local/go/bin/dep\n#  Section PYTHON\nRUN set -ex \\\n && savedAptMark=\"$( apt-mark showmanual ;)\" \\\n && apt-get update \\\n && apt-get install --no-install-recommends dpkg-dev gcc libbz2-dev libc6-dev libexpat1-dev libffi-dev libgdbm-dev liblzma-dev libncursesw5-dev libreadline-dev libsqlite3-dev libssl-dev apt-transport-https lsb-release ca-certificates make tk-dev tcl-dev uuid-dev wget xz-utils zlib1g-dev $( command -v gpg > /dev/null || echo 'gnupg dirmngr' ;) -y\nCOPY --from=python-3.6-build /usr/local/python/3.6.6 /usr/local/python/3.6.6\nCOPY --from=python-3.7-build /usr/local/openssl /usr/local/openssl\nCOPY --from=python-3.7-build /usr/local/python/3.7.0 /usr/local/python/3.7.0\nENV PATH=\"/usr/local/python/3.7.0/bin:$PATH\"\nENV PYTHON_3_7_PATH=\"/usr/local/python/3.7.0/bin\"\nENV PYTHON_3_6_PATH=\"/usr/local/python/3.6.6/bin\"\n#  Install Kudu\nCOPY kudu.conf /tmp\nCOPY apache2.conf /tmp\nCOPY Kudu.82.10506.3895.zip /tmp/Kudu.zip\nENV KUDU_VERSION=\"82.10506.3895\"\nRUN npm install kudusync -g \\\n && cp /tmp/kudu.conf /etc/apache2/sites-available/kudu.conf \\\n && cp /tmp/apache2.conf /etc/apache2/apache2.conf \\\n && unzip -q -o /tmp/Kudu.zip \\\n && mkdir /opt/Kudu \\\n && cp -rf ./$KUDU_VERSION/* /opt/Kudu \\\n && rm -f /tmp/Kudu.zip \\\n && rm -f /tmp/apache2.conf \\\n && rm -f /tmp/kudu.conf \\\n && rm -rf ./$KUDU_VERSION \\\n && cat /opt/Kudu/Web.config | sed 's| <location path=\".\" inheritInChildApplications=\"false\">| <location path=\"~/../../../opt/Kudu\" inheritInChildApplications=\"false\">|' > /opt/Kudu/Web.config2 \\\n && mv /opt/Kudu/Web.config2 /opt/Kudu/Web.config \\\n && chmod 755 /opt/Kudu/bin/kudu.exe \\\n && chmod 755 /opt/Kudu/bin/node_modules/.bin/kuduscript \\\n && chmod 755 /opt/Kudu/bin/Scripts/starter.sh \\\n && mkdir -p /opt/Kudu/local \\\n && chmod 755 /opt/Kudu/local\n#  Install pm2 and pm2-logrotate\nRUN npm install pm2@latest -g \\\n && pm2 install pm2-logrotate \\\n && pm2 set pm2-logrotate:retain 7\n#  Install LogAnalyzer\nCOPY LogAnalyzer.zip /tmp\nRUN mkdir /opt/LogAnalyzer \\\n && unzip /tmp/LogAnalyzer.zip -d /opt/LogAnalyzer \\\n && rm -f /tmp/LogAnalyzer.zip\nCOPY startup.sh /\nRUN chmod 755 /startup.sh \\\n && mkdir -p /home/LogFiles\n#  Remove extraneous config mono config load that starts up\n#  an unnecessary mono process\nRUN sed -i '$d' /etc/apache2/mods-enabled/mod_mono.conf\n#  Install TunnelExtension\nCOPY TunnelExtension.zip /tmp\nRUN mkdir /opt/tunnelext \\\n && unzip /tmp/TunnelExtension.zip -d /opt/tunnelext \\\n && chmod 777 /opt/tunnelext/tunnelwatcher.sh\n#  Install webssh\nCOPY webssh.zip /tmp\nRUN mkdir /opt/webssh \\\n && unzip /tmp/webssh.zip -d /opt/webssh\n#  Replace ssh with wrapper script for CIFS mount permissions workaround\nCOPY ssh /tmp\nRUN mv /usr/bin/ssh /usr/bin/ssh.original \\\n && mv /tmp/ssh /usr/bin/ssh \\\n && chown root:root /usr/bin/ssh \\\n && chmod 755 /usr/bin/ssh\nCOPY hostingstart.html /home/site/wwwroot/hostingstart.html\nCOPY KuduStaticFiles/503.html /opt/Kudu/503.html\nCOPY KuduStaticFiles/_Layout.cshtml /opt/Kudu/_Layout.cshtml\nCOPY KuduStaticFiles/AppService.png /opt/Kudu/Content/Images/AppService.png\nCOPY KuduStaticFiles/linux_favicon.ico /opt/Kudu/linux_favicon.ico\nCOPY deploy.bash.python.template /opt/Kudu/bin/node_modules/kuduscript/lib/templates/deploy.bash.python.template\nCOPY deploy.bash.ruby.template /opt/Kudu/bin/node_modules/kuduscript/lib/templates/deploy.bash.ruby.template\nRUN chmod -R 777 /home \\\n && rm -rf /tmp/*\nEXPOSE 8181/tcp\nENV PORT=\"8181\"\nENTRYPOINT [\"/startup.sh\"]\nCMD [\"1002\", \"kudu_group\", \"1001\", \"kudu_user\", \"localsite\"]\n","injectedSmells":[],"originalDockerfileHash":"68658a099fed2b013924cd5397a5a184","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM appsvctest/php-build-5.6:latest AS php5.6-build\nFROM appsvctest/php-build-7.0:latest AS php7.0-build\nFROM appsvctest/php-build-7.2:latest AS php7.2-build\nFROM appsvctest/python-3.6-build:latest AS python-3.6-build\nFROM appsvctest/python-3.7-build:latest AS python-3.7-build\nFROM buildpack-deps:jessie-curl AS main\nMAINTAINER Nazim Lala <naziml@microsoft.com>\nENV DEBIAN_FRONTEND=\"noninteractive\"\nCOPY mod_mono.tar /tmp\n#   Install dependencies\nRUN apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys 3FA7E0328081BFF6A14DA29AA6A19B38D3D831EF \\\n && echo \"deb http://download.mono-project.com/repo/debian jessie/snapshots/5.0.0.100/. main\" > /etc/apt/sources.list.d/mono-xamarin.list \\\n && echo \"deb http://deb.debian.org/debian/ jessie main\" >> /etc/apt/sources.list \\\n && echo \"deb-src http://deb.debian.org/debian/ jessie main\" >> /etc/apt/sources.list \\\n && echo \"deb http://security.debian.org/ jessie/updates main\" >> /etc/apt/sources.list \\\n && echo \"deb-src http://security.debian.org/ jessie/updates main\" >> /etc/apt/sources.list \\\n && echo \"deb http://archive.debian.org/debian jessie-backports main\" >> /etc/apt/sources.list \\\n && echo \"deb-src http://archive.debian.org/debian jessie-backports main\" >> /etc/apt/sources.list \\\n && echo \"Acquire::Check-Valid-Until \\\"false\\\";\" > /etc/apt/apt.conf \\\n && apt-get update \\\n && apt-get install --no-install-recommends apt-utils -y \\\n && apt-get install --no-install-recommends unzip -y \\\n && apt-get install --no-install-recommends xz-utils -y \\\n && apt-get install --no-install-recommends mono-complete -y \\\n && apt-get install --no-install-recommends mono-apache-server4 -y \\\n && apt-get install --no-install-recommends libapache2-mod-mono -y \\\n && apt-get install --no-install-recommends git -y \\\n && apt-get install --no-install-recommends openssh-client -y \\\n && apt-get install --no-install-recommends vim tree -y \\\n && apt-get install tcptraceroute -y \\\n && wget -O /tmp/node-v4.4.7-linux-x64.tar.xz https://nodejs.org/dist/v4.4.7/node-v4.4.7-linux-x64.tar.xz \\\n && wget -O /tmp/node-v4.5.0-linux-x64.tar.xz https://nodejs.org/dist/v4.5.0/node-v4.5.0-linux-x64.tar.xz \\\n && wget -O /tmp/node-v6.2.2-linux-x64.tar.xz https://nodejs.org/dist/v6.2.2/node-v6.2.2-linux-x64.tar.xz \\\n && wget -O /tmp/node-v6.6.0-linux-x64.tar.xz https://nodejs.org/dist/v6.6.0/node-v6.6.0-linux-x64.tar.xz \\\n && wget -O /tmp/node-v6.9.3-linux-x64.tar.xz https://nodejs.org/dist/v6.9.3/node-v6.9.3-linux-x64.tar.xz \\\n && wget -O /tmp/node-v6.10.3-linux-x64.tar.xz https://nodejs.org/dist/v6.10.3/node-v6.10.3-linux-x64.tar.xz \\\n && wget -O /tmp/node-v6.11.0-linux-x64.tar.xz https://nodejs.org/dist/v6.11.0/node-v6.11.0-linux-x64.tar.xz \\\n && wget -O /tmp/node-v8.0.0-linux-x64.tar.xz https://nodejs.org/dist/v8.0.0/node-v8.0.0-linux-x64.tar.xz \\\n && wget -O /tmp/node-v8.1.0-linux-x64.tar.xz https://nodejs.org/dist/v8.1.0/node-v8.1.0-linux-x64.tar.xz \\\n && wget -O /tmp/node-v8.2.1-linux-x64.tar.xz https://nodejs.org/dist/v8.2.1/node-v8.2.1-linux-x64.tar.xz \\\n && wget -O /tmp/node-v8.8.1-linux-x64.tar.xz https://nodejs.org/dist/v8.8.1/node-v8.8.1-linux-x64.tar.xz \\\n && wget -O /tmp/node-v8.9.4-linux-x64.tar.xz https://nodejs.org/dist/v8.9.4/node-v8.9.4-linux-x64.tar.xz \\\n && wget -O /tmp/node-v8.11.2-linux-x64.tar.xz https://nodejs.org/dist/v8.11.2/node-v8.11.2-linux-x64.tar.xz \\\n && wget -O /tmp/node-v9.4.0-linux-x64.tar.xz https://nodejs.org/dist/v9.4.0/node-v9.4.0-linux-x64.tar.xz \\\n && wget -O /tmp/node-v10.1.0-linux-x64.tar.xz https://nodejs.org/dist/v10.1.0/node-v10.1.0-linux-x64.tar.xz \\\n && wget -O /tmp/npm-2.15.8.zip https://github.com/npm/npm/archive/v2.15.8.zip \\\n && wget -O /tmp/npm-2.15.9.zip https://github.com/npm/npm/archive/v2.15.9.zip \\\n && wget -O /tmp/npm-3.9.5.zip https://github.com/npm/npm/archive/v3.9.5.zip \\\n && wget -O /tmp/npm-3.10.3.zip https://github.com/npm/npm/archive/v3.10.3.zip \\\n && wget -O /tmp/npm-3.10.10.zip https://github.com/npm/npm/archive/v3.10.10.zip \\\n && wget -O /tmp/npm-5.0.3.zip https://github.com/npm/npm/archive/v5.0.3.zip \\\n && wget -O /tmp/npm-5.4.2.zip https://github.com/npm/npm/archive/v5.4.2.zip \\\n && wget -O /tmp/npm-5.6.0.zip https://github.com/npm/npm/archive/v5.6.0.zip \\\n && wget -O /tmp/npm-6.0.1.zip https://github.com/npm/npm/archive/v6.0.1.zip \\\n && ln -s ../mods-available/xml2enc.load /etc/apache2/mods-enabled \\\n && a2enmod proxy \\\n && a2enmod proxy_http \\\n && a2enmod proxy_wstunnel \\\n && a2enmod rewrite \\\n && a2enmod proxy_ajp \\\n && a2enmod deflate \\\n && a2enmod headers \\\n && a2enmod proxy_balancer \\\n && a2enmod proxy_connect \\\n && a2enmod proxy_html \\\n && tar -xf /tmp/mod_mono.tar \\\n && cp mod_mono.so.0.0.0 /usr/lib/apache2/modules/mod_mono.so.0.0.0\n#   Install npm and node\nRUN mkdir -p /opt/npm/2.15.8/node_modules \\\n && unzip -q /tmp/npm-2.15.8.zip -d /opt/npm/2.15.8/node_modules \\\n && mv /opt/npm/2.15.8/node_modules/npm-2.15.8 /opt/npm/2.15.8/node_modules/npm \\\n && ln -s /opt/npm/2.15.8/node_modules/npm/bin/npm /opt/npm/2.15.8/npm \\\n && chmod -R 755 /opt/npm/2.15.8/node_modules/npm/bin \\\n && mkdir -p /opt/npm/2.15.9/node_modules \\\n && unzip -q /tmp/npm-2.15.9.zip -d /opt/npm/2.15.9/node_modules \\\n && mv /opt/npm/2.15.9/node_modules/npm-2.15.9 /opt/npm/2.15.9/node_modules/npm \\\n && ln -s /opt/npm/2.15.9/node_modules/npm/bin/npm /opt/npm/2.15.9/npm \\\n && chmod -R 755 /opt/npm/2.15.9/node_modules/npm/bin \\\n && mkdir -p /opt/npm/3.9.5/node_modules \\\n && unzip -q /tmp/npm-3.9.5.zip -d /opt/npm/3.9.5/node_modules \\\n && mv /opt/npm/3.9.5/node_modules/npm-3.9.5 /opt/npm/3.9.5/node_modules/npm \\\n && ln -s /opt/npm/3.9.5/node_modules/npm/bin/npm /opt/npm/3.9.5/npm \\\n && chmod -R 755 /opt/npm/3.9.5/node_modules/npm/bin \\\n && mkdir -p /opt/npm/3.10.3/node_modules \\\n && unzip -q /tmp/npm-3.10.3.zip -d /opt/npm/3.10.3/node_modules \\\n && mv /opt/npm/3.10.3/node_modules/npm-3.10.3 /opt/npm/3.10.3/node_modules/npm \\\n && ln -s /opt/npm/3.10.3/node_modules/npm/bin/npm /opt/npm/3.10.3/npm \\\n && chmod -R 755 /opt/npm/3.10.3/node_modules/npm/bin \\\n && mkdir -p /opt/npm/3.10.10/node_modules \\\n && unzip -q /tmp/npm-3.10.10.zip -d /opt/npm/3.10.10/node_modules \\\n && mv /opt/npm/3.10.10/node_modules/npm-3.10.10 /opt/npm/3.10.10/node_modules/npm \\\n && ln -s /opt/npm/3.10.10/node_modules/npm/bin/npm /opt/npm/3.10.10/npm \\\n && chmod -R 755 /opt/npm/3.10.10/node_modules/npm/bin \\\n && mkdir -p /opt/npm/5.0.3/node_modules \\\n && unzip -q /tmp/npm-5.0.3.zip -d /opt/npm/5.0.3/node_modules \\\n && mv /opt/npm/5.0.3/node_modules/npm-5.0.3 /opt/npm/5.0.3/node_modules/npm \\\n && ln -s /opt/npm/5.0.3/node_modules/npm/bin/npm /opt/npm/5.0.3/npm \\\n && chmod -R 755 /opt/npm/5.0.3/node_modules/npm/bin \\\n && mkdir -p /opt/npm/5.4.2/node_modules \\\n && unzip -q /tmp/npm-5.4.2.zip -d /opt/npm/5.4.2/node_modules \\\n && mv /opt/npm/5.4.2/node_modules/npm-5.4.2 /opt/npm/5.4.2/node_modules/npm \\\n && ln -s /opt/npm/5.4.2/node_modules/npm/bin/npm /opt/npm/5.4.2/npm \\\n && chmod -R 755 /opt/npm/5.4.2/node_modules/npm/bin \\\n && mkdir -p /opt/npm/5.6.0/node_modules \\\n && unzip -q /tmp/npm-5.6.0.zip -d /opt/npm/5.6.0/node_modules \\\n && mv /opt/npm/5.6.0/node_modules/npm-5.6.0 /opt/npm/5.6.0/node_modules/npm \\\n && ln -s /opt/npm/5.6.0/node_modules/npm/bin/npm /opt/npm/5.6.0/npm \\\n && chmod -R 755 /opt/npm/5.6.0/node_modules/npm/bin \\\n && mkdir -p /opt/npm/6.0.1/node_modules \\\n && unzip -q /tmp/npm-6.0.1.zip -d /opt/npm/6.0.1/node_modules \\\n && mv /opt/npm/6.0.1/node_modules/npm-6.0.1 /opt/npm/6.0.1/node_modules/npm \\\n && ln -s /opt/npm/6.0.1/node_modules/npm/bin/npm /opt/npm/6.0.1/npm \\\n && chmod -R 755 /opt/npm/6.0.1/node_modules/npm/bin \\\n && chown -R root:root /opt/npm \\\n && mkdir -p /opt/nodejs \\\n && tar xfJ /tmp/node-v4.4.7-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v4.4.7-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v4.4.7-linux-x64 /opt/nodejs/4.4.7 \\\n && echo \"2.15.8\" > /opt/nodejs/4.4.7/npm.txt \\\n && mkdir -p /opt/nodejs \\\n && tar xfJ /tmp/node-v4.5.0-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v4.5.0-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v4.5.0-linux-x64 /opt/nodejs/4.5.0 \\\n && echo \"2.15.9\" > /opt/nodejs/4.5.0/npm.txt \\\n && tar xfJ /tmp/node-v6.2.2-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v6.2.2-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v6.2.2-linux-x64 /opt/nodejs/6.2.2 \\\n && echo \"3.9.5\" > /opt/nodejs/6.2.2/npm.txt \\\n && tar xfJ /tmp/node-v6.6.0-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v6.6.0-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v6.6.0-linux-x64 /opt/nodejs/6.6.0 \\\n && echo \"3.10.3\" > /opt/nodejs/6.6.0/npm.txt \\\n && tar xfJ /tmp/node-v6.9.3-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v6.9.3-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v6.9.3-linux-x64 /opt/nodejs/6.9.3 \\\n && echo \"3.10.10\" > /opt/nodejs/6.9.3/npm.txt \\\n && tar xfJ /tmp/node-v6.10.3-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v6.10.3-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v6.10.3-linux-x64 /opt/nodejs/6.10.3 \\\n && echo \"3.10.10\" > /opt/nodejs/6.10.3/npm.txt \\\n && tar xfJ /tmp/node-v6.11.0-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v6.11.0-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v6.11.0-linux-x64 /opt/nodejs/6.11.0 \\\n && echo \"3.10.10\" > /opt/nodejs/6.11.0/npm.txt \\\n && tar xfJ /tmp/node-v8.0.0-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v8.0.0-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v8.0.0-linux-x64 /opt/nodejs/8.0.0 \\\n && echo \"5.0.3\" > /opt/nodejs/8.0.0/npm.txt \\\n && tar xfJ /tmp/node-v8.1.0-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v8.1.0-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v8.1.0-linux-x64 /opt/nodejs/8.1.0 \\\n && echo \"5.0.3\" > /opt/nodejs/8.1.0/npm.txt \\\n && tar xfJ /tmp/node-v8.2.1-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v8.2.1-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v8.2.1-linux-x64 /opt/nodejs/8.2.1 \\\n && echo \"5.4.2\" > /opt/nodejs/8.2.1/npm.txt \\\n && tar xfJ /tmp/node-v8.8.1-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v8.8.1-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v8.8.1-linux-x64 /opt/nodejs/8.8.1 \\\n && echo \"5.4.2\" > /opt/nodejs/8.8.1/npm.txt \\\n && tar xfJ /tmp/node-v8.9.4-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v8.9.4-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v8.9.4-linux-x64 /opt/nodejs/8.9.4 \\\n && echo \"5.6.0\" > /opt/nodejs/8.9.4/npm.txt \\\n && tar xfJ /tmp/node-v8.11.2-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v8.11.2-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v8.11.2-linux-x64 /opt/nodejs/8.11.2 \\\n && echo \"5.6.0\" > /opt/nodejs/8.11.2/npm.txt \\\n && tar xfJ /tmp/node-v9.4.0-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v9.4.0-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v9.4.0-linux-x64 /opt/nodejs/9.4.0 \\\n && echo \"5.6.0\" > /opt/nodejs/9.4.0/npm.txt \\\n && tar xfJ /tmp/node-v10.1.0-linux-x64.tar.xz -C /opt/nodejs \\\n && rm -f node-v10.1.0-linux-x64.tar.xz \\\n && mv /opt/nodejs/node-v10.1.0-linux-x64 /opt/nodejs/10.1.0 \\\n && echo \"6.0.1\" > /opt/nodejs/10.1.0/npm.txt \\\n && chown -R root:root /opt/nodejs \\\n && ln -s /opt/nodejs/6.11.0/bin/node /opt/nodejs/node \\\n && ln -s /opt/nodejs/6.11.0/npm.txt /opt/nodejs/npm.txt \\\n && rm -f /usr/bin/node \\\n && ln -s /opt/nodejs/6.11.0/bin/node /usr/bin/node \\\n && rm -f /opt/nodejs/6.11.0/bin/npm \\\n && ln -s /opt/npm/3.10.10/node_modules/npm/bin/npm /opt/nodejs/npm \\\n && ln -s /opt/npm/3.10.10/node_modules /opt/nodejs/node_modules \\\n && rm -rf /usr/bin/npm \\\n && ln -s /opt/npm/3.10.10/node_modules/npm/bin/npm /usr/bin/npm \\\n && ln -s /opt/npm/3.10.10/node_modules/npm/bin/npm-cli.js /usr/bin/npm-cli.js \\\n && ln -s /opt/npm/3.10.10/node_modules /usr/bin/node_modules\nENV PATH=\"$PATH:/opt/nodejs/6.11.0/bin\"\n#   Upgrade mono\nRUN echo \"deb http://download.mono-project.com/repo/debian beta/. main\" | tee /etc/apt/sources.list.d/mono-xamarin-c7-ms.list \\\n && apt-get update \\\n && apt-get install --no-install-recommends libmono-system-net-http-webrequest4.0-cil -y\n#   Ruby installations\n#   Dependencies for various ruby and rubygem installations\nRUN apt-get install --no-install-recommends libreadline-dev bzip2 build-essential libssl-dev zlib1g-dev libpq-dev libsqlite3-dev curl patch gawk g++ gcc make libc6-dev patch libreadline6-dev libyaml-dev sqlite3 autoconf libgdbm-dev libncurses5-dev automake libtool bison pkg-config libffi-dev bison libxslt-dev libxml2-dev libmysqlclient-dev -y\n#   rbenv\nRUN git clone https://github.com/rbenv/rbenv.git /usr/local/.rbenv\nRUN chmod -R 777 /usr/local/.rbenv\nENV RBENV_ROOT=\"/usr/local/.rbenv\"\nENV PATH=\"$RBENV_ROOT/bin:/usr/local:$PATH\"\nRUN git clone https://github.com/rbenv/ruby-build.git /usr/local/.rbenv/plugins/ruby-build\nRUN chmod -R 777 /usr/local/.rbenv/plugins/ruby-build\nRUN /usr/local/.rbenv/plugins/ruby-build/install.sh\n#   Install ruby 2.3.3 (default), 2.3.8, 2.4.5\nENV RUBY_CONFIGURE_OPTS=\"--disable-install-doc\"\nENV RUBY_CFLAGS=\"-O3\"\nRUN eval \"$( rbenv init - ;)\" \\\n && export WEBSITES_DEFAULT_RUBY_VERSION=\"2.3.3\" \\\n && rbenv install $WEBSITES_DEFAULT_RUBY_VERSION \\\n && rbenv install \"2.3.8\" \\\n && rbenv install \"2.4.5\" \\\n && rbenv install \"2.5.5\" \\\n && rbenv install \"2.6.2\" \\\n && rbenv rehash \\\n && rbenv global $WEBSITES_DEFAULT_RUBY_VERSION \\\n && ls /usr/local -a \\\n && rbenv local $WEBSITES_DEFAULT_RUBY_VERSION \\\n && gem install bundler \\\n && rbenv local 2.3.8 \\\n && gem install bundler \\\n && rbenv local 2.4.5 \\\n && gem install bundler \\\n && rbenv local 2.5.5 \\\n && gem install bundler \\\n && rbenv local 2.6.2 \\\n && gem install bundler \\\n && rbenv local $WEBSITES_DEFAULT_RUBY_VERSION \\\n && chmod -R 777 /usr/local/.rbenv/versions \\\n && chmod -R 777 /usr/local/.rbenv/version\nRUN eval \"$( rbenv init - ;)\" \\\n && rbenv global $WEBSITES_DEFAULT_RUBY_VERSION \\\n && bundle config --global build.nokogiri -- --use-system-libraries\n#   Because Nokogiri tries to build libraries on its own otherwise\nENV NOKOGIRI_USE_SYSTEM_LIBRARIES=\"true\"\n#   SQL Server gem support\nRUN apt-get install unixodbc-dev freetds-dev freetds-bin -y\n#   Install .NET Core\nRUN apt-get update \\\n && apt-get install --no-install-recommends libc6 libcurl3 libgcc1 libgssapi-krb5-2 libicu52 liblttng-ust0 libssl1.0.0 libstdc++6 libunwind8 libuuid1 zlib1g -y \\\n && rm -rf /var/lib/apt/lists/*\n#   Install .NET Core SDK\nENV DOTNET_SDK_VERSION=\"2.1.300\"\nENV DOTNET_SDK_DOWNLOAD_URL=\"https://dotnetcli.blob.core.windows.net/dotnet/Sdk/$DOTNET_SDK_VERSION/dotnet-sdk-$DOTNET_SDK_VERSION-linux-x64.tar.gz\"\nENV DOTNET_SDK_DOWNLOAD_SHA=\"80a6bfb1db5862804e90f819c1adeebe3d624eae0d6147e5d6694333f0458afd7d34ce73623964752971495a310ff7fcc266030ce5aef82d5de7293d94d13770\"\nRUN curl -SL $DOTNET_SDK_DOWNLOAD_URL --output dotnet.tar.gz \\\n && echo \"$DOTNET_SDK_DOWNLOAD_SHA dotnet.tar.gz\" | sha512sum -c - \\\n && mkdir -p /usr/share/dotnet \\\n && tar -zxf dotnet.tar.gz -C /usr/share/dotnet \\\n && rm dotnet.tar.gz \\\n && ln -s /usr/share/dotnet/dotnet /usr/bin/dotnet\n#   Moving the package cache to the container image will require user packages to be repopulated\n#   for each new build done in a new container instance, but it's *much* faster than\n#   using a location on the user's site volume and does not require them to use their storage, and\n#   lets us warm the caches with standard packages\nENV NUGET_PACKAGES=\"/var/nuget\"\n#   Trigger the population of the local package cache and NuGetFallbackFolder\n#   We install the 1.x web templates just so we can create and restore 1.0 and 1.1 MVC apps here\n#   See https://github.com/aspnet/Tooling/blob/master/missing-template.md\n#   Note that after populating the cache we need to chmod 777 every directory underneath\n#   so the Kudu user can access them; this can be removed if we run Kudu as root later.\nENV NUGET_XMLDOC_MODE=\"skip\"\nENV DOTNET_SKIP_FIRST_TIME_EXPERIENCE=\"1\"\nRUN mkdir /var/nuget \\\n && chmod a+rw /var/nuget \\\n && dotnet new -i \"Microsoft.DotNet.Web.ProjectTemplates.1.x::1.0.0-*\" \\\n && mkdir warmup \\\n && cd warmup \\\n && dotnet new \\\n && cd .. \\\n && rm -rf warmup \\\n && mkdir warmup \\\n && cd warmup \\\n && dotnet new mvc -f netcoreapp1.1 \\\n && dotnet restore \\\n && cd .. \\\n && rm -rf warmup \\\n && mkdir warmup \\\n && cd warmup \\\n && dotnet new mvc -f netcoreapp1.0 \\\n && dotnet restore \\\n && cd .. \\\n && rm -rf warmup \\\n && mkdir warmup \\\n && cd warmup \\\n && dotnet new mvc \\\n && dotnet restore \\\n && cd .. \\\n && rm -rf warmup \\\n && rm -rf /tmp/NuGetScratch \\\n && find /var/nuget -type d -exec chmod 777 {}\n#   install apache2\nRUN apt-get install apache2 -y\nRUN service apache2 restart\n#   Section PHP\nRUN apt-get update ; apt-get install --no-install-recommends libcurl4-openssl-dev libssl-dev zlib1g-dev libpng-dev libpq-dev libc-client-dev libsqlite3-dev libgmp-dev libmcrypt-dev libldap2-dev libtidy-dev libkrb5-dev libicu-dev libedit-dev libxml2-dev libxslt-dev unixodbc-dev libmagickwand-dev dpkg-dev file g++ gcc libc-dev libsodium-dev libsodium18 -y \\\n && ln -s /usr/lib/x86_64-linux-gnu/libldap.so /usr/lib/libldap.so\nRUN mkdir -p /usr/local/php/5.6\nCOPY --from=php5.6-build /usr/local/php/5.6 /usr/local/php/5.6\nRUN mkdir -p /usr/local/php/7.0\nCOPY --from=php7.0-build /usr/local/php/7.0 /usr/local/php/7.0\nRUN mkdir -p /usr/local/php/7.2\nCOPY --from=php7.2-build /usr/local/php/7.2 /usr/local/php/7.2\nENV PATH=\"/usr/local/php/7.2/bin:$PATH\"\nENV PHP_5_6_PATH=\"/usr/local/php/5.6/bin\"\nENV PHP_7_0_PATH=\"/usr/local/php/7.0/bin\"\nENV PHP_7_2_PATH=\"/usr/local/php/7.2/bin\"\n#   PHP Composer\nRUN php -r \"copy('https://getcomposer.org/installer', '/tmp/composer-setup.php');\" \\\n && php /tmp/composer-setup.php --install-dir=/usr/local/bin --filename=composer --quiet \\\n && rm -f /tmp/composer-setup.php\nENV PHP_VERSION=\"7.2\"\nENV COMPOSER_VENDOR_DIR=\"/home/site/wwwroot/vendor\"\n#   Golang and musl for cross compiling for alpine.\nENV GOLANG_VERSION=\"1.10\"\nENV GOLANG_DOWNLOAD_URL=\"https://golang.org/dl/go$GOLANG_VERSION.linux-amd64.tar.gz\"\nENV GOLANG_DOWNLOAD_SHA=\"b5a64335f1490277b585832d1f6c7f8c6c11206cba5cd3f771dcb87b98ad1a33\"\nRUN curl -SL $GOLANG_DOWNLOAD_URL --output golang.tar.gz \\\n && echo \"$GOLANG_DOWNLOAD_SHA golang.tar.gz\" | sha256sum -c - \\\n && tar -zxf golang.tar.gz -C /usr/local \\\n && rm golang.tar.gz \\\n && apt-get install musl-tools -y\nENV PATH=\"/usr/local/go/bin:$PATH\"\n#   Download Dep executable\nENV DEP_VERSION=\"0.4.1\"\nENV DEP_DOWNLOAD_URL=\"https://github.com/golang/dep/releases/download/v$DEP_VERSION/dep-linux-amd64\"\nENV DEP_DOWNLOAD_SHA=\"31144e465e52ffbc0035248a10ddea61a09bf28b00784fd3fdd9882c8cbb2315\"\nRUN curl -fL -o /usr/local/go/bin/dep $DEP_DOWNLOAD_URL \\\n && echo \"$DEP_DOWNLOAD_SHA /usr/local/go/bin/dep\" | sha256sum -c - \\\n && chmod +x /usr/local/go/bin/dep\n#   Section PYTHON\nRUN set -ex \\\n && savedAptMark=\"$( apt-mark showmanual ;)\" \\\n && apt-get update \\\n && apt-get install --no-install-recommends dpkg-dev gcc libbz2-dev libc6-dev libexpat1-dev libffi-dev libgdbm-dev liblzma-dev libncursesw5-dev libreadline-dev libsqlite3-dev libssl-dev apt-transport-https lsb-release ca-certificates make tk-dev tcl-dev uuid-dev wget xz-utils zlib1g-dev $( command -v gpg > /dev/null || echo 'gnupg dirmngr' ;) -y\nCOPY --from=python-3.6-build /usr/local/python/3.6.6 /usr/local/python/3.6.6\nCOPY --from=python-3.7-build /usr/local/openssl /usr/local/openssl\nCOPY --from=python-3.7-build /usr/local/python/3.7.0 /usr/local/python/3.7.0\nENV PATH=\"/usr/local/python/3.7.0/bin:$PATH\"\nENV PYTHON_3_7_PATH=\"/usr/local/python/3.7.0/bin\"\nENV PYTHON_3_6_PATH=\"/usr/local/python/3.6.6/bin\"\n#   Install Kudu\nCOPY kudu.conf /tmp\nCOPY apache2.conf /tmp\nCOPY Kudu.82.10506.3895.zip /tmp/Kudu.zip\nENV KUDU_VERSION=\"82.10506.3895\"\nRUN npm install kudusync -g \\\n && cp /tmp/kudu.conf /etc/apache2/sites-available/kudu.conf \\\n && cp /tmp/apache2.conf /etc/apache2/apache2.conf \\\n && unzip -q -o /tmp/Kudu.zip \\\n && mkdir /opt/Kudu \\\n && cp -rf ./$KUDU_VERSION/* /opt/Kudu \\\n && rm -f /tmp/Kudu.zip \\\n && rm -f /tmp/apache2.conf \\\n && rm -f /tmp/kudu.conf \\\n && rm -rf ./$KUDU_VERSION \\\n && cat /opt/Kudu/Web.config | sed 's| <location path=\".\" inheritInChildApplications=\"false\">| <location path=\"~/../../../opt/Kudu\" inheritInChildApplications=\"false\">|' > /opt/Kudu/Web.config2 \\\n && mv /opt/Kudu/Web.config2 /opt/Kudu/Web.config \\\n && chmod 755 /opt/Kudu/bin/kudu.exe \\\n && chmod 755 /opt/Kudu/bin/node_modules/.bin/kuduscript \\\n && chmod 755 /opt/Kudu/bin/Scripts/starter.sh \\\n && mkdir -p /opt/Kudu/local \\\n && chmod 755 /opt/Kudu/local\n#   Install pm2 and pm2-logrotate\nRUN npm install pm2@latest -g \\\n && pm2 install pm2-logrotate \\\n && pm2 set pm2-logrotate:retain 7\n#   Install LogAnalyzer\nCOPY LogAnalyzer.zip /tmp\nRUN mkdir /opt/LogAnalyzer \\\n && unzip /tmp/LogAnalyzer.zip -d /opt/LogAnalyzer \\\n && rm -f /tmp/LogAnalyzer.zip\nCOPY startup.sh /\nRUN chmod 755 /startup.sh \\\n && mkdir -p /home/LogFiles\n#   Remove extraneous config mono config load that starts up\n#   an unnecessary mono process\nRUN sed -i '$d' /etc/apache2/mods-enabled/mod_mono.conf\n#   Install TunnelExtension\nCOPY TunnelExtension.zip /tmp\nRUN mkdir /opt/tunnelext \\\n && unzip /tmp/TunnelExtension.zip -d /opt/tunnelext \\\n && chmod 777 /opt/tunnelext/tunnelwatcher.sh\n#   Install webssh\nCOPY webssh.zip /tmp\nRUN mkdir /opt/webssh \\\n && unzip /tmp/webssh.zip -d /opt/webssh\n#   Replace ssh with wrapper script for CIFS mount permissions workaround\nCOPY ssh /tmp\nRUN mv /usr/bin/ssh /usr/bin/ssh.original \\\n && mv /tmp/ssh /usr/bin/ssh \\\n && chown root:root /usr/bin/ssh \\\n && chmod 755 /usr/bin/ssh\nCOPY hostingstart.html /home/site/wwwroot/hostingstart.html\nCOPY KuduStaticFiles/503.html /opt/Kudu/503.html\nCOPY KuduStaticFiles/_Layout.cshtml /opt/Kudu/_Layout.cshtml\nCOPY KuduStaticFiles/AppService.png /opt/Kudu/Content/Images/AppService.png\nCOPY KuduStaticFiles/linux_favicon.ico /opt/Kudu/linux_favicon.ico\nCOPY deploy.bash.python.template /opt/Kudu/bin/node_modules/kuduscript/lib/templates/deploy.bash.python.template\nCOPY deploy.bash.ruby.template /opt/Kudu/bin/node_modules/kuduscript/lib/templates/deploy.bash.ruby.template\nRUN chmod -R 777 /home \\\n && rm -rf /tmp/*\nEXPOSE 8181/tcp\nENV PORT=\"8181\"\nENTRYPOINT [\"/startup.sh\"]\nCMD [\"1002\", \"kudu_group\", \"1001\", \"kudu_user\", \"localsite\"]\n","originalDockerfileUglifiedHash":"b9fcc0be2cce0fcd1ed24b5e6f55dfb1","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/801fcf628778d0dcbba830730e2e9b8f7915ef50.dockerfile"}