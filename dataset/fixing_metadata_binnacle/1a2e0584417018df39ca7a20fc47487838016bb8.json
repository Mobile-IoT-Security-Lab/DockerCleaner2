{"seed":290957423,"processedDockerfileHash":"b6b6c03fd26e1719456e2c9f2d06e727","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM ubuntu:12.04\nMAINTAINER Jonas Colmsjö <jonas@gizur.com>\nRUN echo \"deb http://archive.ubuntu.com/ubuntu precise main universe\" > /etc/apt/sources.list\nRUN :\nRUN (apt-get update ;apt-get install --no-install-recommends language-pack-en -q -y )\nRUN update-locale LANG=en_US.UTF-8\n#  run echo mail > /etc/hostname\nCOPY etc-hosts.txt /etc/hosts\n#  run chown root:root /etc/hosts\nRUN (apt-get update ;apt-get install --no-install-recommends vim -q -y )\n#   Install Postfix.\nRUN echo \"postfix postfix/main_mailer_type string Internet site\" > preseed.txt\nRUN echo \"postfix postfix/mailname string mail.example.com\" >> preseed.txt\n#   Use Mailbox format.\nRUN debconf-set-selections preseed.txt\nRUN DEBIAN_FRONTEND=noninteractive apt-get install -q -y postfix\nRUN postconf -e myhostname=mail.example.com\nRUN postconf -e mydestination=\"mail.example.com, example.com, localhost.localdomain, localhost\"\nRUN postconf -e mail_spool_directory=\"/var/spool/mail/\"\nRUN postconf -e mailbox_command=\"\"\n#   Add a local user to receive mail at someone@example.com, with a delivery directory\n#   (for the Mailbox format).\nRUN useradd -s /bin/bash someone\nRUN mkdir /var/spool/mail/someone\nRUN chown someone:mail /var/spool/mail/someone\nCOPY etc-aliases.txt /etc/aliases\n#  run chown root:root /etc/aliases\n#  run rm /etc/aliases.db\n#  run touch /etc/aliases.db\n#   run /bin/sh -c \"cd /etc; postmap aliases\"\n#  run newaliases\n#   Use syslog-ng to get Postfix logs (rsyslog uses upstart which does not seem\n#   to run within Docker).\nRUN (apt-get update ;apt-get install --no-install-recommends syslog-ng -q -y )\n#\n#   Jonas C.\n#\n#   Good foor debugging\nRUN (apt-get update ;apt-get install --no-install-recommends mutt vim dnsutils wget curl -y )\n#   Need to use smarthost when running in docker (since these IP-adresses often are blocked for spam purposes)\n#   See: http://www.inboxs.com/index.php/linux-os/mail-server/52-configure-postfix-to-use-smart-host-gmail\nRUN echo smtp.gmail.com USERNAME:PASSWORD > /etc/postfix/relay_passwd\nRUN chmod 600 /etc/postfix/relay_passwd\nRUN postmap /etc/postfix/relay_passwd\nCOPY etc-postfix-main.cf /etc-postfix-main.cf\nRUN cat /etc-postfix-main.cf >> /etc/postfix/main.cf\n#  -------------------------------------------------------------------------\n#   Install apache\n#\n#   Keep upstart from complaining\n#  RUN dpkg-divert --local --rename --add /sbin/initctl\n#  RUN ln -s /bin/true /sbin/initctl\n#  RUN apt-get update\n#\n#   Install supervidord (used to handle processes)\n#\nRUN (apt-get update ;apt-get install --no-install-recommends supervisor -y )\nCOPY ./supervisord.conf /etc/supervisor/conf.d/supervisord.conf\n#\n#   Install Apache\nRUN (apt-get update ;apt-get install --no-install-recommends apache2 -y )\n#  -------------------------------------------------------------------------\n#   Install mailman\n#\n#  run echo \"postfix postfix/mailname string mail.example.com\" > preseed.txt\n#  run debconf-set-selections preseed.txt\nRUN DEBIAN_FRONTEND=noninteractive apt-get install -y mailman\nRUN ln -s /etc/mailman/apache.conf /etc/apache2/sites-enabled/mailman\nRUN /etc/init.d/apache2 restart\nRUN postconf -e 'relay_domains = lists.example.com'\nRUN postconf -e 'transport_maps = hash:/etc/postfix/transport'\nRUN postconf -e 'mailman_destination_recipient_limit = 1'\nRUN postconf -e 'alias_maps = hash:/etc/aliases, hash:/var/lib/mailman/data/aliases'\n#  In /etc/postfix/master.cf double check that you have the following transport:\n#\n#  mailman   unix  -       n       n       -       -       pipe\n#    flags=FR user=list argv=/usr/lib/mailman/bin/postfix-to-mailman.py\n#    ${nexthop} ${user}\n#\n#  It calls the postfix-to-mailman.py script when a mail is delivered to a list.\n#\n#  Associate the domain lists.example.com to the mailman transport with the transport map. Edit the file /etc/postfix/transport:\n#\n#  lists.example.com      mailman:\nCOPY ./etc-mailman-mm_cfg.py /eyc/mailman/mm_cfg.py\nCOPY ./etc-postfix-transport /etc/postfix/transport\nRUN chown root:list /etc/postfix/transport\nRUN postmap -v /etc/postfix/transport\n#  RUN chown root:list /var/lib/mailman/data/aliases\nRUN chown root:list /etc/aliases\nRUN newaliases\n#  run echo \"postfix postfix/mailname string mail.example.com\" > preseed.txt\n#  run debconf-set-selections preseed.txt\n#  RUN newlist mailman\n#  RUN groupadd mailman\n#  RUN useradd -c \"GNU Mailman\" -s /no/shell -d /no/home -g mailman mailman\n#  RUN mkdir -p /usr/local/mailman\n#  RUN cd /usr/local/mailman; chgrp mailman .; chmod a+rx,g+ws .\n#  RUN wget https://launchpad.net/mailman/3.0/3.0.0b3/+download/mailman-3.0.0b3.tar.gz\n#  RUN tar -xzf mailman-3.0.0b3.tar.gz\n#  RUN sudo su mailman -c \"cd /usr/local/mailman/mailman-3.0.0b3; ./configure; man install\"\nEXPOSE 25/tcp 80/tcp\nCMD [\"sh\", \"-c\", \"service\", \"syslog-ng\", \"start\", \";\", \"service\", \"postfix\", \"start\", \";\", \"/etc/init.d/supervisor\", \"start\", \";\", \"/usr/lib/mailman/bin/mailmanctl\", \"start\", \";\", \"tail\", \"-F\", \"/var/log/mailman/*\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM ubuntu:12.04\nMAINTAINER Jonas Colmsjö <jonas@gizur.com>\nRUN echo \"deb http://archive.ubuntu.com/ubuntu precise main universe\" > /etc/apt/sources.list\nRUN apt-get update\nRUN apt-get install language-pack-en -q -y\nRUN update-locale LANG=en_US.UTF-8\n# run echo mail > /etc/hostname\nADD etc-hosts.txt /etc/hosts\n# run chown root:root /etc/hosts\nRUN apt-get install vim -q -y\n#  Install Postfix.\nRUN echo \"postfix postfix/main_mailer_type string Internet site\" > preseed.txt\nRUN echo \"postfix postfix/mailname string mail.example.com\" >> preseed.txt\n#  Use Mailbox format.\nRUN debconf-set-selections preseed.txt\nRUN DEBIAN_FRONTEND=noninteractive apt-get install -q -y postfix\nRUN postconf -e myhostname=mail.example.com\nRUN postconf -e mydestination=\"mail.example.com, example.com, localhost.localdomain, localhost\"\nRUN postconf -e mail_spool_directory=\"/var/spool/mail/\"\nRUN postconf -e mailbox_command=\"\"\n#  Add a local user to receive mail at someone@example.com, with a delivery directory\n#  (for the Mailbox format).\nRUN useradd -s /bin/bash someone\nRUN mkdir /var/spool/mail/someone\nRUN chown someone:mail /var/spool/mail/someone\nADD etc-aliases.txt /etc/aliases\n# run chown root:root /etc/aliases\n# run rm /etc/aliases.db\n# run touch /etc/aliases.db\n#  run /bin/sh -c \"cd /etc; postmap aliases\"\n# run newaliases\n#  Use syslog-ng to get Postfix logs (rsyslog uses upstart which does not seem\n#  to run within Docker).\nRUN apt-get install syslog-ng -q -y\n#\n#  Jonas C.\n#\n#  Good foor debugging\nRUN apt-get install mutt vim dnsutils wget curl -y\n#  Need to use smarthost when running in docker (since these IP-adresses often are blocked for spam purposes)\n#  See: http://www.inboxs.com/index.php/linux-os/mail-server/52-configure-postfix-to-use-smart-host-gmail\nRUN echo smtp.gmail.com USERNAME:PASSWORD > /etc/postfix/relay_passwd\nRUN chmod 600 /etc/postfix/relay_passwd\nRUN postmap /etc/postfix/relay_passwd\nADD etc-postfix-main.cf /etc-postfix-main.cf\nRUN cat /etc-postfix-main.cf >> /etc/postfix/main.cf\n# -------------------------------------------------------------------------\n#  Install apache\n#\n#  Keep upstart from complaining\n# RUN dpkg-divert --local --rename --add /sbin/initctl\n# RUN ln -s /bin/true /sbin/initctl\n# RUN apt-get update\n#\n#  Install supervidord (used to handle processes)\n#\nRUN apt-get install supervisor -y\nADD ./supervisord.conf /etc/supervisor/conf.d/supervisord.conf\n#\n#  Install Apache\nRUN apt-get install apache2 -y\n# -------------------------------------------------------------------------\n#  Install mailman\n#\n# run echo \"postfix postfix/mailname string mail.example.com\" > preseed.txt\n# run debconf-set-selections preseed.txt\nRUN DEBIAN_FRONTEND=noninteractive apt-get install -y mailman\nRUN ln -s /etc/mailman/apache.conf /etc/apache2/sites-enabled/mailman\nRUN /etc/init.d/apache2 restart\nRUN postconf -e 'relay_domains = lists.example.com'\nRUN postconf -e 'transport_maps = hash:/etc/postfix/transport'\nRUN postconf -e 'mailman_destination_recipient_limit = 1'\nRUN postconf -e 'alias_maps = hash:/etc/aliases, hash:/var/lib/mailman/data/aliases'\n# In /etc/postfix/master.cf double check that you have the following transport:\n#\n# mailman   unix  -       n       n       -       -       pipe\n#   flags=FR user=list argv=/usr/lib/mailman/bin/postfix-to-mailman.py\n#   ${nexthop} ${user}\n#\n# It calls the postfix-to-mailman.py script when a mail is delivered to a list.\n#\n# Associate the domain lists.example.com to the mailman transport with the transport map. Edit the file /etc/postfix/transport:\n#\n# lists.example.com      mailman:\nADD ./etc-mailman-mm_cfg.py /eyc/mailman/mm_cfg.py\nADD ./etc-postfix-transport /etc/postfix/transport\nRUN chown root:list /etc/postfix/transport\nRUN postmap -v /etc/postfix/transport\n# RUN chown root:list /var/lib/mailman/data/aliases\nRUN chown root:list /etc/aliases\nRUN newaliases\n# run echo \"postfix postfix/mailname string mail.example.com\" > preseed.txt\n# run debconf-set-selections preseed.txt\n# RUN newlist mailman\n# RUN groupadd mailman\n# RUN useradd -c \"GNU Mailman\" -s /no/shell -d /no/home -g mailman mailman\n# RUN mkdir -p /usr/local/mailman\n# RUN cd /usr/local/mailman; chgrp mailman .; chmod a+rx,g+ws .\n# RUN wget https://launchpad.net/mailman/3.0/3.0.0b3/+download/mailman-3.0.0b3.tar.gz\n# RUN tar -xzf mailman-3.0.0b3.tar.gz\n# RUN sudo su mailman -c \"cd /usr/local/mailman/mailman-3.0.0b3; ./configure; man install\"\nEXPOSE 25/tcp 80/tcp\nCMD [\"sh\", \"-c\", \"service\", \"syslog-ng\", \"start\", \";\", \"service\", \"postfix\", \"start\", \";\", \"/etc/init.d/supervisor\", \"start\", \";\", \"/usr/lib/mailman/bin/mailmanctl\", \"start\", \";\", \"tail\", \"-F\", \"/var/log/mailman/*\"]\n","injectedSmells":[],"originalDockerfileHash":"5db46e890d6527f2dfe87e771157a86f","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM ubuntu:12.04\nMAINTAINER Jonas Colmsjö <jonas@gizur.com>\nRUN echo \"deb http://archive.ubuntu.com/ubuntu precise main universe\" > /etc/apt/sources.list\nRUN apt-get update\nRUN apt-get install language-pack-en -q -y\nRUN update-locale LANG=en_US.UTF-8\n#  run echo mail > /etc/hostname\nADD etc-hosts.txt /etc/hosts\n#  run chown root:root /etc/hosts\nRUN apt-get install vim -q -y\n#   Install Postfix.\nRUN echo \"postfix postfix/main_mailer_type string Internet site\" > preseed.txt\nRUN echo \"postfix postfix/mailname string mail.example.com\" >> preseed.txt\n#   Use Mailbox format.\nRUN debconf-set-selections preseed.txt\nRUN DEBIAN_FRONTEND=noninteractive apt-get install -q -y postfix\nRUN postconf -e myhostname=mail.example.com\nRUN postconf -e mydestination=\"mail.example.com, example.com, localhost.localdomain, localhost\"\nRUN postconf -e mail_spool_directory=\"/var/spool/mail/\"\nRUN postconf -e mailbox_command=\"\"\n#   Add a local user to receive mail at someone@example.com, with a delivery directory\n#   (for the Mailbox format).\nRUN useradd -s /bin/bash someone\nRUN mkdir /var/spool/mail/someone\nRUN chown someone:mail /var/spool/mail/someone\nADD etc-aliases.txt /etc/aliases\n#  run chown root:root /etc/aliases\n#  run rm /etc/aliases.db\n#  run touch /etc/aliases.db\n#   run /bin/sh -c \"cd /etc; postmap aliases\"\n#  run newaliases\n#   Use syslog-ng to get Postfix logs (rsyslog uses upstart which does not seem\n#   to run within Docker).\nRUN apt-get install syslog-ng -q -y\n#\n#   Jonas C.\n#\n#   Good foor debugging\nRUN apt-get install mutt vim dnsutils wget curl -y\n#   Need to use smarthost when running in docker (since these IP-adresses often are blocked for spam purposes)\n#   See: http://www.inboxs.com/index.php/linux-os/mail-server/52-configure-postfix-to-use-smart-host-gmail\nRUN echo smtp.gmail.com USERNAME:PASSWORD > /etc/postfix/relay_passwd\nRUN chmod 600 /etc/postfix/relay_passwd\nRUN postmap /etc/postfix/relay_passwd\nADD etc-postfix-main.cf /etc-postfix-main.cf\nRUN cat /etc-postfix-main.cf >> /etc/postfix/main.cf\n#  -------------------------------------------------------------------------\n#   Install apache\n#\n#   Keep upstart from complaining\n#  RUN dpkg-divert --local --rename --add /sbin/initctl\n#  RUN ln -s /bin/true /sbin/initctl\n#  RUN apt-get update\n#\n#   Install supervidord (used to handle processes)\n#\nRUN apt-get install supervisor -y\nADD ./supervisord.conf /etc/supervisor/conf.d/supervisord.conf\n#\n#   Install Apache\nRUN apt-get install apache2 -y\n#  -------------------------------------------------------------------------\n#   Install mailman\n#\n#  run echo \"postfix postfix/mailname string mail.example.com\" > preseed.txt\n#  run debconf-set-selections preseed.txt\nRUN DEBIAN_FRONTEND=noninteractive apt-get install -y mailman\nRUN ln -s /etc/mailman/apache.conf /etc/apache2/sites-enabled/mailman\nRUN /etc/init.d/apache2 restart\nRUN postconf -e 'relay_domains = lists.example.com'\nRUN postconf -e 'transport_maps = hash:/etc/postfix/transport'\nRUN postconf -e 'mailman_destination_recipient_limit = 1'\nRUN postconf -e 'alias_maps = hash:/etc/aliases, hash:/var/lib/mailman/data/aliases'\n#  In /etc/postfix/master.cf double check that you have the following transport:\n#\n#  mailman   unix  -       n       n       -       -       pipe\n#    flags=FR user=list argv=/usr/lib/mailman/bin/postfix-to-mailman.py\n#    ${nexthop} ${user}\n#\n#  It calls the postfix-to-mailman.py script when a mail is delivered to a list.\n#\n#  Associate the domain lists.example.com to the mailman transport with the transport map. Edit the file /etc/postfix/transport:\n#\n#  lists.example.com      mailman:\nADD ./etc-mailman-mm_cfg.py /eyc/mailman/mm_cfg.py\nADD ./etc-postfix-transport /etc/postfix/transport\nRUN chown root:list /etc/postfix/transport\nRUN postmap -v /etc/postfix/transport\n#  RUN chown root:list /var/lib/mailman/data/aliases\nRUN chown root:list /etc/aliases\nRUN newaliases\n#  run echo \"postfix postfix/mailname string mail.example.com\" > preseed.txt\n#  run debconf-set-selections preseed.txt\n#  RUN newlist mailman\n#  RUN groupadd mailman\n#  RUN useradd -c \"GNU Mailman\" -s /no/shell -d /no/home -g mailman mailman\n#  RUN mkdir -p /usr/local/mailman\n#  RUN cd /usr/local/mailman; chgrp mailman .; chmod a+rx,g+ws .\n#  RUN wget https://launchpad.net/mailman/3.0/3.0.0b3/+download/mailman-3.0.0b3.tar.gz\n#  RUN tar -xzf mailman-3.0.0b3.tar.gz\n#  RUN sudo su mailman -c \"cd /usr/local/mailman/mailman-3.0.0b3; ./configure; man install\"\nEXPOSE 25/tcp 80/tcp\nCMD [\"sh\", \"-c\", \"service\", \"syslog-ng\", \"start\", \";\", \"service\", \"postfix\", \"start\", \";\", \"/etc/init.d/supervisor\", \"start\", \";\", \"/usr/lib/mailman/bin/mailmanctl\", \"start\", \";\", \"tail\", \"-F\", \"/var/log/mailman/*\"]\n","originalDockerfileUglifiedHash":"26e2503596457be6cb09c4dd1058b10f","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/1a2e0584417018df39ca7a20fc47487838016bb8.dockerfile"}