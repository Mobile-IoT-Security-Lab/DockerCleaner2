{"seed":1453479851,"processedDockerfileHash":"03e31c974bb464e04d544cff9cfdf4c4","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","pin-package-manager-versions-apt-get","pin-package-manager-versions-npm","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM php:7.2-fpm\nMAINTAINER Jaroslav Hranicka <hranicka@outlook.com>\nENV DEBIAN_FRONTEND=\"noninteractive\"\nCOPY bin/* /usr/local/bin/\nRUN chmod -R 700 /usr/local/bin/\n#   Locales\nRUN apt-get update \\\n && apt-get install --no-install-recommends locales=2.28-10+deb10u2 -y\nRUN dpkg-reconfigure locales \\\n && locale-gen C.UTF-8 \\\n && /usr/sbin/update-locale LANG=C.UTF-8\nRUN echo 'en_US.UTF-8 UTF-8' >> /etc/locale.gen \\\n && locale-gen\nENV LC_ALL=\"C.UTF-8\"\nENV LANG=\"en_US.UTF-8\"\nENV LANGUAGE=\"en_US.UTF-8\"\n#   Common\nRUN apt-get update \\\n && apt-get install --no-install-recommends openssl=1.1.1n-0+deb10u4 git=1:2.20.1-2+deb10u8 gnupg2=2.2.12-1+deb10u2 -y\n#   PHP\n#   intl\nRUN apt-get update \\\n && apt-get install --no-install-recommends libicu-dev=63.1-6+deb10u3 -y \\\n && docker-php-ext-configure intl \\\n && docker-php-ext-install -j$( nproc ;) intl\n#   xml\nRUN apt-get update \\\n && apt-get install --no-install-recommends libxml2-dev=2.9.4+dfsg1-7+deb10u5 libxslt-dev -y \\\n && docker-php-ext-install -j$( nproc ;) dom xmlrpc xsl\n#   images\nRUN apt-get update \\\n && apt-get install --no-install-recommends libfreetype6-dev=2.9.1-3+deb10u3 libjpeg62-turbo-dev=1:1.5.2-2+deb10u1 libpng-dev=1.6.36-6 libgd-dev=2.2.5-5.2 -y \\\n && docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ \\\n && docker-php-ext-install -j$( nproc ;) gd exif\n#   database\nRUN docker-php-ext-install -j$( nproc ;) mysqli pdo pdo_mysql\n#   strings\nRUN docker-php-ext-install -j$( nproc ;) gettext mbstring\n#   math\nRUN apt-get update \\\n && apt-get install --no-install-recommends libgmp-dev=2:6.1.2+dfsg-4+deb10u1 -y \\\n && ln -s /usr/include/x86_64-linux-gnu/gmp.h /usr/include/gmp.h \\\n && docker-php-ext-install -j$( nproc ;) gmp bcmath\n#   compression\nRUN apt-get update \\\n && apt-get install --no-install-recommends libbz2-dev=1.0.6-9.2~deb10u2 zlib1g-dev=1:1.2.11.dfsg-1+deb10u2 -y \\\n && docker-php-ext-install -j$( nproc ;) zip bz2\n#   ftp\nRUN apt-get update \\\n && apt-get install --no-install-recommends libssl-dev=1.1.1n-0+deb10u4 -y \\\n && docker-php-ext-install -j$( nproc ;) ftp\n#   ssh2\nRUN apt-get update \\\n && apt-get install --no-install-recommends libssh2-1-dev=1.8.0-2.1 -y\n#   memcached\nRUN apt-get update \\\n && apt-get install --no-install-recommends libmemcached-dev=1.0.18-4.2 libmemcached11=1.0.18-4.2 -y\n#   others\nRUN docker-php-ext-install -j$( nproc ;) soap sockets calendar sysvmsg sysvsem sysvshm\n#   PECL\nRUN docker-php-pecl-install ssh2-1.1.2 redis-4.0.2 apcu-5.1.11 memcached-3.0.4\n#   Install XDebug, but not enable by default. Enable using:\n#   * php -d$XDEBUG_EXT vendor/bin/phpunit\n#   * php_xdebug vendor/bin/phpunit\nRUN pecl install xdebug-2.6.0\nENV XDEBUG_EXT=\"zend_extension=/usr/local/lib/php/extensions/no-debug-non-zts-20170718/xdebug.so\"\nRUN alias php_xdebug=\"php -d$XDEBUG_EXT vendor/bin/phpunit\"\n#   Install composer and put binary into $PATH\nRUN curl -sS https://getcomposer.org/installer | php \\\n && mv composer.phar /usr/local/bin/ \\\n && ln -s /usr/local/bin/composer.phar /usr/local/bin/composer\n#   Install PHP Code sniffer\nRUN curl -OL https://squizlabs.github.io/PHP_CodeSniffer/phpcs.phar \\\n && chmod 755 phpcs.phar \\\n && mv phpcs.phar /usr/local/bin/ \\\n && ln -s /usr/local/bin/phpcs.phar /usr/local/bin/phpcs \\\n && curl -OL https://squizlabs.github.io/PHP_CodeSniffer/phpcbf.phar \\\n && chmod 755 phpcbf.phar \\\n && mv phpcbf.phar /usr/local/bin/ \\\n && ln -s /usr/local/bin/phpcbf.phar /usr/local/bin/phpcbf\n#   Install PHPUnit\nRUN curl -OL https://phar.phpunit.de/phpunit.phar \\\n && chmod 755 phpunit.phar \\\n && mv phpunit.phar /usr/local/bin/ \\\n && ln -s /usr/local/bin/phpunit.phar /usr/local/bin/phpunit\nCOPY php.ini /usr/local/etc/php/conf.d/docker-php.ini\n#  # NodeJS, NPM\n#   Install NodeJS\nRUN curl -sL https://deb.nodesource.com/setup_8.x | bash - \\\n && apt-get install --no-install-recommends nodejs=10.24.0~dfsg-1~deb10u3 -y\n#   Install Yarn\nRUN curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | apt-key add - \\\n && echo \"deb https://dl.yarnpkg.com/debian/ stable main\" | tee /etc/apt/sources.list.d/yarn.list \\\n && apt-get update \\\n && apt-get install --no-install-recommends yarn -y\n#   Install Grunt globally\nRUN npm install grunt-cli@1.4.3 -g\n#   Install Gulp globally\nRUN npm install gulp-cli@2.3.0 -g\n#   Install Bower globally\nRUN npm install bower@1.8.14 -g\n#   MariaDB\nRUN apt-get update \\\n && apt-get install --no-install-recommends software-properties-common=0.96.20.2-2 dirmngr=2.2.12-1+deb10u2 -y \\\n && apt-key adv --recv-keys --keyserver keyserver.ubuntu.com 0xF1656F24C74CD1D8 \\\n && add-apt-repository 'deb [arch=amd64,i386,ppc64el] http://mirror.vpsfree.cz/mariadb/repo/10.2/debian stretch main'\nRUN apt-get update \\\n && apt-get install --no-install-recommends mariadb-server=1:10.3.38-0+deb10u1 -y\nVOLUME /var/lib/mysql\nCOPY my.cnf /etc/mysql/conf.d/my.cnf\nEXPOSE 3306/tcp\n#   Redis\nRUN apt-get update \\\n && apt-get install --no-install-recommends redis-server=5:5.0.14-1+deb10u3 -y\nEXPOSE 6379/tcp\n#   Clean\nRUN apt-get clean\nRUN rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* /var/cache/*\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\n","originalDockerfile":"FROM php:7.2-fpm\nMAINTAINER Jaroslav Hranicka <hranicka@outlook.com>\nENV DEBIAN_FRONTEND=\"noninteractive\"\nCOPY bin/* /usr/local/bin/\nRUN chmod -R 700 /usr/local/bin/\n#  Locales\nRUN apt-get update \\\n && apt-get install locales -y\nRUN dpkg-reconfigure locales \\\n && locale-gen C.UTF-8 \\\n && /usr/sbin/update-locale LANG=C.UTF-8\nRUN echo 'en_US.UTF-8 UTF-8' >> /etc/locale.gen \\\n && locale-gen\nENV LC_ALL=\"C.UTF-8\"\nENV LANG=\"en_US.UTF-8\"\nENV LANGUAGE=\"en_US.UTF-8\"\n#  Common\nRUN apt-get update \\\n && apt-get install openssl git gnupg2 -y\n#  PHP\n#  intl\nRUN apt-get update \\\n && apt-get install libicu-dev -y \\\n && docker-php-ext-configure intl \\\n && docker-php-ext-install -j$( nproc ;) intl\n#  xml\nRUN apt-get update \\\n && apt-get install libxml2-dev libxslt-dev -y \\\n && docker-php-ext-install -j$( nproc ;) dom xmlrpc xsl\n#  images\nRUN apt-get update \\\n && apt-get install libfreetype6-dev libjpeg62-turbo-dev libpng-dev libgd-dev -y \\\n && docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ \\\n && docker-php-ext-install -j$( nproc ;) gd exif\n#  database\nRUN docker-php-ext-install -j$( nproc ;) mysqli pdo pdo_mysql\n#  strings\nRUN docker-php-ext-install -j$( nproc ;) gettext mbstring\n#  math\nRUN apt-get update \\\n && apt-get install libgmp-dev -y \\\n && ln -s /usr/include/x86_64-linux-gnu/gmp.h /usr/include/gmp.h \\\n && docker-php-ext-install -j$( nproc ;) gmp bcmath\n#  compression\nRUN apt-get update \\\n && apt-get install libbz2-dev zlib1g-dev -y \\\n && docker-php-ext-install -j$( nproc ;) zip bz2\n#  ftp\nRUN apt-get update \\\n && apt-get install libssl-dev -y \\\n && docker-php-ext-install -j$( nproc ;) ftp\n#  ssh2\nRUN apt-get update \\\n && apt-get install libssh2-1-dev -y\n#  memcached\nRUN apt-get update \\\n && apt-get install libmemcached-dev libmemcached11 -y\n#  others\nRUN docker-php-ext-install -j$( nproc ;) soap sockets calendar sysvmsg sysvsem sysvshm\n#  PECL\nRUN docker-php-pecl-install ssh2-1.1.2 redis-4.0.2 apcu-5.1.11 memcached-3.0.4\n#  Install XDebug, but not enable by default. Enable using:\n#  * php -d$XDEBUG_EXT vendor/bin/phpunit\n#  * php_xdebug vendor/bin/phpunit\nRUN pecl install xdebug-2.6.0\nENV XDEBUG_EXT=\"zend_extension=/usr/local/lib/php/extensions/no-debug-non-zts-20170718/xdebug.so\"\nRUN alias php_xdebug=\"php -d$XDEBUG_EXT vendor/bin/phpunit\"\n#  Install composer and put binary into $PATH\nRUN curl -sS https://getcomposer.org/installer | php \\\n && mv composer.phar /usr/local/bin/ \\\n && ln -s /usr/local/bin/composer.phar /usr/local/bin/composer\n#  Install PHP Code sniffer\nRUN curl -OL https://squizlabs.github.io/PHP_CodeSniffer/phpcs.phar \\\n && chmod 755 phpcs.phar \\\n && mv phpcs.phar /usr/local/bin/ \\\n && ln -s /usr/local/bin/phpcs.phar /usr/local/bin/phpcs \\\n && curl -OL https://squizlabs.github.io/PHP_CodeSniffer/phpcbf.phar \\\n && chmod 755 phpcbf.phar \\\n && mv phpcbf.phar /usr/local/bin/ \\\n && ln -s /usr/local/bin/phpcbf.phar /usr/local/bin/phpcbf\n#  Install PHPUnit\nRUN curl -OL https://phar.phpunit.de/phpunit.phar \\\n && chmod 755 phpunit.phar \\\n && mv phpunit.phar /usr/local/bin/ \\\n && ln -s /usr/local/bin/phpunit.phar /usr/local/bin/phpunit\nADD php.ini /usr/local/etc/php/conf.d/docker-php.ini\n# # NodeJS, NPM\n#  Install NodeJS\nRUN curl -sL https://deb.nodesource.com/setup_8.x | bash - \\\n && apt-get install nodejs -y\n#  Install Yarn\nRUN curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | apt-key add - \\\n && echo \"deb https://dl.yarnpkg.com/debian/ stable main\" | tee /etc/apt/sources.list.d/yarn.list \\\n && apt-get update \\\n && apt-get install yarn -y\n#  Install Grunt globally\nRUN npm install grunt-cli -g\n#  Install Gulp globally\nRUN npm install gulp-cli -g\n#  Install Bower globally\nRUN npm install bower -g\n#  MariaDB\nRUN apt-get update \\\n && apt-get install software-properties-common dirmngr -y \\\n && apt-key adv --recv-keys --keyserver keyserver.ubuntu.com 0xF1656F24C74CD1D8 \\\n && add-apt-repository 'deb [arch=amd64,i386,ppc64el] http://mirror.vpsfree.cz/mariadb/repo/10.2/debian stretch main'\nRUN apt-get update \\\n && apt-get install mariadb-server -y\nVOLUME /var/lib/mysql\nADD my.cnf /etc/mysql/conf.d/my.cnf\nEXPOSE 3306/tcp\n#  Redis\nRUN apt-get update \\\n && apt-get install redis-server -y\nEXPOSE 6379/tcp\n#  Clean\nRUN apt-get clean\nRUN rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* /var/cache/*\n","injectedSmells":[],"originalDockerfileHash":"c4100d6d3a48df3d41a7b56c56a257ab","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM php:7.2-fpm\nMAINTAINER Jaroslav Hranicka <hranicka@outlook.com>\nENV DEBIAN_FRONTEND=\"noninteractive\"\nCOPY bin/* /usr/local/bin/\nRUN chmod -R 700 /usr/local/bin/\n#   Locales\nRUN apt-get update \\\n && apt-get install locales -y\nRUN dpkg-reconfigure locales \\\n && locale-gen C.UTF-8 \\\n && /usr/sbin/update-locale LANG=C.UTF-8\nRUN echo 'en_US.UTF-8 UTF-8' >> /etc/locale.gen \\\n && locale-gen\nENV LC_ALL=\"C.UTF-8\"\nENV LANG=\"en_US.UTF-8\"\nENV LANGUAGE=\"en_US.UTF-8\"\n#   Common\nRUN apt-get update \\\n && apt-get install openssl git gnupg2 -y\n#   PHP\n#   intl\nRUN apt-get update \\\n && apt-get install libicu-dev -y \\\n && docker-php-ext-configure intl \\\n && docker-php-ext-install -j$( nproc ;) intl\n#   xml\nRUN apt-get update \\\n && apt-get install libxml2-dev libxslt-dev -y \\\n && docker-php-ext-install -j$( nproc ;) dom xmlrpc xsl\n#   images\nRUN apt-get update \\\n && apt-get install libfreetype6-dev libjpeg62-turbo-dev libpng-dev libgd-dev -y \\\n && docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ \\\n && docker-php-ext-install -j$( nproc ;) gd exif\n#   database\nRUN docker-php-ext-install -j$( nproc ;) mysqli pdo pdo_mysql\n#   strings\nRUN docker-php-ext-install -j$( nproc ;) gettext mbstring\n#   math\nRUN apt-get update \\\n && apt-get install libgmp-dev -y \\\n && ln -s /usr/include/x86_64-linux-gnu/gmp.h /usr/include/gmp.h \\\n && docker-php-ext-install -j$( nproc ;) gmp bcmath\n#   compression\nRUN apt-get update \\\n && apt-get install libbz2-dev zlib1g-dev -y \\\n && docker-php-ext-install -j$( nproc ;) zip bz2\n#   ftp\nRUN apt-get update \\\n && apt-get install libssl-dev -y \\\n && docker-php-ext-install -j$( nproc ;) ftp\n#   ssh2\nRUN apt-get update \\\n && apt-get install libssh2-1-dev -y\n#   memcached\nRUN apt-get update \\\n && apt-get install libmemcached-dev libmemcached11 -y\n#   others\nRUN docker-php-ext-install -j$( nproc ;) soap sockets calendar sysvmsg sysvsem sysvshm\n#   PECL\nRUN docker-php-pecl-install ssh2-1.1.2 redis-4.0.2 apcu-5.1.11 memcached-3.0.4\n#   Install XDebug, but not enable by default. Enable using:\n#   * php -d$XDEBUG_EXT vendor/bin/phpunit\n#   * php_xdebug vendor/bin/phpunit\nRUN pecl install xdebug-2.6.0\nENV XDEBUG_EXT=\"zend_extension=/usr/local/lib/php/extensions/no-debug-non-zts-20170718/xdebug.so\"\nRUN alias php_xdebug=\"php -d$XDEBUG_EXT vendor/bin/phpunit\"\n#   Install composer and put binary into $PATH\nRUN curl -sS https://getcomposer.org/installer | php \\\n && mv composer.phar /usr/local/bin/ \\\n && ln -s /usr/local/bin/composer.phar /usr/local/bin/composer\n#   Install PHP Code sniffer\nRUN curl -OL https://squizlabs.github.io/PHP_CodeSniffer/phpcs.phar \\\n && chmod 755 phpcs.phar \\\n && mv phpcs.phar /usr/local/bin/ \\\n && ln -s /usr/local/bin/phpcs.phar /usr/local/bin/phpcs \\\n && curl -OL https://squizlabs.github.io/PHP_CodeSniffer/phpcbf.phar \\\n && chmod 755 phpcbf.phar \\\n && mv phpcbf.phar /usr/local/bin/ \\\n && ln -s /usr/local/bin/phpcbf.phar /usr/local/bin/phpcbf\n#   Install PHPUnit\nRUN curl -OL https://phar.phpunit.de/phpunit.phar \\\n && chmod 755 phpunit.phar \\\n && mv phpunit.phar /usr/local/bin/ \\\n && ln -s /usr/local/bin/phpunit.phar /usr/local/bin/phpunit\nADD php.ini /usr/local/etc/php/conf.d/docker-php.ini\n#  # NodeJS, NPM\n#   Install NodeJS\nRUN curl -sL https://deb.nodesource.com/setup_8.x | bash - \\\n && apt-get install nodejs -y\n#   Install Yarn\nRUN curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | apt-key add - \\\n && echo \"deb https://dl.yarnpkg.com/debian/ stable main\" | tee /etc/apt/sources.list.d/yarn.list \\\n && apt-get update \\\n && apt-get install yarn -y\n#   Install Grunt globally\nRUN npm install grunt-cli -g\n#   Install Gulp globally\nRUN npm install gulp-cli -g\n#   Install Bower globally\nRUN npm install bower -g\n#   MariaDB\nRUN apt-get update \\\n && apt-get install software-properties-common dirmngr -y \\\n && apt-key adv --recv-keys --keyserver keyserver.ubuntu.com 0xF1656F24C74CD1D8 \\\n && add-apt-repository 'deb [arch=amd64,i386,ppc64el] http://mirror.vpsfree.cz/mariadb/repo/10.2/debian stretch main'\nRUN apt-get update \\\n && apt-get install mariadb-server -y\nVOLUME /var/lib/mysql\nADD my.cnf /etc/mysql/conf.d/my.cnf\nEXPOSE 3306/tcp\n#   Redis\nRUN apt-get update \\\n && apt-get install redis-server -y\nEXPOSE 6379/tcp\n#   Clean\nRUN apt-get clean\nRUN rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* /var/cache/*\n","originalDockerfileUglifiedHash":"d50b8699ce31a60436088853f6754ac3","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/af593d89da8b3feda1ed38adf76227f95c21aa81.dockerfile"}