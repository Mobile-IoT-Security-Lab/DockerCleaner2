{"seed":215503378,"processedDockerfileHash":"92f73e37f7cca57c30bccde3f95a43bc","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","pin-package-manager-versions-apt-get","have-a-healthcheck","have-a-user"],"processedDockerfile":"#   Copyright 2019 The Skaffold Authors All rights reserved.\n#\n#   Licensed under the Apache License, Version 2.0 (the \"License\");\n#   you may not use this file except in compliance with the License.\n#   You may obtain a copy of the License at\n#\n#       http://www.apache.org/licenses/LICENSE-2.0\n#\n#   Unless required by applicable law or agreed to in writing, software\n#   distributed under the License is distributed on an \"AS IS\" BASIS,\n#   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n#   See the License for the specific language governing permissions and\n#   limitations under the License.\nFROM gcr.io/gcp-runtimes/ubuntu_16_0_4 AS runtime_deps\nRUN apt-get update \\\n && apt-get install --no-install-recommends git=1:2.39.2-1ubuntu1 python --no-install-suggests -y \\\n && rm -rf /var/lib/apt/lists/*\nENV KUBECTL_VERSION=\"v1.12.0\"\nRUN curl -Lo /usr/local/bin/kubectl https://storage.googleapis.com/kubernetes-release/release/${KUBECTL_VERSION}/bin/linux/amd64/kubectl \\\n && chmod +x /usr/local/bin/kubectl\nENV HELM_VERSION=\"v2.8.1\"\nRUN curl -LO https://storage.googleapis.com/kubernetes-helm/helm-${HELM_VERSION}-linux-amd64.tar.gz \\\n && tar -xvf helm-${HELM_VERSION}-linux-amd64.tar.gz -C /usr/local/bin --strip-components 1 \\\n && rm -f helm-${HELM_VERSION}-linux-amd64.tar.gz\nENV CLOUD_SDK_VERSION=\"217.0.0\"\nRUN curl -LO https://dl.google.com/dl/cloudsdk/channels/rapid/downloads/google-cloud-sdk-${CLOUD_SDK_VERSION}-linux-x86_64.tar.gz \\\n && tar -zxvf google-cloud-sdk-${CLOUD_SDK_VERSION}-linux-x86_64.tar.gz \\\n && CLOUDSDK_PYTHON=\"python2.7\" /google-cloud-sdk/install.sh --usage-reporting=false --bash-completion=false --disable-installation-options \\\n && rm -rf google-cloud-sdk-*.tar.gz\nENV PATH=\"$PATH:/google-cloud-sdk/bin\"\nRUN /google-cloud-sdk/bin/gcloud auth configure-docker\nENV KUSTOMIZE_VERSION=\"2.0.3\"\nRUN curl -LO https://github.com/kubernetes-sigs/kustomize/releases/download/v${KUSTOMIZE_VERSION}/kustomize_${KUSTOMIZE_VERSION}_linux_amd64 \\\n && chmod +x kustomize_${KUSTOMIZE_VERSION}_linux_amd64 \\\n && mv kustomize_${KUSTOMIZE_VERSION}_linux_amd64 /usr/local/bin/kustomize\nENV KOMPOSE_VERSION=\"1.17.0\"\nRUN curl -L https://github.com/kubernetes/kompose/releases/download/v${KOMPOSE_VERSION}/kompose-linux-amd64 -o kompose \\\n && chmod +x kompose \\\n && mv kompose /usr/local/bin\nRUN echo \"deb [arch=amd64] http://storage.googleapis.com/bazel-apt stable jdk1.8\" | tee /etc/apt/sources.list.d/bazel.list \\\n && curl https://bazel.build/bazel-release.pub.gpg | apt-key add -\nRUN apt-get update \\\n && apt-get install --no-install-recommends bazel -y \\\n && rm -rf /var/lib/apt/lists/*\nENV CONTAINER_STRUCTURE_TEST_VERSION=\"1.5.0\"\nRUN curl -LO https://storage.googleapis.com/container-structure-test/v${CONTAINER_STRUCTURE_TEST_VERSION}/container-structure-test-linux-amd64 \\\n && chmod +x container-structure-test-linux-amd64 \\\n && mv container-structure-test-linux-amd64 /usr/local/bin/container-structure-test\nENV PATH=\"/usr/local/go/bin:/go/bin:/google-cloud-sdk/bin:$PATH\"\nFROM runtime_deps AS builder\nRUN apt-get update \\\n && apt-get install --no-install-recommends ca-certificates=20230311 curl=7.88.1-7ubuntu1 build-essential=12.9ubuntu3 gcc=4:12.2.0-3ubuntu1 python-setuptools lsb-release=12.0-1ubuntu1 openjdk-8-jdk=8u362-ga-0ubuntu2 software-properties-common=0.99.35 apt-transport-https=2.6.0 --no-install-suggests -y \\\n && curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add - \\\n && apt-key fingerprint 0EBFCD88 \\\n && add-apt-repository \"deb [arch=amd64] https://download.docker.com/linux/ubuntu xenial edge\" \\\n && apt-get update -y \\\n && apt-get install --no-install-recommends docker-ce=17.12.0~ce-0~ubuntu -y \\\n && rm -rf /var/lib/apt/lists/*\nCOPY --from=golang:1.11 /usr/local/go /usr/local/go\nENV PATH=\"/usr/local/go/bin:/go/bin:$PATH\"\nENV GOPATH=\"/go/\"\nWORKDIR /go/src/github.com/GoogleContainerTools/skaffold\nCOPY . .\nFROM builder AS integration\nARG VERSION\nENV KIND_VERSION=\"v0.3.0\"\nRUN curl -Lo kind https://github.com/kubernetes-sigs/kind/releases/download/${KIND_VERSION}/kind-linux-amd64 \\\n && chmod +x kind \\\n && mv kind /usr/local/bin/\nRUN make out/skaffold-linux-amd64 VERSION=$VERSION \\\n && mv out/skaffold-linux-amd64 /usr/bin/skaffold\nCMD [\"make\", \"integration\"]\nFROM runtime_deps AS distribution\nCOPY --from=integration /usr/bin/skaffold /usr/bin/skaffold\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  Copyright 2019 The Skaffold Authors All rights reserved.\n#\n#  Licensed under the Apache License, Version 2.0 (the \"License\");\n#  you may not use this file except in compliance with the License.\n#  You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n#  Unless required by applicable law or agreed to in writing, software\n#  distributed under the License is distributed on an \"AS IS\" BASIS,\n#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n#  See the License for the specific language governing permissions and\n#  limitations under the License.\nFROM gcr.io/gcp-runtimes/ubuntu_16_0_4 AS runtime_deps\nRUN apt-get update \\\n && apt-get install --no-install-recommends git python --no-install-suggests -y \\\n && rm -rf /var/lib/apt/lists/*\nENV KUBECTL_VERSION=\"v1.12.0\"\nRUN curl -Lo /usr/local/bin/kubectl https://storage.googleapis.com/kubernetes-release/release/${KUBECTL_VERSION}/bin/linux/amd64/kubectl \\\n && chmod +x /usr/local/bin/kubectl\nENV HELM_VERSION=\"v2.8.1\"\nRUN curl -LO https://storage.googleapis.com/kubernetes-helm/helm-${HELM_VERSION}-linux-amd64.tar.gz \\\n && tar -xvf helm-${HELM_VERSION}-linux-amd64.tar.gz -C /usr/local/bin --strip-components 1 \\\n && rm -f helm-${HELM_VERSION}-linux-amd64.tar.gz\nENV CLOUD_SDK_VERSION=\"217.0.0\"\nRUN curl -LO https://dl.google.com/dl/cloudsdk/channels/rapid/downloads/google-cloud-sdk-${CLOUD_SDK_VERSION}-linux-x86_64.tar.gz \\\n && tar -zxvf google-cloud-sdk-${CLOUD_SDK_VERSION}-linux-x86_64.tar.gz \\\n && CLOUDSDK_PYTHON=\"python2.7\" /google-cloud-sdk/install.sh --usage-reporting=false --bash-completion=false --disable-installation-options \\\n && rm -rf google-cloud-sdk-*.tar.gz\nENV PATH=\"$PATH:/google-cloud-sdk/bin\"\nRUN /google-cloud-sdk/bin/gcloud auth configure-docker\nENV KUSTOMIZE_VERSION=\"2.0.3\"\nRUN curl -LO https://github.com/kubernetes-sigs/kustomize/releases/download/v${KUSTOMIZE_VERSION}/kustomize_${KUSTOMIZE_VERSION}_linux_amd64 \\\n && chmod +x kustomize_${KUSTOMIZE_VERSION}_linux_amd64 \\\n && mv kustomize_${KUSTOMIZE_VERSION}_linux_amd64 /usr/local/bin/kustomize\nENV KOMPOSE_VERSION=\"1.17.0\"\nRUN curl -L https://github.com/kubernetes/kompose/releases/download/v${KOMPOSE_VERSION}/kompose-linux-amd64 -o kompose \\\n && chmod +x kompose \\\n && mv kompose /usr/local/bin\nRUN echo \"deb [arch=amd64] http://storage.googleapis.com/bazel-apt stable jdk1.8\" | tee /etc/apt/sources.list.d/bazel.list \\\n && curl https://bazel.build/bazel-release.pub.gpg | apt-key add -\nRUN apt-get update \\\n && apt-get install bazel -y \\\n && rm -rf /var/lib/apt/lists/*\nENV CONTAINER_STRUCTURE_TEST_VERSION=\"1.5.0\"\nRUN curl -LO https://storage.googleapis.com/container-structure-test/v${CONTAINER_STRUCTURE_TEST_VERSION}/container-structure-test-linux-amd64 \\\n && chmod +x container-structure-test-linux-amd64 \\\n && mv container-structure-test-linux-amd64 /usr/local/bin/container-structure-test\nENV PATH=\"/usr/local/go/bin:/go/bin:/google-cloud-sdk/bin:$PATH\"\nFROM runtime_deps AS builder\nRUN apt-get update \\\n && apt-get install --no-install-recommends ca-certificates curl build-essential gcc python-setuptools lsb-release openjdk-8-jdk software-properties-common apt-transport-https --no-install-suggests -y \\\n && curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add - \\\n && apt-key fingerprint 0EBFCD88 \\\n && add-apt-repository \"deb [arch=amd64] https://download.docker.com/linux/ubuntu xenial edge\" \\\n && apt-get update -y \\\n && apt-get install docker-ce=17.12.0~ce-0~ubuntu -y \\\n && rm -rf /var/lib/apt/lists/*\nCOPY --from=golang:1.11 /usr/local/go /usr/local/go\nENV PATH=\"/usr/local/go/bin:/go/bin:$PATH\"\nENV GOPATH=\"/go/\"\nWORKDIR /go/src/github.com/GoogleContainerTools/skaffold\nCOPY . .\nFROM builder AS integration\nARG VERSION\nENV KIND_VERSION=\"v0.3.0\"\nRUN curl -Lo kind https://github.com/kubernetes-sigs/kind/releases/download/${KIND_VERSION}/kind-linux-amd64 \\\n && chmod +x kind \\\n && mv kind /usr/local/bin/\nRUN make out/skaffold-linux-amd64 VERSION=$VERSION \\\n && mv out/skaffold-linux-amd64 /usr/bin/skaffold\nCMD [\"make\", \"integration\"]\nFROM runtime_deps AS distribution\nCOPY --from=integration /usr/bin/skaffold /usr/bin/skaffold\n","injectedSmells":[],"originalDockerfileHash":"e575b91a679fc1ab4f693b6c0cd85212","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   Copyright 2019 The Skaffold Authors All rights reserved.\n#\n#   Licensed under the Apache License, Version 2.0 (the \"License\");\n#   you may not use this file except in compliance with the License.\n#   You may obtain a copy of the License at\n#\n#       http://www.apache.org/licenses/LICENSE-2.0\n#\n#   Unless required by applicable law or agreed to in writing, software\n#   distributed under the License is distributed on an \"AS IS\" BASIS,\n#   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n#   See the License for the specific language governing permissions and\n#   limitations under the License.\nFROM gcr.io/gcp-runtimes/ubuntu_16_0_4 AS runtime_deps\nRUN apt-get update \\\n && apt-get install --no-install-recommends git python --no-install-suggests -y \\\n && rm -rf /var/lib/apt/lists/*\nENV KUBECTL_VERSION=\"v1.12.0\"\nRUN curl -Lo /usr/local/bin/kubectl https://storage.googleapis.com/kubernetes-release/release/${KUBECTL_VERSION}/bin/linux/amd64/kubectl \\\n && chmod +x /usr/local/bin/kubectl\nENV HELM_VERSION=\"v2.8.1\"\nRUN curl -LO https://storage.googleapis.com/kubernetes-helm/helm-${HELM_VERSION}-linux-amd64.tar.gz \\\n && tar -xvf helm-${HELM_VERSION}-linux-amd64.tar.gz -C /usr/local/bin --strip-components 1 \\\n && rm -f helm-${HELM_VERSION}-linux-amd64.tar.gz\nENV CLOUD_SDK_VERSION=\"217.0.0\"\nRUN curl -LO https://dl.google.com/dl/cloudsdk/channels/rapid/downloads/google-cloud-sdk-${CLOUD_SDK_VERSION}-linux-x86_64.tar.gz \\\n && tar -zxvf google-cloud-sdk-${CLOUD_SDK_VERSION}-linux-x86_64.tar.gz \\\n && CLOUDSDK_PYTHON=\"python2.7\" /google-cloud-sdk/install.sh --usage-reporting=false --bash-completion=false --disable-installation-options \\\n && rm -rf google-cloud-sdk-*.tar.gz\nENV PATH=\"$PATH:/google-cloud-sdk/bin\"\nRUN /google-cloud-sdk/bin/gcloud auth configure-docker\nENV KUSTOMIZE_VERSION=\"2.0.3\"\nRUN curl -LO https://github.com/kubernetes-sigs/kustomize/releases/download/v${KUSTOMIZE_VERSION}/kustomize_${KUSTOMIZE_VERSION}_linux_amd64 \\\n && chmod +x kustomize_${KUSTOMIZE_VERSION}_linux_amd64 \\\n && mv kustomize_${KUSTOMIZE_VERSION}_linux_amd64 /usr/local/bin/kustomize\nENV KOMPOSE_VERSION=\"1.17.0\"\nRUN curl -L https://github.com/kubernetes/kompose/releases/download/v${KOMPOSE_VERSION}/kompose-linux-amd64 -o kompose \\\n && chmod +x kompose \\\n && mv kompose /usr/local/bin\nRUN echo \"deb [arch=amd64] http://storage.googleapis.com/bazel-apt stable jdk1.8\" | tee /etc/apt/sources.list.d/bazel.list \\\n && curl https://bazel.build/bazel-release.pub.gpg | apt-key add -\nRUN apt-get update \\\n && apt-get install bazel -y \\\n && rm -rf /var/lib/apt/lists/*\nENV CONTAINER_STRUCTURE_TEST_VERSION=\"1.5.0\"\nRUN curl -LO https://storage.googleapis.com/container-structure-test/v${CONTAINER_STRUCTURE_TEST_VERSION}/container-structure-test-linux-amd64 \\\n && chmod +x container-structure-test-linux-amd64 \\\n && mv container-structure-test-linux-amd64 /usr/local/bin/container-structure-test\nENV PATH=\"/usr/local/go/bin:/go/bin:/google-cloud-sdk/bin:$PATH\"\nFROM runtime_deps AS builder\nRUN apt-get update \\\n && apt-get install --no-install-recommends ca-certificates curl build-essential gcc python-setuptools lsb-release openjdk-8-jdk software-properties-common apt-transport-https --no-install-suggests -y \\\n && curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add - \\\n && apt-key fingerprint 0EBFCD88 \\\n && add-apt-repository \"deb [arch=amd64] https://download.docker.com/linux/ubuntu xenial edge\" \\\n && apt-get update -y \\\n && apt-get install docker-ce=17.12.0~ce-0~ubuntu -y \\\n && rm -rf /var/lib/apt/lists/*\nCOPY --from=golang:1.11 /usr/local/go /usr/local/go\nENV PATH=\"/usr/local/go/bin:/go/bin:$PATH\"\nENV GOPATH=\"/go/\"\nWORKDIR /go/src/github.com/GoogleContainerTools/skaffold\nCOPY . .\nFROM builder AS integration\nARG VERSION\nENV KIND_VERSION=\"v0.3.0\"\nRUN curl -Lo kind https://github.com/kubernetes-sigs/kind/releases/download/${KIND_VERSION}/kind-linux-amd64 \\\n && chmod +x kind \\\n && mv kind /usr/local/bin/\nRUN make out/skaffold-linux-amd64 VERSION=$VERSION \\\n && mv out/skaffold-linux-amd64 /usr/bin/skaffold\nCMD [\"make\", \"integration\"]\nFROM runtime_deps AS distribution\nCOPY --from=integration /usr/bin/skaffold /usr/bin/skaffold\n","originalDockerfileUglifiedHash":"f1809d75be4a73d6ca9f5d64316e2899","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/f373cd90bd61e4e00f590e664855e3a415e0cc40.dockerfile"}