{"seed":856543922,"processedDockerfileHash":"c937fb508e1b8fda26d346f43024d642","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","pin-package-manager-versions-apt-get","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM openjdk:8-jre\nLABEL maintainer=\"Jishu Xu <jishuxu@broadinstitute.org>\" \\\n      software=\"Analysis-tools with Picard-2.10.10, Python-3.5.3 and R-3.3.3\" \\\n      description=\"A generic toolset for doing large-scale analysis easily with Google Cloud Buckets.\"\n#   Install Picard\n#   Please follow the below instructions to invoke picard when you are using this docker image:\n#   java jvm-args -jar /usr/picard/picard.jar PicardToolName OPTION1=value1 OPTION2=value2...\nENV picard_version=\"2.10.10\"\nWORKDIR /usr/picard\nRUN which wget &> /dev/null || apt-get install --no-install-recommends wget=1.20.3 ; wget --no-verbose --output-document ./picard.jar https://github.com/broadinstitute/picard/releases/download/${picard_version}/picard.jar\n#   Install Python3\nENV PATH=\"/usr/local/bin:$PATH\"\nRUN apt-get update \\\n && apt-get install --no-install-recommends python3-pip=20.3.4-4+deb11u1 python3-dev=3.9.2-3 -y \\\n && cd /usr/local/bin \\\n && ln -s /usr/bin/python3 python \\\n && pip3 install --upgrade pip\n#   Install R and other dependencies\nRUN apt-get update \\\n && apt-get install --no-install-recommends build-essential=12.9 cmake=3.18.4-2+deb11u1 automake=1:1.16.3-2 curl=7.74.0-1.3+deb11u7 gcc-multilib=4:10.2.1-1 git=1:2.30.2-1+deb11u2 libcurl4-openssl-dev=7.74.0-1.3+deb11u7 libssl-dev=1.1.1n-0+deb11u4 libboost-all-dev=1.74.0.3 libncurses5-dev=6.2+20201114-2 libxml2-dev=2.9.10+dfsg-6.7+deb11u3 libncurses5-dev=6.2+20201114-2 libboost-all-dev=1.74.0.3 libbz2-dev=1.0.8-4 liblzma-dev=5.2.5-2.1~deb11u1 lsb-release=11.1.0 samtools=1.11-1 sudo=1.9.5p2-3+deb11u1 wget=1.21-1+deb11u1 zlib1g-dev=1:1.2.11.dfsg-2+deb11u2 gfortran=4:10.2.1-1 -y\nRUN echo \"deb http://http.debian.net/debian sid main\" > /etc/apt/sources.list.d/debian-unstable.list \\\n && echo 'APT::Default-Release \"testing\";' > /etc/apt/apt.conf.d/default\nENV R_BASE_VERSION=\"3.4.4\"\n#  # Now install R and littler, and create a link for littler in /usr/local/bin\n#  # Also set a default CRAN repo, and make sure littler knows about it too\nRUN apt-get update \\\n && apt-get install --no-install-recommends unstable littler=0.3.12-1 r-cran-littler=0.3.12-1 r-base=${R_BASE_VERSION}-* r-base-dev=${R_BASE_VERSION}-* r-recommended=${R_BASE_VERSION}-* -t -y \\\n && echo 'options(repos = c(CRAN = \"https://cloud.r-project.org/\"), download.file.method = \"libcurl\")' >> /etc/R/Rprofile.site \\\n && echo 'source(\"/etc/R/Rprofile.site\")' >> /etc/littler.r \\\n && ln -s /usr/share/doc/littler/examples/install.r /usr/local/bin/install.r \\\n && ln -s /usr/share/doc/littler/examples/install2.r /usr/local/bin/install2.r \\\n && ln -s /usr/share/doc/littler/examples/installGithub.r /usr/local/bin/installGithub.r \\\n && ln -s /usr/share/doc/littler/examples/testInstalled.r /usr/local/bin/testInstalled.r \\\n && install.r docopt \\\n && rm -rf /tmp/downloaded_packages/ /tmp/*.rds \\\n && rm -rf /var/lib/apt/lists/*\n#   Install python packages\nRUN pip3 install crimson==0.3.0 HTSeq==0.9.0 matplotlib==2.1.0 numpy==1.12.0 pandas==0.20.3 pysam==0.12.0.1 requests==2.18.4 scipy==0.18.1 sctools==0.1.4 tables==3.4.2 google-cloud-storage git+git://github.com/HumanCellAtlas/pipeline-tools.git\n#   Fix cannot import name 'opentype' error\nRUN pip3 install --upgrade google-auth-oauthlib\n#   Mount Google Cloud secret key\nCOPY broad-dsde-mint-dev-analysis-tools.json /usr/secrets/broad-dsde-mint-dev-analysis-tools.json\n#   Set the environment variable for Python\nENV GOOGLE_APPLICATION_CREDENTIALS=\"/usr/secrets/broad-dsde-mint-dev-analysis-tools.json\"\n#   Set the environment variable for R\nENV GCS_AUTH_FILE=\"$GOOGLE_APPLICATION_CREDENTIALS\"\n#   Install gcloud components\nRUN curl -sSL https://sdk.cloud.google.com > /tmp/gcl \\\n && bash /tmp/gcl --install-dir=/usr/gcloud --disable-prompts\n#   Configure gcloud\nENV PATH=\"$PATH:/usr/gcloud/google-cloud-sdk/bin\"\nRUN gcloud auth activate-service-account --key-file=$GCS_AUTH_FILE\n#   Add Cromwell Credentials\nCOPY broad-dsde-mint-dev-cromwell.json /usr/secrets/broad-dsde-mint-dev-cromwell.json\nRUN wget https://ftp-trace.ncbi.nlm.nih.gov/sra/sdk/2.8.2-1/sratoolkit.2.8.2-1-ubuntu64.tar.gz \\\n && tar -zxvf sratoolkit.2.8.2-1-ubuntu64.tar.gz \\\n && cp -r sratoolkit.2.8.2-1-ubuntu64/ /usr/local/\nENV PATH=\"/usr/local/sratoolkit.2.8.2-1-ubuntu64/bin:$PATH\"\nRUN pip3 install ipython\n#   Install R packages\nRUN echo \"r <- getOption('repos'); r['CRAN'] <- 'http://cran.us.r-project.org'; options(repos = r);\" > ~/.Rprofile\nRUN Rscript -e \"install.packages('reshape')\"\nRUN Rscript -e \"install.packages('gplots')\"\nRUN Rscript -e \"install.packages('ggplot2')\"\nRUN Rscript -e \"install.packages('googleCloudStorageR')\"\nRUN Rscript -e \"install.packages('gridExtra')\"\nRUN Rscript -e \"install.packages('ggpubr')\"\nRUN Rscript -e \"install.packages('ggpmisc')\"\nRUN Rscript -e \"install.packages('cowplot')\"\nRUN Rscript -e \"install.packages('corrplot')\"\nRUN Rscript -e \"install.packages('ggrepel')\"\nRUN Rscript -e \"install.packages('optparse')\"\nRUN Rscript -e 'source(\"http://bioconductor.org/biocLite.R\")' -e 'biocLite(\"rtracklayer\")'\nRUN Rscript -e 'source(\"http://bioconductor.org/biocLite.R\")' -e 'biocLite(\"scran\")'\nRUN Rscript -e \"install.packages('igraph')\"\nRUN Rscript -e \"install.packages('rsvd')\"\nRUN Rscript -e \"install.packages('factoextra')\"\nRUN Rscript -e \"install.packages('fpc')\"\nRUN Rscript -e \"install.packages('NbClust')\"\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM openjdk:8-jre\nLABEL maintainer=\"Jishu Xu <jishuxu@broadinstitute.org>\" \\\n      software=\"Analysis-tools with Picard-2.10.10, Python-3.5.3 and R-3.3.3\" \\\n      description=\"A generic toolset for doing large-scale analysis easily with Google Cloud Buckets.\"\n#  Install Picard\n#  Please follow the below instructions to invoke picard when you are using this docker image:\n#  java jvm-args -jar /usr/picard/picard.jar PicardToolName OPTION1=value1 OPTION2=value2...\nENV picard_version=\"2.10.10\"\nWORKDIR /usr/picard\nADD https://github.com/broadinstitute/picard/releases/download/${picard_version}/picard.jar ./picard.jar\n#  Install Python3\nENV PATH=\"/usr/local/bin:$PATH\"\nRUN apt-get update \\\n && apt-get install python3-pip python3-dev -y \\\n && cd /usr/local/bin \\\n && ln -s /usr/bin/python3 python \\\n && pip3 install --upgrade pip\n#  Install R and other dependencies\nRUN apt-get update \\\n && apt-get install -y build-essential cmake automake curl gcc-multilib git libcurl4-openssl-dev libssl-dev libboost-all-dev libncurses5-dev libxml2-dev libncurses5-dev libboost-all-dev libbz2-dev liblzma-dev lsb-release samtools sudo wget zlib1g-dev gfortran\nRUN echo \"deb http://http.debian.net/debian sid main\" > /etc/apt/sources.list.d/debian-unstable.list \\\n && echo 'APT::Default-Release \"testing\";' > /etc/apt/apt.conf.d/default\nENV R_BASE_VERSION=\"3.4.4\"\n# # Now install R and littler, and create a link for littler in /usr/local/bin\n# # Also set a default CRAN repo, and make sure littler knows about it too\nRUN apt-get update \\\n && apt-get install --no-install-recommends unstable littler r-cran-littler r-base=${R_BASE_VERSION}-* r-base-dev=${R_BASE_VERSION}-* r-recommended=${R_BASE_VERSION}-* -t -y \\\n && echo 'options(repos = c(CRAN = \"https://cloud.r-project.org/\"), download.file.method = \"libcurl\")' >> /etc/R/Rprofile.site \\\n && echo 'source(\"/etc/R/Rprofile.site\")' >> /etc/littler.r \\\n && ln -s /usr/share/doc/littler/examples/install.r /usr/local/bin/install.r \\\n && ln -s /usr/share/doc/littler/examples/install2.r /usr/local/bin/install2.r \\\n && ln -s /usr/share/doc/littler/examples/installGithub.r /usr/local/bin/installGithub.r \\\n && ln -s /usr/share/doc/littler/examples/testInstalled.r /usr/local/bin/testInstalled.r \\\n && install.r docopt \\\n && rm -rf /tmp/downloaded_packages/ /tmp/*.rds \\\n && rm -rf /var/lib/apt/lists/*\n#  Install python packages\nRUN pip3 install crimson==0.3.0 HTSeq==0.9.0 matplotlib==2.1.0 numpy==1.12.0 pandas==0.20.3 pysam==0.12.0.1 requests==2.18.4 scipy==0.18.1 sctools==0.1.4 tables==3.4.2 google-cloud-storage git+git://github.com/HumanCellAtlas/pipeline-tools.git\n#  Fix cannot import name 'opentype' error\nRUN pip3 install --upgrade google-auth-oauthlib\n#  Mount Google Cloud secret key\nADD broad-dsde-mint-dev-analysis-tools.json /usr/secrets/broad-dsde-mint-dev-analysis-tools.json\n#  Set the environment variable for Python\nENV GOOGLE_APPLICATION_CREDENTIALS=\"/usr/secrets/broad-dsde-mint-dev-analysis-tools.json\"\n#  Set the environment variable for R\nENV GCS_AUTH_FILE=\"$GOOGLE_APPLICATION_CREDENTIALS\"\n#  Install gcloud components\nRUN curl -sSL https://sdk.cloud.google.com > /tmp/gcl \\\n && bash /tmp/gcl --install-dir=/usr/gcloud --disable-prompts\n#  Configure gcloud\nENV PATH=\"$PATH:/usr/gcloud/google-cloud-sdk/bin\"\nRUN gcloud auth activate-service-account --key-file=$GCS_AUTH_FILE\n#  Add Cromwell Credentials\nADD broad-dsde-mint-dev-cromwell.json /usr/secrets/broad-dsde-mint-dev-cromwell.json\nRUN wget https://ftp-trace.ncbi.nlm.nih.gov/sra/sdk/2.8.2-1/sratoolkit.2.8.2-1-ubuntu64.tar.gz \\\n && tar -zxvf sratoolkit.2.8.2-1-ubuntu64.tar.gz \\\n && cp -r sratoolkit.2.8.2-1-ubuntu64/ /usr/local/\nENV PATH=\"/usr/local/sratoolkit.2.8.2-1-ubuntu64/bin:$PATH\"\nRUN pip3 install ipython\n#  Install R packages\nRUN echo \"r <- getOption('repos'); r['CRAN'] <- 'http://cran.us.r-project.org'; options(repos = r);\" > ~/.Rprofile\nRUN Rscript -e \"install.packages('reshape')\"\nRUN Rscript -e \"install.packages('gplots')\"\nRUN Rscript -e \"install.packages('ggplot2')\"\nRUN Rscript -e \"install.packages('googleCloudStorageR')\"\nRUN Rscript -e \"install.packages('gridExtra')\"\nRUN Rscript -e \"install.packages('ggpubr')\"\nRUN Rscript -e \"install.packages('ggpmisc')\"\nRUN Rscript -e \"install.packages('cowplot')\"\nRUN Rscript -e \"install.packages('corrplot')\"\nRUN Rscript -e \"install.packages('ggrepel')\"\nRUN Rscript -e \"install.packages('optparse')\"\nRUN Rscript -e 'source(\"http://bioconductor.org/biocLite.R\")' -e 'biocLite(\"rtracklayer\")'\nRUN Rscript -e 'source(\"http://bioconductor.org/biocLite.R\")' -e 'biocLite(\"scran\")'\nRUN Rscript -e \"install.packages('igraph')\"\nRUN Rscript -e \"install.packages('rsvd')\"\nRUN Rscript -e \"install.packages('factoextra')\"\nRUN Rscript -e \"install.packages('fpc')\"\nRUN Rscript -e \"install.packages('NbClust')\"\n","injectedSmells":[],"originalDockerfileHash":"a216b8442e05c60bcd357db9330dd2b2","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM openjdk:8-jre\nLABEL maintainer=\"Jishu Xu <jishuxu@broadinstitute.org>\" \\\n      software=\"Analysis-tools with Picard-2.10.10, Python-3.5.3 and R-3.3.3\" \\\n      description=\"A generic toolset for doing large-scale analysis easily with Google Cloud Buckets.\"\n#   Install Picard\n#   Please follow the below instructions to invoke picard when you are using this docker image:\n#   java jvm-args -jar /usr/picard/picard.jar PicardToolName OPTION1=value1 OPTION2=value2...\nENV picard_version=\"2.10.10\"\nWORKDIR /usr/picard\nADD https://github.com/broadinstitute/picard/releases/download/${picard_version}/picard.jar ./picard.jar\n#   Install Python3\nENV PATH=\"/usr/local/bin:$PATH\"\nRUN apt-get update \\\n && apt-get install python3-pip python3-dev -y \\\n && cd /usr/local/bin \\\n && ln -s /usr/bin/python3 python \\\n && pip3 install --upgrade pip\n#   Install R and other dependencies\nRUN apt-get update \\\n && apt-get install build-essential cmake automake curl gcc-multilib git libcurl4-openssl-dev libssl-dev libboost-all-dev libncurses5-dev libxml2-dev libncurses5-dev libboost-all-dev libbz2-dev liblzma-dev lsb-release samtools sudo wget zlib1g-dev gfortran -y\nRUN echo \"deb http://http.debian.net/debian sid main\" > /etc/apt/sources.list.d/debian-unstable.list \\\n && echo 'APT::Default-Release \"testing\";' > /etc/apt/apt.conf.d/default\nENV R_BASE_VERSION=\"3.4.4\"\n#  # Now install R and littler, and create a link for littler in /usr/local/bin\n#  # Also set a default CRAN repo, and make sure littler knows about it too\nRUN apt-get update \\\n && apt-get install --no-install-recommends unstable littler r-cran-littler r-base=${R_BASE_VERSION}-* r-base-dev=${R_BASE_VERSION}-* r-recommended=${R_BASE_VERSION}-* -t -y \\\n && echo 'options(repos = c(CRAN = \"https://cloud.r-project.org/\"), download.file.method = \"libcurl\")' >> /etc/R/Rprofile.site \\\n && echo 'source(\"/etc/R/Rprofile.site\")' >> /etc/littler.r \\\n && ln -s /usr/share/doc/littler/examples/install.r /usr/local/bin/install.r \\\n && ln -s /usr/share/doc/littler/examples/install2.r /usr/local/bin/install2.r \\\n && ln -s /usr/share/doc/littler/examples/installGithub.r /usr/local/bin/installGithub.r \\\n && ln -s /usr/share/doc/littler/examples/testInstalled.r /usr/local/bin/testInstalled.r \\\n && install.r docopt \\\n && rm -rf /tmp/downloaded_packages/ /tmp/*.rds \\\n && rm -rf /var/lib/apt/lists/*\n#   Install python packages\nRUN pip3 install crimson==0.3.0 HTSeq==0.9.0 matplotlib==2.1.0 numpy==1.12.0 pandas==0.20.3 pysam==0.12.0.1 requests==2.18.4 scipy==0.18.1 sctools==0.1.4 tables==3.4.2 google-cloud-storage git+git://github.com/HumanCellAtlas/pipeline-tools.git\n#   Fix cannot import name 'opentype' error\nRUN pip3 install --upgrade google-auth-oauthlib\n#   Mount Google Cloud secret key\nADD broad-dsde-mint-dev-analysis-tools.json /usr/secrets/broad-dsde-mint-dev-analysis-tools.json\n#   Set the environment variable for Python\nENV GOOGLE_APPLICATION_CREDENTIALS=\"/usr/secrets/broad-dsde-mint-dev-analysis-tools.json\"\n#   Set the environment variable for R\nENV GCS_AUTH_FILE=\"$GOOGLE_APPLICATION_CREDENTIALS\"\n#   Install gcloud components\nRUN curl -sSL https://sdk.cloud.google.com > /tmp/gcl \\\n && bash /tmp/gcl --install-dir=/usr/gcloud --disable-prompts\n#   Configure gcloud\nENV PATH=\"$PATH:/usr/gcloud/google-cloud-sdk/bin\"\nRUN gcloud auth activate-service-account --key-file=$GCS_AUTH_FILE\n#   Add Cromwell Credentials\nADD broad-dsde-mint-dev-cromwell.json /usr/secrets/broad-dsde-mint-dev-cromwell.json\nRUN wget https://ftp-trace.ncbi.nlm.nih.gov/sra/sdk/2.8.2-1/sratoolkit.2.8.2-1-ubuntu64.tar.gz \\\n && tar -zxvf sratoolkit.2.8.2-1-ubuntu64.tar.gz \\\n && cp -r sratoolkit.2.8.2-1-ubuntu64/ /usr/local/\nENV PATH=\"/usr/local/sratoolkit.2.8.2-1-ubuntu64/bin:$PATH\"\nRUN pip3 install ipython\n#   Install R packages\nRUN echo \"r <- getOption('repos'); r['CRAN'] <- 'http://cran.us.r-project.org'; options(repos = r);\" > ~/.Rprofile\nRUN Rscript -e \"install.packages('reshape')\"\nRUN Rscript -e \"install.packages('gplots')\"\nRUN Rscript -e \"install.packages('ggplot2')\"\nRUN Rscript -e \"install.packages('googleCloudStorageR')\"\nRUN Rscript -e \"install.packages('gridExtra')\"\nRUN Rscript -e \"install.packages('ggpubr')\"\nRUN Rscript -e \"install.packages('ggpmisc')\"\nRUN Rscript -e \"install.packages('cowplot')\"\nRUN Rscript -e \"install.packages('corrplot')\"\nRUN Rscript -e \"install.packages('ggrepel')\"\nRUN Rscript -e \"install.packages('optparse')\"\nRUN Rscript -e 'source(\"http://bioconductor.org/biocLite.R\")' -e 'biocLite(\"rtracklayer\")'\nRUN Rscript -e 'source(\"http://bioconductor.org/biocLite.R\")' -e 'biocLite(\"scran\")'\nRUN Rscript -e \"install.packages('igraph')\"\nRUN Rscript -e \"install.packages('rsvd')\"\nRUN Rscript -e \"install.packages('factoextra')\"\nRUN Rscript -e \"install.packages('fpc')\"\nRUN Rscript -e \"install.packages('NbClust')\"\n","originalDockerfileUglifiedHash":"0d049537bfe038b5e90dfcc646f0daaf","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/b491aec5051acd567bebcd384151bb76deea6067.dockerfile"}