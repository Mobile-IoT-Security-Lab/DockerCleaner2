{"seed":529367346,"processedDockerfileHash":"7fdd3801284351d86f0b6ba11801afc6","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","have-a-healthcheck","have-a-user"],"processedDockerfile":"ARG PHP_VERSION=5.6.40\nFROM --platform=$TARGETPLATFORM php:${PHP_VERSION}-fpm-alpine AS php\nLABEL maintainer=\"khs1994-docker/lnmp <khs1994@khs1994.com>\"\nARG PHP_EXTENSION_EXTRA\nARG PECL_EXTENSION_EXTRA\nARG APK_EXTRA\nARG APK_DEV_EXTRA\nENV TZ=\"Asia/Shanghai\" \\\n    APP_ENV=\"development\"\nENV PHP_EXTENSION=\"bcmath  bz2  calendar  enchant  exif  gd  gettext  gmp  imap  intl  mysqli  pcntl  pdo_pgsql  pdo_mysql  pgsql  sockets  sysvmsg  sysvsem  sysvshm  xmlrpc  xsl  zip  ${PHP_EXTENSION_EXTRA:-}\"\nENV PECL_EXTENSION=\"igbinary  redis  xdebug-2.5.5  yaml-1.3.1  ${PECL_EXTENSION_EXTRA:-}\"\nARG ALPINE_URL=dl-cdn.alpinelinux.org\nRUN sed -i \"s/dl-cdn.alpinelinux.org/${ALPINE_URL}/g\" /etc/apk/repositories \\\n && set -xe \\\n && PHP_FPM_RUN_DEPS=\" bash tzdata libmemcached-libs libpq zlib libpng freetype libjpeg-turbo libxpm yaml libbz2 libexif libxslt gmp xmlrpc-c enchant c-client icu-libs ${APK_EXTRA:-} \" \\\n && PHP_FPM_BUILD_DEPS=\" libressl-dev libmemcached-dev cyrus-sasl-dev postgresql-dev zlib-dev libpng-dev freetype-dev libjpeg-turbo-dev libxpm-dev yaml-dev libexif-dev libxslt-dev gmp-dev xmlrpc-c-dev bzip2-dev enchant-dev imap-dev gettext-dev libwebp-dev icu-dev ${APK_DEV_EXTRA:-} \" \\\n && apk add $PHP_FPM_RUN_DEPS --no-cache --virtual .php-fpm-run-deps \\\n && apk add $PHP_FPM_BUILD_DEPS --no-cache --virtual .php-fpm-build-deps \\\n && docker-php-ext-configure gd --with-freetype-dir=/usr --with-jpeg-dir=/usr --with-png-dir=/usr --with-xpm-dir=/usr \\\n && docker-php-ext-install $PHP_EXTENSION \\\n && apk add $PHPIZE_DEPS --no-cache --virtual .build-deps \\\n && for extension in ${PHP_EXTENSION}; do strip --strip-all $( php-config --extension-dir ;)/$( echo ${extension} | cut -d '-' -f 1 ;).so ; done \\\n && for extension in ${PECL_EXTENSION}; do pecl install $extension \\\n && docker-php-ext-enable $( echo ${extension} | cut -d '-' -f 1 ;) || echo \"pecl ${extension} install error\" \\\n && rm -rf /usr/local/lib/php/doc/$( echo ${extension} | cut -d '-' -f 1 ;) \\\n && rm -rf /usr/local/lib/php/test/$( echo ${extension} | cut -d '-' -f 1 ;) \\\n && rm -rf /usr/local/include/php/ext/$( echo ${extension} | cut -d '-' -f 1 ;) \\\n && strip --strip-all $( php-config --extension-dir ;)/$( echo ${extension} | cut -d '-' -f 1 ;).so ; done \\\n && docker-php-ext-enable opcache \\\n && apk del --no-network --no-cache .build-deps .php-fpm-build-deps \\\n && mv /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini.default \\\n && rm -rf /tmp/* \\\n && rm -rf /usr/local/lib/php/.registry/.channel.pecl.php.net/* \\\n && mkdir -p /var/log/php-fpm \\\n && ln -sf /dev/stdout /var/log/php-fpm/access.log \\\n && ln -sf /dev/stderr /var/log/php-fpm/error.log \\\n && ln -sf /dev/stderr /var/log/php-fpm/xdebug-remote.log \\\n && chmod -R 777 /var/log/php-fpm\nSTOPSIGNAL SIGQUIT\nWORKDIR /app\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\n","originalDockerfile":"ARG PHP_VERSION=5.6.40\nFROM --platform=$TARGETPLATFORM php:${PHP_VERSION}-fpm-alpine AS php\nLABEL maintainer=\"khs1994-docker/lnmp <khs1994@khs1994.com>\"\nARG PHP_EXTENSION_EXTRA\nARG PECL_EXTENSION_EXTRA\nARG APK_EXTRA\nARG APK_DEV_EXTRA\nENV TZ=\"Asia/Shanghai\" \\\n    APP_ENV=\"development\"\nENV PHP_EXTENSION=\"bcmath  bz2  calendar  enchant  exif  gd  gettext  gmp  imap  intl  mysqli  pcntl  pdo_pgsql  pdo_mysql  pgsql  sockets  sysvmsg  sysvsem  sysvshm  xmlrpc  xsl  zip  ${PHP_EXTENSION_EXTRA:-}\"\nENV PECL_EXTENSION=\"igbinary  redis  xdebug-2.5.5  yaml-1.3.1  ${PECL_EXTENSION_EXTRA:-}\"\nARG ALPINE_URL=dl-cdn.alpinelinux.org\nRUN sed -i \"s/dl-cdn.alpinelinux.org/${ALPINE_URL}/g\" /etc/apk/repositories \\\n && set -xe \\\n && PHP_FPM_RUN_DEPS=\" bash tzdata libmemcached-libs libpq zlib libpng freetype libjpeg-turbo libxpm yaml libbz2 libexif libxslt gmp xmlrpc-c enchant c-client icu-libs ${APK_EXTRA:-} \" \\\n && PHP_FPM_BUILD_DEPS=\" libressl-dev libmemcached-dev cyrus-sasl-dev postgresql-dev zlib-dev libpng-dev freetype-dev libjpeg-turbo-dev libxpm-dev yaml-dev libexif-dev libxslt-dev gmp-dev xmlrpc-c-dev bzip2-dev enchant-dev imap-dev gettext-dev libwebp-dev icu-dev ${APK_DEV_EXTRA:-} \" \\\n && apk add --no-cache --virtual .php-fpm-run-deps $PHP_FPM_RUN_DEPS \\\n && apk add --no-cache --virtual .php-fpm-build-deps $PHP_FPM_BUILD_DEPS \\\n && docker-php-ext-configure gd --with-freetype-dir=/usr --with-jpeg-dir=/usr --with-png-dir=/usr --with-xpm-dir=/usr \\\n && docker-php-ext-install $PHP_EXTENSION \\\n && apk add --no-cache --virtual .build-deps $PHPIZE_DEPS \\\n && for extension in ${PHP_EXTENSION}; do strip --strip-all $( php-config --extension-dir ;)/$( echo ${extension} | cut -d '-' -f 1 ;).so ; done \\\n && for extension in ${PECL_EXTENSION}; do pecl install $extension \\\n && docker-php-ext-enable $( echo ${extension} | cut -d '-' -f 1 ;) || echo \"pecl ${extension} install error\" \\\n && rm -rf /usr/local/lib/php/doc/$( echo ${extension} | cut -d '-' -f 1 ;) \\\n && rm -rf /usr/local/lib/php/test/$( echo ${extension} | cut -d '-' -f 1 ;) \\\n && rm -rf /usr/local/include/php/ext/$( echo ${extension} | cut -d '-' -f 1 ;) \\\n && strip --strip-all $( php-config --extension-dir ;)/$( echo ${extension} | cut -d '-' -f 1 ;).so ; done \\\n && docker-php-ext-enable opcache \\\n && apk del --no-network --no-cache .build-deps .php-fpm-build-deps \\\n && mv /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini.default \\\n && rm -rf /tmp/* \\\n && rm -rf /usr/local/lib/php/.registry/.channel.pecl.php.net/* \\\n && mkdir -p /var/log/php-fpm \\\n && ln -sf /dev/stdout /var/log/php-fpm/access.log \\\n && ln -sf /dev/stderr /var/log/php-fpm/error.log \\\n && ln -sf /dev/stderr /var/log/php-fpm/xdebug-remote.log \\\n && chmod -R 777 /var/log/php-fpm\nSTOPSIGNAL SIGQUIT\nWORKDIR /app\n","injectedSmells":[],"originalDockerfileHash":"9f35188f7ac3dbde8cfaa7741f8d8132","successfullyInjectedSmells":[],"originalDockerfileUglified":"ARG PHP_VERSION=5.6.40\nFROM --platform=$TARGETPLATFORM php:${PHP_VERSION}-fpm-alpine AS php\nLABEL maintainer=\"khs1994-docker/lnmp <khs1994@khs1994.com>\"\nARG PHP_EXTENSION_EXTRA\nARG PECL_EXTENSION_EXTRA\nARG APK_EXTRA\nARG APK_DEV_EXTRA\nENV TZ=\"Asia/Shanghai\" \\\n    APP_ENV=\"development\"\nENV PHP_EXTENSION=\"bcmath  bz2  calendar  enchant  exif  gd  gettext  gmp  imap  intl  mysqli  pcntl  pdo_pgsql  pdo_mysql  pgsql  sockets  sysvmsg  sysvsem  sysvshm  xmlrpc  xsl  zip  ${PHP_EXTENSION_EXTRA:-}\"\nENV PECL_EXTENSION=\"igbinary  redis  xdebug-2.5.5  yaml-1.3.1  ${PECL_EXTENSION_EXTRA:-}\"\nARG ALPINE_URL=dl-cdn.alpinelinux.org\nRUN sed -i \"s/dl-cdn.alpinelinux.org/${ALPINE_URL}/g\" /etc/apk/repositories \\\n && set -xe \\\n && PHP_FPM_RUN_DEPS=\" bash tzdata libmemcached-libs libpq zlib libpng freetype libjpeg-turbo libxpm yaml libbz2 libexif libxslt gmp xmlrpc-c enchant c-client icu-libs ${APK_EXTRA:-} \" \\\n && PHP_FPM_BUILD_DEPS=\" libressl-dev libmemcached-dev cyrus-sasl-dev postgresql-dev zlib-dev libpng-dev freetype-dev libjpeg-turbo-dev libxpm-dev yaml-dev libexif-dev libxslt-dev gmp-dev xmlrpc-c-dev bzip2-dev enchant-dev imap-dev gettext-dev libwebp-dev icu-dev ${APK_DEV_EXTRA:-} \" \\\n && apk add --no-cache --virtual .php-fpm-run-deps $PHP_FPM_RUN_DEPS \\\n && apk add --no-cache --virtual .php-fpm-build-deps $PHP_FPM_BUILD_DEPS \\\n && docker-php-ext-configure gd --with-freetype-dir=/usr --with-jpeg-dir=/usr --with-png-dir=/usr --with-xpm-dir=/usr \\\n && docker-php-ext-install $PHP_EXTENSION \\\n && apk add --no-cache --virtual .build-deps $PHPIZE_DEPS \\\n && for extension in ${PHP_EXTENSION}; do strip --strip-all $( php-config --extension-dir ;)/$( echo ${extension} | cut -d '-' -f 1 ;).so ; done \\\n && for extension in ${PECL_EXTENSION}; do pecl install $extension \\\n && docker-php-ext-enable $( echo ${extension} | cut -d '-' -f 1 ;) || echo \"pecl ${extension} install error\" \\\n && rm -rf /usr/local/lib/php/doc/$( echo ${extension} | cut -d '-' -f 1 ;) \\\n && rm -rf /usr/local/lib/php/test/$( echo ${extension} | cut -d '-' -f 1 ;) \\\n && rm -rf /usr/local/include/php/ext/$( echo ${extension} | cut -d '-' -f 1 ;) \\\n && strip --strip-all $( php-config --extension-dir ;)/$( echo ${extension} | cut -d '-' -f 1 ;).so ; done \\\n && docker-php-ext-enable opcache \\\n && apk del --no-network --no-cache .build-deps .php-fpm-build-deps \\\n && mv /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini.default \\\n && rm -rf /tmp/* \\\n && rm -rf /usr/local/lib/php/.registry/.channel.pecl.php.net/* \\\n && mkdir -p /var/log/php-fpm \\\n && ln -sf /dev/stdout /var/log/php-fpm/access.log \\\n && ln -sf /dev/stderr /var/log/php-fpm/error.log \\\n && ln -sf /dev/stderr /var/log/php-fpm/xdebug-remote.log \\\n && chmod -R 777 /var/log/php-fpm\nSTOPSIGNAL SIGQUIT\nWORKDIR /app\n","originalDockerfileUglifiedHash":"9f35188f7ac3dbde8cfaa7741f8d8132","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/0c3a5963b84c95a548509e985d7d38415ebc1c99.dockerfile"}