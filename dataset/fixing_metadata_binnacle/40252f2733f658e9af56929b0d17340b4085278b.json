{"seed":612612960,"processedDockerfileHash":"d23dbed825001efcead6a780e48f402e","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["do-not-use-apt-get-update-alone","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"#   http://phusion.github.io/baseimage-docker/\n#   https://github.com/phusion/baseimage-docker/blob/master/Changelog.md\nFROM phusion/baseimage:0.9.19\nMAINTAINER Brian Fisher <tbfisher@gmail.com>\nRUN locale-gen en_US.UTF-8\nENV LANG=\"en_US.UTF-8\"\nENV LC_ALL=\"en_US.UTF-8\"\n#   Use baseimage-docker's init system.\nCMD [\"/sbin/my_init\"]\n#   Upgrade OS\nRUN : \\\n && apt-get upgrade -y -o Dpkg::Options::=\"--force-confold\"\n#   PHP\nRUN add-apt-repository ppa:ondrej/php \\\n && : \\\n && DEBIAN_FRONTEND=\"noninteractive\" apt-get install --yes php-pear php7.1-cli php7.1-common php7.1-curl php7.1-dev php7.1-fpm php7.1-gd php7.1-imagick php7.1-imap php7.1-intl php7.1-json php7.1-ldap php7.1-mbstring php7.1-mcrypt php7.1-memcache php7.1-mysql php7.1-opcache php7.1-readline php7.1-sqlite php7.1-tidy php7.1-xdebug php7.1-xml php7.1-zip\n#   php7.1-xhprof\n#   phpredis\nENV PHPREDIS_VERSION=\"3.0.0\"\nRUN : \\\n && DEBIAN_FRONTEND=\"noninteractive\" apt-get install --yes git\nRUN git clone -b $PHPREDIS_VERSION --depth 1 https://github.com/phpredis/phpredis.git /usr/local/src/phpredis\nRUN cd /usr/local/src/phpredis \\\n && phpize \\\n && ./configure \\\n && make clean \\\n && make \\\n && make install\nCOPY ./conf/php/mods-available/redis.ini /etc/php/7.1/mods-available/redis.ini\n#   NGNIX\nRUN : \\\n && DEBIAN_FRONTEND=\"noninteractive\" apt-get install --yes nginx\n#   SSH (for remote drush)\nRUN : \\\n && DEBIAN_FRONTEND=\"noninteractive\" apt-get install --yes openssh-server\nRUN dpkg-reconfigure openssh-server\n#   sSMTP\n#   note php is configured to use ssmtp, which is configured to send to mail:1025,\n#   which is standard configuration for a mailhog/mailhog image with hostname mail.\nRUN : \\\n && DEBIAN_FRONTEND=\"noninteractive\" apt-get install --yes ssmtp\n#   Drush, console\nRUN cd /usr/local/bin/ \\\n && curl http://files.drush.org/drush.phar -L -o drush \\\n && chmod +x drush\nCOPY ./conf/drush/drush-remote.sh /usr/local/bin/drush-remote\nRUN chmod +x /usr/local/bin/drush-remote\nRUN cd /usr/local/bin/ \\\n && curl https://drupalconsole.com/installer -L -o drupal \\\n && chmod +x drupal\n#   Required for drush, convenience utilities, etc.\nRUN : \\\n && DEBIAN_FRONTEND=\"noninteractive\" apt-get install --yes git mysql-client screen\n#   Configure PHP\nRUN mkdir /run/php\nRUN cp /etc/php/7.1/fpm/php.ini /etc/php/7.1/fpm/php.ini.bak\nCOPY ./conf/php/fpm/php.ini-development /etc/php/7.1/fpm/php.ini\n#   COPY /conf/php/fpm/php.ini-production /etc/php/7.1/fpm/php.ini\nRUN cp /etc/php/7.1/fpm/pool.d/www.conf /etc/php/7.1/fpm/pool.d/www.conf.bak\nCOPY /conf/php/fpm/pool.d/www.conf /etc/php/7.1/fpm/pool.d/www.conf\nRUN cp /etc/php/7.1/cli/php.ini /etc/php/7.1/cli/php.ini.bak\nCOPY /conf/php/cli/php.ini-development /etc/php/7.1/cli/php.ini\n#   COPY /conf/php/cli/php.ini-production /etc/php/7.1/cli/php.ini\n#   Prevent php warnings\nRUN sed -ir 's@^#@//@' /etc/php/7.1/mods-available/*\nRUN phpenmod mcrypt redis xdebug\n#   xhprof\n#   Configure NGINX\nRUN cp -r /etc/nginx/sites-available/default /etc/nginx/sites-available/default.bak\nCOPY ./conf/nginx/default-development /etc/nginx/sites-available/default\n#   COPY ./conf/nginx/default-production /etc/nginx/sites-available/default\nRUN cp /etc/nginx/nginx.conf /etc/nginx/nginx.conf.bak\nCOPY ./conf/nginx/nginx.conf /etc/nginx/nginx.conf\n#   Configure sshd\nRUN cp /etc/ssh/sshd_config /etc/ssh/sshd_config.bak\nCOPY ./conf/ssh/sshd_config /etc/ssh/sshd_config\nRUN cp /etc/ssmtp/ssmtp.conf /etc/ssmtp/ssmtp.conf.bak\nCOPY ./conf/ssmtp/ssmtp.conf /etc/ssmtp/ssmtp.conf\n#   Configure directories for drupal.\nRUN mkdir /var/www_files \\\n && mkdir -p /var/www_files/public \\\n && mkdir -p /var/www_files/private \\\n && chown -R www-data:www-data /var/www_files\nVOLUME /var/www_files\n#   Virtualhost is configured to serve from /var/www/web.\nRUN mkdir -p /var/www/web \\\n && echo '<?php phpinfo();' > /var/www/web/index.php \\\n && chgrp www-data /var/www_files \\\n && chmod 775 /var/www_files\n#   https://github.com/phusion/baseimage-docker/pull/339\n#   https://github.com/phusion/baseimage-docker/pull/341\nRUN sed -i 's/syslog/adm/g' /etc/logrotate.conf\n#   Use baseimage-docker's init system.\nCOPY init/ /etc/my_init.d/\nRUN chmod -v +x /etc/my_init.d/*.sh\nCOPY services/ /etc/service/\nRUN chmod -v +x /etc/service/*/run\nEXPOSE 80/tcp 22/tcp\n#   Clean up\nRUN apt-get clean \\\n && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  http://phusion.github.io/baseimage-docker/\n#  https://github.com/phusion/baseimage-docker/blob/master/Changelog.md\nFROM phusion/baseimage:0.9.19\nMAINTAINER Brian Fisher <tbfisher@gmail.com>\nRUN locale-gen en_US.UTF-8\nENV LANG=\"en_US.UTF-8\"\nENV LC_ALL=\"en_US.UTF-8\"\n#  Use baseimage-docker's init system.\nCMD [\"/sbin/my_init\"]\n#  Upgrade OS\nRUN apt-get update \\\n && apt-get upgrade -y -o Dpkg::Options::=\"--force-confold\"\n#  PHP\nRUN add-apt-repository ppa:ondrej/php \\\n && apt-get update \\\n && DEBIAN_FRONTEND=\"noninteractive\" apt-get install --yes php-pear php7.1-cli php7.1-common php7.1-curl php7.1-dev php7.1-fpm php7.1-gd php7.1-imagick php7.1-imap php7.1-intl php7.1-json php7.1-ldap php7.1-mbstring php7.1-mcrypt php7.1-memcache php7.1-mysql php7.1-opcache php7.1-readline php7.1-sqlite php7.1-tidy php7.1-xdebug php7.1-xml php7.1-zip\n#  php7.1-xhprof\n#  phpredis\nENV PHPREDIS_VERSION=\"3.0.0\"\nRUN apt-get update \\\n && DEBIAN_FRONTEND=\"noninteractive\" apt-get install --yes git\nRUN git clone -b $PHPREDIS_VERSION --depth 1 https://github.com/phpredis/phpredis.git /usr/local/src/phpredis\nRUN cd /usr/local/src/phpredis \\\n && phpize \\\n && ./configure \\\n && make clean \\\n && make \\\n && make install\nCOPY ./conf/php/mods-available/redis.ini /etc/php/7.1/mods-available/redis.ini\n#  NGNIX\nRUN apt-get update \\\n && DEBIAN_FRONTEND=\"noninteractive\" apt-get install --yes nginx\n#  SSH (for remote drush)\nRUN apt-get update \\\n && DEBIAN_FRONTEND=\"noninteractive\" apt-get install --yes openssh-server\nRUN dpkg-reconfigure openssh-server\n#  sSMTP\n#  note php is configured to use ssmtp, which is configured to send to mail:1025,\n#  which is standard configuration for a mailhog/mailhog image with hostname mail.\nRUN apt-get update \\\n && DEBIAN_FRONTEND=\"noninteractive\" apt-get install --yes ssmtp\n#  Drush, console\nRUN cd /usr/local/bin/ \\\n && curl http://files.drush.org/drush.phar -L -o drush \\\n && chmod +x drush\nCOPY ./conf/drush/drush-remote.sh /usr/local/bin/drush-remote\nRUN chmod +x /usr/local/bin/drush-remote\nRUN cd /usr/local/bin/ \\\n && curl https://drupalconsole.com/installer -L -o drupal \\\n && chmod +x drupal\n#  Required for drush, convenience utilities, etc.\nRUN apt-get update \\\n && DEBIAN_FRONTEND=\"noninteractive\" apt-get install --yes git mysql-client screen\n#  Configure PHP\nRUN mkdir /run/php\nRUN cp /etc/php/7.1/fpm/php.ini /etc/php/7.1/fpm/php.ini.bak\nCOPY ./conf/php/fpm/php.ini-development /etc/php/7.1/fpm/php.ini\n#  COPY /conf/php/fpm/php.ini-production /etc/php/7.1/fpm/php.ini\nRUN cp /etc/php/7.1/fpm/pool.d/www.conf /etc/php/7.1/fpm/pool.d/www.conf.bak\nCOPY /conf/php/fpm/pool.d/www.conf /etc/php/7.1/fpm/pool.d/www.conf\nRUN cp /etc/php/7.1/cli/php.ini /etc/php/7.1/cli/php.ini.bak\nCOPY /conf/php/cli/php.ini-development /etc/php/7.1/cli/php.ini\n#  COPY /conf/php/cli/php.ini-production /etc/php/7.1/cli/php.ini\n#  Prevent php warnings\nRUN sed -ir 's@^#@//@' /etc/php/7.1/mods-available/*\nRUN phpenmod mcrypt redis xdebug\n#  xhprof\n#  Configure NGINX\nRUN cp -r /etc/nginx/sites-available/default /etc/nginx/sites-available/default.bak\nCOPY ./conf/nginx/default-development /etc/nginx/sites-available/default\n#  COPY ./conf/nginx/default-production /etc/nginx/sites-available/default\nRUN cp /etc/nginx/nginx.conf /etc/nginx/nginx.conf.bak\nCOPY ./conf/nginx/nginx.conf /etc/nginx/nginx.conf\n#  Configure sshd\nRUN cp /etc/ssh/sshd_config /etc/ssh/sshd_config.bak\nCOPY ./conf/ssh/sshd_config /etc/ssh/sshd_config\nRUN cp /etc/ssmtp/ssmtp.conf /etc/ssmtp/ssmtp.conf.bak\nCOPY ./conf/ssmtp/ssmtp.conf /etc/ssmtp/ssmtp.conf\n#  Configure directories for drupal.\nRUN mkdir /var/www_files \\\n && mkdir -p /var/www_files/public \\\n && mkdir -p /var/www_files/private \\\n && chown -R www-data:www-data /var/www_files\nVOLUME /var/www_files\n#  Virtualhost is configured to serve from /var/www/web.\nRUN mkdir -p /var/www/web \\\n && echo '<?php phpinfo();' > /var/www/web/index.php \\\n && chgrp www-data /var/www_files \\\n && chmod 775 /var/www_files\n#  https://github.com/phusion/baseimage-docker/pull/339\n#  https://github.com/phusion/baseimage-docker/pull/341\nRUN sed -i 's/syslog/adm/g' /etc/logrotate.conf\n#  Use baseimage-docker's init system.\nADD init/ /etc/my_init.d/\nRUN chmod -v +x /etc/my_init.d/*.sh\nADD services/ /etc/service/\nRUN chmod -v +x /etc/service/*/run\nEXPOSE 80/tcp 22/tcp\n#  Clean up\nRUN apt-get clean \\\n && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*\n","injectedSmells":[],"originalDockerfileHash":"396f1500ed75b7b7277870b12483bb60","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   http://phusion.github.io/baseimage-docker/\n#   https://github.com/phusion/baseimage-docker/blob/master/Changelog.md\nFROM phusion/baseimage:0.9.19\nMAINTAINER Brian Fisher <tbfisher@gmail.com>\nRUN locale-gen en_US.UTF-8\nENV LANG=\"en_US.UTF-8\"\nENV LC_ALL=\"en_US.UTF-8\"\n#   Use baseimage-docker's init system.\nCMD [\"/sbin/my_init\"]\n#   Upgrade OS\nRUN apt-get update \\\n && apt-get upgrade -y -o Dpkg::Options::=\"--force-confold\"\n#   PHP\nRUN add-apt-repository ppa:ondrej/php \\\n && apt-get update \\\n && DEBIAN_FRONTEND=\"noninteractive\" apt-get install --yes php-pear php7.1-cli php7.1-common php7.1-curl php7.1-dev php7.1-fpm php7.1-gd php7.1-imagick php7.1-imap php7.1-intl php7.1-json php7.1-ldap php7.1-mbstring php7.1-mcrypt php7.1-memcache php7.1-mysql php7.1-opcache php7.1-readline php7.1-sqlite php7.1-tidy php7.1-xdebug php7.1-xml php7.1-zip\n#   php7.1-xhprof\n#   phpredis\nENV PHPREDIS_VERSION=\"3.0.0\"\nRUN apt-get update \\\n && DEBIAN_FRONTEND=\"noninteractive\" apt-get install --yes git\nRUN git clone -b $PHPREDIS_VERSION --depth 1 https://github.com/phpredis/phpredis.git /usr/local/src/phpredis\nRUN cd /usr/local/src/phpredis \\\n && phpize \\\n && ./configure \\\n && make clean \\\n && make \\\n && make install\nCOPY ./conf/php/mods-available/redis.ini /etc/php/7.1/mods-available/redis.ini\n#   NGNIX\nRUN apt-get update \\\n && DEBIAN_FRONTEND=\"noninteractive\" apt-get install --yes nginx\n#   SSH (for remote drush)\nRUN apt-get update \\\n && DEBIAN_FRONTEND=\"noninteractive\" apt-get install --yes openssh-server\nRUN dpkg-reconfigure openssh-server\n#   sSMTP\n#   note php is configured to use ssmtp, which is configured to send to mail:1025,\n#   which is standard configuration for a mailhog/mailhog image with hostname mail.\nRUN apt-get update \\\n && DEBIAN_FRONTEND=\"noninteractive\" apt-get install --yes ssmtp\n#   Drush, console\nRUN cd /usr/local/bin/ \\\n && curl http://files.drush.org/drush.phar -L -o drush \\\n && chmod +x drush\nCOPY ./conf/drush/drush-remote.sh /usr/local/bin/drush-remote\nRUN chmod +x /usr/local/bin/drush-remote\nRUN cd /usr/local/bin/ \\\n && curl https://drupalconsole.com/installer -L -o drupal \\\n && chmod +x drupal\n#   Required for drush, convenience utilities, etc.\nRUN apt-get update \\\n && DEBIAN_FRONTEND=\"noninteractive\" apt-get install --yes git mysql-client screen\n#   Configure PHP\nRUN mkdir /run/php\nRUN cp /etc/php/7.1/fpm/php.ini /etc/php/7.1/fpm/php.ini.bak\nCOPY ./conf/php/fpm/php.ini-development /etc/php/7.1/fpm/php.ini\n#   COPY /conf/php/fpm/php.ini-production /etc/php/7.1/fpm/php.ini\nRUN cp /etc/php/7.1/fpm/pool.d/www.conf /etc/php/7.1/fpm/pool.d/www.conf.bak\nCOPY /conf/php/fpm/pool.d/www.conf /etc/php/7.1/fpm/pool.d/www.conf\nRUN cp /etc/php/7.1/cli/php.ini /etc/php/7.1/cli/php.ini.bak\nCOPY /conf/php/cli/php.ini-development /etc/php/7.1/cli/php.ini\n#   COPY /conf/php/cli/php.ini-production /etc/php/7.1/cli/php.ini\n#   Prevent php warnings\nRUN sed -ir 's@^#@//@' /etc/php/7.1/mods-available/*\nRUN phpenmod mcrypt redis xdebug\n#   xhprof\n#   Configure NGINX\nRUN cp -r /etc/nginx/sites-available/default /etc/nginx/sites-available/default.bak\nCOPY ./conf/nginx/default-development /etc/nginx/sites-available/default\n#   COPY ./conf/nginx/default-production /etc/nginx/sites-available/default\nRUN cp /etc/nginx/nginx.conf /etc/nginx/nginx.conf.bak\nCOPY ./conf/nginx/nginx.conf /etc/nginx/nginx.conf\n#   Configure sshd\nRUN cp /etc/ssh/sshd_config /etc/ssh/sshd_config.bak\nCOPY ./conf/ssh/sshd_config /etc/ssh/sshd_config\nRUN cp /etc/ssmtp/ssmtp.conf /etc/ssmtp/ssmtp.conf.bak\nCOPY ./conf/ssmtp/ssmtp.conf /etc/ssmtp/ssmtp.conf\n#   Configure directories for drupal.\nRUN mkdir /var/www_files \\\n && mkdir -p /var/www_files/public \\\n && mkdir -p /var/www_files/private \\\n && chown -R www-data:www-data /var/www_files\nVOLUME /var/www_files\n#   Virtualhost is configured to serve from /var/www/web.\nRUN mkdir -p /var/www/web \\\n && echo '<?php phpinfo();' > /var/www/web/index.php \\\n && chgrp www-data /var/www_files \\\n && chmod 775 /var/www_files\n#   https://github.com/phusion/baseimage-docker/pull/339\n#   https://github.com/phusion/baseimage-docker/pull/341\nRUN sed -i 's/syslog/adm/g' /etc/logrotate.conf\n#   Use baseimage-docker's init system.\nADD init/ /etc/my_init.d/\nRUN chmod -v +x /etc/my_init.d/*.sh\nADD services/ /etc/service/\nRUN chmod -v +x /etc/service/*/run\nEXPOSE 80/tcp 22/tcp\n#   Clean up\nRUN apt-get clean \\\n && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*\n","originalDockerfileUglifiedHash":"e4fc6aaff4cfc5a2c79af77f7c8b547d","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/40252f2733f658e9af56929b0d17340b4085278b.dockerfile"}