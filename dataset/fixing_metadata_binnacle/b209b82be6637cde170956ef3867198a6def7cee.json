{"seed":2425982556,"processedDockerfileHash":"de38c113ce4656af39a0aaa3daac3de0","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM php:7.1-fpm-alpine\nLABEL maintainer=\"Monogramm Maintainers <opensource at monogramm dot io>\"\n#   Build time env var\nENV DOLI_VERSION=\"9.0.3\"\n#   Get Dolibarr\nRUN which wget &> /dev/null || apt-get install --no-install-recommends wget=1.20.3 ; wget --no-verbose --output-document /tmp/dolibarr.zip https://github.com/Dolibarr/dolibarr/archive/${DOLI_VERSION}.zip\n#   Install the packages we need\n#   Install the PHP extensions we need\n#   see https://wiki.dolibarr.org/index.php/Dependencies_and_external_libraries\n#   Prepare folders\n#   Install Dolibarr from tag archive\nRUN set -ex ; apk add imagemagick=7.0.8.68-r0 libldap=2.4.48-r2 libpq=11.12-r0 libpng=1.6.37-r1 mysql-client=10.3.29-r0 rsync=3.1.3-r1 ssmtp=2.64-r14 shadow=4.6-r2 --no-cache ; apk add autoconf=2.69-r2 curl-dev=7.66.0-r4 freetype-dev=2.10.0-r1 gcc=8.3.0-r0 g++=8.3.0-r0 icu-dev=64.2-r1 libjpeg-turbo-dev=2.0.4-r1 imagemagick-dev=7.0.8.68-r0 imagemagick-libs=7.0.8.68-r0 libmcrypt-dev=2.5.8-r7 libpng-dev=1.6.37-r1 libtool=2.4.6-r6 libxml2-dev=2.9.9-r5 make=4.2.1-r2 openldap-dev=2.4.48-r2 postgresql-dev=11.12-r0 postgresql-libs=11.12-r0 unzip=6.0-r6 $PHPIZE_DEPS --no-cache --virtual .build-deps ; docker-php-ext-configure ldap ; docker-php-ext-configure gd --with-freetype-dir=/usr --with-png-dir=/usr --with-jpeg-dir=/usr ; docker-php-ext-install calendar gd ldap mbstring mysqli pdo pdo_mysql pdo_pgsql pgsql soap zip ; pecl install imagick ; docker-php-ext-enable imagick ; apk --purge del .build-deps ; mkdir -p /var/www/documents ; chown -R www-data:root /var/www ; chmod -R g=u /var/www ; mkdir -p /tmp/dolibarr ; unzip -q /tmp/dolibarr.zip -d /tmp/dolibarr ; rm /tmp/dolibarr.zip ; mkdir -p /usr/src/dolibarr ; cp -r /tmp/dolibarr/dolibarr-${DOLI_VERSION}/* /usr/src/dolibarr ; rm -rf /tmp/dolibarr ; chmod +x /usr/src/dolibarr/scripts/*\n#   Runtime env var\nENV DOLI_AUTO_CONFIGURE=\"1\" \\\n    DOLI_DB_TYPE=\"mysqli\" \\\n    DOLI_DB_HOST=\"\" \\\n    DOLI_DB_PORT=\"3306\" \\\n    DOLI_DB_USER=\"dolibarr\" \\\n    DOLI_DB_PASSWORD=\"\" \\\n    DOLI_DB_NAME=\"dolibarr\" \\\n    DOLI_DB_PREFIX=\"llx_\" \\\n    DOLI_DB_CHARACTER_SET=\"utf8\" \\\n    DOLI_DB_COLLATION=\"utf8_unicode_ci\" \\\n    DOLI_DB_ROOT_LOGIN=\"\" \\\n    DOLI_DB_ROOT_PASSWORD=\"\" \\\n    DOLI_ADMIN_LOGIN=\"admin\" \\\n    DOLI_MODULES=\"\" \\\n    DOLI_URL_ROOT=\"http://localhost\" \\\n    DOLI_AUTH=\"dolibarr\" \\\n    DOLI_LDAP_HOST=\"\" \\\n    DOLI_LDAP_PORT=\"389\" \\\n    DOLI_LDAP_VERSION=\"3\" \\\n    DOLI_LDAP_SERVERTYPE=\"openldap\" \\\n    DOLI_LDAP_LOGIN_ATTRIBUTE=\"uid\" \\\n    DOLI_LDAP_DN=\"\" \\\n    DOLI_LDAP_FILTER=\"\" \\\n    DOLI_LDAP_ADMIN_LOGIN=\"\" \\\n    DOLI_LDAP_ADMIN_PASS=\"\" \\\n    DOLI_LDAP_DEBUG=\"false\" \\\n    DOLI_HTTPS=\"0\" \\\n    DOLI_PROD=\"0\" \\\n    DOLI_NO_CSRF_CHECK=\"0\" \\\n    WWW_USER_ID=\"82\" \\\n    WWW_GROUP_ID=\"82\" \\\n    PHP_INI_DATE_TIMEZONE=\"UTC\" \\\n    PHP_MEMORY_LIMIT=\"256M\" \\\n    PHP_MAX_UPLOAD=\"20M\" \\\n    PHP_MAX_EXECUTION_TIME=\"300\"\nVOLUME /var/www/html /var/www/documents /var/www/scripts\nCOPY entrypoint.sh /\nRUN set -ex ; chmod 755 /entrypoint.sh\nENTRYPOINT [\"/entrypoint.sh\"]\nCMD [\"php-fpm\"]\nRUN addgroup -S docker-user ; adduser -S -G docker-user docker-user\nUSER docker-user\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\n","originalDockerfile":"FROM php:7.1-fpm-alpine\nLABEL maintainer=\"Monogramm Maintainers <opensource at monogramm dot io>\"\n#  Build time env var\nENV DOLI_VERSION=\"9.0.3\"\n#  Get Dolibarr\nADD https://github.com/Dolibarr/dolibarr/archive/${DOLI_VERSION}.zip /tmp/dolibarr.zip\n#  Install the packages we need\n#  Install the PHP extensions we need\n#  see https://wiki.dolibarr.org/index.php/Dependencies_and_external_libraries\n#  Prepare folders\n#  Install Dolibarr from tag archive\nRUN set -ex ; apk add --no-cache imagemagick libldap libpq libpng mysql-client rsync ssmtp shadow ; apk add --no-cache --virtual .build-deps $PHPIZE_DEPS autoconf curl-dev freetype-dev gcc g++ icu-dev libjpeg-turbo-dev imagemagick-dev imagemagick-libs libmcrypt-dev libpng-dev libtool libxml2-dev make openldap-dev postgresql-dev postgresql-libs unzip ; docker-php-ext-configure ldap ; docker-php-ext-configure gd --with-freetype-dir=/usr --with-png-dir=/usr --with-jpeg-dir=/usr ; docker-php-ext-install calendar gd ldap mbstring mysqli pdo pdo_mysql pdo_pgsql pgsql soap zip ; pecl install imagick ; docker-php-ext-enable imagick ; apk --purge del .build-deps ; mkdir -p /var/www/documents ; chown -R www-data:root /var/www ; chmod -R g=u /var/www ; mkdir -p /tmp/dolibarr ; unzip -q /tmp/dolibarr.zip -d /tmp/dolibarr ; rm /tmp/dolibarr.zip ; mkdir -p /usr/src/dolibarr ; cp -r /tmp/dolibarr/dolibarr-${DOLI_VERSION}/* /usr/src/dolibarr ; rm -rf /tmp/dolibarr ; chmod +x /usr/src/dolibarr/scripts/*\n#  Runtime env var\nENV DOLI_AUTO_CONFIGURE=\"1\" \\\n    DOLI_DB_TYPE=\"mysqli\" \\\n    DOLI_DB_HOST=\"\" \\\n    DOLI_DB_PORT=\"3306\" \\\n    DOLI_DB_USER=\"dolibarr\" \\\n    DOLI_DB_PASSWORD=\"\" \\\n    DOLI_DB_NAME=\"dolibarr\" \\\n    DOLI_DB_PREFIX=\"llx_\" \\\n    DOLI_DB_CHARACTER_SET=\"utf8\" \\\n    DOLI_DB_COLLATION=\"utf8_unicode_ci\" \\\n    DOLI_DB_ROOT_LOGIN=\"\" \\\n    DOLI_DB_ROOT_PASSWORD=\"\" \\\n    DOLI_ADMIN_LOGIN=\"admin\" \\\n    DOLI_MODULES=\"\" \\\n    DOLI_URL_ROOT=\"http://localhost\" \\\n    DOLI_AUTH=\"dolibarr\" \\\n    DOLI_LDAP_HOST=\"\" \\\n    DOLI_LDAP_PORT=\"389\" \\\n    DOLI_LDAP_VERSION=\"3\" \\\n    DOLI_LDAP_SERVERTYPE=\"openldap\" \\\n    DOLI_LDAP_LOGIN_ATTRIBUTE=\"uid\" \\\n    DOLI_LDAP_DN=\"\" \\\n    DOLI_LDAP_FILTER=\"\" \\\n    DOLI_LDAP_ADMIN_LOGIN=\"\" \\\n    DOLI_LDAP_ADMIN_PASS=\"\" \\\n    DOLI_LDAP_DEBUG=\"false\" \\\n    DOLI_HTTPS=\"0\" \\\n    DOLI_PROD=\"0\" \\\n    DOLI_NO_CSRF_CHECK=\"0\" \\\n    WWW_USER_ID=\"82\" \\\n    WWW_GROUP_ID=\"82\" \\\n    PHP_INI_DATE_TIMEZONE=\"UTC\" \\\n    PHP_MEMORY_LIMIT=\"256M\" \\\n    PHP_MAX_UPLOAD=\"20M\" \\\n    PHP_MAX_EXECUTION_TIME=\"300\"\nVOLUME /var/www/html /var/www/documents /var/www/scripts\nCOPY entrypoint.sh /\nRUN set -ex ; chmod 755 /entrypoint.sh\nENTRYPOINT [\"/entrypoint.sh\"]\nCMD [\"php-fpm\"]\n","injectedSmells":[],"originalDockerfileHash":"4a71a109d8fad444403e37b590998e5c","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM php:7.1-fpm-alpine\nLABEL maintainer=\"Monogramm Maintainers <opensource at monogramm dot io>\"\n#   Build time env var\nENV DOLI_VERSION=\"9.0.3\"\n#   Get Dolibarr\nADD https://github.com/Dolibarr/dolibarr/archive/${DOLI_VERSION}.zip /tmp/dolibarr.zip\n#   Install the packages we need\n#   Install the PHP extensions we need\n#   see https://wiki.dolibarr.org/index.php/Dependencies_and_external_libraries\n#   Prepare folders\n#   Install Dolibarr from tag archive\nRUN set -ex ; apk add --no-cache imagemagick libldap libpq libpng mysql-client rsync ssmtp shadow ; apk add --no-cache --virtual .build-deps $PHPIZE_DEPS autoconf curl-dev freetype-dev gcc g++ icu-dev libjpeg-turbo-dev imagemagick-dev imagemagick-libs libmcrypt-dev libpng-dev libtool libxml2-dev make openldap-dev postgresql-dev postgresql-libs unzip ; docker-php-ext-configure ldap ; docker-php-ext-configure gd --with-freetype-dir=/usr --with-png-dir=/usr --with-jpeg-dir=/usr ; docker-php-ext-install calendar gd ldap mbstring mysqli pdo pdo_mysql pdo_pgsql pgsql soap zip ; pecl install imagick ; docker-php-ext-enable imagick ; apk --purge del .build-deps ; mkdir -p /var/www/documents ; chown -R www-data:root /var/www ; chmod -R g=u /var/www ; mkdir -p /tmp/dolibarr ; unzip -q /tmp/dolibarr.zip -d /tmp/dolibarr ; rm /tmp/dolibarr.zip ; mkdir -p /usr/src/dolibarr ; cp -r /tmp/dolibarr/dolibarr-${DOLI_VERSION}/* /usr/src/dolibarr ; rm -rf /tmp/dolibarr ; chmod +x /usr/src/dolibarr/scripts/*\n#   Runtime env var\nENV DOLI_AUTO_CONFIGURE=\"1\" \\\n    DOLI_DB_TYPE=\"mysqli\" \\\n    DOLI_DB_HOST=\"\" \\\n    DOLI_DB_PORT=\"3306\" \\\n    DOLI_DB_USER=\"dolibarr\" \\\n    DOLI_DB_PASSWORD=\"\" \\\n    DOLI_DB_NAME=\"dolibarr\" \\\n    DOLI_DB_PREFIX=\"llx_\" \\\n    DOLI_DB_CHARACTER_SET=\"utf8\" \\\n    DOLI_DB_COLLATION=\"utf8_unicode_ci\" \\\n    DOLI_DB_ROOT_LOGIN=\"\" \\\n    DOLI_DB_ROOT_PASSWORD=\"\" \\\n    DOLI_ADMIN_LOGIN=\"admin\" \\\n    DOLI_MODULES=\"\" \\\n    DOLI_URL_ROOT=\"http://localhost\" \\\n    DOLI_AUTH=\"dolibarr\" \\\n    DOLI_LDAP_HOST=\"\" \\\n    DOLI_LDAP_PORT=\"389\" \\\n    DOLI_LDAP_VERSION=\"3\" \\\n    DOLI_LDAP_SERVERTYPE=\"openldap\" \\\n    DOLI_LDAP_LOGIN_ATTRIBUTE=\"uid\" \\\n    DOLI_LDAP_DN=\"\" \\\n    DOLI_LDAP_FILTER=\"\" \\\n    DOLI_LDAP_ADMIN_LOGIN=\"\" \\\n    DOLI_LDAP_ADMIN_PASS=\"\" \\\n    DOLI_LDAP_DEBUG=\"false\" \\\n    DOLI_HTTPS=\"0\" \\\n    DOLI_PROD=\"0\" \\\n    DOLI_NO_CSRF_CHECK=\"0\" \\\n    WWW_USER_ID=\"82\" \\\n    WWW_GROUP_ID=\"82\" \\\n    PHP_INI_DATE_TIMEZONE=\"UTC\" \\\n    PHP_MEMORY_LIMIT=\"256M\" \\\n    PHP_MAX_UPLOAD=\"20M\" \\\n    PHP_MAX_EXECUTION_TIME=\"300\"\nVOLUME /var/www/html /var/www/documents /var/www/scripts\nCOPY entrypoint.sh /\nRUN set -ex ; chmod 755 /entrypoint.sh\nENTRYPOINT [\"/entrypoint.sh\"]\nCMD [\"php-fpm\"]\n","originalDockerfileUglifiedHash":"506a46a17f6ee2cf9c16de87d6d46a41","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/b209b82be6637cde170956ef3867198a6def7cee.dockerfile"}