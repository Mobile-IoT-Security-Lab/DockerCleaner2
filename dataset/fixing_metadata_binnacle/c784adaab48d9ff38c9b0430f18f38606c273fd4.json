{"seed":2845750185,"processedDockerfileHash":"eccadb5ce48be14489713b0723c7458b","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apt-get","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM debian:jessie\nMAINTAINER \"cytopia\" <cytopia@everythingcli.org>\nENV PHP_VERSION=\"5.2.17\"\nENV PHP_INI_DIR=\"/usr/local/etc/php\"\n#   Setup directories\nRUN set -x \\\n && mkdir -p ${PHP_INI_DIR}/conf.d \\\n && mkdir -p /usr/src/php\n#   persistent / runtime deps\nRUN set -x \\\n && apt-get update \\\n && apt-get install --no-install-recommends ca-certificates curl libpcre3 librecode0 libmysqlclient-dev libsqlite3-0 libxml2 -y \\\n && apt-get clean \\\n && rm -r /var/lib/apt/lists/*\n#   phpize deps\nRUN set -x \\\n && apt-get update \\\n && apt-get install --no-install-recommends autoconf file g++ gcc libc-dev make pkg-config re2c xz-utils -y \\\n && apt-get clean \\\n && rm -r /var/lib/apt/lists/*\n#   compile openssl, otherwise --with-openssl won't work\nRUN set -x \\\n && OPENSSL_VERSION=\"1.0.2g\" \\\n && cd /tmp \\\n && mkdir openssl \\\n && curl -sL \"https://www.openssl.org/source/openssl-$OPENSSL_VERSION.tar.gz\" -o openssl.tar.gz \\\n && curl -sL \"https://www.openssl.org/source/openssl-$OPENSSL_VERSION.tar.gz.asc\" -o openssl.tar.gz.asc \\\n && tar -xzf openssl.tar.gz -C openssl --strip-components=1 \\\n && cd /tmp/openssl \\\n && ./config \\\n && make \\\n && make install \\\n && rm -rf /tmp/openssl*\n#   php 5.2 needs older autoconf\nRUN set -x \\\n && buildDeps=\" autoconf2.13 libbison-dev libcurl4-openssl-dev libfl-dev libmysqlclient-dev libpcre3-dev libreadline6-dev librecode-dev libsqlite3-dev libssl-dev libxml2-dev patch \" \\\n && set -x \\\n && apt-get update \\\n && apt-get install --no-install-recommends $buildDeps -y \\\n && rm -rf /var/lib/apt/lists/*\n#   Copy and apply patches to PHP\nCOPY data/php-${PHP_VERSION}*.patch /tmp/\nRUN set -x \\\n && curl -SL \"http://museum.php.net/php5/php-${PHP_VERSION}.tar.gz\" -o /usr/src/php.tar.gz \\\n && tar -xf /usr/src/php.tar.gz -C /usr/src/php --strip-components=1 \\\n && cd /usr/src/php \\\n && patch -p1 < /tmp/php-${PHP_VERSION}-libxml2.patch \\\n && patch -p1 < /tmp/php-${PHP_VERSION}-openssl.patch \\\n && patch -p1 < /tmp/php-${PHP_VERSION}-fpm.patch \\\n && patch -p0 < /tmp/php-${PHP_VERSION}-curl.patch || true \\\n && cd /usr/src \\\n && tar -cJf php.tar.xz php \\\n && rm -rf php php.tar.gz \\\n && rm -rf /tmp/php-*\nCOPY data/docker-php-source /usr/local/bin/\nRUN set -x \\\n && ln -s /usr/lib/x86_64-linux-gnu/libmysqlclient* /usr/lib/ \\\n && cd /usr/src \\\n && docker-php-source extract \\\n && cd /usr/src/php \\\n && ./configure --with-config-file-path=\"${PHP_INI_DIR}\" --with-config-file-scan-dir=\"${PHP_INI_DIR}/conf.d\" --with-fpm-conf=\"/usr/local/etc/php-fpm.conf\" --enable-fastcgi --enable-fpm --enable-force-cgi-redirect --enable-mbstring --enable-pdo --enable-soap --with-curl --with-mysql --with-mysqli --with-openssl=/usr/local/ssl --with-pdo-mysql --with-readline --with-zlib \\\n && make -j\"$( nproc ;)\" \\\n && make install \\\n && { find /usr/local/bin /usr/local/sbin -type f -executable -exec strip --strip-all '{}' + || true ; } \\\n && apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false -o APT::AutoRemove::SuggestsImportant=false ${buildDeps} \\\n && make clean \\\n && cd / \\\n && docker-php-source delete\nWORKDIR /var/www/html\nCOPY data/docker-php-* /usr/local/bin/\nCOPY data/php-fpm /usr/local/sbin/php-fpm\nCOPY data/php-fpm.conf /usr/local/etc/\nCOPY data/php.ini /usr/local/etc/php/php.ini\nEXPOSE 9000/tcp\nENTRYPOINT [\"php-fpm\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM debian:jessie\nMAINTAINER \"cytopia\" <cytopia@everythingcli.org>\nENV PHP_VERSION=\"5.2.17\"\nENV PHP_INI_DIR=\"/usr/local/etc/php\"\n#  Setup directories\nRUN set -x \\\n && mkdir -p ${PHP_INI_DIR}/conf.d \\\n && mkdir -p /usr/src/php\n#  persistent / runtime deps\nRUN set -x \\\n && apt-get update \\\n && apt-get install --no-install-recommends ca-certificates curl libpcre3 librecode0 libmysqlclient-dev libsqlite3-0 libxml2 -y \\\n && apt-get clean \\\n && rm -r /var/lib/apt/lists/*\n#  phpize deps\nRUN set -x \\\n && apt-get update \\\n && apt-get install --no-install-recommends autoconf file g++ gcc libc-dev make pkg-config re2c xz-utils -y \\\n && apt-get clean \\\n && rm -r /var/lib/apt/lists/*\n#  compile openssl, otherwise --with-openssl won't work\nRUN set -x \\\n && OPENSSL_VERSION=\"1.0.2g\" \\\n && cd /tmp \\\n && mkdir openssl \\\n && curl -sL \"https://www.openssl.org/source/openssl-$OPENSSL_VERSION.tar.gz\" -o openssl.tar.gz \\\n && curl -sL \"https://www.openssl.org/source/openssl-$OPENSSL_VERSION.tar.gz.asc\" -o openssl.tar.gz.asc \\\n && tar -xzf openssl.tar.gz -C openssl --strip-components=1 \\\n && cd /tmp/openssl \\\n && ./config \\\n && make \\\n && make install \\\n && rm -rf /tmp/openssl*\n#  php 5.2 needs older autoconf\nRUN set -x \\\n && buildDeps=\" autoconf2.13 libbison-dev libcurl4-openssl-dev libfl-dev libmysqlclient-dev libpcre3-dev libreadline6-dev librecode-dev libsqlite3-dev libssl-dev libxml2-dev patch \" \\\n && set -x \\\n && apt-get update \\\n && apt-get install --no-install-recommends $buildDeps -y \\\n && rm -rf /var/lib/apt/lists/*\n#  Copy and apply patches to PHP\nCOPY data/php-${PHP_VERSION}*.patch /tmp/\nRUN set -x \\\n && curl -SL \"http://museum.php.net/php5/php-${PHP_VERSION}.tar.gz\" -o /usr/src/php.tar.gz \\\n && tar -xf /usr/src/php.tar.gz -C /usr/src/php --strip-components=1 \\\n && cd /usr/src/php \\\n && patch -p1 < /tmp/php-${PHP_VERSION}-libxml2.patch \\\n && patch -p1 < /tmp/php-${PHP_VERSION}-openssl.patch \\\n && patch -p1 < /tmp/php-${PHP_VERSION}-fpm.patch \\\n && patch -p0 < /tmp/php-${PHP_VERSION}-curl.patch || true \\\n && cd /usr/src \\\n && tar -cJf php.tar.xz php \\\n && rm -rf php php.tar.gz \\\n && rm -rf /tmp/php-*\nCOPY data/docker-php-source /usr/local/bin/\nRUN set -x \\\n && ln -s /usr/lib/x86_64-linux-gnu/libmysqlclient* /usr/lib/ \\\n && cd /usr/src \\\n && docker-php-source extract \\\n && cd /usr/src/php \\\n && ./configure --with-config-file-path=\"${PHP_INI_DIR}\" --with-config-file-scan-dir=\"${PHP_INI_DIR}/conf.d\" --with-fpm-conf=\"/usr/local/etc/php-fpm.conf\" --enable-fastcgi --enable-fpm --enable-force-cgi-redirect --enable-mbstring --enable-pdo --enable-soap --with-curl --with-mysql --with-mysqli --with-openssl=/usr/local/ssl --with-pdo-mysql --with-readline --with-zlib \\\n && make -j\"$( nproc ;)\" \\\n && make install \\\n && { find /usr/local/bin /usr/local/sbin -type f -executable -exec strip --strip-all '{}' + || true ; } \\\n && apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false -o APT::AutoRemove::SuggestsImportant=false ${buildDeps} \\\n && make clean \\\n && cd / \\\n && docker-php-source delete\nWORKDIR /var/www/html\nCOPY data/docker-php-* /usr/local/bin/\nCOPY data/php-fpm /usr/local/sbin/php-fpm\nCOPY data/php-fpm.conf /usr/local/etc/\nCOPY data/php.ini /usr/local/etc/php/php.ini\nEXPOSE 9000/tcp\nENTRYPOINT [\"php-fpm\"]\n","injectedSmells":[],"originalDockerfileHash":"be30f4d9e3144c6ef544f6a5a99eb3a9","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM debian:jessie\nMAINTAINER \"cytopia\" <cytopia@everythingcli.org>\nENV PHP_VERSION=\"5.2.17\"\nENV PHP_INI_DIR=\"/usr/local/etc/php\"\n#   Setup directories\nRUN set -x \\\n && mkdir -p ${PHP_INI_DIR}/conf.d \\\n && mkdir -p /usr/src/php\n#   persistent / runtime deps\nRUN set -x \\\n && apt-get update \\\n && apt-get install --no-install-recommends ca-certificates curl libpcre3 librecode0 libmysqlclient-dev libsqlite3-0 libxml2 -y \\\n && apt-get clean \\\n && rm -r /var/lib/apt/lists/*\n#   phpize deps\nRUN set -x \\\n && apt-get update \\\n && apt-get install --no-install-recommends autoconf file g++ gcc libc-dev make pkg-config re2c xz-utils -y \\\n && apt-get clean \\\n && rm -r /var/lib/apt/lists/*\n#   compile openssl, otherwise --with-openssl won't work\nRUN set -x \\\n && OPENSSL_VERSION=\"1.0.2g\" \\\n && cd /tmp \\\n && mkdir openssl \\\n && curl -sL \"https://www.openssl.org/source/openssl-$OPENSSL_VERSION.tar.gz\" -o openssl.tar.gz \\\n && curl -sL \"https://www.openssl.org/source/openssl-$OPENSSL_VERSION.tar.gz.asc\" -o openssl.tar.gz.asc \\\n && tar -xzf openssl.tar.gz -C openssl --strip-components=1 \\\n && cd /tmp/openssl \\\n && ./config \\\n && make \\\n && make install \\\n && rm -rf /tmp/openssl*\n#   php 5.2 needs older autoconf\nRUN set -x \\\n && buildDeps=\" autoconf2.13 libbison-dev libcurl4-openssl-dev libfl-dev libmysqlclient-dev libpcre3-dev libreadline6-dev librecode-dev libsqlite3-dev libssl-dev libxml2-dev patch \" \\\n && set -x \\\n && apt-get update \\\n && apt-get install --no-install-recommends $buildDeps -y \\\n && rm -rf /var/lib/apt/lists/*\n#   Copy and apply patches to PHP\nCOPY data/php-${PHP_VERSION}*.patch /tmp/\nRUN set -x \\\n && curl -SL \"http://museum.php.net/php5/php-${PHP_VERSION}.tar.gz\" -o /usr/src/php.tar.gz \\\n && tar -xf /usr/src/php.tar.gz -C /usr/src/php --strip-components=1 \\\n && cd /usr/src/php \\\n && patch -p1 < /tmp/php-${PHP_VERSION}-libxml2.patch \\\n && patch -p1 < /tmp/php-${PHP_VERSION}-openssl.patch \\\n && patch -p1 < /tmp/php-${PHP_VERSION}-fpm.patch \\\n && patch -p0 < /tmp/php-${PHP_VERSION}-curl.patch || true \\\n && cd /usr/src \\\n && tar -cJf php.tar.xz php \\\n && rm -rf php php.tar.gz \\\n && rm -rf /tmp/php-*\nCOPY data/docker-php-source /usr/local/bin/\nRUN set -x \\\n && ln -s /usr/lib/x86_64-linux-gnu/libmysqlclient* /usr/lib/ \\\n && cd /usr/src \\\n && docker-php-source extract \\\n && cd /usr/src/php \\\n && ./configure --with-config-file-path=\"${PHP_INI_DIR}\" --with-config-file-scan-dir=\"${PHP_INI_DIR}/conf.d\" --with-fpm-conf=\"/usr/local/etc/php-fpm.conf\" --enable-fastcgi --enable-fpm --enable-force-cgi-redirect --enable-mbstring --enable-pdo --enable-soap --with-curl --with-mysql --with-mysqli --with-openssl=/usr/local/ssl --with-pdo-mysql --with-readline --with-zlib \\\n && make -j\"$( nproc ;)\" \\\n && make install \\\n && { find /usr/local/bin /usr/local/sbin -type f -executable -exec strip --strip-all '{}' + || true ; } \\\n && apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false -o APT::AutoRemove::SuggestsImportant=false ${buildDeps} \\\n && make clean \\\n && cd / \\\n && docker-php-source delete\nWORKDIR /var/www/html\nCOPY data/docker-php-* /usr/local/bin/\nCOPY data/php-fpm /usr/local/sbin/php-fpm\nCOPY data/php-fpm.conf /usr/local/etc/\nCOPY data/php.ini /usr/local/etc/php/php.ini\nEXPOSE 9000/tcp\nENTRYPOINT [\"php-fpm\"]\n","originalDockerfileUglifiedHash":"e65b2556424a2c65dfb913140c03099e","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/c784adaab48d9ff38c9b0430f18f38606c273fd4.dockerfile"}