{"seed":1651152266,"processedDockerfileHash":"e7b3af2a484821cd752453c054f604f5","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["have-a-healthcheck","have-a-user"],"processedDockerfile":"#   Copyright 2018 Google LLC\n#\n#   Licensed under the Apache License, Version 2.0 (the \"License\");\n#   you may not use this file except in compliance with the License.\n#   You may obtain a copy of the License at\n#\n#       https://www.apache.org/licenses/LICENSE-2.0\n#\n#   Unless required by applicable law or agreed to in writing, software\n#   distributed under the License is distributed on an \"AS IS\" BASIS,\n#   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n#   See the License for the specific language governing permissions and\n#   limitations under the License.\nFROM gcr.io/google-containers/debian-base-amd64:0.3\nARG BUILD_DATE\nARG VCS_REF\nARG CASSANDRA_VERSION\nARG CQLSH_CONTAINER\nLABEL org.label-schema.build-date=\"$BUILD_DATE\" \\\n      org.label-schema.docker.dockerfile=\"/Dockerfile\" \\\n      org.label-schema.license=\"Apache License 2.0\" \\\n      org.label-schema.name=\"Cassandra container optimized for Kubernetes\" \\\n      org.label-schema.url=\"https://github.com/GoogleCloudPlatform/\" \\\n      org.label-schema.vcs-ref=\"$VCS_REF\" \\\n      org.label-schema.vcs-type=\"Git\" \\\n      org.label-schema.vcs-url=\"https://github.com/GoogleCloudPlatform/gke-stateful-applications-demo\"\nENV CASSANDRA_CONF=\"/etc/cassandra\" \\\n    CASSANDRA_DATA=\"/var/lib/cassandra\" \\\n    CASSANDRA_LOGS=\"/var/log/cassandra\" \\\n    CASSANDRA_RELEASE=\"3.11.3\" \\\n    CASSANDRA_SHA=\"d82e0670cb41b091e88fff55250ce945c4ea026c87a5517d3cf7b6b351d5e2ba\" \\\n    JAVA_HOME=\"/usr/lib/jvm/java-8-openjdk-amd64\" \\\n    DI_VERSION=\"1.2.1\" \\\n    DI_SHA=\"057ecd4ac1d3c3be31f82fc0848bf77b1326a975b4f8423fe31607205a0fe945\" \\\n    JOLOKIA_VERSION=\"1.5.0\" \\\n    JOLOKIA_SHA=\"cd7e20a2887e013873d7321cea1e6bf6bd6ffcdd3cd3968d6950edd8d79bbfb8\" \\\n    PROMETHEUS_VERSION=\"0.10\" \\\n    PROMETHEUS_SHA=\"b144a5a22fc9ee62d8d198f0dcc622f851c77cf52fee4bd529afbc266af37e29\" \\\n    LOGENCODER_VERSION=\"4.10-SNAPSHOT\" \\\n    LOGENCODER_SHA=\"89be27bea7adc05b68c052a27b08c594a9f8e354185acbfd7a7b5f04c7cd9e20\"\nCOPY files /\n#   hadolint ignore=DL3008,DL4006\nRUN set -ex \\\n && echo 'debconf debconf/frontend select Noninteractive' | debconf-set-selections \\\n && export CASSANDRA_VERSION=${CASSANDRA_VERSION:-$CASSANDRA_RELEASE} \\\n && export CASSANDRA_HOME=/usr/local/apache-cassandra-${CASSANDRA_VERSION} \\\n && apt-get update \\\n && apt-get install --no-install-recommends bash openjdk-8-jre-headless libjemalloc1 localepurge wget jq -qq -y --force-yes \\\n && wget -q -O - \"http://search.maven.org/remotecontent?filepath=io/prometheus/jmx/jmx_prometheus_javaagent/${PROMETHEUS_VERSION}/jmx_prometheus_javaagent-${PROMETHEUS_VERSION}.jar\" > /usr/local/share/prometheus-agent.jar \\\n && echo \"$PROMETHEUS_SHA /usr/local/share/prometheus-agent.jar\" | sha256sum -c - \\\n && wget -q -O - \"http://search.maven.org/remotecontent?filepath=org/jolokia/jolokia-jvm/${JOLOKIA_VERSION}/jolokia-jvm-${JOLOKIA_VERSION}-agent.jar\" > /usr/local/share/jolokia-agent.jar \\\n && echo \"$JOLOKIA_SHA /usr/local/share/jolokia-agent.jar\" | sha256sum -c - \\\n && mirror_url=$( wget -q -O - 'https://www.apache.org/dyn/closer.cgi?as_json=1' | jq --raw-output '.preferred' ;) \\\n && wget -q -O - \"${mirror_url}cassandra/${CASSANDRA_VERSION}/apache-cassandra-${CASSANDRA_VERSION}-bin.tar.gz\" > /usr/local/apache-cassandra-bin.tar.gz \\\n && echo \"$CASSANDRA_SHA /usr/local/apache-cassandra-bin.tar.gz\" | sha256sum - \\\n && tar -xzf /usr/local/apache-cassandra-bin.tar.gz -C /usr/local \\\n && rm /usr/local/apache-cassandra-bin.tar.gz \\\n && ln -s $CASSANDRA_HOME /usr/local/apache-cassandra \\\n && wget -q -O - \"https://github.com/mstump/logstash-logback-encoder/releases/download/${LOGENCODER_VERSION}/logstash-logback-encoder-${LOGENCODER_VERSION}.jar\" > /usr/local/apache-cassandra/lib/log-encoder.jar \\\n && echo \"$LOGENCODER_SHA /usr/local/apache-cassandra/lib/log-encoder.jar\" | sha256sum -c - \\\n && wget -q -O - https://github.com/Yelp/dumb-init/releases/download/v${DI_VERSION}/dumb-init_${DI_VERSION}_amd64 > /sbin/dumb-init \\\n && echo \"$DI_SHA /sbin/dumb-init\" | sha256sum -c - \\\n && adduser --disabled-password --no-create-home --gecos '' --disabled-login cassandra \\\n && mkdir -p /var/lib/cassandra/ /var/log/cassandra/ /etc/cassandra/triggers \\\n && chmod +x /sbin/dumb-init /ready-probe.sh \\\n && mv /logback-stdout.xml /logback-json-files.xml /logback-json-stdout.xml /logback-files.xml /cassandra.yaml /jvm.options /prometheus.yaml /etc/cassandra/ \\\n && mv /usr/local/apache-cassandra/conf/cassandra-env.sh /etc/cassandra/ \\\n && chown cassandra: /ready-probe.sh \\\n && if [ -n \"$CQLSH_CONTAINER\" ] ; then apt-get install --no-install-recommends python -y ; else rm -rf $CASSANDRA_HOME/pylib ; fi \\\n && apt-get -y purge wget jq localepurge \\\n && apt-get -y autoremove \\\n && apt-get clean \\\n && rm -rf $CASSANDRA_HOME/*.txt $CASSANDRA_HOME/doc $CASSANDRA_HOME/javadoc $CASSANDRA_HOME/tools/*.yaml $CASSANDRA_HOME/tools/bin/*.bat $CASSANDRA_HOME/bin/*.bat doc man info locale common-licenses ~/.bashrc /var/lib/apt/lists/* /var/log/**/* /var/cache/debconf/* /etc/systemd /lib/lsb /lib/udev /usr/share/doc/ /usr/share/doc-base/ /usr/share/man/ /tmp/* /usr/lib/jvm/java-8-openjdk-amd64/jre/plugin /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/javaws /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/jjs /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/orbd /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/pack200 /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/policytool /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/rmid /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/rmiregistry /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/servertool /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/tnameserv /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/unpack200 /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/javaws.jar /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/deploy* /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/desktop /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/*javafx* /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/*jfx* /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64/libdecora_sse.so /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64/libprism_*.so /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64/libfxplugins.so /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64/libglass.so /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64/libgstreamer-lite.so /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64/libjavafx*.so /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64/libjfx*.so /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/ext/jfxrt.jar /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/ext/nashorn.jar /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/oblique-fonts /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/plugin.jar /usr/lib/jvm/java-8-openjdk-amd64/jre/man /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/images /usr/lib/jvm/java-8-openjdk-amd64/man /usr/lib/jvm/java-8-openjdk-amd64/jre/THIRD_PARTY_README /usr/lib/jvm/java-8-openjdk-amd64/jre/ASSEMBLY_EXCEPTION\nVOLUME [\"/var/lib/cassandra\"]\n#   1234: prometheus jmx_exporter\n#   7000: intra-node communication\n#   7001: TLS intra-node communication\n#   7199: JMX\n#   9042: CQL\n#   9160: thrift service\n#   8778: jolokia port\nEXPOSE 1234/tcp 7000/tcp 7001/tcp 7199/tcp 9042/tcp 9160/tcp 8778/tcp\nCMD [\"/sbin/dumb-init\", \"/bin/bash\", \"/run.sh\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  Copyright 2018 Google LLC\n#\n#  Licensed under the Apache License, Version 2.0 (the \"License\");\n#  you may not use this file except in compliance with the License.\n#  You may obtain a copy of the License at\n#\n#      https://www.apache.org/licenses/LICENSE-2.0\n#\n#  Unless required by applicable law or agreed to in writing, software\n#  distributed under the License is distributed on an \"AS IS\" BASIS,\n#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n#  See the License for the specific language governing permissions and\n#  limitations under the License.\nFROM gcr.io/google-containers/debian-base-amd64:0.3\nARG BUILD_DATE\nARG VCS_REF\nARG CASSANDRA_VERSION\nARG CQLSH_CONTAINER\nLABEL org.label-schema.build-date=\"$BUILD_DATE\" \\\n      org.label-schema.docker.dockerfile=\"/Dockerfile\" \\\n      org.label-schema.license=\"Apache License 2.0\" \\\n      org.label-schema.name=\"Cassandra container optimized for Kubernetes\" \\\n      org.label-schema.url=\"https://github.com/GoogleCloudPlatform/\" \\\n      org.label-schema.vcs-ref=\"$VCS_REF\" \\\n      org.label-schema.vcs-type=\"Git\" \\\n      org.label-schema.vcs-url=\"https://github.com/GoogleCloudPlatform/gke-stateful-applications-demo\"\nENV CASSANDRA_CONF=\"/etc/cassandra\" \\\n    CASSANDRA_DATA=\"/var/lib/cassandra\" \\\n    CASSANDRA_LOGS=\"/var/log/cassandra\" \\\n    CASSANDRA_RELEASE=\"3.11.3\" \\\n    CASSANDRA_SHA=\"d82e0670cb41b091e88fff55250ce945c4ea026c87a5517d3cf7b6b351d5e2ba\" \\\n    JAVA_HOME=\"/usr/lib/jvm/java-8-openjdk-amd64\" \\\n    DI_VERSION=\"1.2.1\" \\\n    DI_SHA=\"057ecd4ac1d3c3be31f82fc0848bf77b1326a975b4f8423fe31607205a0fe945\" \\\n    JOLOKIA_VERSION=\"1.5.0\" \\\n    JOLOKIA_SHA=\"cd7e20a2887e013873d7321cea1e6bf6bd6ffcdd3cd3968d6950edd8d79bbfb8\" \\\n    PROMETHEUS_VERSION=\"0.10\" \\\n    PROMETHEUS_SHA=\"b144a5a22fc9ee62d8d198f0dcc622f851c77cf52fee4bd529afbc266af37e29\" \\\n    LOGENCODER_VERSION=\"4.10-SNAPSHOT\" \\\n    LOGENCODER_SHA=\"89be27bea7adc05b68c052a27b08c594a9f8e354185acbfd7a7b5f04c7cd9e20\"\nCOPY files /\n#  hadolint ignore=DL3008,DL4006\nRUN set -ex \\\n && echo 'debconf debconf/frontend select Noninteractive' | debconf-set-selections \\\n && export CASSANDRA_VERSION=${CASSANDRA_VERSION:-$CASSANDRA_RELEASE} \\\n && export CASSANDRA_HOME=/usr/local/apache-cassandra-${CASSANDRA_VERSION} \\\n && apt-get update \\\n && apt-get install --no-install-recommends bash openjdk-8-jre-headless libjemalloc1 localepurge wget jq -qq -y --force-yes \\\n && wget -q -O - \"http://search.maven.org/remotecontent?filepath=io/prometheus/jmx/jmx_prometheus_javaagent/${PROMETHEUS_VERSION}/jmx_prometheus_javaagent-${PROMETHEUS_VERSION}.jar\" > /usr/local/share/prometheus-agent.jar \\\n && echo \"$PROMETHEUS_SHA /usr/local/share/prometheus-agent.jar\" | sha256sum -c - \\\n && wget -q -O - \"http://search.maven.org/remotecontent?filepath=org/jolokia/jolokia-jvm/${JOLOKIA_VERSION}/jolokia-jvm-${JOLOKIA_VERSION}-agent.jar\" > /usr/local/share/jolokia-agent.jar \\\n && echo \"$JOLOKIA_SHA /usr/local/share/jolokia-agent.jar\" | sha256sum -c - \\\n && mirror_url=$( wget -q -O - 'https://www.apache.org/dyn/closer.cgi?as_json=1' | jq --raw-output '.preferred' ;) \\\n && wget -q -O - \"${mirror_url}cassandra/${CASSANDRA_VERSION}/apache-cassandra-${CASSANDRA_VERSION}-bin.tar.gz\" > /usr/local/apache-cassandra-bin.tar.gz \\\n && echo \"$CASSANDRA_SHA /usr/local/apache-cassandra-bin.tar.gz\" | sha256sum - \\\n && tar -xzf /usr/local/apache-cassandra-bin.tar.gz -C /usr/local \\\n && rm /usr/local/apache-cassandra-bin.tar.gz \\\n && ln -s $CASSANDRA_HOME /usr/local/apache-cassandra \\\n && wget -q -O - \"https://github.com/mstump/logstash-logback-encoder/releases/download/${LOGENCODER_VERSION}/logstash-logback-encoder-${LOGENCODER_VERSION}.jar\" > /usr/local/apache-cassandra/lib/log-encoder.jar \\\n && echo \"$LOGENCODER_SHA /usr/local/apache-cassandra/lib/log-encoder.jar\" | sha256sum -c - \\\n && wget -q -O - https://github.com/Yelp/dumb-init/releases/download/v${DI_VERSION}/dumb-init_${DI_VERSION}_amd64 > /sbin/dumb-init \\\n && echo \"$DI_SHA /sbin/dumb-init\" | sha256sum -c - \\\n && adduser --disabled-password --no-create-home --gecos '' --disabled-login cassandra \\\n && mkdir -p /var/lib/cassandra/ /var/log/cassandra/ /etc/cassandra/triggers \\\n && chmod +x /sbin/dumb-init /ready-probe.sh \\\n && mv /logback-stdout.xml /logback-json-files.xml /logback-json-stdout.xml /logback-files.xml /cassandra.yaml /jvm.options /prometheus.yaml /etc/cassandra/ \\\n && mv /usr/local/apache-cassandra/conf/cassandra-env.sh /etc/cassandra/ \\\n && chown cassandra: /ready-probe.sh \\\n && if [ -n \"$CQLSH_CONTAINER\" ] ; then apt-get install --no-install-recommends python -y ; else rm -rf $CASSANDRA_HOME/pylib ; fi \\\n && apt-get -y purge wget jq localepurge \\\n && apt-get -y autoremove \\\n && apt-get clean \\\n && rm -rf $CASSANDRA_HOME/*.txt $CASSANDRA_HOME/doc $CASSANDRA_HOME/javadoc $CASSANDRA_HOME/tools/*.yaml $CASSANDRA_HOME/tools/bin/*.bat $CASSANDRA_HOME/bin/*.bat doc man info locale common-licenses ~/.bashrc /var/lib/apt/lists/* /var/log/**/* /var/cache/debconf/* /etc/systemd /lib/lsb /lib/udev /usr/share/doc/ /usr/share/doc-base/ /usr/share/man/ /tmp/* /usr/lib/jvm/java-8-openjdk-amd64/jre/plugin /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/javaws /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/jjs /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/orbd /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/pack200 /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/policytool /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/rmid /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/rmiregistry /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/servertool /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/tnameserv /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/unpack200 /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/javaws.jar /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/deploy* /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/desktop /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/*javafx* /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/*jfx* /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64/libdecora_sse.so /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64/libprism_*.so /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64/libfxplugins.so /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64/libglass.so /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64/libgstreamer-lite.so /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64/libjavafx*.so /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64/libjfx*.so /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/ext/jfxrt.jar /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/ext/nashorn.jar /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/oblique-fonts /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/plugin.jar /usr/lib/jvm/java-8-openjdk-amd64/jre/man /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/images /usr/lib/jvm/java-8-openjdk-amd64/man /usr/lib/jvm/java-8-openjdk-amd64/jre/THIRD_PARTY_README /usr/lib/jvm/java-8-openjdk-amd64/jre/ASSEMBLY_EXCEPTION\nVOLUME [\"/var/lib/cassandra\"]\n#  1234: prometheus jmx_exporter\n#  7000: intra-node communication\n#  7001: TLS intra-node communication\n#  7199: JMX\n#  9042: CQL\n#  9160: thrift service\n#  8778: jolokia port\nEXPOSE 1234/tcp 7000/tcp 7001/tcp 7199/tcp 9042/tcp 9160/tcp 8778/tcp\nCMD [\"/sbin/dumb-init\", \"/bin/bash\", \"/run.sh\"]\n","injectedSmells":[],"originalDockerfileHash":"a35683b1b6e3d80b2a5a9c0e626a958a","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   Copyright 2018 Google LLC\n#\n#   Licensed under the Apache License, Version 2.0 (the \"License\");\n#   you may not use this file except in compliance with the License.\n#   You may obtain a copy of the License at\n#\n#       https://www.apache.org/licenses/LICENSE-2.0\n#\n#   Unless required by applicable law or agreed to in writing, software\n#   distributed under the License is distributed on an \"AS IS\" BASIS,\n#   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n#   See the License for the specific language governing permissions and\n#   limitations under the License.\nFROM gcr.io/google-containers/debian-base-amd64:0.3\nARG BUILD_DATE\nARG VCS_REF\nARG CASSANDRA_VERSION\nARG CQLSH_CONTAINER\nLABEL org.label-schema.build-date=\"$BUILD_DATE\" \\\n      org.label-schema.docker.dockerfile=\"/Dockerfile\" \\\n      org.label-schema.license=\"Apache License 2.0\" \\\n      org.label-schema.name=\"Cassandra container optimized for Kubernetes\" \\\n      org.label-schema.url=\"https://github.com/GoogleCloudPlatform/\" \\\n      org.label-schema.vcs-ref=\"$VCS_REF\" \\\n      org.label-schema.vcs-type=\"Git\" \\\n      org.label-schema.vcs-url=\"https://github.com/GoogleCloudPlatform/gke-stateful-applications-demo\"\nENV CASSANDRA_CONF=\"/etc/cassandra\" \\\n    CASSANDRA_DATA=\"/var/lib/cassandra\" \\\n    CASSANDRA_LOGS=\"/var/log/cassandra\" \\\n    CASSANDRA_RELEASE=\"3.11.3\" \\\n    CASSANDRA_SHA=\"d82e0670cb41b091e88fff55250ce945c4ea026c87a5517d3cf7b6b351d5e2ba\" \\\n    JAVA_HOME=\"/usr/lib/jvm/java-8-openjdk-amd64\" \\\n    DI_VERSION=\"1.2.1\" \\\n    DI_SHA=\"057ecd4ac1d3c3be31f82fc0848bf77b1326a975b4f8423fe31607205a0fe945\" \\\n    JOLOKIA_VERSION=\"1.5.0\" \\\n    JOLOKIA_SHA=\"cd7e20a2887e013873d7321cea1e6bf6bd6ffcdd3cd3968d6950edd8d79bbfb8\" \\\n    PROMETHEUS_VERSION=\"0.10\" \\\n    PROMETHEUS_SHA=\"b144a5a22fc9ee62d8d198f0dcc622f851c77cf52fee4bd529afbc266af37e29\" \\\n    LOGENCODER_VERSION=\"4.10-SNAPSHOT\" \\\n    LOGENCODER_SHA=\"89be27bea7adc05b68c052a27b08c594a9f8e354185acbfd7a7b5f04c7cd9e20\"\nCOPY files /\n#   hadolint ignore=DL3008,DL4006\nRUN set -ex \\\n && echo 'debconf debconf/frontend select Noninteractive' | debconf-set-selections \\\n && export CASSANDRA_VERSION=${CASSANDRA_VERSION:-$CASSANDRA_RELEASE} \\\n && export CASSANDRA_HOME=/usr/local/apache-cassandra-${CASSANDRA_VERSION} \\\n && apt-get update \\\n && apt-get install --no-install-recommends bash openjdk-8-jre-headless libjemalloc1 localepurge wget jq -qq -y --force-yes \\\n && wget -q -O - \"http://search.maven.org/remotecontent?filepath=io/prometheus/jmx/jmx_prometheus_javaagent/${PROMETHEUS_VERSION}/jmx_prometheus_javaagent-${PROMETHEUS_VERSION}.jar\" > /usr/local/share/prometheus-agent.jar \\\n && echo \"$PROMETHEUS_SHA /usr/local/share/prometheus-agent.jar\" | sha256sum -c - \\\n && wget -q -O - \"http://search.maven.org/remotecontent?filepath=org/jolokia/jolokia-jvm/${JOLOKIA_VERSION}/jolokia-jvm-${JOLOKIA_VERSION}-agent.jar\" > /usr/local/share/jolokia-agent.jar \\\n && echo \"$JOLOKIA_SHA /usr/local/share/jolokia-agent.jar\" | sha256sum -c - \\\n && mirror_url=$( wget -q -O - 'https://www.apache.org/dyn/closer.cgi?as_json=1' | jq --raw-output '.preferred' ;) \\\n && wget -q -O - \"${mirror_url}cassandra/${CASSANDRA_VERSION}/apache-cassandra-${CASSANDRA_VERSION}-bin.tar.gz\" > /usr/local/apache-cassandra-bin.tar.gz \\\n && echo \"$CASSANDRA_SHA /usr/local/apache-cassandra-bin.tar.gz\" | sha256sum - \\\n && tar -xzf /usr/local/apache-cassandra-bin.tar.gz -C /usr/local \\\n && rm /usr/local/apache-cassandra-bin.tar.gz \\\n && ln -s $CASSANDRA_HOME /usr/local/apache-cassandra \\\n && wget -q -O - \"https://github.com/mstump/logstash-logback-encoder/releases/download/${LOGENCODER_VERSION}/logstash-logback-encoder-${LOGENCODER_VERSION}.jar\" > /usr/local/apache-cassandra/lib/log-encoder.jar \\\n && echo \"$LOGENCODER_SHA /usr/local/apache-cassandra/lib/log-encoder.jar\" | sha256sum -c - \\\n && wget -q -O - https://github.com/Yelp/dumb-init/releases/download/v${DI_VERSION}/dumb-init_${DI_VERSION}_amd64 > /sbin/dumb-init \\\n && echo \"$DI_SHA /sbin/dumb-init\" | sha256sum -c - \\\n && adduser --disabled-password --no-create-home --gecos '' --disabled-login cassandra \\\n && mkdir -p /var/lib/cassandra/ /var/log/cassandra/ /etc/cassandra/triggers \\\n && chmod +x /sbin/dumb-init /ready-probe.sh \\\n && mv /logback-stdout.xml /logback-json-files.xml /logback-json-stdout.xml /logback-files.xml /cassandra.yaml /jvm.options /prometheus.yaml /etc/cassandra/ \\\n && mv /usr/local/apache-cassandra/conf/cassandra-env.sh /etc/cassandra/ \\\n && chown cassandra: /ready-probe.sh \\\n && if [ -n \"$CQLSH_CONTAINER\" ] ; then apt-get install --no-install-recommends python -y ; else rm -rf $CASSANDRA_HOME/pylib ; fi \\\n && apt-get -y purge wget jq localepurge \\\n && apt-get -y autoremove \\\n && apt-get clean \\\n && rm -rf $CASSANDRA_HOME/*.txt $CASSANDRA_HOME/doc $CASSANDRA_HOME/javadoc $CASSANDRA_HOME/tools/*.yaml $CASSANDRA_HOME/tools/bin/*.bat $CASSANDRA_HOME/bin/*.bat doc man info locale common-licenses ~/.bashrc /var/lib/apt/lists/* /var/log/**/* /var/cache/debconf/* /etc/systemd /lib/lsb /lib/udev /usr/share/doc/ /usr/share/doc-base/ /usr/share/man/ /tmp/* /usr/lib/jvm/java-8-openjdk-amd64/jre/plugin /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/javaws /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/jjs /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/orbd /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/pack200 /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/policytool /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/rmid /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/rmiregistry /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/servertool /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/tnameserv /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/unpack200 /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/javaws.jar /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/deploy* /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/desktop /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/*javafx* /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/*jfx* /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64/libdecora_sse.so /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64/libprism_*.so /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64/libfxplugins.so /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64/libglass.so /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64/libgstreamer-lite.so /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64/libjavafx*.so /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/amd64/libjfx*.so /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/ext/jfxrt.jar /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/ext/nashorn.jar /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/oblique-fonts /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/plugin.jar /usr/lib/jvm/java-8-openjdk-amd64/jre/man /usr/lib/jvm/java-8-openjdk-amd64/jre/lib/images /usr/lib/jvm/java-8-openjdk-amd64/man /usr/lib/jvm/java-8-openjdk-amd64/jre/THIRD_PARTY_README /usr/lib/jvm/java-8-openjdk-amd64/jre/ASSEMBLY_EXCEPTION\nVOLUME [\"/var/lib/cassandra\"]\n#   1234: prometheus jmx_exporter\n#   7000: intra-node communication\n#   7001: TLS intra-node communication\n#   7199: JMX\n#   9042: CQL\n#   9160: thrift service\n#   8778: jolokia port\nEXPOSE 1234/tcp 7000/tcp 7001/tcp 7199/tcp 9042/tcp 9160/tcp 8778/tcp\nCMD [\"/sbin/dumb-init\", \"/bin/bash\", \"/run.sh\"]\n","originalDockerfileUglifiedHash":"58088eaa350535340ec84fb3ae509e19","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/d756c6a47033f08f686ada505c1c10523e27534e.dockerfile"}