{"seed":4054778820,"processedDockerfileHash":"7fa51a48311637d642b96ce0fb480462","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","have-a-healthcheck"],"processedDockerfile":"FROM python:3.7.1-stretch\nMAINTAINER Lukas Macura <lukas@lethean.io>\nLABEL io.lethean.vpn-server=\"Lethean.IO\"\nLABEL version=\"1.0\"\nLABEL description=\"Letehan.io VPN server\"\nARG DAEMON_BIN_URL=\"https://github.com/LetheanMovement/lethean/releases/download/v3.1.0/lethean-cli-linux-64bit-v3.1.tar.bz2\"\nARG DAEMON_HOST=\"sync.lethean.io\"\nARG PORT=\"8080\"\nARG ZSYNC_URL=\"https://monitor.lethean.io/bc/data.mdb.zsync\"\nARG ZSYNC_DATA_URL=\"http://monitor.lethean.io/bc/data.mdb\"\nARG ZSYNC_DATA_SHA=\"http://monitor.lethean.io/bc/data.mdb.sha256\"\nENV LTHNPREFIX=\"/opt/lthn\"\n#   Daemon host. Set to empty string to use local daemon with complete copy of blockchain.\nENV DAEMON_HOST=\"$DAEMON_HOST\"\n#   Wallet file. It is relative to etc directory.\nENV WALLET_FILE=\"vpn\"\n#   If you want to use external wallet, set this to RPC of external wallet host\nENV WALLET_RPC_URI=\"\"\n#   Wallet password. Default is to generate random password\nENV WALLET_PASSWORD=\"\"\n#   Wallet RPC password. Default is to generate random password. Username used by dispatcher is 'dispatcher'\nENV WALLET_RPC_PASSWORD=\"\"\n#   To restore wallet from this height. Only applicable for local wallet.\nENV WALLET_RESTORE_HEIGHT=\"349516\"\n#   CA password. Default to generate random password\nENV CA_PASSWORD=\"\"\n#   Common Name for CN\nENV CA_CN=\"LTHNEasyDeploy\"\n#   If you already have providerid. In other case, autogenerate\nENV PROVIDER_ID=\"\"\n#   If you already have providerkey. In other case, autogenerate\nENV PROVIDER_KEY=\"\"\n#   Provider name\nENV PROVIDER_NAME=\"EasyProvider\"\n#   Provider type\nENV PROVIDER_TYPE=\"residential\"\n#   Service endpoint. You need to change this in SDP later\nENV ENDPOINT=\"127.0.0.1\"\n#   Service port\nENV PORT=\"$PORT\"\n#   Zabbix parameters\nENV ZABBIX_SERVER=\"zabbix\"\nENV ZABBIX_HOSTNAME=\"lethean-vpn\"\nENV ZABBIX_META=\"LETHEANNODE\"\nENV ZSYNC_URL=\"$ZSYNC_URL\"\nENV ZSYNC_DATA_URL=\"$ZSYNC_DATA_URL\"\nENV ZSYNC_DATA_SHA=\"$ZSYNC_DATA_SHA\"\nENTRYPOINT [\"/entrypiont-lethean-vpn.sh\"]\nCMD [\"run\"]\nRUN useradd -ms /bin/bash lthn ; apt-get update ; apt-get install --no-install-recommends sudo joe less haproxy openvpn squid net-tools wget stunnel zsync pwgen -y ; echo \"lthn ALL=(ALL) NOPASSWD: ALL\" > /etc/sudoers; mkdir /usr/src/lethean-vpn ; chown -R lthn /usr/src/lethean-vpn\nWORKDIR /usr/src/lethean-vpn/build\nRUN wget -nc -c $DAEMON_BIN_URL \\\n && tar --strip-components 1 -C /usr/bin/ -xjvf $( basename $DAEMON_BIN_URL ;)\nRUN wget https://repo.zabbix.com/zabbix/4.0/debian/pool/main/z/zabbix-release/zabbix-release_4.0-2+stretch_all.deb \\\n && dpkg -i zabbix-release_4.0-2+stretch_all.deb\nRUN apt-get update \\\n && apt-get install --no-install-recommends zabbix-agent zabbix-sender -y \\\n && mkdir /var/run/zabbix \\\n && chown -R lthn /var/log/zabbix /var/run/zabbix\nRUN sed -i \"s/Hostname=(.*)/Hostname=$ZABBIX_HOSTNAME/\" /etc/zabbix/zabbix_agentd.conf ; sed -i \"s/Server=(.*)/Server=$ZABBIX_SERVER/\" /etc/zabbix/zabbix_agentd.conf ; sed -i \"s/ServerActive=(.*)/ServerActive=$ZABBIX_SERVER/\" /etc/zabbix/zabbix_agentd.conf ; sed -i \"s/Hostname=(.*)/Hostname=$ZABBIX_HOSTNAME/\" /etc/zabbix/zabbix_agentd.conf ; sed -i \"s/HostMetadata=(.*)/HostMetadata=$ZABBIX_META/\" /etc/zabbix/zabbix_agentd.conf\nUSER root\nCOPY ./ /usr/src/lethean-vpn/\nRUN rm -rf /usr/src/lethean-vpn/build/\nRUN pip3 install -r /usr/src/lethean-vpn/requirements.txt\nCOPY ./server/docker-run.sh /entrypiont-lethean-vpn.sh\nRUN chown -R lthn /usr/src/ ; chmod +x /entrypiont-lethean-vpn.sh ; chmod +x /usr/src/lethean-vpn/install.sh\nRUN echo -e \"domain lthn.local\\nsearch lthn.local\\nnameserver 127.0.0.1\\n >/etc/resolv.conf\"\nUSER lthn\nWORKDIR /usr/src/lethean-vpn/\nRUN chmod +x configure.sh ; ./configure.sh --runas-user lthn --runas-group lthn --client\nRUN make install SERVER=1 CLIENT=1\nRUN rm -rf /opt/lthn/etc/ca /opt/lthn/etc/*.ini /opt/lthn/etc/*.json /opt/lthn/etc/*.pem /opt/lthn/etc/*.tlsauth /opt/lthn/etc/*.keys /opt/lthn/etc/provider* /opt/lthn/var/* /usr/src/lethean-vpn/build /usr/src/lethean-vpn/env.mk ; mkdir -p /opt/lthn/var/log /opt/lthn/var/run\nWORKDIR /home/lthn\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM python:3.7.1-stretch\nMAINTAINER Lukas Macura <lukas@lethean.io>\nLABEL io.lethean.vpn-server=\"Lethean.IO\"\nLABEL version=\"1.0\"\nLABEL description=\"Letehan.io VPN server\"\nARG DAEMON_BIN_URL=\"https://github.com/LetheanMovement/lethean/releases/download/v3.1.0/lethean-cli-linux-64bit-v3.1.tar.bz2\"\nARG DAEMON_HOST=\"sync.lethean.io\"\nARG PORT=\"8080\"\nARG ZSYNC_URL=\"https://monitor.lethean.io/bc/data.mdb.zsync\"\nARG ZSYNC_DATA_URL=\"http://monitor.lethean.io/bc/data.mdb\"\nARG ZSYNC_DATA_SHA=\"http://monitor.lethean.io/bc/data.mdb.sha256\"\nENV LTHNPREFIX=\"/opt/lthn\"\n#  Daemon host. Set to empty string to use local daemon with complete copy of blockchain.\nENV DAEMON_HOST=\"$DAEMON_HOST\"\n#  Wallet file. It is relative to etc directory.\nENV WALLET_FILE=\"vpn\"\n#  If you want to use external wallet, set this to RPC of external wallet host\nENV WALLET_RPC_URI=\"\"\n#  Wallet password. Default is to generate random password\nENV WALLET_PASSWORD=\"\"\n#  Wallet RPC password. Default is to generate random password. Username used by dispatcher is 'dispatcher'\nENV WALLET_RPC_PASSWORD=\"\"\n#  To restore wallet from this height. Only applicable for local wallet.\nENV WALLET_RESTORE_HEIGHT=\"349516\"\n#  CA password. Default to generate random password\nENV CA_PASSWORD=\"\"\n#  Common Name for CN\nENV CA_CN=\"LTHNEasyDeploy\"\n#  If you already have providerid. In other case, autogenerate\nENV PROVIDER_ID=\"\"\n#  If you already have providerkey. In other case, autogenerate\nENV PROVIDER_KEY=\"\"\n#  Provider name\nENV PROVIDER_NAME=\"EasyProvider\"\n#  Provider type\nENV PROVIDER_TYPE=\"residential\"\n#  Service endpoint. You need to change this in SDP later\nENV ENDPOINT=\"127.0.0.1\"\n#  Service port\nENV PORT=\"$PORT\"\n#  Zabbix parameters\nENV ZABBIX_SERVER=\"zabbix\"\nENV ZABBIX_HOSTNAME=\"lethean-vpn\"\nENV ZABBIX_META=\"LETHEANNODE\"\nENV ZSYNC_URL=\"$ZSYNC_URL\"\nENV ZSYNC_DATA_URL=\"$ZSYNC_DATA_URL\"\nENV ZSYNC_DATA_SHA=\"$ZSYNC_DATA_SHA\"\nENTRYPOINT [\"/entrypiont-lethean-vpn.sh\"]\nCMD [\"run\"]\nRUN useradd -ms /bin/bash lthn ; apt-get update ; apt-get install sudo joe less haproxy openvpn squid net-tools wget stunnel zsync pwgen -y ; echo \"lthn ALL=(ALL) NOPASSWD: ALL\" > /etc/sudoers; mkdir /usr/src/lethean-vpn ; chown -R lthn /usr/src/lethean-vpn\nWORKDIR /usr/src/lethean-vpn/build\nRUN wget -nc -c $DAEMON_BIN_URL \\\n && tar --strip-components 1 -C /usr/bin/ -xjvf $( basename $DAEMON_BIN_URL ;)\nRUN wget https://repo.zabbix.com/zabbix/4.0/debian/pool/main/z/zabbix-release/zabbix-release_4.0-2+stretch_all.deb \\\n && dpkg -i zabbix-release_4.0-2+stretch_all.deb\nRUN apt-get update \\\n && apt-get install zabbix-agent zabbix-sender -y \\\n && mkdir /var/run/zabbix \\\n && chown -R lthn /var/log/zabbix /var/run/zabbix\nRUN sed -i \"s/Hostname=(.*)/Hostname=$ZABBIX_HOSTNAME/\" /etc/zabbix/zabbix_agentd.conf ; sed -i \"s/Server=(.*)/Server=$ZABBIX_SERVER/\" /etc/zabbix/zabbix_agentd.conf ; sed -i \"s/ServerActive=(.*)/ServerActive=$ZABBIX_SERVER/\" /etc/zabbix/zabbix_agentd.conf ; sed -i \"s/Hostname=(.*)/Hostname=$ZABBIX_HOSTNAME/\" /etc/zabbix/zabbix_agentd.conf ; sed -i \"s/HostMetadata=(.*)/HostMetadata=$ZABBIX_META/\" /etc/zabbix/zabbix_agentd.conf\nUSER root\nCOPY ./ /usr/src/lethean-vpn/\nRUN rm -rf /usr/src/lethean-vpn/build/\nRUN pip3 install -r /usr/src/lethean-vpn/requirements.txt\nCOPY ./server/docker-run.sh /entrypiont-lethean-vpn.sh\nRUN chown -R lthn /usr/src/ ; chmod +x /entrypiont-lethean-vpn.sh ; chmod +x /usr/src/lethean-vpn/install.sh\nRUN echo -e \"domain lthn.local\\nsearch lthn.local\\nnameserver 127.0.0.1\\n >/etc/resolv.conf\"\nUSER lthn\nWORKDIR /usr/src/lethean-vpn/\nRUN chmod +x configure.sh ; ./configure.sh --runas-user lthn --runas-group lthn --client\nRUN make install SERVER=1 CLIENT=1\nRUN rm -rf /opt/lthn/etc/ca /opt/lthn/etc/*.ini /opt/lthn/etc/*.json /opt/lthn/etc/*.pem /opt/lthn/etc/*.tlsauth /opt/lthn/etc/*.keys /opt/lthn/etc/provider* /opt/lthn/var/* /usr/src/lethean-vpn/build /usr/src/lethean-vpn/env.mk ; mkdir -p /opt/lthn/var/log /opt/lthn/var/run\nWORKDIR /home/lthn\n","injectedSmells":[],"originalDockerfileHash":"518780a42d26e3665ffff35df1af03c4","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM python:3.7.1-stretch\nMAINTAINER Lukas Macura <lukas@lethean.io>\nLABEL io.lethean.vpn-server=\"Lethean.IO\"\nLABEL version=\"1.0\"\nLABEL description=\"Letehan.io VPN server\"\nARG DAEMON_BIN_URL=\"https://github.com/LetheanMovement/lethean/releases/download/v3.1.0/lethean-cli-linux-64bit-v3.1.tar.bz2\"\nARG DAEMON_HOST=\"sync.lethean.io\"\nARG PORT=\"8080\"\nARG ZSYNC_URL=\"https://monitor.lethean.io/bc/data.mdb.zsync\"\nARG ZSYNC_DATA_URL=\"http://monitor.lethean.io/bc/data.mdb\"\nARG ZSYNC_DATA_SHA=\"http://monitor.lethean.io/bc/data.mdb.sha256\"\nENV LTHNPREFIX=\"/opt/lthn\"\n#   Daemon host. Set to empty string to use local daemon with complete copy of blockchain.\nENV DAEMON_HOST=\"$DAEMON_HOST\"\n#   Wallet file. It is relative to etc directory.\nENV WALLET_FILE=\"vpn\"\n#   If you want to use external wallet, set this to RPC of external wallet host\nENV WALLET_RPC_URI=\"\"\n#   Wallet password. Default is to generate random password\nENV WALLET_PASSWORD=\"\"\n#   Wallet RPC password. Default is to generate random password. Username used by dispatcher is 'dispatcher'\nENV WALLET_RPC_PASSWORD=\"\"\n#   To restore wallet from this height. Only applicable for local wallet.\nENV WALLET_RESTORE_HEIGHT=\"349516\"\n#   CA password. Default to generate random password\nENV CA_PASSWORD=\"\"\n#   Common Name for CN\nENV CA_CN=\"LTHNEasyDeploy\"\n#   If you already have providerid. In other case, autogenerate\nENV PROVIDER_ID=\"\"\n#   If you already have providerkey. In other case, autogenerate\nENV PROVIDER_KEY=\"\"\n#   Provider name\nENV PROVIDER_NAME=\"EasyProvider\"\n#   Provider type\nENV PROVIDER_TYPE=\"residential\"\n#   Service endpoint. You need to change this in SDP later\nENV ENDPOINT=\"127.0.0.1\"\n#   Service port\nENV PORT=\"$PORT\"\n#   Zabbix parameters\nENV ZABBIX_SERVER=\"zabbix\"\nENV ZABBIX_HOSTNAME=\"lethean-vpn\"\nENV ZABBIX_META=\"LETHEANNODE\"\nENV ZSYNC_URL=\"$ZSYNC_URL\"\nENV ZSYNC_DATA_URL=\"$ZSYNC_DATA_URL\"\nENV ZSYNC_DATA_SHA=\"$ZSYNC_DATA_SHA\"\nENTRYPOINT [\"/entrypiont-lethean-vpn.sh\"]\nCMD [\"run\"]\nRUN useradd -ms /bin/bash lthn ; apt-get update ; apt-get install sudo joe less haproxy openvpn squid net-tools wget stunnel zsync pwgen -y ; echo \"lthn ALL=(ALL) NOPASSWD: ALL\" > /etc/sudoers; mkdir /usr/src/lethean-vpn ; chown -R lthn /usr/src/lethean-vpn\nWORKDIR /usr/src/lethean-vpn/build\nRUN wget -nc -c $DAEMON_BIN_URL \\\n && tar --strip-components 1 -C /usr/bin/ -xjvf $( basename $DAEMON_BIN_URL ;)\nRUN wget https://repo.zabbix.com/zabbix/4.0/debian/pool/main/z/zabbix-release/zabbix-release_4.0-2+stretch_all.deb \\\n && dpkg -i zabbix-release_4.0-2+stretch_all.deb\nRUN apt-get update \\\n && apt-get install zabbix-agent zabbix-sender -y \\\n && mkdir /var/run/zabbix \\\n && chown -R lthn /var/log/zabbix /var/run/zabbix\nRUN sed -i \"s/Hostname=(.*)/Hostname=$ZABBIX_HOSTNAME/\" /etc/zabbix/zabbix_agentd.conf ; sed -i \"s/Server=(.*)/Server=$ZABBIX_SERVER/\" /etc/zabbix/zabbix_agentd.conf ; sed -i \"s/ServerActive=(.*)/ServerActive=$ZABBIX_SERVER/\" /etc/zabbix/zabbix_agentd.conf ; sed -i \"s/Hostname=(.*)/Hostname=$ZABBIX_HOSTNAME/\" /etc/zabbix/zabbix_agentd.conf ; sed -i \"s/HostMetadata=(.*)/HostMetadata=$ZABBIX_META/\" /etc/zabbix/zabbix_agentd.conf\nUSER root\nCOPY ./ /usr/src/lethean-vpn/\nRUN rm -rf /usr/src/lethean-vpn/build/\nRUN pip3 install -r /usr/src/lethean-vpn/requirements.txt\nCOPY ./server/docker-run.sh /entrypiont-lethean-vpn.sh\nRUN chown -R lthn /usr/src/ ; chmod +x /entrypiont-lethean-vpn.sh ; chmod +x /usr/src/lethean-vpn/install.sh\nRUN echo -e \"domain lthn.local\\nsearch lthn.local\\nnameserver 127.0.0.1\\n >/etc/resolv.conf\"\nUSER lthn\nWORKDIR /usr/src/lethean-vpn/\nRUN chmod +x configure.sh ; ./configure.sh --runas-user lthn --runas-group lthn --client\nRUN make install SERVER=1 CLIENT=1\nRUN rm -rf /opt/lthn/etc/ca /opt/lthn/etc/*.ini /opt/lthn/etc/*.json /opt/lthn/etc/*.pem /opt/lthn/etc/*.tlsauth /opt/lthn/etc/*.keys /opt/lthn/etc/provider* /opt/lthn/var/* /usr/src/lethean-vpn/build /usr/src/lethean-vpn/env.mk ; mkdir -p /opt/lthn/var/log /opt/lthn/var/run\nWORKDIR /home/lthn\n","originalDockerfileUglifiedHash":"7aa20c5238c8aadfa8a2b38d2ba0a97b","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/0bb84b0381c4203ef5046e006d0322e2a0c5a31f.dockerfile"}