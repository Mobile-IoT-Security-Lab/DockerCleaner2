{"seed":66838937,"processedDockerfileHash":"7dbb90d326c9c5836af08c5b4869c4e0","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","have-a-healthcheck","have-a-user"],"processedDockerfile":"#\n#      Copyright 2019 EPAM Systems\n#\n#      Licensed under the Apache License, Version 2.0 (the \"License\");\n#      you may not use this file except in compliance with the License.\n#      You may obtain a copy of the License at\n#\n#         http://www.apache.org/licenses/LICENSE-2.0\n#\n#      Unless required by applicable law or agreed to in writing, software\n#      distributed under the License is distributed on an \"AS IS\" BASIS,\n#      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n#      See the License for the specific language governing permissions and\n#      limitations under the License.\n#\nFROM golang:1.11.6-alpine3.9 AS builder\nENV OPERATOR_DIR=\"/go/src/github.com/legion-platform/legion/legion/operator\"\nWORKDIR \"${OPERATOR_DIR}\"\nRUN apk add ca-certificates git gcc musl-dev make -u \\\n && wget https://github.com/golang/dep/releases/download/v0.5.1/dep-linux-amd64 -O /usr/local/bin/dep \\\n && chmod +x /usr/local/bin/dep \\\n && wget https://github.com/kubernetes-sigs/kubebuilder/releases/download/v1.0.8/kubebuilder_1.0.8_linux_amd64.tar.gz -O /tmp/kubebuilder.tar.gz \\\n && tar -zxvf /tmp/kubebuilder.tar.gz -C /usr/local/ \\\n && mv /usr/local/kubebuilder_* /usr/local/kubebuilder \\\n && wget https://github.com/swaggo/swag/releases/download/v1.5.0/swag_1.5.0_Linux_x86_64.tar.gz -O /tmp/swag.tar.gz \\\n && tar -zxvf /tmp/swag.tar.gz -C /usr/local/ \\\n && mv /usr/local/swag /usr/bin/ \\\n && wget https://github.com/gotestyourself/gotestsum/releases/download/v0.3.4/gotestsum_0.3.4_linux_amd64.tar.gz -O /tmp/gotestsum.tar.gz \\\n && tar -zxvf /tmp/gotestsum.tar.gz -C /usr/local/ \\\n && mv /usr/local/gotestsum* /usr/bin/gotestsum \\\n && go get github.com/t-yuki/gocover-cobertura\nCOPY legion/operator/Gopkg.toml legion/operator/Gopkg.lock ./\nRUN dep ensure -vendor-only\nCOPY legion/operator/ ./\nRUN GOOS=linux GOARCH=amd64 make build-all \\\n && make test\n#  ########################################################\n#  ########################################################\n#  ########################################################\nFROM alpine:3.9 AS operator\nENV LEGION_DIR=\"/opt/legion\"\nRUN apk add openssh-client ca-certificates -u\nCOPY --from=builder /go/src/github.com/legion-platform/legion/legion/operator/operator \"${LEGION_DIR}/\"\nWORKDIR \"${LEGION_DIR}\"\nCMD [\"./operator\"]\n#  ########################################################\n#  ########################################################\n#  ########################################################\nFROM alpine:3.9 AS edi\nENV LEGION_DIR=\"/opt/legion\" \\\n    TEMPLATE_FOLDER=\"/opt/legion/templates\" \\\n    GIN_MODE=\"release\"\nRUN apk add ca-certificates -u\nCOPY --from=builder /go/src/github.com/legion-platform/legion/legion/operator/edi \"${LEGION_DIR}/\"\nCOPY legion/operator/templates \"${TEMPLATE_FOLDER}/\"\nWORKDIR \"${LEGION_DIR}\"\nCMD [\"./edi\"]\n#  ########################################################\n#  ########################################################\n#  ########################################################\nFROM python:3.6.8-alpine3.9 AS model-builder\nENV LEGION_DIR=\"/opt/legion\" \\\n    LC_ALL=\"C.UTF-8\" \\\n    LANG=\"C.UTF-8\" \\\n    LANGUAGE=\"C.UTF-8\"\nRUN pip install pip==18.1 pipenv==2018.10.13 --disable-pip-version-check --upgrade \\\n && apk add openssh-client ca-certificates -u\nCOPY legion/sdk/Pipfile legion/sdk/Pipfile.lock \"${LEGION_DIR}/sdk/\"/\nRUN cd \"${LEGION_DIR}/sdk\" \\\n && pipenv install --system --three\nCOPY legion/cli/Pipfile legion/cli/Pipfile.lock \"${LEGION_DIR}/cli/\"/\nRUN cd \"${LEGION_DIR}/cli\" \\\n && pipenv install --system --three\nCOPY legion/sdk \"${LEGION_DIR}/sdk\"\nCOPY legion/cli \"${LEGION_DIR}/cli\"\nRUN pip install --no-deps -e \"${LEGION_DIR}/sdk\" \\\n && pip install --no-deps -e \"${LEGION_DIR}/cli\"\nCOPY --from=builder /go/src/github.com/legion-platform/legion/legion/operator/builder \"${LEGION_DIR}/\"\nWORKDIR \"${LEGION_DIR}\"\nCMD [\"./builder\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#\n#     Copyright 2019 EPAM Systems\n#\n#     Licensed under the Apache License, Version 2.0 (the \"License\");\n#     you may not use this file except in compliance with the License.\n#     You may obtain a copy of the License at\n#\n#        http://www.apache.org/licenses/LICENSE-2.0\n#\n#     Unless required by applicable law or agreed to in writing, software\n#     distributed under the License is distributed on an \"AS IS\" BASIS,\n#     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n#     See the License for the specific language governing permissions and\n#     limitations under the License.\n#\nFROM golang:1.11.6-alpine3.9 AS builder\nENV OPERATOR_DIR=\"/go/src/github.com/legion-platform/legion/legion/operator\"\nWORKDIR \"${OPERATOR_DIR}\"\nRUN apk add -u ca-certificates git gcc musl-dev make \\\n && wget https://github.com/golang/dep/releases/download/v0.5.1/dep-linux-amd64 -O /usr/local/bin/dep \\\n && chmod +x /usr/local/bin/dep \\\n && wget https://github.com/kubernetes-sigs/kubebuilder/releases/download/v1.0.8/kubebuilder_1.0.8_linux_amd64.tar.gz -O /tmp/kubebuilder.tar.gz \\\n && tar -zxvf /tmp/kubebuilder.tar.gz -C /usr/local/ \\\n && mv /usr/local/kubebuilder_* /usr/local/kubebuilder \\\n && wget https://github.com/swaggo/swag/releases/download/v1.5.0/swag_1.5.0_Linux_x86_64.tar.gz -O /tmp/swag.tar.gz \\\n && tar -zxvf /tmp/swag.tar.gz -C /usr/local/ \\\n && mv /usr/local/swag /usr/bin/ \\\n && wget https://github.com/gotestyourself/gotestsum/releases/download/v0.3.4/gotestsum_0.3.4_linux_amd64.tar.gz -O /tmp/gotestsum.tar.gz \\\n && tar -zxvf /tmp/gotestsum.tar.gz -C /usr/local/ \\\n && mv /usr/local/gotestsum* /usr/bin/gotestsum \\\n && go get github.com/t-yuki/gocover-cobertura\nCOPY legion/operator/Gopkg.toml legion/operator/Gopkg.lock ./\nRUN dep ensure -vendor-only\nCOPY legion/operator/ ./\nRUN GOOS=linux GOARCH=amd64 make build-all \\\n && make test\n# ########################################################\n# ########################################################\n# ########################################################\nFROM alpine:3.9 AS operator\nENV LEGION_DIR=\"/opt/legion\"\nRUN apk add -u openssh-client ca-certificates\nCOPY --from=builder /go/src/github.com/legion-platform/legion/legion/operator/operator \"${LEGION_DIR}/\"\nWORKDIR \"${LEGION_DIR}\"\nCMD [\"./operator\"]\n# ########################################################\n# ########################################################\n# ########################################################\nFROM alpine:3.9 AS edi\nENV LEGION_DIR=\"/opt/legion\" \\\n    TEMPLATE_FOLDER=\"/opt/legion/templates\" \\\n    GIN_MODE=\"release\"\nRUN apk add -u ca-certificates\nCOPY --from=builder /go/src/github.com/legion-platform/legion/legion/operator/edi \"${LEGION_DIR}/\"\nCOPY legion/operator/templates \"${TEMPLATE_FOLDER}/\"\nWORKDIR \"${LEGION_DIR}\"\nCMD [\"./edi\"]\n# ########################################################\n# ########################################################\n# ########################################################\nFROM python:3.6.8-alpine3.9 AS model-builder\nENV LEGION_DIR=\"/opt/legion\" \\\n    LC_ALL=\"C.UTF-8\" \\\n    LANG=\"C.UTF-8\" \\\n    LANGUAGE=\"C.UTF-8\"\nRUN pip install pip==18.1 pipenv==2018.10.13 --disable-pip-version-check --upgrade \\\n && apk add -u openssh-client ca-certificates\nCOPY legion/sdk/Pipfile legion/sdk/Pipfile.lock \"${LEGION_DIR}/sdk/\"/\nRUN cd \"${LEGION_DIR}/sdk\" \\\n && pipenv install --system --three\nCOPY legion/cli/Pipfile legion/cli/Pipfile.lock \"${LEGION_DIR}/cli/\"/\nRUN cd \"${LEGION_DIR}/cli\" \\\n && pipenv install --system --three\nCOPY legion/sdk \"${LEGION_DIR}/sdk\"\nCOPY legion/cli \"${LEGION_DIR}/cli\"\nRUN pip install --no-deps -e \"${LEGION_DIR}/sdk\" \\\n && pip install --no-deps -e \"${LEGION_DIR}/cli\"\nCOPY --from=builder /go/src/github.com/legion-platform/legion/legion/operator/builder \"${LEGION_DIR}/\"\nWORKDIR \"${LEGION_DIR}\"\nCMD [\"./builder\"]\n","injectedSmells":[],"originalDockerfileHash":"6e62ff8b3b8ed224fbd5e13f03fbe199","successfullyInjectedSmells":[],"originalDockerfileUglified":"#\n#      Copyright 2019 EPAM Systems\n#\n#      Licensed under the Apache License, Version 2.0 (the \"License\");\n#      you may not use this file except in compliance with the License.\n#      You may obtain a copy of the License at\n#\n#         http://www.apache.org/licenses/LICENSE-2.0\n#\n#      Unless required by applicable law or agreed to in writing, software\n#      distributed under the License is distributed on an \"AS IS\" BASIS,\n#      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n#      See the License for the specific language governing permissions and\n#      limitations under the License.\n#\nFROM golang:1.11.6-alpine3.9 AS builder\nENV OPERATOR_DIR=\"/go/src/github.com/legion-platform/legion/legion/operator\"\nWORKDIR \"${OPERATOR_DIR}\"\nRUN apk add -u ca-certificates git gcc musl-dev make \\\n && wget https://github.com/golang/dep/releases/download/v0.5.1/dep-linux-amd64 -O /usr/local/bin/dep \\\n && chmod +x /usr/local/bin/dep \\\n && wget https://github.com/kubernetes-sigs/kubebuilder/releases/download/v1.0.8/kubebuilder_1.0.8_linux_amd64.tar.gz -O /tmp/kubebuilder.tar.gz \\\n && tar -zxvf /tmp/kubebuilder.tar.gz -C /usr/local/ \\\n && mv /usr/local/kubebuilder_* /usr/local/kubebuilder \\\n && wget https://github.com/swaggo/swag/releases/download/v1.5.0/swag_1.5.0_Linux_x86_64.tar.gz -O /tmp/swag.tar.gz \\\n && tar -zxvf /tmp/swag.tar.gz -C /usr/local/ \\\n && mv /usr/local/swag /usr/bin/ \\\n && wget https://github.com/gotestyourself/gotestsum/releases/download/v0.3.4/gotestsum_0.3.4_linux_amd64.tar.gz -O /tmp/gotestsum.tar.gz \\\n && tar -zxvf /tmp/gotestsum.tar.gz -C /usr/local/ \\\n && mv /usr/local/gotestsum* /usr/bin/gotestsum \\\n && go get github.com/t-yuki/gocover-cobertura\nCOPY legion/operator/Gopkg.toml legion/operator/Gopkg.lock ./\nRUN dep ensure -vendor-only\nCOPY legion/operator/ ./\nRUN GOOS=linux GOARCH=amd64 make build-all \\\n && make test\n#  ########################################################\n#  ########################################################\n#  ########################################################\nFROM alpine:3.9 AS operator\nENV LEGION_DIR=\"/opt/legion\"\nRUN apk add -u openssh-client ca-certificates\nCOPY --from=builder /go/src/github.com/legion-platform/legion/legion/operator/operator \"${LEGION_DIR}/\"\nWORKDIR \"${LEGION_DIR}\"\nCMD [\"./operator\"]\n#  ########################################################\n#  ########################################################\n#  ########################################################\nFROM alpine:3.9 AS edi\nENV LEGION_DIR=\"/opt/legion\" \\\n    TEMPLATE_FOLDER=\"/opt/legion/templates\" \\\n    GIN_MODE=\"release\"\nRUN apk add -u ca-certificates\nCOPY --from=builder /go/src/github.com/legion-platform/legion/legion/operator/edi \"${LEGION_DIR}/\"\nCOPY legion/operator/templates \"${TEMPLATE_FOLDER}/\"\nWORKDIR \"${LEGION_DIR}\"\nCMD [\"./edi\"]\n#  ########################################################\n#  ########################################################\n#  ########################################################\nFROM python:3.6.8-alpine3.9 AS model-builder\nENV LEGION_DIR=\"/opt/legion\" \\\n    LC_ALL=\"C.UTF-8\" \\\n    LANG=\"C.UTF-8\" \\\n    LANGUAGE=\"C.UTF-8\"\nRUN pip install pip==18.1 pipenv==2018.10.13 --disable-pip-version-check --upgrade \\\n && apk add -u openssh-client ca-certificates\nCOPY legion/sdk/Pipfile legion/sdk/Pipfile.lock \"${LEGION_DIR}/sdk/\"/\nRUN cd \"${LEGION_DIR}/sdk\" \\\n && pipenv install --system --three\nCOPY legion/cli/Pipfile legion/cli/Pipfile.lock \"${LEGION_DIR}/cli/\"/\nRUN cd \"${LEGION_DIR}/cli\" \\\n && pipenv install --system --three\nCOPY legion/sdk \"${LEGION_DIR}/sdk\"\nCOPY legion/cli \"${LEGION_DIR}/cli\"\nRUN pip install --no-deps -e \"${LEGION_DIR}/sdk\" \\\n && pip install --no-deps -e \"${LEGION_DIR}/cli\"\nCOPY --from=builder /go/src/github.com/legion-platform/legion/legion/operator/builder \"${LEGION_DIR}/\"\nWORKDIR \"${LEGION_DIR}\"\nCMD [\"./builder\"]\n","originalDockerfileUglifiedHash":"872953f248a1337c6c3a3998249ba236","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/2b09fd155edf02c27a471b659c17ce9fff5c73ef.dockerfile"}