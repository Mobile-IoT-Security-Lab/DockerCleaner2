{"seed":2874478969,"processedDockerfileHash":"abe76a1d0a6f14a92e963fe4571bd960","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-npm","pin-package-manager-versions-apk","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM alpine:edge\nMAINTAINER JAremko <w3techplaygound@gmail.com>\n#   Kudos to @urzds for Xpra building example\n#   NOTE: Don't forget to update xpra_sha file:\n#         sha1sum  \"xpra-${XPRA_VERSION}.tar.xz\" > xpra_sha\nENV XPRA_VERSION=\"2.5\"\nCOPY video_dummy_patches /tmp/video_dummy_patches\nCOPY xpra_sha /tmp/\nRUN echo \"http://nl.alpinelinux.org/alpine/edge/testing\" >> /etc/apk/repositories \\\n && echo \"http://nl.alpinelinux.org/alpine/edge/community\" >> /etc/apk/repositories \\\n && apk --no-cache upgrade \\\n && apk add bash=5.2.15-r2 curl=8.0.1-r1 dbus-x11=1.14.6-r1 ffmpeg=6.0-r9 gstreamer=1.22.1-r0 libvpx=1.13.0-r1 libxcomposite=0.4.6-r1 libxdamage=1.1.6-r0 libxext=1.3.5-r0 libxfixes=6.0.1-r0 libxkbfile=1.1.2-r0 libxrandr=1.5.3-r0 libxtst=1.2.4-r1 lz4=1.9.4-r1 lzo=2.10-r3 openrc=0.46-r3 openssh=9.3_p1-r1 openssl=3.1.0-r2 py-asn1 py-cffi py-cryptography py-dbus py-enum34 py-gobject3 py-gtk py-gtkglext py-idna py-ipaddress py-lz4 py-netifaces py-numpy py-pillow py-pycryptodome py-rencode py-six py2-xxhash shared-mime-info=2.2-r2 websockify x264=0.164_git20220602-r1 xhost=1.0.9-r0 xorg-server=21.1.8-r0 --no-cache \\\n && apk add autoconf=2.71-r2 automake=1.16.5-r2 build-base=0.5-r3 coreutils=9.2-r2 cython-dev ffmpeg-dev=6.0-r9 flac-dev=1.4.2-r1 git=2.40.0-r0 libc-dev=0.7.2-r4 libtool=2.4.7-r1 libvpx-dev=1.13.0-r1 libxcomposite-dev=0.4.6-r1 libxdamage-dev=1.1.6-r0 libxext-dev=1.3.5-r0 libxfixes-dev=6.0.1-r0 libxi-dev=1.8-r0 libxkbfile-dev=1.1.2-r0 libxrandr-dev=1.5.3-r0 libxtst-dev=1.2.4-r1 linux-headers=6.2-r0 lz4-dev=1.9.4-r1 musl-utils=1.2.3_git20230322-r0 npm=9.6.4-r0 opus-dev=1.3.1-r1 py-dbus-dev py-gtk-dev py-gtkglext-dev py-numpy-dev py-yuicompressor py2-pip python-dev util-macros=1.20.0-r0 which=2.21-r3 x264-dev=0.164_git20220602-r1 xorg-server-dev=21.1.8-r0 xorgproto=2022.2-r0 xvidcore-dev=1.3.7-r1 xz=5.4.2-r0 --no-cache --virtual build-deps \\\n && npm install uglify-js@2 -g \\\n && cd /tmp \\\n && curl http://www.xpra.org/src/xpra-$XPRA_VERSION.tar.xz -o xpra.tar.xz \\\n && sha1sum -c xpra_sha \\\n && tar -xf \"xpra.tar.xz\" \\\n && cd \"xpra-${XPRA_VERSION}\" \\\n && echo -e 'Section \"Module\"\\n Load \"fb\"\\n EndSection' >> etc/xpra/xorg.conf \\\n && python2 setup.py install --verbose --with-Xdummy --with-Xdummy_wrapper --with-bencode --with-clipboard --with-csc_swscale --with-cython_bencode --with-dbus --with-enc_ffmpeg --with-enc_x264 --with-gtk2 --with-gtk_x11 --with-pillow --with-server --with-vpx --with-vsock --with-x11 --without-client --without-csc_libyuv --without-cuda_kernels --without-cuda_rebuild --without-dec_avcodec2 --without-enc_x265 --without-gtk3 --without-mdns --without-opengl --without-printing --without-sound --without-strict --without-uinput --without-webcam \\\n && mkdir -p /var/run/xpra/ \\\n && cd /tmp \\\n && git clone https://github.com/ncopa/su-exec.git /tmp/su-exec \\\n && cd /tmp/su-exec \\\n && make \\\n && chmod 770 su-exec \\\n && mv su-exec /usr/sbin/ \\\n && git clone https://github.com/JAremko/xf86-video-dummy.git /tmp/xf86-video-dummy \\\n && cd /tmp/xf86-video-dummy \\\n && git apply /tmp/video_dummy_patches/Constant-DPI.patch /tmp/video_dummy_patches/fix-pointer-limits.patch /tmp/video_dummy_patches/30-bit-depth.patch \\\n && aclocal \\\n && autoconf \\\n && automake --add-missing --force-missing \\\n && ./configure \\\n && make \\\n && make install \\\n && mv /usr/local/lib/xorg/modules/drivers/dummy_drv.so /usr/lib/xorg/modules/drivers/ \\\n && apk del build-deps \\\n && rm -rf /var/cache/* /tmp/* /var/log/* ~/.cache \\\n && mkdir -p /var/cache/apk \\\n && mkdir -p /var/run/sshd \\\n && chmod 0755 /var/run/sshd \\\n && rc-update add sshd \\\n && rc-status \\\n && touch /run/openrc/softlevel \\\n && /etc/init.d/sshd start > /dev/null 2>&1 \\\n && /etc/init.d/sshd stop > /dev/null 2>&1\n#   docker run ... --volumes-from <ME> -e DISPLAY=<MY_DISPLAY> ... firefox\nVOLUME /tmp/.X11-unix\n#   Mount <some_ssh_key>.pub in here to enable xpra via ssh\nVOLUME /etc/pub-keys\nCOPY bin/* /usr/local/bin/\nENV DISPLAY=\":14\" \\\n    SHELL=\"/bin/bash\" \\\n    SSHD_PORT=\"22\" \\\n    START_XORG=\"yes\" \\\n    XPRA_HTML=\"no\" \\\n    XPRA_MODE=\"start\" \\\n    XPRA_READONLY=\"no\" \\\n    XORG_DPI=\"96\" \\\n    XPRA_COMPRESS=\"0\" \\\n    XPRA_DPI=\"0\" \\\n    XPRA_ENCODING=\"rgb\" \\\n    XPRA_HTML_DPI=\"96\" \\\n    XPRA_KEYBOARD_SYNC=\"yes\" \\\n    XPRA_MMAP=\"yes\" \\\n    XPRA_SHARING=\"yes\" \\\n    XPRA_TCP_PORT=\"10000\"\nENV GID=\"1000\" \\\n    GNAME=\"xpra\" \\\n    SHELL=\"/bin/bash\" \\\n    UHOME=\"/home/xpra\" \\\n    UID=\"1000\" \\\n    UNAME=\"xpra\"\nEXPOSE $SSHD_PORT $XPRA_TCP_PORT\nENTRYPOINT [\"/usr/local/bin/run\"]\nCMD [\"xhost\", \"+\"]\nRUN addgroup -S docker-user ; adduser -S -G docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM alpine:edge\nMAINTAINER JAremko <w3techplaygound@gmail.com>\n#  Kudos to @urzds for Xpra building example\n#  NOTE: Don't forget to update xpra_sha file:\n#        sha1sum  \"xpra-${XPRA_VERSION}.tar.xz\" > xpra_sha\nENV XPRA_VERSION=\"2.5\"\nCOPY video_dummy_patches /tmp/video_dummy_patches\nCOPY xpra_sha /tmp/\nRUN echo \"http://nl.alpinelinux.org/alpine/edge/testing\" >> /etc/apk/repositories \\\n && echo \"http://nl.alpinelinux.org/alpine/edge/community\" >> /etc/apk/repositories \\\n && apk --no-cache upgrade \\\n && apk --no-cache add bash curl dbus-x11 ffmpeg gstreamer libvpx libxcomposite libxdamage libxext libxfixes libxkbfile libxrandr libxtst lz4 lzo openrc openssh openssl py-asn1 py-cffi py-cryptography py-dbus py-enum34 py-gobject3 py-gtk py-gtkglext py-idna py-ipaddress py-lz4 py-netifaces py-numpy py-pillow py-pycryptodome py-rencode py-six py2-xxhash shared-mime-info websockify x264 xhost xorg-server \\\n && apk --no-cache add --virtual build-deps autoconf automake build-base coreutils cython-dev ffmpeg-dev flac-dev git libc-dev libtool libvpx-dev libxcomposite-dev libxdamage-dev libxext-dev libxfixes-dev libxi-dev libxkbfile-dev libxrandr-dev libxtst-dev linux-headers lz4-dev musl-utils npm opus-dev py-dbus-dev py-gtk-dev py-gtkglext-dev py-numpy-dev py-yuicompressor py2-pip python-dev util-macros which x264-dev xorg-server-dev xorgproto xvidcore-dev xz \\\n && npm install uglify-js@2 -g \\\n && cd /tmp \\\n && curl http://www.xpra.org/src/xpra-$XPRA_VERSION.tar.xz -o xpra.tar.xz \\\n && sha1sum -c xpra_sha \\\n && tar -xf \"xpra.tar.xz\" \\\n && cd \"xpra-${XPRA_VERSION}\" \\\n && echo -e 'Section \"Module\"\\n Load \"fb\"\\n EndSection' >> etc/xpra/xorg.conf \\\n && python2 setup.py install --verbose --with-Xdummy --with-Xdummy_wrapper --with-bencode --with-clipboard --with-csc_swscale --with-cython_bencode --with-dbus --with-enc_ffmpeg --with-enc_x264 --with-gtk2 --with-gtk_x11 --with-pillow --with-server --with-vpx --with-vsock --with-x11 --without-client --without-csc_libyuv --without-cuda_kernels --without-cuda_rebuild --without-dec_avcodec2 --without-enc_x265 --without-gtk3 --without-mdns --without-opengl --without-printing --without-sound --without-strict --without-uinput --without-webcam \\\n && mkdir -p /var/run/xpra/ \\\n && cd /tmp \\\n && git clone https://github.com/ncopa/su-exec.git /tmp/su-exec \\\n && cd /tmp/su-exec \\\n && make \\\n && chmod 770 su-exec \\\n && mv su-exec /usr/sbin/ \\\n && git clone https://github.com/JAremko/xf86-video-dummy.git /tmp/xf86-video-dummy \\\n && cd /tmp/xf86-video-dummy \\\n && git apply /tmp/video_dummy_patches/Constant-DPI.patch /tmp/video_dummy_patches/fix-pointer-limits.patch /tmp/video_dummy_patches/30-bit-depth.patch \\\n && aclocal \\\n && autoconf \\\n && automake --add-missing --force-missing \\\n && ./configure \\\n && make \\\n && make install \\\n && mv /usr/local/lib/xorg/modules/drivers/dummy_drv.so /usr/lib/xorg/modules/drivers/ \\\n && apk del build-deps \\\n && rm -rf /var/cache/* /tmp/* /var/log/* ~/.cache \\\n && mkdir -p /var/cache/apk \\\n && mkdir -p /var/run/sshd \\\n && chmod 0755 /var/run/sshd \\\n && rc-update add sshd \\\n && rc-status \\\n && touch /run/openrc/softlevel \\\n && /etc/init.d/sshd start > /dev/null 2>&1 \\\n && /etc/init.d/sshd stop > /dev/null 2>&1\n#  docker run ... --volumes-from <ME> -e DISPLAY=<MY_DISPLAY> ... firefox\nVOLUME /tmp/.X11-unix\n#  Mount <some_ssh_key>.pub in here to enable xpra via ssh\nVOLUME /etc/pub-keys\nCOPY bin/* /usr/local/bin/\nENV DISPLAY=\":14\" \\\n    SHELL=\"/bin/bash\" \\\n    SSHD_PORT=\"22\" \\\n    START_XORG=\"yes\" \\\n    XPRA_HTML=\"no\" \\\n    XPRA_MODE=\"start\" \\\n    XPRA_READONLY=\"no\" \\\n    XORG_DPI=\"96\" \\\n    XPRA_COMPRESS=\"0\" \\\n    XPRA_DPI=\"0\" \\\n    XPRA_ENCODING=\"rgb\" \\\n    XPRA_HTML_DPI=\"96\" \\\n    XPRA_KEYBOARD_SYNC=\"yes\" \\\n    XPRA_MMAP=\"yes\" \\\n    XPRA_SHARING=\"yes\" \\\n    XPRA_TCP_PORT=\"10000\"\nENV GID=\"1000\" \\\n    GNAME=\"xpra\" \\\n    SHELL=\"/bin/bash\" \\\n    UHOME=\"/home/xpra\" \\\n    UID=\"1000\" \\\n    UNAME=\"xpra\"\nEXPOSE $SSHD_PORT $XPRA_TCP_PORT\nENTRYPOINT [\"/usr/local/bin/run\"]\nCMD [\"xhost\", \"+\"]\n","injectedSmells":[],"originalDockerfileHash":"cc6df3ea11d79df1e1f19dcdab551179","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM alpine:edge\nMAINTAINER JAremko <w3techplaygound@gmail.com>\n#   Kudos to @urzds for Xpra building example\n#   NOTE: Don't forget to update xpra_sha file:\n#         sha1sum  \"xpra-${XPRA_VERSION}.tar.xz\" > xpra_sha\nENV XPRA_VERSION=\"2.5\"\nCOPY video_dummy_patches /tmp/video_dummy_patches\nCOPY xpra_sha /tmp/\nRUN echo \"http://nl.alpinelinux.org/alpine/edge/testing\" >> /etc/apk/repositories \\\n && echo \"http://nl.alpinelinux.org/alpine/edge/community\" >> /etc/apk/repositories \\\n && apk --no-cache upgrade \\\n && apk --no-cache add bash curl dbus-x11 ffmpeg gstreamer libvpx libxcomposite libxdamage libxext libxfixes libxkbfile libxrandr libxtst lz4 lzo openrc openssh openssl py-asn1 py-cffi py-cryptography py-dbus py-enum34 py-gobject3 py-gtk py-gtkglext py-idna py-ipaddress py-lz4 py-netifaces py-numpy py-pillow py-pycryptodome py-rencode py-six py2-xxhash shared-mime-info websockify x264 xhost xorg-server \\\n && apk --no-cache add --virtual build-deps autoconf automake build-base coreutils cython-dev ffmpeg-dev flac-dev git libc-dev libtool libvpx-dev libxcomposite-dev libxdamage-dev libxext-dev libxfixes-dev libxi-dev libxkbfile-dev libxrandr-dev libxtst-dev linux-headers lz4-dev musl-utils npm opus-dev py-dbus-dev py-gtk-dev py-gtkglext-dev py-numpy-dev py-yuicompressor py2-pip python-dev util-macros which x264-dev xorg-server-dev xorgproto xvidcore-dev xz \\\n && npm install uglify-js@2 -g \\\n && cd /tmp \\\n && curl http://www.xpra.org/src/xpra-$XPRA_VERSION.tar.xz -o xpra.tar.xz \\\n && sha1sum -c xpra_sha \\\n && tar -xf \"xpra.tar.xz\" \\\n && cd \"xpra-${XPRA_VERSION}\" \\\n && echo -e 'Section \"Module\"\\n Load \"fb\"\\n EndSection' >> etc/xpra/xorg.conf \\\n && python2 setup.py install --verbose --with-Xdummy --with-Xdummy_wrapper --with-bencode --with-clipboard --with-csc_swscale --with-cython_bencode --with-dbus --with-enc_ffmpeg --with-enc_x264 --with-gtk2 --with-gtk_x11 --with-pillow --with-server --with-vpx --with-vsock --with-x11 --without-client --without-csc_libyuv --without-cuda_kernels --without-cuda_rebuild --without-dec_avcodec2 --without-enc_x265 --without-gtk3 --without-mdns --without-opengl --without-printing --without-sound --without-strict --without-uinput --without-webcam \\\n && mkdir -p /var/run/xpra/ \\\n && cd /tmp \\\n && git clone https://github.com/ncopa/su-exec.git /tmp/su-exec \\\n && cd /tmp/su-exec \\\n && make \\\n && chmod 770 su-exec \\\n && mv su-exec /usr/sbin/ \\\n && git clone https://github.com/JAremko/xf86-video-dummy.git /tmp/xf86-video-dummy \\\n && cd /tmp/xf86-video-dummy \\\n && git apply /tmp/video_dummy_patches/Constant-DPI.patch /tmp/video_dummy_patches/fix-pointer-limits.patch /tmp/video_dummy_patches/30-bit-depth.patch \\\n && aclocal \\\n && autoconf \\\n && automake --add-missing --force-missing \\\n && ./configure \\\n && make \\\n && make install \\\n && mv /usr/local/lib/xorg/modules/drivers/dummy_drv.so /usr/lib/xorg/modules/drivers/ \\\n && apk del build-deps \\\n && rm -rf /var/cache/* /tmp/* /var/log/* ~/.cache \\\n && mkdir -p /var/cache/apk \\\n && mkdir -p /var/run/sshd \\\n && chmod 0755 /var/run/sshd \\\n && rc-update add sshd \\\n && rc-status \\\n && touch /run/openrc/softlevel \\\n && /etc/init.d/sshd start > /dev/null 2>&1 \\\n && /etc/init.d/sshd stop > /dev/null 2>&1\n#   docker run ... --volumes-from <ME> -e DISPLAY=<MY_DISPLAY> ... firefox\nVOLUME /tmp/.X11-unix\n#   Mount <some_ssh_key>.pub in here to enable xpra via ssh\nVOLUME /etc/pub-keys\nCOPY bin/* /usr/local/bin/\nENV DISPLAY=\":14\" \\\n    SHELL=\"/bin/bash\" \\\n    SSHD_PORT=\"22\" \\\n    START_XORG=\"yes\" \\\n    XPRA_HTML=\"no\" \\\n    XPRA_MODE=\"start\" \\\n    XPRA_READONLY=\"no\" \\\n    XORG_DPI=\"96\" \\\n    XPRA_COMPRESS=\"0\" \\\n    XPRA_DPI=\"0\" \\\n    XPRA_ENCODING=\"rgb\" \\\n    XPRA_HTML_DPI=\"96\" \\\n    XPRA_KEYBOARD_SYNC=\"yes\" \\\n    XPRA_MMAP=\"yes\" \\\n    XPRA_SHARING=\"yes\" \\\n    XPRA_TCP_PORT=\"10000\"\nENV GID=\"1000\" \\\n    GNAME=\"xpra\" \\\n    SHELL=\"/bin/bash\" \\\n    UHOME=\"/home/xpra\" \\\n    UID=\"1000\" \\\n    UNAME=\"xpra\"\nEXPOSE $SSHD_PORT $XPRA_TCP_PORT\nENTRYPOINT [\"/usr/local/bin/run\"]\nCMD [\"xhost\", \"+\"]\n","originalDockerfileUglifiedHash":"47db60aed037221dcbbc32b304364596","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/9780c1a8328a8a6d5810173541fc4225e455207e.dockerfile"}