{"seed":2148831153,"processedDockerfileHash":"7ac593faeff7db08931a97e583b1ab60","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["have-a-healthcheck"],"processedDockerfile":"#   Copyright 2017 AT&T Intellectual Property.  All other rights reserved.\n#\n#   Licensed under the Apache License, Version 2.0 (the \"License\");\n#   you may not use this file except in compliance with the License.\n#   You may obtain a copy of the License at\n#\n#       http://www.apache.org/licenses/LICENSE-2.0\n#\n#   Unless required by applicable law or agreed to in writing, software\n#   distributed under the License is distributed on an \"AS IS\" BASIS,\n#   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n#   See the License for the specific language governing permissions and\n#   limitations under the License.\nARG FROM=opensuse/leap:15.0\nFROM ${FROM}\nLABEL org.opencontainers.image.authors=\"airship-discuss@lists.airshipit.org, irc://#airshipit@freenode\"\nLABEL org.opencontainers.image.url=\"https://airshipit.org\"\nLABEL org.opencontainers.image.documentation=\"https://airship-shipyard.readthedocs.org\"\nLABEL org.opencontainers.image.source=\"https://git.openstack.org/openstack/airship-shipyard\"\nLABEL org.opencontainers.image.vendor=\"The Airship Authors\"\nLABEL org.opencontainers.image.licenses=\"Apache-2.0\"\nENV container=\"docker\"\nENV PORT=\"9000\"\nENV LC_ALL=\"C.UTF-8\"\nENV LANG=\"C.UTF-8\"\n#   Setting the version explicitly for PBR\nENV PBR_VERSION=\"0.1a1\"\nARG ctx_base=src/bin\n#   Expose port 9000 for application\nEXPOSE $PORT\nRUN set -ex \\\n && zypper --gpg-auto-import-keys refresh \\\n && zypper -q update -y \\\n && zypper --non-interactive install --no-recommends ca-certificates curl netcfg python3-devel python3-setuptools \\\n && zypper clean -a \\\n && rm -rf /tmp/* /var/tmp/* /usr/share/man /usr/share/doc /usr/share/doc-base\n#   Create shipyard user\nRUN useradd -ms /bin/bash shipyard \\\n && mkdir -p /home/shipyard/shipyard \\\n && mkdir -p /home/shipyard/shipyard_client\n#   Copy entrypoint.sh to /home/shipyard\nCOPY ${ctx_base}/shipyard_airflow/entrypoint.sh /home/shipyard/entrypoint.sh\n#   Change permissions and set up directories\nRUN chown -R shipyard: /home/shipyard \\\n && chmod +x /home/shipyard/entrypoint.sh\n#   Requirements and Shipyard source\nCOPY ${ctx_base}/shipyard_airflow/requirements.txt /home/shipyard/api_requirements.txt\nCOPY ${ctx_base}/shipyard_client/requirements.txt /home/shipyard/client_requirements.txt\nCOPY ${ctx_base}/shipyard_client /home/shipyard/shipyard_client/\nCOPY ${ctx_base}/shipyard_airflow /home/shipyard/shipyard/\n#   Build\nRUN set -ex \\\n && buildDeps=' gcc git-core libopenssl-devel make python3-pip ' \\\n && zypper -q update -y \\\n && zypper --non-interactive install --no-recommends $buildDeps \\\n && python3 -m pip install -U pip \\\n && pip3 install -r /home/shipyard/client_requirements.txt --no-cache-dir \\\n && cd /home/shipyard/shipyard_client \\\n && python3 setup.py install \\\n && pip3 install -r /home/shipyard/api_requirements.txt --no-cache-dir \\\n && cd /home/shipyard/shipyard \\\n && python3 setup.py install \\\n && zypper remove -y --clean-deps $buildDeps \\\n && zypper clean -a \\\n && rm -rf /tmp/* /var/tmp/* /var/log/* /usr/share/man /usr/share/doc /usr/share/doc-base\n#   Entrypoint\nENTRYPOINT [\"/home/shipyard/entrypoint.sh\"]\nCMD [\"server\"]\n#   Set user to shipyard\nUSER shipyard\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  Copyright 2017 AT&T Intellectual Property.  All other rights reserved.\n#\n#  Licensed under the Apache License, Version 2.0 (the \"License\");\n#  you may not use this file except in compliance with the License.\n#  You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n#  Unless required by applicable law or agreed to in writing, software\n#  distributed under the License is distributed on an \"AS IS\" BASIS,\n#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n#  See the License for the specific language governing permissions and\n#  limitations under the License.\nARG FROM=opensuse/leap:15.0\nFROM ${FROM}\nLABEL org.opencontainers.image.authors=\"airship-discuss@lists.airshipit.org, irc://#airshipit@freenode\"\nLABEL org.opencontainers.image.url=\"https://airshipit.org\"\nLABEL org.opencontainers.image.documentation=\"https://airship-shipyard.readthedocs.org\"\nLABEL org.opencontainers.image.source=\"https://git.openstack.org/openstack/airship-shipyard\"\nLABEL org.opencontainers.image.vendor=\"The Airship Authors\"\nLABEL org.opencontainers.image.licenses=\"Apache-2.0\"\nENV container=\"docker\"\nENV PORT=\"9000\"\nENV LC_ALL=\"C.UTF-8\"\nENV LANG=\"C.UTF-8\"\n#  Setting the version explicitly for PBR\nENV PBR_VERSION=\"0.1a1\"\nARG ctx_base=src/bin\n#  Expose port 9000 for application\nEXPOSE $PORT\nRUN set -ex \\\n && zypper --gpg-auto-import-keys refresh \\\n && zypper -q update -y \\\n && zypper --non-interactive install --no-recommends ca-certificates curl netcfg python3-devel python3-setuptools \\\n && zypper clean -a \\\n && rm -rf /tmp/* /var/tmp/* /usr/share/man /usr/share/doc /usr/share/doc-base\n#  Create shipyard user\nRUN useradd -ms /bin/bash shipyard \\\n && mkdir -p /home/shipyard/shipyard \\\n && mkdir -p /home/shipyard/shipyard_client\n#  Copy entrypoint.sh to /home/shipyard\nCOPY ${ctx_base}/shipyard_airflow/entrypoint.sh /home/shipyard/entrypoint.sh\n#  Change permissions and set up directories\nRUN chown -R shipyard: /home/shipyard \\\n && chmod +x /home/shipyard/entrypoint.sh\n#  Requirements and Shipyard source\nCOPY ${ctx_base}/shipyard_airflow/requirements.txt /home/shipyard/api_requirements.txt\nCOPY ${ctx_base}/shipyard_client/requirements.txt /home/shipyard/client_requirements.txt\nCOPY ${ctx_base}/shipyard_client /home/shipyard/shipyard_client/\nCOPY ${ctx_base}/shipyard_airflow /home/shipyard/shipyard/\n#  Build\nRUN set -ex \\\n && buildDeps=' gcc git-core libopenssl-devel make python3-pip ' \\\n && zypper -q update -y \\\n && zypper --non-interactive install --no-recommends $buildDeps \\\n && python3 -m pip install -U pip \\\n && pip3 install -r /home/shipyard/client_requirements.txt --no-cache-dir \\\n && cd /home/shipyard/shipyard_client \\\n && python3 setup.py install \\\n && pip3 install -r /home/shipyard/api_requirements.txt --no-cache-dir \\\n && cd /home/shipyard/shipyard \\\n && python3 setup.py install \\\n && zypper remove -y --clean-deps $buildDeps \\\n && zypper clean -a \\\n && rm -rf /tmp/* /var/tmp/* /var/log/* /usr/share/man /usr/share/doc /usr/share/doc-base\n#  Entrypoint\nENTRYPOINT [\"/home/shipyard/entrypoint.sh\"]\nCMD [\"server\"]\n#  Set user to shipyard\nUSER shipyard\n","injectedSmells":[],"originalDockerfileHash":"44f1f8eec876ed473d05616480148fb1","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   Copyright 2017 AT&T Intellectual Property.  All other rights reserved.\n#\n#   Licensed under the Apache License, Version 2.0 (the \"License\");\n#   you may not use this file except in compliance with the License.\n#   You may obtain a copy of the License at\n#\n#       http://www.apache.org/licenses/LICENSE-2.0\n#\n#   Unless required by applicable law or agreed to in writing, software\n#   distributed under the License is distributed on an \"AS IS\" BASIS,\n#   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n#   See the License for the specific language governing permissions and\n#   limitations under the License.\nARG FROM=opensuse/leap:15.0\nFROM ${FROM}\nLABEL org.opencontainers.image.authors=\"airship-discuss@lists.airshipit.org, irc://#airshipit@freenode\"\nLABEL org.opencontainers.image.url=\"https://airshipit.org\"\nLABEL org.opencontainers.image.documentation=\"https://airship-shipyard.readthedocs.org\"\nLABEL org.opencontainers.image.source=\"https://git.openstack.org/openstack/airship-shipyard\"\nLABEL org.opencontainers.image.vendor=\"The Airship Authors\"\nLABEL org.opencontainers.image.licenses=\"Apache-2.0\"\nENV container=\"docker\"\nENV PORT=\"9000\"\nENV LC_ALL=\"C.UTF-8\"\nENV LANG=\"C.UTF-8\"\n#   Setting the version explicitly for PBR\nENV PBR_VERSION=\"0.1a1\"\nARG ctx_base=src/bin\n#   Expose port 9000 for application\nEXPOSE $PORT\nRUN set -ex \\\n && zypper --gpg-auto-import-keys refresh \\\n && zypper -q update -y \\\n && zypper --non-interactive install --no-recommends ca-certificates curl netcfg python3-devel python3-setuptools \\\n && zypper clean -a \\\n && rm -rf /tmp/* /var/tmp/* /usr/share/man /usr/share/doc /usr/share/doc-base\n#   Create shipyard user\nRUN useradd -ms /bin/bash shipyard \\\n && mkdir -p /home/shipyard/shipyard \\\n && mkdir -p /home/shipyard/shipyard_client\n#   Copy entrypoint.sh to /home/shipyard\nCOPY ${ctx_base}/shipyard_airflow/entrypoint.sh /home/shipyard/entrypoint.sh\n#   Change permissions and set up directories\nRUN chown -R shipyard: /home/shipyard \\\n && chmod +x /home/shipyard/entrypoint.sh\n#   Requirements and Shipyard source\nCOPY ${ctx_base}/shipyard_airflow/requirements.txt /home/shipyard/api_requirements.txt\nCOPY ${ctx_base}/shipyard_client/requirements.txt /home/shipyard/client_requirements.txt\nCOPY ${ctx_base}/shipyard_client /home/shipyard/shipyard_client/\nCOPY ${ctx_base}/shipyard_airflow /home/shipyard/shipyard/\n#   Build\nRUN set -ex \\\n && buildDeps=' gcc git-core libopenssl-devel make python3-pip ' \\\n && zypper -q update -y \\\n && zypper --non-interactive install --no-recommends $buildDeps \\\n && python3 -m pip install -U pip \\\n && pip3 install -r /home/shipyard/client_requirements.txt --no-cache-dir \\\n && cd /home/shipyard/shipyard_client \\\n && python3 setup.py install \\\n && pip3 install -r /home/shipyard/api_requirements.txt --no-cache-dir \\\n && cd /home/shipyard/shipyard \\\n && python3 setup.py install \\\n && zypper remove -y --clean-deps $buildDeps \\\n && zypper clean -a \\\n && rm -rf /tmp/* /var/tmp/* /var/log/* /usr/share/man /usr/share/doc /usr/share/doc-base\n#   Entrypoint\nENTRYPOINT [\"/home/shipyard/entrypoint.sh\"]\nCMD [\"server\"]\n#   Set user to shipyard\nUSER shipyard\n","originalDockerfileUglifiedHash":"989f85af388132ac7bd1e8ca4003a0a4","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/b1255ccc2b8d4989fc5508e4d451b17080689fd6.dockerfile"}