{"seed":1463138517,"processedDockerfileHash":"8c91973d906f4b7bbebf889fe853f243","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM alexmasterov/alpine-libv8:6.7 AS libv8\nFROM alpine:3.7\nLABEL repository.hub=\"alexmasterov/alpine-php:7.1\" \\\n      repository.url=\"https://github.com/AlexMasterov/dockerfiles\" \\\n      maintainer=\"Alex Masterov <alex.masterow@gmail.com>\"\nARG PHP_VERSION=7.1.18\nARG PHP_CONFIG=/etc/php\nARG REALPATH_TURBO_TAG=v2.0.0\nARG XDEBUG_TAG=2.6.0\nARG MSGPACK_TAG=msgpack-2.0.2\nARG REDIS_TAG=4.0.2\nARG PHPIREDIS_TAG=v1.0.0\nARG MEMCACHED_TAG=v3.0.4\nARG TARANTOOL_VERSION=0.3.2\nARG MONGODB_VERSION=1.4.4\nARG AMQP_TAG=v1.9.3\nARG PHPV8_VERSION=0.2.2\nARG GRAPHQL_BRANCH=master\nCOPY --from=libv8 /usr/local/v8 /usr/local/v8\nRUN set -x \\\n && apk add ssmtp tini --update \\\n && addgroup -g 82 -S www-data \\\n && adduser -u 82 -S -D -h /var/cache/www-data -s /sbin/nologin -G www-data www-data\nRUN set -x \\\n && apk add autoconf binutils bzip2-dev curl curl-dev file freetype-dev g++ gcc git icu-dev jpeg-dev libmcrypt-dev libpng-dev libtool libwebp-dev libxml2-dev libxslt-dev make pcre-dev postgresql-dev re2c readline-dev sqlite-dev --virtual .php-build-dependencies \\\n && : \"---------- Proper iconv ----------\" \\\n && apk add gnu-libiconv-dev --no-cache --virtual .ext-runtime-dependencies --repository https://dl-3.alpinelinux.org/alpine/edge/testing/ \\\n && : \"---------- Replace binary and headers ----------\" \\\n && (mv /usr/bin/gnu-iconv /usr/bin/iconv ;mv /usr/include/gnu-libiconv/*.h /usr/include ;rm -rf /usr/include/gnu-libiconv ) \\\n && : \"---------- Build flags ----------\" \\\n && export LDFLAGS=\"-Wl,-O2 -Wl,--hash-style=both -pie\" \\\n && export CFLAGS=\"-O2 -march=native -fstack-protector-strong -fpic -fpie\" \\\n && export CPPFLAGS=${CFLAGS} \\\n && export MAKEFLAGS=\"-j $( expr $( getconf _NPROCESSORS_ONLN ;) + 1 ;)\" \\\n && : \"---------- PHP ----------\" \\\n && PHP_SOURCE=\"https://secure.php.net/get/php-${PHP_VERSION}.tar.xz/from/this/mirror\" \\\n && curl -fSL --connect-timeout 30 ${PHP_SOURCE} | tar xJ -C /tmp \\\n && cd /tmp/php-${PHP_VERSION} \\\n && : \"---------- Build ----------\" \\\n && ./configure --prefix=/usr --sysconfdir=${PHP_CONFIG} --with-config-file-path=${PHP_CONFIG} --with-config-file-scan-dir=${PHP_CONFIG}/conf.d --without-pear --disable-cgi --disable-debug --disable-ipv6 --disable-phpdbg --disable-rpath --disable-static --enable-bcmath --enable-calendar --enable-dom --enable-exif --enable-fd-setsize=$( ulimit -n ;) --enable-fpm --with-fpm-group=www-data --with-fpm-user=www-data --enable-ftp --enable-inline-optimization --enable-intl --enable-json --enable-libxml --with-libxml-dir=/usr --enable-mbregex --enable-mbstring --enable-opcache --enable-huge-code-pages --enable-opcache-file --enable-pcntl --enable-phar --enable-session --enable-shmop --enable-soap --enable-sockets --enable-xml --enable-xmlreader --enable-xmlwriter --enable-zip --with-pcre-dir=/usr --with-bz2=/usr --with-curl=/usr --with-gd --with-freetype-dir=/usr --with-jpeg-dir=/usr --with-png-dir=/usr --with-webp-dir=/usr --with-xpm-dir=no --with-zlib-dir=/usr --with-iconv=/usr --with-mcrypt=/usr --with-mhash --with-openssl=/usr --with-system-ciphers --with-pcre-regex=/usr --with-pcre-jit --with-pdo-mysql=mysqlnd --with-pdo-pgsql --with-pdo-sqlite --with-pgsql --with-readline=/usr --with-xmlrpc --with-xsl=/usr \\\n && make \\\n && make install \\\n && runtimeDeps=\"$( scanelf --needed --nobanner --recursive /usr/sbin/php-fpm | awk '{ gsub(/,/, \"\\nso:\", $2); print \"so:\" $2 }' | sort -u | xargs -r apk info --installed | sort -u ;)\" \\\n && apk add ${runtimeDeps} --virtual .php-runtime-dependencies \\\n && : \"---------- https://bugs.php.net/bug.php?id=52312 ----------\" \\\n && git clone -o ${REALPATH_TURBO_TAG} --depth 1 https://github.com/Whissi/realpath_turbo.git /tmp/realpath_turbo \\\n && cd /tmp/realpath_turbo \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && : \"---------- xDebug ----------\" \\\n && git clone -o ${XDEBUG_TAG} --depth 1 https://github.com/xdebug/xdebug.git /tmp/xdebug \\\n && cd /tmp/xdebug \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && : \"---------- Msgpack ----------\" \\\n && git clone -o ${MSGPACK_TAG} --depth 1 https://github.com/msgpack/msgpack-php.git /tmp/msgpack-php \\\n && cd /tmp/msgpack-php \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && : \"---------- Redis ----------\" \\\n && git clone -o ${REDIS_TAG} --depth 1 https://github.com/phpredis/phpredis.git /tmp/redis \\\n && cd /tmp/redis \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && : \"---------- Phpiredis ----------\" \\\n && : \"---------- https://blog.remirepo.net/post/2016/11/13/Redis-from-PHP ----------\" \\\n && apk add hiredis-dev --virtual .phpiredis-build-dependencies \\\n && apk add hiredis --virtual .phpiredis-runtime-dependencies \\\n && git clone -o ${PHPIREDIS_TAG} --depth 1 https://github.com/nrk/phpiredis.git /tmp/phpiredis \\\n && cd /tmp/phpiredis \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && apk del .phpiredis-build-dependencies \\\n && : \"---------- Memcached ----------\" \\\n && apk add libmemcached-dev cyrus-sasl-dev --virtual .memcached-build-dependencies \\\n && apk add libmemcached --virtual .memcached-runtime-dependencies \\\n && git clone -o ${MEMCACHED_TAG} --depth 1 https://github.com/php-memcached-dev/php-memcached.git /tmp/php-memcached \\\n && cd /tmp/php-memcached \\\n && phpize \\\n && ./configure --disable-memcached-sasl --enable-memcached-msgpack --enable-memcached-json \\\n && make \\\n && make install \\\n && apk del .memcached-build-dependencies \\\n && : \"---------- Tarantool ----------\" \\\n && apk add libltdl --virtual .tarantool-runtime-dependencies \\\n && TARANTOOL_FILENAME=\"tarantool-php-${TARANTOOL_VERSION}\" \\\n && TARANTOOL_SOURCE=\"https://github.com/tarantool/tarantool-php/archive/${TARANTOOL_VERSION}.tar.gz\" \\\n && curl -fSL --connect-timeout 30 ${TARANTOOL_SOURCE} | tar xz -C /tmp \\\n && cd /tmp/${TARANTOOL_FILENAME} \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && : \"---------- Mongodb ----------\" \\\n && apk add cmake pkgconfig --virtual .mongodb-build-dependencies \\\n && apk add libressl2.6-libtls --virtual .mongodb-runtime-dependencies \\\n && MONGODB_FILENAME=\"mongodb-${MONGODB_VERSION}\" \\\n && MONGODB_SOURCE=\"https://github.com/mongodb/mongo-php-driver/releases/download/${MONGODB_VERSION}/${MONGODB_FILENAME}.tgz\" \\\n && curl -fSL --connect-timeout 30 ${MONGODB_SOURCE} | tar xz -C /tmp \\\n && cd /tmp/${MONGODB_FILENAME} \\\n && phpize \\\n && ./configure --with-mongodb-ssl=libressl \\\n && make \\\n && make install \\\n && apk del .mongodb-build-dependencies \\\n && : \"---------- php-amqp (RabbitMQ) ----------\" \\\n && apk add rabbitmq-c-dev --virtual .amqp-build-dependencies \\\n && apk add rabbitmq-c --virtual .amqp-runtime-dependencies \\\n && git clone -o ${AMQP_TAG} --depth 1 https://github.com/pdezwart/php-amqp.git /tmp/php-amqp \\\n && cd /tmp/php-amqp \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && apk del .amqp-build-dependencies \\\n && : \"---------- php-v8 ----------\" \\\n && PHPV8_FILENAME=\"php-v8-${PHPV8_VERSION}\" \\\n && PHPV8_SOURCE=\"https://github.com/pinepain/php-v8/archive/v${PHPV8_VERSION}.tar.gz\" \\\n && curl -fSL --connect-timeout 30 ${PHPV8_SOURCE} | tar xz -C /tmp \\\n && cd /tmp/${PHPV8_FILENAME} \\\n && phpize \\\n && ./configure --with-v8=/usr/local/v8 \\\n && make \\\n && make install \\\n && : \"---------- graphql-parser ----------\" \\\n && apk add bison cmake flex python2 --virtual .graphql-build-dependencies \\\n && git clone -b ${GRAPHQL_BRANCH} --depth 1 https://github.com/dosten/graphql-parser-php.git /tmp/graphql \\\n && : \"---------- libgraphqlparser ----------\" \\\n && cd /tmp/graphql/deps/libgraphqlparser \\\n && cmake . \\\n && make \\\n && make install \\\n && : \"---------- graphql-parser-php ----------\" \\\n && cd /tmp/graphql \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && apk del .graphql-build-dependencies \\\n && : \"---------- Removing build dependencies, clean temporary files ----------\" \\\n && apk del .php-build-dependencies \\\n && rm -rf /var/cache/apk/* /var/tmp/* /tmp/*\nENTRYPOINT [\"tini\", \"--\"]\nCMD [\"php-fpm\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM alexmasterov/alpine-libv8:6.7 AS libv8\nFROM alpine:3.7\nLABEL repository.hub=\"alexmasterov/alpine-php:7.1\" \\\n      repository.url=\"https://github.com/AlexMasterov/dockerfiles\" \\\n      maintainer=\"Alex Masterov <alex.masterow@gmail.com>\"\nARG PHP_VERSION=7.1.18\nARG PHP_CONFIG=/etc/php\nARG REALPATH_TURBO_TAG=v2.0.0\nARG XDEBUG_TAG=2.6.0\nARG MSGPACK_TAG=msgpack-2.0.2\nARG REDIS_TAG=4.0.2\nARG PHPIREDIS_TAG=v1.0.0\nARG MEMCACHED_TAG=v3.0.4\nARG TARANTOOL_VERSION=0.3.2\nARG MONGODB_VERSION=1.4.4\nARG AMQP_TAG=v1.9.3\nARG PHPV8_VERSION=0.2.2\nARG GRAPHQL_BRANCH=master\nCOPY --from=libv8 /usr/local/v8 /usr/local/v8\nRUN set -x \\\n && apk add --update ssmtp tini \\\n && addgroup -g 82 -S www-data \\\n && adduser -u 82 -S -D -h /var/cache/www-data -s /sbin/nologin -G www-data www-data\nRUN set -x \\\n && apk add --virtual .php-build-dependencies autoconf binutils bzip2-dev curl curl-dev file freetype-dev g++ gcc git icu-dev jpeg-dev libmcrypt-dev libpng-dev libtool libwebp-dev libxml2-dev libxslt-dev make pcre-dev postgresql-dev re2c readline-dev sqlite-dev \\\n && : \"---------- Proper iconv ----------\" \\\n && apk add --no-cache --virtual .ext-runtime-dependencies --repository https://dl-3.alpinelinux.org/alpine/edge/testing/ gnu-libiconv-dev \\\n && : \"---------- Replace binary and headers ----------\" \\\n && (mv /usr/bin/gnu-iconv /usr/bin/iconv ;mv /usr/include/gnu-libiconv/*.h /usr/include ;rm -rf /usr/include/gnu-libiconv ) \\\n && : \"---------- Build flags ----------\" \\\n && export LDFLAGS=\"-Wl,-O2 -Wl,--hash-style=both -pie\" \\\n && export CFLAGS=\"-O2 -march=native -fstack-protector-strong -fpic -fpie\" \\\n && export CPPFLAGS=${CFLAGS} \\\n && export MAKEFLAGS=\"-j $( expr $( getconf _NPROCESSORS_ONLN ;) + 1 ;)\" \\\n && : \"---------- PHP ----------\" \\\n && PHP_SOURCE=\"https://secure.php.net/get/php-${PHP_VERSION}.tar.xz/from/this/mirror\" \\\n && curl -fSL --connect-timeout 30 ${PHP_SOURCE} | tar xJ -C /tmp \\\n && cd /tmp/php-${PHP_VERSION} \\\n && : \"---------- Build ----------\" \\\n && ./configure --prefix=/usr --sysconfdir=${PHP_CONFIG} --with-config-file-path=${PHP_CONFIG} --with-config-file-scan-dir=${PHP_CONFIG}/conf.d --without-pear --disable-cgi --disable-debug --disable-ipv6 --disable-phpdbg --disable-rpath --disable-static --enable-bcmath --enable-calendar --enable-dom --enable-exif --enable-fd-setsize=$( ulimit -n ;) --enable-fpm --with-fpm-group=www-data --with-fpm-user=www-data --enable-ftp --enable-inline-optimization --enable-intl --enable-json --enable-libxml --with-libxml-dir=/usr --enable-mbregex --enable-mbstring --enable-opcache --enable-huge-code-pages --enable-opcache-file --enable-pcntl --enable-phar --enable-session --enable-shmop --enable-soap --enable-sockets --enable-xml --enable-xmlreader --enable-xmlwriter --enable-zip --with-pcre-dir=/usr --with-bz2=/usr --with-curl=/usr --with-gd --with-freetype-dir=/usr --with-jpeg-dir=/usr --with-png-dir=/usr --with-webp-dir=/usr --with-xpm-dir=no --with-zlib-dir=/usr --with-iconv=/usr --with-mcrypt=/usr --with-mhash --with-openssl=/usr --with-system-ciphers --with-pcre-regex=/usr --with-pcre-jit --with-pdo-mysql=mysqlnd --with-pdo-pgsql --with-pdo-sqlite --with-pgsql --with-readline=/usr --with-xmlrpc --with-xsl=/usr \\\n && make \\\n && make install \\\n && runtimeDeps=\"$( scanelf --needed --nobanner --recursive /usr/sbin/php-fpm | awk '{ gsub(/,/, \"\\nso:\", $2); print \"so:\" $2 }' | sort -u | xargs -r apk info --installed | sort -u ;)\" \\\n && apk add --virtual .php-runtime-dependencies ${runtimeDeps} \\\n && : \"---------- https://bugs.php.net/bug.php?id=52312 ----------\" \\\n && git clone -o ${REALPATH_TURBO_TAG} --depth 1 https://github.com/Whissi/realpath_turbo.git /tmp/realpath_turbo \\\n && cd /tmp/realpath_turbo \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && : \"---------- xDebug ----------\" \\\n && git clone -o ${XDEBUG_TAG} --depth 1 https://github.com/xdebug/xdebug.git /tmp/xdebug \\\n && cd /tmp/xdebug \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && : \"---------- Msgpack ----------\" \\\n && git clone -o ${MSGPACK_TAG} --depth 1 https://github.com/msgpack/msgpack-php.git /tmp/msgpack-php \\\n && cd /tmp/msgpack-php \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && : \"---------- Redis ----------\" \\\n && git clone -o ${REDIS_TAG} --depth 1 https://github.com/phpredis/phpredis.git /tmp/redis \\\n && cd /tmp/redis \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && : \"---------- Phpiredis ----------\" \\\n && : \"---------- https://blog.remirepo.net/post/2016/11/13/Redis-from-PHP ----------\" \\\n && apk add --virtual .phpiredis-build-dependencies hiredis-dev \\\n && apk add --virtual .phpiredis-runtime-dependencies hiredis \\\n && git clone -o ${PHPIREDIS_TAG} --depth 1 https://github.com/nrk/phpiredis.git /tmp/phpiredis \\\n && cd /tmp/phpiredis \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && apk del .phpiredis-build-dependencies \\\n && : \"---------- Memcached ----------\" \\\n && apk add --virtual .memcached-build-dependencies libmemcached-dev cyrus-sasl-dev \\\n && apk add --virtual .memcached-runtime-dependencies libmemcached \\\n && git clone -o ${MEMCACHED_TAG} --depth 1 https://github.com/php-memcached-dev/php-memcached.git /tmp/php-memcached \\\n && cd /tmp/php-memcached \\\n && phpize \\\n && ./configure --disable-memcached-sasl --enable-memcached-msgpack --enable-memcached-json \\\n && make \\\n && make install \\\n && apk del .memcached-build-dependencies \\\n && : \"---------- Tarantool ----------\" \\\n && apk add --virtual .tarantool-runtime-dependencies libltdl \\\n && TARANTOOL_FILENAME=\"tarantool-php-${TARANTOOL_VERSION}\" \\\n && TARANTOOL_SOURCE=\"https://github.com/tarantool/tarantool-php/archive/${TARANTOOL_VERSION}.tar.gz\" \\\n && curl -fSL --connect-timeout 30 ${TARANTOOL_SOURCE} | tar xz -C /tmp \\\n && cd /tmp/${TARANTOOL_FILENAME} \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && : \"---------- Mongodb ----------\" \\\n && apk add --virtual .mongodb-build-dependencies cmake pkgconfig \\\n && apk add --virtual .mongodb-runtime-dependencies libressl2.6-libtls \\\n && MONGODB_FILENAME=\"mongodb-${MONGODB_VERSION}\" \\\n && MONGODB_SOURCE=\"https://github.com/mongodb/mongo-php-driver/releases/download/${MONGODB_VERSION}/${MONGODB_FILENAME}.tgz\" \\\n && curl -fSL --connect-timeout 30 ${MONGODB_SOURCE} | tar xz -C /tmp \\\n && cd /tmp/${MONGODB_FILENAME} \\\n && phpize \\\n && ./configure --with-mongodb-ssl=libressl \\\n && make \\\n && make install \\\n && apk del .mongodb-build-dependencies \\\n && : \"---------- php-amqp (RabbitMQ) ----------\" \\\n && apk add --virtual .amqp-build-dependencies rabbitmq-c-dev \\\n && apk add --virtual .amqp-runtime-dependencies rabbitmq-c \\\n && git clone -o ${AMQP_TAG} --depth 1 https://github.com/pdezwart/php-amqp.git /tmp/php-amqp \\\n && cd /tmp/php-amqp \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && apk del .amqp-build-dependencies \\\n && : \"---------- php-v8 ----------\" \\\n && PHPV8_FILENAME=\"php-v8-${PHPV8_VERSION}\" \\\n && PHPV8_SOURCE=\"https://github.com/pinepain/php-v8/archive/v${PHPV8_VERSION}.tar.gz\" \\\n && curl -fSL --connect-timeout 30 ${PHPV8_SOURCE} | tar xz -C /tmp \\\n && cd /tmp/${PHPV8_FILENAME} \\\n && phpize \\\n && ./configure --with-v8=/usr/local/v8 \\\n && make \\\n && make install \\\n && : \"---------- graphql-parser ----------\" \\\n && apk add --virtual .graphql-build-dependencies bison cmake flex python2 \\\n && git clone -b ${GRAPHQL_BRANCH} --depth 1 https://github.com/dosten/graphql-parser-php.git /tmp/graphql \\\n && : \"---------- libgraphqlparser ----------\" \\\n && cd /tmp/graphql/deps/libgraphqlparser \\\n && cmake . \\\n && make \\\n && make install \\\n && : \"---------- graphql-parser-php ----------\" \\\n && cd /tmp/graphql \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && apk del .graphql-build-dependencies \\\n && : \"---------- Removing build dependencies, clean temporary files ----------\" \\\n && apk del .php-build-dependencies \\\n && rm -rf /var/cache/apk/* /var/tmp/* /tmp/*\nENTRYPOINT [\"tini\", \"--\"]\nCMD [\"php-fpm\"]\n","injectedSmells":[],"originalDockerfileHash":"bc4a7454d9d578717af781f75735b8d5","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM alexmasterov/alpine-libv8:6.7 AS libv8\nFROM alpine:3.7\nLABEL repository.hub=\"alexmasterov/alpine-php:7.1\" \\\n      repository.url=\"https://github.com/AlexMasterov/dockerfiles\" \\\n      maintainer=\"Alex Masterov <alex.masterow@gmail.com>\"\nARG PHP_VERSION=7.1.18\nARG PHP_CONFIG=/etc/php\nARG REALPATH_TURBO_TAG=v2.0.0\nARG XDEBUG_TAG=2.6.0\nARG MSGPACK_TAG=msgpack-2.0.2\nARG REDIS_TAG=4.0.2\nARG PHPIREDIS_TAG=v1.0.0\nARG MEMCACHED_TAG=v3.0.4\nARG TARANTOOL_VERSION=0.3.2\nARG MONGODB_VERSION=1.4.4\nARG AMQP_TAG=v1.9.3\nARG PHPV8_VERSION=0.2.2\nARG GRAPHQL_BRANCH=master\nCOPY --from=libv8 /usr/local/v8 /usr/local/v8\nRUN set -x \\\n && apk add --update ssmtp tini \\\n && addgroup -g 82 -S www-data \\\n && adduser -u 82 -S -D -h /var/cache/www-data -s /sbin/nologin -G www-data www-data\nRUN set -x \\\n && apk add --virtual .php-build-dependencies autoconf binutils bzip2-dev curl curl-dev file freetype-dev g++ gcc git icu-dev jpeg-dev libmcrypt-dev libpng-dev libtool libwebp-dev libxml2-dev libxslt-dev make pcre-dev postgresql-dev re2c readline-dev sqlite-dev \\\n && : \"---------- Proper iconv ----------\" \\\n && apk add --no-cache --virtual .ext-runtime-dependencies --repository https://dl-3.alpinelinux.org/alpine/edge/testing/ gnu-libiconv-dev \\\n && : \"---------- Replace binary and headers ----------\" \\\n && (mv /usr/bin/gnu-iconv /usr/bin/iconv ;mv /usr/include/gnu-libiconv/*.h /usr/include ;rm -rf /usr/include/gnu-libiconv ) \\\n && : \"---------- Build flags ----------\" \\\n && export LDFLAGS=\"-Wl,-O2 -Wl,--hash-style=both -pie\" \\\n && export CFLAGS=\"-O2 -march=native -fstack-protector-strong -fpic -fpie\" \\\n && export CPPFLAGS=${CFLAGS} \\\n && export MAKEFLAGS=\"-j $( expr $( getconf _NPROCESSORS_ONLN ;) + 1 ;)\" \\\n && : \"---------- PHP ----------\" \\\n && PHP_SOURCE=\"https://secure.php.net/get/php-${PHP_VERSION}.tar.xz/from/this/mirror\" \\\n && curl -fSL --connect-timeout 30 ${PHP_SOURCE} | tar xJ -C /tmp \\\n && cd /tmp/php-${PHP_VERSION} \\\n && : \"---------- Build ----------\" \\\n && ./configure --prefix=/usr --sysconfdir=${PHP_CONFIG} --with-config-file-path=${PHP_CONFIG} --with-config-file-scan-dir=${PHP_CONFIG}/conf.d --without-pear --disable-cgi --disable-debug --disable-ipv6 --disable-phpdbg --disable-rpath --disable-static --enable-bcmath --enable-calendar --enable-dom --enable-exif --enable-fd-setsize=$( ulimit -n ;) --enable-fpm --with-fpm-group=www-data --with-fpm-user=www-data --enable-ftp --enable-inline-optimization --enable-intl --enable-json --enable-libxml --with-libxml-dir=/usr --enable-mbregex --enable-mbstring --enable-opcache --enable-huge-code-pages --enable-opcache-file --enable-pcntl --enable-phar --enable-session --enable-shmop --enable-soap --enable-sockets --enable-xml --enable-xmlreader --enable-xmlwriter --enable-zip --with-pcre-dir=/usr --with-bz2=/usr --with-curl=/usr --with-gd --with-freetype-dir=/usr --with-jpeg-dir=/usr --with-png-dir=/usr --with-webp-dir=/usr --with-xpm-dir=no --with-zlib-dir=/usr --with-iconv=/usr --with-mcrypt=/usr --with-mhash --with-openssl=/usr --with-system-ciphers --with-pcre-regex=/usr --with-pcre-jit --with-pdo-mysql=mysqlnd --with-pdo-pgsql --with-pdo-sqlite --with-pgsql --with-readline=/usr --with-xmlrpc --with-xsl=/usr \\\n && make \\\n && make install \\\n && runtimeDeps=\"$( scanelf --needed --nobanner --recursive /usr/sbin/php-fpm | awk '{ gsub(/,/, \"\\nso:\", $2); print \"so:\" $2 }' | sort -u | xargs -r apk info --installed | sort -u ;)\" \\\n && apk add --virtual .php-runtime-dependencies ${runtimeDeps} \\\n && : \"---------- https://bugs.php.net/bug.php?id=52312 ----------\" \\\n && git clone -o ${REALPATH_TURBO_TAG} --depth 1 https://github.com/Whissi/realpath_turbo.git /tmp/realpath_turbo \\\n && cd /tmp/realpath_turbo \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && : \"---------- xDebug ----------\" \\\n && git clone -o ${XDEBUG_TAG} --depth 1 https://github.com/xdebug/xdebug.git /tmp/xdebug \\\n && cd /tmp/xdebug \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && : \"---------- Msgpack ----------\" \\\n && git clone -o ${MSGPACK_TAG} --depth 1 https://github.com/msgpack/msgpack-php.git /tmp/msgpack-php \\\n && cd /tmp/msgpack-php \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && : \"---------- Redis ----------\" \\\n && git clone -o ${REDIS_TAG} --depth 1 https://github.com/phpredis/phpredis.git /tmp/redis \\\n && cd /tmp/redis \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && : \"---------- Phpiredis ----------\" \\\n && : \"---------- https://blog.remirepo.net/post/2016/11/13/Redis-from-PHP ----------\" \\\n && apk add --virtual .phpiredis-build-dependencies hiredis-dev \\\n && apk add --virtual .phpiredis-runtime-dependencies hiredis \\\n && git clone -o ${PHPIREDIS_TAG} --depth 1 https://github.com/nrk/phpiredis.git /tmp/phpiredis \\\n && cd /tmp/phpiredis \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && apk del .phpiredis-build-dependencies \\\n && : \"---------- Memcached ----------\" \\\n && apk add --virtual .memcached-build-dependencies libmemcached-dev cyrus-sasl-dev \\\n && apk add --virtual .memcached-runtime-dependencies libmemcached \\\n && git clone -o ${MEMCACHED_TAG} --depth 1 https://github.com/php-memcached-dev/php-memcached.git /tmp/php-memcached \\\n && cd /tmp/php-memcached \\\n && phpize \\\n && ./configure --disable-memcached-sasl --enable-memcached-msgpack --enable-memcached-json \\\n && make \\\n && make install \\\n && apk del .memcached-build-dependencies \\\n && : \"---------- Tarantool ----------\" \\\n && apk add --virtual .tarantool-runtime-dependencies libltdl \\\n && TARANTOOL_FILENAME=\"tarantool-php-${TARANTOOL_VERSION}\" \\\n && TARANTOOL_SOURCE=\"https://github.com/tarantool/tarantool-php/archive/${TARANTOOL_VERSION}.tar.gz\" \\\n && curl -fSL --connect-timeout 30 ${TARANTOOL_SOURCE} | tar xz -C /tmp \\\n && cd /tmp/${TARANTOOL_FILENAME} \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && : \"---------- Mongodb ----------\" \\\n && apk add --virtual .mongodb-build-dependencies cmake pkgconfig \\\n && apk add --virtual .mongodb-runtime-dependencies libressl2.6-libtls \\\n && MONGODB_FILENAME=\"mongodb-${MONGODB_VERSION}\" \\\n && MONGODB_SOURCE=\"https://github.com/mongodb/mongo-php-driver/releases/download/${MONGODB_VERSION}/${MONGODB_FILENAME}.tgz\" \\\n && curl -fSL --connect-timeout 30 ${MONGODB_SOURCE} | tar xz -C /tmp \\\n && cd /tmp/${MONGODB_FILENAME} \\\n && phpize \\\n && ./configure --with-mongodb-ssl=libressl \\\n && make \\\n && make install \\\n && apk del .mongodb-build-dependencies \\\n && : \"---------- php-amqp (RabbitMQ) ----------\" \\\n && apk add --virtual .amqp-build-dependencies rabbitmq-c-dev \\\n && apk add --virtual .amqp-runtime-dependencies rabbitmq-c \\\n && git clone -o ${AMQP_TAG} --depth 1 https://github.com/pdezwart/php-amqp.git /tmp/php-amqp \\\n && cd /tmp/php-amqp \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && apk del .amqp-build-dependencies \\\n && : \"---------- php-v8 ----------\" \\\n && PHPV8_FILENAME=\"php-v8-${PHPV8_VERSION}\" \\\n && PHPV8_SOURCE=\"https://github.com/pinepain/php-v8/archive/v${PHPV8_VERSION}.tar.gz\" \\\n && curl -fSL --connect-timeout 30 ${PHPV8_SOURCE} | tar xz -C /tmp \\\n && cd /tmp/${PHPV8_FILENAME} \\\n && phpize \\\n && ./configure --with-v8=/usr/local/v8 \\\n && make \\\n && make install \\\n && : \"---------- graphql-parser ----------\" \\\n && apk add --virtual .graphql-build-dependencies bison cmake flex python2 \\\n && git clone -b ${GRAPHQL_BRANCH} --depth 1 https://github.com/dosten/graphql-parser-php.git /tmp/graphql \\\n && : \"---------- libgraphqlparser ----------\" \\\n && cd /tmp/graphql/deps/libgraphqlparser \\\n && cmake . \\\n && make \\\n && make install \\\n && : \"---------- graphql-parser-php ----------\" \\\n && cd /tmp/graphql \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && apk del .graphql-build-dependencies \\\n && : \"---------- Removing build dependencies, clean temporary files ----------\" \\\n && apk del .php-build-dependencies \\\n && rm -rf /var/cache/apk/* /var/tmp/* /tmp/*\nENTRYPOINT [\"tini\", \"--\"]\nCMD [\"php-fpm\"]\n","originalDockerfileUglifiedHash":"bc4a7454d9d578717af781f75735b8d5","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/11150fc5dca650964185584bd9ec1bbd92669143.dockerfile"}