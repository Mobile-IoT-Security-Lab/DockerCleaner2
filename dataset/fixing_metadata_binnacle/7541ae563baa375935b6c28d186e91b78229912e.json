{"seed":2320864679,"processedDockerfileHash":"63d751b6dad036968349a634ed61efa8","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","pin-package-manager-versions-gem","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM php:5.6.19-apache\nMAINTAINER paolo.mainardi@sparkfabrik.com\nENV REFRESHED_AT=\"2016-03-14\"\nENV DEBIAN_FRONTEND=\"noninteractive\"\n#   Enable apache rewrite.\nRUN a2enmod rewrite\n#   System env variables.\nENV XDEBUG_VERSION=\"2.4.0\"\nENV DRUSH_VERSION=\"8.0.5\"\nENV VAR_DUMPER_VERSION=\"3.0.3\"\nENV GOSU_VERSION=\"1.7\"\nENV MAILHOG_VERSION=\"v0.1.9\"\nENV TIMEZONE=\"\\\"Europe/Rome\\\"\"\n#   Install php packages.\nRUN apt-get update \\\n && apt-get install --no-install-recommends curl cron rsyslog supervisor mysql-client libpng12-dev libjpeg-dev libxml2-dev ruby ruby2.1 ruby2.1-dev git unzip vim libicu-dev libssl-dev -y \\\n && gem install bundler --version 2.4.12 \\\n && pecl install xdebug-${XDEBUG_VERSION} \\\n && docker-php-ext-configure gd --with-png-dir=/usr --with-jpeg-dir=/usr \\\n && docker-php-ext-configure intl \\\n && docker-php-ext-configure pcntl \\\n && docker-php-ext-install soap gd mbstring pdo pdo_mysql zip intl pcntl \\\n && echo \"${TIMEZONE}\" > /etc/timezone \\\n && dpkg-reconfigure -f noninteractive tzdata \\\n && apt-get autoremove -y \\\n && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*\n#   Install composer, drush and other tools.\nENV COMPOSER_HOME=\"/composer-libs\"\nRUN mkdir /composer-libs \\\n && curl -sS https://getcomposer.org/installer | php \\\n && mv composer.phar /usr/local/bin/composer \\\n && composer global require symfony/var-dumper:${VAR_DUMPER_VERSION} \\\n && chown -R www-data:www-data /composer-libs \\\n && curl -fSL \"https://github.com/drush-ops/drush/releases/download/${DRUSH_VERSION}/drush.phar\" -o /usr/bin/drush \\\n && chmod +x /usr/bin/drush \\\n && drush @none dl registry_rebuild-7.x-2.3 \\\n && echo \"PS1='\\[\\033[1;36m\\]\\u\\[\\033[1;31m\\]@\\[\\033[1;32m\\]\\h:\\[\\033[1;35m\\]\\w\\[\\033[1;31m\\]$\\[\\033[0m\\] '\" >> /etc/bash.bashrc \\\n && echo \"export TERM=xterm\" >> /etc/bash.bashrc \\\n && echo \"umask 000\" >> /etc/bash.bashrc \\\n && curl -fSL \"https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-$( dpkg --print-architecture ;)\" -o /usr/bin/gosu\n#   Install mailhog.\nRUN curl -fSL \"https://github.com/mailhog/MailHog/releases/download/${MAILHOG_VERSION}/MailHog_linux_amd64\" -o /usr/local/bin/mailhog \\\n && chmod +x /usr/local/bin/mailhog\n#  # Configure PHP and Apache and supervisord.\nCOPY config/docker/php/*.ini /usr/local/etc/php/conf.d/\nCOPY config/docker/apache/*.conf /etc/apache2/conf-enabled/\nCOPY config/docker/supervisord/*.conf /etc/supervisor/conf.d/\nRUN mkdir -p /usr/local/etc/php/apache2 \\\n && cp -R /usr/local/etc/php/conf.d /usr/local/etc/php/apache2 \\\n && echo 'export PHP_INI_SCAN_DIR=/usr/local/etc/php/apache2/conf.d' >> /etc/apache2/envvars \\\n && echo 'stage:$apr1$g6T0GvU3$6cxYQhCZvI.1aEFYr1uOd/' > /var/www/.htpasswd \\\n && rm -rf /etc/apache2/sites-enabled/*\n#   Configure cron.\nCOPY config/docker/cron/crontab /etc/cron.d/cron\nRUN rm -Rf /etc/cron.daily \\\n && rm -Rf /etc/cron.weekly \\\n && rm -Rf /etc/cron.monthly \\\n && rm -Rf /etc/cron.hourly \\\n && chmod a+x /etc/cron.d/cron\n#   Install blackfire agent.\nRUN export VERSION=`php -r \"echo PHP_MAJOR_VERSION.PHP_MINOR_VERSION;\" ` \\\n && curl -A \"Docker\" -o /tmp/blackfire-probe.tar.gz -D - -L -s https://blackfire.io/api/v1/releases/probe/php/linux/amd64/${VERSION} \\\n && tar zxpf /tmp/blackfire-probe.tar.gz -C /tmp \\\n && mv /tmp/blackfire-*.so `php -r \"echo ini_get('extension_dir');\" `/blackfire.so \\\n && echo \"extension=blackfire.so\\nblackfire.agent_socket=${BLACKFIRE_PORT}\" > $PHP_INI_DIR/apache2/conf.d/blackfire.ini\n#   Install ngrok.\nRUN which wget &> /dev/null || apt-get install --no-install-recommends wget=1.20.3 ; wget --no-verbose --output-document /ngrok.zip https://bin.equinox.io/c/4VmDzA7iaHb/ngrok-stable-linux-amd64.zip\nRUN unzip /ngrok.zip -d /bin \\\n && rm -f ngrok.zip \\\n && touch /.ngrok\n#   Expose apache.\nEXPOSE 80/tcp\n#   Execute daemons.\nCMD exec supervisord -n\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\n","originalDockerfile":"FROM php:5.6.19-apache\nMAINTAINER paolo.mainardi@sparkfabrik.com\nENV REFRESHED_AT=\"2016-03-14\"\nENV DEBIAN_FRONTEND=\"noninteractive\"\n#  Enable apache rewrite.\nRUN a2enmod rewrite\n#  System env variables.\nENV XDEBUG_VERSION=\"2.4.0\"\nENV DRUSH_VERSION=\"8.0.5\"\nENV VAR_DUMPER_VERSION=\"3.0.3\"\nENV GOSU_VERSION=\"1.7\"\nENV MAILHOG_VERSION=\"v0.1.9\"\nENV TIMEZONE=\"\\\"Europe/Rome\\\"\"\n#  Install php packages.\nRUN apt-get update \\\n && apt-get install curl cron rsyslog supervisor mysql-client libpng12-dev libjpeg-dev libxml2-dev ruby ruby2.1 ruby2.1-dev git unzip vim libicu-dev libssl-dev -y \\\n && gem install bundler \\\n && pecl install xdebug-${XDEBUG_VERSION} \\\n && docker-php-ext-configure gd --with-png-dir=/usr --with-jpeg-dir=/usr \\\n && docker-php-ext-configure intl \\\n && docker-php-ext-configure pcntl \\\n && docker-php-ext-install soap gd mbstring pdo pdo_mysql zip intl pcntl \\\n && echo \"${TIMEZONE}\" > /etc/timezone \\\n && dpkg-reconfigure -f noninteractive tzdata \\\n && apt-get autoremove -y \\\n && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*\n#  Install composer, drush and other tools.\nENV COMPOSER_HOME=\"/composer-libs\"\nRUN mkdir /composer-libs \\\n && curl -sS https://getcomposer.org/installer | php \\\n && mv composer.phar /usr/local/bin/composer \\\n && composer global require symfony/var-dumper:${VAR_DUMPER_VERSION} \\\n && chown -R www-data:www-data /composer-libs \\\n && curl -fSL \"https://github.com/drush-ops/drush/releases/download/${DRUSH_VERSION}/drush.phar\" -o /usr/bin/drush \\\n && chmod +x /usr/bin/drush \\\n && drush @none dl registry_rebuild-7.x-2.3 \\\n && echo \"PS1='\\[\\033[1;36m\\]\\u\\[\\033[1;31m\\]@\\[\\033[1;32m\\]\\h:\\[\\033[1;35m\\]\\w\\[\\033[1;31m\\]$\\[\\033[0m\\] '\" >> /etc/bash.bashrc \\\n && echo \"export TERM=xterm\" >> /etc/bash.bashrc \\\n && echo \"umask 000\" >> /etc/bash.bashrc \\\n && curl -fSL \"https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-$( dpkg --print-architecture ;)\" -o /usr/bin/gosu\n#  Install mailhog.\nRUN curl -fSL \"https://github.com/mailhog/MailHog/releases/download/${MAILHOG_VERSION}/MailHog_linux_amd64\" -o /usr/local/bin/mailhog \\\n && chmod +x /usr/local/bin/mailhog\n# # Configure PHP and Apache and supervisord.\nCOPY config/docker/php/*.ini /usr/local/etc/php/conf.d/\nCOPY config/docker/apache/*.conf /etc/apache2/conf-enabled/\nCOPY config/docker/supervisord/*.conf /etc/supervisor/conf.d/\nRUN mkdir -p /usr/local/etc/php/apache2 \\\n && cp -R /usr/local/etc/php/conf.d /usr/local/etc/php/apache2 \\\n && echo 'export PHP_INI_SCAN_DIR=/usr/local/etc/php/apache2/conf.d' >> /etc/apache2/envvars \\\n && echo 'stage:$apr1$g6T0GvU3$6cxYQhCZvI.1aEFYr1uOd/' > /var/www/.htpasswd \\\n && rm -rf /etc/apache2/sites-enabled/*\n#  Configure cron.\nCOPY config/docker/cron/crontab /etc/cron.d/cron\nRUN rm -Rf /etc/cron.daily \\\n && rm -Rf /etc/cron.weekly \\\n && rm -Rf /etc/cron.monthly \\\n && rm -Rf /etc/cron.hourly \\\n && chmod a+x /etc/cron.d/cron\n#  Install blackfire agent.\nRUN export VERSION=`php -r \"echo PHP_MAJOR_VERSION.PHP_MINOR_VERSION;\" ` \\\n && curl -A \"Docker\" -o /tmp/blackfire-probe.tar.gz -D - -L -s https://blackfire.io/api/v1/releases/probe/php/linux/amd64/${VERSION} \\\n && tar zxpf /tmp/blackfire-probe.tar.gz -C /tmp \\\n && mv /tmp/blackfire-*.so `php -r \"echo ini_get('extension_dir');\" `/blackfire.so \\\n && echo \"extension=blackfire.so\\nblackfire.agent_socket=${BLACKFIRE_PORT}\" > $PHP_INI_DIR/apache2/conf.d/blackfire.ini\n#  Install ngrok.\nADD https://bin.equinox.io/c/4VmDzA7iaHb/ngrok-stable-linux-amd64.zip /ngrok.zip\nRUN unzip /ngrok.zip -d /bin \\\n && rm -f ngrok.zip \\\n && touch /.ngrok\n#  Expose apache.\nEXPOSE 80/tcp\n#  Execute daemons.\nCMD exec supervisord -n\n","injectedSmells":[],"originalDockerfileHash":"2f68bbe2bfea5cd4b519fb048a5595a7","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM php:5.6.19-apache\nMAINTAINER paolo.mainardi@sparkfabrik.com\nENV REFRESHED_AT=\"2016-03-14\"\nENV DEBIAN_FRONTEND=\"noninteractive\"\n#   Enable apache rewrite.\nRUN a2enmod rewrite\n#   System env variables.\nENV XDEBUG_VERSION=\"2.4.0\"\nENV DRUSH_VERSION=\"8.0.5\"\nENV VAR_DUMPER_VERSION=\"3.0.3\"\nENV GOSU_VERSION=\"1.7\"\nENV MAILHOG_VERSION=\"v0.1.9\"\nENV TIMEZONE=\"\\\"Europe/Rome\\\"\"\n#   Install php packages.\nRUN apt-get update \\\n && apt-get install curl cron rsyslog supervisor mysql-client libpng12-dev libjpeg-dev libxml2-dev ruby ruby2.1 ruby2.1-dev git unzip vim libicu-dev libssl-dev -y \\\n && gem install bundler \\\n && pecl install xdebug-${XDEBUG_VERSION} \\\n && docker-php-ext-configure gd --with-png-dir=/usr --with-jpeg-dir=/usr \\\n && docker-php-ext-configure intl \\\n && docker-php-ext-configure pcntl \\\n && docker-php-ext-install soap gd mbstring pdo pdo_mysql zip intl pcntl \\\n && echo \"${TIMEZONE}\" > /etc/timezone \\\n && dpkg-reconfigure -f noninteractive tzdata \\\n && apt-get autoremove -y \\\n && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*\n#   Install composer, drush and other tools.\nENV COMPOSER_HOME=\"/composer-libs\"\nRUN mkdir /composer-libs \\\n && curl -sS https://getcomposer.org/installer | php \\\n && mv composer.phar /usr/local/bin/composer \\\n && composer global require symfony/var-dumper:${VAR_DUMPER_VERSION} \\\n && chown -R www-data:www-data /composer-libs \\\n && curl -fSL \"https://github.com/drush-ops/drush/releases/download/${DRUSH_VERSION}/drush.phar\" -o /usr/bin/drush \\\n && chmod +x /usr/bin/drush \\\n && drush @none dl registry_rebuild-7.x-2.3 \\\n && echo \"PS1='\\[\\033[1;36m\\]\\u\\[\\033[1;31m\\]@\\[\\033[1;32m\\]\\h:\\[\\033[1;35m\\]\\w\\[\\033[1;31m\\]$\\[\\033[0m\\] '\" >> /etc/bash.bashrc \\\n && echo \"export TERM=xterm\" >> /etc/bash.bashrc \\\n && echo \"umask 000\" >> /etc/bash.bashrc \\\n && curl -fSL \"https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-$( dpkg --print-architecture ;)\" -o /usr/bin/gosu\n#   Install mailhog.\nRUN curl -fSL \"https://github.com/mailhog/MailHog/releases/download/${MAILHOG_VERSION}/MailHog_linux_amd64\" -o /usr/local/bin/mailhog \\\n && chmod +x /usr/local/bin/mailhog\n#  # Configure PHP and Apache and supervisord.\nCOPY config/docker/php/*.ini /usr/local/etc/php/conf.d/\nCOPY config/docker/apache/*.conf /etc/apache2/conf-enabled/\nCOPY config/docker/supervisord/*.conf /etc/supervisor/conf.d/\nRUN mkdir -p /usr/local/etc/php/apache2 \\\n && cp -R /usr/local/etc/php/conf.d /usr/local/etc/php/apache2 \\\n && echo 'export PHP_INI_SCAN_DIR=/usr/local/etc/php/apache2/conf.d' >> /etc/apache2/envvars \\\n && echo 'stage:$apr1$g6T0GvU3$6cxYQhCZvI.1aEFYr1uOd/' > /var/www/.htpasswd \\\n && rm -rf /etc/apache2/sites-enabled/*\n#   Configure cron.\nCOPY config/docker/cron/crontab /etc/cron.d/cron\nRUN rm -Rf /etc/cron.daily \\\n && rm -Rf /etc/cron.weekly \\\n && rm -Rf /etc/cron.monthly \\\n && rm -Rf /etc/cron.hourly \\\n && chmod a+x /etc/cron.d/cron\n#   Install blackfire agent.\nRUN export VERSION=`php -r \"echo PHP_MAJOR_VERSION.PHP_MINOR_VERSION;\" ` \\\n && curl -A \"Docker\" -o /tmp/blackfire-probe.tar.gz -D - -L -s https://blackfire.io/api/v1/releases/probe/php/linux/amd64/${VERSION} \\\n && tar zxpf /tmp/blackfire-probe.tar.gz -C /tmp \\\n && mv /tmp/blackfire-*.so `php -r \"echo ini_get('extension_dir');\" `/blackfire.so \\\n && echo \"extension=blackfire.so\\nblackfire.agent_socket=${BLACKFIRE_PORT}\" > $PHP_INI_DIR/apache2/conf.d/blackfire.ini\n#   Install ngrok.\nADD https://bin.equinox.io/c/4VmDzA7iaHb/ngrok-stable-linux-amd64.zip /ngrok.zip\nRUN unzip /ngrok.zip -d /bin \\\n && rm -f ngrok.zip \\\n && touch /.ngrok\n#   Expose apache.\nEXPOSE 80/tcp\n#   Execute daemons.\nCMD exec supervisord -n\n","originalDockerfileUglifiedHash":"d75f06ff9ad2dd117595badbfda5acbe","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/7541ae563baa375935b6c28d186e91b78229912e.dockerfile"}