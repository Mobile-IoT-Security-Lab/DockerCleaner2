{"seed":1137896209,"processedDockerfileHash":"c91b4208ecf02fa2bb7efcc471e7f4cf","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["do-not-use-apt-get-update-alone","have-a-healthcheck","have-a-user"],"processedDockerfile":"ARG FROM_TAG=latest\nFROM quay.io/continuouspipe/ubuntu16.04:${FROM_TAG}\nARG PHP_FULL_VERSION\nENV PHP_FULL_VERSION=\"${PHP_FULL_VERSION}\"\nRUN export PHP_VERSION=${PHP_FULL_VERSION%.[0-9]*} \\\n && : \\\n && DEBIAN_FRONTEND=noninteractive apt-get -qq -y --no-install-recommends install awscli jq nginx postfix mysql-client postgresql-client autoconf automake apache2-dev bison build-essential freetds-dev libbz2-dev libc-client-dev libcurl4-openssl-dev libedit-dev libgd-dev libglib2.0-dev libgmp3-dev libicu-dev libjpeg-dev libltdl-dev \"$( dpkg --compare-versions \"$PHP_VERSION\" ge 7.2 || echo \"libmcrypt-dev\" ;)\" libmemcached-dev libmysqlclient-dev libpng-dev libpq-dev libjpeg-dev libsqlite3-dev libssl-dev libtidy-dev libwebp-dev libwrap0-dev libxml2-dev libxslt1-dev libzip-dev pkg-config re2c zlib1g-dev \\\n && wget \"https://secure.php.net/distributions/php-${PHP_FULL_VERSION}.tar.bz2\" \\\n && tar -xf \"php-${PHP_FULL_VERSION}.tar.bz2\" \\\n && cd \"php-${PHP_FULL_VERSION}\" \\\n && mkdir build-cli build-fpm \\\n && cd build-cli \\\n && ln -s ../configure \\\n && ./configure --prefix=/usr --sysconfdir=/etc --localstatedir=/var --with-libedit=shared,/usr --enable-cli --disable-cgi --disable-phpdbg --enable-pcntl --enable-bcmath --with-bz2=/usr --with-curl --with-gd --enable-gd-native-ttf --with-freetype-dir=/usr --with-jpeg-dir=/usr --with-png-dir=/usr --with-xpm-dir=/usr/X11R6 --with-webp-dir=/usr --enable-intl --enable-mbstring \"$( dpkg --compare-versions \"$PHP_VERSION\" ge 7.2 || echo \"--with-mcrypt\" ;)\" --with-mhash --enable-mysqlnd --with-mysql=mysqlnd --with-mysqli=mysqlnd --with-mysql-sock=/var/run/mysqld/mysqld.sock --with-openssl --with-pdo-mysql --with-pdo-pgsql --with-pdo-sqlite --enable-soap --with-sqlite3 --with-tidy --with-xsl --enable-zip --with-zlib \"--with-config-file-path=/etc/php/${PHP_VERSION}/cli\" \"--with-config-file-scan-dir=/etc/php/${PHP_VERSION}/cli/conf.d\" \\\n && make -j2 \\\n && make install \\\n && cd .. \\\n && cd build-fpm \\\n && ln -s ../configure \\\n && ./configure --prefix=/usr \"--sysconfdir=/etc/php/${PHP_VERSION}/fpm\" --localstatedir=/var --enable-fpm --disable-cgi --disable-phpdbg --enable-bcmath --with-bz2=/usr --with-curl --with-gd --enable-gd-native-ttf --with-freetype-dir=/usr --with-jpeg-dir=/usr --with-png-dir=/usr --with-xpm-dir=/usr/X11R6 --with-webp-dir=/usr --enable-intl --enable-mbstring \"$( dpkg --compare-versions \"$PHP_VERSION\" ge 7.2 || echo \"--with-mcrypt\" ;)\" --with-mhash --enable-mysqlnd --with-mysql=mysqlnd --with-mysqli=mysqlnd --with-mysql-sock=/var/run/mysqld/mysqld.sock --with-openssl --with-pdo-mysql --with-pdo-pgsql --with-pdo-sqlite --enable-soap --with-sqlite3 --with-tidy --with-xsl --enable-zip --with-zlib --with-libevent-dir=/usr --with-fpm-user=www-data --with-fpm-group=www-data \"--with-config-file-path=/etc/php/${PHP_VERSION}/fpm\" \"--with-config-file-scan-dir=/etc/php/${PHP_VERSION}/fpm/conf.d\" \\\n && make -j2 \\\n && make install-fpm \\\n && cd ../.. \\\n && rm -rf php-${PHP_FULL_VERSION} php-${PHP_FULL_VERSION}.tar.bz2 \\\n && mv /usr/sbin/php-fpm \"/usr/sbin/php-fpm${PHP_VERSION}\" \\\n && mkdir -p \"/etc/php/${PHP_VERSION}/cli/conf.d\" \"/etc/php/${PHP_VERSION}/fpm/conf.d\" \\\n && mkdir -p \"/etc/php/${PHP_VERSION}/fpm/pool.d\" \\\n && if bash -c '[[ \"${PHP_FULL_VERSION}\" =~ ^5\\. ]]' ; then pecl install memcached-2.2.0 ; else pecl install memcached ; fi \\\n && echo -e '; priority=25\\nextension=memcached.so' | tee /etc/php/${PHP_VERSION}/fpm/conf.d/25-memcached.ini > /etc/php/${PHP_VERSION}/cli/conf.d/25-memcached.ini \\\n && apt-get auto-remove -qq -y \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/* \\\n && wget https://getcomposer.org/installer -O /tmp/composer-setup.php -q \\\n && [ \"$( wget https://composer.github.io/installer.sig -O - -q ;)\" = \"$( sha384sum /tmp/composer-setup.php | awk '{ print $1 }' ;)\" ] \\\n && php /tmp/composer-setup.php --install-dir='/usr/local/bin/' --filename='composer' --quiet \\\n && rm /tmp/composer-setup.php\nUSER build\nRUN composer global require \"hirak/prestissimo\" --no-interaction --no-ansi --quiet --no-progress --prefer-dist \\\n && composer clear-cache --no-ansi --quiet \\\n && chmod -R go-w ~/.composer/vendor\nUSER root\nCOPY ./shared/ ./nginx/ /\nRUN export PHP_VERSION=${PHP_FULL_VERSION%.[0-9]*} \\\n && find /etc/confd/conf.d/ -name \"*.toml\" -type f -exec sed -i'' \"s/$PHP_VERSION/$PHP_VERSION/\" {}\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"ARG FROM_TAG=latest\nFROM quay.io/continuouspipe/ubuntu16.04:${FROM_TAG}\nARG PHP_FULL_VERSION\nENV PHP_FULL_VERSION=\"${PHP_FULL_VERSION}\"\nRUN export PHP_VERSION=${PHP_FULL_VERSION%.[0-9]*} \\\n && apt-get update -qq \\\n && DEBIAN_FRONTEND=noninteractive apt-get -qq -y --no-install-recommends install awscli jq nginx postfix mysql-client postgresql-client autoconf automake apache2-dev bison build-essential freetds-dev libbz2-dev libc-client-dev libcurl4-openssl-dev libedit-dev libgd-dev libglib2.0-dev libgmp3-dev libicu-dev libjpeg-dev libltdl-dev \"$( dpkg --compare-versions \"$PHP_VERSION\" ge 7.2 || echo \"libmcrypt-dev\" ;)\" libmemcached-dev libmysqlclient-dev libpng-dev libpq-dev libjpeg-dev libsqlite3-dev libssl-dev libtidy-dev libwebp-dev libwrap0-dev libxml2-dev libxslt1-dev libzip-dev pkg-config re2c zlib1g-dev \\\n && wget \"https://secure.php.net/distributions/php-${PHP_FULL_VERSION}.tar.bz2\" \\\n && tar -xf \"php-${PHP_FULL_VERSION}.tar.bz2\" \\\n && cd \"php-${PHP_FULL_VERSION}\" \\\n && mkdir build-cli build-fpm \\\n && cd build-cli \\\n && ln -s ../configure \\\n && ./configure --prefix=/usr --sysconfdir=/etc --localstatedir=/var --with-libedit=shared,/usr --enable-cli --disable-cgi --disable-phpdbg --enable-pcntl --enable-bcmath --with-bz2=/usr --with-curl --with-gd --enable-gd-native-ttf --with-freetype-dir=/usr --with-jpeg-dir=/usr --with-png-dir=/usr --with-xpm-dir=/usr/X11R6 --with-webp-dir=/usr --enable-intl --enable-mbstring \"$( dpkg --compare-versions \"$PHP_VERSION\" ge 7.2 || echo \"--with-mcrypt\" ;)\" --with-mhash --enable-mysqlnd --with-mysql=mysqlnd --with-mysqli=mysqlnd --with-mysql-sock=/var/run/mysqld/mysqld.sock --with-openssl --with-pdo-mysql --with-pdo-pgsql --with-pdo-sqlite --enable-soap --with-sqlite3 --with-tidy --with-xsl --enable-zip --with-zlib \"--with-config-file-path=/etc/php/${PHP_VERSION}/cli\" \"--with-config-file-scan-dir=/etc/php/${PHP_VERSION}/cli/conf.d\" \\\n && make -j2 \\\n && make install \\\n && cd .. \\\n && cd build-fpm \\\n && ln -s ../configure \\\n && ./configure --prefix=/usr \"--sysconfdir=/etc/php/${PHP_VERSION}/fpm\" --localstatedir=/var --enable-fpm --disable-cgi --disable-phpdbg --enable-bcmath --with-bz2=/usr --with-curl --with-gd --enable-gd-native-ttf --with-freetype-dir=/usr --with-jpeg-dir=/usr --with-png-dir=/usr --with-xpm-dir=/usr/X11R6 --with-webp-dir=/usr --enable-intl --enable-mbstring \"$( dpkg --compare-versions \"$PHP_VERSION\" ge 7.2 || echo \"--with-mcrypt\" ;)\" --with-mhash --enable-mysqlnd --with-mysql=mysqlnd --with-mysqli=mysqlnd --with-mysql-sock=/var/run/mysqld/mysqld.sock --with-openssl --with-pdo-mysql --with-pdo-pgsql --with-pdo-sqlite --enable-soap --with-sqlite3 --with-tidy --with-xsl --enable-zip --with-zlib --with-libevent-dir=/usr --with-fpm-user=www-data --with-fpm-group=www-data \"--with-config-file-path=/etc/php/${PHP_VERSION}/fpm\" \"--with-config-file-scan-dir=/etc/php/${PHP_VERSION}/fpm/conf.d\" \\\n && make -j2 \\\n && make install-fpm \\\n && cd ../.. \\\n && rm -rf php-${PHP_FULL_VERSION} php-${PHP_FULL_VERSION}.tar.bz2 \\\n && mv /usr/sbin/php-fpm \"/usr/sbin/php-fpm${PHP_VERSION}\" \\\n && mkdir -p \"/etc/php/${PHP_VERSION}/cli/conf.d\" \"/etc/php/${PHP_VERSION}/fpm/conf.d\" \\\n && mkdir -p \"/etc/php/${PHP_VERSION}/fpm/pool.d\" \\\n && if bash -c '[[ \"${PHP_FULL_VERSION}\" =~ ^5\\. ]]' ; then pecl install memcached-2.2.0 ; else pecl install memcached ; fi \\\n && echo -e '; priority=25\\nextension=memcached.so' | tee /etc/php/${PHP_VERSION}/fpm/conf.d/25-memcached.ini > /etc/php/${PHP_VERSION}/cli/conf.d/25-memcached.ini \\\n && apt-get auto-remove -qq -y \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/* \\\n && wget https://getcomposer.org/installer -O /tmp/composer-setup.php -q \\\n && [ \"$( wget https://composer.github.io/installer.sig -O - -q ;)\" = \"$( sha384sum /tmp/composer-setup.php | awk '{ print $1 }' ;)\" ] \\\n && php /tmp/composer-setup.php --install-dir='/usr/local/bin/' --filename='composer' --quiet \\\n && rm /tmp/composer-setup.php\nUSER build\nRUN composer global require \"hirak/prestissimo\" --no-interaction --no-ansi --quiet --no-progress --prefer-dist \\\n && composer clear-cache --no-ansi --quiet \\\n && chmod -R go-w ~/.composer/vendor\nUSER root\nCOPY ./shared/ ./nginx/ /\nRUN export PHP_VERSION=${PHP_FULL_VERSION%.[0-9]*} \\\n && find /etc/confd/conf.d/ -name \"*.toml\" -type f -exec sed -i'' \"s/$PHP_VERSION/$PHP_VERSION/\" {} ;\n","injectedSmells":[],"originalDockerfileHash":"5b7ecfcf2e7c006e744b7d5343d2eb11","successfullyInjectedSmells":[],"originalDockerfileUglified":"ARG FROM_TAG=latest\nFROM quay.io/continuouspipe/ubuntu16.04:${FROM_TAG}\nARG PHP_FULL_VERSION\nENV PHP_FULL_VERSION=\"${PHP_FULL_VERSION}\"\nRUN export PHP_VERSION=${PHP_FULL_VERSION%.[0-9]*} \\\n && apt-get update -qq \\\n && DEBIAN_FRONTEND=noninteractive apt-get -qq -y --no-install-recommends install awscli jq nginx postfix mysql-client postgresql-client autoconf automake apache2-dev bison build-essential freetds-dev libbz2-dev libc-client-dev libcurl4-openssl-dev libedit-dev libgd-dev libglib2.0-dev libgmp3-dev libicu-dev libjpeg-dev libltdl-dev \"$( dpkg --compare-versions \"$PHP_VERSION\" ge 7.2 || echo \"libmcrypt-dev\" ;)\" libmemcached-dev libmysqlclient-dev libpng-dev libpq-dev libjpeg-dev libsqlite3-dev libssl-dev libtidy-dev libwebp-dev libwrap0-dev libxml2-dev libxslt1-dev libzip-dev pkg-config re2c zlib1g-dev \\\n && wget \"https://secure.php.net/distributions/php-${PHP_FULL_VERSION}.tar.bz2\" \\\n && tar -xf \"php-${PHP_FULL_VERSION}.tar.bz2\" \\\n && cd \"php-${PHP_FULL_VERSION}\" \\\n && mkdir build-cli build-fpm \\\n && cd build-cli \\\n && ln -s ../configure \\\n && ./configure --prefix=/usr --sysconfdir=/etc --localstatedir=/var --with-libedit=shared,/usr --enable-cli --disable-cgi --disable-phpdbg --enable-pcntl --enable-bcmath --with-bz2=/usr --with-curl --with-gd --enable-gd-native-ttf --with-freetype-dir=/usr --with-jpeg-dir=/usr --with-png-dir=/usr --with-xpm-dir=/usr/X11R6 --with-webp-dir=/usr --enable-intl --enable-mbstring \"$( dpkg --compare-versions \"$PHP_VERSION\" ge 7.2 || echo \"--with-mcrypt\" ;)\" --with-mhash --enable-mysqlnd --with-mysql=mysqlnd --with-mysqli=mysqlnd --with-mysql-sock=/var/run/mysqld/mysqld.sock --with-openssl --with-pdo-mysql --with-pdo-pgsql --with-pdo-sqlite --enable-soap --with-sqlite3 --with-tidy --with-xsl --enable-zip --with-zlib \"--with-config-file-path=/etc/php/${PHP_VERSION}/cli\" \"--with-config-file-scan-dir=/etc/php/${PHP_VERSION}/cli/conf.d\" \\\n && make -j2 \\\n && make install \\\n && cd .. \\\n && cd build-fpm \\\n && ln -s ../configure \\\n && ./configure --prefix=/usr \"--sysconfdir=/etc/php/${PHP_VERSION}/fpm\" --localstatedir=/var --enable-fpm --disable-cgi --disable-phpdbg --enable-bcmath --with-bz2=/usr --with-curl --with-gd --enable-gd-native-ttf --with-freetype-dir=/usr --with-jpeg-dir=/usr --with-png-dir=/usr --with-xpm-dir=/usr/X11R6 --with-webp-dir=/usr --enable-intl --enable-mbstring \"$( dpkg --compare-versions \"$PHP_VERSION\" ge 7.2 || echo \"--with-mcrypt\" ;)\" --with-mhash --enable-mysqlnd --with-mysql=mysqlnd --with-mysqli=mysqlnd --with-mysql-sock=/var/run/mysqld/mysqld.sock --with-openssl --with-pdo-mysql --with-pdo-pgsql --with-pdo-sqlite --enable-soap --with-sqlite3 --with-tidy --with-xsl --enable-zip --with-zlib --with-libevent-dir=/usr --with-fpm-user=www-data --with-fpm-group=www-data \"--with-config-file-path=/etc/php/${PHP_VERSION}/fpm\" \"--with-config-file-scan-dir=/etc/php/${PHP_VERSION}/fpm/conf.d\" \\\n && make -j2 \\\n && make install-fpm \\\n && cd ../.. \\\n && rm -rf php-${PHP_FULL_VERSION} php-${PHP_FULL_VERSION}.tar.bz2 \\\n && mv /usr/sbin/php-fpm \"/usr/sbin/php-fpm${PHP_VERSION}\" \\\n && mkdir -p \"/etc/php/${PHP_VERSION}/cli/conf.d\" \"/etc/php/${PHP_VERSION}/fpm/conf.d\" \\\n && mkdir -p \"/etc/php/${PHP_VERSION}/fpm/pool.d\" \\\n && if bash -c '[[ \"${PHP_FULL_VERSION}\" =~ ^5\\. ]]' ; then pecl install memcached-2.2.0 ; else pecl install memcached ; fi \\\n && echo -e '; priority=25\\nextension=memcached.so' | tee /etc/php/${PHP_VERSION}/fpm/conf.d/25-memcached.ini > /etc/php/${PHP_VERSION}/cli/conf.d/25-memcached.ini \\\n && apt-get auto-remove -qq -y \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/* \\\n && wget https://getcomposer.org/installer -O /tmp/composer-setup.php -q \\\n && [ \"$( wget https://composer.github.io/installer.sig -O - -q ;)\" = \"$( sha384sum /tmp/composer-setup.php | awk '{ print $1 }' ;)\" ] \\\n && php /tmp/composer-setup.php --install-dir='/usr/local/bin/' --filename='composer' --quiet \\\n && rm /tmp/composer-setup.php\nUSER build\nRUN composer global require \"hirak/prestissimo\" --no-interaction --no-ansi --quiet --no-progress --prefer-dist \\\n && composer clear-cache --no-ansi --quiet \\\n && chmod -R go-w ~/.composer/vendor\nUSER root\nCOPY ./shared/ ./nginx/ /\nRUN export PHP_VERSION=${PHP_FULL_VERSION%.[0-9]*} \\\n && find /etc/confd/conf.d/ -name \"*.toml\" -type f -exec sed -i'' \"s/$PHP_VERSION/$PHP_VERSION/\" {}\n","originalDockerfileUglifiedHash":"c2b1170c45b9c76d7baeb3dfb3d89003","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/badf06c6f11b547957c08645cbc5b846e3a63b1a.dockerfile"}