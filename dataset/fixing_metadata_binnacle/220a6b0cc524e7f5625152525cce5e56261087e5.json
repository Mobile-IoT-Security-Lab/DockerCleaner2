{"seed":646060746,"processedDockerfileHash":"dcaa044281ebd4fa7374a96efff9441a","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","pin-package-manager-versions-apt-get","have-a-healthcheck","have-a-user"],"processedDockerfile":"#   Dockerfile - Ubuntu Xenial\n#   https://github.com/openresty/docker-openresty\nFROM ubuntu:xenial\nLABEL maintainer=\"Evan Wies <evan@neomantra.net>\"\n#   Docker Build Arguments\nARG RESTY_VERSION=\"1.13.6.1\"\nARG RESTY_LUAROCKS_VERSION=\"2.4.3\"\nARG RESTY_OPENSSL_VERSION=\"1.0.2k\"\nARG RESTY_PCRE_VERSION=\"8.41\"\nARG RESTY_J=\"32\"\nARG RESTY_CONFIG_OPTIONS=\" --with-file-aio  --with-http_addition_module  --with-http_auth_request_module  --with-http_dav_module  --with-http_flv_module  --with-http_geoip_module=dynamic  --with-http_gunzip_module  --with-http_gzip_static_module  --with-http_image_filter_module=dynamic  --with-http_mp4_module  --with-http_random_index_module  --with-http_realip_module  --with-http_secure_link_module  --with-http_slice_module  --with-http_ssl_module  --with-http_stub_status_module  --with-http_sub_module  --with-http_v2_module  --with-http_xslt_module=dynamic  --with-ipv6  --with-mail  --with-mail_ssl_module  --with-md5-asm  --with-pcre-jit  --with-sha1-asm  --with-stream  --with-stream_ssl_module  --with-threads  \"\nARG RESTY_CONFIG_OPTIONS_MORE=\"\"\n#   These are not intended to be user-specified\nARG _RESTY_CONFIG_DEPS=\"--with-openssl=/tmp/openssl-${RESTY_OPENSSL_VERSION} --with-pcre=/tmp/pcre-${RESTY_PCRE_VERSION}\"\n#   1) Install apt dependencies\n#   2) Download and untar OpenSSL, PCRE, and OpenResty\n#   3) Build OpenResty\n#   4) Cleanup\nRUN DEBIAN_FRONTEND=noninteractive apt-get update \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y --no-install-recommends build-essential ca-certificates curl gettext-base libgd-dev libgeoip-dev libncurses5-dev libperl-dev libreadline-dev libxslt1-dev make perl unzip zlib1g-dev libmagickwand-dev \\\n && cd /tmp \\\n && curl -fSL https://www.openssl.org/source/openssl-${RESTY_OPENSSL_VERSION}.tar.gz -o openssl-${RESTY_OPENSSL_VERSION}.tar.gz \\\n && tar xzf openssl-${RESTY_OPENSSL_VERSION}.tar.gz \\\n && curl -fSL https://ftp.pcre.org/pub/pcre/pcre-${RESTY_PCRE_VERSION}.tar.gz -o pcre-${RESTY_PCRE_VERSION}.tar.gz \\\n && tar xzf pcre-${RESTY_PCRE_VERSION}.tar.gz \\\n && curl -fSL https://openresty.org/download/openresty-${RESTY_VERSION}.tar.gz -o openresty-${RESTY_VERSION}.tar.gz \\\n && tar xzf openresty-${RESTY_VERSION}.tar.gz \\\n && cd /tmp/openresty-${RESTY_VERSION} \\\n && ./configure -j${RESTY_J} ${_RESTY_CONFIG_DEPS} ${RESTY_CONFIG_OPTIONS} ${RESTY_CONFIG_OPTIONS_MORE} \\\n && make -j${RESTY_J} \\\n && make -j${RESTY_J} install \\\n && cd /tmp \\\n && rm -rf openssl-${RESTY_OPENSSL_VERSION} openssl-${RESTY_OPENSSL_VERSION}.tar.gz openresty-${RESTY_VERSION}.tar.gz openresty-${RESTY_VERSION} pcre-${RESTY_PCRE_VERSION}.tar.gz pcre-${RESTY_PCRE_VERSION} \\\n && curl -fSL https://github.com/luarocks/luarocks/archive/${RESTY_LUAROCKS_VERSION}.tar.gz -o luarocks-${RESTY_LUAROCKS_VERSION}.tar.gz \\\n && tar xzf luarocks-${RESTY_LUAROCKS_VERSION}.tar.gz \\\n && cd luarocks-${RESTY_LUAROCKS_VERSION} \\\n && ./configure --prefix=/usr/local/openresty/luajit --with-lua=/usr/local/openresty/luajit --lua-suffix=jit-2.1.0-beta3 --with-lua-include=/usr/local/openresty/luajit/include/luajit-2.1 \\\n && make -j${RESTY_J} build \\\n && make -j${RESTY_J} install \\\n && cd /tmp \\\n && rm -rf luarocks-${RESTY_LUAROCKS_VERSION} luarocks-${RESTY_LUAROCKS_VERSION}.tar.gz \\\n && DEBIAN_FRONTEND=noninteractive apt-get autoremove -y \\\n && ln -sf /dev/stdout /usr/local/openresty/nginx/logs/access.log \\\n && ln -sf /dev/stderr /usr/local/openresty/nginx/logs/error.log\n#   Add additional binaries into PATH for convenience\nENV PATH=\"$PATH:/usr/local/openresty/luajit/bin:/usr/local/openresty/nginx/sbin:/usr/local/openresty/bin\"\n#   Copy nginx configuration files\nCOPY nginx.conf /usr/local/openresty/nginx/conf/nginx.conf\nCOPY nginx.vh.default.conf /etc/nginx/conf.d/default.conf\nRUN apt-get install --no-install-recommends wget=1.17.1-1ubuntu1.5 libssl-dev=1.0.2g-1ubuntu4.20 -y \\\n && wget https://github.com/mongodb/mongo-c-driver/releases/download/1.9.3/mongo-c-driver-1.9.3.tar.gz \\\n && tar xzf mongo-c-driver-1.9.3.tar.gz \\\n && cd mongo-c-driver-1.9.3 \\\n && ./configure --disable-automatic-init-and-cleanup \\\n && make -j${RESTY_J} \\\n && make -j${RESTY_J} install\nRUN luarocks install resty-mongol --server=http://rocks.moonscript.org \\\n && luarocks install luasocket \\\n && luarocks install chronos \\\n && luarocks install magick\nCOPY lualongnumber /tmp/lualongnumber\nRUN cd /tmp/lualongnumber \\\n && make \\\n && make install\n#   RUN apt-get install -y libboost-all-dev libbson-1.0 libmongoc-1.0-0 \\\n#   && luarocks install \"https://raw.githubusercontent.com/moai/luamongo/master/rockspec/luamongo-scm-0.rockspec\"\n#   TODO: remove any other apt packages?\nCMD [\"/usr/local/openresty/bin/openresty\", \"-g\", \"daemon\", \"off\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  Dockerfile - Ubuntu Xenial\n#  https://github.com/openresty/docker-openresty\nFROM ubuntu:xenial\nLABEL maintainer=\"Evan Wies <evan@neomantra.net>\"\n#  Docker Build Arguments\nARG RESTY_VERSION=\"1.13.6.1\"\nARG RESTY_LUAROCKS_VERSION=\"2.4.3\"\nARG RESTY_OPENSSL_VERSION=\"1.0.2k\"\nARG RESTY_PCRE_VERSION=\"8.41\"\nARG RESTY_J=\"32\"\nARG RESTY_CONFIG_OPTIONS=\" --with-file-aio  --with-http_addition_module  --with-http_auth_request_module  --with-http_dav_module  --with-http_flv_module  --with-http_geoip_module=dynamic  --with-http_gunzip_module  --with-http_gzip_static_module  --with-http_image_filter_module=dynamic  --with-http_mp4_module  --with-http_random_index_module  --with-http_realip_module  --with-http_secure_link_module  --with-http_slice_module  --with-http_ssl_module  --with-http_stub_status_module  --with-http_sub_module  --with-http_v2_module  --with-http_xslt_module=dynamic  --with-ipv6  --with-mail  --with-mail_ssl_module  --with-md5-asm  --with-pcre-jit  --with-sha1-asm  --with-stream  --with-stream_ssl_module  --with-threads  \"\nARG RESTY_CONFIG_OPTIONS_MORE=\"\"\n#  These are not intended to be user-specified\nARG _RESTY_CONFIG_DEPS=\"--with-openssl=/tmp/openssl-${RESTY_OPENSSL_VERSION} --with-pcre=/tmp/pcre-${RESTY_PCRE_VERSION}\"\n#  1) Install apt dependencies\n#  2) Download and untar OpenSSL, PCRE, and OpenResty\n#  3) Build OpenResty\n#  4) Cleanup\nRUN DEBIAN_FRONTEND=noninteractive apt-get update \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y --no-install-recommends build-essential ca-certificates curl gettext-base libgd-dev libgeoip-dev libncurses5-dev libperl-dev libreadline-dev libxslt1-dev make perl unzip zlib1g-dev libmagickwand-dev \\\n && cd /tmp \\\n && curl -fSL https://www.openssl.org/source/openssl-${RESTY_OPENSSL_VERSION}.tar.gz -o openssl-${RESTY_OPENSSL_VERSION}.tar.gz \\\n && tar xzf openssl-${RESTY_OPENSSL_VERSION}.tar.gz \\\n && curl -fSL https://ftp.pcre.org/pub/pcre/pcre-${RESTY_PCRE_VERSION}.tar.gz -o pcre-${RESTY_PCRE_VERSION}.tar.gz \\\n && tar xzf pcre-${RESTY_PCRE_VERSION}.tar.gz \\\n && curl -fSL https://openresty.org/download/openresty-${RESTY_VERSION}.tar.gz -o openresty-${RESTY_VERSION}.tar.gz \\\n && tar xzf openresty-${RESTY_VERSION}.tar.gz \\\n && cd /tmp/openresty-${RESTY_VERSION} \\\n && ./configure -j${RESTY_J} ${_RESTY_CONFIG_DEPS} ${RESTY_CONFIG_OPTIONS} ${RESTY_CONFIG_OPTIONS_MORE} \\\n && make -j${RESTY_J} \\\n && make -j${RESTY_J} install \\\n && cd /tmp \\\n && rm -rf openssl-${RESTY_OPENSSL_VERSION} openssl-${RESTY_OPENSSL_VERSION}.tar.gz openresty-${RESTY_VERSION}.tar.gz openresty-${RESTY_VERSION} pcre-${RESTY_PCRE_VERSION}.tar.gz pcre-${RESTY_PCRE_VERSION} \\\n && curl -fSL https://github.com/luarocks/luarocks/archive/${RESTY_LUAROCKS_VERSION}.tar.gz -o luarocks-${RESTY_LUAROCKS_VERSION}.tar.gz \\\n && tar xzf luarocks-${RESTY_LUAROCKS_VERSION}.tar.gz \\\n && cd luarocks-${RESTY_LUAROCKS_VERSION} \\\n && ./configure --prefix=/usr/local/openresty/luajit --with-lua=/usr/local/openresty/luajit --lua-suffix=jit-2.1.0-beta3 --with-lua-include=/usr/local/openresty/luajit/include/luajit-2.1 \\\n && make -j${RESTY_J} build \\\n && make -j${RESTY_J} install \\\n && cd /tmp \\\n && rm -rf luarocks-${RESTY_LUAROCKS_VERSION} luarocks-${RESTY_LUAROCKS_VERSION}.tar.gz \\\n && DEBIAN_FRONTEND=noninteractive apt-get autoremove -y \\\n && ln -sf /dev/stdout /usr/local/openresty/nginx/logs/access.log \\\n && ln -sf /dev/stderr /usr/local/openresty/nginx/logs/error.log\n#  Add additional binaries into PATH for convenience\nENV PATH=\"$PATH:/usr/local/openresty/luajit/bin:/usr/local/openresty/nginx/sbin:/usr/local/openresty/bin\"\n#  Copy nginx configuration files\nCOPY nginx.conf /usr/local/openresty/nginx/conf/nginx.conf\nCOPY nginx.vh.default.conf /etc/nginx/conf.d/default.conf\nRUN apt-get install wget libssl-dev -y \\\n && wget https://github.com/mongodb/mongo-c-driver/releases/download/1.9.3/mongo-c-driver-1.9.3.tar.gz \\\n && tar xzf mongo-c-driver-1.9.3.tar.gz \\\n && cd mongo-c-driver-1.9.3 \\\n && ./configure --disable-automatic-init-and-cleanup \\\n && make -j${RESTY_J} \\\n && make -j${RESTY_J} install\nRUN luarocks install resty-mongol --server=http://rocks.moonscript.org \\\n && luarocks install luasocket \\\n && luarocks install chronos \\\n && luarocks install magick\nCOPY lualongnumber /tmp/lualongnumber\nRUN cd /tmp/lualongnumber \\\n && make \\\n && make install\n#  RUN apt-get install -y libboost-all-dev libbson-1.0 libmongoc-1.0-0 \\\n#  && luarocks install \"https://raw.githubusercontent.com/moai/luamongo/master/rockspec/luamongo-scm-0.rockspec\"\n#  TODO: remove any other apt packages?\nCMD [\"/usr/local/openresty/bin/openresty\", \"-g\", \"daemon\", \"off\"]\n","injectedSmells":[],"originalDockerfileHash":"86fbc1de29e3d77a9456ba5926821aca","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   Dockerfile - Ubuntu Xenial\n#   https://github.com/openresty/docker-openresty\nFROM ubuntu:xenial\nLABEL maintainer=\"Evan Wies <evan@neomantra.net>\"\n#   Docker Build Arguments\nARG RESTY_VERSION=\"1.13.6.1\"\nARG RESTY_LUAROCKS_VERSION=\"2.4.3\"\nARG RESTY_OPENSSL_VERSION=\"1.0.2k\"\nARG RESTY_PCRE_VERSION=\"8.41\"\nARG RESTY_J=\"32\"\nARG RESTY_CONFIG_OPTIONS=\" --with-file-aio  --with-http_addition_module  --with-http_auth_request_module  --with-http_dav_module  --with-http_flv_module  --with-http_geoip_module=dynamic  --with-http_gunzip_module  --with-http_gzip_static_module  --with-http_image_filter_module=dynamic  --with-http_mp4_module  --with-http_random_index_module  --with-http_realip_module  --with-http_secure_link_module  --with-http_slice_module  --with-http_ssl_module  --with-http_stub_status_module  --with-http_sub_module  --with-http_v2_module  --with-http_xslt_module=dynamic  --with-ipv6  --with-mail  --with-mail_ssl_module  --with-md5-asm  --with-pcre-jit  --with-sha1-asm  --with-stream  --with-stream_ssl_module  --with-threads  \"\nARG RESTY_CONFIG_OPTIONS_MORE=\"\"\n#   These are not intended to be user-specified\nARG _RESTY_CONFIG_DEPS=\"--with-openssl=/tmp/openssl-${RESTY_OPENSSL_VERSION} --with-pcre=/tmp/pcre-${RESTY_PCRE_VERSION}\"\n#   1) Install apt dependencies\n#   2) Download and untar OpenSSL, PCRE, and OpenResty\n#   3) Build OpenResty\n#   4) Cleanup\nRUN DEBIAN_FRONTEND=noninteractive apt-get update \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y --no-install-recommends build-essential ca-certificates curl gettext-base libgd-dev libgeoip-dev libncurses5-dev libperl-dev libreadline-dev libxslt1-dev make perl unzip zlib1g-dev libmagickwand-dev \\\n && cd /tmp \\\n && curl -fSL https://www.openssl.org/source/openssl-${RESTY_OPENSSL_VERSION}.tar.gz -o openssl-${RESTY_OPENSSL_VERSION}.tar.gz \\\n && tar xzf openssl-${RESTY_OPENSSL_VERSION}.tar.gz \\\n && curl -fSL https://ftp.pcre.org/pub/pcre/pcre-${RESTY_PCRE_VERSION}.tar.gz -o pcre-${RESTY_PCRE_VERSION}.tar.gz \\\n && tar xzf pcre-${RESTY_PCRE_VERSION}.tar.gz \\\n && curl -fSL https://openresty.org/download/openresty-${RESTY_VERSION}.tar.gz -o openresty-${RESTY_VERSION}.tar.gz \\\n && tar xzf openresty-${RESTY_VERSION}.tar.gz \\\n && cd /tmp/openresty-${RESTY_VERSION} \\\n && ./configure -j${RESTY_J} ${_RESTY_CONFIG_DEPS} ${RESTY_CONFIG_OPTIONS} ${RESTY_CONFIG_OPTIONS_MORE} \\\n && make -j${RESTY_J} \\\n && make -j${RESTY_J} install \\\n && cd /tmp \\\n && rm -rf openssl-${RESTY_OPENSSL_VERSION} openssl-${RESTY_OPENSSL_VERSION}.tar.gz openresty-${RESTY_VERSION}.tar.gz openresty-${RESTY_VERSION} pcre-${RESTY_PCRE_VERSION}.tar.gz pcre-${RESTY_PCRE_VERSION} \\\n && curl -fSL https://github.com/luarocks/luarocks/archive/${RESTY_LUAROCKS_VERSION}.tar.gz -o luarocks-${RESTY_LUAROCKS_VERSION}.tar.gz \\\n && tar xzf luarocks-${RESTY_LUAROCKS_VERSION}.tar.gz \\\n && cd luarocks-${RESTY_LUAROCKS_VERSION} \\\n && ./configure --prefix=/usr/local/openresty/luajit --with-lua=/usr/local/openresty/luajit --lua-suffix=jit-2.1.0-beta3 --with-lua-include=/usr/local/openresty/luajit/include/luajit-2.1 \\\n && make -j${RESTY_J} build \\\n && make -j${RESTY_J} install \\\n && cd /tmp \\\n && rm -rf luarocks-${RESTY_LUAROCKS_VERSION} luarocks-${RESTY_LUAROCKS_VERSION}.tar.gz \\\n && DEBIAN_FRONTEND=noninteractive apt-get autoremove -y \\\n && ln -sf /dev/stdout /usr/local/openresty/nginx/logs/access.log \\\n && ln -sf /dev/stderr /usr/local/openresty/nginx/logs/error.log\n#   Add additional binaries into PATH for convenience\nENV PATH=\"$PATH:/usr/local/openresty/luajit/bin:/usr/local/openresty/nginx/sbin:/usr/local/openresty/bin\"\n#   Copy nginx configuration files\nCOPY nginx.conf /usr/local/openresty/nginx/conf/nginx.conf\nCOPY nginx.vh.default.conf /etc/nginx/conf.d/default.conf\nRUN apt-get install wget libssl-dev -y \\\n && wget https://github.com/mongodb/mongo-c-driver/releases/download/1.9.3/mongo-c-driver-1.9.3.tar.gz \\\n && tar xzf mongo-c-driver-1.9.3.tar.gz \\\n && cd mongo-c-driver-1.9.3 \\\n && ./configure --disable-automatic-init-and-cleanup \\\n && make -j${RESTY_J} \\\n && make -j${RESTY_J} install\nRUN luarocks install resty-mongol --server=http://rocks.moonscript.org \\\n && luarocks install luasocket \\\n && luarocks install chronos \\\n && luarocks install magick\nCOPY lualongnumber /tmp/lualongnumber\nRUN cd /tmp/lualongnumber \\\n && make \\\n && make install\n#   RUN apt-get install -y libboost-all-dev libbson-1.0 libmongoc-1.0-0 \\\n#   && luarocks install \"https://raw.githubusercontent.com/moai/luamongo/master/rockspec/luamongo-scm-0.rockspec\"\n#   TODO: remove any other apt packages?\nCMD [\"/usr/local/openresty/bin/openresty\", \"-g\", \"daemon\", \"off\"]\n","originalDockerfileUglifiedHash":"1b24cb85c57aa960a9785cbc02040bdd","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/220a6b0cc524e7f5625152525cce5e56261087e5.dockerfile"}