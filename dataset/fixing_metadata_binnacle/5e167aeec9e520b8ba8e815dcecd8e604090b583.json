{"seed":3502110872,"processedDockerfileHash":"a0dc6e3ebd718fbe09cab5b514782075","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","pin-package-manager-versions-apt-get","have-a-healthcheck","have-a-user"],"processedDockerfile":"#   © Copyright IBM Corporation 2017, 2019.\n#   LICENSE: Apache License, Version 2.0 (http://www.apache.org/licenses/LICENSE-2.0)\n#  ######### Dockerfile for Sysdig version 0.26.1 #########\n#\n#   This Dockerfile builds a basic installation of Sysdig.\n#\n#   Sysdig is open source, system-level exploration: capture system state and activity from a running Linux instance, then save, filter and analyze.\n#   Sysdig is scriptable in Lua and includes a command line interface and a powerful interactive UI, csysdig, that runs in your terminal.\n#\n#   To build this image, from the directory containing this Dockerfile\n#   (assuming that the file is named Dockerfile):\n#   docker build -t <image_name> .\n#\n#   To run sysdig in a Docker container use below command\n#    docker run -it --privileged -v /var/run/docker.sock:/host/var/run/docker.sock -v /dev:/host/dev -v /proc:/host/proc:ro -v\n#     /boot:/host/boot:ro -v /lib/modules:/host/lib/modules:ro -v /usr:/host/usr:ro --name <container_name> <image_name>\n#\n#   The official website\n#   https://www.sysdig.org/\n#  #################################################################################\n#   Base Image\nFROM s390x/ubuntu:16.04\nARG SYSDIG_VER=0.26.1\n#   The author\nMAINTAINER LoZ Open Source Ecosystem (https://www.ibm.com/developerworks/community/groups/community/lozopensource)\nLABEL RUN=\"docker run -i -t --privileged -v /var/run/docker.sock:/host/var/run/docker.sock -v /dev:/host/dev -v /proc:/host/proc:ro -v /boot:/host/boot:ro -v /lib/modules:/host/lib/modules:ro -v /usr:/host/usr:ro --name NAME IMAGE\"\nENV SOURCEDIR=\"/tmp/source\"\nWORKDIR $SOURCEDIR\n#   Install dependencies\nRUN apt-get update \\\n && apt-get install --no-install-recommends cmake gcc g++ libelf-dev lua5.1 lua5.1-dev patch tar wget linux-headers-$( uname -r ;) -y \\\n && cd $SOURCEDIR \\\n && wget https://github.com/draios/sysdig/archive/${SYSDIG_VER}.tar.gz \\\n && tar -xvzf ${SYSDIG_VER}.tar.gz \\\n && cd sysdig-${SYSDIG_VER} \\\n && mkdir build \\\n && echo \"--- src/google/protobuf/stubs/atomicops_internals_generic_gcc.h 2019-06-06 18:20:59.506309314 +0000\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \"+++ src/google/protobuf/stubs/atomicops_internals_generic_gcc.h 2019-06-05 19:19:01.626309314 +0000\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \"@@ -146,6 +146,14 @@\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \" return __atomic_load_n(ptr, __ATOMIC_RELAXED);\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \" }\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \"+inline Atomic64 Release_CompareAndSwap(volatile Atomic64* ptr,\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \"+ Atomic64 old_value,\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \"+ Atomic64 new_value) {\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \"+ __atomic_compare_exchange_n(ptr, &old_value, new_value, false,\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \"+ __ATOMIC_RELEASE, __ATOMIC_ACQUIRE);\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \"+ return old_value;\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \"+}\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \"+\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \" #endif // defined(__LP64__)\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \" } // namespace internal\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && sed -i \"468iPATCH_COMMAND cp $SOURCEDIR/protobuf-3.5.0.patch . \\\n && patch -p0 -i protobuf-3.5.0.patch\" CMakeLists.txt \\\n && sed -i \"510s/1.1.4/1.8.1/\" CMakeLists.txt \\\n && sed -i \"28i#include <sys/sysmacros.h>\" userspace/libscap/scap_fds.c \\\n && cd build \\\n && cmake -DUSE_BUNDLED_LUAJIT=OFF .. \\\n && make \\\n && make install \\\n && mkdir -p /opt/sysdig \\\n && cp $SOURCEDIR/sysdig-${SYSDIG_VER}/build/driver/sysdig-probe.ko /opt/sysdig \\\n && cp -r $SOURCEDIR/sysdig-${SYSDIG_VER}/build/userspace/sysdig /opt/sysdig \\\n && apt-get -y remove cmake gcc g++ linux-headers-$( uname -r ;) lua5.1 lua5.1-dev patch wget \\\n && apt-get autoremove -y \\\n && apt-get autoremove -y \\\n && rm -rf $SOURCEDIR \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/*\nWORKDIR /opt/sysdig\nCMD [\"bash\"]\n#   End of Dockerfile\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  © Copyright IBM Corporation 2017, 2019.\n#  LICENSE: Apache License, Version 2.0 (http://www.apache.org/licenses/LICENSE-2.0)\n# ######### Dockerfile for Sysdig version 0.26.1 #########\n#\n#  This Dockerfile builds a basic installation of Sysdig.\n#\n#  Sysdig is open source, system-level exploration: capture system state and activity from a running Linux instance, then save, filter and analyze.\n#  Sysdig is scriptable in Lua and includes a command line interface and a powerful interactive UI, csysdig, that runs in your terminal.\n#\n#  To build this image, from the directory containing this Dockerfile\n#  (assuming that the file is named Dockerfile):\n#  docker build -t <image_name> .\n#\n#  To run sysdig in a Docker container use below command\n#   docker run -it --privileged -v /var/run/docker.sock:/host/var/run/docker.sock -v /dev:/host/dev -v /proc:/host/proc:ro -v\n#    /boot:/host/boot:ro -v /lib/modules:/host/lib/modules:ro -v /usr:/host/usr:ro --name <container_name> <image_name>\n#\n#  The official website\n#  https://www.sysdig.org/\n# #################################################################################\n#  Base Image\nFROM s390x/ubuntu:16.04\nARG SYSDIG_VER=0.26.1\n#  The author\nMAINTAINER LoZ Open Source Ecosystem (https://www.ibm.com/developerworks/community/groups/community/lozopensource)\nLABEL RUN=\"docker run -i -t --privileged -v /var/run/docker.sock:/host/var/run/docker.sock -v /dev:/host/dev -v /proc:/host/proc:ro -v /boot:/host/boot:ro -v /lib/modules:/host/lib/modules:ro -v /usr:/host/usr:ro --name NAME IMAGE\"\nENV SOURCEDIR=\"/tmp/source\"\nWORKDIR $SOURCEDIR\n#  Install dependencies\nRUN apt-get update \\\n && apt-get install cmake gcc g++ libelf-dev lua5.1 lua5.1-dev patch tar wget linux-headers-$( uname -r ;) -y \\\n && cd $SOURCEDIR \\\n && wget https://github.com/draios/sysdig/archive/${SYSDIG_VER}.tar.gz \\\n && tar -xvzf ${SYSDIG_VER}.tar.gz \\\n && cd sysdig-${SYSDIG_VER} \\\n && mkdir build \\\n && echo \"--- src/google/protobuf/stubs/atomicops_internals_generic_gcc.h 2019-06-06 18:20:59.506309314 +0000\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \"+++ src/google/protobuf/stubs/atomicops_internals_generic_gcc.h 2019-06-05 19:19:01.626309314 +0000\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \"@@ -146,6 +146,14 @@\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \" return __atomic_load_n(ptr, __ATOMIC_RELAXED);\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \" }\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \"+inline Atomic64 Release_CompareAndSwap(volatile Atomic64* ptr,\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \"+ Atomic64 old_value,\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \"+ Atomic64 new_value) {\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \"+ __atomic_compare_exchange_n(ptr, &old_value, new_value, false,\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \"+ __ATOMIC_RELEASE, __ATOMIC_ACQUIRE);\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \"+ return old_value;\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \"+}\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \"+\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \" #endif // defined(__LP64__)\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \" } // namespace internal\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && sed -i \"468iPATCH_COMMAND cp $SOURCEDIR/protobuf-3.5.0.patch . \\\n && patch -p0 -i protobuf-3.5.0.patch\" CMakeLists.txt \\\n && sed -i \"510s/1.1.4/1.8.1/\" CMakeLists.txt \\\n && sed -i \"28i#include <sys/sysmacros.h>\" userspace/libscap/scap_fds.c \\\n && cd build \\\n && cmake -DUSE_BUNDLED_LUAJIT=OFF .. \\\n && make \\\n && make install \\\n && mkdir -p /opt/sysdig \\\n && cp $SOURCEDIR/sysdig-${SYSDIG_VER}/build/driver/sysdig-probe.ko /opt/sysdig \\\n && cp -r $SOURCEDIR/sysdig-${SYSDIG_VER}/build/userspace/sysdig /opt/sysdig \\\n && apt-get -y remove cmake gcc g++ linux-headers-$( uname -r ;) lua5.1 lua5.1-dev patch wget \\\n && apt-get autoremove -y \\\n && apt-get autoremove -y \\\n && rm -rf $SOURCEDIR \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/*\nWORKDIR /opt/sysdig\nCMD [\"bash\"]\n#  End of Dockerfile\n","injectedSmells":[],"originalDockerfileHash":"24350b5bb686a166c717eec1d0bdf898","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   © Copyright IBM Corporation 2017, 2019.\n#   LICENSE: Apache License, Version 2.0 (http://www.apache.org/licenses/LICENSE-2.0)\n#  ######### Dockerfile for Sysdig version 0.26.1 #########\n#\n#   This Dockerfile builds a basic installation of Sysdig.\n#\n#   Sysdig is open source, system-level exploration: capture system state and activity from a running Linux instance, then save, filter and analyze.\n#   Sysdig is scriptable in Lua and includes a command line interface and a powerful interactive UI, csysdig, that runs in your terminal.\n#\n#   To build this image, from the directory containing this Dockerfile\n#   (assuming that the file is named Dockerfile):\n#   docker build -t <image_name> .\n#\n#   To run sysdig in a Docker container use below command\n#    docker run -it --privileged -v /var/run/docker.sock:/host/var/run/docker.sock -v /dev:/host/dev -v /proc:/host/proc:ro -v\n#     /boot:/host/boot:ro -v /lib/modules:/host/lib/modules:ro -v /usr:/host/usr:ro --name <container_name> <image_name>\n#\n#   The official website\n#   https://www.sysdig.org/\n#  #################################################################################\n#   Base Image\nFROM s390x/ubuntu:16.04\nARG SYSDIG_VER=0.26.1\n#   The author\nMAINTAINER LoZ Open Source Ecosystem (https://www.ibm.com/developerworks/community/groups/community/lozopensource)\nLABEL RUN=\"docker run -i -t --privileged -v /var/run/docker.sock:/host/var/run/docker.sock -v /dev:/host/dev -v /proc:/host/proc:ro -v /boot:/host/boot:ro -v /lib/modules:/host/lib/modules:ro -v /usr:/host/usr:ro --name NAME IMAGE\"\nENV SOURCEDIR=\"/tmp/source\"\nWORKDIR $SOURCEDIR\n#   Install dependencies\nRUN apt-get update \\\n && apt-get install cmake gcc g++ libelf-dev lua5.1 lua5.1-dev patch tar wget linux-headers-$( uname -r ;) -y \\\n && cd $SOURCEDIR \\\n && wget https://github.com/draios/sysdig/archive/${SYSDIG_VER}.tar.gz \\\n && tar -xvzf ${SYSDIG_VER}.tar.gz \\\n && cd sysdig-${SYSDIG_VER} \\\n && mkdir build \\\n && echo \"--- src/google/protobuf/stubs/atomicops_internals_generic_gcc.h 2019-06-06 18:20:59.506309314 +0000\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \"+++ src/google/protobuf/stubs/atomicops_internals_generic_gcc.h 2019-06-05 19:19:01.626309314 +0000\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \"@@ -146,6 +146,14 @@\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \" return __atomic_load_n(ptr, __ATOMIC_RELAXED);\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \" }\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \"+inline Atomic64 Release_CompareAndSwap(volatile Atomic64* ptr,\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \"+ Atomic64 old_value,\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \"+ Atomic64 new_value) {\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \"+ __atomic_compare_exchange_n(ptr, &old_value, new_value, false,\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \"+ __ATOMIC_RELEASE, __ATOMIC_ACQUIRE);\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \"+ return old_value;\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \"+}\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \"+\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \" #endif // defined(__LP64__)\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && echo \" } // namespace internal\" >> $SOURCEDIR/protobuf-3.5.0.patch \\\n && sed -i \"468iPATCH_COMMAND cp $SOURCEDIR/protobuf-3.5.0.patch . \\\n && patch -p0 -i protobuf-3.5.0.patch\" CMakeLists.txt \\\n && sed -i \"510s/1.1.4/1.8.1/\" CMakeLists.txt \\\n && sed -i \"28i#include <sys/sysmacros.h>\" userspace/libscap/scap_fds.c \\\n && cd build \\\n && cmake -DUSE_BUNDLED_LUAJIT=OFF .. \\\n && make \\\n && make install \\\n && mkdir -p /opt/sysdig \\\n && cp $SOURCEDIR/sysdig-${SYSDIG_VER}/build/driver/sysdig-probe.ko /opt/sysdig \\\n && cp -r $SOURCEDIR/sysdig-${SYSDIG_VER}/build/userspace/sysdig /opt/sysdig \\\n && apt-get -y remove cmake gcc g++ linux-headers-$( uname -r ;) lua5.1 lua5.1-dev patch wget \\\n && apt-get autoremove -y \\\n && apt-get autoremove -y \\\n && rm -rf $SOURCEDIR \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/*\nWORKDIR /opt/sysdig\nCMD [\"bash\"]\n#   End of Dockerfile\n","originalDockerfileUglifiedHash":"99e535821acf79a716c6e326262d267c","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/5e167aeec9e520b8ba8e815dcecd8e604090b583.dockerfile"}