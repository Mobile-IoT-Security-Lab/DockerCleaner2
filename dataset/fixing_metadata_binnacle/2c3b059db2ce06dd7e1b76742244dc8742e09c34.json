{"seed":2080806160,"processedDockerfileHash":"0eb7b7718025730ffb7c0356a4c8506f","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","pin-package-manager-versions-apt-get","pin-package-manager-versions-npm","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM openjdk:8-jdk\nENV DEBIAN_FRONTEND=\"noninteractive\"\nRUN echo \"LC_ALL=en_US.UTF-8\" >> /etc/environment\nRUN echo \"LANG=en_US.UTF-8\" >> /etc/environment\nRUN echo \"NODE_ENV=development\" >> /etc/environment\nENV BASE_DIR=\"/home/dataturks\"\nENV BAZAR_PARENT_DIR=\"/home/dataturks\"\nRUN mkdir $BASE_DIR\nRUN mkdir $BASE_DIR/logs\nWORKDIR $BASE_DIR\n#   Install basics\nRUN apt-get update \\\n && apt-get install --no-install-recommends mysql-server -y \\\n && apt-get install --no-install-recommends apache2=2.4.56-1~deb11u1 -y \\\n && apt-get install --no-install-recommends php7.0 -y \\\n && apt-get install --no-install-recommends libapache2-mod-php7.0 -y\nCOPY ./docker/onprem-dataturks.com.conf /etc/apache2/sites-available/\nCOPY ./docker/onprem-dataturks.com.conf /etc/apache2/sites-available/000-default.conf\nRUN a2enmod proxy_http \\\n && a2enmod php7.0 \\\n && a2ensite onprem-dataturks.com.conf\nWORKDIR $BASE_DIR\n#  init mysql DB\nCOPY ./docker/mysqlInit.sql $BASE_DIR/mysqlInit.sql\nCOPY ./docker/init.sh $BASE_DIR/init.sh\nRUN chmod +x ./init.sh \\\n && ./init.sh\n#  Install Node 8\nRUN apt-get install --no-install-recommends build-essential=12.9 -y \\\n && curl -sL https://deb.nodesource.com/setup_8.x | bash \\\n && apt-get install --no-install-recommends nodejs=12.22.12~dfsg-1~deb11u3 --yes \\\n && node -v \\\n && npm -v \\\n && npm install nodemon@2.0.22 -g \\\n && nodemon -v\n#  Copy Bazaar.\nRUN mkdir $BAZAR_PARENT_DIR/bazaar\nRUN chmod -R 755 $BAZAR_PARENT_DIR/bazaar\nCOPY ./bazaar/src $BAZAR_PARENT_DIR/bazaar/src\nCOPY ./bazaar/api $BAZAR_PARENT_DIR/bazaar/api\nCOPY ./bazaar/webpack $BAZAR_PARENT_DIR/bazaar/webpack\nCOPY ./bazaar/semantic $BAZAR_PARENT_DIR/bazaar/semantic\nCOPY ./bazaar/bin $BAZAR_PARENT_DIR/bazaar/bin\nCOPY ./bazaar/build $BAZAR_PARENT_DIR/bazaar/build\nCOPY ./bazaar/static $BAZAR_PARENT_DIR/bazaar/static\nCOPY ./bazaar/js $BAZAR_PARENT_DIR/bazaar/js\nCOPY ./bazaar/css $BAZAR_PARENT_DIR/bazaar/css\nCOPY ./bazaar/img $BAZAR_PARENT_DIR/bazaar/img\nCOPY ./bazaar/vendor $BAZAR_PARENT_DIR/bazaar/vendor\nCOPY ./bazaar/.babelrc $BAZAR_PARENT_DIR/bazaar/.babelrc\nCOPY ./bazaar/server.babel.js $BAZAR_PARENT_DIR/bazaar/server.babel.js\nCOPY ./bazaar/semantic.json $BAZAR_PARENT_DIR/bazaar/semantic.json\nCOPY ./bazaar/package.json $BAZAR_PARENT_DIR/bazaar/package.json\nCOPY ./bazaar/onprem.php $BAZAR_PARENT_DIR/bazaar/onprem.php\n#  allow local uploads.\nWORKDIR $BAZAR_PARENT_DIR/bazaar\nRUN rm -rf $BAZAR_PARENT_DIR/bazaar/uploads \\\n && mkdir $BAZAR_PARENT_DIR/bazaar/uploads \\\n && npm install \\\n && npm run build-onprem \\\n && npm prune\n#  remove source.\nRUN rm -rf $BAZAR_PARENT_DIR/bazaar/src/components \\\n && rm -rf $BAZAR_PARENT_DIR/bazaar/src/containers \\\n && rm -rf $BAZAR_PARENT_DIR/bazaar/src/theme \\\n && rm -rf $BAZAR_PARENT_DIR/bazaar/src/utils\n#  set permissions for apache readable.\n#  RUN chmod -R 755 $BAZAR_PARENT_DIR/bazaar\nWORKDIR $BASE_DIR\nEXPOSE 9090/tcp\nEXPOSE 3000/tcp\nEXPOSE 3001/tcp\nEXPOSE 80/tcp\nCOPY ./code/hope/target/dataturks-1.0-SNAPSHOT.jar $BASE_DIR/dataturks-1.0-SNAPSHOT.jar\nCOPY ./code/hope/onprem.yml $BASE_DIR/onprem.yml\nCOPY ./docker/startup.sh $BASE_DIR/startup.sh\nRUN chmod +x ./startup.sh\nCMD ./startup.sh > ./startup_log.log\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM openjdk:8-jdk\nENV DEBIAN_FRONTEND=\"noninteractive\"\nRUN echo \"LC_ALL=en_US.UTF-8\" >> /etc/environment\nRUN echo \"LANG=en_US.UTF-8\" >> /etc/environment\nRUN echo \"NODE_ENV=development\" >> /etc/environment\nENV BASE_DIR=\"/home/dataturks\"\nENV BAZAR_PARENT_DIR=\"/home/dataturks\"\nRUN mkdir $BASE_DIR\nRUN mkdir $BASE_DIR/logs\nWORKDIR $BASE_DIR\n#  Install basics\nRUN apt-get update \\\n && apt-get install mysql-server -y \\\n && apt-get install apache2 -y \\\n && apt-get install php7.0 -y \\\n && apt-get install libapache2-mod-php7.0 -y\nCOPY ./docker/onprem-dataturks.com.conf /etc/apache2/sites-available/\nCOPY ./docker/onprem-dataturks.com.conf /etc/apache2/sites-available/000-default.conf\nRUN a2enmod proxy_http \\\n && a2enmod php7.0 \\\n && a2ensite onprem-dataturks.com.conf\nWORKDIR $BASE_DIR\n# init mysql DB\nCOPY ./docker/mysqlInit.sql $BASE_DIR/mysqlInit.sql\nCOPY ./docker/init.sh $BASE_DIR/init.sh\nRUN chmod +x ./init.sh \\\n && ./init.sh\n# Install Node 8\nRUN apt-get install build-essential -y \\\n && curl -sL https://deb.nodesource.com/setup_8.x | bash \\\n && apt-get install nodejs --yes \\\n && node -v \\\n && npm -v \\\n && npm install nodemon -g \\\n && nodemon -v\n# Copy Bazaar.\nRUN mkdir $BAZAR_PARENT_DIR/bazaar\nRUN chmod -R 755 $BAZAR_PARENT_DIR/bazaar\nCOPY ./bazaar/src $BAZAR_PARENT_DIR/bazaar/src\nCOPY ./bazaar/api $BAZAR_PARENT_DIR/bazaar/api\nCOPY ./bazaar/webpack $BAZAR_PARENT_DIR/bazaar/webpack\nCOPY ./bazaar/semantic $BAZAR_PARENT_DIR/bazaar/semantic\nCOPY ./bazaar/bin $BAZAR_PARENT_DIR/bazaar/bin\nCOPY ./bazaar/build $BAZAR_PARENT_DIR/bazaar/build\nCOPY ./bazaar/static $BAZAR_PARENT_DIR/bazaar/static\nCOPY ./bazaar/js $BAZAR_PARENT_DIR/bazaar/js\nCOPY ./bazaar/css $BAZAR_PARENT_DIR/bazaar/css\nCOPY ./bazaar/img $BAZAR_PARENT_DIR/bazaar/img\nCOPY ./bazaar/vendor $BAZAR_PARENT_DIR/bazaar/vendor\nCOPY ./bazaar/.babelrc $BAZAR_PARENT_DIR/bazaar/.babelrc\nCOPY ./bazaar/server.babel.js $BAZAR_PARENT_DIR/bazaar/server.babel.js\nCOPY ./bazaar/semantic.json $BAZAR_PARENT_DIR/bazaar/semantic.json\nCOPY ./bazaar/package.json $BAZAR_PARENT_DIR/bazaar/package.json\nCOPY ./bazaar/onprem.php $BAZAR_PARENT_DIR/bazaar/onprem.php\n# allow local uploads.\nWORKDIR $BAZAR_PARENT_DIR/bazaar\nRUN rm -rf $BAZAR_PARENT_DIR/bazaar/uploads \\\n && mkdir $BAZAR_PARENT_DIR/bazaar/uploads \\\n && npm install \\\n && npm run build-onprem \\\n && npm prune\n# remove source.\nRUN rm -rf $BAZAR_PARENT_DIR/bazaar/src/components \\\n && rm -rf $BAZAR_PARENT_DIR/bazaar/src/containers \\\n && rm -rf $BAZAR_PARENT_DIR/bazaar/src/theme \\\n && rm -rf $BAZAR_PARENT_DIR/bazaar/src/utils\n# set permissions for apache readable.\n# RUN chmod -R 755 $BAZAR_PARENT_DIR/bazaar\nWORKDIR $BASE_DIR\nEXPOSE 9090/tcp\nEXPOSE 3000/tcp\nEXPOSE 3001/tcp\nEXPOSE 80/tcp\nCOPY ./code/hope/target/dataturks-1.0-SNAPSHOT.jar $BASE_DIR/dataturks-1.0-SNAPSHOT.jar\nCOPY ./code/hope/onprem.yml $BASE_DIR/onprem.yml\nCOPY ./docker/startup.sh $BASE_DIR/startup.sh\nRUN chmod +x ./startup.sh\nCMD ./startup.sh > ./startup_log.log\n","injectedSmells":[],"originalDockerfileHash":"9b7082b83439a1e8007f6c7a7c069510","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM openjdk:8-jdk\nENV DEBIAN_FRONTEND=\"noninteractive\"\nRUN echo \"LC_ALL=en_US.UTF-8\" >> /etc/environment\nRUN echo \"LANG=en_US.UTF-8\" >> /etc/environment\nRUN echo \"NODE_ENV=development\" >> /etc/environment\nENV BASE_DIR=\"/home/dataturks\"\nENV BAZAR_PARENT_DIR=\"/home/dataturks\"\nRUN mkdir $BASE_DIR\nRUN mkdir $BASE_DIR/logs\nWORKDIR $BASE_DIR\n#   Install basics\nRUN apt-get update \\\n && apt-get install mysql-server -y \\\n && apt-get install apache2 -y \\\n && apt-get install php7.0 -y \\\n && apt-get install libapache2-mod-php7.0 -y\nCOPY ./docker/onprem-dataturks.com.conf /etc/apache2/sites-available/\nCOPY ./docker/onprem-dataturks.com.conf /etc/apache2/sites-available/000-default.conf\nRUN a2enmod proxy_http \\\n && a2enmod php7.0 \\\n && a2ensite onprem-dataturks.com.conf\nWORKDIR $BASE_DIR\n#  init mysql DB\nCOPY ./docker/mysqlInit.sql $BASE_DIR/mysqlInit.sql\nCOPY ./docker/init.sh $BASE_DIR/init.sh\nRUN chmod +x ./init.sh \\\n && ./init.sh\n#  Install Node 8\nRUN apt-get install build-essential -y \\\n && curl -sL https://deb.nodesource.com/setup_8.x | bash \\\n && apt-get install nodejs --yes \\\n && node -v \\\n && npm -v \\\n && npm install nodemon -g \\\n && nodemon -v\n#  Copy Bazaar.\nRUN mkdir $BAZAR_PARENT_DIR/bazaar\nRUN chmod -R 755 $BAZAR_PARENT_DIR/bazaar\nCOPY ./bazaar/src $BAZAR_PARENT_DIR/bazaar/src\nCOPY ./bazaar/api $BAZAR_PARENT_DIR/bazaar/api\nCOPY ./bazaar/webpack $BAZAR_PARENT_DIR/bazaar/webpack\nCOPY ./bazaar/semantic $BAZAR_PARENT_DIR/bazaar/semantic\nCOPY ./bazaar/bin $BAZAR_PARENT_DIR/bazaar/bin\nCOPY ./bazaar/build $BAZAR_PARENT_DIR/bazaar/build\nCOPY ./bazaar/static $BAZAR_PARENT_DIR/bazaar/static\nCOPY ./bazaar/js $BAZAR_PARENT_DIR/bazaar/js\nCOPY ./bazaar/css $BAZAR_PARENT_DIR/bazaar/css\nCOPY ./bazaar/img $BAZAR_PARENT_DIR/bazaar/img\nCOPY ./bazaar/vendor $BAZAR_PARENT_DIR/bazaar/vendor\nCOPY ./bazaar/.babelrc $BAZAR_PARENT_DIR/bazaar/.babelrc\nCOPY ./bazaar/server.babel.js $BAZAR_PARENT_DIR/bazaar/server.babel.js\nCOPY ./bazaar/semantic.json $BAZAR_PARENT_DIR/bazaar/semantic.json\nCOPY ./bazaar/package.json $BAZAR_PARENT_DIR/bazaar/package.json\nCOPY ./bazaar/onprem.php $BAZAR_PARENT_DIR/bazaar/onprem.php\n#  allow local uploads.\nWORKDIR $BAZAR_PARENT_DIR/bazaar\nRUN rm -rf $BAZAR_PARENT_DIR/bazaar/uploads \\\n && mkdir $BAZAR_PARENT_DIR/bazaar/uploads \\\n && npm install \\\n && npm run build-onprem \\\n && npm prune\n#  remove source.\nRUN rm -rf $BAZAR_PARENT_DIR/bazaar/src/components \\\n && rm -rf $BAZAR_PARENT_DIR/bazaar/src/containers \\\n && rm -rf $BAZAR_PARENT_DIR/bazaar/src/theme \\\n && rm -rf $BAZAR_PARENT_DIR/bazaar/src/utils\n#  set permissions for apache readable.\n#  RUN chmod -R 755 $BAZAR_PARENT_DIR/bazaar\nWORKDIR $BASE_DIR\nEXPOSE 9090/tcp\nEXPOSE 3000/tcp\nEXPOSE 3001/tcp\nEXPOSE 80/tcp\nCOPY ./code/hope/target/dataturks-1.0-SNAPSHOT.jar $BASE_DIR/dataturks-1.0-SNAPSHOT.jar\nCOPY ./code/hope/onprem.yml $BASE_DIR/onprem.yml\nCOPY ./docker/startup.sh $BASE_DIR/startup.sh\nRUN chmod +x ./startup.sh\nCMD ./startup.sh > ./startup_log.log\n","originalDockerfileUglifiedHash":"cffd422211e65ce1f5e61a66658a3ab1","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/2c3b059db2ce06dd7e1b76742244dc8742e09c34.dockerfile"}