{"seed":3030262442,"processedDockerfileHash":"15f67ee8e77a6245ffe9399b502f9e6e","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apt-get","have-a-healthcheck","have-a-user"],"processedDockerfile":"#   Copyright 2017 The Go Authors. All rights reserved.\n#   Use of this source code is governed by a BSD-style\n#   license that can be found in the LICENSE file.\nFROM debian:stretch AS nacl\nRUN apt-get update \\\n && apt-get install --no-install-recommends curl=7.52.1-5+deb9u16 bzip2=1.0.6-8.1 ca-certificates=20200601~deb9u2 -y\nRUN curl -s https://storage.googleapis.com/nativeclient-mirror/nacl/nacl_sdk/trunk.544461/naclsdk_linux.tar.bz2 | tar -xj -C /tmp --strip-components=2 pepper_67/tools/sel_ldr_x86_64\nFROM debian:stretch AS build\nLABEL maintainer=\"golang-dev@googlegroups.com\"\nENV BUILD_DEPS=\"'curl git gcc patch libc6-dev ca-certificates'\"\nRUN apt-get update \\\n && apt-get install --no-install-recommends ${BUILD_DEPS} -y\nENV GOPATH=\"/go\"\nENV PATH=\"/usr/local/go/bin:$GOPATH/bin:$PATH\"\nENV GOROOT_BOOTSTRAP=\"/usr/local/gobootstrap\"\nARG GO_VERSION=go1.12.6\nENV GO_VERSION=\"${GO_VERSION}\"\n#   Fake time\nCOPY enable-fake-time.patch /usr/local/playground/\n#   Fake file system\nCOPY fake_fs.lst /usr/local/playground/\n#   Get the Go binary.\nRUN curl -sSL https://dl.google.com/go/$GO_VERSION.linux-amd64.tar.gz -o /tmp/go.tar.gz\nRUN curl -sSL https://dl.google.com/go/$GO_VERSION.linux-amd64.tar.gz.sha256 -o /tmp/go.tar.gz.sha256\nRUN echo \"$( cat /tmp/go.tar.gz.sha256 ;) /tmp/go.tar.gz\" | sha256sum -c -\nRUN tar -C /usr/local/ -vxzf /tmp/go.tar.gz\n#   Make a copy for GOROOT_BOOTSTRAP, because we rebuild the toolchain and make.bash removes bin/go as its first step.\nRUN cp -R /usr/local/go $GOROOT_BOOTSTRAP\n#   Apply the fake time and fake filesystem patches.\nRUN patch /usr/local/go/src/runtime/rt0_nacl_amd64p32.s /usr/local/playground/enable-fake-time.patch\nRUN cd /usr/local/go \\\n && go run misc/nacl/mkzip.go -p syscall /usr/local/playground/fake_fs.lst src/syscall/fstest_nacl.go\n#   Re-build the Go toolchain.\nRUN cd /usr/local/go/src \\\n && GOOS=nacl GOARCH=amd64p32 ./make.bash --no-clean\nRUN mkdir /gocache\nENV GOCACHE=\"/gocache\"\nENV GO111MODULE=\"on\"\nCOPY go.mod /go/src/playground/go.mod\nCOPY go.sum /go/src/playground/go.sum\nWORKDIR /go/src/playground\n#   Pre-build some packages to speed final install later.\nRUN go install cloud.google.com/go/compute/metadata\nRUN go install cloud.google.com/go/datastore\nRUN go install github.com/bradfitz/gomemcache/memcache\nRUN go install golang.org/x/tools/godoc/static\nRUN go install golang.org/x/tools/imports\nRUN go install github.com/rogpeppe/go-internal/modfile\nRUN go install github.com/rogpeppe/go-internal/txtar\n#   Add and compile playground daemon\nCOPY . /go/src/playground/\nWORKDIR /go/src/playground\nRUN go install\nFROM debian:stretch\nRUN apt-get update \\\n && apt-get install --no-install-recommends git=1:2.11.0-3+deb9u7 ca-certificates=20200601~deb9u2 -y\nCOPY --from=build /usr/local/go /usr/local/go\nCOPY --from=nacl /tmp/sel_ldr_x86_64 /usr/local/bin\nENV GOPATH=\"/go\"\nENV PATH=\"/usr/local/go/bin:$GOPATH/bin:$PATH\"\n#   Add and compile tour packages\nRUN GOOS=nacl GOARCH=amd64p32 go get golang.org/x/tour/pic golang.org/x/tour/reader golang.org/x/tour/tree golang.org/x/tour/wc golang.org/x/talks/content/2016/applicative/google \\\n && rm -rf $GOPATH/src/golang.org/x/tour/.git \\\n && rm -rf $GOPATH/src/golang.org/x/talks/.git\n#   Add tour packages under their old import paths (so old snippets still work)\nRUN mkdir -p $GOPATH/src/code.google.com/p/go-tour \\\n && cp -R $GOPATH/src/golang.org/x/tour/* $GOPATH/src/code.google.com/p/go-tour/ \\\n && sed -i 's_// import_// public import_' $( find $GOPATH/src/code.google.com/p/go-tour/ -name *.go ;) \\\n && go install code.google.com/p/go-tour/pic code.google.com/p/go-tour/reader code.google.com/p/go-tour/tree code.google.com/p/go-tour/wc\nRUN mkdir /app\nCOPY --from=build /go/bin/playground /app\nCOPY edit.html /app\nCOPY static /app/static\nWORKDIR /app\n#   Run tests\nRUN /app/playground test\n#   Whether we allow third-party imports via proxy.golang.org:\nENV ALLOW_PLAY_MODULE_DOWNLOADS=\"true\"\nEXPOSE 8080/tcp\nENTRYPOINT [\"/app/playground\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  Copyright 2017 The Go Authors. All rights reserved.\n#  Use of this source code is governed by a BSD-style\n#  license that can be found in the LICENSE file.\nFROM debian:stretch AS nacl\nRUN apt-get update \\\n && apt-get install --no-install-recommends curl bzip2 ca-certificates -y\nRUN curl -s https://storage.googleapis.com/nativeclient-mirror/nacl/nacl_sdk/trunk.544461/naclsdk_linux.tar.bz2 | tar -xj -C /tmp --strip-components=2 pepper_67/tools/sel_ldr_x86_64\nFROM debian:stretch AS build\nLABEL maintainer=\"golang-dev@googlegroups.com\"\nENV BUILD_DEPS=\"'curl git gcc patch libc6-dev ca-certificates'\"\nRUN apt-get update \\\n && apt-get install --no-install-recommends ${BUILD_DEPS} -y\nENV GOPATH=\"/go\"\nENV PATH=\"/usr/local/go/bin:$GOPATH/bin:$PATH\"\nENV GOROOT_BOOTSTRAP=\"/usr/local/gobootstrap\"\nARG GO_VERSION=go1.12.6\nENV GO_VERSION=\"${GO_VERSION}\"\n#  Fake time\nCOPY enable-fake-time.patch /usr/local/playground/\n#  Fake file system\nCOPY fake_fs.lst /usr/local/playground/\n#  Get the Go binary.\nRUN curl -sSL https://dl.google.com/go/$GO_VERSION.linux-amd64.tar.gz -o /tmp/go.tar.gz\nRUN curl -sSL https://dl.google.com/go/$GO_VERSION.linux-amd64.tar.gz.sha256 -o /tmp/go.tar.gz.sha256\nRUN echo \"$( cat /tmp/go.tar.gz.sha256 ;) /tmp/go.tar.gz\" | sha256sum -c -\nRUN tar -C /usr/local/ -vxzf /tmp/go.tar.gz\n#  Make a copy for GOROOT_BOOTSTRAP, because we rebuild the toolchain and make.bash removes bin/go as its first step.\nRUN cp -R /usr/local/go $GOROOT_BOOTSTRAP\n#  Apply the fake time and fake filesystem patches.\nRUN patch /usr/local/go/src/runtime/rt0_nacl_amd64p32.s /usr/local/playground/enable-fake-time.patch\nRUN cd /usr/local/go \\\n && go run misc/nacl/mkzip.go -p syscall /usr/local/playground/fake_fs.lst src/syscall/fstest_nacl.go\n#  Re-build the Go toolchain.\nRUN cd /usr/local/go/src \\\n && GOOS=nacl GOARCH=amd64p32 ./make.bash --no-clean\nRUN mkdir /gocache\nENV GOCACHE=\"/gocache\"\nENV GO111MODULE=\"on\"\nCOPY go.mod /go/src/playground/go.mod\nCOPY go.sum /go/src/playground/go.sum\nWORKDIR /go/src/playground\n#  Pre-build some packages to speed final install later.\nRUN go install cloud.google.com/go/compute/metadata\nRUN go install cloud.google.com/go/datastore\nRUN go install github.com/bradfitz/gomemcache/memcache\nRUN go install golang.org/x/tools/godoc/static\nRUN go install golang.org/x/tools/imports\nRUN go install github.com/rogpeppe/go-internal/modfile\nRUN go install github.com/rogpeppe/go-internal/txtar\n#  Add and compile playground daemon\nCOPY . /go/src/playground/\nWORKDIR /go/src/playground\nRUN go install\nFROM debian:stretch\nRUN apt-get update \\\n && apt-get install --no-install-recommends git ca-certificates -y\nCOPY --from=build /usr/local/go /usr/local/go\nCOPY --from=nacl /tmp/sel_ldr_x86_64 /usr/local/bin\nENV GOPATH=\"/go\"\nENV PATH=\"/usr/local/go/bin:$GOPATH/bin:$PATH\"\n#  Add and compile tour packages\nRUN GOOS=nacl GOARCH=amd64p32 go get golang.org/x/tour/pic golang.org/x/tour/reader golang.org/x/tour/tree golang.org/x/tour/wc golang.org/x/talks/content/2016/applicative/google \\\n && rm -rf $GOPATH/src/golang.org/x/tour/.git \\\n && rm -rf $GOPATH/src/golang.org/x/talks/.git\n#  Add tour packages under their old import paths (so old snippets still work)\nRUN mkdir -p $GOPATH/src/code.google.com/p/go-tour \\\n && cp -R $GOPATH/src/golang.org/x/tour/* $GOPATH/src/code.google.com/p/go-tour/ \\\n && sed -i 's_// import_// public import_' $( find $GOPATH/src/code.google.com/p/go-tour/ -name *.go ;) \\\n && go install code.google.com/p/go-tour/pic code.google.com/p/go-tour/reader code.google.com/p/go-tour/tree code.google.com/p/go-tour/wc\nRUN mkdir /app\nCOPY --from=build /go/bin/playground /app\nCOPY edit.html /app\nCOPY static /app/static\nWORKDIR /app\n#  Run tests\nRUN /app/playground test\n#  Whether we allow third-party imports via proxy.golang.org:\nENV ALLOW_PLAY_MODULE_DOWNLOADS=\"true\"\nEXPOSE 8080/tcp\nENTRYPOINT [\"/app/playground\"]\n","injectedSmells":[],"originalDockerfileHash":"85a6c6682da6a68614ba21c1b49e22aa","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   Copyright 2017 The Go Authors. All rights reserved.\n#   Use of this source code is governed by a BSD-style\n#   license that can be found in the LICENSE file.\nFROM debian:stretch AS nacl\nRUN apt-get update \\\n && apt-get install --no-install-recommends curl bzip2 ca-certificates -y\nRUN curl -s https://storage.googleapis.com/nativeclient-mirror/nacl/nacl_sdk/trunk.544461/naclsdk_linux.tar.bz2 | tar -xj -C /tmp --strip-components=2 pepper_67/tools/sel_ldr_x86_64\nFROM debian:stretch AS build\nLABEL maintainer=\"golang-dev@googlegroups.com\"\nENV BUILD_DEPS=\"'curl git gcc patch libc6-dev ca-certificates'\"\nRUN apt-get update \\\n && apt-get install --no-install-recommends ${BUILD_DEPS} -y\nENV GOPATH=\"/go\"\nENV PATH=\"/usr/local/go/bin:$GOPATH/bin:$PATH\"\nENV GOROOT_BOOTSTRAP=\"/usr/local/gobootstrap\"\nARG GO_VERSION=go1.12.6\nENV GO_VERSION=\"${GO_VERSION}\"\n#   Fake time\nCOPY enable-fake-time.patch /usr/local/playground/\n#   Fake file system\nCOPY fake_fs.lst /usr/local/playground/\n#   Get the Go binary.\nRUN curl -sSL https://dl.google.com/go/$GO_VERSION.linux-amd64.tar.gz -o /tmp/go.tar.gz\nRUN curl -sSL https://dl.google.com/go/$GO_VERSION.linux-amd64.tar.gz.sha256 -o /tmp/go.tar.gz.sha256\nRUN echo \"$( cat /tmp/go.tar.gz.sha256 ;) /tmp/go.tar.gz\" | sha256sum -c -\nRUN tar -C /usr/local/ -vxzf /tmp/go.tar.gz\n#   Make a copy for GOROOT_BOOTSTRAP, because we rebuild the toolchain and make.bash removes bin/go as its first step.\nRUN cp -R /usr/local/go $GOROOT_BOOTSTRAP\n#   Apply the fake time and fake filesystem patches.\nRUN patch /usr/local/go/src/runtime/rt0_nacl_amd64p32.s /usr/local/playground/enable-fake-time.patch\nRUN cd /usr/local/go \\\n && go run misc/nacl/mkzip.go -p syscall /usr/local/playground/fake_fs.lst src/syscall/fstest_nacl.go\n#   Re-build the Go toolchain.\nRUN cd /usr/local/go/src \\\n && GOOS=nacl GOARCH=amd64p32 ./make.bash --no-clean\nRUN mkdir /gocache\nENV GOCACHE=\"/gocache\"\nENV GO111MODULE=\"on\"\nCOPY go.mod /go/src/playground/go.mod\nCOPY go.sum /go/src/playground/go.sum\nWORKDIR /go/src/playground\n#   Pre-build some packages to speed final install later.\nRUN go install cloud.google.com/go/compute/metadata\nRUN go install cloud.google.com/go/datastore\nRUN go install github.com/bradfitz/gomemcache/memcache\nRUN go install golang.org/x/tools/godoc/static\nRUN go install golang.org/x/tools/imports\nRUN go install github.com/rogpeppe/go-internal/modfile\nRUN go install github.com/rogpeppe/go-internal/txtar\n#   Add and compile playground daemon\nCOPY . /go/src/playground/\nWORKDIR /go/src/playground\nRUN go install\nFROM debian:stretch\nRUN apt-get update \\\n && apt-get install --no-install-recommends git ca-certificates -y\nCOPY --from=build /usr/local/go /usr/local/go\nCOPY --from=nacl /tmp/sel_ldr_x86_64 /usr/local/bin\nENV GOPATH=\"/go\"\nENV PATH=\"/usr/local/go/bin:$GOPATH/bin:$PATH\"\n#   Add and compile tour packages\nRUN GOOS=nacl GOARCH=amd64p32 go get golang.org/x/tour/pic golang.org/x/tour/reader golang.org/x/tour/tree golang.org/x/tour/wc golang.org/x/talks/content/2016/applicative/google \\\n && rm -rf $GOPATH/src/golang.org/x/tour/.git \\\n && rm -rf $GOPATH/src/golang.org/x/talks/.git\n#   Add tour packages under their old import paths (so old snippets still work)\nRUN mkdir -p $GOPATH/src/code.google.com/p/go-tour \\\n && cp -R $GOPATH/src/golang.org/x/tour/* $GOPATH/src/code.google.com/p/go-tour/ \\\n && sed -i 's_// import_// public import_' $( find $GOPATH/src/code.google.com/p/go-tour/ -name *.go ;) \\\n && go install code.google.com/p/go-tour/pic code.google.com/p/go-tour/reader code.google.com/p/go-tour/tree code.google.com/p/go-tour/wc\nRUN mkdir /app\nCOPY --from=build /go/bin/playground /app\nCOPY edit.html /app\nCOPY static /app/static\nWORKDIR /app\n#   Run tests\nRUN /app/playground test\n#   Whether we allow third-party imports via proxy.golang.org:\nENV ALLOW_PLAY_MODULE_DOWNLOADS=\"true\"\nEXPOSE 8080/tcp\nENTRYPOINT [\"/app/playground\"]\n","originalDockerfileUglifiedHash":"fb07241e2dcee49e174402cf1844beda","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/3ea5419e53298701b23edb29d3e600702254926f.dockerfile"}