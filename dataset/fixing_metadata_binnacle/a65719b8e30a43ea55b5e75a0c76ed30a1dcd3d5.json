{"seed":1541737638,"processedDockerfileHash":"de367b3d8282f4df23822f75b8e5ab3a","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM centos:7\nARG GEOMESA_VERSION\nCOPY tarballs/geomesa-accumulo-dist_2.11-${GEOMESA_VERSION}-bin.tar.gz accumulo-dist.tar.gz\nRUN tar -zxf accumulo-dist.tar.gz\nFROM centos:7\nARG GEOMESA_VERSION\nCOPY tarballs/geomesa-kafka-dist_2.11-${GEOMESA_VERSION}-bin.tar.gz kafka-dist.tar.gz\nRUN tar -zxf kafka-dist.tar.gz\nFROM quay.io/geomesa/base:__TAG__\nARG GEOMESA_VERSION\nARG ACCUMULO_VERSION\nARG THRIFT_VERSION\nENV ACCUMULO_VERSION=\"${ACCUMULO_VERSION}\"\nENV THRIFT_VERSION=\"${THRIFT_VERSION}\"\nENV HADOOP_VERSION=\"2.8.4\"\nENV GEOSERVER_VERSION=\"2.14.1\"\nENV TOMCAT_VERSION=\"8.5.23\"\n#   Install tomcat\nRUN set -x \\\n && mkdir -p /opt/tomcat/webapps/geoserver \\\n && curl -sS https://archive.apache.org/dist/tomcat/tomcat-8/v${TOMCAT_VERSION}/bin/apache-tomcat-${TOMCAT_VERSION}.tar.gz | tar -zx -C /opt/tomcat --strip-components=1\nRUN set -x \\\n && curl -sS -L -o /tmp/geoserver-war.zip https://downloads.sourceforge.net/project/geoserver/GeoServer/${GEOSERVER_VERSION}/geoserver-${GEOSERVER_VERSION}-war.zip \\\n && unzip /tmp/geoserver-war.zip geoserver.war -d /tmp \\\n && unzip /tmp/geoserver.war -d /opt/tomcat/webapps/geoserver \\\n && rm -rf /tmp/geoserver-war.zip /tmp/geoserver.war /opt/tomcat/webapps/geoserver/META-INF\n#   Install geoserver WPS plugin\nRUN set -x \\\n && curl -sS -L -o /tmp/geoserver-wps.zip https://downloads.sourceforge.net/project/geoserver/GeoServer/${GEOSERVER_VERSION}/extensions/geoserver-${GEOSERVER_VERSION}-wps-plugin.zip \\\n && unzip -j /tmp/geoserver-wps.zip -d /opt/tomcat/webapps/geoserver/WEB-INF/lib/ \\\n && rm -rf /tmp/geoserver-wps.zip\n#   Install Geomesa Accumulo Distribution\nCOPY --from=0 /geomesa-accumulo* /opt/geomesa/\n#   Install GeoMesa Accumulo DataStore\nRUN set -x \\\n && cd /opt/tomcat/webapps/geoserver/WEB-INF/lib/ \\\n && tar zxvf /opt/geomesa/dist/gs-plugins/geomesa-accumulo-gs-plugin_2.11-${GEOMESA_VERSION}-install.tar.gz\n#   Install GeoMesa Accumulo BlobStore\nRUN set -x \\\n && cd /opt/tomcat/webapps/geoserver/WEB-INF/lib/ \\\n && tar zxvf /opt/geomesa/dist/gs-plugins/geomesa-blobstore-gs-plugin_2.11-${GEOMESA_VERSION}-install.tar.gz\n#   Install GeoMesa Stream Store\nRUN set -x \\\n && cd /opt/tomcat/webapps/geoserver/WEB-INF/lib/ \\\n && tar zxvf /opt/geomesa/dist/gs-plugins/geomesa-stream-gs-plugin_2.11-${GEOMESA_VERSION}-install.tar.gz\n#   Install GeoMesa GeoJson Support\nRUN set -x \\\n && cd /opt/tomcat/webapps/geoserver/WEB-INF/lib/ \\\n && tar zxvf /opt/geomesa/dist/gs-plugins/geomesa-geojson-gs-plugin_2.11-${GEOMESA_VERSION}-install.tar.gz\n#   Install GeoMesa Process Jar\nRUN set -x \\\n && cd /opt/tomcat/webapps/geoserver/WEB-INF/lib/ \\\n && cp /opt/geomesa/dist/gs-plugins/geomesa-process-wps_2.11-${GEOMESA_VERSION}.jar .\n#   Install Hadoop and Accumulo specific jars\nRUN set -x \\\n && /opt/geomesa/bin/install-hadoop-accumulo.sh /opt/tomcat/webapps/geoserver/WEB-INF/lib -a ${ACCUMULO_VERSION} -h ${HADOOP_VERSION} -t ${THRIFT_VERSION}\n#   Install Geomesa Kafka Distribution\nCOPY --from=1 /geomesa-kafka* /opt/geomesa-kafka/\n#   Install GeoMesa Kafka DataStore\nRUN set -x \\\n && cd /opt/tomcat/webapps/geoserver/WEB-INF/lib/ \\\n && tar zxvf /opt/geomesa-kafka/dist/gs-plugins/geomesa-kafka-gs-plugin_2.11-${GEOMESA_VERSION}-install.tar.gz \\\n && rm /opt/tomcat/webapps/geoserver/WEB-INF/lib/zookeeper*.jar \\\n && /opt/geomesa-kafka/bin/install-kafka.sh /opt/tomcat/webapps/geoserver/WEB-INF/lib\nFROM quay.io/geomesa/base:__TAG__\nARG GEOMESA_VERSION\nARG ACCUMULO_VERSION\nARG THRIFT_VERSION\nENV ACCUMULO_VERSION=\"${ACCUMULO_VERSION}\"\nENV GEOMESA_VERSION=\"${GEOMESA_VERSION}\"\nENV THRIFT_VERSION=\"${THRIFT_VERSION}\"\nENV HADOOP_VERSION=\"2.8.4\"\nENV GEOSERVER_VERSION=\"2.14.1\"\nENV TOMCAT_VERSION=\"8.5.23\"\nENV CATALINA_OPTS=\"\\\"-Xmx8g -XX:MaxPermSize=512M -Duser.timezone=UTC -server -Djava.awt.headless=true\\\"\"\nCOPY --from=2 /opt/tomcat /opt/tomcat/\nRUN set -x \\\n && groupadd tomcat \\\n && useradd -M -s /bin/nologin -g tomcat -d /opt/tomcat tomcat \\\n && chown root /opt/tomcat/webapps/geoserver/WEB-INF/lib/* \\\n && chgrp root /opt/tomcat/webapps/geoserver/WEB-INF/lib/*\nCOPY server.xml /opt/tomcat/conf/server.xml\nVOLUME [\"/opt/tomcat/webapps/geoserver/data\"]\nEXPOSE 9090/tcp\nCMD [\"/opt/tomcat/bin/catalina.sh\", \"run\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM centos:7\nARG GEOMESA_VERSION\nCOPY tarballs/geomesa-accumulo-dist_2.11-${GEOMESA_VERSION}-bin.tar.gz accumulo-dist.tar.gz\nRUN tar -zxf accumulo-dist.tar.gz\nFROM centos:7\nARG GEOMESA_VERSION\nCOPY tarballs/geomesa-kafka-dist_2.11-${GEOMESA_VERSION}-bin.tar.gz kafka-dist.tar.gz\nRUN tar -zxf kafka-dist.tar.gz\nFROM quay.io/geomesa/base:__TAG__\nARG GEOMESA_VERSION\nARG ACCUMULO_VERSION\nARG THRIFT_VERSION\nENV ACCUMULO_VERSION=\"${ACCUMULO_VERSION}\"\nENV THRIFT_VERSION=\"${THRIFT_VERSION}\"\nENV HADOOP_VERSION=\"2.8.4\"\nENV GEOSERVER_VERSION=\"2.14.1\"\nENV TOMCAT_VERSION=\"8.5.23\"\n#  Install tomcat\nRUN set -x \\\n && mkdir -p /opt/tomcat/webapps/geoserver \\\n && curl -sS https://archive.apache.org/dist/tomcat/tomcat-8/v${TOMCAT_VERSION}/bin/apache-tomcat-${TOMCAT_VERSION}.tar.gz | tar -zx -C /opt/tomcat --strip-components=1\nRUN set -x \\\n && curl -sS -L -o /tmp/geoserver-war.zip https://downloads.sourceforge.net/project/geoserver/GeoServer/${GEOSERVER_VERSION}/geoserver-${GEOSERVER_VERSION}-war.zip \\\n && unzip /tmp/geoserver-war.zip geoserver.war -d /tmp \\\n && unzip /tmp/geoserver.war -d /opt/tomcat/webapps/geoserver \\\n && rm -rf /tmp/geoserver-war.zip /tmp/geoserver.war /opt/tomcat/webapps/geoserver/META-INF\n#  Install geoserver WPS plugin\nRUN set -x \\\n && curl -sS -L -o /tmp/geoserver-wps.zip https://downloads.sourceforge.net/project/geoserver/GeoServer/${GEOSERVER_VERSION}/extensions/geoserver-${GEOSERVER_VERSION}-wps-plugin.zip \\\n && unzip -j /tmp/geoserver-wps.zip -d /opt/tomcat/webapps/geoserver/WEB-INF/lib/ \\\n && rm -rf /tmp/geoserver-wps.zip\n#  Install Geomesa Accumulo Distribution\nCOPY --from=0 /geomesa-accumulo* /opt/geomesa/\n#  Install GeoMesa Accumulo DataStore\nRUN set -x \\\n && cd /opt/tomcat/webapps/geoserver/WEB-INF/lib/ \\\n && tar zxvf /opt/geomesa/dist/gs-plugins/geomesa-accumulo-gs-plugin_2.11-${GEOMESA_VERSION}-install.tar.gz\n#  Install GeoMesa Accumulo BlobStore\nRUN set -x \\\n && cd /opt/tomcat/webapps/geoserver/WEB-INF/lib/ \\\n && tar zxvf /opt/geomesa/dist/gs-plugins/geomesa-blobstore-gs-plugin_2.11-${GEOMESA_VERSION}-install.tar.gz\n#  Install GeoMesa Stream Store\nRUN set -x \\\n && cd /opt/tomcat/webapps/geoserver/WEB-INF/lib/ \\\n && tar zxvf /opt/geomesa/dist/gs-plugins/geomesa-stream-gs-plugin_2.11-${GEOMESA_VERSION}-install.tar.gz\n#  Install GeoMesa GeoJson Support\nRUN set -x \\\n && cd /opt/tomcat/webapps/geoserver/WEB-INF/lib/ \\\n && tar zxvf /opt/geomesa/dist/gs-plugins/geomesa-geojson-gs-plugin_2.11-${GEOMESA_VERSION}-install.tar.gz\n#  Install GeoMesa Process Jar\nRUN set -x \\\n && cd /opt/tomcat/webapps/geoserver/WEB-INF/lib/ \\\n && cp /opt/geomesa/dist/gs-plugins/geomesa-process-wps_2.11-${GEOMESA_VERSION}.jar .\n#  Install Hadoop and Accumulo specific jars\nRUN set -x \\\n && /opt/geomesa/bin/install-hadoop-accumulo.sh /opt/tomcat/webapps/geoserver/WEB-INF/lib -a ${ACCUMULO_VERSION} -h ${HADOOP_VERSION} -t ${THRIFT_VERSION}\n#  Install Geomesa Kafka Distribution\nCOPY --from=1 /geomesa-kafka* /opt/geomesa-kafka/\n#  Install GeoMesa Kafka DataStore\nRUN set -x \\\n && cd /opt/tomcat/webapps/geoserver/WEB-INF/lib/ \\\n && tar zxvf /opt/geomesa-kafka/dist/gs-plugins/geomesa-kafka-gs-plugin_2.11-${GEOMESA_VERSION}-install.tar.gz \\\n && rm /opt/tomcat/webapps/geoserver/WEB-INF/lib/zookeeper*.jar \\\n && /opt/geomesa-kafka/bin/install-kafka.sh /opt/tomcat/webapps/geoserver/WEB-INF/lib\nFROM quay.io/geomesa/base:__TAG__\nARG GEOMESA_VERSION\nARG ACCUMULO_VERSION\nARG THRIFT_VERSION\nENV ACCUMULO_VERSION=\"${ACCUMULO_VERSION}\"\nENV GEOMESA_VERSION=\"${GEOMESA_VERSION}\"\nENV THRIFT_VERSION=\"${THRIFT_VERSION}\"\nENV HADOOP_VERSION=\"2.8.4\"\nENV GEOSERVER_VERSION=\"2.14.1\"\nENV TOMCAT_VERSION=\"8.5.23\"\nENV CATALINA_OPTS=\"\\\"-Xmx8g -XX:MaxPermSize=512M -Duser.timezone=UTC -server -Djava.awt.headless=true\\\"\"\nCOPY --from=2 /opt/tomcat /opt/tomcat/\nRUN set -x \\\n && groupadd tomcat \\\n && useradd -M -s /bin/nologin -g tomcat -d /opt/tomcat tomcat \\\n && chown root /opt/tomcat/webapps/geoserver/WEB-INF/lib/* \\\n && chgrp root /opt/tomcat/webapps/geoserver/WEB-INF/lib/*\nCOPY server.xml /opt/tomcat/conf/server.xml\nVOLUME [\"/opt/tomcat/webapps/geoserver/data\"]\nEXPOSE 9090/tcp\nCMD [\"/opt/tomcat/bin/catalina.sh\", \"run\"]\n","injectedSmells":[],"originalDockerfileHash":"e5f556a648362dec4d374c8d5be50ca6","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM centos:7\nARG GEOMESA_VERSION\nCOPY tarballs/geomesa-accumulo-dist_2.11-${GEOMESA_VERSION}-bin.tar.gz accumulo-dist.tar.gz\nRUN tar -zxf accumulo-dist.tar.gz\nFROM centos:7\nARG GEOMESA_VERSION\nCOPY tarballs/geomesa-kafka-dist_2.11-${GEOMESA_VERSION}-bin.tar.gz kafka-dist.tar.gz\nRUN tar -zxf kafka-dist.tar.gz\nFROM quay.io/geomesa/base:__TAG__\nARG GEOMESA_VERSION\nARG ACCUMULO_VERSION\nARG THRIFT_VERSION\nENV ACCUMULO_VERSION=\"${ACCUMULO_VERSION}\"\nENV THRIFT_VERSION=\"${THRIFT_VERSION}\"\nENV HADOOP_VERSION=\"2.8.4\"\nENV GEOSERVER_VERSION=\"2.14.1\"\nENV TOMCAT_VERSION=\"8.5.23\"\n#   Install tomcat\nRUN set -x \\\n && mkdir -p /opt/tomcat/webapps/geoserver \\\n && curl -sS https://archive.apache.org/dist/tomcat/tomcat-8/v${TOMCAT_VERSION}/bin/apache-tomcat-${TOMCAT_VERSION}.tar.gz | tar -zx -C /opt/tomcat --strip-components=1\nRUN set -x \\\n && curl -sS -L -o /tmp/geoserver-war.zip https://downloads.sourceforge.net/project/geoserver/GeoServer/${GEOSERVER_VERSION}/geoserver-${GEOSERVER_VERSION}-war.zip \\\n && unzip /tmp/geoserver-war.zip geoserver.war -d /tmp \\\n && unzip /tmp/geoserver.war -d /opt/tomcat/webapps/geoserver \\\n && rm -rf /tmp/geoserver-war.zip /tmp/geoserver.war /opt/tomcat/webapps/geoserver/META-INF\n#   Install geoserver WPS plugin\nRUN set -x \\\n && curl -sS -L -o /tmp/geoserver-wps.zip https://downloads.sourceforge.net/project/geoserver/GeoServer/${GEOSERVER_VERSION}/extensions/geoserver-${GEOSERVER_VERSION}-wps-plugin.zip \\\n && unzip -j /tmp/geoserver-wps.zip -d /opt/tomcat/webapps/geoserver/WEB-INF/lib/ \\\n && rm -rf /tmp/geoserver-wps.zip\n#   Install Geomesa Accumulo Distribution\nCOPY --from=0 /geomesa-accumulo* /opt/geomesa/\n#   Install GeoMesa Accumulo DataStore\nRUN set -x \\\n && cd /opt/tomcat/webapps/geoserver/WEB-INF/lib/ \\\n && tar zxvf /opt/geomesa/dist/gs-plugins/geomesa-accumulo-gs-plugin_2.11-${GEOMESA_VERSION}-install.tar.gz\n#   Install GeoMesa Accumulo BlobStore\nRUN set -x \\\n && cd /opt/tomcat/webapps/geoserver/WEB-INF/lib/ \\\n && tar zxvf /opt/geomesa/dist/gs-plugins/geomesa-blobstore-gs-plugin_2.11-${GEOMESA_VERSION}-install.tar.gz\n#   Install GeoMesa Stream Store\nRUN set -x \\\n && cd /opt/tomcat/webapps/geoserver/WEB-INF/lib/ \\\n && tar zxvf /opt/geomesa/dist/gs-plugins/geomesa-stream-gs-plugin_2.11-${GEOMESA_VERSION}-install.tar.gz\n#   Install GeoMesa GeoJson Support\nRUN set -x \\\n && cd /opt/tomcat/webapps/geoserver/WEB-INF/lib/ \\\n && tar zxvf /opt/geomesa/dist/gs-plugins/geomesa-geojson-gs-plugin_2.11-${GEOMESA_VERSION}-install.tar.gz\n#   Install GeoMesa Process Jar\nRUN set -x \\\n && cd /opt/tomcat/webapps/geoserver/WEB-INF/lib/ \\\n && cp /opt/geomesa/dist/gs-plugins/geomesa-process-wps_2.11-${GEOMESA_VERSION}.jar .\n#   Install Hadoop and Accumulo specific jars\nRUN set -x \\\n && /opt/geomesa/bin/install-hadoop-accumulo.sh /opt/tomcat/webapps/geoserver/WEB-INF/lib -a ${ACCUMULO_VERSION} -h ${HADOOP_VERSION} -t ${THRIFT_VERSION}\n#   Install Geomesa Kafka Distribution\nCOPY --from=1 /geomesa-kafka* /opt/geomesa-kafka/\n#   Install GeoMesa Kafka DataStore\nRUN set -x \\\n && cd /opt/tomcat/webapps/geoserver/WEB-INF/lib/ \\\n && tar zxvf /opt/geomesa-kafka/dist/gs-plugins/geomesa-kafka-gs-plugin_2.11-${GEOMESA_VERSION}-install.tar.gz \\\n && rm /opt/tomcat/webapps/geoserver/WEB-INF/lib/zookeeper*.jar \\\n && /opt/geomesa-kafka/bin/install-kafka.sh /opt/tomcat/webapps/geoserver/WEB-INF/lib\nFROM quay.io/geomesa/base:__TAG__\nARG GEOMESA_VERSION\nARG ACCUMULO_VERSION\nARG THRIFT_VERSION\nENV ACCUMULO_VERSION=\"${ACCUMULO_VERSION}\"\nENV GEOMESA_VERSION=\"${GEOMESA_VERSION}\"\nENV THRIFT_VERSION=\"${THRIFT_VERSION}\"\nENV HADOOP_VERSION=\"2.8.4\"\nENV GEOSERVER_VERSION=\"2.14.1\"\nENV TOMCAT_VERSION=\"8.5.23\"\nENV CATALINA_OPTS=\"\\\"-Xmx8g -XX:MaxPermSize=512M -Duser.timezone=UTC -server -Djava.awt.headless=true\\\"\"\nCOPY --from=2 /opt/tomcat /opt/tomcat/\nRUN set -x \\\n && groupadd tomcat \\\n && useradd -M -s /bin/nologin -g tomcat -d /opt/tomcat tomcat \\\n && chown root /opt/tomcat/webapps/geoserver/WEB-INF/lib/* \\\n && chgrp root /opt/tomcat/webapps/geoserver/WEB-INF/lib/*\nCOPY server.xml /opt/tomcat/conf/server.xml\nVOLUME [\"/opt/tomcat/webapps/geoserver/data\"]\nEXPOSE 9090/tcp\nCMD [\"/opt/tomcat/bin/catalina.sh\", \"run\"]\n","originalDockerfileUglifiedHash":"0b297c2a2b1ad2f3936d28c1f61a58bc","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/a65719b8e30a43ea55b5e75a0c76ed30a1dcd3d5.dockerfile"}