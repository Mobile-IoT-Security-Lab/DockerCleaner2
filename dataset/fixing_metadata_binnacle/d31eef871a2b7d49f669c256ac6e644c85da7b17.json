{"seed":4267992594,"processedDockerfileHash":"fac38890f4d3f82a22667052fef628ca","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apt-get","have-a-healthcheck","have-a-user"],"processedDockerfile":"#\n#   crashplan-pro Dockerfile\n#\n#   https://github.com/jlesage/docker-crashplan-pro\n#\nFROM ubuntu:18.04\nWORKDIR /tmp\nRUN apt-get update \\\n && apt-get install --no-install-recommends build-essential=12.4ubuntu1 -y\nCOPY uname_wrapper.c /tmp/\nRUN gcc -o /tmp/uname_wrapper.so /tmp/uname_wrapper.c -Wall -Werror -fPIC -shared -ldl\nRUN strip /tmp/uname_wrapper.so\n#   Pull base image.\nFROM jlesage/baseimage-gui:alpine-3.8-glibc-v3.5.2\n#   Define software versions.\nARG CRASHPLAN_VERSION=7.0.0\nARG CRASHPLAN_TIMESTAMP=1525200006700\nARG CRASHPLAN_BUILD=581\n#   Define software download URLs.\n#   NOTE: Do not use the following URL, as it may not point to the latest build\n#         number:\n#   https://download.code42.com/installs/linux/install/CrashPlanSmb/CrashPlanSmb_${CRASHPLAN_VERSION}_Linux.tgz\nARG CRASHPLAN_URL=https://web-eam-msp.crashplanpro.com/client/installers/CrashPlanSmb_${CRASHPLAN_VERSION}_${CRASHPLAN_TIMESTAMP}_${CRASHPLAN_BUILD}_Linux.tgz\n#   Define container build variables.\nARG TARGETDIR=/usr/local/crashplan\n#   Define working directory.\nWORKDIR /tmp\n#   Install CrashPlan.\nRUN add-pkg --virtual build-dependencies cpio curl \\\n && echo \"Installing CrashPlan...\" \\\n && curl -# -L ${CRASHPLAN_URL} | tar -xz \\\n && mkdir -p ${TARGETDIR} \\\n && cat $( ls crashplan-install/*.cpi ;) | gzip -d -c - | cpio -i --no-preserve-owner --directory=${TARGETDIR} \\\n && mv \"${TARGETDIR}\"/*.asar \"${TARGETDIR}/electron/resources\" \\\n && chmod 755 \"${TARGETDIR}/electron/crashplan\" \\\n && chmod 755 \"${TARGETDIR}/bin/CrashPlanService\" \\\n && chmod 755 \"${TARGETDIR}/bin/restore-tool\" \\\n && mv ${TARGETDIR}/conf /defaults/conf \\\n && sed-patch '/<orgType>BUSINESS<\\/orgType>/a \\\\t<serviceUIConfig>\\n\\t\\t<serviceHost>127.0.0.1<\\/serviceHost>\\n\\t<\\/serviceUIConfig>' /defaults/conf/default.service.xml \\\n && sed-patch \"s|<backupConfig>|<backupConfig>\\n\\t\\t\\t<manifestPath>/usr/local/var/crashplan</manifestPath>|g\" /defaults/conf/default.service.xml \\\n && sed-patch '/<serviceUIConfig>/i\\\\t<javaMemoryHeapMax nil=\"true\"/>' /defaults/conf/default.service.xml \\\n && mkdir -p /usr/local/var/crashplan \\\n && rm -r /usr/local/crashplan/upgrade \\\n && touch /usr/local/crashplan/upgrade \\\n && chmod 400 /usr/local/crashplan/upgrade \\\n && ln -s /config/conf $TARGETDIR/conf \\\n && ln -s /config/cache $TARGETDIR/cache \\\n && rm -r $TARGETDIR/log \\\n && ln -s /config/log $TARGETDIR/log \\\n && ln -s /config/var /var/lib/crashplan \\\n && ln -s /config/repository/metadata /usr/local/crashplan/metadata \\\n && del-pkg build-dependencies \\\n && rm -rf /tmp/*\n#   Misc adjustments.\nRUN sed-patch '/^nobody:/d' /defaults/passwd \\\n && sed-patch '/^nobody:/d' /defaults/group \\\n && sed-patch '/^nobody:/d' /defaults/shadow \\\n && echo > /etc/fstab \\\n && echo \"${CRASHPLAN_VERSION}\" > /defaults/cp_version\n#   Install dependencies.\nRUN add-pkg libselinux --repository http://dl-cdn.alpinelinux.org/alpine/edge/community \\\n && add-pkg gtk+3.0 libxscrnsaver nss eudev gconf xdotool yad bc\n#   Adjust the openbox config.\nRUN sed-patch 's/<application type=\"normal\">/<application type=\"normal\" title=\"Code42\">/' /etc/xdg/openbox/rc.xml \\\n && sed-patch '/<application type=\"normal\" title=\"Code42\">/a \\ <layer>below</layer>' /etc/xdg/openbox/rc.xml\n#   Enable log monitoring.\nRUN sed-patch 's|LOG_FILES=|LOG_FILES=/config/log/service.log|' /etc/logmonitor/logmonitor.conf \\\n && sed-patch 's|STATUS_FILES=|STATUS_FILES=/config/log/app.log|' /etc/logmonitor/logmonitor.conf\n#   Generate and install favicons.\nRUN APP_ICON_URL=https://github.com/jlesage/docker-templates/raw/master/jlesage/images/crashplan-pro-icon.png \\\n && install_app_icon.sh \"$APP_ICON_URL\"\n#   Add files.\nCOPY rootfs/ /\nCOPY --from=0 /tmp/uname_wrapper.so /usr/local/crashplan/\n#   Set environment variables.\nENV S6_WAIT_FOR_SERVICE_MAXTIME=\"10000\" \\\n    APP_NAME=\"CrashPlan for Small Business\" \\\n    KEEP_APP_RUNNING=\"1\"\n#   Define mountable directories.\nVOLUME [\"/config\"]\nVOLUME [\"/storage\"]\n#   Metadata.\nLABEL org.label-schema.name=\"crashplan-pro\" \\\n      org.label-schema.description=\"Docker container for CrashPlan PRO\" \\\n      org.label-schema.version=\"unknown\" \\\n      org.label-schema.vcs-url=\"https://github.com/jlesage/docker-crashplan-pro\" \\\n      org.label-schema.schema-version=\"1.0\"\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#\n#  crashplan-pro Dockerfile\n#\n#  https://github.com/jlesage/docker-crashplan-pro\n#\nFROM ubuntu:18.04\nWORKDIR /tmp\nRUN apt-get update \\\n && apt-get install --no-install-recommends -y build-essential\nCOPY uname_wrapper.c /tmp/\nRUN gcc -o /tmp/uname_wrapper.so /tmp/uname_wrapper.c -Wall -Werror -fPIC -shared -ldl\nRUN strip /tmp/uname_wrapper.so\n#  Pull base image.\nFROM jlesage/baseimage-gui:alpine-3.8-glibc-v3.5.2\n#  Define software versions.\nARG CRASHPLAN_VERSION=7.0.0\nARG CRASHPLAN_TIMESTAMP=1525200006700\nARG CRASHPLAN_BUILD=581\n#  Define software download URLs.\n#  NOTE: Do not use the following URL, as it may not point to the latest build\n#        number:\n#  https://download.code42.com/installs/linux/install/CrashPlanSmb/CrashPlanSmb_${CRASHPLAN_VERSION}_Linux.tgz\nARG CRASHPLAN_URL=https://web-eam-msp.crashplanpro.com/client/installers/CrashPlanSmb_${CRASHPLAN_VERSION}_${CRASHPLAN_TIMESTAMP}_${CRASHPLAN_BUILD}_Linux.tgz\n#  Define container build variables.\nARG TARGETDIR=/usr/local/crashplan\n#  Define working directory.\nWORKDIR /tmp\n#  Install CrashPlan.\nRUN add-pkg --virtual build-dependencies cpio curl \\\n && echo \"Installing CrashPlan...\" \\\n && curl -# -L ${CRASHPLAN_URL} | tar -xz \\\n && mkdir -p ${TARGETDIR} \\\n && cat $( ls crashplan-install/*.cpi ;) | gzip -d -c - | cpio -i --no-preserve-owner --directory=${TARGETDIR} \\\n && mv \"${TARGETDIR}\"/*.asar \"${TARGETDIR}/electron/resources\" \\\n && chmod 755 \"${TARGETDIR}/electron/crashplan\" \\\n && chmod 755 \"${TARGETDIR}/bin/CrashPlanService\" \\\n && chmod 755 \"${TARGETDIR}/bin/restore-tool\" \\\n && mv ${TARGETDIR}/conf /defaults/conf \\\n && sed-patch '/<orgType>BUSINESS<\\/orgType>/a \\\\t<serviceUIConfig>\\n\\t\\t<serviceHost>127.0.0.1<\\/serviceHost>\\n\\t<\\/serviceUIConfig>' /defaults/conf/default.service.xml \\\n && sed-patch \"s|<backupConfig>|<backupConfig>\\n\\t\\t\\t<manifestPath>/usr/local/var/crashplan</manifestPath>|g\" /defaults/conf/default.service.xml \\\n && sed-patch '/<serviceUIConfig>/i\\\\t<javaMemoryHeapMax nil=\"true\"/>' /defaults/conf/default.service.xml \\\n && mkdir -p /usr/local/var/crashplan \\\n && rm -r /usr/local/crashplan/upgrade \\\n && touch /usr/local/crashplan/upgrade \\\n && chmod 400 /usr/local/crashplan/upgrade \\\n && ln -s /config/conf $TARGETDIR/conf \\\n && ln -s /config/cache $TARGETDIR/cache \\\n && rm -r $TARGETDIR/log \\\n && ln -s /config/log $TARGETDIR/log \\\n && ln -s /config/var /var/lib/crashplan \\\n && ln -s /config/repository/metadata /usr/local/crashplan/metadata \\\n && del-pkg build-dependencies \\\n && rm -rf /tmp/*\n#  Misc adjustments.\nRUN sed-patch '/^nobody:/d' /defaults/passwd \\\n && sed-patch '/^nobody:/d' /defaults/group \\\n && sed-patch '/^nobody:/d' /defaults/shadow \\\n && echo > /etc/fstab \\\n && echo \"${CRASHPLAN_VERSION}\" > /defaults/cp_version\n#  Install dependencies.\nRUN add-pkg libselinux --repository http://dl-cdn.alpinelinux.org/alpine/edge/community \\\n && add-pkg gtk+3.0 libxscrnsaver nss eudev gconf xdotool yad bc\n#  Adjust the openbox config.\nRUN sed-patch 's/<application type=\"normal\">/<application type=\"normal\" title=\"Code42\">/' /etc/xdg/openbox/rc.xml \\\n && sed-patch '/<application type=\"normal\" title=\"Code42\">/a \\ <layer>below</layer>' /etc/xdg/openbox/rc.xml\n#  Enable log monitoring.\nRUN sed-patch 's|LOG_FILES=|LOG_FILES=/config/log/service.log|' /etc/logmonitor/logmonitor.conf \\\n && sed-patch 's|STATUS_FILES=|STATUS_FILES=/config/log/app.log|' /etc/logmonitor/logmonitor.conf\n#  Generate and install favicons.\nRUN APP_ICON_URL=https://github.com/jlesage/docker-templates/raw/master/jlesage/images/crashplan-pro-icon.png \\\n && install_app_icon.sh \"$APP_ICON_URL\"\n#  Add files.\nCOPY rootfs/ /\nCOPY --from=0 /tmp/uname_wrapper.so /usr/local/crashplan/\n#  Set environment variables.\nENV S6_WAIT_FOR_SERVICE_MAXTIME=\"10000\" \\\n    APP_NAME=\"CrashPlan for Small Business\" \\\n    KEEP_APP_RUNNING=\"1\"\n#  Define mountable directories.\nVOLUME [\"/config\"]\nVOLUME [\"/storage\"]\n#  Metadata.\nLABEL org.label-schema.name=\"crashplan-pro\" \\\n      org.label-schema.description=\"Docker container for CrashPlan PRO\" \\\n      org.label-schema.version=\"unknown\" \\\n      org.label-schema.vcs-url=\"https://github.com/jlesage/docker-crashplan-pro\" \\\n      org.label-schema.schema-version=\"1.0\"\n","injectedSmells":[],"originalDockerfileHash":"d81223656cb102d119836158fe646612","successfullyInjectedSmells":[],"originalDockerfileUglified":"#\n#   crashplan-pro Dockerfile\n#\n#   https://github.com/jlesage/docker-crashplan-pro\n#\nFROM ubuntu:18.04\nWORKDIR /tmp\nRUN apt-get update \\\n && apt-get install --no-install-recommends build-essential -y\nCOPY uname_wrapper.c /tmp/\nRUN gcc -o /tmp/uname_wrapper.so /tmp/uname_wrapper.c -Wall -Werror -fPIC -shared -ldl\nRUN strip /tmp/uname_wrapper.so\n#   Pull base image.\nFROM jlesage/baseimage-gui:alpine-3.8-glibc-v3.5.2\n#   Define software versions.\nARG CRASHPLAN_VERSION=7.0.0\nARG CRASHPLAN_TIMESTAMP=1525200006700\nARG CRASHPLAN_BUILD=581\n#   Define software download URLs.\n#   NOTE: Do not use the following URL, as it may not point to the latest build\n#         number:\n#   https://download.code42.com/installs/linux/install/CrashPlanSmb/CrashPlanSmb_${CRASHPLAN_VERSION}_Linux.tgz\nARG CRASHPLAN_URL=https://web-eam-msp.crashplanpro.com/client/installers/CrashPlanSmb_${CRASHPLAN_VERSION}_${CRASHPLAN_TIMESTAMP}_${CRASHPLAN_BUILD}_Linux.tgz\n#   Define container build variables.\nARG TARGETDIR=/usr/local/crashplan\n#   Define working directory.\nWORKDIR /tmp\n#   Install CrashPlan.\nRUN add-pkg --virtual build-dependencies cpio curl \\\n && echo \"Installing CrashPlan...\" \\\n && curl -# -L ${CRASHPLAN_URL} | tar -xz \\\n && mkdir -p ${TARGETDIR} \\\n && cat $( ls crashplan-install/*.cpi ;) | gzip -d -c - | cpio -i --no-preserve-owner --directory=${TARGETDIR} \\\n && mv \"${TARGETDIR}\"/*.asar \"${TARGETDIR}/electron/resources\" \\\n && chmod 755 \"${TARGETDIR}/electron/crashplan\" \\\n && chmod 755 \"${TARGETDIR}/bin/CrashPlanService\" \\\n && chmod 755 \"${TARGETDIR}/bin/restore-tool\" \\\n && mv ${TARGETDIR}/conf /defaults/conf \\\n && sed-patch '/<orgType>BUSINESS<\\/orgType>/a \\\\t<serviceUIConfig>\\n\\t\\t<serviceHost>127.0.0.1<\\/serviceHost>\\n\\t<\\/serviceUIConfig>' /defaults/conf/default.service.xml \\\n && sed-patch \"s|<backupConfig>|<backupConfig>\\n\\t\\t\\t<manifestPath>/usr/local/var/crashplan</manifestPath>|g\" /defaults/conf/default.service.xml \\\n && sed-patch '/<serviceUIConfig>/i\\\\t<javaMemoryHeapMax nil=\"true\"/>' /defaults/conf/default.service.xml \\\n && mkdir -p /usr/local/var/crashplan \\\n && rm -r /usr/local/crashplan/upgrade \\\n && touch /usr/local/crashplan/upgrade \\\n && chmod 400 /usr/local/crashplan/upgrade \\\n && ln -s /config/conf $TARGETDIR/conf \\\n && ln -s /config/cache $TARGETDIR/cache \\\n && rm -r $TARGETDIR/log \\\n && ln -s /config/log $TARGETDIR/log \\\n && ln -s /config/var /var/lib/crashplan \\\n && ln -s /config/repository/metadata /usr/local/crashplan/metadata \\\n && del-pkg build-dependencies \\\n && rm -rf /tmp/*\n#   Misc adjustments.\nRUN sed-patch '/^nobody:/d' /defaults/passwd \\\n && sed-patch '/^nobody:/d' /defaults/group \\\n && sed-patch '/^nobody:/d' /defaults/shadow \\\n && echo > /etc/fstab \\\n && echo \"${CRASHPLAN_VERSION}\" > /defaults/cp_version\n#   Install dependencies.\nRUN add-pkg libselinux --repository http://dl-cdn.alpinelinux.org/alpine/edge/community \\\n && add-pkg gtk+3.0 libxscrnsaver nss eudev gconf xdotool yad bc\n#   Adjust the openbox config.\nRUN sed-patch 's/<application type=\"normal\">/<application type=\"normal\" title=\"Code42\">/' /etc/xdg/openbox/rc.xml \\\n && sed-patch '/<application type=\"normal\" title=\"Code42\">/a \\ <layer>below</layer>' /etc/xdg/openbox/rc.xml\n#   Enable log monitoring.\nRUN sed-patch 's|LOG_FILES=|LOG_FILES=/config/log/service.log|' /etc/logmonitor/logmonitor.conf \\\n && sed-patch 's|STATUS_FILES=|STATUS_FILES=/config/log/app.log|' /etc/logmonitor/logmonitor.conf\n#   Generate and install favicons.\nRUN APP_ICON_URL=https://github.com/jlesage/docker-templates/raw/master/jlesage/images/crashplan-pro-icon.png \\\n && install_app_icon.sh \"$APP_ICON_URL\"\n#   Add files.\nCOPY rootfs/ /\nCOPY --from=0 /tmp/uname_wrapper.so /usr/local/crashplan/\n#   Set environment variables.\nENV S6_WAIT_FOR_SERVICE_MAXTIME=\"10000\" \\\n    APP_NAME=\"CrashPlan for Small Business\" \\\n    KEEP_APP_RUNNING=\"1\"\n#   Define mountable directories.\nVOLUME [\"/config\"]\nVOLUME [\"/storage\"]\n#   Metadata.\nLABEL org.label-schema.name=\"crashplan-pro\" \\\n      org.label-schema.description=\"Docker container for CrashPlan PRO\" \\\n      org.label-schema.version=\"unknown\" \\\n      org.label-schema.vcs-url=\"https://github.com/jlesage/docker-crashplan-pro\" \\\n      org.label-schema.schema-version=\"1.0\"\n","originalDockerfileUglifiedHash":"8b6cd322be2bb1c7210db54bf9ad5995","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/d31eef871a2b7d49f669c256ac6e644c85da7b17.dockerfile"}