{"seed":3071259295,"processedDockerfileHash":"1b5a15b11ad8036a3f1b3b74b24fbf98","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","have-a-healthcheck","have-a-user"],"processedDockerfile":"#  upstream https://github.com/docker-library/mongo\nFROM debian:jessie-slim\nMAINTAINER 若虚 <slpcat@qq.com>\n#   Container variables\nENV TERM=\"xterm\" \\\n    LANG=\"en_US.UTF-8\" \\\n    LANGUAGE=\"en_US:en\" \\\n    LC_ALL=\"en_US.UTF-8\" \\\n    TIMEZONE=\"Asia/Shanghai\"\nRUN echo 'deb http://mirrors.aliyun.com/debian jessie-backports main' > /etc/apt/sources.list.d/backports.list \\\n && sed -i 's/deb.debian.org/mirrors.aliyun.com/' /etc/apt/sources.list\n#   Set timezone and locales\nRUN echo \"${TIMEZONE}\" > /etc/timezone \\\n && echo \"$LANG UTF-8\" > /etc/locale.gen \\\n && : \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -yq apt-utils dialog vim-tiny locales \\\n && ln -sf /usr/share/zoneinfo/${TIMEZONE} /etc/localtime \\\n && update-locale LANG=$LANG \\\n && locale-gen $LANG \\\n && DEBIAN_FRONTEND=noninteractive dpkg-reconfigure locales\n#   Install required packages\nRUN apt-get dist-upgrade -y\n#   add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added\nRUN groupadd -r mongodb \\\n && useradd -r -g mongodb mongodb\nRUN apt-get update \\\n && (apt-get update ;apt-get install --no-install-recommends ca-certificates jq numactl -y ) \\\n && rm -rf /var/lib/apt/lists/*\n#   grab gosu for easy step-down from root (https://github.com/tianon/gosu/releases)\nENV GOSU_VERSION=\"1.10\"\n#   grab \"js-yaml\" for parsing mongod's YAML config files (https://github.com/nodeca/js-yaml/releases)\nENV JSYAML_VERSION=\"3.10.0\"\nRUN set -ex ; apt-get update ; (apt-get update ;apt-get install --no-install-recommends wget -y ) ; rm -rf /var/lib/apt/lists/* ; dpkgArch=\"$( dpkg --print-architecture | awk -F- '{ print $NF }' ;)\" ; wget -O /usr/local/bin/gosu \"https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-$dpkgArch\" ; wget -O /usr/local/bin/gosu.asc \"https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-$dpkgArch.asc\" ; export GNUPGHOME=\"$( mktemp -d ;)\" ; gpg --keyserver keyserver.ubuntu.com --recv-keys B42F6819007F00F88E364FD4036A9C25BF357DD4 ; gpg --batch --verify /usr/local/bin/gosu.asc /usr/local/bin/gosu ; rm -r \"$GNUPGHOME\" /usr/local/bin/gosu.asc ; chmod +x /usr/local/bin/gosu ; gosu nobody true ; wget -O /js-yaml.js \"https://github.com/nodeca/js-yaml/raw/${JSYAML_VERSION}/dist/js-yaml.js\" ; apt-get purge -y --auto-remove wget\nRUN mkdir /docker-entrypoint-initdb.d\nENV GPG_KEYS=\"2930ADAE8CAF5059EE73BB4B58712A2291FA4AD5\"\n#   https://docs.mongodb.com/manual/tutorial/verify-mongodb-packages/#download-then-import-the-key-file\nRUN set -ex ; export GNUPGHOME=\"$( mktemp -d ;)\" ; for key in $GPG_KEYS; do gpg --keyserver keyserver.ubuntu.com --recv-keys \"$key\" ; done ; gpg --export $GPG_KEYS > /etc/apt/trusted.gpg.d/mongodb.gpg; rm -r \"$GNUPGHOME\" ; apt-key list\n#   Allow build-time overrides (eg. to build image with MongoDB Enterprise version)\n#   Options for MONGO_PACKAGE: mongodb-org OR mongodb-enterprise\n#   Options for MONGO_REPO: repo.mongodb.org OR repo.mongodb.com\n#   Example: docker build --build-arg MONGO_PACKAGE=mongodb-enterprise --build-arg MONGO_REPO=repo.mongodb.com .\nARG MONGO_PACKAGE=mongodb-org\n#  ARG MONGO_REPO=repo.mongodb.org\nARG MONGO_REPO=mirrors.aliyun.com/mongodb\nENV MONGO_PACKAGE=\"${MONGO_PACKAGE}\" \\\n    MONGO_REPO=\"${MONGO_REPO}\"\nENV MONGO_MAJOR=\"3.6\"\nENV MONGO_VERSION=\"3.6.5\"\nRUN echo \"deb http://$MONGO_REPO/apt/debian jessie/${MONGO_PACKAGE%-unstable}/$MONGO_MAJOR main\" | tee \"/etc/apt/sources.list.d/${MONGO_PACKAGE%-unstable}.list\"\nRUN set -x \\\n && apt-get update \\\n && (apt-get update ;apt-get install --no-install-recommends ${MONGO_PACKAGE}=$MONGO_VERSION ${MONGO_PACKAGE}-server=$MONGO_VERSION ${MONGO_PACKAGE}-shell=$MONGO_VERSION ${MONGO_PACKAGE}-mongos=$MONGO_VERSION ${MONGO_PACKAGE}-tools=$MONGO_VERSION -y ) \\\n && rm -rf /var/lib/apt/lists/* \\\n && rm -rf /var/lib/mongodb \\\n && mv /etc/mongod.conf /etc/mongod.conf.orig\nRUN mkdir -p /data/db /data/configdb \\\n && chown -R mongodb:mongodb /data/db /data/configdb\nVOLUME /data/db /data/configdb\nCOPY docker-entrypoint.sh /usr/local/bin/\nENTRYPOINT [\"docker-entrypoint.sh\"]\nEXPOSE 27017/tcp\nCMD [\"mongod\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"# upstream https://github.com/docker-library/mongo\nFROM debian:jessie-slim\nMAINTAINER 若虚 <slpcat@qq.com>\n#  Container variables\nENV TERM=\"xterm\" \\\n    LANG=\"en_US.UTF-8\" \\\n    LANGUAGE=\"en_US:en\" \\\n    LC_ALL=\"en_US.UTF-8\" \\\n    TIMEZONE=\"Asia/Shanghai\"\nRUN echo 'deb http://mirrors.aliyun.com/debian jessie-backports main' > /etc/apt/sources.list.d/backports.list \\\n && sed -i 's/deb.debian.org/mirrors.aliyun.com/' /etc/apt/sources.list\n#  Set timezone and locales\nRUN echo \"${TIMEZONE}\" > /etc/timezone \\\n && echo \"$LANG UTF-8\" > /etc/locale.gen \\\n && apt-get update -q \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -yq apt-utils dialog vim-tiny locales \\\n && ln -sf /usr/share/zoneinfo/${TIMEZONE} /etc/localtime \\\n && update-locale LANG=$LANG \\\n && locale-gen $LANG \\\n && DEBIAN_FRONTEND=noninteractive dpkg-reconfigure locales\n#  Install required packages\nRUN apt-get dist-upgrade -y\n#  add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added\nRUN groupadd -r mongodb \\\n && useradd -r -g mongodb mongodb\nRUN apt-get update \\\n && apt-get install --no-install-recommends ca-certificates jq numactl -y \\\n && rm -rf /var/lib/apt/lists/*\n#  grab gosu for easy step-down from root (https://github.com/tianon/gosu/releases)\nENV GOSU_VERSION=\"1.10\"\n#  grab \"js-yaml\" for parsing mongod's YAML config files (https://github.com/nodeca/js-yaml/releases)\nENV JSYAML_VERSION=\"3.10.0\"\nRUN set -ex ; apt-get update ; apt-get install --no-install-recommends wget -y ; rm -rf /var/lib/apt/lists/* ; dpkgArch=\"$( dpkg --print-architecture | awk -F- '{ print $NF }' ;)\" ; wget -O /usr/local/bin/gosu \"https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-$dpkgArch\" ; wget -O /usr/local/bin/gosu.asc \"https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-$dpkgArch.asc\" ; export GNUPGHOME=\"$( mktemp -d ;)\" ; gpg --keyserver keyserver.ubuntu.com --recv-keys B42F6819007F00F88E364FD4036A9C25BF357DD4 ; gpg --batch --verify /usr/local/bin/gosu.asc /usr/local/bin/gosu ; rm -r \"$GNUPGHOME\" /usr/local/bin/gosu.asc ; chmod +x /usr/local/bin/gosu ; gosu nobody true ; wget -O /js-yaml.js \"https://github.com/nodeca/js-yaml/raw/${JSYAML_VERSION}/dist/js-yaml.js\" ; apt-get purge -y --auto-remove wget\nRUN mkdir /docker-entrypoint-initdb.d\nENV GPG_KEYS=\"2930ADAE8CAF5059EE73BB4B58712A2291FA4AD5\"\n#  https://docs.mongodb.com/manual/tutorial/verify-mongodb-packages/#download-then-import-the-key-file\nRUN set -ex ; export GNUPGHOME=\"$( mktemp -d ;)\" ; for key in $GPG_KEYS; do gpg --keyserver keyserver.ubuntu.com --recv-keys \"$key\" ; done ; gpg --export $GPG_KEYS > /etc/apt/trusted.gpg.d/mongodb.gpg; rm -r \"$GNUPGHOME\" ; apt-key list\n#  Allow build-time overrides (eg. to build image with MongoDB Enterprise version)\n#  Options for MONGO_PACKAGE: mongodb-org OR mongodb-enterprise\n#  Options for MONGO_REPO: repo.mongodb.org OR repo.mongodb.com\n#  Example: docker build --build-arg MONGO_PACKAGE=mongodb-enterprise --build-arg MONGO_REPO=repo.mongodb.com .\nARG MONGO_PACKAGE=mongodb-org\n# ARG MONGO_REPO=repo.mongodb.org\nARG MONGO_REPO=mirrors.aliyun.com/mongodb\nENV MONGO_PACKAGE=\"${MONGO_PACKAGE}\" \\\n    MONGO_REPO=\"${MONGO_REPO}\"\nENV MONGO_MAJOR=\"3.6\"\nENV MONGO_VERSION=\"3.6.5\"\nRUN echo \"deb http://$MONGO_REPO/apt/debian jessie/${MONGO_PACKAGE%-unstable}/$MONGO_MAJOR main\" | tee \"/etc/apt/sources.list.d/${MONGO_PACKAGE%-unstable}.list\"\nRUN set -x \\\n && apt-get update \\\n && apt-get install ${MONGO_PACKAGE}=$MONGO_VERSION ${MONGO_PACKAGE}-server=$MONGO_VERSION ${MONGO_PACKAGE}-shell=$MONGO_VERSION ${MONGO_PACKAGE}-mongos=$MONGO_VERSION ${MONGO_PACKAGE}-tools=$MONGO_VERSION -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && rm -rf /var/lib/mongodb \\\n && mv /etc/mongod.conf /etc/mongod.conf.orig\nRUN mkdir -p /data/db /data/configdb \\\n && chown -R mongodb:mongodb /data/db /data/configdb\nVOLUME /data/db /data/configdb\nCOPY docker-entrypoint.sh /usr/local/bin/\nENTRYPOINT [\"docker-entrypoint.sh\"]\nEXPOSE 27017/tcp\nCMD [\"mongod\"]\n","injectedSmells":[],"originalDockerfileHash":"a6484120db95a591f15d16a6b70fb29f","successfullyInjectedSmells":[],"originalDockerfileUglified":"#  upstream https://github.com/docker-library/mongo\nFROM debian:jessie-slim\nMAINTAINER 若虚 <slpcat@qq.com>\n#   Container variables\nENV TERM=\"xterm\" \\\n    LANG=\"en_US.UTF-8\" \\\n    LANGUAGE=\"en_US:en\" \\\n    LC_ALL=\"en_US.UTF-8\" \\\n    TIMEZONE=\"Asia/Shanghai\"\nRUN echo 'deb http://mirrors.aliyun.com/debian jessie-backports main' > /etc/apt/sources.list.d/backports.list \\\n && sed -i 's/deb.debian.org/mirrors.aliyun.com/' /etc/apt/sources.list\n#   Set timezone and locales\nRUN echo \"${TIMEZONE}\" > /etc/timezone \\\n && echo \"$LANG UTF-8\" > /etc/locale.gen \\\n && apt-get update -q \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -yq apt-utils dialog vim-tiny locales \\\n && ln -sf /usr/share/zoneinfo/${TIMEZONE} /etc/localtime \\\n && update-locale LANG=$LANG \\\n && locale-gen $LANG \\\n && DEBIAN_FRONTEND=noninteractive dpkg-reconfigure locales\n#   Install required packages\nRUN apt-get dist-upgrade -y\n#   add our user and group first to make sure their IDs get assigned consistently, regardless of whatever dependencies get added\nRUN groupadd -r mongodb \\\n && useradd -r -g mongodb mongodb\nRUN apt-get update \\\n && apt-get install --no-install-recommends ca-certificates jq numactl -y \\\n && rm -rf /var/lib/apt/lists/*\n#   grab gosu for easy step-down from root (https://github.com/tianon/gosu/releases)\nENV GOSU_VERSION=\"1.10\"\n#   grab \"js-yaml\" for parsing mongod's YAML config files (https://github.com/nodeca/js-yaml/releases)\nENV JSYAML_VERSION=\"3.10.0\"\nRUN set -ex ; apt-get update ; apt-get install --no-install-recommends wget -y ; rm -rf /var/lib/apt/lists/* ; dpkgArch=\"$( dpkg --print-architecture | awk -F- '{ print $NF }' ;)\" ; wget -O /usr/local/bin/gosu \"https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-$dpkgArch\" ; wget -O /usr/local/bin/gosu.asc \"https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-$dpkgArch.asc\" ; export GNUPGHOME=\"$( mktemp -d ;)\" ; gpg --keyserver keyserver.ubuntu.com --recv-keys B42F6819007F00F88E364FD4036A9C25BF357DD4 ; gpg --batch --verify /usr/local/bin/gosu.asc /usr/local/bin/gosu ; rm -r \"$GNUPGHOME\" /usr/local/bin/gosu.asc ; chmod +x /usr/local/bin/gosu ; gosu nobody true ; wget -O /js-yaml.js \"https://github.com/nodeca/js-yaml/raw/${JSYAML_VERSION}/dist/js-yaml.js\" ; apt-get purge -y --auto-remove wget\nRUN mkdir /docker-entrypoint-initdb.d\nENV GPG_KEYS=\"2930ADAE8CAF5059EE73BB4B58712A2291FA4AD5\"\n#   https://docs.mongodb.com/manual/tutorial/verify-mongodb-packages/#download-then-import-the-key-file\nRUN set -ex ; export GNUPGHOME=\"$( mktemp -d ;)\" ; for key in $GPG_KEYS; do gpg --keyserver keyserver.ubuntu.com --recv-keys \"$key\" ; done ; gpg --export $GPG_KEYS > /etc/apt/trusted.gpg.d/mongodb.gpg; rm -r \"$GNUPGHOME\" ; apt-key list\n#   Allow build-time overrides (eg. to build image with MongoDB Enterprise version)\n#   Options for MONGO_PACKAGE: mongodb-org OR mongodb-enterprise\n#   Options for MONGO_REPO: repo.mongodb.org OR repo.mongodb.com\n#   Example: docker build --build-arg MONGO_PACKAGE=mongodb-enterprise --build-arg MONGO_REPO=repo.mongodb.com .\nARG MONGO_PACKAGE=mongodb-org\n#  ARG MONGO_REPO=repo.mongodb.org\nARG MONGO_REPO=mirrors.aliyun.com/mongodb\nENV MONGO_PACKAGE=\"${MONGO_PACKAGE}\" \\\n    MONGO_REPO=\"${MONGO_REPO}\"\nENV MONGO_MAJOR=\"3.6\"\nENV MONGO_VERSION=\"3.6.5\"\nRUN echo \"deb http://$MONGO_REPO/apt/debian jessie/${MONGO_PACKAGE%-unstable}/$MONGO_MAJOR main\" | tee \"/etc/apt/sources.list.d/${MONGO_PACKAGE%-unstable}.list\"\nRUN set -x \\\n && apt-get update \\\n && apt-get install ${MONGO_PACKAGE}=$MONGO_VERSION ${MONGO_PACKAGE}-server=$MONGO_VERSION ${MONGO_PACKAGE}-shell=$MONGO_VERSION ${MONGO_PACKAGE}-mongos=$MONGO_VERSION ${MONGO_PACKAGE}-tools=$MONGO_VERSION -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && rm -rf /var/lib/mongodb \\\n && mv /etc/mongod.conf /etc/mongod.conf.orig\nRUN mkdir -p /data/db /data/configdb \\\n && chown -R mongodb:mongodb /data/db /data/configdb\nVOLUME /data/db /data/configdb\nCOPY docker-entrypoint.sh /usr/local/bin/\nENTRYPOINT [\"docker-entrypoint.sh\"]\nEXPOSE 27017/tcp\nCMD [\"mongod\"]\n","originalDockerfileUglifiedHash":"5046b82402f7487f7c0768a43b7173b1","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/006828776e78a849a1a789b07c394abe14743de2.dockerfile"}