{"seed":39262116,"processedDockerfileHash":"2f6fde57285b99a7ea93177a9087c44b","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","have-a-healthcheck","have-a-user"],"processedDockerfile":"#   Dockerfile for XRDP on Ubuntu 16.04 desktop.\n#\n#   Copyright (C) 2017 Hiroo MATSUMOTO <hiroom2.mail@gmail.com>\n#\nFROM ubuntu:16.04\nMAINTAINER Hiroo MATSUMOTO <hiroom2.mail@gmail.com>\nLABEL Description=\"XRDP on Ubuntu 16.04 desktop\" \\\n      Version=\"1.0\"\nEXPOSE 3389/tcp\nARG user=${user:-doxrdp}\nARG password=${password:-doxrdp}\nARG desktop=${desktop:-unity}\nARG xrdp=${xrdp:-0.9.1-7}\nARG model=${model:-pc105}\nARG layout=${layout:-us}\nARG cpu=${cpu:-amd64}\n#   Check desktop argument at an early stage.\nRUN case \"${desktop}\" in (unity) true ;;(classic) true ;;(xubuntu) true ;;(mate) true ;;(lubuntu) true ;;(kubuntu) true ;;(*) echo \"Not supported desktop: ${desktop}\" 1>&2; false ;; esac\n#   Set locale.\nRUN locale-gen en_US en_US.UTF-8\nENV LANG=\"en_US.UTF-8\"\nENV LANGUAGE=\"en_US:en\"\nENV LC_ALL=\"en_US.UTF-8\"\nRUN locale > /etc/default/locale\n#   Update Ubuntu.\nRUN : \\\n && apt-get upgrade -y\n#   Install expect.\nRUN (apt-get update ;apt-get install --no-install-recommends expect=5.45-7 -y )\n#   Install debconf at an early stage for debconf-set-selections.\nRUN (apt-get update ;apt-get install --no-install-recommends debconf=1.5.58ubuntu2 -y )\n#   Set keyboard.\nRUN echo \"keyboard-configuration keyboard-configuration/modelcode string ${model}\\nkeyboard-configuration keyboard-configuration/layoutcode string ${layout}\\n\" | debconf-set-selections\n#   Create user.\nRUN (apt-get update ;apt-get install --no-install-recommends sudo=1.8.16-0ubuntu1.10 bash=4.3-14ubuntu1.4 -y ) \\\n && sed -e 's/%sudo\\(.*\\)ALL$/%sudo\\1NOPASSWD:ALL/g' -i /etc/sudoers \\\n && useradd -m ${user} -s /bin/bash \\\n && gpasswd -a ${user} sudo \\\n && printf \"set timeout -1\\nspawn passwd ${user}\\nexpect \\\"Enter new UNIX password:\\\" { send \\\"${password}\\n\\\" }\\nexpect \\\"Retype new UNIX password:\\\" { send \\\"${password}\\n\\\" }\\nexpect eof\\n\" | expect\n#   Install TigerVNC from upstream.\nRUN (apt-get update ;apt-get install --no-install-recommends dpkg-dev=1.18.4ubuntu1.7 git=1:2.7.4-0ubuntu1.10 -y ) \\\n && mkdir tigervnc.build \\\n && cd tigervnc.build \\\n && git clone https://github.com/TigerVNC/tigervnc \\\n && cd tigervnc \\\n && git checkout ff872614b507d0aa8bfbd09ef41550390cfe658a -b branch \\\n && ln -s contrib/packages/deb/ubuntu-xenial/debian \\\n && chmod a+x debian/rules \\\n && pkgs=$( dpkg-checkbuilddeps 2>&1 | sed -e 's/.*build dependencies://g' -e 's/([^)]*)//g' ;) \\\n && (apt-get update ;apt-get install --no-install-recommends 'apt::install-recommends=true' ${pkgs} -y -o ) \\\n && fakeroot debian/rules binary \\\n && apt-get remove -y dpkg-dev git ${pkgs} \\\n && cd .. \\\n && (dpkg -i *.deb || ((apt-get update ;apt-get install --no-install-recommends -f -y ) \\\n && dpkg -i *.deb ) ) \\\n && cd .. \\\n && rm -rf tigervnc.build\n#   Install latest XRDP. And apply patch to latest XRDP for changing\n#   Xvnc session to be default because Xorg session's cursor has black\n#   background.\nRUN mkdir xrdp \\\n && cd xrdp \\\n && (apt-get update ;apt-get install --no-install-recommends wget=1.17.1-1ubuntu1.5 patch=2.7.5-1ubuntu0.16.04.2 -y ) \\\n && URL=http://archive.ubuntu.com/ubuntu/pool/universe/x/xrdp \\\n && PKG=\"xrdp_${xrdp}_${cpu}.deb xorgxrdp_${xrdp}_${cpu}.deb \" \\\n && for pkg in ${PKG}; do wget -q ${URL}/${pkg} \\\n && (dpkg -i \"${pkg}\" || (apt-get update ;apt-get install --no-install-recommends -f -y ) ) ; done \\\n && cd .. \\\n && rm -rf xrdp \\\n && cd /etc/xrdp \\\n && echo \"--- xrdp.ini.org 2017-02-23 07:14:16.614833723 +0000\\n+++ xrdp.ini 2017-02-23 07:15:10.489078284 +0000\\n@@ -147,15 +147,6 @@ tcutils=true\\n ; Session types\\n ;\\n \\n-[Xorg]\\n-name=Xorg\\n-lib=libxup.so\\n-username=ask\\n-password=ask\\n-ip=127.0.0.1\\n-port=-1\\n-code=20\\n-\\n [Xvnc]\\n name=Xvnc\\n lib=libvnc.so\\n@@ -166,6 +157,15 @@ port=-1\\n \\n+[Xorg]\\n+name=Xorg\\n+lib=libxup.so\\n+username=ask\\n+password=ask\\n+ip=127.0.0.1\\n+port=-1\\n+code=20\\n+\\n [console]\\n name=console\\n lib=libvnc.so\\n\" | patch -p0 \\\n && apt-get remove -y wget patch\n#   Disable resolvconf postinst to /etc/resolv.conf which cannot be\n#   updated in container.\n#   https://github.com/docker/docker/issues/1297#issuecomment-115458690\nRUN echo \"resolvconf resolvconf/linkify-resolvconf boolean false\" | debconf-set-selections\n#   Install desktop.\nRUN case \"${desktop}\" in (unity) (apt-get update ;apt-get install --no-install-recommends ubuntu-desktop=1.361.6 unity=7.4.5+16.04.20190312-0ubuntu1 -y ) \\\n && ln -s /usr/bin/unity-control-center /usr/bin/gnome-control-center \\\n && service dbus start \\\n && su - ${user} -c \"dbus-launch gsettings set org.gnome.desktop.lockdown disable-lock-screen true\" \\\n && su - ${user} -c \"dbus-launch gsettings set org.gnome.desktop.session idle-delay 0\" \\\n && service dbus stop \\\n && printf \"/usr/lib/gnome-session/gnome-session-binary --session=ubuntu &\\n/usr/lib/x86_64-linux-gnu/unity/unity-panel-service &\\n/usr/lib/unity-settings-daemon/unity-settings-daemon &\\n\\nfor indicator in /usr/lib/x86_64-linux-gnu/indicator-*; do\\n basename=$( basename ${indicator} ;)\\n dirname=$( dirname ${indicator} ;)\\n service=${dirname}/${basename}/${basename}-service\\n ${service} &\\ndone\\n\\nunity\\n\" > /home/${user}/.xsession \\\n && chown ${user}:${user} /home/${user}/.xsession ;;(classic) (apt-get update ;apt-get install --no-install-recommends ubuntu-desktop=1.361.6 gnome-panel=1:3.18.3-0ubuntu0.1 metacity=1:3.18.7-0ubuntu0.3 -y ) \\\n && ln -s /usr/bin/unity-control-center /usr/bin/gnome-control-center \\\n && printf \"gnome-panel &\\nmetacity &\\n\" > /home/${user}/.xsessionrc \\\n && chown ${user}:${user} /home/${user}/.xsessionrc ;;(mate) (apt-get update ;apt-get install --no-install-recommends ubuntu-mate-desktop=1.154.1 ubuntu-mate-core=1.154.1 mate-desktop-environment-extras=1.12.0+1 -y ) \\\n && service dbus start \\\n && su - ${user} -c \"dbus-launch gsettings set org.mate.screensaver idle-activation-enabled false\" \\\n && su - ${user} -c \"dbus-launch gsettings set org.mate.screensaver lock-enabled false\" \\\n && service dbus stop \\\n && echo \"mate-session\" > /home/${user}/.xsession \\\n && chown ${user}:${user} /home/${user}/.xsession ;;(xubuntu) (apt-get update ;apt-get install --no-install-recommends xubuntu-desktop=2.206 -y ) \\\n && echo \"mode: off\\n\" > /home/${user}/.xscreensaver \\\n && chown ${user}:${user} /home/${user}/.xscreensaver \\\n && echo \"xfce4-session\" > /home/${user}/.xsession \\\n && chown ${user}:${user} /home/${user}/.xsession ;;(lubuntu) (apt-get update ;apt-get install --no-install-recommends lubuntu-desktop=0.65.3 -y ) \\\n && apt-get remove -y light-locker \\\n && echo \"lxsession -s Lubuntu -e LXDE\" > /home/${user}/.xsession \\\n && chown ${user}:${user} /home/${user}/.xsession ;;(kubuntu) (apt-get update ;apt-get install --no-install-recommends kubuntu-desktop=1.338 -y ) \\\n && (apt-get update ;apt-get install --no-install-recommends libglib2.0-bin=2.48.2-0ubuntu4.8 -y ) \\\n && echo \"startkde\" > /home/${user}/.xsession \\\n && chown ${user}:${user} /home/${user}/.xsession ;; esac\n#   Fix incomplete language support.\nRUN (apt-get update ;apt-get install --no-install-recommends language-selector-common=0.165.4 -y ) \\\n && (apt-get update ;apt-get install --no-install-recommends language-pack-gnome-en=1:16.04+20161009 -y ) \\\n && (apt-get update ;apt-get install --no-install-recommends $( check-language-support ;) -y )\n#   Remove gnome-software. If you need image including gnome-software,\n#   you need to run gnome-software on container till gnome-software\n#   initialization completed. And you need to stop rsyslog, dbus and\n#   xrdp service. Then you need to commit container as image.\nRUN apt-get remove -y gnome-software\n#   Remove expect.\nRUN apt-get remove -y expect\n#   Clean cache\nRUN apt-get autoremove -y \\\n && apt-get clean -y all\n#   Use rsyslog instead of journald.\nCMD service rsyslog start \\\n && service dbus start \\\n && service xrdp start \\\n && tail -f /var/log/syslog\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  Dockerfile for XRDP on Ubuntu 16.04 desktop.\n#\n#  Copyright (C) 2017 Hiroo MATSUMOTO <hiroom2.mail@gmail.com>\n#\nFROM ubuntu:16.04\nMAINTAINER Hiroo MATSUMOTO <hiroom2.mail@gmail.com>\nLABEL Description=\"XRDP on Ubuntu 16.04 desktop\" \\\n      Version=\"1.0\"\nEXPOSE 3389/tcp\nARG user=${user:-doxrdp}\nARG password=${password:-doxrdp}\nARG desktop=${desktop:-unity}\nARG xrdp=${xrdp:-0.9.1-7}\nARG model=${model:-pc105}\nARG layout=${layout:-us}\nARG cpu=${cpu:-amd64}\n#  Check desktop argument at an early stage.\nRUN case \"${desktop}\" in (unity) true ;;(classic) true ;;(xubuntu) true ;;(mate) true ;;(lubuntu) true ;;(kubuntu) true ;;(*) echo \"Not supported desktop: ${desktop}\" 1>&2; false ;; esac\n#  Set locale.\nRUN locale-gen en_US en_US.UTF-8\nENV LANG=\"en_US.UTF-8\"\nENV LANGUAGE=\"en_US:en\"\nENV LC_ALL=\"en_US.UTF-8\"\nRUN locale > /etc/default/locale\n#  Update Ubuntu.\nRUN apt-get update -y \\\n && apt-get upgrade -y\n#  Install expect.\nRUN apt-get install expect -y\n#  Install debconf at an early stage for debconf-set-selections.\nRUN apt-get install debconf -y\n#  Set keyboard.\nRUN echo \"keyboard-configuration keyboard-configuration/modelcode string ${model}\\nkeyboard-configuration keyboard-configuration/layoutcode string ${layout}\\n\" | debconf-set-selections\n#  Create user.\nRUN apt-get install sudo bash -y \\\n && sed -e 's/%sudo\\(.*\\)ALL$/%sudo\\1NOPASSWD:ALL/g' -i /etc/sudoers \\\n && useradd -m ${user} -s /bin/bash \\\n && gpasswd -a ${user} sudo \\\n && printf \"set timeout -1\\nspawn passwd ${user}\\nexpect \\\"Enter new UNIX password:\\\" { send \\\"${password}\\\\n\\\" }\\nexpect \\\"Retype new UNIX password:\\\" { send \\\"${password}\\\\n\\\" }\\nexpect eof\\n\" | expect\n#  Install TigerVNC from upstream.\nRUN apt-get install dpkg-dev git -y \\\n && mkdir tigervnc.build \\\n && cd tigervnc.build \\\n && git clone https://github.com/TigerVNC/tigervnc \\\n && cd tigervnc \\\n && git checkout ff872614b507d0aa8bfbd09ef41550390cfe658a -b branch \\\n && ln -s contrib/packages/deb/ubuntu-xenial/debian \\\n && chmod a+x debian/rules \\\n && pkgs=$( dpkg-checkbuilddeps 2>&1 | sed -e 's/.*build dependencies://g' -e 's/([^)]*)//g' ;) \\\n && apt-get install 'apt::install-recommends=true' ${pkgs} -y -o \\\n && fakeroot debian/rules binary \\\n && apt-get remove -y dpkg-dev git ${pkgs} \\\n && cd .. \\\n && (dpkg -i *.deb || (apt-get install -f -y \\\n && dpkg -i *.deb ) ) \\\n && cd .. \\\n && rm -rf tigervnc.build\n#  Install latest XRDP. And apply patch to latest XRDP for changing\n#  Xvnc session to be default because Xorg session's cursor has black\n#  background.\nRUN mkdir xrdp \\\n && cd xrdp \\\n && apt-get install wget patch -y \\\n && URL=http://archive.ubuntu.com/ubuntu/pool/universe/x/xrdp \\\n && PKG=\"xrdp_${xrdp}_${cpu}.deb xorgxrdp_${xrdp}_${cpu}.deb \" \\\n && for pkg in ${PKG}; do wget -q ${URL}/${pkg} \\\n && (dpkg -i \"${pkg}\" || apt-get install -f -y ) ; done \\\n && cd .. \\\n && rm -rf xrdp \\\n && cd /etc/xrdp \\\n && echo \"--- xrdp.ini.org 2017-02-23 07:14:16.614833723 +0000\\n+++ xrdp.ini 2017-02-23 07:15:10.489078284 +0000\\n@@ -147,15 +147,6 @@ tcutils=true\\n ; Session types\\n ;\\n \\n-[Xorg]\\n-name=Xorg\\n-lib=libxup.so\\n-username=ask\\n-password=ask\\n-ip=127.0.0.1\\n-port=-1\\n-code=20\\n-\\n [Xvnc]\\n name=Xvnc\\n lib=libvnc.so\\n@@ -166,6 +157,15 @@ port=-1\\n \\n+[Xorg]\\n+name=Xorg\\n+lib=libxup.so\\n+username=ask\\n+password=ask\\n+ip=127.0.0.1\\n+port=-1\\n+code=20\\n+\\n [console]\\n name=console\\n lib=libvnc.so\\n\" | patch -p0 \\\n && apt-get remove -y wget patch\n#  Disable resolvconf postinst to /etc/resolv.conf which cannot be\n#  updated in container.\n#  https://github.com/docker/docker/issues/1297#issuecomment-115458690\nRUN echo \"resolvconf resolvconf/linkify-resolvconf boolean false\" | debconf-set-selections\n#  Install desktop.\nRUN case \"${desktop}\" in (unity) apt-get install ubuntu-desktop unity -y \\\n && ln -s /usr/bin/unity-control-center /usr/bin/gnome-control-center \\\n && service dbus start \\\n && su - ${user} -c \"dbus-launch gsettings set org.gnome.desktop.lockdown disable-lock-screen true\" \\\n && su - ${user} -c \"dbus-launch gsettings set org.gnome.desktop.session idle-delay 0\" \\\n && service dbus stop \\\n && printf \"/usr/lib/gnome-session/gnome-session-binary --session=ubuntu &\\n/usr/lib/x86_64-linux-gnu/unity/unity-panel-service &\\n/usr/lib/unity-settings-daemon/unity-settings-daemon &\\n\\nfor indicator in /usr/lib/x86_64-linux-gnu/indicator-*; do\\n basename=$(basename ${indicator})\\n dirname=$(dirname ${indicator})\\n service=${dirname}/${basename}/${basename}-service\\n ${service} &\\ndone\\n\\nunity\\n\" > /home/${user}/.xsession \\\n && chown ${user}:${user} /home/${user}/.xsession ;;(classic) apt-get install ubuntu-desktop gnome-panel metacity -y \\\n && ln -s /usr/bin/unity-control-center /usr/bin/gnome-control-center \\\n && printf \"gnome-panel &\\nmetacity &\\n\" > /home/${user}/.xsessionrc \\\n && chown ${user}:${user} /home/${user}/.xsessionrc ;;(mate) apt-get install ubuntu-mate-desktop ubuntu-mate-core mate-desktop-environment-extras -y \\\n && service dbus start \\\n && su - ${user} -c \"dbus-launch gsettings set org.mate.screensaver idle-activation-enabled false\" \\\n && su - ${user} -c \"dbus-launch gsettings set org.mate.screensaver lock-enabled false\" \\\n && service dbus stop \\\n && echo \"mate-session\" > /home/${user}/.xsession \\\n && chown ${user}:${user} /home/${user}/.xsession ;;(xubuntu) apt-get install xubuntu-desktop -y \\\n && echo \"mode: off\\n\" > /home/${user}/.xscreensaver \\\n && chown ${user}:${user} /home/${user}/.xscreensaver \\\n && echo \"xfce4-session\" > /home/${user}/.xsession \\\n && chown ${user}:${user} /home/${user}/.xsession ;;(lubuntu) apt-get install lubuntu-desktop -y \\\n && apt-get remove -y light-locker \\\n && echo \"lxsession -s Lubuntu -e LXDE\" > /home/${user}/.xsession \\\n && chown ${user}:${user} /home/${user}/.xsession ;;(kubuntu) apt-get install kubuntu-desktop -y \\\n && apt-get install libglib2.0-bin -y \\\n && echo \"startkde\" > /home/${user}/.xsession \\\n && chown ${user}:${user} /home/${user}/.xsession ;; esac\n#  Fix incomplete language support.\nRUN apt-get install language-selector-common -y \\\n && apt-get install language-pack-gnome-en -y \\\n && apt-get install $( check-language-support ;) -y\n#  Remove gnome-software. If you need image including gnome-software,\n#  you need to run gnome-software on container till gnome-software\n#  initialization completed. And you need to stop rsyslog, dbus and\n#  xrdp service. Then you need to commit container as image.\nRUN apt-get remove -y gnome-software\n#  Remove expect.\nRUN apt-get remove -y expect\n#  Clean cache\nRUN apt-get autoremove -y \\\n && apt-get clean -y all\n#  Use rsyslog instead of journald.\nCMD service rsyslog start \\\n && service dbus start \\\n && service xrdp start \\\n && tail -f /var/log/syslog\n","injectedSmells":[],"originalDockerfileHash":"de2d6a6dfa13f96b0b2334fa025717a4","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   Dockerfile for XRDP on Ubuntu 16.04 desktop.\n#\n#   Copyright (C) 2017 Hiroo MATSUMOTO <hiroom2.mail@gmail.com>\n#\nFROM ubuntu:16.04\nMAINTAINER Hiroo MATSUMOTO <hiroom2.mail@gmail.com>\nLABEL Description=\"XRDP on Ubuntu 16.04 desktop\" \\\n      Version=\"1.0\"\nEXPOSE 3389/tcp\nARG user=${user:-doxrdp}\nARG password=${password:-doxrdp}\nARG desktop=${desktop:-unity}\nARG xrdp=${xrdp:-0.9.1-7}\nARG model=${model:-pc105}\nARG layout=${layout:-us}\nARG cpu=${cpu:-amd64}\n#   Check desktop argument at an early stage.\nRUN case \"${desktop}\" in (unity) true ;;(classic) true ;;(xubuntu) true ;;(mate) true ;;(lubuntu) true ;;(kubuntu) true ;;(*) echo \"Not supported desktop: ${desktop}\" 1>&2; false ;; esac\n#   Set locale.\nRUN locale-gen en_US en_US.UTF-8\nENV LANG=\"en_US.UTF-8\"\nENV LANGUAGE=\"en_US:en\"\nENV LC_ALL=\"en_US.UTF-8\"\nRUN locale > /etc/default/locale\n#   Update Ubuntu.\nRUN apt-get update -y \\\n && apt-get upgrade -y\n#   Install expect.\nRUN apt-get install expect -y\n#   Install debconf at an early stage for debconf-set-selections.\nRUN apt-get install debconf -y\n#   Set keyboard.\nRUN echo \"keyboard-configuration keyboard-configuration/modelcode string ${model}\\nkeyboard-configuration keyboard-configuration/layoutcode string ${layout}\\n\" | debconf-set-selections\n#   Create user.\nRUN apt-get install sudo bash -y \\\n && sed -e 's/%sudo\\(.*\\)ALL$/%sudo\\1NOPASSWD:ALL/g' -i /etc/sudoers \\\n && useradd -m ${user} -s /bin/bash \\\n && gpasswd -a ${user} sudo \\\n && printf \"set timeout -1\\nspawn passwd ${user}\\nexpect \\\"Enter new UNIX password:\\\" { send \\\"${password}\\n\\\" }\\nexpect \\\"Retype new UNIX password:\\\" { send \\\"${password}\\n\\\" }\\nexpect eof\\n\" | expect\n#   Install TigerVNC from upstream.\nRUN apt-get install dpkg-dev git -y \\\n && mkdir tigervnc.build \\\n && cd tigervnc.build \\\n && git clone https://github.com/TigerVNC/tigervnc \\\n && cd tigervnc \\\n && git checkout ff872614b507d0aa8bfbd09ef41550390cfe658a -b branch \\\n && ln -s contrib/packages/deb/ubuntu-xenial/debian \\\n && chmod a+x debian/rules \\\n && pkgs=$( dpkg-checkbuilddeps 2>&1 | sed -e 's/.*build dependencies://g' -e 's/([^)]*)//g' ;) \\\n && apt-get install 'apt::install-recommends=true' ${pkgs} -y -o \\\n && fakeroot debian/rules binary \\\n && apt-get remove -y dpkg-dev git ${pkgs} \\\n && cd .. \\\n && (dpkg -i *.deb || (apt-get install -f -y \\\n && dpkg -i *.deb ) ) \\\n && cd .. \\\n && rm -rf tigervnc.build\n#   Install latest XRDP. And apply patch to latest XRDP for changing\n#   Xvnc session to be default because Xorg session's cursor has black\n#   background.\nRUN mkdir xrdp \\\n && cd xrdp \\\n && apt-get install wget patch -y \\\n && URL=http://archive.ubuntu.com/ubuntu/pool/universe/x/xrdp \\\n && PKG=\"xrdp_${xrdp}_${cpu}.deb xorgxrdp_${xrdp}_${cpu}.deb \" \\\n && for pkg in ${PKG}; do wget -q ${URL}/${pkg} \\\n && (dpkg -i \"${pkg}\" || apt-get install -f -y ) ; done \\\n && cd .. \\\n && rm -rf xrdp \\\n && cd /etc/xrdp \\\n && echo \"--- xrdp.ini.org 2017-02-23 07:14:16.614833723 +0000\\n+++ xrdp.ini 2017-02-23 07:15:10.489078284 +0000\\n@@ -147,15 +147,6 @@ tcutils=true\\n ; Session types\\n ;\\n \\n-[Xorg]\\n-name=Xorg\\n-lib=libxup.so\\n-username=ask\\n-password=ask\\n-ip=127.0.0.1\\n-port=-1\\n-code=20\\n-\\n [Xvnc]\\n name=Xvnc\\n lib=libvnc.so\\n@@ -166,6 +157,15 @@ port=-1\\n \\n+[Xorg]\\n+name=Xorg\\n+lib=libxup.so\\n+username=ask\\n+password=ask\\n+ip=127.0.0.1\\n+port=-1\\n+code=20\\n+\\n [console]\\n name=console\\n lib=libvnc.so\\n\" | patch -p0 \\\n && apt-get remove -y wget patch\n#   Disable resolvconf postinst to /etc/resolv.conf which cannot be\n#   updated in container.\n#   https://github.com/docker/docker/issues/1297#issuecomment-115458690\nRUN echo \"resolvconf resolvconf/linkify-resolvconf boolean false\" | debconf-set-selections\n#   Install desktop.\nRUN case \"${desktop}\" in (unity) apt-get install ubuntu-desktop unity -y \\\n && ln -s /usr/bin/unity-control-center /usr/bin/gnome-control-center \\\n && service dbus start \\\n && su - ${user} -c \"dbus-launch gsettings set org.gnome.desktop.lockdown disable-lock-screen true\" \\\n && su - ${user} -c \"dbus-launch gsettings set org.gnome.desktop.session idle-delay 0\" \\\n && service dbus stop \\\n && printf \"/usr/lib/gnome-session/gnome-session-binary --session=ubuntu &\\n/usr/lib/x86_64-linux-gnu/unity/unity-panel-service &\\n/usr/lib/unity-settings-daemon/unity-settings-daemon &\\n\\nfor indicator in /usr/lib/x86_64-linux-gnu/indicator-*; do\\n basename=$( basename ${indicator} ;)\\n dirname=$( dirname ${indicator} ;)\\n service=${dirname}/${basename}/${basename}-service\\n ${service} &\\ndone\\n\\nunity\\n\" > /home/${user}/.xsession \\\n && chown ${user}:${user} /home/${user}/.xsession ;;(classic) apt-get install ubuntu-desktop gnome-panel metacity -y \\\n && ln -s /usr/bin/unity-control-center /usr/bin/gnome-control-center \\\n && printf \"gnome-panel &\\nmetacity &\\n\" > /home/${user}/.xsessionrc \\\n && chown ${user}:${user} /home/${user}/.xsessionrc ;;(mate) apt-get install ubuntu-mate-desktop ubuntu-mate-core mate-desktop-environment-extras -y \\\n && service dbus start \\\n && su - ${user} -c \"dbus-launch gsettings set org.mate.screensaver idle-activation-enabled false\" \\\n && su - ${user} -c \"dbus-launch gsettings set org.mate.screensaver lock-enabled false\" \\\n && service dbus stop \\\n && echo \"mate-session\" > /home/${user}/.xsession \\\n && chown ${user}:${user} /home/${user}/.xsession ;;(xubuntu) apt-get install xubuntu-desktop -y \\\n && echo \"mode: off\\n\" > /home/${user}/.xscreensaver \\\n && chown ${user}:${user} /home/${user}/.xscreensaver \\\n && echo \"xfce4-session\" > /home/${user}/.xsession \\\n && chown ${user}:${user} /home/${user}/.xsession ;;(lubuntu) apt-get install lubuntu-desktop -y \\\n && apt-get remove -y light-locker \\\n && echo \"lxsession -s Lubuntu -e LXDE\" > /home/${user}/.xsession \\\n && chown ${user}:${user} /home/${user}/.xsession ;;(kubuntu) apt-get install kubuntu-desktop -y \\\n && apt-get install libglib2.0-bin -y \\\n && echo \"startkde\" > /home/${user}/.xsession \\\n && chown ${user}:${user} /home/${user}/.xsession ;; esac\n#   Fix incomplete language support.\nRUN apt-get install language-selector-common -y \\\n && apt-get install language-pack-gnome-en -y \\\n && apt-get install $( check-language-support ;) -y\n#   Remove gnome-software. If you need image including gnome-software,\n#   you need to run gnome-software on container till gnome-software\n#   initialization completed. And you need to stop rsyslog, dbus and\n#   xrdp service. Then you need to commit container as image.\nRUN apt-get remove -y gnome-software\n#   Remove expect.\nRUN apt-get remove -y expect\n#   Clean cache\nRUN apt-get autoremove -y \\\n && apt-get clean -y all\n#   Use rsyslog instead of journald.\nCMD service rsyslog start \\\n && service dbus start \\\n && service xrdp start \\\n && tail -f /var/log/syslog\n","originalDockerfileUglifiedHash":"6233f909a92fbe634e489254e00c0bff","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/474d21b367bbe9a1348bacef5c62360ca855f01b.dockerfile"}