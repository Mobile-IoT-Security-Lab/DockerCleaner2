{"seed":1813681497,"processedDockerfileHash":"b3ca7fdaad15789a34ee5ff4febeee53","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"#   Dockerizing MongoDB: Dockerfile for building MongoDB images\n#   Based on ubuntu:latest, installs MongoDB following the instructions from:\n#   http://docs.mongodb.org/manual/tutorial/install-mongodb-on-ubuntu/\n#   Format: FROM    repository[:version]\nFROM ubuntu:latest\n#   Format: MAINTAINER Name <email@addr.ess>\nMAINTAINER Jonas Colmsjö <jonas@gizur.com>\nRUN :\nRUN (apt-get update ;apt-get install --no-install-recommends curl=7.88.1-7ubuntu1 wget=1.21.3-1ubuntu1 nano=7.2-1 -y )\nRUN echo \"export HOME=/root\" > /.profile\n#\n#   Install supervisord (used to handle processes)\n#\nRUN (apt-get update ;apt-get install --no-install-recommends supervisor=4.2.1-1ubuntu1 -y )\nCOPY ./supervisord.conf /etc/supervisor/conf.d/supervisord.conf\n#\n#   Install MongoDB\n#   ---------------\n#   Installation:\n#   Import MongoDB public GPG key AND create a MongoDB list file\nRUN apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv 7F0CEB10\nRUN echo 'deb http://downloads-distro.mongodb.org/repo/ubuntu-upstart dist 10gen' | tee /etc/apt/sources.list.d/10gen.list\n#   Update apt-get sources AND install MongoDB\nRUN :\nRUN (apt-get update ;apt-get install --no-install-recommends mongodb-org -y -q )\n#   It is possible to install a specific version also\n#   RUN apt-get install -y -q mongodb-org=2.6.1 mongodb-org-server=2.6.1 mongodb-org-shell=2.6.1 mongodb-org-mongos=2.6.1 mongodb-org-tools=2.6.1\n#   Create the MongoDB data directory\nRUN mkdir -p /data/db\nCOPY ./etc-mongod.conf /etc/mongod.conf\n#\n#   Install NodeJS\n#   --------------\nCOPY ./init-node.sh /src/\n#   Download and install using npm\nRUN curl https://raw.githubusercontent.com/creationix/nvm/v0.11.1/install.sh | bash\nRUN echo \"[ -s /.nvm/nvm.sh ] \\\n && . /.nvm/nvm.sh\" >> /.profile\nRUN /bin/bash -c \"source /.profile \\\n && nvm install v0.11.2\"\n#   Install node for root user together node jaydata etc.\nRUN /src/init-node.sh\n#   Fix a broken package.json (connect need to be exactly 2.0.0)\nCOPY ./odata-server-package.json /.nvm/v0.11.2/lib/node_modules/odata-server/package.json\nRUN /bin/bash -c \"source $HOME/.nvm/nvm.sh; nvm use v0.11.2; cd /.nvm/v0.11.2/lib/node_modules/odata-server; npm install .\"\n#\n#   Install MySQL\n#   -------------\n#   Keep upstart from complaining\nRUN dpkg-divert --local --rename --add /sbin/initctl\n#  RUN ln -s /bin/true /sbin/initctl\nRUN :\n#   Bundle everything\nCOPY ./mysql-setup.sh /src/\n#   Install MySQL server\nRUN DEBIAN_FRONTEND=noninteractive apt-get install -y mysql-server \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/*\n#   Fix configuration\nRUN sed -i -e\"s/^bind-address\\s*=\\s*127.0.0.1/bind-address = 0.0.0.0/\" /etc/mysql/my.cnf\n#   Setup admin user\nRUN /src/mysql-setup.sh\n#\n#   Tungsten replicator\n#   --------------------\nRUN :\n#   Install Java\nRUN (apt-get update ;apt-get install --no-install-recommends openjdk-7-jre -y )\n#   Install Ruby\nRUN (apt-get update ;apt-get install --no-install-recommends ruby1.9.1-full -y )\n#   Install rsync\nRUN (apt-get update ;apt-get install --no-install-recommends rsync=3.2.7-1 -y )\n#   Install sshd\nRUN (apt-get update ;apt-get install --no-install-recommends openssh-server=1:9.0p1-1ubuntu8 -y )\nRUN mkdir /var/run/sshd\n#  RUN echo 'root:password' |chpasswd\n#\n#   NOTE: Insecure, should not be used in production!!\n#\nCOPY ./root-ssh-authorized_keys /root/.ssh/authorized_keys\nCOPY ./root-ssh-id_rsa /root/.ssh/id_rsa\nCOPY ./root-ssh-id_rsa.pub /root/.ssh/id_rsa.pub\nCOPY ./etc-ssh-sshd_config /etc/ssh/sshd_config\nRUN chmod 700 /root/.ssh ; chmod 600 /root/.ssh/**\n#   Install tungsten\nRUN wget https://s3.amazonaws.com/files.continuent.com/builds/nightly/tungsten-2.0-snapshots/tungsten-replicator-2.1.0-346.tar.gz\nRUN tar -xzf tungsten-replicator-2.1.0-346.tar.gz\nRUN mkdir opt/continuent\nCOPY ./etc-mysql-my.cnf /etc/mysql/my.cnf\nRUN ln -s /etc/mysql/my.cnf /etc/my.cnf\nCOPY ./init-mongodb.js /src/\nCOPY ./init-mongodb.sh /src/\nRUN /src/init-mongodb.sh\n#\n#   Start things up\n#   ---------------\n#   2112, 10000 and 10001 are used by tungsten\n#   27017 is used by mongodb\n#   3306 is used by MySQL\n#   9001 is used by supervisord\nEXPOSE 22/tcp 80/tcp 443/tcp 8080/tcp 27017/tcp 3306/tcp 2112/tcp 10000/tcp 10001/tcp 9001/tcp\nCMD [\"supervisord\", \"-n\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  Dockerizing MongoDB: Dockerfile for building MongoDB images\n#  Based on ubuntu:latest, installs MongoDB following the instructions from:\n#  http://docs.mongodb.org/manual/tutorial/install-mongodb-on-ubuntu/\n#  Format: FROM    repository[:version]\nFROM ubuntu:latest\n#  Format: MAINTAINER Name <email@addr.ess>\nMAINTAINER Jonas Colmsjö <jonas@gizur.com>\nRUN apt-get update\nRUN apt-get install curl wget nano -y\nRUN echo \"export HOME=/root\" > /.profile\n#\n#  Install supervisord (used to handle processes)\n#\nRUN apt-get install supervisor -y\nADD ./supervisord.conf /etc/supervisor/conf.d/supervisord.conf\n#\n#  Install MongoDB\n#  ---------------\n#  Installation:\n#  Import MongoDB public GPG key AND create a MongoDB list file\nRUN apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv 7F0CEB10\nRUN echo 'deb http://downloads-distro.mongodb.org/repo/ubuntu-upstart dist 10gen' | tee /etc/apt/sources.list.d/10gen.list\n#  Update apt-get sources AND install MongoDB\nRUN apt-get update\nRUN apt-get install mongodb-org -y -q\n#  It is possible to install a specific version also\n#  RUN apt-get install -y -q mongodb-org=2.6.1 mongodb-org-server=2.6.1 mongodb-org-shell=2.6.1 mongodb-org-mongos=2.6.1 mongodb-org-tools=2.6.1\n#  Create the MongoDB data directory\nRUN mkdir -p /data/db\nADD ./etc-mongod.conf /etc/mongod.conf\n#\n#  Install NodeJS\n#  --------------\nADD ./init-node.sh /src/\n#  Download and install using npm\nRUN curl https://raw.githubusercontent.com/creationix/nvm/v0.11.1/install.sh | bash\nRUN echo \"[ -s /.nvm/nvm.sh ] \\\n && . /.nvm/nvm.sh\" >> /.profile\nRUN /bin/bash -c \"source /.profile \\\n && nvm install v0.11.2\"\n#  Install node for root user together node jaydata etc.\nRUN /src/init-node.sh\n#  Fix a broken package.json (connect need to be exactly 2.0.0)\nADD ./odata-server-package.json /.nvm/v0.11.2/lib/node_modules/odata-server/package.json\nRUN /bin/bash -c \"source $HOME/.nvm/nvm.sh; nvm use v0.11.2; cd /.nvm/v0.11.2/lib/node_modules/odata-server; npm install .\"\n#\n#  Install MySQL\n#  -------------\n#  Keep upstart from complaining\nRUN dpkg-divert --local --rename --add /sbin/initctl\n# RUN ln -s /bin/true /sbin/initctl\nRUN apt-get update\n#  Bundle everything\nADD ./mysql-setup.sh /src/\n#  Install MySQL server\nRUN DEBIAN_FRONTEND=noninteractive apt-get install -y mysql-server \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/*\n#  Fix configuration\nRUN sed -i -e\"s/^bind-address\\s*=\\s*127.0.0.1/bind-address = 0.0.0.0/\" /etc/mysql/my.cnf\n#  Setup admin user\nRUN /src/mysql-setup.sh\n#\n#  Tungsten replicator\n#  --------------------\nRUN apt-get update\n#  Install Java\nRUN apt-get install openjdk-7-jre -y\n#  Install Ruby\nRUN apt-get install ruby1.9.1-full -y\n#  Install rsync\nRUN apt-get install rsync -y\n#  Install sshd\nRUN apt-get install openssh-server -y\nRUN mkdir /var/run/sshd\n# RUN echo 'root:password' |chpasswd\n#\n#  NOTE: Insecure, should not be used in production!!\n#\nADD ./root-ssh-authorized_keys /root/.ssh/authorized_keys\nADD ./root-ssh-id_rsa /root/.ssh/id_rsa\nADD ./root-ssh-id_rsa.pub /root/.ssh/id_rsa.pub\nADD ./etc-ssh-sshd_config /etc/ssh/sshd_config\nRUN chmod 700 /root/.ssh ; chmod 600 /root/.ssh/**\n#  Install tungsten\nRUN wget https://s3.amazonaws.com/files.continuent.com/builds/nightly/tungsten-2.0-snapshots/tungsten-replicator-2.1.0-346.tar.gz\nRUN tar -xzf tungsten-replicator-2.1.0-346.tar.gz\nRUN mkdir opt/continuent\nADD ./etc-mysql-my.cnf /etc/mysql/my.cnf\nRUN ln -s /etc/mysql/my.cnf /etc/my.cnf\nADD ./init-mongodb.js /src/\nADD ./init-mongodb.sh /src/\nRUN /src/init-mongodb.sh\n#\n#  Start things up\n#  ---------------\n#  2112, 10000 and 10001 are used by tungsten\n#  27017 is used by mongodb\n#  3306 is used by MySQL\n#  9001 is used by supervisord\nEXPOSE 22/tcp 80/tcp 443/tcp 8080/tcp 27017/tcp 3306/tcp 2112/tcp 10000/tcp 10001/tcp 9001/tcp\nCMD [\"supervisord\", \"-n\"]\n","injectedSmells":[],"originalDockerfileHash":"1aece6c68b094ecff60402dc6c1a9559","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   Dockerizing MongoDB: Dockerfile for building MongoDB images\n#   Based on ubuntu:latest, installs MongoDB following the instructions from:\n#   http://docs.mongodb.org/manual/tutorial/install-mongodb-on-ubuntu/\n#   Format: FROM    repository[:version]\nFROM ubuntu:latest\n#   Format: MAINTAINER Name <email@addr.ess>\nMAINTAINER Jonas Colmsjö <jonas@gizur.com>\nRUN apt-get update\nRUN apt-get install curl wget nano -y\nRUN echo \"export HOME=/root\" > /.profile\n#\n#   Install supervisord (used to handle processes)\n#\nRUN apt-get install supervisor -y\nADD ./supervisord.conf /etc/supervisor/conf.d/supervisord.conf\n#\n#   Install MongoDB\n#   ---------------\n#   Installation:\n#   Import MongoDB public GPG key AND create a MongoDB list file\nRUN apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv 7F0CEB10\nRUN echo 'deb http://downloads-distro.mongodb.org/repo/ubuntu-upstart dist 10gen' | tee /etc/apt/sources.list.d/10gen.list\n#   Update apt-get sources AND install MongoDB\nRUN apt-get update\nRUN apt-get install mongodb-org -y -q\n#   It is possible to install a specific version also\n#   RUN apt-get install -y -q mongodb-org=2.6.1 mongodb-org-server=2.6.1 mongodb-org-shell=2.6.1 mongodb-org-mongos=2.6.1 mongodb-org-tools=2.6.1\n#   Create the MongoDB data directory\nRUN mkdir -p /data/db\nADD ./etc-mongod.conf /etc/mongod.conf\n#\n#   Install NodeJS\n#   --------------\nADD ./init-node.sh /src/\n#   Download and install using npm\nRUN curl https://raw.githubusercontent.com/creationix/nvm/v0.11.1/install.sh | bash\nRUN echo \"[ -s /.nvm/nvm.sh ] \\\n && . /.nvm/nvm.sh\" >> /.profile\nRUN /bin/bash -c \"source /.profile \\\n && nvm install v0.11.2\"\n#   Install node for root user together node jaydata etc.\nRUN /src/init-node.sh\n#   Fix a broken package.json (connect need to be exactly 2.0.0)\nADD ./odata-server-package.json /.nvm/v0.11.2/lib/node_modules/odata-server/package.json\nRUN /bin/bash -c \"source $HOME/.nvm/nvm.sh; nvm use v0.11.2; cd /.nvm/v0.11.2/lib/node_modules/odata-server; npm install .\"\n#\n#   Install MySQL\n#   -------------\n#   Keep upstart from complaining\nRUN dpkg-divert --local --rename --add /sbin/initctl\n#  RUN ln -s /bin/true /sbin/initctl\nRUN apt-get update\n#   Bundle everything\nADD ./mysql-setup.sh /src/\n#   Install MySQL server\nRUN DEBIAN_FRONTEND=noninteractive apt-get install -y mysql-server \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/*\n#   Fix configuration\nRUN sed -i -e\"s/^bind-address\\s*=\\s*127.0.0.1/bind-address = 0.0.0.0/\" /etc/mysql/my.cnf\n#   Setup admin user\nRUN /src/mysql-setup.sh\n#\n#   Tungsten replicator\n#   --------------------\nRUN apt-get update\n#   Install Java\nRUN apt-get install openjdk-7-jre -y\n#   Install Ruby\nRUN apt-get install ruby1.9.1-full -y\n#   Install rsync\nRUN apt-get install rsync -y\n#   Install sshd\nRUN apt-get install openssh-server -y\nRUN mkdir /var/run/sshd\n#  RUN echo 'root:password' |chpasswd\n#\n#   NOTE: Insecure, should not be used in production!!\n#\nADD ./root-ssh-authorized_keys /root/.ssh/authorized_keys\nADD ./root-ssh-id_rsa /root/.ssh/id_rsa\nADD ./root-ssh-id_rsa.pub /root/.ssh/id_rsa.pub\nADD ./etc-ssh-sshd_config /etc/ssh/sshd_config\nRUN chmod 700 /root/.ssh ; chmod 600 /root/.ssh/**\n#   Install tungsten\nRUN wget https://s3.amazonaws.com/files.continuent.com/builds/nightly/tungsten-2.0-snapshots/tungsten-replicator-2.1.0-346.tar.gz\nRUN tar -xzf tungsten-replicator-2.1.0-346.tar.gz\nRUN mkdir opt/continuent\nADD ./etc-mysql-my.cnf /etc/mysql/my.cnf\nRUN ln -s /etc/mysql/my.cnf /etc/my.cnf\nADD ./init-mongodb.js /src/\nADD ./init-mongodb.sh /src/\nRUN /src/init-mongodb.sh\n#\n#   Start things up\n#   ---------------\n#   2112, 10000 and 10001 are used by tungsten\n#   27017 is used by mongodb\n#   3306 is used by MySQL\n#   9001 is used by supervisord\nEXPOSE 22/tcp 80/tcp 443/tcp 8080/tcp 27017/tcp 3306/tcp 2112/tcp 10000/tcp 10001/tcp 9001/tcp\nCMD [\"supervisord\", \"-n\"]\n","originalDockerfileUglifiedHash":"fbcfac479de849172a032e4c12d037f7","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/a4b0e0ed9050674571152c089253919e95285b57.dockerfile"}