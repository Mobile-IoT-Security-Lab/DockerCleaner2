{"seed":1540650605,"processedDockerfileHash":"8df2da85c065f83889df8ab95c5a25f4","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM ubuntu:14.04\nMAINTAINER Jonas Friedmann <j@frd.mn> version: 0.1\nENV DEBIAN_FRONTEND=\"noninteractive\"\n#   Update locale\nRUN locale-gen en_US en_US.UTF-8 \\\n && dpkg-reconfigure locales\n#   Update apt\nRUN :\n#   Install dependencies\nRUN (apt-get update ;apt-get install --no-install-recommends debconf-utils=1.5.51ubuntu2 mysql-server-5.5=5.5.62-0ubuntu0.14.04.1 mysql-client=5.5.62-0ubuntu0.14.04.1 dovecot-core=1:2.2.9-1ubuntu2.6 dovecot-imapd=1:2.2.9-1ubuntu2.6 dovecot-pop3d=1:2.2.9-1ubuntu2.6 dovecot-lmtpd=1:2.2.9-1ubuntu2.6 dovecot-mysql=1:2.2.9-1ubuntu2.6 dovecot-sieve=1:2.2.9-1ubuntu2.6 dovecot-managesieved=1:2.2.9-1ubuntu2.6 supervisor=3.0b2-1ubuntu0.1 nginx=1.4.6-1ubuntu3.9 curl=7.35.0-1ubuntu2.20 php5-fpm=5.5.9+dfsg-1ubuntu4.29 php5-pgsql=5.5.9+dfsg-1ubuntu4.29 php-apc=4.0.2-2build1 php5-mcrypt=5.4.6-0ubuntu5 php5-curl=5.5.9+dfsg-1ubuntu4.29 php5-gd=5.5.9+dfsg-1ubuntu4.29 php5-json=1.3.2-2build1 php5-cli=5.5.9+dfsg-1ubuntu4.29 php5-mysql=5.5.9+dfsg-1ubuntu4.29 php5-memcache=3.0.8-4build1 php5-cgi=5.5.9+dfsg-1ubuntu4.29 git=1:1.9.1-1ubuntu0.10 mailutils=1:2.99.98-1.1 telnet=0.17-36build2 dnsutils=1:9.9.5.dfsg-3ubuntu0.19 -y )\n#   Add settings file for further usage\nCOPY settings.conf /tmp/settings.conf\n#   Configure MySQL\nCOPY mysql/adjust-mysql-configuration-file.sh /tmp/adjust-mysql-configuration-file.sh\nRUN /bin/sh /tmp/adjust-mysql-configuration-file.sh\nCOPY mysql/update-mysql-password.sh /tmp/update-mysql-password.sh\nRUN /bin/sh /tmp/update-mysql-password.sh\n#   Configure Nginx\nRUN echo \"daemon off;\" >> /etc/nginx/nginx.conf\n#   Configure PHP5-FPM\nCOPY php5-fpm/adjust-php-configuration-file.sh /tmp/adjust-php-configuration-file.sh\nRUN /bin/sh /tmp/adjust-php-configuration-file.sh\n#   Install composer\nRUN curl -sS https://getcomposer.org/installer | php\nRUN mv composer.phar /usr/local/bin/composer\n#   Prepare Nginx\nRUN rm /etc/nginx/sites-enabled/default\nCOPY nginx/vimbadmin /etc/nginx/sites-available/vimbadmin\nRUN ln -sf /etc/nginx/sites-available/vimbadmin /etc/nginx/sites-enabled/vimbadmin\nRUN mkdir /var/www\nCOPY nginx/correct-vimbadmin-hostname.sh /tmp/correct-vimbadmin-hostname.sh\nRUN /bin/sh /tmp/correct-vimbadmin-hostname.sh\n#   Configure ViMbAdmin\nRUN mkdir /var/www/vimbadmin\nRUN export INSTALL_PATH=/var/www/vimbadmin\nRUN composer config -g github-protocols https\nRUN composer create-project --no-interaction opensolutions/vimbadmin /var/www/vimbadmin -s dev\nRUN chown -R www-data: /var/www/vimbadmin/var\nCOPY mysql/create-vimbadmin-database.sh /tmp/create-vimbadmin-database.sh\nRUN /bin/sh /tmp/create-vimbadmin-database.sh\nRUN cp /var/www/vimbadmin/application/configs/application.ini.dist /var/www/vimbadmin/application/configs/application.ini\nCOPY nginx/correct-vimbadmin-settings-file.sh /tmp/correct-vimbadmin-settings-file.sh\nRUN /bin/sh /tmp/correct-vimbadmin-settings-file.sh\nRUN cp /var/www/vimbadmin/public/.htaccess.dist /var/www/vimbadmin/public/.htaccess\n#   Create SQL tables for ViMbAdmin\nCOPY nginx/create-vimbadmin-sql-tables.sh /tmp/create-vimbadmin-sql-tables.sh\nRUN /bin/sh /tmp/create-vimbadmin-sql-tables.sh\n#   Adjust web server file permissions\nRUN chown -R www-data:root /var/www\n#   Prepare installation of postfix\nRUN echo \"postfix postfix/root_address string\" | debconf-set-selections\nRUN echo \"postfix postfix/procmail boolean false\" | debconf-set-selections\nRUN echo \"postfix postfix/rfc1035_violation boolean false\" | debconf-set-selections\nRUN echo \"postfix postfix/bad_recipient_delimiter error\" | debconf-set-selections\nRUN echo \"postfix postfix/protocols select all\" | debconf-set-selections\nRUN echo \"postfix postfix/retry_upgrade_warning boolean\" | debconf-set-selections\nRUN echo \"postfix postfix/kernel_version_warning boolean\" | debconf-set-selections\nRUN echo \"postfix postfix/mailname string diva.vimm.be\" | debconf-set-selections\nRUN echo \"postfix postfix/tlsmgr_upgrade_warning boolean\" | debconf-set-selections\nRUN echo \"postfix postfix/mydomain_warning boolean\" | debconf-set-selections\nRUN echo \"postfix postfix/recipient_delim string +\" | debconf-set-selections\nRUN echo \"postfix postfix/mynetworks string 127.0.0.0/8 [::ffff:127.0.0.0]/104 [::1]/128 172.17.0.0/16 \" | debconf-set-selections\nRUN echo \"postfix postfix/not_configured error\" | debconf-set-selections\nRUN echo \"postfix postfix/main_mailer_type select Internet Site\" | debconf-set-selections\nRUN echo \"postfix postfix/sqlite_warning boolean\" | debconf-set-selections\nRUN echo \"postfix postfix/destinations string diva.vimm.be, localhost.localdomain, localhost\" | debconf-set-selections\nRUN echo \"postfix postfix/chattr boolean false\" | debconf-set-selections\nRUN echo \"postfix postfix/mailbox_limit string 0\" | debconf-set-selections\nRUN echo \"postfix postfix/relayhost string\" | debconf-set-selections\n#   Install postfix\nRUN (apt-get update ;apt-get install --no-install-recommends postfix=2.11.0-1ubuntu1.2 postfix-mysql=2.11.0-1ubuntu1.2 -y )\n#   Add postfix configuration files\nCOPY postfix/main.cf /etc/postfix/main.cf\nCOPY postfix/master.cf /etc/postfix/master.cf\nRUN mkdir /etc/postfix/mysql\nCOPY postfix/mysql/virtual_alias_maps.cf /etc/postfix/mysql/virtual_alias_maps.cf\nCOPY postfix/mysql/virtual_domains_maps.cf /etc/postfix/mysql/virtual_domains_maps.cf\nCOPY postfix/mysql/virtual_mailbox_maps.cf /etc/postfix/mysql/virtual_mailbox_maps.cf\nCOPY postfix/mysql/virtual_transport_maps.cf /etc/postfix/mysql/virtual_transport_maps.cf\n#   Adjust the files\nCOPY postfix/adjust-postfix-configuration-file.sh /tmp/adjust-postfix-configuration-file.sh\nRUN /bin/sh /tmp/adjust-postfix-configuration-file.sh\n#   Copy default services into postfix' chroot\nRUN /bin/cp /etc/services /var/spool/postfix/etc/services\n#   Configure dovecot\n#  RUN mkdir -p /var/mail/vhosts/\n#  VOLUME /var/mail/vhosts\nRUN groupadd -g 5000 vmail\nRUN useradd -g vmail -u 5000 vmail -d /var/vmail\nRUN mkdir /var/vmail\nRUN chown vmail:vmail /var/vmail\n#   Add dovecot configuration files\nCOPY dovecot/dovecot.conf /etc/dovecot/dovecot.conf\nCOPY dovecot/dovecot-sql.conf.ext /etc/dovecot/dovecot-sql.conf.ext\nCOPY dovecot/conf.d/10-auth.conf /etc/dovecot/conf.d/10-auth.conf\nCOPY dovecot/conf.d/10-logging.conf /etc/dovecot/conf.d/10-logging.conf\nCOPY dovecot/conf.d/10-mail.conf /etc/dovecot/conf.d/10-mail.conf\nCOPY dovecot/conf.d/10-master.conf /etc/dovecot/conf.d/10-master.conf\nCOPY dovecot/conf.d/15-lda.conf /etc/dovecot/conf.d/15-lda.conf\nCOPY dovecot/conf.d/20-imap.conf /etc/dovecot/conf.d/20-imap.conf\nCOPY dovecot/conf.d/20-lmtp.conf /etc/dovecot/conf.d/20-lmtp.conf\nCOPY dovecot/conf.d/20-managesieve.conf /etc/dovecot/conf.d/20-managesieve.conf\nCOPY dovecot/conf.d/20-pop3.conf /etc/dovecot/conf.d/20-pop3.conf\nCOPY dovecot/conf.d/auth-sql.conf.ext /etc/dovecot/conf.d/auth-sql.conf.ext\nRUN chown -R vmail:dovecot /etc/dovecot\nRUN chmod -R o-rwx /etc/dovecot\n#   Adjust the config files\nCOPY dovecot/adjust-dovecot-configuration-files.sh /tmp/adjust-dovecot-configuration-files.sh\nCOPY dovecot/create-ssl-certificate.sh /tmp/create-ssl-certificate.sh\nRUN /bin/sh /tmp/adjust-dovecot-configuration-files.sh\nRUN /bin/sh /tmp/create-ssl-certificate.sh\n#   Expose MySQL, postfix, Dovecot and Nginx\nEXPOSE 3306/tcp 25/tcp 80/tcp 143/tcp 993/tcp 995/tcp\n#   Copy supervisor config\nCOPY supervisor/supervisord.conf /etc/supervisor/conf.d/supervisord.conf\n#   Correct permissions\nRUN chown -R root:root /etc/postfix/ /etc/dovecot/ /etc/nginx/ /etc/supervisor/\n#   Start supervisor\nCMD [\"/usr/bin/supervisord\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM ubuntu:14.04\nMAINTAINER Jonas Friedmann <j@frd.mn> version: 0.1\nENV DEBIAN_FRONTEND=\"noninteractive\"\n#  Update locale\nRUN locale-gen en_US en_US.UTF-8 \\\n && dpkg-reconfigure locales\n#  Update apt\nRUN apt-get update\n#  Install dependencies\nRUN apt-get install debconf-utils mysql-server-5.5 mysql-client dovecot-core dovecot-imapd dovecot-pop3d dovecot-lmtpd dovecot-mysql dovecot-sieve dovecot-managesieved supervisor nginx curl php5-fpm php5-pgsql php-apc php5-mcrypt php5-curl php5-gd php5-json php5-cli php5-mysql php5-memcache php5-cgi git mailutils telnet dnsutils -y\n#  Add settings file for further usage\nADD settings.conf /tmp/settings.conf\n#  Configure MySQL\nADD mysql/adjust-mysql-configuration-file.sh /tmp/adjust-mysql-configuration-file.sh\nRUN /bin/sh /tmp/adjust-mysql-configuration-file.sh\nADD mysql/update-mysql-password.sh /tmp/update-mysql-password.sh\nRUN /bin/sh /tmp/update-mysql-password.sh\n#  Configure Nginx\nRUN echo \"daemon off;\" >> /etc/nginx/nginx.conf\n#  Configure PHP5-FPM\nADD php5-fpm/adjust-php-configuration-file.sh /tmp/adjust-php-configuration-file.sh\nRUN /bin/sh /tmp/adjust-php-configuration-file.sh\n#  Install composer\nRUN curl -sS https://getcomposer.org/installer | php\nRUN mv composer.phar /usr/local/bin/composer\n#  Prepare Nginx\nRUN rm /etc/nginx/sites-enabled/default\nADD nginx/vimbadmin /etc/nginx/sites-available/vimbadmin\nRUN ln -sf /etc/nginx/sites-available/vimbadmin /etc/nginx/sites-enabled/vimbadmin\nRUN mkdir /var/www\nADD nginx/correct-vimbadmin-hostname.sh /tmp/correct-vimbadmin-hostname.sh\nRUN /bin/sh /tmp/correct-vimbadmin-hostname.sh\n#  Configure ViMbAdmin\nRUN mkdir /var/www/vimbadmin\nRUN export INSTALL_PATH=/var/www/vimbadmin\nRUN composer config -g github-protocols https\nRUN composer create-project --no-interaction opensolutions/vimbadmin /var/www/vimbadmin -s dev\nRUN chown -R www-data: /var/www/vimbadmin/var\nADD mysql/create-vimbadmin-database.sh /tmp/create-vimbadmin-database.sh\nRUN /bin/sh /tmp/create-vimbadmin-database.sh\nRUN cp /var/www/vimbadmin/application/configs/application.ini.dist /var/www/vimbadmin/application/configs/application.ini\nADD nginx/correct-vimbadmin-settings-file.sh /tmp/correct-vimbadmin-settings-file.sh\nRUN /bin/sh /tmp/correct-vimbadmin-settings-file.sh\nRUN cp /var/www/vimbadmin/public/.htaccess.dist /var/www/vimbadmin/public/.htaccess\n#  Create SQL tables for ViMbAdmin\nADD nginx/create-vimbadmin-sql-tables.sh /tmp/create-vimbadmin-sql-tables.sh\nRUN /bin/sh /tmp/create-vimbadmin-sql-tables.sh\n#  Adjust web server file permissions\nRUN chown -R www-data:root /var/www\n#  Prepare installation of postfix\nRUN echo \"postfix postfix/root_address string\" | debconf-set-selections\nRUN echo \"postfix postfix/procmail boolean false\" | debconf-set-selections\nRUN echo \"postfix postfix/rfc1035_violation boolean false\" | debconf-set-selections\nRUN echo \"postfix postfix/bad_recipient_delimiter error\" | debconf-set-selections\nRUN echo \"postfix postfix/protocols select all\" | debconf-set-selections\nRUN echo \"postfix postfix/retry_upgrade_warning boolean\" | debconf-set-selections\nRUN echo \"postfix postfix/kernel_version_warning boolean\" | debconf-set-selections\nRUN echo \"postfix postfix/mailname string diva.vimm.be\" | debconf-set-selections\nRUN echo \"postfix postfix/tlsmgr_upgrade_warning boolean\" | debconf-set-selections\nRUN echo \"postfix postfix/mydomain_warning boolean\" | debconf-set-selections\nRUN echo \"postfix postfix/recipient_delim string +\" | debconf-set-selections\nRUN echo \"postfix postfix/mynetworks string 127.0.0.0/8 [::ffff:127.0.0.0]/104 [::1]/128 172.17.0.0/16 \" | debconf-set-selections\nRUN echo \"postfix postfix/not_configured error\" | debconf-set-selections\nRUN echo \"postfix postfix/main_mailer_type select Internet Site\" | debconf-set-selections\nRUN echo \"postfix postfix/sqlite_warning boolean\" | debconf-set-selections\nRUN echo \"postfix postfix/destinations string diva.vimm.be, localhost.localdomain, localhost\" | debconf-set-selections\nRUN echo \"postfix postfix/chattr boolean false\" | debconf-set-selections\nRUN echo \"postfix postfix/mailbox_limit string 0\" | debconf-set-selections\nRUN echo \"postfix postfix/relayhost string\" | debconf-set-selections\n#  Install postfix\nRUN apt-get install postfix postfix-mysql -y\n#  Add postfix configuration files\nADD postfix/main.cf /etc/postfix/main.cf\nADD postfix/master.cf /etc/postfix/master.cf\nRUN mkdir /etc/postfix/mysql\nADD postfix/mysql/virtual_alias_maps.cf /etc/postfix/mysql/virtual_alias_maps.cf\nADD postfix/mysql/virtual_domains_maps.cf /etc/postfix/mysql/virtual_domains_maps.cf\nADD postfix/mysql/virtual_mailbox_maps.cf /etc/postfix/mysql/virtual_mailbox_maps.cf\nADD postfix/mysql/virtual_transport_maps.cf /etc/postfix/mysql/virtual_transport_maps.cf\n#  Adjust the files\nADD postfix/adjust-postfix-configuration-file.sh /tmp/adjust-postfix-configuration-file.sh\nRUN /bin/sh /tmp/adjust-postfix-configuration-file.sh\n#  Copy default services into postfix' chroot\nRUN /bin/cp /etc/services /var/spool/postfix/etc/services\n#  Configure dovecot\n# RUN mkdir -p /var/mail/vhosts/\n# VOLUME /var/mail/vhosts\nRUN groupadd -g 5000 vmail\nRUN useradd -g vmail -u 5000 vmail -d /var/vmail\nRUN mkdir /var/vmail\nRUN chown vmail:vmail /var/vmail\n#  Add dovecot configuration files\nADD dovecot/dovecot.conf /etc/dovecot/dovecot.conf\nADD dovecot/dovecot-sql.conf.ext /etc/dovecot/dovecot-sql.conf.ext\nADD dovecot/conf.d/10-auth.conf /etc/dovecot/conf.d/10-auth.conf\nADD dovecot/conf.d/10-logging.conf /etc/dovecot/conf.d/10-logging.conf\nADD dovecot/conf.d/10-mail.conf /etc/dovecot/conf.d/10-mail.conf\nADD dovecot/conf.d/10-master.conf /etc/dovecot/conf.d/10-master.conf\nADD dovecot/conf.d/15-lda.conf /etc/dovecot/conf.d/15-lda.conf\nADD dovecot/conf.d/20-imap.conf /etc/dovecot/conf.d/20-imap.conf\nADD dovecot/conf.d/20-lmtp.conf /etc/dovecot/conf.d/20-lmtp.conf\nADD dovecot/conf.d/20-managesieve.conf /etc/dovecot/conf.d/20-managesieve.conf\nADD dovecot/conf.d/20-pop3.conf /etc/dovecot/conf.d/20-pop3.conf\nADD dovecot/conf.d/auth-sql.conf.ext /etc/dovecot/conf.d/auth-sql.conf.ext\nRUN chown -R vmail:dovecot /etc/dovecot\nRUN chmod -R o-rwx /etc/dovecot\n#  Adjust the config files\nADD dovecot/adjust-dovecot-configuration-files.sh /tmp/adjust-dovecot-configuration-files.sh\nADD dovecot/create-ssl-certificate.sh /tmp/create-ssl-certificate.sh\nRUN /bin/sh /tmp/adjust-dovecot-configuration-files.sh\nRUN /bin/sh /tmp/create-ssl-certificate.sh\n#  Expose MySQL, postfix, Dovecot and Nginx\nEXPOSE 3306/tcp 25/tcp 80/tcp 143/tcp 993/tcp 995/tcp\n#  Copy supervisor config\nADD supervisor/supervisord.conf /etc/supervisor/conf.d/supervisord.conf\n#  Correct permissions\nRUN chown -R root:root /etc/postfix/ /etc/dovecot/ /etc/nginx/ /etc/supervisor/\n#  Start supervisor\nCMD [\"/usr/bin/supervisord\"]\n","injectedSmells":[],"originalDockerfileHash":"e2ce10af539a76bf80f730c55bd4766d","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM ubuntu:14.04\nMAINTAINER Jonas Friedmann <j@frd.mn> version: 0.1\nENV DEBIAN_FRONTEND=\"noninteractive\"\n#   Update locale\nRUN locale-gen en_US en_US.UTF-8 \\\n && dpkg-reconfigure locales\n#   Update apt\nRUN apt-get update\n#   Install dependencies\nRUN apt-get install debconf-utils mysql-server-5.5 mysql-client dovecot-core dovecot-imapd dovecot-pop3d dovecot-lmtpd dovecot-mysql dovecot-sieve dovecot-managesieved supervisor nginx curl php5-fpm php5-pgsql php-apc php5-mcrypt php5-curl php5-gd php5-json php5-cli php5-mysql php5-memcache php5-cgi git mailutils telnet dnsutils -y\n#   Add settings file for further usage\nADD settings.conf /tmp/settings.conf\n#   Configure MySQL\nADD mysql/adjust-mysql-configuration-file.sh /tmp/adjust-mysql-configuration-file.sh\nRUN /bin/sh /tmp/adjust-mysql-configuration-file.sh\nADD mysql/update-mysql-password.sh /tmp/update-mysql-password.sh\nRUN /bin/sh /tmp/update-mysql-password.sh\n#   Configure Nginx\nRUN echo \"daemon off;\" >> /etc/nginx/nginx.conf\n#   Configure PHP5-FPM\nADD php5-fpm/adjust-php-configuration-file.sh /tmp/adjust-php-configuration-file.sh\nRUN /bin/sh /tmp/adjust-php-configuration-file.sh\n#   Install composer\nRUN curl -sS https://getcomposer.org/installer | php\nRUN mv composer.phar /usr/local/bin/composer\n#   Prepare Nginx\nRUN rm /etc/nginx/sites-enabled/default\nADD nginx/vimbadmin /etc/nginx/sites-available/vimbadmin\nRUN ln -sf /etc/nginx/sites-available/vimbadmin /etc/nginx/sites-enabled/vimbadmin\nRUN mkdir /var/www\nADD nginx/correct-vimbadmin-hostname.sh /tmp/correct-vimbadmin-hostname.sh\nRUN /bin/sh /tmp/correct-vimbadmin-hostname.sh\n#   Configure ViMbAdmin\nRUN mkdir /var/www/vimbadmin\nRUN export INSTALL_PATH=/var/www/vimbadmin\nRUN composer config -g github-protocols https\nRUN composer create-project --no-interaction opensolutions/vimbadmin /var/www/vimbadmin -s dev\nRUN chown -R www-data: /var/www/vimbadmin/var\nADD mysql/create-vimbadmin-database.sh /tmp/create-vimbadmin-database.sh\nRUN /bin/sh /tmp/create-vimbadmin-database.sh\nRUN cp /var/www/vimbadmin/application/configs/application.ini.dist /var/www/vimbadmin/application/configs/application.ini\nADD nginx/correct-vimbadmin-settings-file.sh /tmp/correct-vimbadmin-settings-file.sh\nRUN /bin/sh /tmp/correct-vimbadmin-settings-file.sh\nRUN cp /var/www/vimbadmin/public/.htaccess.dist /var/www/vimbadmin/public/.htaccess\n#   Create SQL tables for ViMbAdmin\nADD nginx/create-vimbadmin-sql-tables.sh /tmp/create-vimbadmin-sql-tables.sh\nRUN /bin/sh /tmp/create-vimbadmin-sql-tables.sh\n#   Adjust web server file permissions\nRUN chown -R www-data:root /var/www\n#   Prepare installation of postfix\nRUN echo \"postfix postfix/root_address string\" | debconf-set-selections\nRUN echo \"postfix postfix/procmail boolean false\" | debconf-set-selections\nRUN echo \"postfix postfix/rfc1035_violation boolean false\" | debconf-set-selections\nRUN echo \"postfix postfix/bad_recipient_delimiter error\" | debconf-set-selections\nRUN echo \"postfix postfix/protocols select all\" | debconf-set-selections\nRUN echo \"postfix postfix/retry_upgrade_warning boolean\" | debconf-set-selections\nRUN echo \"postfix postfix/kernel_version_warning boolean\" | debconf-set-selections\nRUN echo \"postfix postfix/mailname string diva.vimm.be\" | debconf-set-selections\nRUN echo \"postfix postfix/tlsmgr_upgrade_warning boolean\" | debconf-set-selections\nRUN echo \"postfix postfix/mydomain_warning boolean\" | debconf-set-selections\nRUN echo \"postfix postfix/recipient_delim string +\" | debconf-set-selections\nRUN echo \"postfix postfix/mynetworks string 127.0.0.0/8 [::ffff:127.0.0.0]/104 [::1]/128 172.17.0.0/16 \" | debconf-set-selections\nRUN echo \"postfix postfix/not_configured error\" | debconf-set-selections\nRUN echo \"postfix postfix/main_mailer_type select Internet Site\" | debconf-set-selections\nRUN echo \"postfix postfix/sqlite_warning boolean\" | debconf-set-selections\nRUN echo \"postfix postfix/destinations string diva.vimm.be, localhost.localdomain, localhost\" | debconf-set-selections\nRUN echo \"postfix postfix/chattr boolean false\" | debconf-set-selections\nRUN echo \"postfix postfix/mailbox_limit string 0\" | debconf-set-selections\nRUN echo \"postfix postfix/relayhost string\" | debconf-set-selections\n#   Install postfix\nRUN apt-get install postfix postfix-mysql -y\n#   Add postfix configuration files\nADD postfix/main.cf /etc/postfix/main.cf\nADD postfix/master.cf /etc/postfix/master.cf\nRUN mkdir /etc/postfix/mysql\nADD postfix/mysql/virtual_alias_maps.cf /etc/postfix/mysql/virtual_alias_maps.cf\nADD postfix/mysql/virtual_domains_maps.cf /etc/postfix/mysql/virtual_domains_maps.cf\nADD postfix/mysql/virtual_mailbox_maps.cf /etc/postfix/mysql/virtual_mailbox_maps.cf\nADD postfix/mysql/virtual_transport_maps.cf /etc/postfix/mysql/virtual_transport_maps.cf\n#   Adjust the files\nADD postfix/adjust-postfix-configuration-file.sh /tmp/adjust-postfix-configuration-file.sh\nRUN /bin/sh /tmp/adjust-postfix-configuration-file.sh\n#   Copy default services into postfix' chroot\nRUN /bin/cp /etc/services /var/spool/postfix/etc/services\n#   Configure dovecot\n#  RUN mkdir -p /var/mail/vhosts/\n#  VOLUME /var/mail/vhosts\nRUN groupadd -g 5000 vmail\nRUN useradd -g vmail -u 5000 vmail -d /var/vmail\nRUN mkdir /var/vmail\nRUN chown vmail:vmail /var/vmail\n#   Add dovecot configuration files\nADD dovecot/dovecot.conf /etc/dovecot/dovecot.conf\nADD dovecot/dovecot-sql.conf.ext /etc/dovecot/dovecot-sql.conf.ext\nADD dovecot/conf.d/10-auth.conf /etc/dovecot/conf.d/10-auth.conf\nADD dovecot/conf.d/10-logging.conf /etc/dovecot/conf.d/10-logging.conf\nADD dovecot/conf.d/10-mail.conf /etc/dovecot/conf.d/10-mail.conf\nADD dovecot/conf.d/10-master.conf /etc/dovecot/conf.d/10-master.conf\nADD dovecot/conf.d/15-lda.conf /etc/dovecot/conf.d/15-lda.conf\nADD dovecot/conf.d/20-imap.conf /etc/dovecot/conf.d/20-imap.conf\nADD dovecot/conf.d/20-lmtp.conf /etc/dovecot/conf.d/20-lmtp.conf\nADD dovecot/conf.d/20-managesieve.conf /etc/dovecot/conf.d/20-managesieve.conf\nADD dovecot/conf.d/20-pop3.conf /etc/dovecot/conf.d/20-pop3.conf\nADD dovecot/conf.d/auth-sql.conf.ext /etc/dovecot/conf.d/auth-sql.conf.ext\nRUN chown -R vmail:dovecot /etc/dovecot\nRUN chmod -R o-rwx /etc/dovecot\n#   Adjust the config files\nADD dovecot/adjust-dovecot-configuration-files.sh /tmp/adjust-dovecot-configuration-files.sh\nADD dovecot/create-ssl-certificate.sh /tmp/create-ssl-certificate.sh\nRUN /bin/sh /tmp/adjust-dovecot-configuration-files.sh\nRUN /bin/sh /tmp/create-ssl-certificate.sh\n#   Expose MySQL, postfix, Dovecot and Nginx\nEXPOSE 3306/tcp 25/tcp 80/tcp 143/tcp 993/tcp 995/tcp\n#   Copy supervisor config\nADD supervisor/supervisord.conf /etc/supervisor/conf.d/supervisord.conf\n#   Correct permissions\nRUN chown -R root:root /etc/postfix/ /etc/dovecot/ /etc/nginx/ /etc/supervisor/\n#   Start supervisor\nCMD [\"/usr/bin/supervisord\"]\n","originalDockerfileUglifiedHash":"b94a9f6cf21439dce0cc6edd6850d711","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/771ca17fffdb67c8a9bc487b1622faf1e8be7d4f.dockerfile"}