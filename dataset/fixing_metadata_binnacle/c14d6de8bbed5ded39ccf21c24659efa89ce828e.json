{"seed":1218565077,"processedDockerfileHash":"fa4914241051abc0eaaf05785852a34a","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","pin-package-manager-versions-apt-get","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM tiredofit/nodejs:12-debian-latest\nLABEL maintainer=\"Dave Conroy (dave at tiredofit dot ca)\"\n#  ## Set Defaults\nENV DB_EMBEDDED=\"TRUE\" \\\n    ENABLE_CRON=\"TRUE\" \\\n    ENABLE_SMTP=\"TRUE\" \\\n    ASTERISK_VERSION=\"16.3.0\" \\\n    BCG729_VERSION=\"1.0.4\" \\\n    SPANDSP_VERSION=\"20180108\" \\\n    FREEPBX_VERSION=\"15.0.15.3\" \\\n    UCP_FIRST=\"TRUE\"\n#  ## Install Dependencies\nRUN set -x \\\n && apt-get update \\\n && apt-get install --no-install-recommends wget -y \\\n && curl https://packages.sury.org/php/apt.gpg | apt-key add - \\\n && echo 'deb https://packages.sury.org/php/ stretch main' > /etc/apt/sources.list.d/deb.sury.org.list \\\n && apt-get update \\\n && apt-get install --no-install-recommends debconf locales locales-all -y \\\n && apt-get -y upgrade \\\n && ASTERISK_BUILD_DEPS=' autoconf automake bison build-essential doxygen flex libasound2-dev libcurl4-openssl-dev libedit-dev libical-dev libiksemel-dev libjansson-dev libmariadbclient-dev libncurses5-dev libneon27-dev libnewt-dev libogg-dev libresample1-dev libspandsp-dev libsqlite3-dev libsrtp0-dev libssl-dev libtiff-dev libtool-bin libvorbis-dev libxml2-dev linux-headers-amd64 pkg-config python-dev subversion unixodbc-dev uuid-dev ' \\\n && apt-get install --no-install-recommends apache2 composer fail2ban flite ffmpeg git g++ iproute2 iptables lame libiodbc2 libicu-dev libsrtp0 locales-all mariadb-client mariadb-server mongodb mpg123 net-tools php5.6 php5.6-cli php5.6-curl php5.6-gd php5.6-ldap php5.6-mbstring php5.6-mysql php5.6-sqlite php5.6-xml php5.6-zip php-pear procps sox sqlite3 sudo unixodbc uuid wget whois xmlstarlet $ASTERISK_BUILD_DEPS -y \\\n && cd /usr/src \\\n && mkdir -p mariadb-connector \\\n && curl -sSL https://downloads.mariadb.com/Connectors/odbc/connector-odbc-2.0.18/mariadb-connector-odbc-2.0.18-ga-debian-x86_64.tar.gz | tar xvfz - -C /usr/src/mariadb-connector \\\n && cp mariadb-connector/lib/libmaodbc.so /usr/lib/x86_64-linux-gnu/odbc/ \\\n && addgroup --gid 2600 asterisk \\\n && adduser --uid 2600 --gid 2600 --gecos \"Asterisk User\" --disabled-password asterisk \\\n && mkdir -p /usr/src/spandsp \\\n && curl -kL https://www.soft-switch.org/downloads/spandsp/snapshots/spandsp-${SPANDSP_VERSION}.tar.gz | tar xvfz - --strip 1 -C /usr/src/spandsp \\\n && cd /usr/src/spandsp \\\n && ./configure \\\n && make \\\n && make install \\\n && cd /usr/src \\\n && mkdir -p asterisk \\\n && curl -sSL http://downloads.asterisk.org/pub/telephony/asterisk/releases/asterisk-${ASTERISK_VERSION}.tar.gz | tar xvfz - --strip 1 -C /usr/src/asterisk \\\n && cd /usr/src/asterisk/ \\\n && make distclean \\\n && contrib/scripts/get_mp3_source.sh \\\n && ./configure --with-resample --with-pjproject-bundled --with-jansson-bundled --with-ssl=ssl --with-srtp \\\n && make menuselect/menuselect menuselect-tree menuselect.makeopts \\\n && menuselect/menuselect --disable BUILD_NATIVE --enable app_confbridge --enable app_fax --enable app_macro --enable codec_opus --enable codec_silk --enable format_mp3 --enable BETTER_BACKTRACES --disable MOH-OPSOUND-WAV --enable MOH-OPSOUND-GSM make \\\n && make install \\\n && make config \\\n && ldconfig \\\n && git clone https://github.com/BelledonneCommunications/bcg729 /usr/src/bcg729 \\\n && cd /usr/src/bcg729 \\\n && git checkout tags/$BCG729_VERSION \\\n && ./autogen.sh \\\n && ./configure --libdir=/lib \\\n && make \\\n && make install \\\n && mkdir -p /usr/src/asterisk-g72x \\\n && curl https://bitbucket.org/arkadi/asterisk-g72x/get/default.tar.gz | tar xvfz - --strip 1 -C /usr/src/asterisk-g72x \\\n && cd /usr/src/asterisk-g72x \\\n && ./autogen.sh \\\n && ./configure --with-bcg729 --with-asterisk160 --enable-penryn \\\n && make \\\n && make install \\\n && mkdir -p /var/run/fail2ban \\\n && cd / \\\n && rm -rf /usr/src/* /tmp/* /etc/cron* \\\n && apt-get purge -y $ASTERISK_BUILD_DEPS libspandsp-dev \\\n && apt-get -y autoremove \\\n && apt-get clean \\\n && apt-get install --no-install-recommends make -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && sed -i -e \"s/memory_limit = 128M/memory_limit = 256M/g\" /etc/php/5.6/apache2/php.ini \\\n && sed -i 's/\\(^upload_max_filesize = \\).*/\\120M/' /etc/php/5.6/apache2/php.ini \\\n && a2disconf other-vhosts-access-log.conf \\\n && a2enmod rewrite \\\n && a2enmod headers \\\n && rm -rf /var/log/* \\\n && mkdir -p /var/log/asterisk \\\n && mkdir -p /var/log/apache2 \\\n && mkdir -p /var/log/httpd \\\n && echo '%zabbix ALL=(asterisk) NOPASSWD:/usr/sbin/asterisk' >> /etc/sudoers \\\n && mkdir -p /assets/config/var/lib/ /assets/config/home/ \\\n && mv /home/asterisk /assets/config/home/ \\\n && ln -s /data/home/asterisk /home/asterisk \\\n && mv /var/lib/asterisk /assets/config/var/lib/ \\\n && ln -s /data/var/lib/asterisk /var/lib/asterisk \\\n && ln -s /data/usr/local/fop2 /usr/local/fop2 \\\n && mkdir -p /assets/config/var/run/ \\\n && mv /var/run/asterisk /assets/config/var/run/ \\\n && mv /var/lib/mysql /assets/config/var/lib/ \\\n && mkdir -p /assets/config/var/spool \\\n && mv /var/spool/cron /assets/config/var/spool/ \\\n && ln -s /data/var/spool/cron /var/spool/cron \\\n && mkdir -p /var/run/mongodb \\\n && rm -rf /var/lib/mongodb \\\n && ln -s /data/var/lib/mongodb /var/lib/mongodb \\\n && ln -s /data/var/run/asterisk /var/run/asterisk \\\n && rm -rf /var/spool/asterisk \\\n && ln -s /data/var/spool/asterisk /var/spool/asterisk \\\n && rm -rf /etc/asterisk \\\n && ln -s /data/etc/asterisk /etc/asterisk\n#  ## Networking Configuration\nEXPOSE 80/tcp 443/tcp 4445/tcp 4569/tcp 5060/udp 5160/udp 5061/tcp 5161/tcp 8001/tcp 8003/tcp 8008/tcp 8009/tcp 18000-20000/udp\n#  ## Files Add\nCOPY install /\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM tiredofit/nodejs:12-debian-latest\nLABEL maintainer=\"Dave Conroy (dave at tiredofit dot ca)\"\n# ## Set Defaults\nENV DB_EMBEDDED=\"TRUE\" \\\n    ENABLE_CRON=\"TRUE\" \\\n    ENABLE_SMTP=\"TRUE\" \\\n    ASTERISK_VERSION=\"16.3.0\" \\\n    BCG729_VERSION=\"1.0.4\" \\\n    SPANDSP_VERSION=\"20180108\" \\\n    FREEPBX_VERSION=\"15.0.15.3\" \\\n    UCP_FIRST=\"TRUE\"\n# ## Install Dependencies\nRUN set -x \\\n && apt-get update \\\n && apt-get install wget -y \\\n && curl https://packages.sury.org/php/apt.gpg | apt-key add - \\\n && echo 'deb https://packages.sury.org/php/ stretch main' > /etc/apt/sources.list.d/deb.sury.org.list \\\n && apt-get update \\\n && apt-get install debconf locales locales-all -y \\\n && apt-get -y upgrade \\\n && ASTERISK_BUILD_DEPS=' autoconf automake bison build-essential doxygen flex libasound2-dev libcurl4-openssl-dev libedit-dev libical-dev libiksemel-dev libjansson-dev libmariadbclient-dev libncurses5-dev libneon27-dev libnewt-dev libogg-dev libresample1-dev libspandsp-dev libsqlite3-dev libsrtp0-dev libssl-dev libtiff-dev libtool-bin libvorbis-dev libxml2-dev linux-headers-amd64 pkg-config python-dev subversion unixodbc-dev uuid-dev ' \\\n && apt-get install --no-install-recommends apache2 composer fail2ban flite ffmpeg git g++ iproute2 iptables lame libiodbc2 libicu-dev libsrtp0 locales-all mariadb-client mariadb-server mongodb mpg123 net-tools php5.6 php5.6-cli php5.6-curl php5.6-gd php5.6-ldap php5.6-mbstring php5.6-mysql php5.6-sqlite php5.6-xml php5.6-zip php-pear procps sox sqlite3 sudo unixodbc uuid wget whois xmlstarlet $ASTERISK_BUILD_DEPS -y \\\n && cd /usr/src \\\n && mkdir -p mariadb-connector \\\n && curl -sSL https://downloads.mariadb.com/Connectors/odbc/connector-odbc-2.0.18/mariadb-connector-odbc-2.0.18-ga-debian-x86_64.tar.gz | tar xvfz - -C /usr/src/mariadb-connector \\\n && cp mariadb-connector/lib/libmaodbc.so /usr/lib/x86_64-linux-gnu/odbc/ \\\n && addgroup --gid 2600 asterisk \\\n && adduser --uid 2600 --gid 2600 --gecos \"Asterisk User\" --disabled-password asterisk \\\n && mkdir -p /usr/src/spandsp \\\n && curl -kL https://www.soft-switch.org/downloads/spandsp/snapshots/spandsp-${SPANDSP_VERSION}.tar.gz | tar xvfz - --strip 1 -C /usr/src/spandsp \\\n && cd /usr/src/spandsp \\\n && ./configure \\\n && make \\\n && make install \\\n && cd /usr/src \\\n && mkdir -p asterisk \\\n && curl -sSL http://downloads.asterisk.org/pub/telephony/asterisk/releases/asterisk-${ASTERISK_VERSION}.tar.gz | tar xvfz - --strip 1 -C /usr/src/asterisk \\\n && cd /usr/src/asterisk/ \\\n && make distclean \\\n && contrib/scripts/get_mp3_source.sh \\\n && ./configure --with-resample --with-pjproject-bundled --with-jansson-bundled --with-ssl=ssl --with-srtp \\\n && make menuselect/menuselect menuselect-tree menuselect.makeopts \\\n && menuselect/menuselect --disable BUILD_NATIVE --enable app_confbridge --enable app_fax --enable app_macro --enable codec_opus --enable codec_silk --enable format_mp3 --enable BETTER_BACKTRACES --disable MOH-OPSOUND-WAV --enable MOH-OPSOUND-GSM make \\\n && make install \\\n && make config \\\n && ldconfig \\\n && git clone https://github.com/BelledonneCommunications/bcg729 /usr/src/bcg729 \\\n && cd /usr/src/bcg729 \\\n && git checkout tags/$BCG729_VERSION \\\n && ./autogen.sh \\\n && ./configure --libdir=/lib \\\n && make \\\n && make install \\\n && mkdir -p /usr/src/asterisk-g72x \\\n && curl https://bitbucket.org/arkadi/asterisk-g72x/get/default.tar.gz | tar xvfz - --strip 1 -C /usr/src/asterisk-g72x \\\n && cd /usr/src/asterisk-g72x \\\n && ./autogen.sh \\\n && ./configure --with-bcg729 --with-asterisk160 --enable-penryn \\\n && make \\\n && make install \\\n && mkdir -p /var/run/fail2ban \\\n && cd / \\\n && rm -rf /usr/src/* /tmp/* /etc/cron* \\\n && apt-get purge -y $ASTERISK_BUILD_DEPS libspandsp-dev \\\n && apt-get -y autoremove \\\n && apt-get clean \\\n && apt-get install make -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && sed -i -e \"s/memory_limit = 128M/memory_limit = 256M/g\" /etc/php/5.6/apache2/php.ini \\\n && sed -i 's/\\(^upload_max_filesize = \\).*/\\120M/' /etc/php/5.6/apache2/php.ini \\\n && a2disconf other-vhosts-access-log.conf \\\n && a2enmod rewrite \\\n && a2enmod headers \\\n && rm -rf /var/log/* \\\n && mkdir -p /var/log/asterisk \\\n && mkdir -p /var/log/apache2 \\\n && mkdir -p /var/log/httpd \\\n && echo '%zabbix ALL=(asterisk) NOPASSWD:/usr/sbin/asterisk' >> /etc/sudoers \\\n && mkdir -p /assets/config/var/lib/ /assets/config/home/ \\\n && mv /home/asterisk /assets/config/home/ \\\n && ln -s /data/home/asterisk /home/asterisk \\\n && mv /var/lib/asterisk /assets/config/var/lib/ \\\n && ln -s /data/var/lib/asterisk /var/lib/asterisk \\\n && ln -s /data/usr/local/fop2 /usr/local/fop2 \\\n && mkdir -p /assets/config/var/run/ \\\n && mv /var/run/asterisk /assets/config/var/run/ \\\n && mv /var/lib/mysql /assets/config/var/lib/ \\\n && mkdir -p /assets/config/var/spool \\\n && mv /var/spool/cron /assets/config/var/spool/ \\\n && ln -s /data/var/spool/cron /var/spool/cron \\\n && mkdir -p /var/run/mongodb \\\n && rm -rf /var/lib/mongodb \\\n && ln -s /data/var/lib/mongodb /var/lib/mongodb \\\n && ln -s /data/var/run/asterisk /var/run/asterisk \\\n && rm -rf /var/spool/asterisk \\\n && ln -s /data/var/spool/asterisk /var/spool/asterisk \\\n && rm -rf /etc/asterisk \\\n && ln -s /data/etc/asterisk /etc/asterisk\n# ## Networking Configuration\nEXPOSE 80/tcp 443/tcp 4445/tcp 4569/tcp 5060/udp 5160/udp 5061/tcp 5161/tcp 8001/tcp 8003/tcp 8008/tcp 8009/tcp 18000-20000/udp\n# ## Files Add\nADD install /\n","injectedSmells":[],"originalDockerfileHash":"1d96c51ece834eb7e2ac663c48a1d3d5","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM tiredofit/nodejs:12-debian-latest\nLABEL maintainer=\"Dave Conroy (dave at tiredofit dot ca)\"\n#  ## Set Defaults\nENV DB_EMBEDDED=\"TRUE\" \\\n    ENABLE_CRON=\"TRUE\" \\\n    ENABLE_SMTP=\"TRUE\" \\\n    ASTERISK_VERSION=\"16.3.0\" \\\n    BCG729_VERSION=\"1.0.4\" \\\n    SPANDSP_VERSION=\"20180108\" \\\n    FREEPBX_VERSION=\"15.0.15.3\" \\\n    UCP_FIRST=\"TRUE\"\n#  ## Install Dependencies\nRUN set -x \\\n && apt-get update \\\n && apt-get install wget -y \\\n && curl https://packages.sury.org/php/apt.gpg | apt-key add - \\\n && echo 'deb https://packages.sury.org/php/ stretch main' > /etc/apt/sources.list.d/deb.sury.org.list \\\n && apt-get update \\\n && apt-get install debconf locales locales-all -y \\\n && apt-get -y upgrade \\\n && ASTERISK_BUILD_DEPS=' autoconf automake bison build-essential doxygen flex libasound2-dev libcurl4-openssl-dev libedit-dev libical-dev libiksemel-dev libjansson-dev libmariadbclient-dev libncurses5-dev libneon27-dev libnewt-dev libogg-dev libresample1-dev libspandsp-dev libsqlite3-dev libsrtp0-dev libssl-dev libtiff-dev libtool-bin libvorbis-dev libxml2-dev linux-headers-amd64 pkg-config python-dev subversion unixodbc-dev uuid-dev ' \\\n && apt-get install --no-install-recommends apache2 composer fail2ban flite ffmpeg git g++ iproute2 iptables lame libiodbc2 libicu-dev libsrtp0 locales-all mariadb-client mariadb-server mongodb mpg123 net-tools php5.6 php5.6-cli php5.6-curl php5.6-gd php5.6-ldap php5.6-mbstring php5.6-mysql php5.6-sqlite php5.6-xml php5.6-zip php-pear procps sox sqlite3 sudo unixodbc uuid wget whois xmlstarlet $ASTERISK_BUILD_DEPS -y \\\n && cd /usr/src \\\n && mkdir -p mariadb-connector \\\n && curl -sSL https://downloads.mariadb.com/Connectors/odbc/connector-odbc-2.0.18/mariadb-connector-odbc-2.0.18-ga-debian-x86_64.tar.gz | tar xvfz - -C /usr/src/mariadb-connector \\\n && cp mariadb-connector/lib/libmaodbc.so /usr/lib/x86_64-linux-gnu/odbc/ \\\n && addgroup --gid 2600 asterisk \\\n && adduser --uid 2600 --gid 2600 --gecos \"Asterisk User\" --disabled-password asterisk \\\n && mkdir -p /usr/src/spandsp \\\n && curl -kL https://www.soft-switch.org/downloads/spandsp/snapshots/spandsp-${SPANDSP_VERSION}.tar.gz | tar xvfz - --strip 1 -C /usr/src/spandsp \\\n && cd /usr/src/spandsp \\\n && ./configure \\\n && make \\\n && make install \\\n && cd /usr/src \\\n && mkdir -p asterisk \\\n && curl -sSL http://downloads.asterisk.org/pub/telephony/asterisk/releases/asterisk-${ASTERISK_VERSION}.tar.gz | tar xvfz - --strip 1 -C /usr/src/asterisk \\\n && cd /usr/src/asterisk/ \\\n && make distclean \\\n && contrib/scripts/get_mp3_source.sh \\\n && ./configure --with-resample --with-pjproject-bundled --with-jansson-bundled --with-ssl=ssl --with-srtp \\\n && make menuselect/menuselect menuselect-tree menuselect.makeopts \\\n && menuselect/menuselect --disable BUILD_NATIVE --enable app_confbridge --enable app_fax --enable app_macro --enable codec_opus --enable codec_silk --enable format_mp3 --enable BETTER_BACKTRACES --disable MOH-OPSOUND-WAV --enable MOH-OPSOUND-GSM make \\\n && make install \\\n && make config \\\n && ldconfig \\\n && git clone https://github.com/BelledonneCommunications/bcg729 /usr/src/bcg729 \\\n && cd /usr/src/bcg729 \\\n && git checkout tags/$BCG729_VERSION \\\n && ./autogen.sh \\\n && ./configure --libdir=/lib \\\n && make \\\n && make install \\\n && mkdir -p /usr/src/asterisk-g72x \\\n && curl https://bitbucket.org/arkadi/asterisk-g72x/get/default.tar.gz | tar xvfz - --strip 1 -C /usr/src/asterisk-g72x \\\n && cd /usr/src/asterisk-g72x \\\n && ./autogen.sh \\\n && ./configure --with-bcg729 --with-asterisk160 --enable-penryn \\\n && make \\\n && make install \\\n && mkdir -p /var/run/fail2ban \\\n && cd / \\\n && rm -rf /usr/src/* /tmp/* /etc/cron* \\\n && apt-get purge -y $ASTERISK_BUILD_DEPS libspandsp-dev \\\n && apt-get -y autoremove \\\n && apt-get clean \\\n && apt-get install make -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && sed -i -e \"s/memory_limit = 128M/memory_limit = 256M/g\" /etc/php/5.6/apache2/php.ini \\\n && sed -i 's/\\(^upload_max_filesize = \\).*/\\120M/' /etc/php/5.6/apache2/php.ini \\\n && a2disconf other-vhosts-access-log.conf \\\n && a2enmod rewrite \\\n && a2enmod headers \\\n && rm -rf /var/log/* \\\n && mkdir -p /var/log/asterisk \\\n && mkdir -p /var/log/apache2 \\\n && mkdir -p /var/log/httpd \\\n && echo '%zabbix ALL=(asterisk) NOPASSWD:/usr/sbin/asterisk' >> /etc/sudoers \\\n && mkdir -p /assets/config/var/lib/ /assets/config/home/ \\\n && mv /home/asterisk /assets/config/home/ \\\n && ln -s /data/home/asterisk /home/asterisk \\\n && mv /var/lib/asterisk /assets/config/var/lib/ \\\n && ln -s /data/var/lib/asterisk /var/lib/asterisk \\\n && ln -s /data/usr/local/fop2 /usr/local/fop2 \\\n && mkdir -p /assets/config/var/run/ \\\n && mv /var/run/asterisk /assets/config/var/run/ \\\n && mv /var/lib/mysql /assets/config/var/lib/ \\\n && mkdir -p /assets/config/var/spool \\\n && mv /var/spool/cron /assets/config/var/spool/ \\\n && ln -s /data/var/spool/cron /var/spool/cron \\\n && mkdir -p /var/run/mongodb \\\n && rm -rf /var/lib/mongodb \\\n && ln -s /data/var/lib/mongodb /var/lib/mongodb \\\n && ln -s /data/var/run/asterisk /var/run/asterisk \\\n && rm -rf /var/spool/asterisk \\\n && ln -s /data/var/spool/asterisk /var/spool/asterisk \\\n && rm -rf /etc/asterisk \\\n && ln -s /data/etc/asterisk /etc/asterisk\n#  ## Networking Configuration\nEXPOSE 80/tcp 443/tcp 4445/tcp 4569/tcp 5060/udp 5160/udp 5061/tcp 5161/tcp 8001/tcp 8003/tcp 8008/tcp 8009/tcp 18000-20000/udp\n#  ## Files Add\nADD install /\n","originalDockerfileUglifiedHash":"67dcb4d4c5ebe1bd8ffa45a7ce896dd6","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/c14d6de8bbed5ded39ccf21c24659efa89ce828e.dockerfile"}