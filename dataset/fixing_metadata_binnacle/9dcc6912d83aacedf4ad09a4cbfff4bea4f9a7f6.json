{"seed":708608706,"processedDockerfileHash":"b2475f4fdc2f491331bd74e2e9145544","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","have-a-healthcheck"],"processedDockerfile":"ARG COMPOSER_VERSION=1.8.5\nFROM composer:${COMPOSER_VERSION} AS composer\n#   See https://github.com/docker-library/php/blob/bb16de8a711d1ba1dc76adf4665b3b1c06a06922/7.2/alpine3.9/fpm/Dockerfile\nFROM php:7.2.18-fpm-alpine3.9\nMAINTAINER Alexandre DEMODE <contact@alex-d.fr>\nARG TIMEZONE\nARG DOCKER_HOST_IP\nARG IDE_KEY\nARG APCU_VERSION=5.1.17\nRUN apk add openssl git zip unzip --no-cache\n#   Add some php extensions\nRUN apk add icu-dev $PHPIZE_DEPS --no-cache --virtual .build-deps \\\n && docker-php-ext-configure intl \\\n && docker-php-ext-install intl pdo_mysql \\\n && pecl install apcu-${APCU_VERSION} \\\n && docker-php-ext-enable apcu opcache \\\n && runDeps=\"$( scanelf --needed --nobanner --format '%n#p' --recursive /usr/local/lib/php/extensions | tr ',' '\\n' | sort -u | awk 'system(\"[ -e /usr/local/lib/\" $1 \" ]\") == 0 { next } { print \"so:\" $1 }' ;)\" \\\n && apk add $runDeps --no-cache --virtual .api-phpexts-rundeps \\\n && apk del .build-deps\n#   Install Composer\nCOPY --from=composer /usr/bin/composer /usr/bin/composer\nENV COMPOSER_ALLOW_SUPERUSER=\"1\"\nRUN composer global require \"symfony/flex\" --prefer-dist --no-progress --no-suggest --classmap-authoritative \\\n && composer clear-cache\n#   Set timezone\nRUN ln -snf /usr/share/zoneinfo/${TIMEZONE} /etc/localtime \\\n && echo ${TIMEZONE} > /etc/timezone \\\n && printf '[PHP]\\ndate.timezone = \"%s\"\\n', ${TIMEZONE} > /usr/local/etc/php/conf.d/tzone.ini\n#   Improve performances\nRUN echo \"opcache.memory_consumption=256\" >> /usr/local/etc/php/conf.d/docker-php-ext-opcache.ini \\\n && echo \"opcache.max_accelerated_files=20000\" >> /usr/local/etc/php/conf.d/docker-php-ext-opcache.ini \\\n && echo \"realpath_cache_size=4096K\" > /usr/local/etc/php/conf.d/custom.ini \\\n && echo \"realpath_cache_ttl=600\" >> /usr/local/etc/php/conf.d/custom.ini\n#   Blackfire\nENV current_os=\"alpine\"\nRUN version=$( php -r \"echo PHP_MAJOR_VERSION.PHP_MINOR_VERSION;\" ;) \\\n && curl -A \"Docker\" -o /tmp/blackfire-probe.tar.gz -D - -L -s https://blackfire.io/api/v1/releases/probe/php/$current_os/amd64/$version \\\n && mkdir -p /tmp/blackfire \\\n && tar zxpf /tmp/blackfire-probe.tar.gz -C /tmp/blackfire \\\n && mv /tmp/blackfire/blackfire-*.so $( php -r \"echo ini_get('extension_dir');\" ;)/blackfire.so \\\n && printf \"extension=blackfire.so\\nblackfire.agent_socket=tcp://blackfire:8707\\n\" > $PHP_INI_DIR/conf.d/blackfire.ini \\\n && rm -rf /tmp/blackfire /tmp/blackfire-probe.tar.gz\n#   Install Xdebug\n#  RUN pecl install xdebug && docker-php-ext-enable xdebug && \\\n#      echo \"error_reporting = E_ALL\" >> /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini && \\\n#      echo \"display_startup_errors = On\" >> /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini && \\\n#      echo \"display_errors = On\" >> /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini && \\\n#      echo \"xdebug.remote_enable=1\" >> /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini && \\\n#      echo \"xdebug.remote_autostart=1\" >> /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini && \\\n#      echo \"xdebug.remote_connect_back=0\" >> /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini && \\\n#      echo \"xdebug.remote_host=${DOCKER_HOST_IP}\" >> /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini && \\\n#      echo \"xdebug.idekey=\\\"${IDE_KEY}\\\"\" >> /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini && \\\n#      echo \"xdebug.remote_port=9001\" >> /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini && \\\n#      echo \"xdebug.remote_log=\\\"/var/www/colllect/var/logs/xdebug.log\\\"\" >> /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini\n#   Install Xdebug profiler\n#  RUN echo \"xdebug.profiler_enable=1\" >> /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini && \\\n#      echo \"xdebug.profiler_output_dir=\\\"/var/www/colllect/var/logs/xdebug_profiler\\\"\" >> /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini\nCOPY php-fpm.conf /usr/local/etc/\nRUN mkdir -p /var/cache/colllect \\\n && chown 82:82 /var/cache/colllect \\\n && chmod 755 /var/cache/colllect\nWORKDIR /var/www/colllect\nUSER www-data\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"ARG COMPOSER_VERSION=1.8.5\nFROM composer:${COMPOSER_VERSION} AS composer\n#  See https://github.com/docker-library/php/blob/bb16de8a711d1ba1dc76adf4665b3b1c06a06922/7.2/alpine3.9/fpm/Dockerfile\nFROM php:7.2.18-fpm-alpine3.9\nMAINTAINER Alexandre DEMODE <contact@alex-d.fr>\nARG TIMEZONE\nARG DOCKER_HOST_IP\nARG IDE_KEY\nARG APCU_VERSION=5.1.17\nRUN apk add --no-cache openssl git zip unzip\n#  Add some php extensions\nRUN apk add --no-cache --virtual .build-deps $PHPIZE_DEPS icu-dev \\\n && docker-php-ext-configure intl \\\n && docker-php-ext-install intl pdo_mysql \\\n && pecl install apcu-${APCU_VERSION} \\\n && docker-php-ext-enable apcu opcache \\\n && runDeps=\"$( scanelf --needed --nobanner --format '%n#p' --recursive /usr/local/lib/php/extensions | tr ',' '\\n' | sort -u | awk 'system(\"[ -e /usr/local/lib/\" $1 \" ]\") == 0 { next } { print \"so:\" $1 }' ;)\" \\\n && apk add --no-cache --virtual .api-phpexts-rundeps $runDeps \\\n && apk del .build-deps\n#  Install Composer\nCOPY --from=composer /usr/bin/composer /usr/bin/composer\nENV COMPOSER_ALLOW_SUPERUSER=\"1\"\nRUN composer global require \"symfony/flex\" --prefer-dist --no-progress --no-suggest --classmap-authoritative \\\n && composer clear-cache\n#  Set timezone\nRUN ln -snf /usr/share/zoneinfo/${TIMEZONE} /etc/localtime \\\n && echo ${TIMEZONE} > /etc/timezone \\\n && printf '[PHP]\\ndate.timezone = \"%s\"\\n', ${TIMEZONE} > /usr/local/etc/php/conf.d/tzone.ini\n#  Improve performances\nRUN echo \"opcache.memory_consumption=256\" >> /usr/local/etc/php/conf.d/docker-php-ext-opcache.ini \\\n && echo \"opcache.max_accelerated_files=20000\" >> /usr/local/etc/php/conf.d/docker-php-ext-opcache.ini \\\n && echo \"realpath_cache_size=4096K\" > /usr/local/etc/php/conf.d/custom.ini \\\n && echo \"realpath_cache_ttl=600\" >> /usr/local/etc/php/conf.d/custom.ini\n#  Blackfire\nENV current_os=\"alpine\"\nRUN version=$( php -r \"echo PHP_MAJOR_VERSION.PHP_MINOR_VERSION;\" ;) \\\n && curl -A \"Docker\" -o /tmp/blackfire-probe.tar.gz -D - -L -s https://blackfire.io/api/v1/releases/probe/php/$current_os/amd64/$version \\\n && mkdir -p /tmp/blackfire \\\n && tar zxpf /tmp/blackfire-probe.tar.gz -C /tmp/blackfire \\\n && mv /tmp/blackfire/blackfire-*.so $( php -r \"echo ini_get('extension_dir');\" ;)/blackfire.so \\\n && printf \"extension=blackfire.so\\nblackfire.agent_socket=tcp://blackfire:8707\\n\" > $PHP_INI_DIR/conf.d/blackfire.ini \\\n && rm -rf /tmp/blackfire /tmp/blackfire-probe.tar.gz\n#  Install Xdebug\n# RUN pecl install xdebug && docker-php-ext-enable xdebug && \\\n#     echo \"error_reporting = E_ALL\" >> /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini && \\\n#     echo \"display_startup_errors = On\" >> /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini && \\\n#     echo \"display_errors = On\" >> /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini && \\\n#     echo \"xdebug.remote_enable=1\" >> /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini && \\\n#     echo \"xdebug.remote_autostart=1\" >> /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini && \\\n#     echo \"xdebug.remote_connect_back=0\" >> /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini && \\\n#     echo \"xdebug.remote_host=${DOCKER_HOST_IP}\" >> /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini && \\\n#     echo \"xdebug.idekey=\\\"${IDE_KEY}\\\"\" >> /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini && \\\n#     echo \"xdebug.remote_port=9001\" >> /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini && \\\n#     echo \"xdebug.remote_log=\\\"/var/www/colllect/var/logs/xdebug.log\\\"\" >> /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini\n#  Install Xdebug profiler\n# RUN echo \"xdebug.profiler_enable=1\" >> /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini && \\\n#     echo \"xdebug.profiler_output_dir=\\\"/var/www/colllect/var/logs/xdebug_profiler\\\"\" >> /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini\nCOPY php-fpm.conf /usr/local/etc/\nRUN mkdir -p /var/cache/colllect \\\n && chown 82:82 /var/cache/colllect \\\n && chmod 755 /var/cache/colllect\nWORKDIR /var/www/colllect\nUSER www-data\n","injectedSmells":[],"originalDockerfileHash":"28b0b20e0e2d9e78d147a30d2a3c82c2","successfullyInjectedSmells":[],"originalDockerfileUglified":"ARG COMPOSER_VERSION=1.8.5\nFROM composer:${COMPOSER_VERSION} AS composer\n#   See https://github.com/docker-library/php/blob/bb16de8a711d1ba1dc76adf4665b3b1c06a06922/7.2/alpine3.9/fpm/Dockerfile\nFROM php:7.2.18-fpm-alpine3.9\nMAINTAINER Alexandre DEMODE <contact@alex-d.fr>\nARG TIMEZONE\nARG DOCKER_HOST_IP\nARG IDE_KEY\nARG APCU_VERSION=5.1.17\nRUN apk add --no-cache openssl git zip unzip\n#   Add some php extensions\nRUN apk add --no-cache --virtual .build-deps $PHPIZE_DEPS icu-dev \\\n && docker-php-ext-configure intl \\\n && docker-php-ext-install intl pdo_mysql \\\n && pecl install apcu-${APCU_VERSION} \\\n && docker-php-ext-enable apcu opcache \\\n && runDeps=\"$( scanelf --needed --nobanner --format '%n#p' --recursive /usr/local/lib/php/extensions | tr ',' '\\n' | sort -u | awk 'system(\"[ -e /usr/local/lib/\" $1 \" ]\") == 0 { next } { print \"so:\" $1 }' ;)\" \\\n && apk add --no-cache --virtual .api-phpexts-rundeps $runDeps \\\n && apk del .build-deps\n#   Install Composer\nCOPY --from=composer /usr/bin/composer /usr/bin/composer\nENV COMPOSER_ALLOW_SUPERUSER=\"1\"\nRUN composer global require \"symfony/flex\" --prefer-dist --no-progress --no-suggest --classmap-authoritative \\\n && composer clear-cache\n#   Set timezone\nRUN ln -snf /usr/share/zoneinfo/${TIMEZONE} /etc/localtime \\\n && echo ${TIMEZONE} > /etc/timezone \\\n && printf '[PHP]\\ndate.timezone = \"%s\"\\n', ${TIMEZONE} > /usr/local/etc/php/conf.d/tzone.ini\n#   Improve performances\nRUN echo \"opcache.memory_consumption=256\" >> /usr/local/etc/php/conf.d/docker-php-ext-opcache.ini \\\n && echo \"opcache.max_accelerated_files=20000\" >> /usr/local/etc/php/conf.d/docker-php-ext-opcache.ini \\\n && echo \"realpath_cache_size=4096K\" > /usr/local/etc/php/conf.d/custom.ini \\\n && echo \"realpath_cache_ttl=600\" >> /usr/local/etc/php/conf.d/custom.ini\n#   Blackfire\nENV current_os=\"alpine\"\nRUN version=$( php -r \"echo PHP_MAJOR_VERSION.PHP_MINOR_VERSION;\" ;) \\\n && curl -A \"Docker\" -o /tmp/blackfire-probe.tar.gz -D - -L -s https://blackfire.io/api/v1/releases/probe/php/$current_os/amd64/$version \\\n && mkdir -p /tmp/blackfire \\\n && tar zxpf /tmp/blackfire-probe.tar.gz -C /tmp/blackfire \\\n && mv /tmp/blackfire/blackfire-*.so $( php -r \"echo ini_get('extension_dir');\" ;)/blackfire.so \\\n && printf \"extension=blackfire.so\\nblackfire.agent_socket=tcp://blackfire:8707\\n\" > $PHP_INI_DIR/conf.d/blackfire.ini \\\n && rm -rf /tmp/blackfire /tmp/blackfire-probe.tar.gz\n#   Install Xdebug\n#  RUN pecl install xdebug && docker-php-ext-enable xdebug && \\\n#      echo \"error_reporting = E_ALL\" >> /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini && \\\n#      echo \"display_startup_errors = On\" >> /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini && \\\n#      echo \"display_errors = On\" >> /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini && \\\n#      echo \"xdebug.remote_enable=1\" >> /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini && \\\n#      echo \"xdebug.remote_autostart=1\" >> /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini && \\\n#      echo \"xdebug.remote_connect_back=0\" >> /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini && \\\n#      echo \"xdebug.remote_host=${DOCKER_HOST_IP}\" >> /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini && \\\n#      echo \"xdebug.idekey=\\\"${IDE_KEY}\\\"\" >> /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini && \\\n#      echo \"xdebug.remote_port=9001\" >> /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini && \\\n#      echo \"xdebug.remote_log=\\\"/var/www/colllect/var/logs/xdebug.log\\\"\" >> /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini\n#   Install Xdebug profiler\n#  RUN echo \"xdebug.profiler_enable=1\" >> /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini && \\\n#      echo \"xdebug.profiler_output_dir=\\\"/var/www/colllect/var/logs/xdebug_profiler\\\"\" >> /usr/local/etc/php/conf.d/docker-php-ext-xdebug.ini\nCOPY php-fpm.conf /usr/local/etc/\nRUN mkdir -p /var/cache/colllect \\\n && chown 82:82 /var/cache/colllect \\\n && chmod 755 /var/cache/colllect\nWORKDIR /var/www/colllect\nUSER www-data\n","originalDockerfileUglifiedHash":"7cd19ea1e3f5e1dc73c05f4dae98c59b","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/9dcc6912d83aacedf4ad09a4cbfff4bea4f9a7f6.dockerfile"}