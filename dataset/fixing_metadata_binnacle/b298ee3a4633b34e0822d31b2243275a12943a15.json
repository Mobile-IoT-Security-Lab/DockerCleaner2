{"seed":2462899979,"processedDockerfileHash":"9809087b0ca07c4d02e0318eb7fdcd63","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-npm","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM ubuntu:trusty\nMAINTAINER Matthieu Caneill <matthieu.caneill@savoirfairelinux.com>\nENV DEBIAN_FRONTEND=\"noninteractive\"\n#  ## Init\nRUN :\n#  ## Utils\nRUN (apt-get update ;apt-get install --no-install-recommends git=1:1.9.1-1ubuntu0.10 python-pip=1.5.4-1ubuntu4 emacs=45.0ubuntu1 curl=7.35.0-1ubuntu2.20 nodejs=0.10.25~dfsg2-2ubuntu1.2 nodejs-legacy=0.10.25~dfsg2-2ubuntu1.2 npm=1.3.10~dfsg-1 vim=2:7.4.052-1ubuntu3.1 wget=1.15-1ubuntu1.14.04.5 -y )\nRUN npm install bower@1.8.14 -g\n#  ## Other .deb sources\nRUN curl http://download.opensuse.org/repositories/home:/kaji-project/xUbuntu_14.04/Release.key | apt-key add -\nRUN echo 'deb http://download.opensuse.org/repositories/home:/kaji-project/xUbuntu_14.04/ /' >> /etc/apt/sources.list.d/kaji.list\nRUN curl http://download.opensuse.org/repositories/home:/sfl-monitoring:/monitoring-tools/xUbuntu_14.04/Release.key | apt-key add -\nRUN echo 'deb http://download.opensuse.org/repositories/home:/sfl-monitoring:/monitoring-tools/xUbuntu_14.04/ /' >> /etc/apt/sources.list.d/shinkenplugins.list\nRUN :\n#  ## InfluxDB\n#   RUN wget http://s3.amazonaws.com/influxdb/influxdb_latest_amd64.deb\nRUN wget http://get.influxdb.org.s3.amazonaws.com/influxdb_0.8.9_amd64.deb\n#   RUN dpkg -i influxdb_latest_amd64.deb\nRUN dpkg -i influxdb_0.8.9_amd64.deb\n#  ## Shinken\nRUN (apt-get update ;apt-get install --no-install-recommends kaji -y )\n#  ## Plugins\nRUN (apt-get update ;apt-get install --no-install-recommends nagios-plugins=1.5-3ubuntu1 -y )\nRUN (apt-get update ;apt-get install --no-install-recommends monitoring-plugins-sfl-check-amt-montreal monitoring-plugins-sfl-check-bixi-montreal monitoring-plugins-sfl-check-emergency-rooms-quebec monitoring-plugins-sfl-check-environment-canada monitoring-plugins-sfl-check-http2 monitoring-plugins-sfl-check-quebecrencontrescom monitoring-plugins-sfl-check-reseaucontactcom monitoring-plugins-sfl-check-stm-metro-montreal monitoring-plugins-sfl-check-hydro-quebec -y )\n#  ## SSH\nRUN (apt-get update ;apt-get install --no-install-recommends openssh-server=1:6.6p1-2ubuntu2.13 -y )\n#  ## Apache\nRUN (apt-get update ;apt-get install --no-install-recommends apache2=2.4.7-1ubuntu4.22 libapache2-mod-wsgi=3.4-4ubuntu2.1.14.04.2 -y )\n#  ## Supervisor\nRUN (apt-get update ;apt-get install --no-install-recommends supervisor=3.0b2-1ubuntu0.1 -y )\n#  # Shinken hosts/services configuration\nRUN (apt-get update ;apt-get install --no-install-recommends python-bs4=4.2.1-1ubuntu2 python-requests=2.2.1-1ubuntu0.4 -y )\n#  ## Configuration\n#  # Docker\n#   makes `df` work\n#  RUN ln -s /proc/mounts /etc/mtab\n#   run permissions for user `shinken`\nRUN chmod u+s /bin/ping\nRUN chmod u+s /bin/ping6\n#  # Shinken, Apache, Adagios\nCOPY app /srv/app\nCOPY scripts /scripts\n#  RUN mkdir /etc/shinken/adagios\nRUN scripts/banks.py > etc/shinken/adagios/banks.cfg\nRUN scripts/dns.py > etc/shinken/adagios/dns.cfg\nRUN scripts/websites.py > etc/shinken/adagios/websites.cfg\nRUN scripts/hospitals.py > etc/shinken/adagios/hospitals.cfg\nRUN scripts/transports.py > etc/shinken/adagios/transports.cfg\nRUN scripts/dating.py > etc/shinken/adagios/dating.cfg\nRUN scripts/isp.py > etc/shinken/adagios/isp.cfg\nRUN scripts/environment.py > etc/shinken/adagios/environment.cfg\nRUN scripts/energy.py > etc/shinken/adagios/energy.cfg\n#   APP\nRUN cd /srv/app \\\n && yes | bower install --allow-root\n#   Allow ssh connection from host\n#  ADD id_rsa.pub /root/.ssh/authorized_keys\n#  RUN echo root:root | chpasswd\n#  RUN sed -i 's/PermitRootLogin.*/PermitRootLogin Yes/' /etc/ssh/sshd_config\nCOPY etc /etc\n#   rm useless configuration\nRUN rm -f /etc/shinken/hosts/*\n#  ## Finishing installation\nRUN sudo bash /usr/sbin/kaji-finish-install\nEXPOSE 80/tcp\nEXPOSE 8083/tcp\nEXPOSE 22/tcp\nCMD [\"/usr/bin/supervisord\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM ubuntu:trusty\nMAINTAINER Matthieu Caneill <matthieu.caneill@savoirfairelinux.com>\nENV DEBIAN_FRONTEND=\"noninteractive\"\n# ## Init\nRUN apt-get update\n# ## Utils\nRUN apt-get install git python-pip emacs curl nodejs nodejs-legacy npm vim wget -y\nRUN npm install bower -g\n# ## Other .deb sources\nRUN curl http://download.opensuse.org/repositories/home:/kaji-project/xUbuntu_14.04/Release.key | apt-key add -\nRUN echo 'deb http://download.opensuse.org/repositories/home:/kaji-project/xUbuntu_14.04/ /' >> /etc/apt/sources.list.d/kaji.list\nRUN curl http://download.opensuse.org/repositories/home:/sfl-monitoring:/monitoring-tools/xUbuntu_14.04/Release.key | apt-key add -\nRUN echo 'deb http://download.opensuse.org/repositories/home:/sfl-monitoring:/monitoring-tools/xUbuntu_14.04/ /' >> /etc/apt/sources.list.d/shinkenplugins.list\nRUN apt-get update\n# ## InfluxDB\n#  RUN wget http://s3.amazonaws.com/influxdb/influxdb_latest_amd64.deb\nRUN wget http://get.influxdb.org.s3.amazonaws.com/influxdb_0.8.9_amd64.deb\n#  RUN dpkg -i influxdb_latest_amd64.deb\nRUN dpkg -i influxdb_0.8.9_amd64.deb\n# ## Shinken\nRUN apt-get install kaji -y\n# ## Plugins\nRUN apt-get install nagios-plugins -y\nRUN apt-get install monitoring-plugins-sfl-check-amt-montreal monitoring-plugins-sfl-check-bixi-montreal monitoring-plugins-sfl-check-emergency-rooms-quebec monitoring-plugins-sfl-check-environment-canada monitoring-plugins-sfl-check-http2 monitoring-plugins-sfl-check-quebecrencontrescom monitoring-plugins-sfl-check-reseaucontactcom monitoring-plugins-sfl-check-stm-metro-montreal monitoring-plugins-sfl-check-hydro-quebec -y\n# ## SSH\nRUN apt-get install openssh-server -y\n# ## Apache\nRUN apt-get install apache2 libapache2-mod-wsgi -y\n# ## Supervisor\nRUN apt-get install supervisor -y\n# # Shinken hosts/services configuration\nRUN apt-get install python-bs4 python-requests -y\n# ## Configuration\n# # Docker\n#  makes `df` work\n# RUN ln -s /proc/mounts /etc/mtab\n#  run permissions for user `shinken`\nRUN chmod u+s /bin/ping\nRUN chmod u+s /bin/ping6\n# # Shinken, Apache, Adagios\nADD app /srv/app\nADD scripts /scripts\n# RUN mkdir /etc/shinken/adagios\nRUN scripts/banks.py > etc/shinken/adagios/banks.cfg\nRUN scripts/dns.py > etc/shinken/adagios/dns.cfg\nRUN scripts/websites.py > etc/shinken/adagios/websites.cfg\nRUN scripts/hospitals.py > etc/shinken/adagios/hospitals.cfg\nRUN scripts/transports.py > etc/shinken/adagios/transports.cfg\nRUN scripts/dating.py > etc/shinken/adagios/dating.cfg\nRUN scripts/isp.py > etc/shinken/adagios/isp.cfg\nRUN scripts/environment.py > etc/shinken/adagios/environment.cfg\nRUN scripts/energy.py > etc/shinken/adagios/energy.cfg\n#  APP\nRUN cd /srv/app \\\n && yes | bower install --allow-root\n#  Allow ssh connection from host\n# ADD id_rsa.pub /root/.ssh/authorized_keys\n# RUN echo root:root | chpasswd\n# RUN sed -i 's/PermitRootLogin.*/PermitRootLogin Yes/' /etc/ssh/sshd_config\nADD etc /etc\n#  rm useless configuration\nRUN rm -f /etc/shinken/hosts/*\n# ## Finishing installation\nRUN sudo bash /usr/sbin/kaji-finish-install\nEXPOSE 80/tcp\nEXPOSE 8083/tcp\nEXPOSE 22/tcp\nCMD [\"/usr/bin/supervisord\"]\n","injectedSmells":[],"originalDockerfileHash":"78ae3e5cf49a526bbda76edd92ccdf0b","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM ubuntu:trusty\nMAINTAINER Matthieu Caneill <matthieu.caneill@savoirfairelinux.com>\nENV DEBIAN_FRONTEND=\"noninteractive\"\n#  ## Init\nRUN apt-get update\n#  ## Utils\nRUN apt-get install git python-pip emacs curl nodejs nodejs-legacy npm vim wget -y\nRUN npm install bower -g\n#  ## Other .deb sources\nRUN curl http://download.opensuse.org/repositories/home:/kaji-project/xUbuntu_14.04/Release.key | apt-key add -\nRUN echo 'deb http://download.opensuse.org/repositories/home:/kaji-project/xUbuntu_14.04/ /' >> /etc/apt/sources.list.d/kaji.list\nRUN curl http://download.opensuse.org/repositories/home:/sfl-monitoring:/monitoring-tools/xUbuntu_14.04/Release.key | apt-key add -\nRUN echo 'deb http://download.opensuse.org/repositories/home:/sfl-monitoring:/monitoring-tools/xUbuntu_14.04/ /' >> /etc/apt/sources.list.d/shinkenplugins.list\nRUN apt-get update\n#  ## InfluxDB\n#   RUN wget http://s3.amazonaws.com/influxdb/influxdb_latest_amd64.deb\nRUN wget http://get.influxdb.org.s3.amazonaws.com/influxdb_0.8.9_amd64.deb\n#   RUN dpkg -i influxdb_latest_amd64.deb\nRUN dpkg -i influxdb_0.8.9_amd64.deb\n#  ## Shinken\nRUN apt-get install kaji -y\n#  ## Plugins\nRUN apt-get install nagios-plugins -y\nRUN apt-get install monitoring-plugins-sfl-check-amt-montreal monitoring-plugins-sfl-check-bixi-montreal monitoring-plugins-sfl-check-emergency-rooms-quebec monitoring-plugins-sfl-check-environment-canada monitoring-plugins-sfl-check-http2 monitoring-plugins-sfl-check-quebecrencontrescom monitoring-plugins-sfl-check-reseaucontactcom monitoring-plugins-sfl-check-stm-metro-montreal monitoring-plugins-sfl-check-hydro-quebec -y\n#  ## SSH\nRUN apt-get install openssh-server -y\n#  ## Apache\nRUN apt-get install apache2 libapache2-mod-wsgi -y\n#  ## Supervisor\nRUN apt-get install supervisor -y\n#  # Shinken hosts/services configuration\nRUN apt-get install python-bs4 python-requests -y\n#  ## Configuration\n#  # Docker\n#   makes `df` work\n#  RUN ln -s /proc/mounts /etc/mtab\n#   run permissions for user `shinken`\nRUN chmod u+s /bin/ping\nRUN chmod u+s /bin/ping6\n#  # Shinken, Apache, Adagios\nADD app /srv/app\nADD scripts /scripts\n#  RUN mkdir /etc/shinken/adagios\nRUN scripts/banks.py > etc/shinken/adagios/banks.cfg\nRUN scripts/dns.py > etc/shinken/adagios/dns.cfg\nRUN scripts/websites.py > etc/shinken/adagios/websites.cfg\nRUN scripts/hospitals.py > etc/shinken/adagios/hospitals.cfg\nRUN scripts/transports.py > etc/shinken/adagios/transports.cfg\nRUN scripts/dating.py > etc/shinken/adagios/dating.cfg\nRUN scripts/isp.py > etc/shinken/adagios/isp.cfg\nRUN scripts/environment.py > etc/shinken/adagios/environment.cfg\nRUN scripts/energy.py > etc/shinken/adagios/energy.cfg\n#   APP\nRUN cd /srv/app \\\n && yes | bower install --allow-root\n#   Allow ssh connection from host\n#  ADD id_rsa.pub /root/.ssh/authorized_keys\n#  RUN echo root:root | chpasswd\n#  RUN sed -i 's/PermitRootLogin.*/PermitRootLogin Yes/' /etc/ssh/sshd_config\nADD etc /etc\n#   rm useless configuration\nRUN rm -f /etc/shinken/hosts/*\n#  ## Finishing installation\nRUN sudo bash /usr/sbin/kaji-finish-install\nEXPOSE 80/tcp\nEXPOSE 8083/tcp\nEXPOSE 22/tcp\nCMD [\"/usr/bin/supervisord\"]\n","originalDockerfileUglifiedHash":"593bfaac67ff460ebf4e65b56cdfc1f1","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/b298ee3a4633b34e0822d31b2243275a12943a15.dockerfile"}