{"seed":1795486059,"processedDockerfileHash":"0ea5b3c47a6ef67b0170149aefabd3b5","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","pin-package-manager-versions-apt-get","have-a-healthcheck","have-a-user"],"processedDockerfile":"ARG BUILD_FROM=hassioaddons/ubuntu-base:3.1.2\n#  ##############################################################################\n#   Build container to get custom vscode extensions.\n#  ##############################################################################\n#   hadolint ignore=DL3006\nFROM ${BUILD_FROM} AS vscode\n#   Copy in extensions list\nCOPY vscode.extensions /root/vscode.extensions\n#   Install the actual VSCode to download configs and extensions\n#   hadolint ignore=DL3015\nRUN apt-get update \\\n && apt-get install --no-install-recommends libx11-xcb1=2:1.6.4-3ubuntu0.2 libasound2=1.1.3-5ubuntu0.2 -y \\\n && curl -o vscode-amd64.deb -L https://vscode-update.azurewebsites.net/latest/linux-deb-x64/stable \\\n && dpkg -i vscode-amd64.deb || true \\\n && apt-get install --no-install-recommends -y -f \\\n && rm -f vscode-amd64.deb \\\n && code -v --user-data-dir /root/.config/Code\nRUN while read -r ext ; do echo \"Installing vscode extension: ${ext}\" ;code --user-data-dir /root/.config/Code --install-extension \"${ext%#*}\" ; done < /root/vscode.extensions \\\n && ls -la /root/.vscode/extensions\n#  ##############################################################################\n#   Build the actual add-on.\n#  ##############################################################################\n#   hadolint ignore=DL3006\nFROM ${BUILD_FROM}\n#   Confiure locale\nENV LANG=\"en_US.UTF-8\" \\\n    LC_ALL=\"en_US.UTF-8\"\n#   Set shell\nSHELL [\"/bin/bash\", \"-o\", \"pipefail\", \"-c\"]\n#   Copy Python requirements file\nCOPY requirements.txt /tmp/requirements.txt\n#   Setup base system\nARG BUILD_ARCH\nRUN apt-get update \\\n && apt-get install --no-install-recommends build-essential=12.4ubuntu1 colordiff=1.0.18-1 git=1:2.17.1-1ubuntu0.4 libnginx-mod-http-lua=1.14.0-0ubuntu1.2 locales=2.27-3ubuntu1 luarocks=2.4.2+dfsg-1 mosquitto-clients=1.4.15-2ubuntu0.18.04.3 net-tools=1.60+git20161116.90da8a0-1ubuntu1 nginx=1.14.0-0ubuntu1.2 nmap=7.60-1ubuntu5 openssh-client=1:7.6p1-4ubuntu0.3 openssl=1.1.0g-2ubuntu4.3 python3-dev=3.6.7-1~18.04 python3=3.6.7-1~18.04 wget=1.19.4-1ubuntu2.2 zsh=5.4.2-3ubuntu3.1 ack=2.22-1 -y \\\n && luarocks install lua-resty-http 0.13-0 \\\n && curl https://bootstrap.pypa.io/get-pip.py | python3 \\\n && locale-gen en_US.UTF-8 \\\n && curl -J -L -o /tmp/code.tar.gz \"https://github.com/cdr/code-server/releases/download/1.1156-vsc1.33.1/code-server1.1156-vsc1.33.1-linux-x64.tar.gz\" \\\n && tar zxvf /tmp/code.tar.gz --strip 1 -C /tmp \\\n && mv /tmp/code-server /usr/local/bin/code-server \\\n && chmod a+x /usr/local/bin/code-server \\\n && curl -L -s -o /usr/bin/hassio \"https://github.com/home-assistant/hassio-cli/releases/download/2.2.0/hassio_${BUILD_ARCH}\" \\\n && chmod a+x /usr/bin/hassio \\\n && git clone --branch master --single-branch --depth 1 \"git://github.com/robbyrussell/oh-my-zsh.git\" ~/.oh-my-zsh \\\n && git clone --branch master --single-branch --depth 1 \"git://github.com/zsh-users/zsh-autosuggestions\" ~/.oh-my-zsh/custom/plugins/zsh-autosuggestions \\\n && git clone --branch master --single-branch --depth 1 \"git://github.com/zsh-users/zsh-syntax-highlighting.git\" ~/.oh-my-zsh/custom/plugins/zsh-syntax-highlighting \\\n && sed -i -e \"s#bin/bash#bin/zsh#\" /etc/passwd \\\n && update-alternatives --install /usr/bin/python python /usr/bin/python3 10 \\\n && pip3 install --no-cache-dir -r /tmp/requirements.txt \\\n && apt-get purge -y --auto-remove build-essential luarocks python3-dev \\\n && find /usr/local/lib/python3.6/ -type d -name tests -depth -exec rm -rf {}\n#   Copy root filesystem\nCOPY rootfs /\n#   Get the custom extensions\nCOPY --from=vscode /root/.vscode/extensions /root/.code-server/extensions\n#   Build arguments\nARG BUILD_DATE\nARG BUILD_REF\nARG BUILD_VERSION\n#   Labels\nLABEL io.hass.name=\"Visual Studio Code\" \\\n      io.hass.description=\"Visual Studio Code, accessible through the browser.\" \\\n      io.hass.arch=\"${BUILD_ARCH}\" \\\n      io.hass.type=\"addon\" \\\n      io.hass.version=\"${BUILD_VERSION}\" \\\n      maintainer=\"Franck Nijhof <frenck@addons.community>\" \\\n      org.label-schema.description=\"Visual Studio Code, accessible through the browser.\" \\\n      org.label-schema.build-date=\"${BUILD_DATE}\" \\\n      org.label-schema.name=\"Visual Studio Code\" \\\n      org.label-schema.schema-version=\"1.0\" \\\n      org.label-schema.url=\"https://community.home-assistant.io/?u=frenck\" \\\n      org.label-schema.usage=\"https://github.com/hassio-addons/addon-vscode/tree/master/README.md\" \\\n      org.label-schema.vcs-ref=\"${BUILD_REF}\" \\\n      org.label-schema.vcs-url=\"https://github.com/hassio-addons/addon-vscode\" \\\n      org.label-schema.vendor=\"Community Hass.io Add-ons\"\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"ARG BUILD_FROM=hassioaddons/ubuntu-base:3.1.2\n# ##############################################################################\n#  Build container to get custom vscode extensions.\n# ##############################################################################\n#  hadolint ignore=DL3006\nFROM ${BUILD_FROM} AS vscode\n#  Copy in extensions list\nCOPY vscode.extensions /root/vscode.extensions\n#  Install the actual VSCode to download configs and extensions\n#  hadolint ignore=DL3015\nRUN apt-get update \\\n && apt-get install --no-install-recommends libx11-xcb1=2:1.6.4-3ubuntu0.2 libasound2=1.1.3-5ubuntu0.2 -y \\\n && curl -o vscode-amd64.deb -L https://vscode-update.azurewebsites.net/latest/linux-deb-x64/stable \\\n && dpkg -i vscode-amd64.deb || true \\\n && apt-get install -y -f \\\n && rm -f vscode-amd64.deb \\\n && code -v --user-data-dir /root/.config/Code\nRUN while read -r ext ; do echo \"Installing vscode extension: ${ext}\" ;code --user-data-dir /root/.config/Code --install-extension \"${ext%#*}\" ; done < /root/vscode.extensions \\\n && ls -la /root/.vscode/extensions\n# ##############################################################################\n#  Build the actual add-on.\n# ##############################################################################\n#  hadolint ignore=DL3006\nFROM ${BUILD_FROM}\n#  Confiure locale\nENV LANG=\"en_US.UTF-8\" \\\n    LC_ALL=\"en_US.UTF-8\"\n#  Set shell\nSHELL [\"/bin/bash\", \"-o\", \"pipefail\", \"-c\"]\n#  Copy Python requirements file\nCOPY requirements.txt /tmp/requirements.txt\n#  Setup base system\nARG BUILD_ARCH\nRUN apt-get update \\\n && apt-get install --no-install-recommends build-essential=12.4ubuntu1 colordiff=1.0.18-1 git=1:2.17.1-1ubuntu0.4 libnginx-mod-http-lua=1.14.0-0ubuntu1.2 locales=2.27-3ubuntu1 luarocks=2.4.2+dfsg-1 mosquitto-clients=1.4.15-2ubuntu0.18.04.3 net-tools=1.60+git20161116.90da8a0-1ubuntu1 nginx=1.14.0-0ubuntu1.2 nmap=7.60-1ubuntu5 openssh-client=1:7.6p1-4ubuntu0.3 openssl=1.1.0g-2ubuntu4.3 python3-dev=3.6.7-1~18.04 python3=3.6.7-1~18.04 wget=1.19.4-1ubuntu2.2 zsh=5.4.2-3ubuntu3.1 ack=2.22-1 -y \\\n && luarocks install lua-resty-http 0.13-0 \\\n && curl https://bootstrap.pypa.io/get-pip.py | python3 \\\n && locale-gen en_US.UTF-8 \\\n && curl -J -L -o /tmp/code.tar.gz \"https://github.com/cdr/code-server/releases/download/1.1156-vsc1.33.1/code-server1.1156-vsc1.33.1-linux-x64.tar.gz\" \\\n && tar zxvf /tmp/code.tar.gz --strip 1 -C /tmp \\\n && mv /tmp/code-server /usr/local/bin/code-server \\\n && chmod a+x /usr/local/bin/code-server \\\n && curl -L -s -o /usr/bin/hassio \"https://github.com/home-assistant/hassio-cli/releases/download/2.2.0/hassio_${BUILD_ARCH}\" \\\n && chmod a+x /usr/bin/hassio \\\n && git clone --branch master --single-branch --depth 1 \"git://github.com/robbyrussell/oh-my-zsh.git\" ~/.oh-my-zsh \\\n && git clone --branch master --single-branch --depth 1 \"git://github.com/zsh-users/zsh-autosuggestions\" ~/.oh-my-zsh/custom/plugins/zsh-autosuggestions \\\n && git clone --branch master --single-branch --depth 1 \"git://github.com/zsh-users/zsh-syntax-highlighting.git\" ~/.oh-my-zsh/custom/plugins/zsh-syntax-highlighting \\\n && sed -i -e \"s#bin/bash#bin/zsh#\" /etc/passwd \\\n && update-alternatives --install /usr/bin/python python /usr/bin/python3 10 \\\n && pip3 install --no-cache-dir -r /tmp/requirements.txt \\\n && apt-get purge -y --auto-remove build-essential luarocks python3-dev \\\n && find /usr/local/lib/python3.6/ -type d -name tests -depth -exec rm -rf {} ; \\\n && find /usr/local/lib/python3.6/ -type d -name test -depth -exec rm -rf {} ; \\\n && find /usr/local/lib/python3.6/ -name __pycache__ -depth -exec rm -rf {} ; \\\n && find /usr/local/lib/python3.6/ -name \"*.pyc\" -depth -exec rm -f {} ; \\\n && rm -fr /tmp/* /etc/nginx /var/{cache,log}/* /var/lib/apt/lists/* \\\n && mkdir -p /var/log/nginx \\\n && touch /var/log/nginx/error.log\n#  Copy root filesystem\nCOPY rootfs /\n#  Get the custom extensions\nCOPY --from=vscode /root/.vscode/extensions /root/.code-server/extensions\n#  Build arguments\nARG BUILD_DATE\nARG BUILD_REF\nARG BUILD_VERSION\n#  Labels\nLABEL io.hass.name=\"Visual Studio Code\" \\\n      io.hass.description=\"Visual Studio Code, accessible through the browser.\" \\\n      io.hass.arch=\"${BUILD_ARCH}\" \\\n      io.hass.type=\"addon\" \\\n      io.hass.version=\"${BUILD_VERSION}\" \\\n      maintainer=\"Franck Nijhof <frenck@addons.community>\" \\\n      org.label-schema.description=\"Visual Studio Code, accessible through the browser.\" \\\n      org.label-schema.build-date=\"${BUILD_DATE}\" \\\n      org.label-schema.name=\"Visual Studio Code\" \\\n      org.label-schema.schema-version=\"1.0\" \\\n      org.label-schema.url=\"https://community.home-assistant.io/?u=frenck\" \\\n      org.label-schema.usage=\"https://github.com/hassio-addons/addon-vscode/tree/master/README.md\" \\\n      org.label-schema.vcs-ref=\"${BUILD_REF}\" \\\n      org.label-schema.vcs-url=\"https://github.com/hassio-addons/addon-vscode\" \\\n      org.label-schema.vendor=\"Community Hass.io Add-ons\"\n","injectedSmells":[],"originalDockerfileHash":"55d75a454330aedcda8ac8b86b04f16b","successfullyInjectedSmells":[],"originalDockerfileUglified":"ARG BUILD_FROM=hassioaddons/ubuntu-base:3.1.2\n#  ##############################################################################\n#   Build container to get custom vscode extensions.\n#  ##############################################################################\n#   hadolint ignore=DL3006\nFROM ${BUILD_FROM} AS vscode\n#   Copy in extensions list\nCOPY vscode.extensions /root/vscode.extensions\n#   Install the actual VSCode to download configs and extensions\n#   hadolint ignore=DL3015\nRUN apt-get update \\\n && apt-get install --no-install-recommends libx11-xcb1=2:1.6.4-3ubuntu0.2 libasound2=1.1.3-5ubuntu0.2 -y \\\n && curl -o vscode-amd64.deb -L https://vscode-update.azurewebsites.net/latest/linux-deb-x64/stable \\\n && dpkg -i vscode-amd64.deb || true \\\n && apt-get install -y -f \\\n && rm -f vscode-amd64.deb \\\n && code -v --user-data-dir /root/.config/Code\nRUN while read -r ext ; do echo \"Installing vscode extension: ${ext}\" ;code --user-data-dir /root/.config/Code --install-extension \"${ext%#*}\" ; done < /root/vscode.extensions \\\n && ls -la /root/.vscode/extensions\n#  ##############################################################################\n#   Build the actual add-on.\n#  ##############################################################################\n#   hadolint ignore=DL3006\nFROM ${BUILD_FROM}\n#   Confiure locale\nENV LANG=\"en_US.UTF-8\" \\\n    LC_ALL=\"en_US.UTF-8\"\n#   Set shell\nSHELL [\"/bin/bash\", \"-o\", \"pipefail\", \"-c\"]\n#   Copy Python requirements file\nCOPY requirements.txt /tmp/requirements.txt\n#   Setup base system\nARG BUILD_ARCH\nRUN apt-get update \\\n && apt-get install --no-install-recommends build-essential=12.4ubuntu1 colordiff=1.0.18-1 git=1:2.17.1-1ubuntu0.4 libnginx-mod-http-lua=1.14.0-0ubuntu1.2 locales=2.27-3ubuntu1 luarocks=2.4.2+dfsg-1 mosquitto-clients=1.4.15-2ubuntu0.18.04.3 net-tools=1.60+git20161116.90da8a0-1ubuntu1 nginx=1.14.0-0ubuntu1.2 nmap=7.60-1ubuntu5 openssh-client=1:7.6p1-4ubuntu0.3 openssl=1.1.0g-2ubuntu4.3 python3-dev=3.6.7-1~18.04 python3=3.6.7-1~18.04 wget=1.19.4-1ubuntu2.2 zsh=5.4.2-3ubuntu3.1 ack=2.22-1 -y \\\n && luarocks install lua-resty-http 0.13-0 \\\n && curl https://bootstrap.pypa.io/get-pip.py | python3 \\\n && locale-gen en_US.UTF-8 \\\n && curl -J -L -o /tmp/code.tar.gz \"https://github.com/cdr/code-server/releases/download/1.1156-vsc1.33.1/code-server1.1156-vsc1.33.1-linux-x64.tar.gz\" \\\n && tar zxvf /tmp/code.tar.gz --strip 1 -C /tmp \\\n && mv /tmp/code-server /usr/local/bin/code-server \\\n && chmod a+x /usr/local/bin/code-server \\\n && curl -L -s -o /usr/bin/hassio \"https://github.com/home-assistant/hassio-cli/releases/download/2.2.0/hassio_${BUILD_ARCH}\" \\\n && chmod a+x /usr/bin/hassio \\\n && git clone --branch master --single-branch --depth 1 \"git://github.com/robbyrussell/oh-my-zsh.git\" ~/.oh-my-zsh \\\n && git clone --branch master --single-branch --depth 1 \"git://github.com/zsh-users/zsh-autosuggestions\" ~/.oh-my-zsh/custom/plugins/zsh-autosuggestions \\\n && git clone --branch master --single-branch --depth 1 \"git://github.com/zsh-users/zsh-syntax-highlighting.git\" ~/.oh-my-zsh/custom/plugins/zsh-syntax-highlighting \\\n && sed -i -e \"s#bin/bash#bin/zsh#\" /etc/passwd \\\n && update-alternatives --install /usr/bin/python python /usr/bin/python3 10 \\\n && pip3 install --no-cache-dir -r /tmp/requirements.txt \\\n && apt-get purge -y --auto-remove build-essential luarocks python3-dev \\\n && find /usr/local/lib/python3.6/ -type d -name tests -depth -exec rm -rf {}\n#   Copy root filesystem\nCOPY rootfs /\n#   Get the custom extensions\nCOPY --from=vscode /root/.vscode/extensions /root/.code-server/extensions\n#   Build arguments\nARG BUILD_DATE\nARG BUILD_REF\nARG BUILD_VERSION\n#   Labels\nLABEL io.hass.name=\"Visual Studio Code\" \\\n      io.hass.description=\"Visual Studio Code, accessible through the browser.\" \\\n      io.hass.arch=\"${BUILD_ARCH}\" \\\n      io.hass.type=\"addon\" \\\n      io.hass.version=\"${BUILD_VERSION}\" \\\n      maintainer=\"Franck Nijhof <frenck@addons.community>\" \\\n      org.label-schema.description=\"Visual Studio Code, accessible through the browser.\" \\\n      org.label-schema.build-date=\"${BUILD_DATE}\" \\\n      org.label-schema.name=\"Visual Studio Code\" \\\n      org.label-schema.schema-version=\"1.0\" \\\n      org.label-schema.url=\"https://community.home-assistant.io/?u=frenck\" \\\n      org.label-schema.usage=\"https://github.com/hassio-addons/addon-vscode/tree/master/README.md\" \\\n      org.label-schema.vcs-ref=\"${BUILD_REF}\" \\\n      org.label-schema.vcs-url=\"https://github.com/hassio-addons/addon-vscode\" \\\n      org.label-schema.vendor=\"Community Hass.io Add-ons\"\n","originalDockerfileUglifiedHash":"f2cfce645f56aae4b9b6c51203bcd9da","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/fb998b6b89083099b565d805156fb9a3fba0832c.dockerfile"}