{"seed":3688121600,"processedDockerfileHash":"37f1ea646483dedadf458372df518bda","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apt-get","have-a-healthcheck","have-a-user"],"processedDockerfile":"#   ARG usage in FROMs has to go up here in global\nARG embedpy_img=kxsys/embedpy:latest\n#  ###\nFROM $embedpy_img AS embedpy\nFROM embedpy AS juypterq\nRUN apt-get update \\\n && apt-get install --no-install-recommends build-essential=12.9ubuntu3 -yy --option=Dpkg::options::=--force-unsafe-io \\\n && apt-get clean \\\n && find /var/lib/apt/lists -type f -delete\nCOPY build/makefile requirements.txt *.q *.p *.ipynb /opt/kx/jupyterq/\nCOPY jupyterq_licensemgr/ /opt/kx/jupyterq/jupyterq_licensemgr/\nCOPY src/c/ /opt/kx/jupyterq/src/c/\nCOPY kxpy/ /opt/kx/jupyterq/kxpy/\nCOPY kernelspec/ /opt/kx/jupyterq/kernelspec/\nCOPY examples/ /opt/kx/jupyterq/examples/\n#   COPY kdb+Notebooks.ipynb /opt/kx/jupyterq/examples/kdb+Notebooks.ipynb\nRUN make -C /opt/kx/jupyterq jupyterq\n#  ###\nFROM embedpy\nARG port=8888\nENV PORT=\"${port}\"\nEXPOSE ${port}/tcp\nARG VCS_REF=dev\nARG BUILD_DATE=dev\nLABEL org.label-schema.schema-version=\"1.0\" \\\n      org.label-schema.name=\"jupyterq\" \\\n      org.label-schema.description=\"Jupyter kernel for kdb+\" \\\n      org.label-schema.vendor=\"Kx\" \\\n      org.label-schema.license=\"Apache-2.0\" \\\n      org.label-schema.url=\"https://code.kx.com/q/ml/jupyterq/\" \\\n      org.label-schema.version=\"${VERSION:-dev}\" \\\n      org.label-schema.vcs-url=\"https://github.com/KxSystems/jupyterq.git\" \\\n      org.label-schema.vcs-ref=\"$VCS_REF\" \\\n      org.label-schema.build-date=\"$BUILD_DATE\" \\\n      org.label-schema.docker.cmd=\"docker run -v `pwd`/q:/tmp/q -p $PORT:$PORT kxsys/jupyterq\"\nCOPY --from=juypterq /opt/kx/jupyterq /opt/kx/jupyterq\nRUN chown kx:kx /opt/kx/jupyterq /opt/kx/jupyterq/kdb+Notebooks.ipynb\nRUN find /opt/kx/jupyterq -maxdepth 1 -type f -name 'jupyterq_*.q' | xargs ln -s -t /opt/kx/q \\\n && ln -s -t /opt/kx/q /opt/kx/jupyterq/kxpy \\\n && ln -s -t /opt/kx/q/l64 /opt/kx/jupyterq/l64/jupyterq.so\nRUN apt-get update \\\n && apt-get install --no-install-recommends xinetd=1:2.3.15.3-1 libgl1-mesa-glx=23.0.1-1ubuntu1 -yy --option=Dpkg::options::=--force-unsafe-io \\\n && apt-get clean \\\n && find /var/lib/apt/lists -type f -delete\nUSER kx\nRUN . /opt/conda/etc/profile.d/conda.sh \\\n && conda activate kx \\\n && conda install nomkl \\\n && conda install --file /opt/kx/jupyterq/requirements.txt \\\n && conda clean -y --all\nUSER root\nRUN chown -R kx:kx /opt/kx/jupyterq/jupyterq_licensemgr\nUSER kx\nRUN . /opt/conda/etc/profile.d/conda.sh \\\n && conda activate kx \\\n && cd /opt/kx/jupyterq/jupyterq_licensemgr \\\n && python setup.py build \\\n && pip install . --user --no-deps\n#   remove token auth\nRUN mkdir -p ~/.jupyter \\\n && echo \"c.NotebookApp.token = u''\" > ~/.jupyter/jupyter_notebook_config.py\nRUN . /opt/conda/etc/profile.d/conda.sh \\\n && conda activate kx \\\n && jupyter kernelspec install --user --name=qpk /opt/kx/jupyterq/kernelspec \\\n && jupyter nbextension install --user --py jupyterq_licensemgr \\\n && jupyter nbextension enable --user --py jupyterq_licensemgr \\\n && jupyter serverextension enable --py jupyterq_licensemgr \\\n && jupyter trust /opt/kx/jupyterq/kdb+Notebooks.ipynb\nUSER root\nCOPY docker/init /init\nRUN chmod 0755 /init\n#  # Create new Entry folders\n#  # Notebooks, Data & Scripts can all be mounted to these folders\nARG nbroot=/jqnotebooks\nARG nbdata=/jqdata\nARG nbscripts=/jqscripts\nENV NBROOT=\"${nbroot}\"\nENV NBDATA=\"${nbdata}\"\nENV NBSCRIPTS=\"${nbscipts}\"\nVOLUME ${nbroot} ${nbdata} ${nbscripts}\nENTRYPOINT [\"/init\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  ARG usage in FROMs has to go up here in global\nARG embedpy_img=kxsys/embedpy:latest\n# ###\nFROM $embedpy_img AS embedpy\nFROM embedpy AS juypterq\nRUN apt-get update \\\n && apt-get install --no-install-recommends build-essential -yy --option=Dpkg::options::=--force-unsafe-io \\\n && apt-get clean \\\n && find /var/lib/apt/lists -type f -delete\nCOPY build/makefile requirements.txt *.q *.p *.ipynb /opt/kx/jupyterq/\nCOPY jupyterq_licensemgr/ /opt/kx/jupyterq/jupyterq_licensemgr/\nCOPY src/c/ /opt/kx/jupyterq/src/c/\nCOPY kxpy/ /opt/kx/jupyterq/kxpy/\nCOPY kernelspec/ /opt/kx/jupyterq/kernelspec/\nCOPY examples/ /opt/kx/jupyterq/examples/\n#  COPY kdb+Notebooks.ipynb /opt/kx/jupyterq/examples/kdb+Notebooks.ipynb\nRUN make -C /opt/kx/jupyterq jupyterq\n# ###\nFROM embedpy\nARG port=8888\nENV PORT=\"${port}\"\nEXPOSE ${port}/tcp\nARG VCS_REF=dev\nARG BUILD_DATE=dev\nLABEL org.label-schema.schema-version=\"1.0\" \\\n      org.label-schema.name=\"jupyterq\" \\\n      org.label-schema.description=\"Jupyter kernel for kdb+\" \\\n      org.label-schema.vendor=\"Kx\" \\\n      org.label-schema.license=\"Apache-2.0\" \\\n      org.label-schema.url=\"https://code.kx.com/q/ml/jupyterq/\" \\\n      org.label-schema.version=\"${VERSION:-dev}\" \\\n      org.label-schema.vcs-url=\"https://github.com/KxSystems/jupyterq.git\" \\\n      org.label-schema.vcs-ref=\"$VCS_REF\" \\\n      org.label-schema.build-date=\"$BUILD_DATE\" \\\n      org.label-schema.docker.cmd=\"docker run -v `pwd`/q:/tmp/q -p $PORT:$PORT kxsys/jupyterq\"\nCOPY --from=juypterq /opt/kx/jupyterq /opt/kx/jupyterq\nRUN chown kx:kx /opt/kx/jupyterq /opt/kx/jupyterq/kdb+Notebooks.ipynb\nRUN find /opt/kx/jupyterq -maxdepth 1 -type f -name 'jupyterq_*.q' | xargs ln -s -t /opt/kx/q \\\n && ln -s -t /opt/kx/q /opt/kx/jupyterq/kxpy \\\n && ln -s -t /opt/kx/q/l64 /opt/kx/jupyterq/l64/jupyterq.so\nRUN apt-get update \\\n && apt-get install --no-install-recommends xinetd libgl1-mesa-glx -yy --option=Dpkg::options::=--force-unsafe-io \\\n && apt-get clean \\\n && find /var/lib/apt/lists -type f -delete\nUSER kx\nRUN . /opt/conda/etc/profile.d/conda.sh \\\n && conda activate kx \\\n && conda install nomkl \\\n && conda install --file /opt/kx/jupyterq/requirements.txt \\\n && conda clean -y --all\nUSER root\nRUN chown -R kx:kx /opt/kx/jupyterq/jupyterq_licensemgr\nUSER kx\nRUN . /opt/conda/etc/profile.d/conda.sh \\\n && conda activate kx \\\n && cd /opt/kx/jupyterq/jupyterq_licensemgr \\\n && python setup.py build \\\n && pip install . --user --no-deps\n#  remove token auth\nRUN mkdir -p ~/.jupyter \\\n && echo \"c.NotebookApp.token = u''\" > ~/.jupyter/jupyter_notebook_config.py\nRUN . /opt/conda/etc/profile.d/conda.sh \\\n && conda activate kx \\\n && jupyter kernelspec install --user --name=qpk /opt/kx/jupyterq/kernelspec \\\n && jupyter nbextension install --user --py jupyterq_licensemgr \\\n && jupyter nbextension enable --user --py jupyterq_licensemgr \\\n && jupyter serverextension enable --py jupyterq_licensemgr \\\n && jupyter trust /opt/kx/jupyterq/kdb+Notebooks.ipynb\nUSER root\nCOPY docker/init /init\nRUN chmod 0755 /init\n# # Create new Entry folders\n# # Notebooks, Data & Scripts can all be mounted to these folders\nARG nbroot=/jqnotebooks\nARG nbdata=/jqdata\nARG nbscripts=/jqscripts\nENV NBROOT=\"${nbroot}\"\nENV NBDATA=\"${nbdata}\"\nENV NBSCRIPTS=\"${nbscipts}\"\nVOLUME ${nbroot} ${nbdata} ${nbscripts}\nENTRYPOINT [\"/init\"]\n","injectedSmells":[],"originalDockerfileHash":"dfa00eeb08713f4633d904ffdbd44500","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   ARG usage in FROMs has to go up here in global\nARG embedpy_img=kxsys/embedpy:latest\n#  ###\nFROM $embedpy_img AS embedpy\nFROM embedpy AS juypterq\nRUN apt-get update \\\n && apt-get install --no-install-recommends build-essential -yy --option=Dpkg::options::=--force-unsafe-io \\\n && apt-get clean \\\n && find /var/lib/apt/lists -type f -delete\nCOPY build/makefile requirements.txt *.q *.p *.ipynb /opt/kx/jupyterq/\nCOPY jupyterq_licensemgr/ /opt/kx/jupyterq/jupyterq_licensemgr/\nCOPY src/c/ /opt/kx/jupyterq/src/c/\nCOPY kxpy/ /opt/kx/jupyterq/kxpy/\nCOPY kernelspec/ /opt/kx/jupyterq/kernelspec/\nCOPY examples/ /opt/kx/jupyterq/examples/\n#   COPY kdb+Notebooks.ipynb /opt/kx/jupyterq/examples/kdb+Notebooks.ipynb\nRUN make -C /opt/kx/jupyterq jupyterq\n#  ###\nFROM embedpy\nARG port=8888\nENV PORT=\"${port}\"\nEXPOSE ${port}/tcp\nARG VCS_REF=dev\nARG BUILD_DATE=dev\nLABEL org.label-schema.schema-version=\"1.0\" \\\n      org.label-schema.name=\"jupyterq\" \\\n      org.label-schema.description=\"Jupyter kernel for kdb+\" \\\n      org.label-schema.vendor=\"Kx\" \\\n      org.label-schema.license=\"Apache-2.0\" \\\n      org.label-schema.url=\"https://code.kx.com/q/ml/jupyterq/\" \\\n      org.label-schema.version=\"${VERSION:-dev}\" \\\n      org.label-schema.vcs-url=\"https://github.com/KxSystems/jupyterq.git\" \\\n      org.label-schema.vcs-ref=\"$VCS_REF\" \\\n      org.label-schema.build-date=\"$BUILD_DATE\" \\\n      org.label-schema.docker.cmd=\"docker run -v `pwd`/q:/tmp/q -p $PORT:$PORT kxsys/jupyterq\"\nCOPY --from=juypterq /opt/kx/jupyterq /opt/kx/jupyterq\nRUN chown kx:kx /opt/kx/jupyterq /opt/kx/jupyterq/kdb+Notebooks.ipynb\nRUN find /opt/kx/jupyterq -maxdepth 1 -type f -name 'jupyterq_*.q' | xargs ln -s -t /opt/kx/q \\\n && ln -s -t /opt/kx/q /opt/kx/jupyterq/kxpy \\\n && ln -s -t /opt/kx/q/l64 /opt/kx/jupyterq/l64/jupyterq.so\nRUN apt-get update \\\n && apt-get install --no-install-recommends xinetd libgl1-mesa-glx -yy --option=Dpkg::options::=--force-unsafe-io \\\n && apt-get clean \\\n && find /var/lib/apt/lists -type f -delete\nUSER kx\nRUN . /opt/conda/etc/profile.d/conda.sh \\\n && conda activate kx \\\n && conda install nomkl \\\n && conda install --file /opt/kx/jupyterq/requirements.txt \\\n && conda clean -y --all\nUSER root\nRUN chown -R kx:kx /opt/kx/jupyterq/jupyterq_licensemgr\nUSER kx\nRUN . /opt/conda/etc/profile.d/conda.sh \\\n && conda activate kx \\\n && cd /opt/kx/jupyterq/jupyterq_licensemgr \\\n && python setup.py build \\\n && pip install . --user --no-deps\n#   remove token auth\nRUN mkdir -p ~/.jupyter \\\n && echo \"c.NotebookApp.token = u''\" > ~/.jupyter/jupyter_notebook_config.py\nRUN . /opt/conda/etc/profile.d/conda.sh \\\n && conda activate kx \\\n && jupyter kernelspec install --user --name=qpk /opt/kx/jupyterq/kernelspec \\\n && jupyter nbextension install --user --py jupyterq_licensemgr \\\n && jupyter nbextension enable --user --py jupyterq_licensemgr \\\n && jupyter serverextension enable --py jupyterq_licensemgr \\\n && jupyter trust /opt/kx/jupyterq/kdb+Notebooks.ipynb\nUSER root\nCOPY docker/init /init\nRUN chmod 0755 /init\n#  # Create new Entry folders\n#  # Notebooks, Data & Scripts can all be mounted to these folders\nARG nbroot=/jqnotebooks\nARG nbdata=/jqdata\nARG nbscripts=/jqscripts\nENV NBROOT=\"${nbroot}\"\nENV NBDATA=\"${nbdata}\"\nENV NBSCRIPTS=\"${nbscipts}\"\nVOLUME ${nbroot} ${nbdata} ${nbscripts}\nENTRYPOINT [\"/init\"]\n","originalDockerfileUglifiedHash":"9317d892a7fde4467615dd4af201273d","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/845f5025a07251da60960cfe23c16ff683835964.dockerfile"}