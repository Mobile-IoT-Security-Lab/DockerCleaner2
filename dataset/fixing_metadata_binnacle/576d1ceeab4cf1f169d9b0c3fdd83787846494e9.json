{"seed":1792737579,"processedDockerfileHash":"42d058b8225824732ce1ca91868bd893","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-npm","pin-package-manager-versions-apk","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM unocha/nodejs-builder:%%UPSTREAM%%\nMAINTAINER UN-OCHA Operations <ops+docker@humanitarianresponse.info>\n#   Alpine based docker image.\n#   Includes php composer, ruby bundler, less, npm, jasmine, compass and drush.\n#   Parse arguments for the build command.\nARG VERSION\nARG VCS_URL\nARG VCS_REF\nARG BUILD_DATE\n#   A little bit of metadata management.\n#   See http://label-schema.org/\nLABEL org.label-schema.schema-version=\"1.0\" \\\n      org.label-schema.build-date=\"$BUILD_DATE\" \\\n      org.label-schema.vendor=\"UN-OCHA\" \\\n      org.label-schema.version=\"$VERSION\" \\\n      org.label-schema.vcs-url=\"$VCS_URL\" \\\n      org.label-schema.vcs-ref=\"$VCS_REF\" \\\n      org.label-schema.name=\"unified-builder\" \\\n      org.label-schema.description=\"This service provides a builder container for PHP, with node and sass helpers.\" \\\n      org.label-schema.architecture=\"x86_64\" \\\n      org.label-schema.distribution=\"Alpine Linux\" \\\n      org.label-schema.distribution-version=\"3.8\" \\\n      info.humanitarianresponse.php=\"$VERSION\" \\\n      info.humanitarianresponse.php.modules=\"bcmath bz2 calendar ctype curl dom exif fileinfo fpm ftp gd gettext iconv igbinary imagick imap intl json mcrypt memcached opcache openssl pdo pdo_mysql pdo_pgsql phar posix redis shmop soap sysvmsg sysvsem sysvshm simplexml sockets wddx xml xmlreader xmlwriter xsl zip zlib\" \\\n      info.humanitarianresponse.php.sapi=\"cli\" \\\n      info.humanitarianresponse.composer=\"1.8.4\" \\\n      info.humanitarianresponse.drush=\"8.1.18-dev\" \\\n      info.humanitarianresponse.node=\"8.11.3\" \\\n      info.humanitarianresponse.npm=\"5.6.0\" \\\n      info.humanitarianresponse.yarn=\"1.7.0\" \\\n      info.humanitarianresponse.compass=\"3.2.0\" \\\n      info.humanitarianresponse.jasmine=\"2.8.0\" \\\n      info.humanitarianresponse.casperjs=\"1.1.3\" \\\n      info.humanitarianresponse.phantomjs=\"2.0.0\" \\\n      info.humanitarianresponse.ruby=\"2.3.1\"\nENV DRUSH_VERSION=\"8\" \\\n    DRUSH_RELEASE=\"8.x-dev\"\nCOPY drushrc.php /drushrc.php\nRUN npm install jasmine@4.6.0 --global \\\n && rm -rf /tmp/npm-* \\\n && apk add bash ca-certificates curl build-base git gzip openssh-client patch rsync tar wget php7-bcmath php7-bz2 php7-calendar php7-ctype php7-curl php7-dom php7-exif php7-iconv php7-fileinfo php7-ftp php7-gd php7-gettext php7-iconv php7-imagick php7-imap php7-intl php7-json php7-mbstring php7-mcrypt php7-memcached php7-mysqli php7-opcache php7-openssl php7-pdo php7-pdo_mysql php7-pdo_pgsql php7-phar php7-posix php7-redis php7-shmop php7-sysvmsg php7-sysvsem php7-sysvshm php7-simplexml php7-soap php7-sockets php7-tokenizer php7-wddx php7-xml php7-xmlreader php7-xmlwriter php7-xsl php7-zip php7-zlib --update-cache \\\n && rm -rf /var/cache/apk/* \\\n && cd /tmp \\\n && ln -sf /usr/bin/php7 /usr/bin/php \\\n && COMPOSER_HASH=$( curl -sS https://composer.github.io/installer.sig ;) \\\n && php -r \"copy('https://getcomposer.org/installer', 'composer-setup.php');\" \\\n && php -r \"if (hash_file('SHA384', 'composer-setup.php') === '$COMPOSER_HASH') { echo 'Installer verified'; } else { echo 'Installer corrupt'; unlink('composer-setup.php'); } echo PHP_EOL;\" \\\n && php composer-setup.php --install-dir=/usr/bin --filename=composer \\\n && php -r \"unlink('composer-setup.php');\" \\\n && COMPOSER_HOME=/usr/local/drush$DRUSH_VERSION composer global require drush/drush:$DRUSH_RELEASE \\\n && cd / \\\n && ln -sf /usr/local/drush$DRUSH_VERSION/vendor/bin/drush /usr/bin/drush \\\n && drush status \\\n && drush -y @none dl --destination=/home/appuser/.drush/commands registry_rebuild-7.x \\\n && chown -R appuser:appuser /home/appuser/.drush \\\n && mkdir -p /root/.drush \\\n && ln -s /home/appuser/.drush/commands /root/.drush/commands \\\n && mkdir -p /etc/drush \\\n && mv /drushrc.php /etc/drush/drushrc.php \\\n && rm -f /tmp/drush8-2282.patch /tmp/drush8-2567.patch \\\n && apk add git php7-dev autoconf g++ make --update-cache --virtual .build-dependencies \\\n && cd /tmp \\\n && git clone https://github.com/igbinary/igbinary \\\n && cd igbinary \\\n && phpize7 \\\n && ./configure CFLAGS=\"-O2 -g\" --enable-igbinary --with-php-config=/usr/bin/php-config7 \\\n && make \\\n && make install \\\n && cd .. \\\n && rm -rf igbinary \\\n && rm -rf /usr/include/php/ \\\n && apk del .build-dependencies \\\n && rm -rf /var/cache/apk/* \\\n && apk add fontconfig libc6-compat python --update-cache \\\n && rm -rf /var/cache/apk/* \\\n && curl -L -o /tmp/casperjs.zip https://github.com/n1k0/casperjs/archive/master.zip \\\n && mkdir /opt \\\n && unzip /tmp/casperjs.zip -d /opt \\\n && mv /opt/casperjs-master /opt/casperjs \\\n && ln -s /opt/casperjs/bin/casperjs /usr/local/bin/casperjs \\\n && rm -f /tmp/casperjs.zip \\\n && curl -Ls https://github.com/fgrehm/docker-phantomjs2/releases/download/v2.0.0-20150722/dockerized-phantomjs.tar.gz | tar xz -C / bin etc/fonts etc/ssl lib lib64 usr/lib usr/local usr/share\nWORKDIR /tmp\nCMD [\"bash\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM unocha/nodejs-builder:%%UPSTREAM%%\nMAINTAINER UN-OCHA Operations <ops+docker@humanitarianresponse.info>\n#  Alpine based docker image.\n#  Includes php composer, ruby bundler, less, npm, jasmine, compass and drush.\n#  Parse arguments for the build command.\nARG VERSION\nARG VCS_URL\nARG VCS_REF\nARG BUILD_DATE\n#  A little bit of metadata management.\n#  See http://label-schema.org/\nLABEL org.label-schema.schema-version=\"1.0\" \\\n      org.label-schema.build-date=\"$BUILD_DATE\" \\\n      org.label-schema.vendor=\"UN-OCHA\" \\\n      org.label-schema.version=\"$VERSION\" \\\n      org.label-schema.vcs-url=\"$VCS_URL\" \\\n      org.label-schema.vcs-ref=\"$VCS_REF\" \\\n      org.label-schema.name=\"unified-builder\" \\\n      org.label-schema.description=\"This service provides a builder container for PHP, with node and sass helpers.\" \\\n      org.label-schema.architecture=\"x86_64\" \\\n      org.label-schema.distribution=\"Alpine Linux\" \\\n      org.label-schema.distribution-version=\"3.8\" \\\n      info.humanitarianresponse.php=\"$VERSION\" \\\n      info.humanitarianresponse.php.modules=\"bcmath bz2 calendar ctype curl dom exif fileinfo fpm ftp gd gettext iconv igbinary imagick imap intl json mcrypt memcached opcache openssl pdo pdo_mysql pdo_pgsql phar posix redis shmop soap sysvmsg sysvsem sysvshm simplexml sockets wddx xml xmlreader xmlwriter xsl zip zlib\" \\\n      info.humanitarianresponse.php.sapi=\"cli\" \\\n      info.humanitarianresponse.composer=\"1.8.4\" \\\n      info.humanitarianresponse.drush=\"8.1.18-dev\" \\\n      info.humanitarianresponse.node=\"8.11.3\" \\\n      info.humanitarianresponse.npm=\"5.6.0\" \\\n      info.humanitarianresponse.yarn=\"1.7.0\" \\\n      info.humanitarianresponse.compass=\"3.2.0\" \\\n      info.humanitarianresponse.jasmine=\"2.8.0\" \\\n      info.humanitarianresponse.casperjs=\"1.1.3\" \\\n      info.humanitarianresponse.phantomjs=\"2.0.0\" \\\n      info.humanitarianresponse.ruby=\"2.3.1\"\nENV DRUSH_VERSION=\"8\" \\\n    DRUSH_RELEASE=\"8.x-dev\"\nCOPY drushrc.php /drushrc.php\nRUN npm install jasmine --global \\\n && rm -rf /tmp/npm-* \\\n && apk add --update-cache bash ca-certificates curl build-base git gzip openssh-client patch rsync tar wget php7-bcmath php7-bz2 php7-calendar php7-ctype php7-curl php7-dom php7-exif php7-iconv php7-fileinfo php7-ftp php7-gd php7-gettext php7-iconv php7-imagick php7-imap php7-intl php7-json php7-mbstring php7-mcrypt php7-memcached php7-mysqli php7-opcache php7-openssl php7-pdo php7-pdo_mysql php7-pdo_pgsql php7-phar php7-posix php7-redis php7-shmop php7-sysvmsg php7-sysvsem php7-sysvshm php7-simplexml php7-soap php7-sockets php7-tokenizer php7-wddx php7-xml php7-xmlreader php7-xmlwriter php7-xsl php7-zip php7-zlib \\\n && rm -rf /var/cache/apk/* \\\n && cd /tmp \\\n && ln -sf /usr/bin/php7 /usr/bin/php \\\n && COMPOSER_HASH=$( curl -sS https://composer.github.io/installer.sig ;) \\\n && php -r \"copy('https://getcomposer.org/installer', 'composer-setup.php');\" \\\n && php -r \"if (hash_file('SHA384', 'composer-setup.php') === '$COMPOSER_HASH') { echo 'Installer verified'; } else { echo 'Installer corrupt'; unlink('composer-setup.php'); } echo PHP_EOL;\" \\\n && php composer-setup.php --install-dir=/usr/bin --filename=composer \\\n && php -r \"unlink('composer-setup.php');\" \\\n && COMPOSER_HOME=/usr/local/drush$DRUSH_VERSION composer global require drush/drush:$DRUSH_RELEASE \\\n && cd / \\\n && ln -sf /usr/local/drush$DRUSH_VERSION/vendor/bin/drush /usr/bin/drush \\\n && drush status \\\n && drush -y @none dl --destination=/home/appuser/.drush/commands registry_rebuild-7.x \\\n && chown -R appuser:appuser /home/appuser/.drush \\\n && mkdir -p /root/.drush \\\n && ln -s /home/appuser/.drush/commands /root/.drush/commands \\\n && mkdir -p /etc/drush \\\n && mv /drushrc.php /etc/drush/drushrc.php \\\n && rm -f /tmp/drush8-2282.patch /tmp/drush8-2567.patch \\\n && apk add --update-cache --virtual .build-dependencies git php7-dev autoconf g++ make \\\n && cd /tmp \\\n && git clone https://github.com/igbinary/igbinary \\\n && cd igbinary \\\n && phpize7 \\\n && ./configure CFLAGS=\"-O2 -g\" --enable-igbinary --with-php-config=/usr/bin/php-config7 \\\n && make \\\n && make install \\\n && cd .. \\\n && rm -rf igbinary \\\n && rm -rf /usr/include/php/ \\\n && apk del .build-dependencies \\\n && rm -rf /var/cache/apk/* \\\n && apk add --update-cache fontconfig libc6-compat python \\\n && rm -rf /var/cache/apk/* \\\n && curl -L -o /tmp/casperjs.zip https://github.com/n1k0/casperjs/archive/master.zip \\\n && mkdir /opt \\\n && unzip /tmp/casperjs.zip -d /opt \\\n && mv /opt/casperjs-master /opt/casperjs \\\n && ln -s /opt/casperjs/bin/casperjs /usr/local/bin/casperjs \\\n && rm -f /tmp/casperjs.zip \\\n && curl -Ls https://github.com/fgrehm/docker-phantomjs2/releases/download/v2.0.0-20150722/dockerized-phantomjs.tar.gz | tar xz -C / bin etc/fonts etc/ssl lib lib64 usr/lib usr/local usr/share\nWORKDIR /tmp\nCMD [\"bash\"]\n","injectedSmells":[],"originalDockerfileHash":"bf202459834bb725054894316adb012b","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM unocha/nodejs-builder:%%UPSTREAM%%\nMAINTAINER UN-OCHA Operations <ops+docker@humanitarianresponse.info>\n#   Alpine based docker image.\n#   Includes php composer, ruby bundler, less, npm, jasmine, compass and drush.\n#   Parse arguments for the build command.\nARG VERSION\nARG VCS_URL\nARG VCS_REF\nARG BUILD_DATE\n#   A little bit of metadata management.\n#   See http://label-schema.org/\nLABEL org.label-schema.schema-version=\"1.0\" \\\n      org.label-schema.build-date=\"$BUILD_DATE\" \\\n      org.label-schema.vendor=\"UN-OCHA\" \\\n      org.label-schema.version=\"$VERSION\" \\\n      org.label-schema.vcs-url=\"$VCS_URL\" \\\n      org.label-schema.vcs-ref=\"$VCS_REF\" \\\n      org.label-schema.name=\"unified-builder\" \\\n      org.label-schema.description=\"This service provides a builder container for PHP, with node and sass helpers.\" \\\n      org.label-schema.architecture=\"x86_64\" \\\n      org.label-schema.distribution=\"Alpine Linux\" \\\n      org.label-schema.distribution-version=\"3.8\" \\\n      info.humanitarianresponse.php=\"$VERSION\" \\\n      info.humanitarianresponse.php.modules=\"bcmath bz2 calendar ctype curl dom exif fileinfo fpm ftp gd gettext iconv igbinary imagick imap intl json mcrypt memcached opcache openssl pdo pdo_mysql pdo_pgsql phar posix redis shmop soap sysvmsg sysvsem sysvshm simplexml sockets wddx xml xmlreader xmlwriter xsl zip zlib\" \\\n      info.humanitarianresponse.php.sapi=\"cli\" \\\n      info.humanitarianresponse.composer=\"1.8.4\" \\\n      info.humanitarianresponse.drush=\"8.1.18-dev\" \\\n      info.humanitarianresponse.node=\"8.11.3\" \\\n      info.humanitarianresponse.npm=\"5.6.0\" \\\n      info.humanitarianresponse.yarn=\"1.7.0\" \\\n      info.humanitarianresponse.compass=\"3.2.0\" \\\n      info.humanitarianresponse.jasmine=\"2.8.0\" \\\n      info.humanitarianresponse.casperjs=\"1.1.3\" \\\n      info.humanitarianresponse.phantomjs=\"2.0.0\" \\\n      info.humanitarianresponse.ruby=\"2.3.1\"\nENV DRUSH_VERSION=\"8\" \\\n    DRUSH_RELEASE=\"8.x-dev\"\nCOPY drushrc.php /drushrc.php\nRUN npm install jasmine --global \\\n && rm -rf /tmp/npm-* \\\n && apk add --update-cache bash ca-certificates curl build-base git gzip openssh-client patch rsync tar wget php7-bcmath php7-bz2 php7-calendar php7-ctype php7-curl php7-dom php7-exif php7-iconv php7-fileinfo php7-ftp php7-gd php7-gettext php7-iconv php7-imagick php7-imap php7-intl php7-json php7-mbstring php7-mcrypt php7-memcached php7-mysqli php7-opcache php7-openssl php7-pdo php7-pdo_mysql php7-pdo_pgsql php7-phar php7-posix php7-redis php7-shmop php7-sysvmsg php7-sysvsem php7-sysvshm php7-simplexml php7-soap php7-sockets php7-tokenizer php7-wddx php7-xml php7-xmlreader php7-xmlwriter php7-xsl php7-zip php7-zlib \\\n && rm -rf /var/cache/apk/* \\\n && cd /tmp \\\n && ln -sf /usr/bin/php7 /usr/bin/php \\\n && COMPOSER_HASH=$( curl -sS https://composer.github.io/installer.sig ;) \\\n && php -r \"copy('https://getcomposer.org/installer', 'composer-setup.php');\" \\\n && php -r \"if (hash_file('SHA384', 'composer-setup.php') === '$COMPOSER_HASH') { echo 'Installer verified'; } else { echo 'Installer corrupt'; unlink('composer-setup.php'); } echo PHP_EOL;\" \\\n && php composer-setup.php --install-dir=/usr/bin --filename=composer \\\n && php -r \"unlink('composer-setup.php');\" \\\n && COMPOSER_HOME=/usr/local/drush$DRUSH_VERSION composer global require drush/drush:$DRUSH_RELEASE \\\n && cd / \\\n && ln -sf /usr/local/drush$DRUSH_VERSION/vendor/bin/drush /usr/bin/drush \\\n && drush status \\\n && drush -y @none dl --destination=/home/appuser/.drush/commands registry_rebuild-7.x \\\n && chown -R appuser:appuser /home/appuser/.drush \\\n && mkdir -p /root/.drush \\\n && ln -s /home/appuser/.drush/commands /root/.drush/commands \\\n && mkdir -p /etc/drush \\\n && mv /drushrc.php /etc/drush/drushrc.php \\\n && rm -f /tmp/drush8-2282.patch /tmp/drush8-2567.patch \\\n && apk add --update-cache --virtual .build-dependencies git php7-dev autoconf g++ make \\\n && cd /tmp \\\n && git clone https://github.com/igbinary/igbinary \\\n && cd igbinary \\\n && phpize7 \\\n && ./configure CFLAGS=\"-O2 -g\" --enable-igbinary --with-php-config=/usr/bin/php-config7 \\\n && make \\\n && make install \\\n && cd .. \\\n && rm -rf igbinary \\\n && rm -rf /usr/include/php/ \\\n && apk del .build-dependencies \\\n && rm -rf /var/cache/apk/* \\\n && apk add --update-cache fontconfig libc6-compat python \\\n && rm -rf /var/cache/apk/* \\\n && curl -L -o /tmp/casperjs.zip https://github.com/n1k0/casperjs/archive/master.zip \\\n && mkdir /opt \\\n && unzip /tmp/casperjs.zip -d /opt \\\n && mv /opt/casperjs-master /opt/casperjs \\\n && ln -s /opt/casperjs/bin/casperjs /usr/local/bin/casperjs \\\n && rm -f /tmp/casperjs.zip \\\n && curl -Ls https://github.com/fgrehm/docker-phantomjs2/releases/download/v2.0.0-20150722/dockerized-phantomjs.tar.gz | tar xz -C / bin etc/fonts etc/ssl lib lib64 usr/lib usr/local usr/share\nWORKDIR /tmp\nCMD [\"bash\"]\n","originalDockerfileUglifiedHash":"f9e0a38951f4c9b52ea02ee3ddd101cb","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/576d1ceeab4cf1f169d9b0c3fdd83787846494e9.dockerfile"}