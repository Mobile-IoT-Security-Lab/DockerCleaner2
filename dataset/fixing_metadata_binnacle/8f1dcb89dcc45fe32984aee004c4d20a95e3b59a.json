{"seed":3768411104,"processedDockerfileHash":"0ebed34b8f06393a7a9d8e0d38a36e4d","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM php:7.3-fpm-alpine\nARG BUILD_DATE\nARG VCS_REF\nLABEL maintainer=\"Simon Erhardt <hello@rootlogin.ch>\" \\\n      org.label-schema.name=\"Nextcloud\" \\\n      org.label-schema.description=\"Minimal Nextcloud docker image based on Alpine Linux.\" \\\n      org.label-schema.build-date=\"$BUILD_DATE\" \\\n      org.label-schema.vcs-ref=\"$VCS_REF\" \\\n      org.label-schema.vcs-url=\"https://github.com/chrootLogin/docker-nextcloud\" \\\n      org.label-schema.schema-version=\"1.0\"\nARG NEXTCLOUD_GPG=\"2880 6A87 8AE4 23A2 8372  792E D758 99B9 A724 937A\"\nARG NEXTCLOUD_VERSION=15.0.7\nARG UID=1501\nARG GID=1501\nRUN set -ex \\\n && addgroup -g ${GID} nextcloud \\\n && adduser -u ${UID} -h /opt/nextcloud -H -G nextcloud -s /sbin/nologin -D nextcloud \\\n && apk update \\\n && apk upgrade \\\n && apk add alpine-sdk=1.0-r1 autoconf=2.71-r0 bash=5.1.16-r0 freetype=2.11.1-r2 freetype-dev=2.11.1-r2 gnupg=2.2.31-r2 icu-dev=69.1-r1 icu-libs=69.1-r1 imagemagick=7.1.0.16-r0 imagemagick-dev=7.1.0.16-r0 libjpeg-turbo=2.1.2-r0 libjpeg-turbo-dev=2.1.2-r0 libldap=2.6.2-r0 libmcrypt=2.5.8-r9 libmcrypt-dev=2.5.8-r9 libmemcached=1.0.18-r4 libmemcached-dev=1.0.18-r4 libpng=1.6.37-r1 libpng-dev=1.6.37-r1 libzip=1.8.0-r1 libzip-dev=1.8.0-r1 nginx=1.20.2-r1 openldap-dev=2.6.2-r0 openssl=1.1.1t-r3 pcre=8.45-r1 pcre-dev=8.45-r1 postgresql-dev postgresql-libs samba-client=4.15.13-r0 sudo=1.9.12_p2-r0 supervisor=4.2.2-r2 tar=1.34-r1 tini=0.19.0-r0 wget=1.21.2-r2 \\\n && docker-php-ext-configure gd --with-freetype-dir=/usr --with-png-dir=/usr --with-jpeg-dir=/usr \\\n && docker-php-ext-configure ldap \\\n && docker-php-ext-configure zip --with-libzip=/usr \\\n && docker-php-ext-install gd exif intl mbstring ldap mysqli opcache pcntl pdo_mysql pdo_pgsql pgsql zip \\\n && pecl install APCu-5.1.16 \\\n && pecl install imagick-3.4.3 \\\n && pecl install mcrypt-1.0.2 \\\n && pecl install memcached-3.1.3 \\\n && pecl install redis-4.2.0 \\\n && docker-php-ext-enable apcu imagick mcrypt memcached redis \\\n && apk del alpine-sdk autoconf freetype-dev icu-dev imagemagick-dev libmcrypt-dev libmemcached-dev libjpeg-turbo-dev libpng-dev libzip-dev openldap-dev pcre-dev postgresql-dev \\\n && rm -rf /var/cache/apk/* \\\n && mkdir -p /opt/nextcloud \\\n && cd /tmp \\\n && NEXTCLOUD_TARBALL=\"nextcloud-${NEXTCLOUD_VERSION}.tar.bz2\" \\\n && wget -q https://download.nextcloud.com/server/releases/${NEXTCLOUD_TARBALL} \\\n && wget -q https://download.nextcloud.com/server/releases/${NEXTCLOUD_TARBALL}.sha256 \\\n && wget -q https://download.nextcloud.com/server/releases/${NEXTCLOUD_TARBALL}.asc \\\n && wget -q https://nextcloud.com/nextcloud.asc \\\n && echo \"Verifying both integrity and authenticity of ${NEXTCLOUD_TARBALL}...\" \\\n && CHECKSUM_STATE=$( echo -n $( sha256sum -c ${NEXTCLOUD_TARBALL}.sha256 ;) | tail -c 2 ;) \\\n && if [ \"${CHECKSUM_STATE}\" != \"OK\" ] ; then echo \"Warning! Checksum does not match!\" \\\n && exit 1 ; fi \\\n && gpg --import nextcloud.asc \\\n && FINGERPRINT=\"$( LANG=C gpg --verify ${NEXTCLOUD_TARBALL}.asc ${NEXTCLOUD_TARBALL} 2>&1 | sed -n \"s#Primary key fingerprint: \\(.*\\)#\\1#p\" ;)\" \\\n && if [ -z \"${FINGERPRINT}\" ] ; then echo \"Warning! Invalid GPG signature!\" \\\n && exit 1 ; fi \\\n && if [ \"${FINGERPRINT}\" != \"${NEXTCLOUD_GPG}\" ] ; then echo \"Warning! Wrong GPG fingerprint!\" \\\n && exit 1 ; fi \\\n && echo \"All seems good, now unpacking ${NEXTCLOUD_TARBALL}...\" \\\n && tar xjf ${NEXTCLOUD_TARBALL} --strip-components=1 -C /opt/nextcloud \\\n && rm -rf /opt/nextcloud/updater \\\n && rm -rf /tmp/* /root/.gnupg \\\n && rm -rf /var/www/*\nCOPY root /\nRUN chmod +x /usr/local/bin/run.sh /usr/local/bin/occ /etc/periodic/15min/nextcloud\nVOLUME [\"/data\"]\nEXPOSE 80/tcp\nENTRYPOINT [\"/sbin/tini\", \"--\"]\nCMD [\"/usr/local/bin/run.sh\"]\nRUN addgroup -S docker-user ; adduser -S -G docker-user docker-user\nUSER docker-user\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\n","originalDockerfile":"FROM php:7.3-fpm-alpine\nARG BUILD_DATE\nARG VCS_REF\nLABEL maintainer=\"Simon Erhardt <hello@rootlogin.ch>\" \\\n      org.label-schema.name=\"Nextcloud\" \\\n      org.label-schema.description=\"Minimal Nextcloud docker image based on Alpine Linux.\" \\\n      org.label-schema.build-date=\"$BUILD_DATE\" \\\n      org.label-schema.vcs-ref=\"$VCS_REF\" \\\n      org.label-schema.vcs-url=\"https://github.com/chrootLogin/docker-nextcloud\" \\\n      org.label-schema.schema-version=\"1.0\"\nARG NEXTCLOUD_GPG=\"2880 6A87 8AE4 23A2 8372  792E D758 99B9 A724 937A\"\nARG NEXTCLOUD_VERSION=15.0.7\nARG UID=1501\nARG GID=1501\nRUN set -ex \\\n && addgroup -g ${GID} nextcloud \\\n && adduser -u ${UID} -h /opt/nextcloud -H -G nextcloud -s /sbin/nologin -D nextcloud \\\n && apk update \\\n && apk upgrade \\\n && apk add alpine-sdk autoconf bash freetype freetype-dev gnupg icu-dev icu-libs imagemagick imagemagick-dev libjpeg-turbo libjpeg-turbo-dev libldap libmcrypt libmcrypt-dev libmemcached libmemcached-dev libpng libpng-dev libzip libzip-dev nginx openldap-dev openssl pcre pcre-dev postgresql-dev postgresql-libs samba-client sudo supervisor tar tini wget \\\n && docker-php-ext-configure gd --with-freetype-dir=/usr --with-png-dir=/usr --with-jpeg-dir=/usr \\\n && docker-php-ext-configure ldap \\\n && docker-php-ext-configure zip --with-libzip=/usr \\\n && docker-php-ext-install gd exif intl mbstring ldap mysqli opcache pcntl pdo_mysql pdo_pgsql pgsql zip \\\n && pecl install APCu-5.1.16 \\\n && pecl install imagick-3.4.3 \\\n && pecl install mcrypt-1.0.2 \\\n && pecl install memcached-3.1.3 \\\n && pecl install redis-4.2.0 \\\n && docker-php-ext-enable apcu imagick mcrypt memcached redis \\\n && apk del alpine-sdk autoconf freetype-dev icu-dev imagemagick-dev libmcrypt-dev libmemcached-dev libjpeg-turbo-dev libpng-dev libzip-dev openldap-dev pcre-dev postgresql-dev \\\n && rm -rf /var/cache/apk/* \\\n && mkdir -p /opt/nextcloud \\\n && cd /tmp \\\n && NEXTCLOUD_TARBALL=\"nextcloud-${NEXTCLOUD_VERSION}.tar.bz2\" \\\n && wget -q https://download.nextcloud.com/server/releases/${NEXTCLOUD_TARBALL} \\\n && wget -q https://download.nextcloud.com/server/releases/${NEXTCLOUD_TARBALL}.sha256 \\\n && wget -q https://download.nextcloud.com/server/releases/${NEXTCLOUD_TARBALL}.asc \\\n && wget -q https://nextcloud.com/nextcloud.asc \\\n && echo \"Verifying both integrity and authenticity of ${NEXTCLOUD_TARBALL}...\" \\\n && CHECKSUM_STATE=$( echo -n $( sha256sum -c ${NEXTCLOUD_TARBALL}.sha256 ;) | tail -c 2 ;) \\\n && if [ \"${CHECKSUM_STATE}\" != \"OK\" ] ; then echo \"Warning! Checksum does not match!\" \\\n && exit 1 ; fi \\\n && gpg --import nextcloud.asc \\\n && FINGERPRINT=\"$( LANG=C gpg --verify ${NEXTCLOUD_TARBALL}.asc ${NEXTCLOUD_TARBALL} 2>&1 | sed -n \"s#Primary key fingerprint: \\(.*\\)#\\1#p\" ;)\" \\\n && if [ -z \"${FINGERPRINT}\" ] ; then echo \"Warning! Invalid GPG signature!\" \\\n && exit 1 ; fi \\\n && if [ \"${FINGERPRINT}\" != \"${NEXTCLOUD_GPG}\" ] ; then echo \"Warning! Wrong GPG fingerprint!\" \\\n && exit 1 ; fi \\\n && echo \"All seems good, now unpacking ${NEXTCLOUD_TARBALL}...\" \\\n && tar xjf ${NEXTCLOUD_TARBALL} --strip-components=1 -C /opt/nextcloud \\\n && rm -rf /opt/nextcloud/updater \\\n && rm -rf /tmp/* /root/.gnupg \\\n && rm -rf /var/www/*\nCOPY root /\nRUN chmod +x /usr/local/bin/run.sh /usr/local/bin/occ /etc/periodic/15min/nextcloud\nVOLUME [\"/data\"]\nEXPOSE 80/tcp\nENTRYPOINT [\"/sbin/tini\", \"--\"]\nCMD [\"/usr/local/bin/run.sh\"]\n","injectedSmells":[],"originalDockerfileHash":"1a4add40f65be7809b6223fee09d63e0","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM php:7.3-fpm-alpine\nARG BUILD_DATE\nARG VCS_REF\nLABEL maintainer=\"Simon Erhardt <hello@rootlogin.ch>\" \\\n      org.label-schema.name=\"Nextcloud\" \\\n      org.label-schema.description=\"Minimal Nextcloud docker image based on Alpine Linux.\" \\\n      org.label-schema.build-date=\"$BUILD_DATE\" \\\n      org.label-schema.vcs-ref=\"$VCS_REF\" \\\n      org.label-schema.vcs-url=\"https://github.com/chrootLogin/docker-nextcloud\" \\\n      org.label-schema.schema-version=\"1.0\"\nARG NEXTCLOUD_GPG=\"2880 6A87 8AE4 23A2 8372  792E D758 99B9 A724 937A\"\nARG NEXTCLOUD_VERSION=15.0.7\nARG UID=1501\nARG GID=1501\nRUN set -ex \\\n && addgroup -g ${GID} nextcloud \\\n && adduser -u ${UID} -h /opt/nextcloud -H -G nextcloud -s /sbin/nologin -D nextcloud \\\n && apk update \\\n && apk upgrade \\\n && apk add alpine-sdk autoconf bash freetype freetype-dev gnupg icu-dev icu-libs imagemagick imagemagick-dev libjpeg-turbo libjpeg-turbo-dev libldap libmcrypt libmcrypt-dev libmemcached libmemcached-dev libpng libpng-dev libzip libzip-dev nginx openldap-dev openssl pcre pcre-dev postgresql-dev postgresql-libs samba-client sudo supervisor tar tini wget \\\n && docker-php-ext-configure gd --with-freetype-dir=/usr --with-png-dir=/usr --with-jpeg-dir=/usr \\\n && docker-php-ext-configure ldap \\\n && docker-php-ext-configure zip --with-libzip=/usr \\\n && docker-php-ext-install gd exif intl mbstring ldap mysqli opcache pcntl pdo_mysql pdo_pgsql pgsql zip \\\n && pecl install APCu-5.1.16 \\\n && pecl install imagick-3.4.3 \\\n && pecl install mcrypt-1.0.2 \\\n && pecl install memcached-3.1.3 \\\n && pecl install redis-4.2.0 \\\n && docker-php-ext-enable apcu imagick mcrypt memcached redis \\\n && apk del alpine-sdk autoconf freetype-dev icu-dev imagemagick-dev libmcrypt-dev libmemcached-dev libjpeg-turbo-dev libpng-dev libzip-dev openldap-dev pcre-dev postgresql-dev \\\n && rm -rf /var/cache/apk/* \\\n && mkdir -p /opt/nextcloud \\\n && cd /tmp \\\n && NEXTCLOUD_TARBALL=\"nextcloud-${NEXTCLOUD_VERSION}.tar.bz2\" \\\n && wget -q https://download.nextcloud.com/server/releases/${NEXTCLOUD_TARBALL} \\\n && wget -q https://download.nextcloud.com/server/releases/${NEXTCLOUD_TARBALL}.sha256 \\\n && wget -q https://download.nextcloud.com/server/releases/${NEXTCLOUD_TARBALL}.asc \\\n && wget -q https://nextcloud.com/nextcloud.asc \\\n && echo \"Verifying both integrity and authenticity of ${NEXTCLOUD_TARBALL}...\" \\\n && CHECKSUM_STATE=$( echo -n $( sha256sum -c ${NEXTCLOUD_TARBALL}.sha256 ;) | tail -c 2 ;) \\\n && if [ \"${CHECKSUM_STATE}\" != \"OK\" ] ; then echo \"Warning! Checksum does not match!\" \\\n && exit 1 ; fi \\\n && gpg --import nextcloud.asc \\\n && FINGERPRINT=\"$( LANG=C gpg --verify ${NEXTCLOUD_TARBALL}.asc ${NEXTCLOUD_TARBALL} 2>&1 | sed -n \"s#Primary key fingerprint: \\(.*\\)#\\1#p\" ;)\" \\\n && if [ -z \"${FINGERPRINT}\" ] ; then echo \"Warning! Invalid GPG signature!\" \\\n && exit 1 ; fi \\\n && if [ \"${FINGERPRINT}\" != \"${NEXTCLOUD_GPG}\" ] ; then echo \"Warning! Wrong GPG fingerprint!\" \\\n && exit 1 ; fi \\\n && echo \"All seems good, now unpacking ${NEXTCLOUD_TARBALL}...\" \\\n && tar xjf ${NEXTCLOUD_TARBALL} --strip-components=1 -C /opt/nextcloud \\\n && rm -rf /opt/nextcloud/updater \\\n && rm -rf /tmp/* /root/.gnupg \\\n && rm -rf /var/www/*\nCOPY root /\nRUN chmod +x /usr/local/bin/run.sh /usr/local/bin/occ /etc/periodic/15min/nextcloud\nVOLUME [\"/data\"]\nEXPOSE 80/tcp\nENTRYPOINT [\"/sbin/tini\", \"--\"]\nCMD [\"/usr/local/bin/run.sh\"]\n","originalDockerfileUglifiedHash":"1a4add40f65be7809b6223fee09d63e0","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/8f1dcb89dcc45fe32984aee004c4d20a95e3b59a.dockerfile"}