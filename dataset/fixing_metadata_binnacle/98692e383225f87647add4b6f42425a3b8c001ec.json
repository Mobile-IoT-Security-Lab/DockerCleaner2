{"seed":1628734617,"processedDockerfileHash":"041ffc777ba85320da1927677245b820","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","pin-package-manager-versions-npm","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM node:11-stretch\nLABEL org.label-schema.schema-version=\"= 1.0.0  org.label-schema.vendor = mkenney@webbedlam.com  org.label-schema.vcs-url = https://github.com/mkenney/docker-npm  org.label-schema.description = \\\"This image provides node based build tools.\\\"  org.label-schema.name = \\\"NPM\\\"  org.label-schema.url = http://mkenney.github.io/docker-npm/\"\nENV TERM=\"xterm\" \\\n    NLS_LANG=\"American_America.AL32UTF8\" \\\n    LANG=\"C.UTF-8\" \\\n    LANGUAGE=\"C.UTF-8\" \\\n    LC_ALL=\"C.UTF-8\" \\\n    TIMEZONE=\"America/Denver\"\nRUN set -x \\\n && apt-get update -qq \\\n && apt-get install --no-install-recommends apt-transport-https apt-utils -qqy \\\n && apt-get -qq upgrade \\\n && apt-get -qq dist-upgrade \\\n && curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | apt-key add - \\\n && echo \"deb https://dl.yarnpkg.com/debian/ stable main\" | tee /etc/apt/sources.list.d/yarn.list \\\n && apt-get update -qq \\\n && apt-get install --no-install-recommends acl git mercurial rsync subversion sudo wget -qqy \\\n && rm /bin/sh \\\n && ln -s /bin/bash /bin/sh\n#   install npm packages\nRUN set -x \\\n && npm install gulp-cli@2.3.0 grunt-cli@1.4.3 bower@1.8.14 markdown-styles@3.2.0 npx@10.2.2 --silent --global \\\n && curl --compressed -o- -L https://yarnpkg.com/install.sh | sh\n#  #############################################################################\n#   UTF-8 Locale, timezone\n#  #############################################################################\nRUN set -x \\\n && apt-get install --no-install-recommends locales -qqy \\\n && locale-gen C.UTF-8 ${UTF8_LOCALE} \\\n && dpkg-reconfigure locales \\\n && /usr/sbin/update-locale LANG=C.UTF-8 LANGUAGE=C.UTF-8 LC_ALL=C.UTF-8 \\\n && export LANG=C.UTF-8 \\\n && export LANGUAGE=C.UTF-8 \\\n && export LC_ALL=C.UTF-8 \\\n && echo $TIMEZONE > /etc/timezone \\\n && dpkg-reconfigure -f noninteractive tzdata\n#  #############################################################################\n#   users\n#  #############################################################################\nRUN set -x \\\n && echo \"export NLS_LANG=$( echo $NLS_LANG ;)\" >> /root/.bash_profile \\\n && echo \"export LANG=$( echo $LANG ;)\" >> /root/.bash_profile \\\n && echo \"export LANGUAGE=$( echo $LANGUAGE ;)\" >> /root/.bash_profile \\\n && echo \"export LC_ALL=$( echo $LC_ALL ;)\" >> /root/.bash_profile \\\n && echo \"export TERM=xterm\" >> /root/.bash_profile \\\n && echo \"export PATH=$( echo $PATH ;)\" >> /root/.bash_profile \\\n && echo \"cd /src\" >> /root/.bash_profile \\\n && echo \"source $HOME/.bashrc\" >> /root/.bash_profile \\\n && groupadd dev \\\n && useradd dev -s /bin/bash -m -g dev \\\n && echo \"dev:password\" | chpasswd \\\n && echo \"dev ALL=(ALL:ALL) NOPASSWD: ALL\" >> /etc/sudoers \\\n && rsync -a /root/ /home/dev/ \\\n && chown -R dev:dev /home/dev/ \\\n && chmod 0777 /home/dev \\\n && chmod -R u+rwX,g+rwX,o+rwX /home/dev \\\n && setfacl -R -d -m user::rwx,group::rwx,other::rwx /home/dev\n#  #############################################################################\n#   ~ fin ~\n#  #############################################################################\nRUN set -x \\\n && wget -O /run-as-user https://raw.githubusercontent.com/mkenney/docker-scripts/master/container/run-as-user \\\n && chmod 0755 /run-as-user \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/*\nVOLUME /src\nWORKDIR /src\nENTRYPOINT [\"/run-as-user\"]\nCMD [\"/usr/local/bin/npm\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\nHEALTHCHECK CMD curl --fail http://127.0.0.1:3000 || exit 1\n","originalDockerfile":"FROM node:11-stretch\nLABEL org.label-schema.schema-version=\"= 1.0.0  org.label-schema.vendor = mkenney@webbedlam.com  org.label-schema.vcs-url = https://github.com/mkenney/docker-npm  org.label-schema.description = \\\"This image provides node based build tools.\\\"  org.label-schema.name = \\\"NPM\\\"  org.label-schema.url = http://mkenney.github.io/docker-npm/\"\nENV TERM=\"xterm\" \\\n    NLS_LANG=\"American_America.AL32UTF8\" \\\n    LANG=\"C.UTF-8\" \\\n    LANGUAGE=\"C.UTF-8\" \\\n    LC_ALL=\"C.UTF-8\" \\\n    TIMEZONE=\"America/Denver\"\nRUN set -x \\\n && apt-get update -qq \\\n && apt-get install apt-transport-https apt-utils -qqy \\\n && apt-get -qq upgrade \\\n && apt-get -qq dist-upgrade \\\n && curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | apt-key add - \\\n && echo \"deb https://dl.yarnpkg.com/debian/ stable main\" | tee /etc/apt/sources.list.d/yarn.list \\\n && apt-get update -qq \\\n && apt-get install acl git mercurial rsync subversion sudo wget -qqy \\\n && rm /bin/sh \\\n && ln -s /bin/bash /bin/sh\n#  install npm packages\nRUN set -x \\\n && npm install gulp-cli grunt-cli bower markdown-styles npx --silent --global \\\n && curl --compressed -o- -L https://yarnpkg.com/install.sh | sh\n# #############################################################################\n#  UTF-8 Locale, timezone\n# #############################################################################\nRUN set -x \\\n && apt-get install locales -qqy \\\n && locale-gen C.UTF-8 ${UTF8_LOCALE} \\\n && dpkg-reconfigure locales \\\n && /usr/sbin/update-locale LANG=C.UTF-8 LANGUAGE=C.UTF-8 LC_ALL=C.UTF-8 \\\n && export LANG=C.UTF-8 \\\n && export LANGUAGE=C.UTF-8 \\\n && export LC_ALL=C.UTF-8 \\\n && echo $TIMEZONE > /etc/timezone \\\n && dpkg-reconfigure -f noninteractive tzdata\n# #############################################################################\n#  users\n# #############################################################################\nRUN set -x \\\n && echo \"export NLS_LANG=$( echo $NLS_LANG ;)\" >> /root/.bash_profile \\\n && echo \"export LANG=$( echo $LANG ;)\" >> /root/.bash_profile \\\n && echo \"export LANGUAGE=$( echo $LANGUAGE ;)\" >> /root/.bash_profile \\\n && echo \"export LC_ALL=$( echo $LC_ALL ;)\" >> /root/.bash_profile \\\n && echo \"export TERM=xterm\" >> /root/.bash_profile \\\n && echo \"export PATH=$( echo $PATH ;)\" >> /root/.bash_profile \\\n && echo \"cd /src\" >> /root/.bash_profile \\\n && echo \"source $HOME/.bashrc\" >> /root/.bash_profile \\\n && groupadd dev \\\n && useradd dev -s /bin/bash -m -g dev \\\n && echo \"dev:password\" | chpasswd \\\n && echo \"dev ALL=(ALL:ALL) NOPASSWD: ALL\" >> /etc/sudoers \\\n && rsync -a /root/ /home/dev/ \\\n && chown -R dev:dev /home/dev/ \\\n && chmod 0777 /home/dev \\\n && chmod -R u+rwX,g+rwX,o+rwX /home/dev \\\n && setfacl -R -d -m user::rwx,group::rwx,other::rwx /home/dev\n# #############################################################################\n#  ~ fin ~\n# #############################################################################\nRUN set -x \\\n && wget -O /run-as-user https://raw.githubusercontent.com/mkenney/docker-scripts/master/container/run-as-user \\\n && chmod 0755 /run-as-user \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/*\nVOLUME /src\nWORKDIR /src\nENTRYPOINT [\"/run-as-user\"]\nCMD [\"/usr/local/bin/npm\"]\n","injectedSmells":[],"originalDockerfileHash":"cb533f31af05c8fe6aca959361148499","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM node:11-stretch\nLABEL org.label-schema.schema-version=\"= 1.0.0  org.label-schema.vendor = mkenney@webbedlam.com  org.label-schema.vcs-url = https://github.com/mkenney/docker-npm  org.label-schema.description = \\\"This image provides node based build tools.\\\"  org.label-schema.name = \\\"NPM\\\"  org.label-schema.url = http://mkenney.github.io/docker-npm/\"\nENV TERM=\"xterm\" \\\n    NLS_LANG=\"American_America.AL32UTF8\" \\\n    LANG=\"C.UTF-8\" \\\n    LANGUAGE=\"C.UTF-8\" \\\n    LC_ALL=\"C.UTF-8\" \\\n    TIMEZONE=\"America/Denver\"\nRUN set -x \\\n && apt-get update -qq \\\n && apt-get install apt-transport-https apt-utils -qqy \\\n && apt-get -qq upgrade \\\n && apt-get -qq dist-upgrade \\\n && curl -sS https://dl.yarnpkg.com/debian/pubkey.gpg | apt-key add - \\\n && echo \"deb https://dl.yarnpkg.com/debian/ stable main\" | tee /etc/apt/sources.list.d/yarn.list \\\n && apt-get update -qq \\\n && apt-get install acl git mercurial rsync subversion sudo wget -qqy \\\n && rm /bin/sh \\\n && ln -s /bin/bash /bin/sh\n#   install npm packages\nRUN set -x \\\n && npm install gulp-cli grunt-cli bower markdown-styles npx --silent --global \\\n && curl --compressed -o- -L https://yarnpkg.com/install.sh | sh\n#  #############################################################################\n#   UTF-8 Locale, timezone\n#  #############################################################################\nRUN set -x \\\n && apt-get install locales -qqy \\\n && locale-gen C.UTF-8 ${UTF8_LOCALE} \\\n && dpkg-reconfigure locales \\\n && /usr/sbin/update-locale LANG=C.UTF-8 LANGUAGE=C.UTF-8 LC_ALL=C.UTF-8 \\\n && export LANG=C.UTF-8 \\\n && export LANGUAGE=C.UTF-8 \\\n && export LC_ALL=C.UTF-8 \\\n && echo $TIMEZONE > /etc/timezone \\\n && dpkg-reconfigure -f noninteractive tzdata\n#  #############################################################################\n#   users\n#  #############################################################################\nRUN set -x \\\n && echo \"export NLS_LANG=$( echo $NLS_LANG ;)\" >> /root/.bash_profile \\\n && echo \"export LANG=$( echo $LANG ;)\" >> /root/.bash_profile \\\n && echo \"export LANGUAGE=$( echo $LANGUAGE ;)\" >> /root/.bash_profile \\\n && echo \"export LC_ALL=$( echo $LC_ALL ;)\" >> /root/.bash_profile \\\n && echo \"export TERM=xterm\" >> /root/.bash_profile \\\n && echo \"export PATH=$( echo $PATH ;)\" >> /root/.bash_profile \\\n && echo \"cd /src\" >> /root/.bash_profile \\\n && echo \"source $HOME/.bashrc\" >> /root/.bash_profile \\\n && groupadd dev \\\n && useradd dev -s /bin/bash -m -g dev \\\n && echo \"dev:password\" | chpasswd \\\n && echo \"dev ALL=(ALL:ALL) NOPASSWD: ALL\" >> /etc/sudoers \\\n && rsync -a /root/ /home/dev/ \\\n && chown -R dev:dev /home/dev/ \\\n && chmod 0777 /home/dev \\\n && chmod -R u+rwX,g+rwX,o+rwX /home/dev \\\n && setfacl -R -d -m user::rwx,group::rwx,other::rwx /home/dev\n#  #############################################################################\n#   ~ fin ~\n#  #############################################################################\nRUN set -x \\\n && wget -O /run-as-user https://raw.githubusercontent.com/mkenney/docker-scripts/master/container/run-as-user \\\n && chmod 0755 /run-as-user \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/*\nVOLUME /src\nWORKDIR /src\nENTRYPOINT [\"/run-as-user\"]\nCMD [\"/usr/local/bin/npm\"]\n","originalDockerfileUglifiedHash":"eb84db54658a4f243aa82d50dc5b04c1","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/98692e383225f87647add4b6f42425a3b8c001ec.dockerfile"}