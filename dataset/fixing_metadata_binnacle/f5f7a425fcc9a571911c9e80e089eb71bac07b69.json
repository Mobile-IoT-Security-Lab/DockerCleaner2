{"seed":4120462007,"processedDockerfileHash":"2c64ed06d85d1e43b0489775c4adcbd0","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","have-a-healthcheck","have-a-user"],"processedDockerfile":"#\n#   Licensed to the Apache Software Foundation (ASF) under one\n#   or more contributor license agreements.  See the NOTICE file\n#   distributed with this work for additional information\n#   regarding copyright ownership.  The ASF licenses this file\n#   to you under the Apache License, Version 2.0 (the\n#   \"License\"); you may not use this file except in compliance\n#   with the License.  You may obtain a copy of the License at\n#\n#     http://www.apache.org/licenses/LICENSE-2.0\n#\n#   Unless required by applicable law or agreed to in writing,\n#   software distributed under the License is distributed on an\n#   \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n#   KIND, either express or implied.  See the License for the\n#   specific language governing permissions and limitations\n#   under the License.\n#\n#\n#   Dockerfile for guacamole-server\n#\n#   Use Debian as base for the build\nARG DEBIAN_VERSION=stable\nFROM debian:${DEBIAN_VERSION} AS builder\n#   Base directory for installed build artifacts.\n#   Due to limitations of the Docker image build process, this value is\n#   duplicated in an ARG in the second stage of the build.\n#\nARG PREFIX_DIR=/usr/local/guacamole\n#   Build arguments\nARG BUILD_DIR=/tmp/guacd-docker-BUILD\nARG BUILD_DEPENDENCIES=\"               autoconf                       automake                       gcc                            libcairo2-dev                  libfreerdp-dev                 libjpeg62-turbo-dev            libossp-uuid-dev               libpango1.0-dev                libpulse-dev                   libssh2-1-dev                  libssl-dev                     libtelnet-dev                  libtool                        libvncserver-dev               libwebsockets-dev              libwebp-dev                    make\"\n#   Bring build environment up to date and install build dependencies\nRUN apt-get update \\\n && apt-get install --no-install-recommends $BUILD_DEPENDENCIES -y \\\n && rm -rf /var/lib/apt/lists/*\n#   Add configuration scripts\nCOPY src/guacd-docker/bin \"${PREFIX_DIR}/bin/\"\n#   Copy source to container for sake of build\nCOPY . \"$BUILD_DIR\"\n#   Build guacamole-server from local source\nRUN ${PREFIX_DIR}/bin/build-guacd.sh \"$BUILD_DIR\" \"$PREFIX_DIR\"\n#   Record the packages of all runtime library dependencies\nRUN ${PREFIX_DIR}/bin/list-dependencies.sh ${PREFIX_DIR}/sbin/guacd ${PREFIX_DIR}/lib/libguac-client-*.so ${PREFIX_DIR}/lib/freerdp/guac*.so > ${PREFIX_DIR}/DEPENDENCIES\n#   Use same Debian as the base for the runtime image\nFROM debian:${DEBIAN_VERSION}\n#   Base directory for installed build artifacts.\n#   Due to limitations of the Docker image build process, this value is\n#   duplicated in an ARG in the first stage of the build. See also the\n#   CMD directive at the end of this build stage.\n#\nARG PREFIX_DIR=/usr/local/guacamole\n#   Runtime environment\nENV LC_ALL=\"C.UTF-8\"\nENV LD_LIBRARY_PATH=\"${PREFIX_DIR}/lib\"\nENV GUACD_LOG_LEVEL=\"info\"\nARG RUNTIME_DEPENDENCIES=\"             ca-certificates                ghostscript                    libfreerdp-plugins-standard    fonts-liberation               fonts-dejavu                   xfonts-terminus\"\n#   Copy build artifacts into this stage\nCOPY --from=builder ${PREFIX_DIR} ${PREFIX_DIR}\n#   Bring runtime environment up to date and install runtime dependencies\nRUN apt-get update \\\n && apt-get install --no-install-recommends $RUNTIME_DEPENDENCIES -y \\\n && apt-get install --no-install-recommends $( cat \"${PREFIX_DIR}\"/DEPENDENCIES ;) -y \\\n && rm -rf /var/lib/apt/lists/*\n#   Link FreeRDP plugins into proper path\nRUN ${PREFIX_DIR}/bin/link-freerdp-plugins.sh ${PREFIX_DIR}/lib/freerdp/guac*.so\n#   Expose the default listener port\nEXPOSE 4822/tcp\n#   Start guacd, listening on port 0.0.0.0:4822\n#\n#   Note the path here MUST correspond to the value specified in the \n#   PREFIX_DIR build argument.\n#\nCMD /usr/local/guacamole/sbin/guacd -b 0.0.0.0 -L $GUACD_LOG_LEVEL -f\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#\n#  Licensed to the Apache Software Foundation (ASF) under one\n#  or more contributor license agreements.  See the NOTICE file\n#  distributed with this work for additional information\n#  regarding copyright ownership.  The ASF licenses this file\n#  to you under the Apache License, Version 2.0 (the\n#  \"License\"); you may not use this file except in compliance\n#  with the License.  You may obtain a copy of the License at\n#\n#    http://www.apache.org/licenses/LICENSE-2.0\n#\n#  Unless required by applicable law or agreed to in writing,\n#  software distributed under the License is distributed on an\n#  \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n#  KIND, either express or implied.  See the License for the\n#  specific language governing permissions and limitations\n#  under the License.\n#\n#\n#  Dockerfile for guacamole-server\n#\n#  Use Debian as base for the build\nARG DEBIAN_VERSION=stable\nFROM debian:${DEBIAN_VERSION} AS builder\n#  Base directory for installed build artifacts.\n#  Due to limitations of the Docker image build process, this value is\n#  duplicated in an ARG in the second stage of the build.\n#\nARG PREFIX_DIR=/usr/local/guacamole\n#  Build arguments\nARG BUILD_DIR=/tmp/guacd-docker-BUILD\nARG BUILD_DEPENDENCIES=\"               autoconf                       automake                       gcc                            libcairo2-dev                  libfreerdp-dev                 libjpeg62-turbo-dev            libossp-uuid-dev               libpango1.0-dev                libpulse-dev                   libssh2-1-dev                  libssl-dev                     libtelnet-dev                  libtool                        libvncserver-dev               libwebsockets-dev              libwebp-dev                    make\"\n#  Bring build environment up to date and install build dependencies\nRUN apt-get update \\\n && apt-get install $BUILD_DEPENDENCIES -y \\\n && rm -rf /var/lib/apt/lists/*\n#  Add configuration scripts\nCOPY src/guacd-docker/bin \"${PREFIX_DIR}/bin/\"\n#  Copy source to container for sake of build\nCOPY . \"$BUILD_DIR\"\n#  Build guacamole-server from local source\nRUN ${PREFIX_DIR}/bin/build-guacd.sh \"$BUILD_DIR\" \"$PREFIX_DIR\"\n#  Record the packages of all runtime library dependencies\nRUN ${PREFIX_DIR}/bin/list-dependencies.sh ${PREFIX_DIR}/sbin/guacd ${PREFIX_DIR}/lib/libguac-client-*.so ${PREFIX_DIR}/lib/freerdp/guac*.so > ${PREFIX_DIR}/DEPENDENCIES\n#  Use same Debian as the base for the runtime image\nFROM debian:${DEBIAN_VERSION}\n#  Base directory for installed build artifacts.\n#  Due to limitations of the Docker image build process, this value is\n#  duplicated in an ARG in the first stage of the build. See also the\n#  CMD directive at the end of this build stage.\n#\nARG PREFIX_DIR=/usr/local/guacamole\n#  Runtime environment\nENV LC_ALL=\"C.UTF-8\"\nENV LD_LIBRARY_PATH=\"${PREFIX_DIR}/lib\"\nENV GUACD_LOG_LEVEL=\"info\"\nARG RUNTIME_DEPENDENCIES=\"             ca-certificates                ghostscript                    libfreerdp-plugins-standard    fonts-liberation               fonts-dejavu                   xfonts-terminus\"\n#  Copy build artifacts into this stage\nCOPY --from=builder ${PREFIX_DIR} ${PREFIX_DIR}\n#  Bring runtime environment up to date and install runtime dependencies\nRUN apt-get update \\\n && apt-get install $RUNTIME_DEPENDENCIES -y \\\n && apt-get install $( cat \"${PREFIX_DIR}\"/DEPENDENCIES ;) -y \\\n && rm -rf /var/lib/apt/lists/*\n#  Link FreeRDP plugins into proper path\nRUN ${PREFIX_DIR}/bin/link-freerdp-plugins.sh ${PREFIX_DIR}/lib/freerdp/guac*.so\n#  Expose the default listener port\nEXPOSE 4822/tcp\n#  Start guacd, listening on port 0.0.0.0:4822\n#\n#  Note the path here MUST correspond to the value specified in the \n#  PREFIX_DIR build argument.\n#\nCMD /usr/local/guacamole/sbin/guacd -b 0.0.0.0 -L $GUACD_LOG_LEVEL -f\n","injectedSmells":[],"originalDockerfileHash":"e2c83ee8d33a411fe424989cf59942b7","successfullyInjectedSmells":[],"originalDockerfileUglified":"#\n#   Licensed to the Apache Software Foundation (ASF) under one\n#   or more contributor license agreements.  See the NOTICE file\n#   distributed with this work for additional information\n#   regarding copyright ownership.  The ASF licenses this file\n#   to you under the Apache License, Version 2.0 (the\n#   \"License\"); you may not use this file except in compliance\n#   with the License.  You may obtain a copy of the License at\n#\n#     http://www.apache.org/licenses/LICENSE-2.0\n#\n#   Unless required by applicable law or agreed to in writing,\n#   software distributed under the License is distributed on an\n#   \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n#   KIND, either express or implied.  See the License for the\n#   specific language governing permissions and limitations\n#   under the License.\n#\n#\n#   Dockerfile for guacamole-server\n#\n#   Use Debian as base for the build\nARG DEBIAN_VERSION=stable\nFROM debian:${DEBIAN_VERSION} AS builder\n#   Base directory for installed build artifacts.\n#   Due to limitations of the Docker image build process, this value is\n#   duplicated in an ARG in the second stage of the build.\n#\nARG PREFIX_DIR=/usr/local/guacamole\n#   Build arguments\nARG BUILD_DIR=/tmp/guacd-docker-BUILD\nARG BUILD_DEPENDENCIES=\"               autoconf                       automake                       gcc                            libcairo2-dev                  libfreerdp-dev                 libjpeg62-turbo-dev            libossp-uuid-dev               libpango1.0-dev                libpulse-dev                   libssh2-1-dev                  libssl-dev                     libtelnet-dev                  libtool                        libvncserver-dev               libwebsockets-dev              libwebp-dev                    make\"\n#   Bring build environment up to date and install build dependencies\nRUN apt-get update \\\n && apt-get install $BUILD_DEPENDENCIES -y \\\n && rm -rf /var/lib/apt/lists/*\n#   Add configuration scripts\nCOPY src/guacd-docker/bin \"${PREFIX_DIR}/bin/\"\n#   Copy source to container for sake of build\nCOPY . \"$BUILD_DIR\"\n#   Build guacamole-server from local source\nRUN ${PREFIX_DIR}/bin/build-guacd.sh \"$BUILD_DIR\" \"$PREFIX_DIR\"\n#   Record the packages of all runtime library dependencies\nRUN ${PREFIX_DIR}/bin/list-dependencies.sh ${PREFIX_DIR}/sbin/guacd ${PREFIX_DIR}/lib/libguac-client-*.so ${PREFIX_DIR}/lib/freerdp/guac*.so > ${PREFIX_DIR}/DEPENDENCIES\n#   Use same Debian as the base for the runtime image\nFROM debian:${DEBIAN_VERSION}\n#   Base directory for installed build artifacts.\n#   Due to limitations of the Docker image build process, this value is\n#   duplicated in an ARG in the first stage of the build. See also the\n#   CMD directive at the end of this build stage.\n#\nARG PREFIX_DIR=/usr/local/guacamole\n#   Runtime environment\nENV LC_ALL=\"C.UTF-8\"\nENV LD_LIBRARY_PATH=\"${PREFIX_DIR}/lib\"\nENV GUACD_LOG_LEVEL=\"info\"\nARG RUNTIME_DEPENDENCIES=\"             ca-certificates                ghostscript                    libfreerdp-plugins-standard    fonts-liberation               fonts-dejavu                   xfonts-terminus\"\n#   Copy build artifacts into this stage\nCOPY --from=builder ${PREFIX_DIR} ${PREFIX_DIR}\n#   Bring runtime environment up to date and install runtime dependencies\nRUN apt-get update \\\n && apt-get install $RUNTIME_DEPENDENCIES -y \\\n && apt-get install $( cat \"${PREFIX_DIR}\"/DEPENDENCIES ;) -y \\\n && rm -rf /var/lib/apt/lists/*\n#   Link FreeRDP plugins into proper path\nRUN ${PREFIX_DIR}/bin/link-freerdp-plugins.sh ${PREFIX_DIR}/lib/freerdp/guac*.so\n#   Expose the default listener port\nEXPOSE 4822/tcp\n#   Start guacd, listening on port 0.0.0.0:4822\n#\n#   Note the path here MUST correspond to the value specified in the \n#   PREFIX_DIR build argument.\n#\nCMD /usr/local/guacamole/sbin/guacd -b 0.0.0.0 -L $GUACD_LOG_LEVEL -f\n","originalDockerfileUglifiedHash":"3ab22be605d00b63e6e7f115e1013f1d","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/f5f7a425fcc9a571911c9e80e089eb71bac07b69.dockerfile"}