{"seed":81751758,"processedDockerfileHash":"d8acaf438bd4b33c073cf0da4d571647","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM microsoft/dotnet:2.1-aspnetcore-runtime AS base\nWORKDIR /app\nEXPOSE 80/tcp\nEXPOSE 443/tcp\n#  Build main branch source apps\nFROM microsoft/dotnet:2.1-sdk AS build-src\nCOPY ConferencePlanner.sln ./\nCOPY src src\nRUN dotnet restore -nowarn:msb3202,nu1503 --packages /nuget\nWORKDIR /src/BackEnd\nRUN dotnet build -c Release -o /app/backend\nWORKDIR /src/FrontEnd\nRUN dotnet build -c Release -o app/frontend\n#  Build save-points\n#  1-Create-API-and-EF-Model\nFROM microsoft/dotnet:2.1-sdk AS build-save-1\nCOPY --from=build-src /nuget /nuget\nARG DIR=save-points/1-Create-API-and-EF-Model/ConferencePlanner/\nCOPY $DIR/ConferencePlanner.sln ./\nCOPY $DIR/BackEnd/BackEnd.csproj BackEnd/\nRUN dotnet restore -nowarn:msb3202,nu1503 -s /nuget\nCOPY ${DIR} ./\nRUN dotnet build -c Release -o /app\n#  2a-Refactor-to-ConferenceDTO\nFROM microsoft/dotnet:2.1-sdk AS build-save-2a\nCOPY --from=build-src /nuget /nuget\nARG DIR=save-points/2a-Refactor-to-ConferenceDTO/ConferencePlanner/\nCOPY $DIR/ConferencePlanner.sln ./\nCOPY $DIR/BackEnd/BackEnd.csproj BackEnd/\nCOPY $DIR/ConferenceDTO/ConferenceDTO.csproj ConferenceDTO/\nRUN dotnet restore -nowarn:msb3202,nu1503 -s /nuget\nCOPY ${DIR} ./\nRUN dotnet build -c Release -o /app\n#  2b-BackEnd-completed\nFROM microsoft/dotnet:2.1-sdk AS build-save-2b\nCOPY --from=build-src /nuget /nuget\nARG DIR=save-points/2b-BackEnd-completed/ConferencePlanner/\nCOPY $DIR/ConferencePlanner.sln ./\nCOPY $DIR/BackEnd/BackEnd.csproj BackEnd/\nCOPY $DIR/ConferenceDTO/ConferenceDTO.csproj ConferenceDTO/\nRUN dotnet restore -nowarn:msb3202,nu1503 -s /nuget\nCOPY ${DIR} ./\nRUN dotnet build -c Release -o /app\n#  3-Front-End-started\nFROM microsoft/dotnet:2.1-sdk AS build-save-3\nCOPY --from=build-src /nuget /nuget\nARG DIR=save-points/3-Front-End-started/ConferencePlanner/\nCOPY $DIR/ConferencePlanner.sln ./\nCOPY ${DIR} ./\nRUN dotnet restore -nowarn:msb3202,nu1503 -s /nuget\nWORKDIR /BackEnd\nRUN dotnet build -c Release -o /app/backend\nWORKDIR /FrontEnd\nRUN dotnet build -c Release -o app/frontend\n#  4-Authentication-and-Tag-Helpers\nFROM microsoft/dotnet:2.1-sdk AS build-save-4\nCOPY --from=build-src /nuget /nuget\nARG DIR=save-points/4-Authentication-and-Tag-Helpers/ConferencePlanner/\nCOPY $DIR/ConferencePlanner.sln ./\nCOPY ${DIR} ./\nRUN dotnet restore -nowarn:msb3202,nu1503 -s /nuget\nWORKDIR /BackEnd\nRUN dotnet build -c Release -o /app/backend\nWORKDIR /FrontEnd\nRUN dotnet build -c Release -o app/frontend\n#  5-User-association-and-personal-agenda\nFROM microsoft/dotnet:2.1-sdk AS build-save-5\nCOPY --from=build-src /nuget /nuget\nARG DIR=save-points/5-User-association-and-personal-agenda/ConferencePlanner/\nCOPY $DIR/ConferencePlanner.sln ./\nCOPY ${DIR} ./\nRUN dotnet restore -nowarn:msb3202,nu1503 -s /nuget\nWORKDIR /BackEnd\nRUN dotnet build -c Release -o /app/backend\nWORKDIR /FrontEnd\nRUN dotnet build -c Release -o app/frontend\n#  6-Deployment-docker\nFROM microsoft/dotnet:2.1-sdk AS build-save-6\nCOPY --from=build-src /nuget /nuget\nARG DIR=save-points/6-Deployment-docker/ConferencePlanner/\nCOPY $DIR/ConferencePlanner.sln ./\nCOPY ${DIR} ./\nWORKDIR /BackEnd\nRUN dotnet restore -nowarn:msb3202,nu1503 -s /nuget\nRUN dotnet build -c Release -o /app/backend\nWORKDIR /FrontEnd\nRUN dotnet restore -nowarn:msb3202,nu1503 -s /nuget\nRUN dotnet build -c Release -o app/frontend\n#  8a-Adding-FrontEnd-Spa-final\nFROM microsoft/dotnet:2.1-sdk AS build-save-8a-final\nENV NODE_VERSION=\"8.11.2\"\nENV NODE_DOWNLOAD_URL=\"https://nodejs.org/dist/v$NODE_VERSION/node-v$NODE_VERSION-linux-x64.tar.gz\"\nENV NODE_DOWNLOAD_SHA=\"67dc4c06a58d4b23c5378325ad7e0a2ec482b48cea802252b99ebe8538a3ab79\"\nRUN curl -SL \"$NODE_DOWNLOAD_URL\" --output nodejs.tar.gz \\\n && echo \"$NODE_DOWNLOAD_SHA nodejs.tar.gz\" | sha256sum -c - \\\n && tar -xzf \"nodejs.tar.gz\" -C /usr/local --strip-components=1 \\\n && rm nodejs.tar.gz \\\n && ln -s /usr/local/bin/node /usr/local/bin/nodejs\nCOPY --from=build-src /nuget /nuget\nARG DIR=save-points/8a-Adding-FrontEnd-Spa-final/ConferencePlanner\nCOPY $DIR/ConferencePlanner.sln ./\nCOPY ${DIR}/src ./src\nWORKDIR /src/BackEnd\nRUN dotnet restore -nowarn:msb3202,nu1503 -s /nuget\nRUN dotnet build -c Release -o /app/backend\nWORKDIR /src/FrontEndSpa\nRUN dotnet restore -nowarn:msb3202,nu1503 -s /nuget\nWORKDIR /src/FrontEndSpa/ClientApp\nRUN npm install\nRUN npm run build\nWORKDIR /src/FrontEndSpa\nRUN dotnet build -c Release -o app/frontend\n#  8a-Adding-FrontEnd-Spa-started\nFROM microsoft/dotnet:2.1-sdk AS build-save-8a-start\nCOPY --from=build-src /nuget /nuget\nARG DIR=save-points/8a-Adding-FrontEnd-Spa-started/ConferencePlanner\nCOPY $DIR/ConferencePlanner.sln ./\nCOPY ${DIR}/src ./src\nWORKDIR /src/BackEnd\nRUN dotnet restore -nowarn:msb3202,nu1503 -s /nuget\nRUN dotnet build -c Release -o /app/backend\n#  produce final images\nFROM build-src AS publish-backend\nRUN dotnet publish -c Release -o /app\nFROM build-src AS publish-frontend\nRUN dotnet publish -c Release -o /app\n#   Produce this image using\n#   docker build --target final-backend -t aspnet-app-workshop-backend:latest .\nFROM base AS final-backend\nWORKDIR /app\nCOPY --from=publish-backend /app .\nENTRYPOINT [\"dotnet\", \"BackEnd.dll\"]\n#   Produce this image using\n#   docker build --target final-backend -t aspnet-app-workshop-frontend:latest .\nFROM base AS final-frontend\nWORKDIR /app\nCOPY --from=publish-frontend /app .\nENTRYPOINT [\"dotnet\", \"FrontEnd.dll\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM microsoft/dotnet:2.1-aspnetcore-runtime AS base\nWORKDIR /app\nEXPOSE 80/tcp\nEXPOSE 443/tcp\n# Build main branch source apps\nFROM microsoft/dotnet:2.1-sdk AS build-src\nCOPY ConferencePlanner.sln ./\nCOPY src src\nRUN dotnet restore -nowarn:msb3202,nu1503 --packages /nuget\nWORKDIR /src/BackEnd\nRUN dotnet build -c Release -o /app/backend\nWORKDIR /src/FrontEnd\nRUN dotnet build -c Release -o app/frontend\n# Build save-points\n# 1-Create-API-and-EF-Model\nFROM microsoft/dotnet:2.1-sdk AS build-save-1\nCOPY --from=build-src /nuget /nuget\nARG DIR=save-points/1-Create-API-and-EF-Model/ConferencePlanner/\nCOPY $DIR/ConferencePlanner.sln ./\nCOPY $DIR/BackEnd/BackEnd.csproj BackEnd/\nRUN dotnet restore -nowarn:msb3202,nu1503 -s /nuget\nCOPY ${DIR} ./\nRUN dotnet build -c Release -o /app\n# 2a-Refactor-to-ConferenceDTO\nFROM microsoft/dotnet:2.1-sdk AS build-save-2a\nCOPY --from=build-src /nuget /nuget\nARG DIR=save-points/2a-Refactor-to-ConferenceDTO/ConferencePlanner/\nCOPY $DIR/ConferencePlanner.sln ./\nCOPY $DIR/BackEnd/BackEnd.csproj BackEnd/\nCOPY $DIR/ConferenceDTO/ConferenceDTO.csproj ConferenceDTO/\nRUN dotnet restore -nowarn:msb3202,nu1503 -s /nuget\nCOPY ${DIR} ./\nRUN dotnet build -c Release -o /app\n# 2b-BackEnd-completed\nFROM microsoft/dotnet:2.1-sdk AS build-save-2b\nCOPY --from=build-src /nuget /nuget\nARG DIR=save-points/2b-BackEnd-completed/ConferencePlanner/\nCOPY $DIR/ConferencePlanner.sln ./\nCOPY $DIR/BackEnd/BackEnd.csproj BackEnd/\nCOPY $DIR/ConferenceDTO/ConferenceDTO.csproj ConferenceDTO/\nRUN dotnet restore -nowarn:msb3202,nu1503 -s /nuget\nCOPY ${DIR} ./\nRUN dotnet build -c Release -o /app\n# 3-Front-End-started\nFROM microsoft/dotnet:2.1-sdk AS build-save-3\nCOPY --from=build-src /nuget /nuget\nARG DIR=save-points/3-Front-End-started/ConferencePlanner/\nCOPY $DIR/ConferencePlanner.sln ./\nCOPY ${DIR} ./\nRUN dotnet restore -nowarn:msb3202,nu1503 -s /nuget\nWORKDIR /BackEnd\nRUN dotnet build -c Release -o /app/backend\nWORKDIR /FrontEnd\nRUN dotnet build -c Release -o app/frontend\n# 4-Authentication-and-Tag-Helpers\nFROM microsoft/dotnet:2.1-sdk AS build-save-4\nCOPY --from=build-src /nuget /nuget\nARG DIR=save-points/4-Authentication-and-Tag-Helpers/ConferencePlanner/\nCOPY $DIR/ConferencePlanner.sln ./\nCOPY ${DIR} ./\nRUN dotnet restore -nowarn:msb3202,nu1503 -s /nuget\nWORKDIR /BackEnd\nRUN dotnet build -c Release -o /app/backend\nWORKDIR /FrontEnd\nRUN dotnet build -c Release -o app/frontend\n# 5-User-association-and-personal-agenda\nFROM microsoft/dotnet:2.1-sdk AS build-save-5\nCOPY --from=build-src /nuget /nuget\nARG DIR=save-points/5-User-association-and-personal-agenda/ConferencePlanner/\nCOPY $DIR/ConferencePlanner.sln ./\nCOPY ${DIR} ./\nRUN dotnet restore -nowarn:msb3202,nu1503 -s /nuget\nWORKDIR /BackEnd\nRUN dotnet build -c Release -o /app/backend\nWORKDIR /FrontEnd\nRUN dotnet build -c Release -o app/frontend\n# 6-Deployment-docker\nFROM microsoft/dotnet:2.1-sdk AS build-save-6\nCOPY --from=build-src /nuget /nuget\nARG DIR=save-points/6-Deployment-docker/ConferencePlanner/\nCOPY $DIR/ConferencePlanner.sln ./\nCOPY ${DIR} ./\nWORKDIR /BackEnd\nRUN dotnet restore -nowarn:msb3202,nu1503 -s /nuget\nRUN dotnet build -c Release -o /app/backend\nWORKDIR /FrontEnd\nRUN dotnet restore -nowarn:msb3202,nu1503 -s /nuget\nRUN dotnet build -c Release -o app/frontend\n# 8a-Adding-FrontEnd-Spa-final\nFROM microsoft/dotnet:2.1-sdk AS build-save-8a-final\nENV NODE_VERSION=\"8.11.2\"\nENV NODE_DOWNLOAD_URL=\"https://nodejs.org/dist/v$NODE_VERSION/node-v$NODE_VERSION-linux-x64.tar.gz\"\nENV NODE_DOWNLOAD_SHA=\"67dc4c06a58d4b23c5378325ad7e0a2ec482b48cea802252b99ebe8538a3ab79\"\nRUN curl -SL \"$NODE_DOWNLOAD_URL\" --output nodejs.tar.gz \\\n && echo \"$NODE_DOWNLOAD_SHA nodejs.tar.gz\" | sha256sum -c - \\\n && tar -xzf \"nodejs.tar.gz\" -C /usr/local --strip-components=1 \\\n && rm nodejs.tar.gz \\\n && ln -s /usr/local/bin/node /usr/local/bin/nodejs\nCOPY --from=build-src /nuget /nuget\nARG DIR=save-points/8a-Adding-FrontEnd-Spa-final/ConferencePlanner\nCOPY $DIR/ConferencePlanner.sln ./\nCOPY ${DIR}/src ./src\nWORKDIR /src/BackEnd\nRUN dotnet restore -nowarn:msb3202,nu1503 -s /nuget\nRUN dotnet build -c Release -o /app/backend\nWORKDIR /src/FrontEndSpa\nRUN dotnet restore -nowarn:msb3202,nu1503 -s /nuget\nWORKDIR /src/FrontEndSpa/ClientApp\nRUN npm install\nRUN npm run build\nWORKDIR /src/FrontEndSpa\nRUN dotnet build -c Release -o app/frontend\n# 8a-Adding-FrontEnd-Spa-started\nFROM microsoft/dotnet:2.1-sdk AS build-save-8a-start\nCOPY --from=build-src /nuget /nuget\nARG DIR=save-points/8a-Adding-FrontEnd-Spa-started/ConferencePlanner\nCOPY $DIR/ConferencePlanner.sln ./\nCOPY ${DIR}/src ./src\nWORKDIR /src/BackEnd\nRUN dotnet restore -nowarn:msb3202,nu1503 -s /nuget\nRUN dotnet build -c Release -o /app/backend\n# produce final images\nFROM build-src AS publish-backend\nRUN dotnet publish -c Release -o /app\nFROM build-src AS publish-frontend\nRUN dotnet publish -c Release -o /app\n#  Produce this image using\n#  docker build --target final-backend -t aspnet-app-workshop-backend:latest .\nFROM base AS final-backend\nWORKDIR /app\nCOPY --from=publish-backend /app .\nENTRYPOINT [\"dotnet\", \"BackEnd.dll\"]\n#  Produce this image using\n#  docker build --target final-backend -t aspnet-app-workshop-frontend:latest .\nFROM base AS final-frontend\nWORKDIR /app\nCOPY --from=publish-frontend /app .\nENTRYPOINT [\"dotnet\", \"FrontEnd.dll\"]\n","injectedSmells":[],"originalDockerfileHash":"7fb83f13695dc576d3ff572d04df6ece","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM microsoft/dotnet:2.1-aspnetcore-runtime AS base\nWORKDIR /app\nEXPOSE 80/tcp\nEXPOSE 443/tcp\n#  Build main branch source apps\nFROM microsoft/dotnet:2.1-sdk AS build-src\nCOPY ConferencePlanner.sln ./\nCOPY src src\nRUN dotnet restore -nowarn:msb3202,nu1503 --packages /nuget\nWORKDIR /src/BackEnd\nRUN dotnet build -c Release -o /app/backend\nWORKDIR /src/FrontEnd\nRUN dotnet build -c Release -o app/frontend\n#  Build save-points\n#  1-Create-API-and-EF-Model\nFROM microsoft/dotnet:2.1-sdk AS build-save-1\nCOPY --from=build-src /nuget /nuget\nARG DIR=save-points/1-Create-API-and-EF-Model/ConferencePlanner/\nCOPY $DIR/ConferencePlanner.sln ./\nCOPY $DIR/BackEnd/BackEnd.csproj BackEnd/\nRUN dotnet restore -nowarn:msb3202,nu1503 -s /nuget\nCOPY ${DIR} ./\nRUN dotnet build -c Release -o /app\n#  2a-Refactor-to-ConferenceDTO\nFROM microsoft/dotnet:2.1-sdk AS build-save-2a\nCOPY --from=build-src /nuget /nuget\nARG DIR=save-points/2a-Refactor-to-ConferenceDTO/ConferencePlanner/\nCOPY $DIR/ConferencePlanner.sln ./\nCOPY $DIR/BackEnd/BackEnd.csproj BackEnd/\nCOPY $DIR/ConferenceDTO/ConferenceDTO.csproj ConferenceDTO/\nRUN dotnet restore -nowarn:msb3202,nu1503 -s /nuget\nCOPY ${DIR} ./\nRUN dotnet build -c Release -o /app\n#  2b-BackEnd-completed\nFROM microsoft/dotnet:2.1-sdk AS build-save-2b\nCOPY --from=build-src /nuget /nuget\nARG DIR=save-points/2b-BackEnd-completed/ConferencePlanner/\nCOPY $DIR/ConferencePlanner.sln ./\nCOPY $DIR/BackEnd/BackEnd.csproj BackEnd/\nCOPY $DIR/ConferenceDTO/ConferenceDTO.csproj ConferenceDTO/\nRUN dotnet restore -nowarn:msb3202,nu1503 -s /nuget\nCOPY ${DIR} ./\nRUN dotnet build -c Release -o /app\n#  3-Front-End-started\nFROM microsoft/dotnet:2.1-sdk AS build-save-3\nCOPY --from=build-src /nuget /nuget\nARG DIR=save-points/3-Front-End-started/ConferencePlanner/\nCOPY $DIR/ConferencePlanner.sln ./\nCOPY ${DIR} ./\nRUN dotnet restore -nowarn:msb3202,nu1503 -s /nuget\nWORKDIR /BackEnd\nRUN dotnet build -c Release -o /app/backend\nWORKDIR /FrontEnd\nRUN dotnet build -c Release -o app/frontend\n#  4-Authentication-and-Tag-Helpers\nFROM microsoft/dotnet:2.1-sdk AS build-save-4\nCOPY --from=build-src /nuget /nuget\nARG DIR=save-points/4-Authentication-and-Tag-Helpers/ConferencePlanner/\nCOPY $DIR/ConferencePlanner.sln ./\nCOPY ${DIR} ./\nRUN dotnet restore -nowarn:msb3202,nu1503 -s /nuget\nWORKDIR /BackEnd\nRUN dotnet build -c Release -o /app/backend\nWORKDIR /FrontEnd\nRUN dotnet build -c Release -o app/frontend\n#  5-User-association-and-personal-agenda\nFROM microsoft/dotnet:2.1-sdk AS build-save-5\nCOPY --from=build-src /nuget /nuget\nARG DIR=save-points/5-User-association-and-personal-agenda/ConferencePlanner/\nCOPY $DIR/ConferencePlanner.sln ./\nCOPY ${DIR} ./\nRUN dotnet restore -nowarn:msb3202,nu1503 -s /nuget\nWORKDIR /BackEnd\nRUN dotnet build -c Release -o /app/backend\nWORKDIR /FrontEnd\nRUN dotnet build -c Release -o app/frontend\n#  6-Deployment-docker\nFROM microsoft/dotnet:2.1-sdk AS build-save-6\nCOPY --from=build-src /nuget /nuget\nARG DIR=save-points/6-Deployment-docker/ConferencePlanner/\nCOPY $DIR/ConferencePlanner.sln ./\nCOPY ${DIR} ./\nWORKDIR /BackEnd\nRUN dotnet restore -nowarn:msb3202,nu1503 -s /nuget\nRUN dotnet build -c Release -o /app/backend\nWORKDIR /FrontEnd\nRUN dotnet restore -nowarn:msb3202,nu1503 -s /nuget\nRUN dotnet build -c Release -o app/frontend\n#  8a-Adding-FrontEnd-Spa-final\nFROM microsoft/dotnet:2.1-sdk AS build-save-8a-final\nENV NODE_VERSION=\"8.11.2\"\nENV NODE_DOWNLOAD_URL=\"https://nodejs.org/dist/v$NODE_VERSION/node-v$NODE_VERSION-linux-x64.tar.gz\"\nENV NODE_DOWNLOAD_SHA=\"67dc4c06a58d4b23c5378325ad7e0a2ec482b48cea802252b99ebe8538a3ab79\"\nRUN curl -SL \"$NODE_DOWNLOAD_URL\" --output nodejs.tar.gz \\\n && echo \"$NODE_DOWNLOAD_SHA nodejs.tar.gz\" | sha256sum -c - \\\n && tar -xzf \"nodejs.tar.gz\" -C /usr/local --strip-components=1 \\\n && rm nodejs.tar.gz \\\n && ln -s /usr/local/bin/node /usr/local/bin/nodejs\nCOPY --from=build-src /nuget /nuget\nARG DIR=save-points/8a-Adding-FrontEnd-Spa-final/ConferencePlanner\nCOPY $DIR/ConferencePlanner.sln ./\nCOPY ${DIR}/src ./src\nWORKDIR /src/BackEnd\nRUN dotnet restore -nowarn:msb3202,nu1503 -s /nuget\nRUN dotnet build -c Release -o /app/backend\nWORKDIR /src/FrontEndSpa\nRUN dotnet restore -nowarn:msb3202,nu1503 -s /nuget\nWORKDIR /src/FrontEndSpa/ClientApp\nRUN npm install\nRUN npm run build\nWORKDIR /src/FrontEndSpa\nRUN dotnet build -c Release -o app/frontend\n#  8a-Adding-FrontEnd-Spa-started\nFROM microsoft/dotnet:2.1-sdk AS build-save-8a-start\nCOPY --from=build-src /nuget /nuget\nARG DIR=save-points/8a-Adding-FrontEnd-Spa-started/ConferencePlanner\nCOPY $DIR/ConferencePlanner.sln ./\nCOPY ${DIR}/src ./src\nWORKDIR /src/BackEnd\nRUN dotnet restore -nowarn:msb3202,nu1503 -s /nuget\nRUN dotnet build -c Release -o /app/backend\n#  produce final images\nFROM build-src AS publish-backend\nRUN dotnet publish -c Release -o /app\nFROM build-src AS publish-frontend\nRUN dotnet publish -c Release -o /app\n#   Produce this image using\n#   docker build --target final-backend -t aspnet-app-workshop-backend:latest .\nFROM base AS final-backend\nWORKDIR /app\nCOPY --from=publish-backend /app .\nENTRYPOINT [\"dotnet\", \"BackEnd.dll\"]\n#   Produce this image using\n#   docker build --target final-backend -t aspnet-app-workshop-frontend:latest .\nFROM base AS final-frontend\nWORKDIR /app\nCOPY --from=publish-frontend /app .\nENTRYPOINT [\"dotnet\", \"FrontEnd.dll\"]\n","originalDockerfileUglifiedHash":"f3dbb7eb15d3e6983e924c31b4a16d76","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/3cd63ae1b1f748b34c52844b6334c37bb7e96513.dockerfile"}