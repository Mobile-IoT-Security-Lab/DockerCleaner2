{"seed":3349390095,"processedDockerfileHash":"7f1a19aa0560094e3331bd04d6598a1a","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM php:7.3-fpm\nRUN apt-get update \\\n && apt-get install --no-install-recommends libz-dev libmemcached-dev -y\nRUN pecl install memcached-3.1.2\nRUN echo extension=memcached.so >> /usr/local/etc/php/conf.d/memcached.ini\n#   gd extension\nRUN apt-get update \\\n && apt-get install --no-install-recommends libpng-dev libfreetype6-dev libjpeg-dev libxpm-dev libxml2-dev libxslt-dev librabbitmq-dev libssh-dev libwebp-dev -y\nRUN docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ --with-xpm-dir=/usr/include --with-webp-dir=/usr/include/\nRUN docker-php-ext-install gd\nRUN pecl install amqp-1.9.4\nRUN docker-php-ext-enable amqp\nRUN apt-get update \\\n && apt-get install --no-install-recommends libz-dev libzip-dev -y\nRUN docker-php-ext-install zip\nRUN docker-php-ext-install xsl\nRUN apt-get update \\\n && apt-get install --no-install-recommends libicu-dev -y\nRUN docker-php-ext-install intl\nRUN docker-php-ext-install mysqli\nRUN docker-php-ext-install pdo_mysql\nRUN docker-php-ext-install opcache\nRUN docker-php-ext-install bcmath\nRUN docker-php-ext-install calendar\nRUN docker-php-ext-install sockets\nRUN pecl install redis \\\n && docker-php-ext-enable redis\n#   ldap\nRUN apt-get update \\\n && apt-get install --no-install-recommends libldap2-dev -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && docker-php-ext-configure ldap --with-libdir=lib/x86_64-linux-gnu/ \\\n && docker-php-ext-install ldap\n#   ldap\nRUN docker-php-ext-configure pcntl --enable-pcntl \\\n && docker-php-ext-install pcntl\nRUN pecl install xdebug-2.7.0RC2\nRUN echo \"zend_extension=`php -i | grep ^extension_dir | cut -f 3 -d ' ' `/xdebug.so\" >> /usr/local/etc/php/conf.d/xdebug.ini\nRUN docker-php-ext-install soap\nENV COMPOSER_HOME=\"/composer\"\nCOPY --from=composer:1.8.4 /usr/bin/composer /usr/local/bin/composer\nRUN apt-get update \\\n && apt-get install --no-install-recommends git vim mysql-client rsync sshpass bzip2 msmtp unzip -y\nCOPY php.ini /usr/local/etc/php/php.ini\n#   Cron\nRUN apt-get update \\\n && apt-get install --no-install-recommends cron -y \\\n && mkfifo --mode 0666 /var/log/cron.log \\\n && sed --regexp-extended --in-place 's/^session\\s+required\\s+pam_loginuid.so$/session optional pam_loginuid.so/' /etc/pam.d/cron\nCOPY start-cron /usr/sbin\nRUN chmod +x /usr/sbin/start-cron\n#   Cron\nENV PHP_DATE_TIMEZONE=\"\" \\\n    PHP_LOG_ERRORS_MAX_LEN=\"1024\" \\\n    PHP_LOG_ERRORS=\"\" \\\n    PHP_MAX_EXECUTION_TIME=\"0\" \\\n    PHP_MAX_FILE_UPLOADS=\"20\" \\\n    PHP_MAX_INPUT_VARS=\"1000\" \\\n    PHP_MEMORY_LIMIT=\"128M\" \\\n    PHP_POST_MAX_SIZE=\"8M\" \\\n    PHP_SENDMAIL_PATH=\"/usr/sbin/sendmail -t -i\" \\\n    PHP_SESSION_SAVE_HANDLER=\"files\" \\\n    PHP_SESSION_SAVE_PATH=\"\" \\\n    PHP_UPLOAD_MAX_FILESIZE=\"2M\" \\\n    PHP_XDEBUG_DEFAULT_ENABLE=\"0\" \\\n    PHP_XDEBUG_IDEKEY=\" PHP_XDEBUG_PROFILER_ENABLE=0\" \\\n    PHP_XDEBUG_REMOTE_AUTOSTART=\"0\" \\\n    PHP_XDEBUG_REMOTE_CONNECT_BACK=\"0\" \\\n    PHP_XDEBUG_REMOTE_ENABLE=\"0\" \\\n    PHP_XDEBUG_REMOTE_HOST=\"0\"\nWORKDIR /usr/src/app\n#   imagick\nRUN apt-get update \\\n && apt-get install --no-install-recommends libmagickwand-dev -y \\\n && pecl install imagick \\\n && docker-php-ext-enable imagick\n#   Install Postgre PDO\nRUN apt-get install --no-install-recommends libpq-dev -y \\\n && docker-php-ext-configure pgsql -with-pgsql=/usr/local/pgsql \\\n && docker-php-ext-install pdo_pgsql pgsql\nRUN pecl install pcov-1.0.0\nRUN docker-php-ext-enable pcov\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\n","originalDockerfile":"FROM php:7.3-fpm\nRUN apt-get update \\\n && apt-get install libz-dev libmemcached-dev -y\nRUN pecl install memcached-3.1.2\nRUN echo extension=memcached.so >> /usr/local/etc/php/conf.d/memcached.ini\n#  gd extension\nRUN apt-get update \\\n && apt-get install libpng-dev libfreetype6-dev libjpeg-dev libxpm-dev libxml2-dev libxslt-dev librabbitmq-dev libssh-dev libwebp-dev -y\nRUN docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ --with-xpm-dir=/usr/include --with-webp-dir=/usr/include/\nRUN docker-php-ext-install gd\nRUN pecl install amqp-1.9.4\nRUN docker-php-ext-enable amqp\nRUN apt-get update \\\n && apt-get install libz-dev libzip-dev -y\nRUN docker-php-ext-install zip\nRUN docker-php-ext-install xsl\nRUN apt-get update \\\n && apt-get install libicu-dev -y\nRUN docker-php-ext-install intl\nRUN docker-php-ext-install mysqli\nRUN docker-php-ext-install pdo_mysql\nRUN docker-php-ext-install opcache\nRUN docker-php-ext-install bcmath\nRUN docker-php-ext-install calendar\nRUN docker-php-ext-install sockets\nRUN pecl install redis \\\n && docker-php-ext-enable redis\n#  ldap\nRUN apt-get update \\\n && apt-get install libldap2-dev -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && docker-php-ext-configure ldap --with-libdir=lib/x86_64-linux-gnu/ \\\n && docker-php-ext-install ldap\n#  ldap\nRUN docker-php-ext-configure pcntl --enable-pcntl \\\n && docker-php-ext-install pcntl\nRUN pecl install xdebug-2.7.0RC2\nRUN echo \"zend_extension=`php -i | grep ^extension_dir | cut -f 3 -d ' ' `/xdebug.so\" >> /usr/local/etc/php/conf.d/xdebug.ini\nRUN docker-php-ext-install soap\nENV COMPOSER_HOME=\"/composer\"\nCOPY --from=composer:1.8.4 /usr/bin/composer /usr/local/bin/composer\nRUN apt-get update \\\n && apt-get install git vim mysql-client rsync sshpass bzip2 msmtp unzip -y\nADD php.ini /usr/local/etc/php/php.ini\n#  Cron\nRUN apt-get update \\\n && apt-get install cron -y \\\n && mkfifo --mode 0666 /var/log/cron.log \\\n && sed --regexp-extended --in-place 's/^session\\s+required\\s+pam_loginuid.so$/session optional pam_loginuid.so/' /etc/pam.d/cron\nCOPY start-cron /usr/sbin\nRUN chmod +x /usr/sbin/start-cron\n#  Cron\nENV PHP_DATE_TIMEZONE=\"\" \\\n    PHP_LOG_ERRORS_MAX_LEN=\"1024\" \\\n    PHP_LOG_ERRORS=\"\" \\\n    PHP_MAX_EXECUTION_TIME=\"0\" \\\n    PHP_MAX_FILE_UPLOADS=\"20\" \\\n    PHP_MAX_INPUT_VARS=\"1000\" \\\n    PHP_MEMORY_LIMIT=\"128M\" \\\n    PHP_POST_MAX_SIZE=\"8M\" \\\n    PHP_SENDMAIL_PATH=\"/usr/sbin/sendmail -t -i\" \\\n    PHP_SESSION_SAVE_HANDLER=\"files\" \\\n    PHP_SESSION_SAVE_PATH=\"\" \\\n    PHP_UPLOAD_MAX_FILESIZE=\"2M\" \\\n    PHP_XDEBUG_DEFAULT_ENABLE=\"0\" \\\n    PHP_XDEBUG_IDEKEY=\" PHP_XDEBUG_PROFILER_ENABLE=0\" \\\n    PHP_XDEBUG_REMOTE_AUTOSTART=\"0\" \\\n    PHP_XDEBUG_REMOTE_CONNECT_BACK=\"0\" \\\n    PHP_XDEBUG_REMOTE_ENABLE=\"0\" \\\n    PHP_XDEBUG_REMOTE_HOST=\"0\"\nWORKDIR /usr/src/app\n#  imagick\nRUN apt-get update \\\n && apt-get install libmagickwand-dev -y \\\n && pecl install imagick \\\n && docker-php-ext-enable imagick\n#  Install Postgre PDO\nRUN apt-get install libpq-dev -y \\\n && docker-php-ext-configure pgsql -with-pgsql=/usr/local/pgsql \\\n && docker-php-ext-install pdo_pgsql pgsql\nRUN pecl install pcov-1.0.0\nRUN docker-php-ext-enable pcov\n","injectedSmells":[],"originalDockerfileHash":"6a6da82ca9a552a200a91afbc7a3a30f","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM php:7.3-fpm\nRUN apt-get update \\\n && apt-get install libz-dev libmemcached-dev -y\nRUN pecl install memcached-3.1.2\nRUN echo extension=memcached.so >> /usr/local/etc/php/conf.d/memcached.ini\n#   gd extension\nRUN apt-get update \\\n && apt-get install libpng-dev libfreetype6-dev libjpeg-dev libxpm-dev libxml2-dev libxslt-dev librabbitmq-dev libssh-dev libwebp-dev -y\nRUN docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ --with-xpm-dir=/usr/include --with-webp-dir=/usr/include/\nRUN docker-php-ext-install gd\nRUN pecl install amqp-1.9.4\nRUN docker-php-ext-enable amqp\nRUN apt-get update \\\n && apt-get install libz-dev libzip-dev -y\nRUN docker-php-ext-install zip\nRUN docker-php-ext-install xsl\nRUN apt-get update \\\n && apt-get install libicu-dev -y\nRUN docker-php-ext-install intl\nRUN docker-php-ext-install mysqli\nRUN docker-php-ext-install pdo_mysql\nRUN docker-php-ext-install opcache\nRUN docker-php-ext-install bcmath\nRUN docker-php-ext-install calendar\nRUN docker-php-ext-install sockets\nRUN pecl install redis \\\n && docker-php-ext-enable redis\n#   ldap\nRUN apt-get update \\\n && apt-get install libldap2-dev -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && docker-php-ext-configure ldap --with-libdir=lib/x86_64-linux-gnu/ \\\n && docker-php-ext-install ldap\n#   ldap\nRUN docker-php-ext-configure pcntl --enable-pcntl \\\n && docker-php-ext-install pcntl\nRUN pecl install xdebug-2.7.0RC2\nRUN echo \"zend_extension=`php -i | grep ^extension_dir | cut -f 3 -d ' ' `/xdebug.so\" >> /usr/local/etc/php/conf.d/xdebug.ini\nRUN docker-php-ext-install soap\nENV COMPOSER_HOME=\"/composer\"\nCOPY --from=composer:1.8.4 /usr/bin/composer /usr/local/bin/composer\nRUN apt-get update \\\n && apt-get install git vim mysql-client rsync sshpass bzip2 msmtp unzip -y\nADD php.ini /usr/local/etc/php/php.ini\n#   Cron\nRUN apt-get update \\\n && apt-get install cron -y \\\n && mkfifo --mode 0666 /var/log/cron.log \\\n && sed --regexp-extended --in-place 's/^session\\s+required\\s+pam_loginuid.so$/session optional pam_loginuid.so/' /etc/pam.d/cron\nCOPY start-cron /usr/sbin\nRUN chmod +x /usr/sbin/start-cron\n#   Cron\nENV PHP_DATE_TIMEZONE=\"\" \\\n    PHP_LOG_ERRORS_MAX_LEN=\"1024\" \\\n    PHP_LOG_ERRORS=\"\" \\\n    PHP_MAX_EXECUTION_TIME=\"0\" \\\n    PHP_MAX_FILE_UPLOADS=\"20\" \\\n    PHP_MAX_INPUT_VARS=\"1000\" \\\n    PHP_MEMORY_LIMIT=\"128M\" \\\n    PHP_POST_MAX_SIZE=\"8M\" \\\n    PHP_SENDMAIL_PATH=\"/usr/sbin/sendmail -t -i\" \\\n    PHP_SESSION_SAVE_HANDLER=\"files\" \\\n    PHP_SESSION_SAVE_PATH=\"\" \\\n    PHP_UPLOAD_MAX_FILESIZE=\"2M\" \\\n    PHP_XDEBUG_DEFAULT_ENABLE=\"0\" \\\n    PHP_XDEBUG_IDEKEY=\" PHP_XDEBUG_PROFILER_ENABLE=0\" \\\n    PHP_XDEBUG_REMOTE_AUTOSTART=\"0\" \\\n    PHP_XDEBUG_REMOTE_CONNECT_BACK=\"0\" \\\n    PHP_XDEBUG_REMOTE_ENABLE=\"0\" \\\n    PHP_XDEBUG_REMOTE_HOST=\"0\"\nWORKDIR /usr/src/app\n#   imagick\nRUN apt-get update \\\n && apt-get install libmagickwand-dev -y \\\n && pecl install imagick \\\n && docker-php-ext-enable imagick\n#   Install Postgre PDO\nRUN apt-get install libpq-dev -y \\\n && docker-php-ext-configure pgsql -with-pgsql=/usr/local/pgsql \\\n && docker-php-ext-install pdo_pgsql pgsql\nRUN pecl install pcov-1.0.0\nRUN docker-php-ext-enable pcov\n","originalDockerfileUglifiedHash":"11d25bb9b43e316aea9169a23289f5e9","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/e174d6a7abb73c32e1f81d9e214c751eec2c96c7.dockerfile"}