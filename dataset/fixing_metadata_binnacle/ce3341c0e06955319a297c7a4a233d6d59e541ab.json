{"seed":396451372,"processedDockerfileHash":"70ba20f6416411b9ffa976a775ca7def","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","have-a-healthcheck"],"processedDockerfile":"FROM ubuntu:16.04\nENV AEGIR_VERSION=\"7.x-3.x\"\nENV DEVSHOP_VERSION=\"1.x\"\nENV PROVISION_VERSION=\"7.x-3.x\"\nENV COMPOSER_VERSION=\"1.8.4\"\nENV DRUSH_VERSION=\"8.1.18\"\nENV REGISTRY_REBUILD_VERSION=\"7.x-2.5\"\nENV AEGIR_MAKEFILE=\"https://raw.githubusercontent.com/opendevshop/devshop/$DEVSHOP_VERSION/build-devmaster.make\"\nENV DEBIAN_FRONTEND=\"noninteractive\"\nRUN apt-get update -qq \\\n && (apt-get update ;apt-get install --no-install-recommends apache2=2.4.18-2ubuntu3.17 cron=3.0pl1-128ubuntu2 pwgen=2.07-1.1ubuntu1 git-core=1:2.7.4-0ubuntu1.10 libapache2-mod-php=1:7.0+35ubuntu6.1 libpcre3-dev=2:8.38-3.1 mysql-client=5.7.33-0ubuntu0.16.04.1 mysql-server=5.7.33-0ubuntu0.16.04.1 nano=2.5.3-2ubuntu2 openssh-server=1:7.2p2-4ubuntu2.10 postfix=3.1.0-3ubuntu0.4 rsync=3.1.1-3ubuntu1.3 sudo=1.8.16-0ubuntu1.10 unzip=6.0-20ubuntu1.1 wget=1.17.1-1ubuntu1.5 vim=2:7.4.1689-3ubuntu1.5 -y -qq )\nENV LC_ALL=\"C.UTF-8\"\nENV LANG=\"en_US.UTF-8\"\nRUN apt-get update -qq \\\n && (apt-get update ;apt-get install --no-install-recommends software-properties-common=0.96.20.10 -y -qq )\nRUN add-apt-repository ppa:ondrej/php \\\n && add-apt-repository ppa:ondrej/apache2 \\\n && :\n#   PHP 7.2\nRUN (apt-get update ;apt-get install --no-install-recommends php7.2 php7.2-cli php7.2-curl php7.2-dev php7.2-fpm php7.2-gd php7.2-json php7.2-mbstring php7.2-mysql php7.2-xml -y -qq )\n#   PHP 7.1\nRUN (apt-get update ;apt-get install --no-install-recommends php7.1 php7.1-cli php7.1-curl php7.1-fpm php7.1-gd php7.1-mbstring php7.1-mysql php7.1-xml -y -qq )\n#   PHP 7.0\nRUN (apt-get update ;apt-get install --no-install-recommends php7.0=7.0.33-0ubuntu0.16.04.16 php7.0-cli=7.0.33-0ubuntu0.16.04.16 php7.0-curl=7.0.33-0ubuntu0.16.04.16 php7.0-fpm=7.0.33-0ubuntu0.16.04.16 php7.0-gd=7.0.33-0ubuntu0.16.04.16 php7.0-mbstring=7.0.33-0ubuntu0.16.04.16 php7.0-mysql=7.0.33-0ubuntu0.16.04.16 php7.0-xml=7.0.33-0ubuntu0.16.04.16 -y -qq )\n#   PHP 5.3\nRUN (apt-get update ;apt-get install --no-install-recommends php5.6 php5.6-cli php5.6-curl php5.6-fpm php5.6-gd php5.6-mbstring php5.6-mysql php5.6-xml -y -qq )\nRUN (apt-get update ;apt-get install --no-install-recommends apache2=2.4.18-2ubuntu3.17 -y -qq )\nENV AEGIR_UID=\"12345\"\nRUN echo \"Creating user aegir with UID $AEGIR_UID and GID $AEGIR_GID\"\nRUN addgroup --gid $AEGIR_UID aegir\nRUN adduser --uid $AEGIR_UID --gid $AEGIR_UID --system --shell /bin/bash --home /var/aegir aegir\nRUN adduser aegir www-data\nRUN a2enmod rewrite\nRUN a2enmod ssl\nRUN ln -s /var/aegir/config/apache.conf /etc/apache2/conf-available/aegir.conf\nRUN ln -s /etc/apache2/conf-available/aegir.conf /etc/apache2/conf-enabled/aegir.conf\nRUN wget https://github.com/composer/composer/releases/download/$COMPOSER_VERSION/composer.phar -O - -q > /usr/local/bin/composer\nRUN wget https://github.com/drush-ops/drush/releases/download/$DRUSH_VERSION/drush.phar -O - -q > /usr/local/bin/drush\nRUN chmod +x /usr/local/bin/composer\nRUN chmod +x /usr/local/bin/drush\n#   Install fix-permissions and fix-ownership scripts\nRUN wget http://cgit.drupalcode.org/hosting_tasks_extra/plain/fix_permissions/scripts/standalone-install-fix-permissions-ownership.sh\nRUN bash standalone-install-fix-permissions-ownership.sh\n#   Copy files\nCOPY files/sudoers-aegir /etc/sudoers.d/aegir\nRUN chmod 0440 /etc/sudoers.d/aegir\nCOPY files/docker-entrypoint.sh /usr/local/bin/\nRUN chmod +x /usr/local/bin/docker-entrypoint.sh\nCOPY files/services-start.sh /usr/local/bin/services-start\nRUN chmod +x /usr/local/bin/services-start\nCOPY files/set-user-ids.sh /usr/local/bin/set-user-ids\nRUN chmod +x /usr/local/bin/set-user-ids\n#   Prepare Aegir Logs folder.\nRUN mkdir /var/log/aegir\nRUN chown aegir:aegir /var/log/aegir\nRUN echo 'Hello, Aegir.' > /var/log/aegir/system.log\n#   Don't install provision. Downstream tags will do this with the right version.\n#  # Install Provision for all.\nRUN mkdir -p /usr/share/drush/commands\nRUN drush dl --destination=/usr/share/drush/commands provision-$PROVISION_VERSION -y\nRUN drush dl --destination=/usr/share/drush/commands registry_rebuild-$REGISTRY_REBUILD_VERSION -y\n#   Setup SSH server.\nRUN sed 's@session\\s*required\\s*pam_loginuid.so@session optional pam_loginuid.so@g' -i /etc/pam.d/sshd\nENV NOTVISIBLE=\"\\\"in users profile\\\"\"\nRUN echo \"export VISIBLE=now\" >> /etc/profile\nEXPOSE 22/tcp\nUSER aegir\nRUN mkdir /var/aegir/config\nRUN mkdir /var/aegir/.drush\nRUN mkdir /var/aegir/projects\nRUN mkdir /var/aegir/.ssh\nRUN chmod 700 /var/aegir/.ssh\n#   You may change this environment at run time. User UID 1 is created with this email address.\nENV AEGIR_CLIENT_EMAIL=\"aegir@aegir.local.computer\"\nENV AEGIR_CLIENT_NAME=\"admin\"\nENV AEGIR_PROFILE=\"devmaster\"\nENV AEGIR_WORKING_COPY=\"0\"\n#   Must be fixed across versions so we can upgrade containers.\nENV AEGIR_HOSTMASTER_ROOT=\"/var/aegir/devmaster\"\n#   Build the devmaster stack\nRUN drush make $AEGIR_MAKEFILE $AEGIR_HOSTMASTER_ROOT\nWORKDIR /var/aegir\nVOLUME /var/lib/mysql\nEXPOSE 80/tcp\nEXPOSE 443/tcp\nEXPOSE 3306/tcp\n#   The Hostname of the database server to use\nENV AEGIR_DATABASE_SERVER=\"localhost\"\nENV HOME=\"/var/aegir\"\nVOLUME /var/aegir/projects\n#   docker-entrypoint.sh waits for mysql and runs hostmaster install\nENTRYPOINT [\"docker-entrypoint.sh\"]\nCMD [\"drush\", \"@hostmaster\", \"hosting-queued\"]\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM ubuntu:16.04\nENV AEGIR_VERSION=\"7.x-3.x\"\nENV DEVSHOP_VERSION=\"1.x\"\nENV PROVISION_VERSION=\"7.x-3.x\"\nENV COMPOSER_VERSION=\"1.8.4\"\nENV DRUSH_VERSION=\"8.1.18\"\nENV REGISTRY_REBUILD_VERSION=\"7.x-2.5\"\nENV AEGIR_MAKEFILE=\"https://raw.githubusercontent.com/opendevshop/devshop/$DEVSHOP_VERSION/build-devmaster.make\"\nENV DEBIAN_FRONTEND=\"noninteractive\"\nRUN apt-get update -qq \\\n && apt-get install apache2 cron pwgen git-core libapache2-mod-php libpcre3-dev mysql-client mysql-server nano openssh-server postfix rsync sudo unzip wget vim -y -qq\nENV LC_ALL=\"C.UTF-8\"\nENV LANG=\"en_US.UTF-8\"\nRUN apt-get update -qq \\\n && apt-get install software-properties-common -y -qq\nRUN add-apt-repository ppa:ondrej/php \\\n && add-apt-repository ppa:ondrej/apache2 \\\n && apt-get update -qq\n#  PHP 7.2\nRUN apt-get install php7.2 php7.2-cli php7.2-curl php7.2-dev php7.2-fpm php7.2-gd php7.2-json php7.2-mbstring php7.2-mysql php7.2-xml -y -qq\n#  PHP 7.1\nRUN apt-get install php7.1 php7.1-cli php7.1-curl php7.1-fpm php7.1-gd php7.1-mbstring php7.1-mysql php7.1-xml -y -qq\n#  PHP 7.0\nRUN apt-get install php7.0 php7.0-cli php7.0-curl php7.0-fpm php7.0-gd php7.0-mbstring php7.0-mysql php7.0-xml -y -qq\n#  PHP 5.3\nRUN apt-get install php5.6 php5.6-cli php5.6-curl php5.6-fpm php5.6-gd php5.6-mbstring php5.6-mysql php5.6-xml -y -qq\nRUN apt-get install apache2 -y -qq\nENV AEGIR_UID=\"12345\"\nRUN echo \"Creating user aegir with UID $AEGIR_UID and GID $AEGIR_GID\"\nRUN addgroup --gid $AEGIR_UID aegir\nRUN adduser --uid $AEGIR_UID --gid $AEGIR_UID --system --shell /bin/bash --home /var/aegir aegir\nRUN adduser aegir www-data\nRUN a2enmod rewrite\nRUN a2enmod ssl\nRUN ln -s /var/aegir/config/apache.conf /etc/apache2/conf-available/aegir.conf\nRUN ln -s /etc/apache2/conf-available/aegir.conf /etc/apache2/conf-enabled/aegir.conf\nRUN wget https://github.com/composer/composer/releases/download/$COMPOSER_VERSION/composer.phar -O - -q > /usr/local/bin/composer\nRUN wget https://github.com/drush-ops/drush/releases/download/$DRUSH_VERSION/drush.phar -O - -q > /usr/local/bin/drush\nRUN chmod +x /usr/local/bin/composer\nRUN chmod +x /usr/local/bin/drush\n#  Install fix-permissions and fix-ownership scripts\nRUN wget http://cgit.drupalcode.org/hosting_tasks_extra/plain/fix_permissions/scripts/standalone-install-fix-permissions-ownership.sh\nRUN bash standalone-install-fix-permissions-ownership.sh\n#  Copy files\nCOPY files/sudoers-aegir /etc/sudoers.d/aegir\nRUN chmod 0440 /etc/sudoers.d/aegir\nCOPY files/docker-entrypoint.sh /usr/local/bin/\nRUN chmod +x /usr/local/bin/docker-entrypoint.sh\nCOPY files/services-start.sh /usr/local/bin/services-start\nRUN chmod +x /usr/local/bin/services-start\nCOPY files/set-user-ids.sh /usr/local/bin/set-user-ids\nRUN chmod +x /usr/local/bin/set-user-ids\n#  Prepare Aegir Logs folder.\nRUN mkdir /var/log/aegir\nRUN chown aegir:aegir /var/log/aegir\nRUN echo 'Hello, Aegir.' > /var/log/aegir/system.log\n#  Don't install provision. Downstream tags will do this with the right version.\n# # Install Provision for all.\nRUN mkdir -p /usr/share/drush/commands\nRUN drush dl --destination=/usr/share/drush/commands provision-$PROVISION_VERSION -y\nRUN drush dl --destination=/usr/share/drush/commands registry_rebuild-$REGISTRY_REBUILD_VERSION -y\n#  Setup SSH server.\nRUN sed 's@session\\s*required\\s*pam_loginuid.so@session optional pam_loginuid.so@g' -i /etc/pam.d/sshd\nENV NOTVISIBLE=\"\\\"in users profile\\\"\"\nRUN echo \"export VISIBLE=now\" >> /etc/profile\nEXPOSE 22/tcp\nUSER aegir\nRUN mkdir /var/aegir/config\nRUN mkdir /var/aegir/.drush\nRUN mkdir /var/aegir/projects\nRUN mkdir /var/aegir/.ssh\nRUN chmod 700 /var/aegir/.ssh\n#  You may change this environment at run time. User UID 1 is created with this email address.\nENV AEGIR_CLIENT_EMAIL=\"aegir@aegir.local.computer\"\nENV AEGIR_CLIENT_NAME=\"admin\"\nENV AEGIR_PROFILE=\"devmaster\"\nENV AEGIR_WORKING_COPY=\"0\"\n#  Must be fixed across versions so we can upgrade containers.\nENV AEGIR_HOSTMASTER_ROOT=\"/var/aegir/devmaster\"\n#  Build the devmaster stack\nRUN drush make $AEGIR_MAKEFILE $AEGIR_HOSTMASTER_ROOT\nWORKDIR /var/aegir\nVOLUME /var/lib/mysql\nEXPOSE 80/tcp\nEXPOSE 443/tcp\nEXPOSE 3306/tcp\n#  The Hostname of the database server to use\nENV AEGIR_DATABASE_SERVER=\"localhost\"\nENV HOME=\"/var/aegir\"\nVOLUME /var/aegir/projects\n#  docker-entrypoint.sh waits for mysql and runs hostmaster install\nENTRYPOINT [\"docker-entrypoint.sh\"]\nCMD [\"drush\", \"@hostmaster\", \"hosting-queued\"]\n","injectedSmells":[],"originalDockerfileHash":"152535a2c75465f46b7ab34817a15e2c","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM ubuntu:16.04\nENV AEGIR_VERSION=\"7.x-3.x\"\nENV DEVSHOP_VERSION=\"1.x\"\nENV PROVISION_VERSION=\"7.x-3.x\"\nENV COMPOSER_VERSION=\"1.8.4\"\nENV DRUSH_VERSION=\"8.1.18\"\nENV REGISTRY_REBUILD_VERSION=\"7.x-2.5\"\nENV AEGIR_MAKEFILE=\"https://raw.githubusercontent.com/opendevshop/devshop/$DEVSHOP_VERSION/build-devmaster.make\"\nENV DEBIAN_FRONTEND=\"noninteractive\"\nRUN apt-get update -qq \\\n && apt-get install apache2 cron pwgen git-core libapache2-mod-php libpcre3-dev mysql-client mysql-server nano openssh-server postfix rsync sudo unzip wget vim -y -qq\nENV LC_ALL=\"C.UTF-8\"\nENV LANG=\"en_US.UTF-8\"\nRUN apt-get update -qq \\\n && apt-get install software-properties-common -y -qq\nRUN add-apt-repository ppa:ondrej/php \\\n && add-apt-repository ppa:ondrej/apache2 \\\n && apt-get update -qq\n#   PHP 7.2\nRUN apt-get install php7.2 php7.2-cli php7.2-curl php7.2-dev php7.2-fpm php7.2-gd php7.2-json php7.2-mbstring php7.2-mysql php7.2-xml -y -qq\n#   PHP 7.1\nRUN apt-get install php7.1 php7.1-cli php7.1-curl php7.1-fpm php7.1-gd php7.1-mbstring php7.1-mysql php7.1-xml -y -qq\n#   PHP 7.0\nRUN apt-get install php7.0 php7.0-cli php7.0-curl php7.0-fpm php7.0-gd php7.0-mbstring php7.0-mysql php7.0-xml -y -qq\n#   PHP 5.3\nRUN apt-get install php5.6 php5.6-cli php5.6-curl php5.6-fpm php5.6-gd php5.6-mbstring php5.6-mysql php5.6-xml -y -qq\nRUN apt-get install apache2 -y -qq\nENV AEGIR_UID=\"12345\"\nRUN echo \"Creating user aegir with UID $AEGIR_UID and GID $AEGIR_GID\"\nRUN addgroup --gid $AEGIR_UID aegir\nRUN adduser --uid $AEGIR_UID --gid $AEGIR_UID --system --shell /bin/bash --home /var/aegir aegir\nRUN adduser aegir www-data\nRUN a2enmod rewrite\nRUN a2enmod ssl\nRUN ln -s /var/aegir/config/apache.conf /etc/apache2/conf-available/aegir.conf\nRUN ln -s /etc/apache2/conf-available/aegir.conf /etc/apache2/conf-enabled/aegir.conf\nRUN wget https://github.com/composer/composer/releases/download/$COMPOSER_VERSION/composer.phar -O - -q > /usr/local/bin/composer\nRUN wget https://github.com/drush-ops/drush/releases/download/$DRUSH_VERSION/drush.phar -O - -q > /usr/local/bin/drush\nRUN chmod +x /usr/local/bin/composer\nRUN chmod +x /usr/local/bin/drush\n#   Install fix-permissions and fix-ownership scripts\nRUN wget http://cgit.drupalcode.org/hosting_tasks_extra/plain/fix_permissions/scripts/standalone-install-fix-permissions-ownership.sh\nRUN bash standalone-install-fix-permissions-ownership.sh\n#   Copy files\nCOPY files/sudoers-aegir /etc/sudoers.d/aegir\nRUN chmod 0440 /etc/sudoers.d/aegir\nCOPY files/docker-entrypoint.sh /usr/local/bin/\nRUN chmod +x /usr/local/bin/docker-entrypoint.sh\nCOPY files/services-start.sh /usr/local/bin/services-start\nRUN chmod +x /usr/local/bin/services-start\nCOPY files/set-user-ids.sh /usr/local/bin/set-user-ids\nRUN chmod +x /usr/local/bin/set-user-ids\n#   Prepare Aegir Logs folder.\nRUN mkdir /var/log/aegir\nRUN chown aegir:aegir /var/log/aegir\nRUN echo 'Hello, Aegir.' > /var/log/aegir/system.log\n#   Don't install provision. Downstream tags will do this with the right version.\n#  # Install Provision for all.\nRUN mkdir -p /usr/share/drush/commands\nRUN drush dl --destination=/usr/share/drush/commands provision-$PROVISION_VERSION -y\nRUN drush dl --destination=/usr/share/drush/commands registry_rebuild-$REGISTRY_REBUILD_VERSION -y\n#   Setup SSH server.\nRUN sed 's@session\\s*required\\s*pam_loginuid.so@session optional pam_loginuid.so@g' -i /etc/pam.d/sshd\nENV NOTVISIBLE=\"\\\"in users profile\\\"\"\nRUN echo \"export VISIBLE=now\" >> /etc/profile\nEXPOSE 22/tcp\nUSER aegir\nRUN mkdir /var/aegir/config\nRUN mkdir /var/aegir/.drush\nRUN mkdir /var/aegir/projects\nRUN mkdir /var/aegir/.ssh\nRUN chmod 700 /var/aegir/.ssh\n#   You may change this environment at run time. User UID 1 is created with this email address.\nENV AEGIR_CLIENT_EMAIL=\"aegir@aegir.local.computer\"\nENV AEGIR_CLIENT_NAME=\"admin\"\nENV AEGIR_PROFILE=\"devmaster\"\nENV AEGIR_WORKING_COPY=\"0\"\n#   Must be fixed across versions so we can upgrade containers.\nENV AEGIR_HOSTMASTER_ROOT=\"/var/aegir/devmaster\"\n#   Build the devmaster stack\nRUN drush make $AEGIR_MAKEFILE $AEGIR_HOSTMASTER_ROOT\nWORKDIR /var/aegir\nVOLUME /var/lib/mysql\nEXPOSE 80/tcp\nEXPOSE 443/tcp\nEXPOSE 3306/tcp\n#   The Hostname of the database server to use\nENV AEGIR_DATABASE_SERVER=\"localhost\"\nENV HOME=\"/var/aegir\"\nVOLUME /var/aegir/projects\n#   docker-entrypoint.sh waits for mysql and runs hostmaster install\nENTRYPOINT [\"docker-entrypoint.sh\"]\nCMD [\"drush\", \"@hostmaster\", \"hosting-queued\"]\n","originalDockerfileUglifiedHash":"8bb35eb2b7615d6e8cf713d0ea76cbd1","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/ce3341c0e06955319a297c7a4a233d6d59e541ab.dockerfile"}