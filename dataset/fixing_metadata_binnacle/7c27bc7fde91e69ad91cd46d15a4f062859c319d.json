{"seed":2778004716,"processedDockerfileHash":"cb306e235cf83478335e2cb1f0a8be21","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM centos:7\n#   Download tools\nRUN yum -y install ca-certificates curl wget\nRUN yum -y install bzr git mercurial openssh subversion setup\n#   Build tools\nRUN yum -y install autoconf automake bzip2 bzip2-devel file gcc gcc-c++ glib2-devel glibc-devel ImageMagick ImageMagick-devel libcurl-devel libevent-devel libffi-devel libjpeg-devel libtool libwebp-devel libxml2-devel libxslt-devel libyaml-devel make mysql-devel ncurses-devel openssl-devel patch postgresql-devel readline-devel sqlite-devel xz xz-devel zlib-devel\n#   St2 package build debs\nRUN yum -y install openldap-devel\n#   Enable remote pubkey access\nRUN mkdir /root/.ssh \\\n && chmod 700 /root/.ssh \\\n && echo \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCdCmmPjsOBWRXc+PKdgDRrsciNjp25zTacyz8Gdkln2ma046brOYXAphhp/85DKgHtANBBt3cl4+HnpDbmAfyq2qZT7hWzAbMxtq0Sj+yyFyUdreXoe4gEKyxpV6o8p/R/XzEcawvqX/vFc5EIFmvTdamxZs9DQmOE5AZMzUB18Kerkrb0/arUcZ8iMi9Ng9a18avow+7oUFZ6Oub7ISz/dkIRojaKO/2paJZ4p+v7ZLn7Hq8TUeBkgAlx872oh8J8linhIq17zK6x4MGL8qiurp2hnfe0cuCxwcsYGy+4DfK51+E2vks6FprCIfF5hIdz26euPn67/YpM0F0b5nXF busybee@drone\" >> /root/.ssh/authorized_keys\n#   Create busybee credentials and make busybee pkey available for root\nCOPY busybee* /root/.ssh/\nRUN chmod 600 /root/.ssh/busybee\nRUN yum -y install openssh-server sudo \\\n && ssh-keygen -t rsa -N '' -f /etc/ssh/ssh_host_rsa_key\n#   1. small fix for SSH in ubuntu 13.10 (that's harmless everywhere else)\n#   2. permit root logins and set simple password password and pubkey\n#   3. change requiretty to !requiretty in /etc/sudoers\nRUN sed -ri 's/^session\\s+required\\s+pam_loginuid.so$/session optional pam_loginuid.so/' /etc/pam.d/sshd \\\n && sed -ri 's/^#?PermitRootLogin\\s+.*/PermitRootLogin yes/' /etc/ssh/sshd_config \\\n && sed -ri 's/^#?PubkeyAuthentication\\s+.*/PubkeyAuthentication yes/' /etc/ssh/sshd_config \\\n && sed -ri 's/requiretty/!requiretty/' /etc/sudoers \\\n && echo 'root:docker.io' | chpasswd\n#   Set default locale to 'UTF-8' for the test execution environment\n#   Per https://github.com/CentOS/sig-cloud-instance-images/issues/71\nRUN sed -ri 's/langs=en_US.UTF-8/langs=en_US.utf8/' /etc/yum.conf \\\n && yum reinstall -y glibc-common\nRUN yum -y install nc net-tools\nENV container=\"docker\"\nRUN yum -y update ; yum -y install systemd ; yum clean all\nRUN cd /lib/systemd/system/sysinit.target.wants/ ; ls -1 | grep -v systemd-tmpfiles-setup.service | xargs rm ; rm -f /etc/systemd/system/*.wants/* ; rm -f /lib/systemd/system/local-fs.target.wants/* ; rm -f /lib/systemd/system/sockets.target.wants/*udev* ; rm -f /lib/systemd/system/sockets.target.wants/*initctl* ; rm -f /lib/systemd/system/basic.target.wants/* ; rm -f /lib/systemd/system/anaconda.target.wants/* ; systemctl preset sshd\n#   we can have ssh\nEXPOSE 22/tcp\nVOLUME [ \"/sys/fs/cgroup\" ]\nCMD [\"/usr/sbin/init\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM centos:7\n#  Download tools\nRUN yum -y install ca-certificates curl wget\nRUN yum -y install bzr git mercurial openssh subversion setup\n#  Build tools\nRUN yum -y install autoconf automake bzip2 bzip2-devel file gcc gcc-c++ glib2-devel glibc-devel ImageMagick ImageMagick-devel libcurl-devel libevent-devel libffi-devel libjpeg-devel libtool libwebp-devel libxml2-devel libxslt-devel libyaml-devel make mysql-devel ncurses-devel openssl-devel patch postgresql-devel readline-devel sqlite-devel xz xz-devel zlib-devel\n#  St2 package build debs\nRUN yum -y install openldap-devel\n#  Enable remote pubkey access\nRUN mkdir /root/.ssh \\\n && chmod 700 /root/.ssh \\\n && echo \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCdCmmPjsOBWRXc+PKdgDRrsciNjp25zTacyz8Gdkln2ma046brOYXAphhp/85DKgHtANBBt3cl4+HnpDbmAfyq2qZT7hWzAbMxtq0Sj+yyFyUdreXoe4gEKyxpV6o8p/R/XzEcawvqX/vFc5EIFmvTdamxZs9DQmOE5AZMzUB18Kerkrb0/arUcZ8iMi9Ng9a18avow+7oUFZ6Oub7ISz/dkIRojaKO/2paJZ4p+v7ZLn7Hq8TUeBkgAlx872oh8J8linhIq17zK6x4MGL8qiurp2hnfe0cuCxwcsYGy+4DfK51+E2vks6FprCIfF5hIdz26euPn67/YpM0F0b5nXF busybee@drone\" >> /root/.ssh/authorized_keys\n#  Create busybee credentials and make busybee pkey available for root\nCOPY busybee* /root/.ssh/\nRUN chmod 600 /root/.ssh/busybee\nRUN yum -y install openssh-server sudo \\\n && ssh-keygen -t rsa -N '' -f /etc/ssh/ssh_host_rsa_key\n#  1. small fix for SSH in ubuntu 13.10 (that's harmless everywhere else)\n#  2. permit root logins and set simple password password and pubkey\n#  3. change requiretty to !requiretty in /etc/sudoers\nRUN sed -ri 's/^session\\s+required\\s+pam_loginuid.so$/session optional pam_loginuid.so/' /etc/pam.d/sshd \\\n && sed -ri 's/^#?PermitRootLogin\\s+.*/PermitRootLogin yes/' /etc/ssh/sshd_config \\\n && sed -ri 's/^#?PubkeyAuthentication\\s+.*/PubkeyAuthentication yes/' /etc/ssh/sshd_config \\\n && sed -ri 's/requiretty/!requiretty/' /etc/sudoers \\\n && echo 'root:docker.io' | chpasswd\n#  Set default locale to 'UTF-8' for the test execution environment\n#  Per https://github.com/CentOS/sig-cloud-instance-images/issues/71\nRUN sed -ri 's/langs=en_US.UTF-8/langs=en_US.utf8/' /etc/yum.conf \\\n && yum reinstall -y glibc-common\nRUN yum -y install nc net-tools\nENV container=\"docker\"\nRUN yum -y update ; yum -y install systemd ; yum clean all\nRUN cd /lib/systemd/system/sysinit.target.wants/ ; ls -1 | grep -v systemd-tmpfiles-setup.service | xargs rm ; rm -f /etc/systemd/system/*.wants/* ; rm -f /lib/systemd/system/local-fs.target.wants/* ; rm -f /lib/systemd/system/sockets.target.wants/*udev* ; rm -f /lib/systemd/system/sockets.target.wants/*initctl* ; rm -f /lib/systemd/system/basic.target.wants/* ; rm -f /lib/systemd/system/anaconda.target.wants/* ; systemctl preset sshd\n#  we can have ssh\nEXPOSE 22/tcp\nVOLUME [ \"/sys/fs/cgroup\" ]\nCMD [\"/usr/sbin/init\"]\n","injectedSmells":[],"originalDockerfileHash":"481dac4c4df2a224f7b69e13a594fcec","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM centos:7\n#   Download tools\nRUN yum -y install ca-certificates curl wget\nRUN yum -y install bzr git mercurial openssh subversion setup\n#   Build tools\nRUN yum -y install autoconf automake bzip2 bzip2-devel file gcc gcc-c++ glib2-devel glibc-devel ImageMagick ImageMagick-devel libcurl-devel libevent-devel libffi-devel libjpeg-devel libtool libwebp-devel libxml2-devel libxslt-devel libyaml-devel make mysql-devel ncurses-devel openssl-devel patch postgresql-devel readline-devel sqlite-devel xz xz-devel zlib-devel\n#   St2 package build debs\nRUN yum -y install openldap-devel\n#   Enable remote pubkey access\nRUN mkdir /root/.ssh \\\n && chmod 700 /root/.ssh \\\n && echo \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCdCmmPjsOBWRXc+PKdgDRrsciNjp25zTacyz8Gdkln2ma046brOYXAphhp/85DKgHtANBBt3cl4+HnpDbmAfyq2qZT7hWzAbMxtq0Sj+yyFyUdreXoe4gEKyxpV6o8p/R/XzEcawvqX/vFc5EIFmvTdamxZs9DQmOE5AZMzUB18Kerkrb0/arUcZ8iMi9Ng9a18avow+7oUFZ6Oub7ISz/dkIRojaKO/2paJZ4p+v7ZLn7Hq8TUeBkgAlx872oh8J8linhIq17zK6x4MGL8qiurp2hnfe0cuCxwcsYGy+4DfK51+E2vks6FprCIfF5hIdz26euPn67/YpM0F0b5nXF busybee@drone\" >> /root/.ssh/authorized_keys\n#   Create busybee credentials and make busybee pkey available for root\nCOPY busybee* /root/.ssh/\nRUN chmod 600 /root/.ssh/busybee\nRUN yum -y install openssh-server sudo \\\n && ssh-keygen -t rsa -N '' -f /etc/ssh/ssh_host_rsa_key\n#   1. small fix for SSH in ubuntu 13.10 (that's harmless everywhere else)\n#   2. permit root logins and set simple password password and pubkey\n#   3. change requiretty to !requiretty in /etc/sudoers\nRUN sed -ri 's/^session\\s+required\\s+pam_loginuid.so$/session optional pam_loginuid.so/' /etc/pam.d/sshd \\\n && sed -ri 's/^#?PermitRootLogin\\s+.*/PermitRootLogin yes/' /etc/ssh/sshd_config \\\n && sed -ri 's/^#?PubkeyAuthentication\\s+.*/PubkeyAuthentication yes/' /etc/ssh/sshd_config \\\n && sed -ri 's/requiretty/!requiretty/' /etc/sudoers \\\n && echo 'root:docker.io' | chpasswd\n#   Set default locale to 'UTF-8' for the test execution environment\n#   Per https://github.com/CentOS/sig-cloud-instance-images/issues/71\nRUN sed -ri 's/langs=en_US.UTF-8/langs=en_US.utf8/' /etc/yum.conf \\\n && yum reinstall -y glibc-common\nRUN yum -y install nc net-tools\nENV container=\"docker\"\nRUN yum -y update ; yum -y install systemd ; yum clean all\nRUN cd /lib/systemd/system/sysinit.target.wants/ ; ls -1 | grep -v systemd-tmpfiles-setup.service | xargs rm ; rm -f /etc/systemd/system/*.wants/* ; rm -f /lib/systemd/system/local-fs.target.wants/* ; rm -f /lib/systemd/system/sockets.target.wants/*udev* ; rm -f /lib/systemd/system/sockets.target.wants/*initctl* ; rm -f /lib/systemd/system/basic.target.wants/* ; rm -f /lib/systemd/system/anaconda.target.wants/* ; systemctl preset sshd\n#   we can have ssh\nEXPOSE 22/tcp\nVOLUME [ \"/sys/fs/cgroup\" ]\nCMD [\"/usr/sbin/init\"]\n","originalDockerfileUglifiedHash":"065a810589f1dffa61c12356cf1d51bb","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/7c27bc7fde91e69ad91cd46d15a4f062859c319d.dockerfile"}