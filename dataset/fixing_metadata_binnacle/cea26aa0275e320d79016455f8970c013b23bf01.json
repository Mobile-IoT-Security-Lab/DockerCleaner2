{"seed":2864584381,"processedDockerfileHash":"f50008878672f838f62e483f0964a674","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"#   Builds a base Docker image for Ubuntu with X Windows and VNC support.\n#\n#   The built image can be found at:\n#\n#     https://hub.docker.com/r/x11vnc/desktop\n#\n#   Authors:\n#   Xiangmin Jiao <xmjiao@gmail.com>\nFROM ubuntu:18.04\nLABEL maintainer=\"Xiangmin Jiao <xmjiao@gmail.com>\"\nARG DOCKER_LANG=en_US\nARG DOCKER_TIMEZONE=America/New_York\nENV LANG=\"$DOCKER_LANG.UTF-8\" \\\n    LANGUAGE=\"$DOCKER_LANG:UTF-8\" \\\n    LC_ALL=\"$DOCKER_LANG.UTF-8\"\nWORKDIR /tmp\nARG DEBIAN_FRONTEND=noninteractive\n#   Install some required system tools and packages for X Windows and ssh\nRUN : \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y --no-install-recommends apt-utils apt-file locales language-pack-en \\\n && locale-gen $LANG \\\n && dpkg-reconfigure -f noninteractive locales \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y --no-install-recommends curl less vim psmisc runit apt-transport-https ca-certificates software-properties-common man sudo rsync bsdtar net-tools gpg-agent inetutils-ping csh tcsh zsh build-essential libssl-dev git dos2unix openssh-server python python-tk python3-tk xserver-xorg-video-dummy lxde x11-xserver-utils xterm gnome-themes-standard gtk2-engines-pixbuf gtk2-engines-murrine libcanberra-gtk-module libcanberra-gtk3-module ttf-ubuntu-font-family xfonts-base xfonts-100dpi xfonts-75dpi xfonts-scalable xfonts-cyrillic libopengl0 mesa-utils libglu1-mesa libgl1-mesa-dri libjpeg8 libjpeg62 xauth x11vnc firefox xpdf \\\n && chmod 755 /usr/local/share/zsh/site-functions \\\n && apt-get -y autoremove \\\n && ssh-keygen -A \\\n && ln -s -f /lib64/ld-linux-x86-64.so.2 /lib64/ld-lsb-x86-64.so \\\n && perl -p -i -e 's/#?X11Forwarding\\s+\\w+/X11Forwarding yes/g; s/#?X11UseLocalhost\\s+\\w+/X11UseLocalhost no/g; s/#?PasswordAuthentication\\s+\\w+/PasswordAuthentication no/g; s/#?PermitEmptyPasswords\\s+\\w+/PermitEmptyPasswords no/g' /etc/ssh/sshd_config \\\n && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*\n#   Install websokify and noVNC\nRUN curl -O https://bootstrap.pypa.io/get-pip.py \\\n && python2 get-pip.py \\\n && pip2 install --no-cache-dir setuptools \\\n && pip2 install -U https://github.com/novnc/websockify/archive/master.tar.gz \\\n && mkdir /usr/local/noVNC \\\n && curl -s -L https://github.com/x11vnc/noVNC/archive/master.tar.gz | bsdtar zxf - -C /usr/local/noVNC --strip-components 1 \\\n && rm -rf /tmp/* /var/tmp/*\n#   Install x11vnc from source\n#   Install X-related to compile x11vnc from source code.\n#   https://bugs.launchpad.net/ubuntu/+source/x11vnc/+bug/1686084\nRUN apt-get update \\\n && (apt-get update ;apt-get install --no-install-recommends libxtst-dev=2:1.2.3-1 libssl-dev=1.1.1-1ubuntu2.1~18.04.21 libjpeg-dev=8c-2ubuntu8 -y ) \\\n && mkdir -p /tmp/x11vnc-0.9.14 \\\n && curl -s -L http://x11vnc.sourceforge.net/dev/x11vnc-0.9.14-dev.tar.gz | bsdtar zxf - -C /tmp/x11vnc-0.9.14 --strip-components 1 \\\n && cd /tmp/x11vnc-0.9.14 \\\n && ./configure --prefix=/usr/local CFLAGS='-O2 -fno-stack-protector -Wall' \\\n && make \\\n && make install \\\n && apt-get -y remove libxtst-dev libssl-dev libjpeg-dev \\\n && apt-get -y autoremove \\\n && ldconfig \\\n && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*\n#  #######################################################\n#   Customization for user and location\n#  #######################################################\n#   Set up user so that we do not run as root in DOCKER\nENV DOCKER_USER=\"ubuntu\" \\\n    DOCKER_UID=\"9999\" \\\n    DOCKER_GID=\"9999\" \\\n    DOCKER_SHELL=\"/bin/zsh\"\nENV DOCKER_GROUP=\"$DOCKER_USER\" \\\n    DOCKER_HOME=\"/home/$DOCKER_USER\" \\\n    SHELL=\"$DOCKER_SHELL\"\n#   Change the default timezone to $DOCKER_TIMEZONE\n#   Run ldconfig so that /usr/local/lib etc. are in the default\n#   search path for dynamic linker\nRUN groupadd -g $DOCKER_GID $DOCKER_GROUP \\\n && useradd -m -u $DOCKER_UID -g $DOCKER_GID -s $DOCKER_SHELL -G sudo $DOCKER_USER \\\n && echo \"$DOCKER_USER:\"`openssl rand -base64 12 ` | chpasswd \\\n && echo \"$DOCKER_USER ALL=(ALL) NOPASSWD: ALL\" >> /etc/sudoers \\\n && echo \"$DOCKER_TIMEZONE\" > /etc/timezone \\\n && ln -s -f /usr/share/zoneinfo/$DOCKER_TIMEZONE /etc/localtime\nCOPY image/etc /etc\nCOPY image/usr /usr\nCOPY image/sbin /sbin\nCOPY image/home $DOCKER_HOME\nRUN mkdir -p $DOCKER_HOME/.config/mozilla \\\n && ln -s -f .config/mozilla $DOCKER_HOME/.mozilla \\\n && touch $DOCKER_HOME/.sudo_as_admin_successful \\\n && mkdir -p $DOCKER_HOME/shared \\\n && mkdir -p $DOCKER_HOME/.ssh \\\n && mkdir -p $DOCKER_HOME/.log \\\n && touch $DOCKER_HOME/.log/vnc.log \\\n && chown -R $DOCKER_USER:$DOCKER_GROUP $DOCKER_HOME\nWORKDIR $DOCKER_HOME\nENV DOCKER_CMD=\"start_vnc\"\nUSER root\nENTRYPOINT [\"/sbin/my_init\", \"--quiet\", \"--\", \"/sbin/setuser\", \"ubuntu\"]\nCMD [\"$DOCKER_CMD\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  Builds a base Docker image for Ubuntu with X Windows and VNC support.\n#\n#  The built image can be found at:\n#\n#    https://hub.docker.com/r/x11vnc/desktop\n#\n#  Authors:\n#  Xiangmin Jiao <xmjiao@gmail.com>\nFROM ubuntu:18.04\nLABEL maintainer=\"Xiangmin Jiao <xmjiao@gmail.com>\"\nARG DOCKER_LANG=en_US\nARG DOCKER_TIMEZONE=America/New_York\nENV LANG=\"$DOCKER_LANG.UTF-8\" \\\n    LANGUAGE=\"$DOCKER_LANG:UTF-8\" \\\n    LC_ALL=\"$DOCKER_LANG.UTF-8\"\nWORKDIR /tmp\nARG DEBIAN_FRONTEND=noninteractive\n#  Install some required system tools and packages for X Windows and ssh\nRUN apt-get update \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y --no-install-recommends apt-utils apt-file locales language-pack-en \\\n && locale-gen $LANG \\\n && dpkg-reconfigure -f noninteractive locales \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y --no-install-recommends curl less vim psmisc runit apt-transport-https ca-certificates software-properties-common man sudo rsync bsdtar net-tools gpg-agent inetutils-ping csh tcsh zsh build-essential libssl-dev git dos2unix openssh-server python python-tk python3-tk xserver-xorg-video-dummy lxde x11-xserver-utils xterm gnome-themes-standard gtk2-engines-pixbuf gtk2-engines-murrine libcanberra-gtk-module libcanberra-gtk3-module ttf-ubuntu-font-family xfonts-base xfonts-100dpi xfonts-75dpi xfonts-scalable xfonts-cyrillic libopengl0 mesa-utils libglu1-mesa libgl1-mesa-dri libjpeg8 libjpeg62 xauth x11vnc firefox xpdf \\\n && chmod 755 /usr/local/share/zsh/site-functions \\\n && apt-get -y autoremove \\\n && ssh-keygen -A \\\n && ln -s -f /lib64/ld-linux-x86-64.so.2 /lib64/ld-lsb-x86-64.so \\\n && perl -p -i -e 's/#?X11Forwarding\\s+\\w+/X11Forwarding yes/g; s/#?X11UseLocalhost\\s+\\w+/X11UseLocalhost no/g; s/#?PasswordAuthentication\\s+\\w+/PasswordAuthentication no/g; s/#?PermitEmptyPasswords\\s+\\w+/PermitEmptyPasswords no/g' /etc/ssh/sshd_config \\\n && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*\n#  Install websokify and noVNC\nRUN curl -O https://bootstrap.pypa.io/get-pip.py \\\n && python2 get-pip.py \\\n && pip2 install --no-cache-dir setuptools \\\n && pip2 install -U https://github.com/novnc/websockify/archive/master.tar.gz \\\n && mkdir /usr/local/noVNC \\\n && curl -s -L https://github.com/x11vnc/noVNC/archive/master.tar.gz | bsdtar zxf - -C /usr/local/noVNC --strip-components 1 \\\n && rm -rf /tmp/* /var/tmp/*\n#  Install x11vnc from source\n#  Install X-related to compile x11vnc from source code.\n#  https://bugs.launchpad.net/ubuntu/+source/x11vnc/+bug/1686084\nRUN apt-get update \\\n && apt-get install libxtst-dev libssl-dev libjpeg-dev -y \\\n && mkdir -p /tmp/x11vnc-0.9.14 \\\n && curl -s -L http://x11vnc.sourceforge.net/dev/x11vnc-0.9.14-dev.tar.gz | bsdtar zxf - -C /tmp/x11vnc-0.9.14 --strip-components 1 \\\n && cd /tmp/x11vnc-0.9.14 \\\n && ./configure --prefix=/usr/local CFLAGS='-O2 -fno-stack-protector -Wall' \\\n && make \\\n && make install \\\n && apt-get -y remove libxtst-dev libssl-dev libjpeg-dev \\\n && apt-get -y autoremove \\\n && ldconfig \\\n && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*\n# #######################################################\n#  Customization for user and location\n# #######################################################\n#  Set up user so that we do not run as root in DOCKER\nENV DOCKER_USER=\"ubuntu\" \\\n    DOCKER_UID=\"9999\" \\\n    DOCKER_GID=\"9999\" \\\n    DOCKER_SHELL=\"/bin/zsh\"\nENV DOCKER_GROUP=\"$DOCKER_USER\" \\\n    DOCKER_HOME=\"/home/$DOCKER_USER\" \\\n    SHELL=\"$DOCKER_SHELL\"\n#  Change the default timezone to $DOCKER_TIMEZONE\n#  Run ldconfig so that /usr/local/lib etc. are in the default\n#  search path for dynamic linker\nRUN groupadd -g $DOCKER_GID $DOCKER_GROUP \\\n && useradd -m -u $DOCKER_UID -g $DOCKER_GID -s $DOCKER_SHELL -G sudo $DOCKER_USER \\\n && echo \"$DOCKER_USER:\"`openssl rand -base64 12 ` | chpasswd \\\n && echo \"$DOCKER_USER ALL=(ALL) NOPASSWD: ALL\" >> /etc/sudoers \\\n && echo \"$DOCKER_TIMEZONE\" > /etc/timezone \\\n && ln -s -f /usr/share/zoneinfo/$DOCKER_TIMEZONE /etc/localtime\nADD image/etc /etc\nADD image/usr /usr\nADD image/sbin /sbin\nADD image/home $DOCKER_HOME\nRUN mkdir -p $DOCKER_HOME/.config/mozilla \\\n && ln -s -f .config/mozilla $DOCKER_HOME/.mozilla \\\n && touch $DOCKER_HOME/.sudo_as_admin_successful \\\n && mkdir -p $DOCKER_HOME/shared \\\n && mkdir -p $DOCKER_HOME/.ssh \\\n && mkdir -p $DOCKER_HOME/.log \\\n && touch $DOCKER_HOME/.log/vnc.log \\\n && chown -R $DOCKER_USER:$DOCKER_GROUP $DOCKER_HOME\nWORKDIR $DOCKER_HOME\nENV DOCKER_CMD=\"start_vnc\"\nUSER root\nENTRYPOINT [\"/sbin/my_init\", \"--quiet\", \"--\", \"/sbin/setuser\", \"ubuntu\"]\nCMD [\"$DOCKER_CMD\"]\n","injectedSmells":[],"originalDockerfileHash":"4f6ef5b526a5f160b6efaa63aabe16bd","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   Builds a base Docker image for Ubuntu with X Windows and VNC support.\n#\n#   The built image can be found at:\n#\n#     https://hub.docker.com/r/x11vnc/desktop\n#\n#   Authors:\n#   Xiangmin Jiao <xmjiao@gmail.com>\nFROM ubuntu:18.04\nLABEL maintainer=\"Xiangmin Jiao <xmjiao@gmail.com>\"\nARG DOCKER_LANG=en_US\nARG DOCKER_TIMEZONE=America/New_York\nENV LANG=\"$DOCKER_LANG.UTF-8\" \\\n    LANGUAGE=\"$DOCKER_LANG:UTF-8\" \\\n    LC_ALL=\"$DOCKER_LANG.UTF-8\"\nWORKDIR /tmp\nARG DEBIAN_FRONTEND=noninteractive\n#   Install some required system tools and packages for X Windows and ssh\nRUN apt-get update \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y --no-install-recommends apt-utils apt-file locales language-pack-en \\\n && locale-gen $LANG \\\n && dpkg-reconfigure -f noninteractive locales \\\n && DEBIAN_FRONTEND=noninteractive apt-get install -y --no-install-recommends curl less vim psmisc runit apt-transport-https ca-certificates software-properties-common man sudo rsync bsdtar net-tools gpg-agent inetutils-ping csh tcsh zsh build-essential libssl-dev git dos2unix openssh-server python python-tk python3-tk xserver-xorg-video-dummy lxde x11-xserver-utils xterm gnome-themes-standard gtk2-engines-pixbuf gtk2-engines-murrine libcanberra-gtk-module libcanberra-gtk3-module ttf-ubuntu-font-family xfonts-base xfonts-100dpi xfonts-75dpi xfonts-scalable xfonts-cyrillic libopengl0 mesa-utils libglu1-mesa libgl1-mesa-dri libjpeg8 libjpeg62 xauth x11vnc firefox xpdf \\\n && chmod 755 /usr/local/share/zsh/site-functions \\\n && apt-get -y autoremove \\\n && ssh-keygen -A \\\n && ln -s -f /lib64/ld-linux-x86-64.so.2 /lib64/ld-lsb-x86-64.so \\\n && perl -p -i -e 's/#?X11Forwarding\\s+\\w+/X11Forwarding yes/g; s/#?X11UseLocalhost\\s+\\w+/X11UseLocalhost no/g; s/#?PasswordAuthentication\\s+\\w+/PasswordAuthentication no/g; s/#?PermitEmptyPasswords\\s+\\w+/PermitEmptyPasswords no/g' /etc/ssh/sshd_config \\\n && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*\n#   Install websokify and noVNC\nRUN curl -O https://bootstrap.pypa.io/get-pip.py \\\n && python2 get-pip.py \\\n && pip2 install --no-cache-dir setuptools \\\n && pip2 install -U https://github.com/novnc/websockify/archive/master.tar.gz \\\n && mkdir /usr/local/noVNC \\\n && curl -s -L https://github.com/x11vnc/noVNC/archive/master.tar.gz | bsdtar zxf - -C /usr/local/noVNC --strip-components 1 \\\n && rm -rf /tmp/* /var/tmp/*\n#   Install x11vnc from source\n#   Install X-related to compile x11vnc from source code.\n#   https://bugs.launchpad.net/ubuntu/+source/x11vnc/+bug/1686084\nRUN apt-get update \\\n && apt-get install libxtst-dev libssl-dev libjpeg-dev -y \\\n && mkdir -p /tmp/x11vnc-0.9.14 \\\n && curl -s -L http://x11vnc.sourceforge.net/dev/x11vnc-0.9.14-dev.tar.gz | bsdtar zxf - -C /tmp/x11vnc-0.9.14 --strip-components 1 \\\n && cd /tmp/x11vnc-0.9.14 \\\n && ./configure --prefix=/usr/local CFLAGS='-O2 -fno-stack-protector -Wall' \\\n && make \\\n && make install \\\n && apt-get -y remove libxtst-dev libssl-dev libjpeg-dev \\\n && apt-get -y autoremove \\\n && ldconfig \\\n && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*\n#  #######################################################\n#   Customization for user and location\n#  #######################################################\n#   Set up user so that we do not run as root in DOCKER\nENV DOCKER_USER=\"ubuntu\" \\\n    DOCKER_UID=\"9999\" \\\n    DOCKER_GID=\"9999\" \\\n    DOCKER_SHELL=\"/bin/zsh\"\nENV DOCKER_GROUP=\"$DOCKER_USER\" \\\n    DOCKER_HOME=\"/home/$DOCKER_USER\" \\\n    SHELL=\"$DOCKER_SHELL\"\n#   Change the default timezone to $DOCKER_TIMEZONE\n#   Run ldconfig so that /usr/local/lib etc. are in the default\n#   search path for dynamic linker\nRUN groupadd -g $DOCKER_GID $DOCKER_GROUP \\\n && useradd -m -u $DOCKER_UID -g $DOCKER_GID -s $DOCKER_SHELL -G sudo $DOCKER_USER \\\n && echo \"$DOCKER_USER:\"`openssl rand -base64 12 ` | chpasswd \\\n && echo \"$DOCKER_USER ALL=(ALL) NOPASSWD: ALL\" >> /etc/sudoers \\\n && echo \"$DOCKER_TIMEZONE\" > /etc/timezone \\\n && ln -s -f /usr/share/zoneinfo/$DOCKER_TIMEZONE /etc/localtime\nADD image/etc /etc\nADD image/usr /usr\nADD image/sbin /sbin\nADD image/home $DOCKER_HOME\nRUN mkdir -p $DOCKER_HOME/.config/mozilla \\\n && ln -s -f .config/mozilla $DOCKER_HOME/.mozilla \\\n && touch $DOCKER_HOME/.sudo_as_admin_successful \\\n && mkdir -p $DOCKER_HOME/shared \\\n && mkdir -p $DOCKER_HOME/.ssh \\\n && mkdir -p $DOCKER_HOME/.log \\\n && touch $DOCKER_HOME/.log/vnc.log \\\n && chown -R $DOCKER_USER:$DOCKER_GROUP $DOCKER_HOME\nWORKDIR $DOCKER_HOME\nENV DOCKER_CMD=\"start_vnc\"\nUSER root\nENTRYPOINT [\"/sbin/my_init\", \"--quiet\", \"--\", \"/sbin/setuser\", \"ubuntu\"]\nCMD [\"$DOCKER_CMD\"]\n","originalDockerfileUglifiedHash":"1f0c9a46d69366c0b942d2f74b5364d1","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/cea26aa0275e320d79016455f8970c013b23bf01.dockerfile"}