{"seed":3619251823,"processedDockerfileHash":"450a576dc06da1dd22f8bc3d10aeddcf","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["do-not-use-apt-get-update-alone","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"#   -*- coding: utf-8 -*-\n#\n#   This file is covered by the LICENSING file in the root of this project.\n#\n#  ## Dockerfile for guacamole\n#  ## Includes all the optional authentication modules preinstalled\nFROM phusion/baseimage:0.9.15\n#  ## based on Randy hall's hall/guacamole\nMAINTAINER Ice Shi \nCMD [\"/sbin/my_init\"]\nENV HOME=\"/root\"\nENV DEBIAN_FRONTEND=\"noninteractive\"\n#  ## Don't let apt install docs or man pages\n#     ADD excludes /etc/dpkg/dpkg.cfg.d/excludes\n#  ## Update system\nRUN :\n#  ## Install packages and clean up in one command to reduce build size\nRUN (apt-get update ;apt-get install --no-install-recommends libcairo2-dev libpng12-dev freerdp-x11 libssh2-1 libfreerdp-dev libvorbis-dev libssl0.9.8 gcc libssh-dev libpulse-dev tomcat7 tomcat7-admin libpango1.0-dev libssh2-1-dev autoconf wget libossp-uuid-dev libtelnet-dev libvncserver-dev build-essential -y ) \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* /usr/share/man /usr/share/groff /usr/share/info /usr/share/lintian /usr/share/linda /var/cache/man \\\n && ((find /usr/share/doc -depth -type f ! -name copyright | xargs rm || true ) ) \\\n && ((find /usr/share/doc -empty | xargs rmdir || true ) )\n#  ## Install the authentication extensions in the classpath folder\n#  ## and the client app in the tomcat webapp folder\n#  ## Version of guacamole to be installed\nENV GUAC_VER=\"0.9.6\"\n#  ## Version of mysql-connector-java to install\nENV MCJ_VER=\"5.1.35\"\n#  ## config directory and classpath directory\nRUN mkdir -p /etc/guacamole /var/lib/guacamole/classpath\n#  ## Install LDAP Authentication extension\nRUN cd /tmp \\\n && wget -q --span-hosts http://downloads.sourceforge.net/project/guacamole/current/extensions/guacamole-auth-ldap-${GUAC_VER}.tar.gz \\\n && tar -zxf guacamole-auth-ldap-$GUAC_VER.tar.gz \\\n && mv -f `find . -type f -name '*.jar' ` /var/lib/guacamole/classpath \\\n && rm -Rf /tmp/*\n#  ## Install NOAUTH Authentication extension\nRUN cd /tmp \\\n && wget -q --span-hosts http://downloads.sourceforge.net/project/guacamole/current/extensions/guacamole-auth-noauth-${GUAC_VER}.tar.gz \\\n && tar -zxf guacamole-auth-noauth-$GUAC_VER.tar.gz \\\n && mv -f `find . -type f -name '*.jar' ` /var/lib/guacamole/classpath \\\n && rm -Rf /tmp/*\n#  ## Install MySQL Authentication Module\nRUN cd /tmp \\\n && wget -q --span-hosts http://downloads.sourceforge.net/project/guacamole/current/extensions/guacamole-auth-mysql-${GUAC_VER}.tar.gz \\\n && tar -zxf guacamole-auth-mysql-$GUAC_VER.tar.gz \\\n && mv -f `find . -type f -name '*.jar' ` /var/lib/guacamole/classpath \\\n && mv -f guacamole-auth-mysql-$GUAC_VER/schema/*.sql /root \\\n && rm -Rf /tmp/*\n#  ## Install dependancies for mysql authentication module\nRUN cd /tmp \\\n && wget -q --span-hosts http://dev.mysql.com/get/Downloads/Connector-J/mysql-connector-java-${MCJ_VER}.tar.gz \\\n && tar -zxf mysql-connector-java-$MCJ_VER.tar.gz \\\n && mv -f `find . -type f -name '*.jar' ` /var/lib/guacamole/classpath \\\n && rm -Rf /tmp/*\n#  ## Install precompiled client webapp\nRUN cd /var/lib/tomcat7/webapps \\\n && rm -Rf ROOT \\\n && wget -q --span-hosts http://sourceforge.net/projects/guacamole/files/current/binary/guacamole-${GUAC_VER}.war \\\n && ln -s guacamole-$GUAC_VER.war ROOT.war \\\n && ln -s guacamole-$GUAC_VER.war guacamole.war\n#  ## Compile and install guacamole server\nRUN cd /tmp \\\n && wget -q --span-hosts http://sourceforge.net/projects/guacamole/files/current/source/guacamole-server-${GUAC_VER}.tar.gz \\\n && tar -zxf guacamole-server-$GUAC_VER.tar.gz \\\n && cd guacamole-server-$GUAC_VER \\\n && ./configure --with-init-dir=/etc/init.d \\\n && make \\\n && make install \\\n && update-rc.d guacd defaults \\\n && ldconfig \\\n && cd /usr/share/tomcat7 \\\n && ln -s /etc/guacamole .guacamole \\\n && rm -Rf /tmp/*\n#  ## Install HMAC Authentication module\n#     Installed as precompiled jar so the container doesn't get bloated\n#\n#     get clone https://github.com/grncdr/guacamole-auth-hmac.git\n#     cd guacamole-auth-hmac\n#     mvn package\n#     cp target/guacamole-auth-hmac-1.0-SNAPSHOT.jar /var/lib/tomcat7/webapps\n#  ## ADD guacamole-auth-hmac-1.0-SNAPSHOT.jar /var/lib/guacamole/classpath/guacamole-auth-hmac-1.0-SNAPSHOT.jar\n#  ## Configure Service Startup\nCOPY rc.local /etc/rc.local\nRUN chmod a+x /etc/rc.local\n#  ## Disable SSH in the container\n#     rm -rf /etc/service/sshd /etc/my_init.d/00_regen_ssh_host_keys.sh\n#  ## END\n#  ## To make this a functional guacamole container, you must map /etc/guacamole of this container\n#  ## To a folder on your host machine.  You can also build a new container based on this one\n#  ## adding your config files directly inside your new container.  See the sampleconfigs directory\n#  ## for examples.\n#  ##\n#  ## This container is used as a base for\n#  ## hall/guacamole-guacd - Runs only the guqcd daemon and exports the ports to other containers\n#  ## hall/guacamole-mysql - Links to hall/quacamole-guacd, stackbrew/mysql and stores the config\n#  ##                        database in a persistent container.\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  -*- coding: utf-8 -*-\n#\n#  This file is covered by the LICENSING file in the root of this project.\n#\n# ## Dockerfile for guacamole\n# ## Includes all the optional authentication modules preinstalled\nFROM phusion/baseimage:0.9.15\n# ## based on Randy hall's hall/guacamole\nMAINTAINER Ice Shi \nCMD [\"/sbin/my_init\"]\nENV HOME=\"/root\"\nENV DEBIAN_FRONTEND=\"noninteractive\"\n# ## Don't let apt install docs or man pages\n#    ADD excludes /etc/dpkg/dpkg.cfg.d/excludes\n# ## Update system\nRUN apt-get update\n# ## Install packages and clean up in one command to reduce build size\nRUN apt-get install --no-install-recommends libcairo2-dev libpng12-dev freerdp-x11 libssh2-1 libfreerdp-dev libvorbis-dev libssl0.9.8 gcc libssh-dev libpulse-dev tomcat7 tomcat7-admin libpango1.0-dev libssh2-1-dev autoconf wget libossp-uuid-dev libtelnet-dev libvncserver-dev build-essential -y \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* /usr/share/man /usr/share/groff /usr/share/info /usr/share/lintian /usr/share/linda /var/cache/man \\\n && ((find /usr/share/doc -depth -type f ! -name copyright | xargs rm || true ) ) \\\n && ((find /usr/share/doc -empty | xargs rmdir || true ) )\n# ## Install the authentication extensions in the classpath folder\n# ## and the client app in the tomcat webapp folder\n# ## Version of guacamole to be installed\nENV GUAC_VER=\"0.9.6\"\n# ## Version of mysql-connector-java to install\nENV MCJ_VER=\"5.1.35\"\n# ## config directory and classpath directory\nRUN mkdir -p /etc/guacamole /var/lib/guacamole/classpath\n# ## Install LDAP Authentication extension\nRUN cd /tmp \\\n && wget -q --span-hosts http://downloads.sourceforge.net/project/guacamole/current/extensions/guacamole-auth-ldap-${GUAC_VER}.tar.gz \\\n && tar -zxf guacamole-auth-ldap-$GUAC_VER.tar.gz \\\n && mv -f `find . -type f -name '*.jar' ` /var/lib/guacamole/classpath \\\n && rm -Rf /tmp/*\n# ## Install NOAUTH Authentication extension\nRUN cd /tmp \\\n && wget -q --span-hosts http://downloads.sourceforge.net/project/guacamole/current/extensions/guacamole-auth-noauth-${GUAC_VER}.tar.gz \\\n && tar -zxf guacamole-auth-noauth-$GUAC_VER.tar.gz \\\n && mv -f `find . -type f -name '*.jar' ` /var/lib/guacamole/classpath \\\n && rm -Rf /tmp/*\n# ## Install MySQL Authentication Module\nRUN cd /tmp \\\n && wget -q --span-hosts http://downloads.sourceforge.net/project/guacamole/current/extensions/guacamole-auth-mysql-${GUAC_VER}.tar.gz \\\n && tar -zxf guacamole-auth-mysql-$GUAC_VER.tar.gz \\\n && mv -f `find . -type f -name '*.jar' ` /var/lib/guacamole/classpath \\\n && mv -f guacamole-auth-mysql-$GUAC_VER/schema/*.sql /root \\\n && rm -Rf /tmp/*\n# ## Install dependancies for mysql authentication module\nRUN cd /tmp \\\n && wget -q --span-hosts http://dev.mysql.com/get/Downloads/Connector-J/mysql-connector-java-${MCJ_VER}.tar.gz \\\n && tar -zxf mysql-connector-java-$MCJ_VER.tar.gz \\\n && mv -f `find . -type f -name '*.jar' ` /var/lib/guacamole/classpath \\\n && rm -Rf /tmp/*\n# ## Install precompiled client webapp\nRUN cd /var/lib/tomcat7/webapps \\\n && rm -Rf ROOT \\\n && wget -q --span-hosts http://sourceforge.net/projects/guacamole/files/current/binary/guacamole-${GUAC_VER}.war \\\n && ln -s guacamole-$GUAC_VER.war ROOT.war \\\n && ln -s guacamole-$GUAC_VER.war guacamole.war\n# ## Compile and install guacamole server\nRUN cd /tmp \\\n && wget -q --span-hosts http://sourceforge.net/projects/guacamole/files/current/source/guacamole-server-${GUAC_VER}.tar.gz \\\n && tar -zxf guacamole-server-$GUAC_VER.tar.gz \\\n && cd guacamole-server-$GUAC_VER \\\n && ./configure --with-init-dir=/etc/init.d \\\n && make \\\n && make install \\\n && update-rc.d guacd defaults \\\n && ldconfig \\\n && cd /usr/share/tomcat7 \\\n && ln -s /etc/guacamole .guacamole \\\n && rm -Rf /tmp/*\n# ## Install HMAC Authentication module\n#    Installed as precompiled jar so the container doesn't get bloated\n#\n#    get clone https://github.com/grncdr/guacamole-auth-hmac.git\n#    cd guacamole-auth-hmac\n#    mvn package\n#    cp target/guacamole-auth-hmac-1.0-SNAPSHOT.jar /var/lib/tomcat7/webapps\n# ## ADD guacamole-auth-hmac-1.0-SNAPSHOT.jar /var/lib/guacamole/classpath/guacamole-auth-hmac-1.0-SNAPSHOT.jar\n# ## Configure Service Startup\nADD rc.local /etc/rc.local\nRUN chmod a+x /etc/rc.local\n# ## Disable SSH in the container\n#    rm -rf /etc/service/sshd /etc/my_init.d/00_regen_ssh_host_keys.sh\n# ## END\n# ## To make this a functional guacamole container, you must map /etc/guacamole of this container\n# ## To a folder on your host machine.  You can also build a new container based on this one\n# ## adding your config files directly inside your new container.  See the sampleconfigs directory\n# ## for examples.\n# ##\n# ## This container is used as a base for\n# ## hall/guacamole-guacd - Runs only the guqcd daemon and exports the ports to other containers\n# ## hall/guacamole-mysql - Links to hall/quacamole-guacd, stackbrew/mysql and stores the config\n# ##                        database in a persistent container.\n","injectedSmells":[],"originalDockerfileHash":"4807282f1f99b5bfb7bb50b7d7b9666f","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   -*- coding: utf-8 -*-\n#\n#   This file is covered by the LICENSING file in the root of this project.\n#\n#  ## Dockerfile for guacamole\n#  ## Includes all the optional authentication modules preinstalled\nFROM phusion/baseimage:0.9.15\n#  ## based on Randy hall's hall/guacamole\nMAINTAINER Ice Shi \nCMD [\"/sbin/my_init\"]\nENV HOME=\"/root\"\nENV DEBIAN_FRONTEND=\"noninteractive\"\n#  ## Don't let apt install docs or man pages\n#     ADD excludes /etc/dpkg/dpkg.cfg.d/excludes\n#  ## Update system\nRUN apt-get update\n#  ## Install packages and clean up in one command to reduce build size\nRUN apt-get install --no-install-recommends libcairo2-dev libpng12-dev freerdp-x11 libssh2-1 libfreerdp-dev libvorbis-dev libssl0.9.8 gcc libssh-dev libpulse-dev tomcat7 tomcat7-admin libpango1.0-dev libssh2-1-dev autoconf wget libossp-uuid-dev libtelnet-dev libvncserver-dev build-essential -y \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* /usr/share/man /usr/share/groff /usr/share/info /usr/share/lintian /usr/share/linda /var/cache/man \\\n && ((find /usr/share/doc -depth -type f ! -name copyright | xargs rm || true ) ) \\\n && ((find /usr/share/doc -empty | xargs rmdir || true ) )\n#  ## Install the authentication extensions in the classpath folder\n#  ## and the client app in the tomcat webapp folder\n#  ## Version of guacamole to be installed\nENV GUAC_VER=\"0.9.6\"\n#  ## Version of mysql-connector-java to install\nENV MCJ_VER=\"5.1.35\"\n#  ## config directory and classpath directory\nRUN mkdir -p /etc/guacamole /var/lib/guacamole/classpath\n#  ## Install LDAP Authentication extension\nRUN cd /tmp \\\n && wget -q --span-hosts http://downloads.sourceforge.net/project/guacamole/current/extensions/guacamole-auth-ldap-${GUAC_VER}.tar.gz \\\n && tar -zxf guacamole-auth-ldap-$GUAC_VER.tar.gz \\\n && mv -f `find . -type f -name '*.jar' ` /var/lib/guacamole/classpath \\\n && rm -Rf /tmp/*\n#  ## Install NOAUTH Authentication extension\nRUN cd /tmp \\\n && wget -q --span-hosts http://downloads.sourceforge.net/project/guacamole/current/extensions/guacamole-auth-noauth-${GUAC_VER}.tar.gz \\\n && tar -zxf guacamole-auth-noauth-$GUAC_VER.tar.gz \\\n && mv -f `find . -type f -name '*.jar' ` /var/lib/guacamole/classpath \\\n && rm -Rf /tmp/*\n#  ## Install MySQL Authentication Module\nRUN cd /tmp \\\n && wget -q --span-hosts http://downloads.sourceforge.net/project/guacamole/current/extensions/guacamole-auth-mysql-${GUAC_VER}.tar.gz \\\n && tar -zxf guacamole-auth-mysql-$GUAC_VER.tar.gz \\\n && mv -f `find . -type f -name '*.jar' ` /var/lib/guacamole/classpath \\\n && mv -f guacamole-auth-mysql-$GUAC_VER/schema/*.sql /root \\\n && rm -Rf /tmp/*\n#  ## Install dependancies for mysql authentication module\nRUN cd /tmp \\\n && wget -q --span-hosts http://dev.mysql.com/get/Downloads/Connector-J/mysql-connector-java-${MCJ_VER}.tar.gz \\\n && tar -zxf mysql-connector-java-$MCJ_VER.tar.gz \\\n && mv -f `find . -type f -name '*.jar' ` /var/lib/guacamole/classpath \\\n && rm -Rf /tmp/*\n#  ## Install precompiled client webapp\nRUN cd /var/lib/tomcat7/webapps \\\n && rm -Rf ROOT \\\n && wget -q --span-hosts http://sourceforge.net/projects/guacamole/files/current/binary/guacamole-${GUAC_VER}.war \\\n && ln -s guacamole-$GUAC_VER.war ROOT.war \\\n && ln -s guacamole-$GUAC_VER.war guacamole.war\n#  ## Compile and install guacamole server\nRUN cd /tmp \\\n && wget -q --span-hosts http://sourceforge.net/projects/guacamole/files/current/source/guacamole-server-${GUAC_VER}.tar.gz \\\n && tar -zxf guacamole-server-$GUAC_VER.tar.gz \\\n && cd guacamole-server-$GUAC_VER \\\n && ./configure --with-init-dir=/etc/init.d \\\n && make \\\n && make install \\\n && update-rc.d guacd defaults \\\n && ldconfig \\\n && cd /usr/share/tomcat7 \\\n && ln -s /etc/guacamole .guacamole \\\n && rm -Rf /tmp/*\n#  ## Install HMAC Authentication module\n#     Installed as precompiled jar so the container doesn't get bloated\n#\n#     get clone https://github.com/grncdr/guacamole-auth-hmac.git\n#     cd guacamole-auth-hmac\n#     mvn package\n#     cp target/guacamole-auth-hmac-1.0-SNAPSHOT.jar /var/lib/tomcat7/webapps\n#  ## ADD guacamole-auth-hmac-1.0-SNAPSHOT.jar /var/lib/guacamole/classpath/guacamole-auth-hmac-1.0-SNAPSHOT.jar\n#  ## Configure Service Startup\nADD rc.local /etc/rc.local\nRUN chmod a+x /etc/rc.local\n#  ## Disable SSH in the container\n#     rm -rf /etc/service/sshd /etc/my_init.d/00_regen_ssh_host_keys.sh\n#  ## END\n#  ## To make this a functional guacamole container, you must map /etc/guacamole of this container\n#  ## To a folder on your host machine.  You can also build a new container based on this one\n#  ## adding your config files directly inside your new container.  See the sampleconfigs directory\n#  ## for examples.\n#  ##\n#  ## This container is used as a base for\n#  ## hall/guacamole-guacd - Runs only the guqcd daemon and exports the ports to other containers\n#  ## hall/guacamole-mysql - Links to hall/quacamole-guacd, stackbrew/mysql and stores the config\n#  ##                        database in a persistent container.\n","originalDockerfileUglifiedHash":"4503434fa1dfe9f8e37e0e2fb497111b","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/ffca243bf86a75a529432654ee2d8ad79381daf8.dockerfile"}