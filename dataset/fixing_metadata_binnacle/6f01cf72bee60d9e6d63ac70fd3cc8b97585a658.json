{"seed":1804789420,"processedDockerfileHash":"333094d23adbc23addbcc4080508df8c","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","have-a-healthcheck","have-a-user"],"processedDockerfile":"#\n#   Dockerfile for WordPress\n#\nFROM appsvcorg/nginx-fpm:php7.2.13\nMAINTAINER Azure App Service Container Images <appsvc-images@microsoft.com>\n#   ========\n#   ENV vars\n#   ========\n#   ssh\nENV SSH_PASSWD=\"\\\"root:Docker!\\\"\"\n#  nginx\nENV NGINX_VERSION=\"1.14.0\"\nENV NGINX_LOG_DIR=\"\\\"/home/LogFiles/nginx\\\"\"\n#  php\nENV PHP_HOME=\"\\\"/usr/local/etc/php\\\"\"\nENV PHP_CONF_DIR=\"$PHP_HOME\"\nENV PHP_CONF_FILE=\"$PHP_CONF_DIR\\\"/php.ini\\\"\"\n#   mariadb\nENV MARIADB_DATA_DIR=\"\\\"/home/data/mysql\\\"\"\nENV MARIADB_LOG_DIR=\"\\\"/home/LogFiles/mysql\\\"\"\n#   phpmyadmin\nENV PHPMYADMIN_SOURCE=\"\\\"/usr/src/phpmyadmin\\\"\"\nENV PHPMYADMIN_HOME=\"\\\"/home/phpmyadmin\\\"\"\n#   redis\nENV PHPREDIS_VERSION=\"3.1.2\"\n#   wordpress\nENV WORDPRESS_SOURCE=\"\\\"/usr/src/wordpress\\\"\"\nENV WORDPRESS_HOME=\"\\\"/home/site/wwwroot\\\"\"\n#\nENV DOCKER_BUILD_HOME=\"\\\"/dockerbuild\\\"\"\n#   ====================\n#   Download and Install\n#   ~. tools\n#   1. redis\n#   2. wordpress\n#   ====================\nWORKDIR $DOCKER_BUILD_HOME\nRUN set -ex \\\n && apk update \\\n && apk add redis --no-cache \\\n && curl -O https://raw.githubusercontent.com/wp-cli/builds/gh-pages/phar/wp-cli.phar \\\n && chmod +x wp-cli.phar \\\n && mv wp-cli.phar /usr/local/bin/wp \\\n && docker-php-source extract \\\n && curl -L -o /tmp/redis.tar.gz https://github.com/phpredis/phpredis/archive/$PHPREDIS_VERSION.tar.gz \\\n && tar xfz /tmp/redis.tar.gz \\\n && rm -r /tmp/redis.tar.gz \\\n && mv phpredis-$PHPREDIS_VERSION /usr/src/php/ext/redis \\\n && apk add libjpeg-turbo-dev libpng-dev --no-cache --virtual .build-deps \\\n && docker-php-ext-configure gd --with-png-dir=/usr --with-jpeg-dir=/usr \\\n && docker-php-ext-install gd zip redis \\\n && runDeps=\"$( scanelf --needed --nobanner --format '%n#p' --recursive /usr/local/lib/php/extensions | tr ',' '\\n' | sort -u | awk 'system(\"[ -e /usr/local/lib/\" $1 \" ]\") == 0 { next } { print \"so:\" $1 }' ;)\" \\\n && apk add $runDeps --virtual .wordpress-phpexts-rundeps \\\n && apk del .build-deps \\\n && docker-php-source delete \\\n && mkdir -p $WORDPRESS_SOURCE \\\n && apk update \\\n && apk upgrade \\\n && rm -rf /var/cache/apk/* \\\n && rm -rf /tmp/*\n#   =========\n#   Configure\n#   =========\n#   nginx\nCOPY nginx.conf /etc/nginx/nginx.conf\nCOPY default.conf /etc/nginx/conf.d/default.conf\n#   =====\n#   final\n#   =====\nCOPY wp-config.php $WORDPRESS_SOURCE/\nCOPY uploads.ini /usr/local/etc/php/conf.d/uploads.ini\n#   phpmyadmin\nCOPY phpmyadmin-default.conf $PHPMYADMIN_SOURCE/phpmyadmin-default.conf\n#   nginx\nCOPY spec-settings.conf /etc/nginx/conf.d/spec-settings.conf\nCOPY entrypoint.sh /usr/local/bin/\nRUN chmod +x /usr/local/bin/entrypoint.sh\nEXPOSE 2222/tcp 80/tcp\nENTRYPOINT [\"entrypoint.sh\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#\n#  Dockerfile for WordPress\n#\nFROM appsvcorg/nginx-fpm:php7.2.13\nMAINTAINER Azure App Service Container Images <appsvc-images@microsoft.com>\n#  ========\n#  ENV vars\n#  ========\n#  ssh\nENV SSH_PASSWD=\"\\\"root:Docker!\\\"\"\n# nginx\nENV NGINX_VERSION=\"1.14.0\"\nENV NGINX_LOG_DIR=\"\\\"/home/LogFiles/nginx\\\"\"\n# php\nENV PHP_HOME=\"\\\"/usr/local/etc/php\\\"\"\nENV PHP_CONF_DIR=\"$PHP_HOME\"\nENV PHP_CONF_FILE=\"$PHP_CONF_DIR\\\"/php.ini\\\"\"\n#  mariadb\nENV MARIADB_DATA_DIR=\"\\\"/home/data/mysql\\\"\"\nENV MARIADB_LOG_DIR=\"\\\"/home/LogFiles/mysql\\\"\"\n#  phpmyadmin\nENV PHPMYADMIN_SOURCE=\"\\\"/usr/src/phpmyadmin\\\"\"\nENV PHPMYADMIN_HOME=\"\\\"/home/phpmyadmin\\\"\"\n#  redis\nENV PHPREDIS_VERSION=\"3.1.2\"\n#  wordpress\nENV WORDPRESS_SOURCE=\"\\\"/usr/src/wordpress\\\"\"\nENV WORDPRESS_HOME=\"\\\"/home/site/wwwroot\\\"\"\n#\nENV DOCKER_BUILD_HOME=\"\\\"/dockerbuild\\\"\"\n#  ====================\n#  Download and Install\n#  ~. tools\n#  1. redis\n#  2. wordpress\n#  ====================\nWORKDIR $DOCKER_BUILD_HOME\nRUN set -ex \\\n && apk update \\\n && apk add --no-cache redis \\\n && curl -O https://raw.githubusercontent.com/wp-cli/builds/gh-pages/phar/wp-cli.phar \\\n && chmod +x wp-cli.phar \\\n && mv wp-cli.phar /usr/local/bin/wp \\\n && docker-php-source extract \\\n && curl -L -o /tmp/redis.tar.gz https://github.com/phpredis/phpredis/archive/$PHPREDIS_VERSION.tar.gz \\\n && tar xfz /tmp/redis.tar.gz \\\n && rm -r /tmp/redis.tar.gz \\\n && mv phpredis-$PHPREDIS_VERSION /usr/src/php/ext/redis \\\n && apk add --no-cache --virtual .build-deps libjpeg-turbo-dev libpng-dev \\\n && docker-php-ext-configure gd --with-png-dir=/usr --with-jpeg-dir=/usr \\\n && docker-php-ext-install gd zip redis \\\n && runDeps=\"$( scanelf --needed --nobanner --format '%n#p' --recursive /usr/local/lib/php/extensions | tr ',' '\\n' | sort -u | awk 'system(\"[ -e /usr/local/lib/\" $1 \" ]\") == 0 { next } { print \"so:\" $1 }' ;)\" \\\n && apk add --virtual .wordpress-phpexts-rundeps $runDeps \\\n && apk del .build-deps \\\n && docker-php-source delete \\\n && mkdir -p $WORDPRESS_SOURCE \\\n && apk update \\\n && apk upgrade \\\n && rm -rf /var/cache/apk/* \\\n && rm -rf /tmp/*\n#  =========\n#  Configure\n#  =========\n#  nginx\nCOPY nginx.conf /etc/nginx/nginx.conf\nCOPY default.conf /etc/nginx/conf.d/default.conf\n#  =====\n#  final\n#  =====\nCOPY wp-config.php $WORDPRESS_SOURCE/\nCOPY uploads.ini /usr/local/etc/php/conf.d/uploads.ini\n#  phpmyadmin\nCOPY phpmyadmin-default.conf $PHPMYADMIN_SOURCE/phpmyadmin-default.conf\n#  nginx\nCOPY spec-settings.conf /etc/nginx/conf.d/spec-settings.conf\nCOPY entrypoint.sh /usr/local/bin/\nRUN chmod +x /usr/local/bin/entrypoint.sh\nEXPOSE 2222/tcp 80/tcp\nENTRYPOINT [\"entrypoint.sh\"]\n","injectedSmells":[],"originalDockerfileHash":"29b53a1de86532026c8d47e36b92e6ac","successfullyInjectedSmells":[],"originalDockerfileUglified":"#\n#   Dockerfile for WordPress\n#\nFROM appsvcorg/nginx-fpm:php7.2.13\nMAINTAINER Azure App Service Container Images <appsvc-images@microsoft.com>\n#   ========\n#   ENV vars\n#   ========\n#   ssh\nENV SSH_PASSWD=\"\\\"root:Docker!\\\"\"\n#  nginx\nENV NGINX_VERSION=\"1.14.0\"\nENV NGINX_LOG_DIR=\"\\\"/home/LogFiles/nginx\\\"\"\n#  php\nENV PHP_HOME=\"\\\"/usr/local/etc/php\\\"\"\nENV PHP_CONF_DIR=\"$PHP_HOME\"\nENV PHP_CONF_FILE=\"$PHP_CONF_DIR\\\"/php.ini\\\"\"\n#   mariadb\nENV MARIADB_DATA_DIR=\"\\\"/home/data/mysql\\\"\"\nENV MARIADB_LOG_DIR=\"\\\"/home/LogFiles/mysql\\\"\"\n#   phpmyadmin\nENV PHPMYADMIN_SOURCE=\"\\\"/usr/src/phpmyadmin\\\"\"\nENV PHPMYADMIN_HOME=\"\\\"/home/phpmyadmin\\\"\"\n#   redis\nENV PHPREDIS_VERSION=\"3.1.2\"\n#   wordpress\nENV WORDPRESS_SOURCE=\"\\\"/usr/src/wordpress\\\"\"\nENV WORDPRESS_HOME=\"\\\"/home/site/wwwroot\\\"\"\n#\nENV DOCKER_BUILD_HOME=\"\\\"/dockerbuild\\\"\"\n#   ====================\n#   Download and Install\n#   ~. tools\n#   1. redis\n#   2. wordpress\n#   ====================\nWORKDIR $DOCKER_BUILD_HOME\nRUN set -ex \\\n && apk update \\\n && apk add --no-cache redis \\\n && curl -O https://raw.githubusercontent.com/wp-cli/builds/gh-pages/phar/wp-cli.phar \\\n && chmod +x wp-cli.phar \\\n && mv wp-cli.phar /usr/local/bin/wp \\\n && docker-php-source extract \\\n && curl -L -o /tmp/redis.tar.gz https://github.com/phpredis/phpredis/archive/$PHPREDIS_VERSION.tar.gz \\\n && tar xfz /tmp/redis.tar.gz \\\n && rm -r /tmp/redis.tar.gz \\\n && mv phpredis-$PHPREDIS_VERSION /usr/src/php/ext/redis \\\n && apk add --no-cache --virtual .build-deps libjpeg-turbo-dev libpng-dev \\\n && docker-php-ext-configure gd --with-png-dir=/usr --with-jpeg-dir=/usr \\\n && docker-php-ext-install gd zip redis \\\n && runDeps=\"$( scanelf --needed --nobanner --format '%n#p' --recursive /usr/local/lib/php/extensions | tr ',' '\\n' | sort -u | awk 'system(\"[ -e /usr/local/lib/\" $1 \" ]\") == 0 { next } { print \"so:\" $1 }' ;)\" \\\n && apk add --virtual .wordpress-phpexts-rundeps $runDeps \\\n && apk del .build-deps \\\n && docker-php-source delete \\\n && mkdir -p $WORDPRESS_SOURCE \\\n && apk update \\\n && apk upgrade \\\n && rm -rf /var/cache/apk/* \\\n && rm -rf /tmp/*\n#   =========\n#   Configure\n#   =========\n#   nginx\nCOPY nginx.conf /etc/nginx/nginx.conf\nCOPY default.conf /etc/nginx/conf.d/default.conf\n#   =====\n#   final\n#   =====\nCOPY wp-config.php $WORDPRESS_SOURCE/\nCOPY uploads.ini /usr/local/etc/php/conf.d/uploads.ini\n#   phpmyadmin\nCOPY phpmyadmin-default.conf $PHPMYADMIN_SOURCE/phpmyadmin-default.conf\n#   nginx\nCOPY spec-settings.conf /etc/nginx/conf.d/spec-settings.conf\nCOPY entrypoint.sh /usr/local/bin/\nRUN chmod +x /usr/local/bin/entrypoint.sh\nEXPOSE 2222/tcp 80/tcp\nENTRYPOINT [\"entrypoint.sh\"]\n","originalDockerfileUglifiedHash":"4658e240f093cca2321099d5c0883117","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/6f01cf72bee60d9e6d63ac70fd3cc8b97585a658.dockerfile"}