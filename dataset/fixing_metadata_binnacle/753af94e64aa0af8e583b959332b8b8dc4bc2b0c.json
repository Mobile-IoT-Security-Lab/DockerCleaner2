{"seed":3189274979,"processedDockerfileHash":"099a0d8c0c7ad51986e6229cc248f712","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM alpine:3.4\nMAINTAINER mail@racktear.com\nRUN addgroup -S tarantool \\\n && adduser -S -G tarantool tarantool \\\n && apk add 'su-exec>=0.2' --no-cache\nENV TARANTOOL_VERSION=\"1.5.5.27\" \\\n    TARANTOOL_DOWNLOAD_URL=\"https://github.com/tarantool/tarantool.git\" \\\n    TARANTOOL_COMMIT=\"1687c022e7aa93e9c118e1b80e1eac6c429b1010\" \\\n    TARANTOOL_INSTALL_LUADIR=\"/usr/local/share/tarantool\" \\\n    LUAROCKS_URL=\"http://keplerproject.github.io/luarocks/releases/luarocks-2.3.0.tar.gz\" \\\n    TARANTOOL_SNAP_DIR=\"/var/lib/tarantool\" \\\n    TARANTOOL_WAL_DIR=\"/var/lib/tarantool\" \\\n    TARANTOOL_PORT=\"3301\" \\\n    TARANTOOL_ADMIN_PORT=\"3302\"\nRUN set -x \\\n && apk add libstdc++=5.3.0-r0 readline=6.3.008-r4 openssl=1.0.2n-r0 yaml=0.1.6-r1 lz4=131-r0 binutils=2.26-r1 ncurses=6.0_p20171125-r0 libgomp=5.3.0-r0 lua=5.1.5-r4 curl=7.60.0-r1 tar=1.29-r1 zip=3.0-r4 mariadb-client-libs=10.1.32-r0 libpq=9.5.13-r0 mariadb-libs=10.1.32-r0 --no-cache --virtual .run-deps \\\n && apk add perl=5.22.3-r0 gcc=5.3.0-r0 g++=5.3.0-r0 cmake=3.5.2-r0 readline-dev=6.3.008-r4 openssl-dev=1.0.2n-r0 yaml-dev=0.1.6-r1 lz4-dev=131-r0 binutils-dev=2.26-r1 ncurses-dev=6.0_p20171125-r0 lua-dev=5.1.5-r4 musl-dev=1.1.14-r16 make=4.1-r1 git=2.8.6-r0 postgresql-dev=9.5.13-r0 lua-dev=5.1.5-r4 mariadb-dev=10.1.32-r0 wget=1.18-r3 --no-cache --virtual .build-deps \\\n && : \"---------- tarantool ----------\" \\\n && mkdir -p /usr/src/tarantool \\\n && git clone \"$TARANTOOL_DOWNLOAD_URL\" /usr/src/tarantool \\\n && git -C /usr/src/tarantool checkout \"$TARANTOOL_COMMIT\" \\\n && git -C /usr/src/tarantool submodule init \\\n && git -C /usr/src/tarantool submodule update \\\n && echo \"$TARANTOOL_VERSION\" > /usr/src/tarantool/VERSION \\\n && (cd /usr/src/tarantool ;cmake -DENABLE_CLIENT:BOOL=ON -DWITH_MYSQL:BOOL=ON -DWITH_POSTGRESQL:BOOL=ON -DCMAKE_BUILD_TYPE=RelWithDebInfo -DENABLE_BUNDLED_LIBYAML:BOOL=OFF -DENABLE_BACKTRACE:BOOL=ON . ) \\\n && make -C /usr/src/tarantool -j \\\n && make -C /usr/src/tarantool install \\\n && make -C /usr/src/tarantool clean \\\n && : \"---------- luarocks ----------\" \\\n && wget -O luarocks.tar.gz \"$LUAROCKS_URL\" \\\n && mkdir -p /usr/src/luarocks \\\n && tar -xzf luarocks.tar.gz -C /usr/src/luarocks --strip-components=1 \\\n && (cd /usr/src/luarocks ;./configure ;make build ;make install ) \\\n && rm -r /usr/src/luarocks \\\n && rm -rf /usr/src/tarantool \\\n && : \"---------- remove build deps ----------\" \\\n && apk del .build-deps\nCOPY luarocks-config.lua /usr/local/etc/luarocks/config-5.1.lua\nRUN mkdir -p /var/lib/tarantool \\\n && chown tarantool:tarantool /var/lib/tarantool \\\n && mkdir -p /opt/tarantool \\\n && chown tarantool:tarantool /opt/tarantool \\\n && mkdir -p /var/run/tarantool \\\n && chown tarantool:tarantool /var/run/tarantool \\\n && mkdir /etc/tarantool \\\n && chown tarantool:tarantool /etc/tarantool\nVOLUME /var/lib/tarantool\nWORKDIR /opt/tarantool\nCOPY docker-entrypoint.sh /usr/local/bin/\nRUN ln -s /usr/local/bin/docker-entrypoint.sh /entrypoint.sh\nENTRYPOINT [\"docker-entrypoint.sh\"]\nEXPOSE 3301/tcp\nCMD [\"tarantool_box\", \"-c\", \"/etc/tarantool/tarantool.cfg\"]\nRUN addgroup -S docker-user ; adduser -S -G docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM alpine:3.4\nMAINTAINER mail@racktear.com\nRUN addgroup -S tarantool \\\n && adduser -S -G tarantool tarantool \\\n && apk add --no-cache 'su-exec>=0.2'\nENV TARANTOOL_VERSION=\"1.5.5.27\" \\\n    TARANTOOL_DOWNLOAD_URL=\"https://github.com/tarantool/tarantool.git\" \\\n    TARANTOOL_COMMIT=\"1687c022e7aa93e9c118e1b80e1eac6c429b1010\" \\\n    TARANTOOL_INSTALL_LUADIR=\"/usr/local/share/tarantool\" \\\n    LUAROCKS_URL=\"http://keplerproject.github.io/luarocks/releases/luarocks-2.3.0.tar.gz\" \\\n    TARANTOOL_SNAP_DIR=\"/var/lib/tarantool\" \\\n    TARANTOOL_WAL_DIR=\"/var/lib/tarantool\" \\\n    TARANTOOL_PORT=\"3301\" \\\n    TARANTOOL_ADMIN_PORT=\"3302\"\nRUN set -x \\\n && apk add --no-cache --virtual .run-deps libstdc++ readline openssl yaml lz4 binutils ncurses libgomp lua curl tar zip mariadb-client-libs libpq mariadb-libs \\\n && apk add --no-cache --virtual .build-deps perl gcc g++ cmake readline-dev openssl-dev yaml-dev lz4-dev binutils-dev ncurses-dev lua-dev musl-dev make git postgresql-dev lua-dev mariadb-dev wget \\\n && : \"---------- tarantool ----------\" \\\n && mkdir -p /usr/src/tarantool \\\n && git clone \"$TARANTOOL_DOWNLOAD_URL\" /usr/src/tarantool \\\n && git -C /usr/src/tarantool checkout \"$TARANTOOL_COMMIT\" \\\n && git -C /usr/src/tarantool submodule init \\\n && git -C /usr/src/tarantool submodule update \\\n && echo \"$TARANTOOL_VERSION\" > /usr/src/tarantool/VERSION \\\n && (cd /usr/src/tarantool ;cmake -DENABLE_CLIENT:BOOL=ON -DWITH_MYSQL:BOOL=ON -DWITH_POSTGRESQL:BOOL=ON -DCMAKE_BUILD_TYPE=RelWithDebInfo -DENABLE_BUNDLED_LIBYAML:BOOL=OFF -DENABLE_BACKTRACE:BOOL=ON . ) \\\n && make -C /usr/src/tarantool -j \\\n && make -C /usr/src/tarantool install \\\n && make -C /usr/src/tarantool clean \\\n && : \"---------- luarocks ----------\" \\\n && wget -O luarocks.tar.gz \"$LUAROCKS_URL\" \\\n && mkdir -p /usr/src/luarocks \\\n && tar -xzf luarocks.tar.gz -C /usr/src/luarocks --strip-components=1 \\\n && (cd /usr/src/luarocks ;./configure ;make build ;make install ) \\\n && rm -r /usr/src/luarocks \\\n && rm -rf /usr/src/tarantool \\\n && : \"---------- remove build deps ----------\" \\\n && apk del .build-deps\nCOPY luarocks-config.lua /usr/local/etc/luarocks/config-5.1.lua\nRUN mkdir -p /var/lib/tarantool \\\n && chown tarantool:tarantool /var/lib/tarantool \\\n && mkdir -p /opt/tarantool \\\n && chown tarantool:tarantool /opt/tarantool \\\n && mkdir -p /var/run/tarantool \\\n && chown tarantool:tarantool /var/run/tarantool \\\n && mkdir /etc/tarantool \\\n && chown tarantool:tarantool /etc/tarantool\nVOLUME /var/lib/tarantool\nWORKDIR /opt/tarantool\nCOPY docker-entrypoint.sh /usr/local/bin/\nRUN ln -s /usr/local/bin/docker-entrypoint.sh /entrypoint.sh\nENTRYPOINT [\"docker-entrypoint.sh\"]\nEXPOSE 3301/tcp\nCMD [\"tarantool_box\", \"-c\", \"/etc/tarantool/tarantool.cfg\"]\n","injectedSmells":[],"originalDockerfileHash":"689ecdb05cf8ea343918fd9fbe187963","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM alpine:3.4\nMAINTAINER mail@racktear.com\nRUN addgroup -S tarantool \\\n && adduser -S -G tarantool tarantool \\\n && apk add --no-cache 'su-exec>=0.2'\nENV TARANTOOL_VERSION=\"1.5.5.27\" \\\n    TARANTOOL_DOWNLOAD_URL=\"https://github.com/tarantool/tarantool.git\" \\\n    TARANTOOL_COMMIT=\"1687c022e7aa93e9c118e1b80e1eac6c429b1010\" \\\n    TARANTOOL_INSTALL_LUADIR=\"/usr/local/share/tarantool\" \\\n    LUAROCKS_URL=\"http://keplerproject.github.io/luarocks/releases/luarocks-2.3.0.tar.gz\" \\\n    TARANTOOL_SNAP_DIR=\"/var/lib/tarantool\" \\\n    TARANTOOL_WAL_DIR=\"/var/lib/tarantool\" \\\n    TARANTOOL_PORT=\"3301\" \\\n    TARANTOOL_ADMIN_PORT=\"3302\"\nRUN set -x \\\n && apk add --no-cache --virtual .run-deps libstdc++ readline openssl yaml lz4 binutils ncurses libgomp lua curl tar zip mariadb-client-libs libpq mariadb-libs \\\n && apk add --no-cache --virtual .build-deps perl gcc g++ cmake readline-dev openssl-dev yaml-dev lz4-dev binutils-dev ncurses-dev lua-dev musl-dev make git postgresql-dev lua-dev mariadb-dev wget \\\n && : \"---------- tarantool ----------\" \\\n && mkdir -p /usr/src/tarantool \\\n && git clone \"$TARANTOOL_DOWNLOAD_URL\" /usr/src/tarantool \\\n && git -C /usr/src/tarantool checkout \"$TARANTOOL_COMMIT\" \\\n && git -C /usr/src/tarantool submodule init \\\n && git -C /usr/src/tarantool submodule update \\\n && echo \"$TARANTOOL_VERSION\" > /usr/src/tarantool/VERSION \\\n && (cd /usr/src/tarantool ;cmake -DENABLE_CLIENT:BOOL=ON -DWITH_MYSQL:BOOL=ON -DWITH_POSTGRESQL:BOOL=ON -DCMAKE_BUILD_TYPE=RelWithDebInfo -DENABLE_BUNDLED_LIBYAML:BOOL=OFF -DENABLE_BACKTRACE:BOOL=ON . ) \\\n && make -C /usr/src/tarantool -j \\\n && make -C /usr/src/tarantool install \\\n && make -C /usr/src/tarantool clean \\\n && : \"---------- luarocks ----------\" \\\n && wget -O luarocks.tar.gz \"$LUAROCKS_URL\" \\\n && mkdir -p /usr/src/luarocks \\\n && tar -xzf luarocks.tar.gz -C /usr/src/luarocks --strip-components=1 \\\n && (cd /usr/src/luarocks ;./configure ;make build ;make install ) \\\n && rm -r /usr/src/luarocks \\\n && rm -rf /usr/src/tarantool \\\n && : \"---------- remove build deps ----------\" \\\n && apk del .build-deps\nCOPY luarocks-config.lua /usr/local/etc/luarocks/config-5.1.lua\nRUN mkdir -p /var/lib/tarantool \\\n && chown tarantool:tarantool /var/lib/tarantool \\\n && mkdir -p /opt/tarantool \\\n && chown tarantool:tarantool /opt/tarantool \\\n && mkdir -p /var/run/tarantool \\\n && chown tarantool:tarantool /var/run/tarantool \\\n && mkdir /etc/tarantool \\\n && chown tarantool:tarantool /etc/tarantool\nVOLUME /var/lib/tarantool\nWORKDIR /opt/tarantool\nCOPY docker-entrypoint.sh /usr/local/bin/\nRUN ln -s /usr/local/bin/docker-entrypoint.sh /entrypoint.sh\nENTRYPOINT [\"docker-entrypoint.sh\"]\nEXPOSE 3301/tcp\nCMD [\"tarantool_box\", \"-c\", \"/etc/tarantool/tarantool.cfg\"]\n","originalDockerfileUglifiedHash":"689ecdb05cf8ea343918fd9fbe187963","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/753af94e64aa0af8e583b959332b8b8dc4bc2b0c.dockerfile"}