{"seed":4013431212,"processedDockerfileHash":"edc9cd7e3ae4630031fd91059ef79a96","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apt-get","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM ubuntu:18.04\nLABEL maintainer=\"Huan LI <zixia@zixia.net>\"\nENV DEBIAN_FRONTEND=\"noninteractive\"\nENV WECHATY_DOCKER=\"1\"\nENV LC_ALL=\"C.UTF-8\"\nENV NODE_ENV=\"$NODE_ENV\"\nENV NPM_CONFIG_LOGLEVEL=\"warn\"\n#   Installing the 'apt-utils' package gets rid of the 'debconf: delaying package configuration, since apt-utils is not installed'\n#   error message when installing any other package with the apt-get package manager.\n#   https://peteris.rocks/blog/quiet-and-unattended-installation-with-apt-get/\nRUN apt-get update \\\n && apt-get install --no-install-recommends apt-utils=1.6.14 bash=4.4.18-2ubuntu1.3 build-essential=12.4ubuntu1 ca-certificates=20211016ubuntu0.18.04.1 curl=7.58.0-2ubuntu3.24 coreutils=8.28-1ubuntu1 ffmpeg=7:3.4.11-0ubuntu0.1 figlet=2.2.5-3 git=1:2.17.1-1ubuntu0.17 gnupg2=2.2.4-1ubuntu1.6 jq=1.5+dfsg-2 libgconf-2-4=3.2.6-4ubuntu1 moreutils=0.60-1 python-dev=2.7.15~rc1-1 shellcheck=0.4.6-1 sudo=1.8.21p2-3ubuntu1.5 tzdata=2022g-0ubuntu0.18.04 vim=2:8.0.1453-1ubuntu1.11 wget=1.19.4-1ubuntu2.2 -y \\\n && apt-get purge --auto-remove \\\n && rm -rf /tmp/* /var/lib/apt/lists/*\nRUN curl -sL https://deb.nodesource.com/setup_10.x | sudo -E bash - \\\n && apt-get update \\\n && apt-get install --no-install-recommends nodejs=8.10.0~dfsg-2ubuntu0.4 -y \\\n && apt-get purge --auto-remove \\\n && rm -rf /tmp/* /var/lib/apt/lists/*\n#   https://github.com/GoogleChrome/puppeteer/blob/master/docs/troubleshooting.md\n#   https://github.com/ebidel/try-puppeteer/blob/master/backend/Dockerfile\n#   Install latest chrome dev package.\n#   Note: this also installs the necessary libs so we don't need the previous RUN command.\nRUN wget -q -O - https://dl-ssl.google.com/linux/linux_signing_key.pub | apt-key add - \\\n && sh -c 'echo \"deb [arch=amd64] http://dl.google.com/linux/chrome/deb/ stable main\" >> /etc/apt/sources.list.d/google.list' \\\n && apt-get update \\\n && apt-get install --no-install-recommends google-chrome-unstable -y \\\n && apt-get purge --auto-remove \\\n && rm -rf /tmp/* /var/lib/apt/lists/* \\\n && rm -rf /usr/bin/google-chrome* /opt/google/chrome-unstable\nRUN mkdir /wechaty /node_modules\nWORKDIR /wechaty\nCOPY package.json .\nRUN npm install \\\n && sudo rm -fr /tmp/* ~/.npm\nCOPY . .\n#   Pre-Install All Puppets\nRUN npm run puppet-install \\\n && sudo rm -fr /tmp/* ~/.npm\n#   RUN npm run test:debug\nRUN npm test\nRUN npm run dist\n#   Loading from node_modules Folders: https://nodejs.org/api/modules.html\n#   If it is not found there, then it moves to the parent directory, and so on, until the root of the file system is reached.\nRUN sudo mkdir /bot \\\n && npm link \\\n && sudo ln -sfv /usr/lib/node_modules/* /node_modules/ \\\n && sudo ln -sfv /wechaty/node_modules/* /node_modules/ \\\n && sudo ln -sfv /wechaty/tsconfig.json / \\\n && echo 'Linked Wechaty to Global'\nENTRYPOINT [\"/wechaty/bin/entrypoint.sh\"]\nCMD []\n#\n#   https://docs.docker.com/docker-cloud/builds/advanced/\n#   http://label-schema.org/rc1/\n#\nLABEL org.label-schema.license=\"Apache-2.0\" \\\n      org.label-schema.build-date=\"$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" \\\n      org.label-schema.version=\"$DOCKER_TAG\" \\\n      org.label-schema.schema-version=\"$(wechaty-version)\" \\\n      org.label-schema.name=\"Wechaty\" \\\n      org.label-schema.description=\"Wechat for Bot\" \\\n      org.label-schema.usage=\"https://github.com/chatie/wechaty/wiki/Docker\" \\\n      org.label-schema.url=\"https://www.chatie.io\" \\\n      org.label-schema.vendor=\"Chatie\" \\\n      org.label-schema.vcs-ref=\"$SOURCE_COMMIT\" \\\n      org.label-schema.vcs-url=\"https://github.com/chatie/wechaty\" \\\n      org.label-schema.docker.cmd=\"docker run -ti --rm zixia/wechaty <code.js>\" \\\n      org.label-schema.docker.cmd.test=\"docker run -ti --rm zixia/wechaty test\" \\\n      org.label-schema.docker.cmd.help=\"docker run -ti --rm zixia/wechaty help\" \\\n      org.label-schema.docker.params=\"WECHATY_TOKEN=token token from https://www.chatie.io, WECHATY_LOG=verbose Set Verbose Log, TZ='Asia/Shanghai' TimeZone\"\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM ubuntu:18.04\nLABEL maintainer=\"Huan LI <zixia@zixia.net>\"\nENV DEBIAN_FRONTEND=\"noninteractive\"\nENV WECHATY_DOCKER=\"1\"\nENV LC_ALL=\"C.UTF-8\"\nENV NODE_ENV=\"$NODE_ENV\"\nENV NPM_CONFIG_LOGLEVEL=\"warn\"\n#  Installing the 'apt-utils' package gets rid of the 'debconf: delaying package configuration, since apt-utils is not installed'\n#  error message when installing any other package with the apt-get package manager.\n#  https://peteris.rocks/blog/quiet-and-unattended-installation-with-apt-get/\nRUN apt-get update \\\n && apt-get install --no-install-recommends apt-utils bash build-essential ca-certificates curl coreutils ffmpeg figlet git gnupg2 jq libgconf-2-4 moreutils python-dev shellcheck sudo tzdata vim wget -y \\\n && apt-get purge --auto-remove \\\n && rm -rf /tmp/* /var/lib/apt/lists/*\nRUN curl -sL https://deb.nodesource.com/setup_10.x | sudo -E bash - \\\n && apt-get update \\\n && apt-get install --no-install-recommends nodejs -y \\\n && apt-get purge --auto-remove \\\n && rm -rf /tmp/* /var/lib/apt/lists/*\n#  https://github.com/GoogleChrome/puppeteer/blob/master/docs/troubleshooting.md\n#  https://github.com/ebidel/try-puppeteer/blob/master/backend/Dockerfile\n#  Install latest chrome dev package.\n#  Note: this also installs the necessary libs so we don't need the previous RUN command.\nRUN wget -q -O - https://dl-ssl.google.com/linux/linux_signing_key.pub | apt-key add - \\\n && sh -c 'echo \"deb [arch=amd64] http://dl.google.com/linux/chrome/deb/ stable main\" >> /etc/apt/sources.list.d/google.list' \\\n && apt-get update \\\n && apt-get install --no-install-recommends google-chrome-unstable -y \\\n && apt-get purge --auto-remove \\\n && rm -rf /tmp/* /var/lib/apt/lists/* \\\n && rm -rf /usr/bin/google-chrome* /opt/google/chrome-unstable\nRUN mkdir /wechaty /node_modules\nWORKDIR /wechaty\nCOPY package.json .\nRUN npm install \\\n && sudo rm -fr /tmp/* ~/.npm\nCOPY . .\n#  Pre-Install All Puppets\nRUN npm run puppet-install \\\n && sudo rm -fr /tmp/* ~/.npm\n#  RUN npm run test:debug\nRUN npm test\nRUN npm run dist\n#  Loading from node_modules Folders: https://nodejs.org/api/modules.html\n#  If it is not found there, then it moves to the parent directory, and so on, until the root of the file system is reached.\nRUN sudo mkdir /bot \\\n && npm link \\\n && sudo ln -sfv /usr/lib/node_modules/* /node_modules/ \\\n && sudo ln -sfv /wechaty/node_modules/* /node_modules/ \\\n && sudo ln -sfv /wechaty/tsconfig.json / \\\n && echo 'Linked Wechaty to Global'\nENTRYPOINT [\"/wechaty/bin/entrypoint.sh\"]\nCMD []\n#\n#  https://docs.docker.com/docker-cloud/builds/advanced/\n#  http://label-schema.org/rc1/\n#\nLABEL org.label-schema.license=\"Apache-2.0\" \\\n      org.label-schema.build-date=\"$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" \\\n      org.label-schema.version=\"$DOCKER_TAG\" \\\n      org.label-schema.schema-version=\"$(wechaty-version)\" \\\n      org.label-schema.name=\"Wechaty\" \\\n      org.label-schema.description=\"Wechat for Bot\" \\\n      org.label-schema.usage=\"https://github.com/chatie/wechaty/wiki/Docker\" \\\n      org.label-schema.url=\"https://www.chatie.io\" \\\n      org.label-schema.vendor=\"Chatie\" \\\n      org.label-schema.vcs-ref=\"$SOURCE_COMMIT\" \\\n      org.label-schema.vcs-url=\"https://github.com/chatie/wechaty\" \\\n      org.label-schema.docker.cmd=\"docker run -ti --rm zixia/wechaty <code.js>\" \\\n      org.label-schema.docker.cmd.test=\"docker run -ti --rm zixia/wechaty test\" \\\n      org.label-schema.docker.cmd.help=\"docker run -ti --rm zixia/wechaty help\" \\\n      org.label-schema.docker.params=\"WECHATY_TOKEN=token token from https://www.chatie.io, WECHATY_LOG=verbose Set Verbose Log, TZ='Asia/Shanghai' TimeZone\"\n","injectedSmells":[],"originalDockerfileHash":"e63814b60d4b833a721884c8ef3819ac","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM ubuntu:18.04\nLABEL maintainer=\"Huan LI <zixia@zixia.net>\"\nENV DEBIAN_FRONTEND=\"noninteractive\"\nENV WECHATY_DOCKER=\"1\"\nENV LC_ALL=\"C.UTF-8\"\nENV NODE_ENV=\"$NODE_ENV\"\nENV NPM_CONFIG_LOGLEVEL=\"warn\"\n#   Installing the 'apt-utils' package gets rid of the 'debconf: delaying package configuration, since apt-utils is not installed'\n#   error message when installing any other package with the apt-get package manager.\n#   https://peteris.rocks/blog/quiet-and-unattended-installation-with-apt-get/\nRUN apt-get update \\\n && apt-get install --no-install-recommends apt-utils bash build-essential ca-certificates curl coreutils ffmpeg figlet git gnupg2 jq libgconf-2-4 moreutils python-dev shellcheck sudo tzdata vim wget -y \\\n && apt-get purge --auto-remove \\\n && rm -rf /tmp/* /var/lib/apt/lists/*\nRUN curl -sL https://deb.nodesource.com/setup_10.x | sudo -E bash - \\\n && apt-get update \\\n && apt-get install --no-install-recommends nodejs -y \\\n && apt-get purge --auto-remove \\\n && rm -rf /tmp/* /var/lib/apt/lists/*\n#   https://github.com/GoogleChrome/puppeteer/blob/master/docs/troubleshooting.md\n#   https://github.com/ebidel/try-puppeteer/blob/master/backend/Dockerfile\n#   Install latest chrome dev package.\n#   Note: this also installs the necessary libs so we don't need the previous RUN command.\nRUN wget -q -O - https://dl-ssl.google.com/linux/linux_signing_key.pub | apt-key add - \\\n && sh -c 'echo \"deb [arch=amd64] http://dl.google.com/linux/chrome/deb/ stable main\" >> /etc/apt/sources.list.d/google.list' \\\n && apt-get update \\\n && apt-get install --no-install-recommends google-chrome-unstable -y \\\n && apt-get purge --auto-remove \\\n && rm -rf /tmp/* /var/lib/apt/lists/* \\\n && rm -rf /usr/bin/google-chrome* /opt/google/chrome-unstable\nRUN mkdir /wechaty /node_modules\nWORKDIR /wechaty\nCOPY package.json .\nRUN npm install \\\n && sudo rm -fr /tmp/* ~/.npm\nCOPY . .\n#   Pre-Install All Puppets\nRUN npm run puppet-install \\\n && sudo rm -fr /tmp/* ~/.npm\n#   RUN npm run test:debug\nRUN npm test\nRUN npm run dist\n#   Loading from node_modules Folders: https://nodejs.org/api/modules.html\n#   If it is not found there, then it moves to the parent directory, and so on, until the root of the file system is reached.\nRUN sudo mkdir /bot \\\n && npm link \\\n && sudo ln -sfv /usr/lib/node_modules/* /node_modules/ \\\n && sudo ln -sfv /wechaty/node_modules/* /node_modules/ \\\n && sudo ln -sfv /wechaty/tsconfig.json / \\\n && echo 'Linked Wechaty to Global'\nENTRYPOINT [\"/wechaty/bin/entrypoint.sh\"]\nCMD []\n#\n#   https://docs.docker.com/docker-cloud/builds/advanced/\n#   http://label-schema.org/rc1/\n#\nLABEL org.label-schema.license=\"Apache-2.0\" \\\n      org.label-schema.build-date=\"$(date -u +'%Y-%m-%dT%H:%M:%SZ')\" \\\n      org.label-schema.version=\"$DOCKER_TAG\" \\\n      org.label-schema.schema-version=\"$(wechaty-version)\" \\\n      org.label-schema.name=\"Wechaty\" \\\n      org.label-schema.description=\"Wechat for Bot\" \\\n      org.label-schema.usage=\"https://github.com/chatie/wechaty/wiki/Docker\" \\\n      org.label-schema.url=\"https://www.chatie.io\" \\\n      org.label-schema.vendor=\"Chatie\" \\\n      org.label-schema.vcs-ref=\"$SOURCE_COMMIT\" \\\n      org.label-schema.vcs-url=\"https://github.com/chatie/wechaty\" \\\n      org.label-schema.docker.cmd=\"docker run -ti --rm zixia/wechaty <code.js>\" \\\n      org.label-schema.docker.cmd.test=\"docker run -ti --rm zixia/wechaty test\" \\\n      org.label-schema.docker.cmd.help=\"docker run -ti --rm zixia/wechaty help\" \\\n      org.label-schema.docker.params=\"WECHATY_TOKEN=token token from https://www.chatie.io, WECHATY_LOG=verbose Set Verbose Log, TZ='Asia/Shanghai' TimeZone\"\n","originalDockerfileUglifiedHash":"5bb43d868f356e9bc2b86187a7f98103","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/7067ee013c7f50d02657d830122fc84fb4e7b827.dockerfile"}