{"seed":2463108878,"processedDockerfileHash":"a6a90ae61f3f7264a2f3de38d6663c2e","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["have-a-healthcheck"],"processedDockerfile":"#   Fetch image based on Tomcat 8.5.34 and Java 11\n#   More infos about this image: https://github.com/Alfresco/alfresco-docker-base-tomcat\nFROM alfresco/alfresco-base-tomcat:8.5.34-java-11-openjdk-centos-7\n#   Set default user information\nARG GROUPNAME=Alfresco\nARG GROUPID=1000\nARG USERNAME=alfresco\nARG USERID=33000\n#   Set default environment args\nARG TOMCAT_DIR=/usr/local/tomcat\n#   Base ACS Repository Image includes transformation commands:\n#     /usr/bin/alfresco-pdf-renderer      - alfresco-pdf-renderer\n#     /usr/bin/convert                    - imagemagick\n#     /opt/libreoffice5.4/program/soffice - LibreOffice\n#   alfresco-pdf-renderer uses the PDFium library from Google Inc. See the license at https://pdfium.googlesource.com/pdfium/+/master/LICENSE or in /pdfium.txt\n#   ImageMagick is from ImageMagick Studio LLC. See the license at http://www.imagemagick.org/script/license.php or in /ImageMagick-license.txt\n#   LibreOffice is from The Document Foundation. See the license at https://www.libreoffice.org/download/license/ or in /libreoffice.txt\nENV ALFRESCO_PDF_RENDERER_LIB_RPM_URL=\"https://nexus.alfresco.com/nexus/service/local/repositories/releases/content/org/alfresco/alfresco-pdf-renderer/1.1/alfresco-pdf-renderer-1.1-linux.tgz\"\nENV PDFIUM_LICENSE_FILE=\"https://github.com/Alfresco/acs-community-packaging/blob/master/distribution/src/main/resources/licenses/3rd-party/pdfium.txt\"\nENV LIBREOFFICE_RPM_URL=\"https://nexus.alfresco.com/nexus/service/local/repositories/thirdparty/content/org/libreoffice/libreoffice-dist/5.4.6/libreoffice-dist-5.4.6-linux.gz\"\nENV LIBREOFFICE_LICENSE_FILE=\"https://github.com/Alfresco/acs-community-packaging/blob/master/distribution/src/main/resources/licenses/3rd-party/libreoffice.txt\"\nENV IMAGEMAGICK_RPM_URL=\"https://nexus.alfresco.com/nexus/service/local/repositories/thirdparty/content/org/imagemagick/imagemagick-distribution/7.0.7-27/imagemagick-distribution-7.0.7-27-linux.rpm\"\nENV IMAGEMAGICK_LIB_RPM_URL=\"https://nexus.alfresco.com/nexus/service/local/repositories/thirdparty/content/org/imagemagick/imagemagick-distribution/7.0.7-27/imagemagick-distribution-7.0.7-27-libs-linux.rpm\"\nENV IMAGEMAGICK_LICENSE_FILE=\"https://github.com/Alfresco/acs-community-packaging/blob/master/distribution/src/main/resources/licenses/3rd-party/ImageMagick-license.txt\"\n#   Install transformer binaries\nRUN yum install wget -y \\\n && wget $ALFRESCO_PDF_RENDERER_LIB_RPM_URL \\\n && wget -P /. $PDFIUM_LICENSE_FILE \\\n && tar xf alfresco-pdf-renderer-*-linux.tgz -C /usr/bin \\\n && rm -f alfresco-pdf-renderer-*-linux.tgz \\\n && yum install -y cairo cups-libs libSM \\\n && wget $LIBREOFFICE_RPM_URL \\\n && wget -P /. $LIBREOFFICE_LICENSE_FILE \\\n && tar xzf libreoffice-dist-*-linux.gz \\\n && yum localinstall -y LibreOffice*/RPMS/*.rpm \\\n && rm -rf libreoffice-dist-*-linux.gz LibreOffice_*_Linux_x86-64_rpm \\\n && wget $IMAGEMAGICK_RPM_URL \\\n && wget $IMAGEMAGICK_LIB_RPM_URL \\\n && wget -P /. $IMAGEMAGICK_LICENSE_FILE \\\n && yum localinstall -y imagemagick-distribution-*-linux.rpm \\\n && rm -f imagemagick-distribution-*-linux.rpm \\\n && yum clean all \\\n && yum remove wget -y\n#   Create prerequisite to store tools and properties\nRUN mkdir -p ${TOMCAT_DIR}/shared/classes/alfresco/extension \\\n && mkdir ${TOMCAT_DIR}/alfresco-mmt\nRUN touch ${TOMCAT_DIR}/shared/classes/alfresco-global.properties\n#   You need to run `mvn clean install` in the root of this project to update the following dependencies\n#   Copy the WAR files to the appropriate location for your application server\n#   Copy the JDBC drivers for the database you are using to the lib/ directory.\n#   Copy the alfresco-mmt.jar\nCOPY target/war ${TOMCAT_DIR}/webapps\nCOPY target/connector/* ${TOMCAT_DIR}/lib/\nCOPY target/alfresco-mmt/* ${TOMCAT_DIR}/alfresco-mmt/\n#   Copy Licenses to the root of the Docker image\nRUN mkdir /licenses\nCOPY target/licenses/ /licenses/\n#   Change the value of the shared.loader= property to the following:\n#   shared.loader=${catalina.base}/shared/classes\nRUN sed -i \"s/shared.loader=/shared.loader=${catalina.base}\\/shared\\/classes/\" ${TOMCAT_DIR}/conf/catalina.properties\n#   Add here configurations for alfresco-global.properties\nRUN echo -e '\\nalfresco-pdf-renderer.root=/usr/bin/\\nalfresco-pdf-renderer.exe=${alfresco-pdf-renderer.root}/alfresco-pdf-renderer\\n\\njodconverter.enabled=true\\njodconverter.portNumbers=8100\\njodconverter.officeHome=/opt/libreoffice5.4/\\n\\nimg.root=/usr/lib64/ImageMagick-7.0.7\\nimg.coders=/usr/lib64/ImageMagick-7.0.7/modules-Q16HDRI/coders\\nimg.config=/usr/lib64/ImageMagick-7.0.7/config-Q16HDRI\\nimg.exe=/usr/bin/convert\\n' >> ${TOMCAT_DIR}/shared/classes/alfresco-global.properties\n#   Add debug for testing\n#   RUN echo -e '\\n\\\n#   log4j.logger.org.alfresco.repo.content.transform.TransformerDebug=debug\\n\\\n#   ' >> ${TOMCAT_DIR}/shared/classes/alfresco/extension/custom-log4j.properties\nRUN mkdir -p ${TOMCAT_DIR}/amps\n#   Copy the amps from build context to the appropriate location for your application server\nCOPY target/amps ${TOMCAT_DIR}/amps\n#   Install amps on alfresco.war\nRUN java -jar ${TOMCAT_DIR}/alfresco-mmt/alfresco-mmt*.jar install ${TOMCAT_DIR}/amps ${TOMCAT_DIR}/webapps/alfresco -directory -nobackup -force\n#   Docker CMD from parent image starts the server\n#   Make webapps folder read-only.\nRUN chmod -R =r ${TOMCAT_DIR}/webapps \\\n && sed -i -e \"$a\\grant\\ codeBase\\ \\\"file:$\\{catalina.base\\}\\/webapps\\/alfresco\\/-\\\" \\{\\n\\ permission\\ java.security.AllPermission\\;\\n\\};\\ngrant\\ codeBase\\ \\\"file:$\\{catalina.base\\}\\/webapps\\/ROOT\\/-\\\" \\{\\n\\ permission org.apache.catalina.security.DeployXmlPermission \\\"ROOT\\\";\\n\\};\" ${TOMCAT_DIR}/conf/catalina.policy\n#   fontconfig is required by Activiti worflow diagram generator\n#   installing pinned dependencies as well\nRUN yum install -y fontconfig-2.13.0-4.3.el7 dejavu-fonts-common-2.33-6.el7 fontpackages-filesystem-1.44-8.el7 freetype-2.8-12.el7 libpng-1.5.13-7.el7_2 dejavu-sans-fonts-2.33-6.el7 \\\n && yum clean all\n#   The standard configuration is to have all Tomcat files owned by root with group GROUPNAME and whilst owner has read/write privileges, \n#   group only has restricted permissions and world has no permissions.\nRUN mkdir -p ${TOMCAT_DIR}/conf/Catalina/localhost \\\n && mkdir -p ${TOMCAT_DIR}/alf_data \\\n && groupadd -g ${GROUPID} ${GROUPNAME} \\\n && useradd -u ${USERID} -G ${GROUPNAME} ${USERNAME} \\\n && chgrp -R ${GROUPNAME} ${TOMCAT_DIR} \\\n && chmod g+w ${TOMCAT_DIR}/logs \\\n && chmod g+rx ${TOMCAT_DIR}/conf \\\n && chmod -R g+r ${TOMCAT_DIR}/conf \\\n && find ${TOMCAT_DIR}/webapps -type d -exec chmod 0750 {}\n#   To remote debug into this image add: EXPOSE 8000\n#   Changes are also required to the docker-compose/docker-compose.yml file.\n#   EXPOSE 8000\nUSER ${USERNAME}\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  Fetch image based on Tomcat 8.5.34 and Java 11\n#  More infos about this image: https://github.com/Alfresco/alfresco-docker-base-tomcat\nFROM alfresco/alfresco-base-tomcat:8.5.34-java-11-openjdk-centos-7\n#  Set default user information\nARG GROUPNAME=Alfresco\nARG GROUPID=1000\nARG USERNAME=alfresco\nARG USERID=33000\n#  Set default environment args\nARG TOMCAT_DIR=/usr/local/tomcat\n#  Base ACS Repository Image includes transformation commands:\n#    /usr/bin/alfresco-pdf-renderer      - alfresco-pdf-renderer\n#    /usr/bin/convert                    - imagemagick\n#    /opt/libreoffice5.4/program/soffice - LibreOffice\n#  alfresco-pdf-renderer uses the PDFium library from Google Inc. See the license at https://pdfium.googlesource.com/pdfium/+/master/LICENSE or in /pdfium.txt\n#  ImageMagick is from ImageMagick Studio LLC. See the license at http://www.imagemagick.org/script/license.php or in /ImageMagick-license.txt\n#  LibreOffice is from The Document Foundation. See the license at https://www.libreoffice.org/download/license/ or in /libreoffice.txt\nENV ALFRESCO_PDF_RENDERER_LIB_RPM_URL=\"https://nexus.alfresco.com/nexus/service/local/repositories/releases/content/org/alfresco/alfresco-pdf-renderer/1.1/alfresco-pdf-renderer-1.1-linux.tgz\"\nENV PDFIUM_LICENSE_FILE=\"https://github.com/Alfresco/acs-community-packaging/blob/master/distribution/src/main/resources/licenses/3rd-party/pdfium.txt\"\nENV LIBREOFFICE_RPM_URL=\"https://nexus.alfresco.com/nexus/service/local/repositories/thirdparty/content/org/libreoffice/libreoffice-dist/5.4.6/libreoffice-dist-5.4.6-linux.gz\"\nENV LIBREOFFICE_LICENSE_FILE=\"https://github.com/Alfresco/acs-community-packaging/blob/master/distribution/src/main/resources/licenses/3rd-party/libreoffice.txt\"\nENV IMAGEMAGICK_RPM_URL=\"https://nexus.alfresco.com/nexus/service/local/repositories/thirdparty/content/org/imagemagick/imagemagick-distribution/7.0.7-27/imagemagick-distribution-7.0.7-27-linux.rpm\"\nENV IMAGEMAGICK_LIB_RPM_URL=\"https://nexus.alfresco.com/nexus/service/local/repositories/thirdparty/content/org/imagemagick/imagemagick-distribution/7.0.7-27/imagemagick-distribution-7.0.7-27-libs-linux.rpm\"\nENV IMAGEMAGICK_LICENSE_FILE=\"https://github.com/Alfresco/acs-community-packaging/blob/master/distribution/src/main/resources/licenses/3rd-party/ImageMagick-license.txt\"\n#  Install transformer binaries\nRUN yum install wget -y \\\n && wget $ALFRESCO_PDF_RENDERER_LIB_RPM_URL \\\n && wget -P /. $PDFIUM_LICENSE_FILE \\\n && tar xf alfresco-pdf-renderer-*-linux.tgz -C /usr/bin \\\n && rm -f alfresco-pdf-renderer-*-linux.tgz \\\n && yum install -y cairo cups-libs libSM \\\n && wget $LIBREOFFICE_RPM_URL \\\n && wget -P /. $LIBREOFFICE_LICENSE_FILE \\\n && tar xzf libreoffice-dist-*-linux.gz \\\n && yum localinstall -y LibreOffice*/RPMS/*.rpm \\\n && rm -rf libreoffice-dist-*-linux.gz LibreOffice_*_Linux_x86-64_rpm \\\n && wget $IMAGEMAGICK_RPM_URL \\\n && wget $IMAGEMAGICK_LIB_RPM_URL \\\n && wget -P /. $IMAGEMAGICK_LICENSE_FILE \\\n && yum localinstall -y imagemagick-distribution-*-linux.rpm \\\n && rm -f imagemagick-distribution-*-linux.rpm \\\n && yum clean all \\\n && yum remove wget -y\n#  Create prerequisite to store tools and properties\nRUN mkdir -p ${TOMCAT_DIR}/shared/classes/alfresco/extension \\\n && mkdir ${TOMCAT_DIR}/alfresco-mmt\nRUN touch ${TOMCAT_DIR}/shared/classes/alfresco-global.properties\n#  You need to run `mvn clean install` in the root of this project to update the following dependencies\n#  Copy the WAR files to the appropriate location for your application server\n#  Copy the JDBC drivers for the database you are using to the lib/ directory.\n#  Copy the alfresco-mmt.jar\nCOPY target/war ${TOMCAT_DIR}/webapps\nCOPY target/connector/* ${TOMCAT_DIR}/lib/\nCOPY target/alfresco-mmt/* ${TOMCAT_DIR}/alfresco-mmt/\n#  Copy Licenses to the root of the Docker image\nRUN mkdir /licenses\nCOPY target/licenses/ /licenses/\n#  Change the value of the shared.loader= property to the following:\n#  shared.loader=${catalina.base}/shared/classes\nRUN sed -i \"s/shared.loader=/shared.loader=${catalina.base}\\/shared\\/classes/\" ${TOMCAT_DIR}/conf/catalina.properties\n#  Add here configurations for alfresco-global.properties\nRUN echo -e '\\nalfresco-pdf-renderer.root=/usr/bin/\\nalfresco-pdf-renderer.exe=${alfresco-pdf-renderer.root}/alfresco-pdf-renderer\\n\\njodconverter.enabled=true\\njodconverter.portNumbers=8100\\njodconverter.officeHome=/opt/libreoffice5.4/\\n\\nimg.root=/usr/lib64/ImageMagick-7.0.7\\nimg.coders=/usr/lib64/ImageMagick-7.0.7/modules-Q16HDRI/coders\\nimg.config=/usr/lib64/ImageMagick-7.0.7/config-Q16HDRI\\nimg.exe=/usr/bin/convert\\n' >> ${TOMCAT_DIR}/shared/classes/alfresco-global.properties\n#  Add debug for testing\n#  RUN echo -e '\\n\\\n#  log4j.logger.org.alfresco.repo.content.transform.TransformerDebug=debug\\n\\\n#  ' >> ${TOMCAT_DIR}/shared/classes/alfresco/extension/custom-log4j.properties\nRUN mkdir -p ${TOMCAT_DIR}/amps\n#  Copy the amps from build context to the appropriate location for your application server\nCOPY target/amps ${TOMCAT_DIR}/amps\n#  Install amps on alfresco.war\nRUN java -jar ${TOMCAT_DIR}/alfresco-mmt/alfresco-mmt*.jar install ${TOMCAT_DIR}/amps ${TOMCAT_DIR}/webapps/alfresco -directory -nobackup -force\n#  Docker CMD from parent image starts the server\n#  Make webapps folder read-only.\nRUN chmod -R =r ${TOMCAT_DIR}/webapps \\\n && sed -i -e \"$a\\grant\\ codeBase\\ \\\"file:$\\{catalina.base\\}\\/webapps\\/alfresco\\/-\\\" \\{\\n\\ permission\\ java.security.AllPermission\\;\\n\\};\\ngrant\\ codeBase\\ \\\"file:$\\{catalina.base\\}\\/webapps\\/ROOT\\/-\\\" \\{\\n\\ permission org.apache.catalina.security.DeployXmlPermission \\\"ROOT\\\";\\n\\};\" ${TOMCAT_DIR}/conf/catalina.policy\n#  fontconfig is required by Activiti worflow diagram generator\n#  installing pinned dependencies as well\nRUN yum install -y fontconfig-2.13.0-4.3.el7 dejavu-fonts-common-2.33-6.el7 fontpackages-filesystem-1.44-8.el7 freetype-2.8-12.el7 libpng-1.5.13-7.el7_2 dejavu-sans-fonts-2.33-6.el7 \\\n && yum clean all\n#  The standard configuration is to have all Tomcat files owned by root with group GROUPNAME and whilst owner has read/write privileges, \n#  group only has restricted permissions and world has no permissions.\nRUN mkdir -p ${TOMCAT_DIR}/conf/Catalina/localhost \\\n && mkdir -p ${TOMCAT_DIR}/alf_data \\\n && groupadd -g ${GROUPID} ${GROUPNAME} \\\n && useradd -u ${USERID} -G ${GROUPNAME} ${USERNAME} \\\n && chgrp -R ${GROUPNAME} ${TOMCAT_DIR} \\\n && chmod g+w ${TOMCAT_DIR}/logs \\\n && chmod g+rx ${TOMCAT_DIR}/conf \\\n && chmod -R g+r ${TOMCAT_DIR}/conf \\\n && find ${TOMCAT_DIR}/webapps -type d -exec chmod 0750 {} ; \\\n && find ${TOMCAT_DIR}/webapps -type f -exec chmod 0640 {} ; \\\n && chmod -R g+r ${TOMCAT_DIR}/webapps \\\n && chmod g+r ${TOMCAT_DIR}/conf/Catalina \\\n && chmod g+rwx ${TOMCAT_DIR}/alf_data \\\n && chmod g+rwx ${TOMCAT_DIR}/logs \\\n && chmod g+rwx ${TOMCAT_DIR}/temp \\\n && chmod g+rwx ${TOMCAT_DIR}/work \\\n && sed -i -e \"s_log4j.appender.File.File\\=alfresco.log_log4j.appender.File.File\\=${TOMCAT_DIR}/logs\\/alfresco.log_\" ${TOMCAT_DIR}/webapps/alfresco/WEB-INF/classes/log4j.properties\n#  To remote debug into this image add: EXPOSE 8000\n#  Changes are also required to the docker-compose/docker-compose.yml file.\n#  EXPOSE 8000\nUSER ${USERNAME}\n","injectedSmells":[],"originalDockerfileHash":"bf9530389ad12998794d8c7e92d00f0e","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   Fetch image based on Tomcat 8.5.34 and Java 11\n#   More infos about this image: https://github.com/Alfresco/alfresco-docker-base-tomcat\nFROM alfresco/alfresco-base-tomcat:8.5.34-java-11-openjdk-centos-7\n#   Set default user information\nARG GROUPNAME=Alfresco\nARG GROUPID=1000\nARG USERNAME=alfresco\nARG USERID=33000\n#   Set default environment args\nARG TOMCAT_DIR=/usr/local/tomcat\n#   Base ACS Repository Image includes transformation commands:\n#     /usr/bin/alfresco-pdf-renderer      - alfresco-pdf-renderer\n#     /usr/bin/convert                    - imagemagick\n#     /opt/libreoffice5.4/program/soffice - LibreOffice\n#   alfresco-pdf-renderer uses the PDFium library from Google Inc. See the license at https://pdfium.googlesource.com/pdfium/+/master/LICENSE or in /pdfium.txt\n#   ImageMagick is from ImageMagick Studio LLC. See the license at http://www.imagemagick.org/script/license.php or in /ImageMagick-license.txt\n#   LibreOffice is from The Document Foundation. See the license at https://www.libreoffice.org/download/license/ or in /libreoffice.txt\nENV ALFRESCO_PDF_RENDERER_LIB_RPM_URL=\"https://nexus.alfresco.com/nexus/service/local/repositories/releases/content/org/alfresco/alfresco-pdf-renderer/1.1/alfresco-pdf-renderer-1.1-linux.tgz\"\nENV PDFIUM_LICENSE_FILE=\"https://github.com/Alfresco/acs-community-packaging/blob/master/distribution/src/main/resources/licenses/3rd-party/pdfium.txt\"\nENV LIBREOFFICE_RPM_URL=\"https://nexus.alfresco.com/nexus/service/local/repositories/thirdparty/content/org/libreoffice/libreoffice-dist/5.4.6/libreoffice-dist-5.4.6-linux.gz\"\nENV LIBREOFFICE_LICENSE_FILE=\"https://github.com/Alfresco/acs-community-packaging/blob/master/distribution/src/main/resources/licenses/3rd-party/libreoffice.txt\"\nENV IMAGEMAGICK_RPM_URL=\"https://nexus.alfresco.com/nexus/service/local/repositories/thirdparty/content/org/imagemagick/imagemagick-distribution/7.0.7-27/imagemagick-distribution-7.0.7-27-linux.rpm\"\nENV IMAGEMAGICK_LIB_RPM_URL=\"https://nexus.alfresco.com/nexus/service/local/repositories/thirdparty/content/org/imagemagick/imagemagick-distribution/7.0.7-27/imagemagick-distribution-7.0.7-27-libs-linux.rpm\"\nENV IMAGEMAGICK_LICENSE_FILE=\"https://github.com/Alfresco/acs-community-packaging/blob/master/distribution/src/main/resources/licenses/3rd-party/ImageMagick-license.txt\"\n#   Install transformer binaries\nRUN yum install wget -y \\\n && wget $ALFRESCO_PDF_RENDERER_LIB_RPM_URL \\\n && wget -P /. $PDFIUM_LICENSE_FILE \\\n && tar xf alfresco-pdf-renderer-*-linux.tgz -C /usr/bin \\\n && rm -f alfresco-pdf-renderer-*-linux.tgz \\\n && yum install -y cairo cups-libs libSM \\\n && wget $LIBREOFFICE_RPM_URL \\\n && wget -P /. $LIBREOFFICE_LICENSE_FILE \\\n && tar xzf libreoffice-dist-*-linux.gz \\\n && yum localinstall -y LibreOffice*/RPMS/*.rpm \\\n && rm -rf libreoffice-dist-*-linux.gz LibreOffice_*_Linux_x86-64_rpm \\\n && wget $IMAGEMAGICK_RPM_URL \\\n && wget $IMAGEMAGICK_LIB_RPM_URL \\\n && wget -P /. $IMAGEMAGICK_LICENSE_FILE \\\n && yum localinstall -y imagemagick-distribution-*-linux.rpm \\\n && rm -f imagemagick-distribution-*-linux.rpm \\\n && yum clean all \\\n && yum remove wget -y\n#   Create prerequisite to store tools and properties\nRUN mkdir -p ${TOMCAT_DIR}/shared/classes/alfresco/extension \\\n && mkdir ${TOMCAT_DIR}/alfresco-mmt\nRUN touch ${TOMCAT_DIR}/shared/classes/alfresco-global.properties\n#   You need to run `mvn clean install` in the root of this project to update the following dependencies\n#   Copy the WAR files to the appropriate location for your application server\n#   Copy the JDBC drivers for the database you are using to the lib/ directory.\n#   Copy the alfresco-mmt.jar\nCOPY target/war ${TOMCAT_DIR}/webapps\nCOPY target/connector/* ${TOMCAT_DIR}/lib/\nCOPY target/alfresco-mmt/* ${TOMCAT_DIR}/alfresco-mmt/\n#   Copy Licenses to the root of the Docker image\nRUN mkdir /licenses\nCOPY target/licenses/ /licenses/\n#   Change the value of the shared.loader= property to the following:\n#   shared.loader=${catalina.base}/shared/classes\nRUN sed -i \"s/shared.loader=/shared.loader=${catalina.base}\\/shared\\/classes/\" ${TOMCAT_DIR}/conf/catalina.properties\n#   Add here configurations for alfresco-global.properties\nRUN echo -e '\\nalfresco-pdf-renderer.root=/usr/bin/\\nalfresco-pdf-renderer.exe=${alfresco-pdf-renderer.root}/alfresco-pdf-renderer\\n\\njodconverter.enabled=true\\njodconverter.portNumbers=8100\\njodconverter.officeHome=/opt/libreoffice5.4/\\n\\nimg.root=/usr/lib64/ImageMagick-7.0.7\\nimg.coders=/usr/lib64/ImageMagick-7.0.7/modules-Q16HDRI/coders\\nimg.config=/usr/lib64/ImageMagick-7.0.7/config-Q16HDRI\\nimg.exe=/usr/bin/convert\\n' >> ${TOMCAT_DIR}/shared/classes/alfresco-global.properties\n#   Add debug for testing\n#   RUN echo -e '\\n\\\n#   log4j.logger.org.alfresco.repo.content.transform.TransformerDebug=debug\\n\\\n#   ' >> ${TOMCAT_DIR}/shared/classes/alfresco/extension/custom-log4j.properties\nRUN mkdir -p ${TOMCAT_DIR}/amps\n#   Copy the amps from build context to the appropriate location for your application server\nCOPY target/amps ${TOMCAT_DIR}/amps\n#   Install amps on alfresco.war\nRUN java -jar ${TOMCAT_DIR}/alfresco-mmt/alfresco-mmt*.jar install ${TOMCAT_DIR}/amps ${TOMCAT_DIR}/webapps/alfresco -directory -nobackup -force\n#   Docker CMD from parent image starts the server\n#   Make webapps folder read-only.\nRUN chmod -R =r ${TOMCAT_DIR}/webapps \\\n && sed -i -e \"$a\\grant\\ codeBase\\ \\\"file:$\\{catalina.base\\}\\/webapps\\/alfresco\\/-\\\" \\{\\n\\ permission\\ java.security.AllPermission\\;\\n\\};\\ngrant\\ codeBase\\ \\\"file:$\\{catalina.base\\}\\/webapps\\/ROOT\\/-\\\" \\{\\n\\ permission org.apache.catalina.security.DeployXmlPermission \\\"ROOT\\\";\\n\\};\" ${TOMCAT_DIR}/conf/catalina.policy\n#   fontconfig is required by Activiti worflow diagram generator\n#   installing pinned dependencies as well\nRUN yum install -y fontconfig-2.13.0-4.3.el7 dejavu-fonts-common-2.33-6.el7 fontpackages-filesystem-1.44-8.el7 freetype-2.8-12.el7 libpng-1.5.13-7.el7_2 dejavu-sans-fonts-2.33-6.el7 \\\n && yum clean all\n#   The standard configuration is to have all Tomcat files owned by root with group GROUPNAME and whilst owner has read/write privileges, \n#   group only has restricted permissions and world has no permissions.\nRUN mkdir -p ${TOMCAT_DIR}/conf/Catalina/localhost \\\n && mkdir -p ${TOMCAT_DIR}/alf_data \\\n && groupadd -g ${GROUPID} ${GROUPNAME} \\\n && useradd -u ${USERID} -G ${GROUPNAME} ${USERNAME} \\\n && chgrp -R ${GROUPNAME} ${TOMCAT_DIR} \\\n && chmod g+w ${TOMCAT_DIR}/logs \\\n && chmod g+rx ${TOMCAT_DIR}/conf \\\n && chmod -R g+r ${TOMCAT_DIR}/conf \\\n && find ${TOMCAT_DIR}/webapps -type d -exec chmod 0750 {}\n#   To remote debug into this image add: EXPOSE 8000\n#   Changes are also required to the docker-compose/docker-compose.yml file.\n#   EXPOSE 8000\nUSER ${USERNAME}\n","originalDockerfileUglifiedHash":"f8bb65d82f550fe8243f0390591a49d6","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/1399d31d540f575d52f57756ebeb3e7be68ca693.dockerfile"}