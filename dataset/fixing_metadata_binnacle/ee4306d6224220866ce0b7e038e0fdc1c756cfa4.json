{"seed":2814647681,"processedDockerfileHash":"edd725cd37abf30b1c2c1ff92f047aca","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","pin-package-manager-versions-apt-get","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM ubuntu:16.04\nMAINTAINER Claus Stadler <cstadler@informatik.uni-leipzig.de>\nENV DEBIAN_FRONTEND=\"noninteractive\"\nRUN echo \"force rebuild 7\"\nRUN apt-get update -y --fix-missing \\\n && apt-get install --no-install-recommends software-properties-common=0.96.20.10 wget=1.17.1-1ubuntu1.5 git=1:2.7.4-0ubuntu1.10 curl=7.47.0-1ubuntu2.19 sudo=1.8.16-0ubuntu1.10 -y \\\n && apt-get update\nENV POSTGRES_CLIENT_VERSION=\"9.5\"\nENV POSTGIS_CLIENT_VERSION=\"2.2\"\n#  ENV POSTGRES_CLIENT_VERSION ${POSTGRES_VERSION}\n#  ENV POSTGIS_CLIENT_VERSION ${POSTGIS_VERSION}\nRUN echo \"pgclientver: ${POSTGRES_CLIENT_VERSION}\"\n#   for 16.04: libgeos-c1v5\nRUN apt-get install --no-install-recommends build-essential=12.1ubuntu2 libxml2-dev=2.9.3+dfsg1-1ubuntu0.7 libpq-dev=9.5.25-0ubuntu0.16.04.1 libbz2-dev=1.0.6-8ubuntu0.2 libtool=2.4.6-0.1 automake=1:1.15-4ubuntu1 libproj-dev=4.9.2-2 libboost-dev=1.58.0.1ubuntu1 libboost-system-dev=1.58.0.1ubuntu1 libboost-filesystem-dev=1.58.0.1ubuntu1 libboost-thread-dev=1.58.0.1ubuntu1 libexpat-dev gcc=4:5.3.1-1ubuntu1 proj-bin=4.9.2-2 libgeos-c1v5=3.5.0-1ubuntu2 libgeos++-dev=3.5.0-1ubuntu2 libexpat-dev php-pgsql=1:7.0+35ubuntu6.1 php-json=1:7.0+35ubuntu6.1 php-db=1.7.14-3build1 postgresql=9.5+173ubuntu0.3 postgis=2.2.1+dfsg-2ubuntu0.1 postgresql-contrib=9.5+173ubuntu0.3 wget=1.17.1-1ubuntu1.5 osm2pgsql=0.88.1-1 osmosis=0.44.1-4 gettext-base=0.19.7-2ubuntu3.1 osmctools=0.6-1 postgresql-${POSTGRES_CLIENT_VERSION}-postgis-${POSTGIS_CLIENT_VERSION} postgresql-server-dev-${POSTGRES_CLIENT_VERSION} -y\n#   Install the linked geo data package for the lgd-osm-replication-sequences tool\nRUN wget -qO - http://cstadler.aksw.org/repos/apt/conf/packages.precise.gpg.key | sudo apt-key add - \\\n && echo 'deb http://cstadler.aksw.org/repos/apt precise main contrib non-free' | sudo tee -a /etc/apt/sources.list.d/cstadler.aksw.org.list \\\n && apt-get update \\\n && apt-get install --no-install-recommends linkedgeodata -y\nWORKDIR /app/nominatim\n#   Nominatim install\nENV NOMINATIM_VERSION=\"v2.5.1\"\nRUN git clone https://github.com/openstreetmap/Nominatim ./src\nRUN cd ./src \\\n && git checkout \"$NOMINATIM_VERSION\"\n#  RUN git clone --recursive https://github.com/openstreetmap/Nominatim ./src\n#  RUN cd ./src && git checkout \"$NOMINATIM_VERSION\" && git submodule update --recursive --init && \\\n#    ./autogen.sh && ./configure && make\nRUN echo \"force rebuild b6\"\n#   Nominatim create site\n#   FIXME Eventually get rid of the need for the .pgpass file, but the latest osm2pgsql tool fails to read password from the PGPASS environment variable\n#   Alternatively, create the file dynamically within the container\nCOPY target/.pgpass /root/\nRUN chmod 600 /root/.pgpass\nCOPY local.php.dist ./src/settings/\nCOPY setup-patched.php ./src/utils/\nRUN chmod +x ./src/utils/setup-patched.php\nCOPY update-patched.php ./src/utils/\nRUN chmod +x ./src/utils/update-patched.php\nCOPY target/nominatim ./src/nominatim/\nRUN chmod +x ./src/nominatim/nominatim\nCOPY target/osm2pgsql ./src/osm2pgsql/\nRUN chmod +x ./src/osm2pgsql/osm2pgsql\nCOPY target/nominatim.so ./src/module/\nCOPY configuration.txt.dist ./src/settings/\n#  RUN rm -rf /var/www/html/* && ./src/utils/setup.php --create-website /var/www/html\n#   Apache configure\n#  COPY nominatim.conf /etc/apache2/sites-enabled/000-default.conf\n#  ENV DB_HOST test\n#  RUN echo \"xxxyyyDB: ${DB_HOST} $DB_URL\"\n#   Load initial data\n#  ENV PBF_DATA http://download.geofabrik.de/europe/monaco-latest.osm.pbf\n#  RUN curl -L $PBF_DATA --create-dirs -o /app/src/data.osm.pbf\n#  RUN service postgresql start && \\\n#      psql \"$DB_URL\" -c \"CREATE ROLE nominatim;\" || true && \\\n#      psql \"$DB_URL\" -c \"CREATE ROLE www-data NOSUPERUSER NOCREATEDB NOCREATEROL;\" || true && \\\n#      psql \"$DB_URL\" -c \"CREATE DATABASE IF NOT EXISTS nominatim\" && \\\n#      sudo -u postgres psql postgres -c \"DROP DATABASE IF EXISTS nominatim\" && \\\n#      useradd -m -p password1234 nominatim && \\\n#      chown -R nominatim:nominatim ./src && \\\n#      sudo -u nominatim ./src/utils/setup.php --osm-file /app/src/data.osm.pbf --all --threads 2 && \\\n#      service postgresql stop\n#  EXPOSE 5432\n#  EXPOSE 8080\nCOPY start.sh .\nCMD ./start.sh\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM ubuntu:16.04\nMAINTAINER Claus Stadler <cstadler@informatik.uni-leipzig.de>\nENV DEBIAN_FRONTEND=\"noninteractive\"\nRUN echo \"force rebuild 7\"\nRUN apt-get update -y --fix-missing \\\n && apt-get install software-properties-common wget git curl sudo -y \\\n && apt-get update\nENV POSTGRES_CLIENT_VERSION=\"9.5\"\nENV POSTGIS_CLIENT_VERSION=\"2.2\"\n# ENV POSTGRES_CLIENT_VERSION ${POSTGRES_VERSION}\n# ENV POSTGIS_CLIENT_VERSION ${POSTGIS_VERSION}\nRUN echo \"pgclientver: ${POSTGRES_CLIENT_VERSION}\"\n#  for 16.04: libgeos-c1v5\nRUN apt-get install build-essential libxml2-dev libpq-dev libbz2-dev libtool automake libproj-dev libboost-dev libboost-system-dev libboost-filesystem-dev libboost-thread-dev libexpat-dev gcc proj-bin libgeos-c1v5 libgeos++-dev libexpat-dev php-pgsql php-json php-db postgresql postgis postgresql-contrib wget osm2pgsql osmosis gettext-base osmctools postgresql-${POSTGRES_CLIENT_VERSION}-postgis-${POSTGIS_CLIENT_VERSION} postgresql-server-dev-${POSTGRES_CLIENT_VERSION} -y\n#  Install the linked geo data package for the lgd-osm-replication-sequences tool\nRUN wget -qO - http://cstadler.aksw.org/repos/apt/conf/packages.precise.gpg.key | sudo apt-key add - \\\n && echo 'deb http://cstadler.aksw.org/repos/apt precise main contrib non-free' | sudo tee -a /etc/apt/sources.list.d/cstadler.aksw.org.list \\\n && apt-get update \\\n && apt-get install linkedgeodata -y\nWORKDIR /app/nominatim\n#  Nominatim install\nENV NOMINATIM_VERSION=\"v2.5.1\"\nRUN git clone https://github.com/openstreetmap/Nominatim ./src\nRUN cd ./src \\\n && git checkout \"$NOMINATIM_VERSION\"\n# RUN git clone --recursive https://github.com/openstreetmap/Nominatim ./src\n# RUN cd ./src && git checkout \"$NOMINATIM_VERSION\" && git submodule update --recursive --init && \\\n#   ./autogen.sh && ./configure && make\nRUN echo \"force rebuild b6\"\n#  Nominatim create site\n#  FIXME Eventually get rid of the need for the .pgpass file, but the latest osm2pgsql tool fails to read password from the PGPASS environment variable\n#  Alternatively, create the file dynamically within the container\nCOPY target/.pgpass /root/\nRUN chmod 600 /root/.pgpass\nCOPY local.php.dist ./src/settings/\nCOPY setup-patched.php ./src/utils/\nRUN chmod +x ./src/utils/setup-patched.php\nCOPY update-patched.php ./src/utils/\nRUN chmod +x ./src/utils/update-patched.php\nCOPY target/nominatim ./src/nominatim/\nRUN chmod +x ./src/nominatim/nominatim\nCOPY target/osm2pgsql ./src/osm2pgsql/\nRUN chmod +x ./src/osm2pgsql/osm2pgsql\nCOPY target/nominatim.so ./src/module/\nCOPY configuration.txt.dist ./src/settings/\n# RUN rm -rf /var/www/html/* && ./src/utils/setup.php --create-website /var/www/html\n#  Apache configure\n# COPY nominatim.conf /etc/apache2/sites-enabled/000-default.conf\n# ENV DB_HOST test\n# RUN echo \"xxxyyyDB: ${DB_HOST} $DB_URL\"\n#  Load initial data\n# ENV PBF_DATA http://download.geofabrik.de/europe/monaco-latest.osm.pbf\n# RUN curl -L $PBF_DATA --create-dirs -o /app/src/data.osm.pbf\n# RUN service postgresql start && \\\n#     psql \"$DB_URL\" -c \"CREATE ROLE nominatim;\" || true && \\\n#     psql \"$DB_URL\" -c \"CREATE ROLE www-data NOSUPERUSER NOCREATEDB NOCREATEROL;\" || true && \\\n#     psql \"$DB_URL\" -c \"CREATE DATABASE IF NOT EXISTS nominatim\" && \\\n#     sudo -u postgres psql postgres -c \"DROP DATABASE IF EXISTS nominatim\" && \\\n#     useradd -m -p password1234 nominatim && \\\n#     chown -R nominatim:nominatim ./src && \\\n#     sudo -u nominatim ./src/utils/setup.php --osm-file /app/src/data.osm.pbf --all --threads 2 && \\\n#     service postgresql stop\n# EXPOSE 5432\n# EXPOSE 8080\nCOPY start.sh .\nCMD ./start.sh\n","injectedSmells":[],"originalDockerfileHash":"fbed73cd9cc162f12edb6543a7c41d81","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM ubuntu:16.04\nMAINTAINER Claus Stadler <cstadler@informatik.uni-leipzig.de>\nENV DEBIAN_FRONTEND=\"noninteractive\"\nRUN echo \"force rebuild 7\"\nRUN apt-get update -y --fix-missing \\\n && apt-get install software-properties-common wget git curl sudo -y \\\n && apt-get update\nENV POSTGRES_CLIENT_VERSION=\"9.5\"\nENV POSTGIS_CLIENT_VERSION=\"2.2\"\n#  ENV POSTGRES_CLIENT_VERSION ${POSTGRES_VERSION}\n#  ENV POSTGIS_CLIENT_VERSION ${POSTGIS_VERSION}\nRUN echo \"pgclientver: ${POSTGRES_CLIENT_VERSION}\"\n#   for 16.04: libgeos-c1v5\nRUN apt-get install build-essential libxml2-dev libpq-dev libbz2-dev libtool automake libproj-dev libboost-dev libboost-system-dev libboost-filesystem-dev libboost-thread-dev libexpat-dev gcc proj-bin libgeos-c1v5 libgeos++-dev libexpat-dev php-pgsql php-json php-db postgresql postgis postgresql-contrib wget osm2pgsql osmosis gettext-base osmctools postgresql-${POSTGRES_CLIENT_VERSION}-postgis-${POSTGIS_CLIENT_VERSION} postgresql-server-dev-${POSTGRES_CLIENT_VERSION} -y\n#   Install the linked geo data package for the lgd-osm-replication-sequences tool\nRUN wget -qO - http://cstadler.aksw.org/repos/apt/conf/packages.precise.gpg.key | sudo apt-key add - \\\n && echo 'deb http://cstadler.aksw.org/repos/apt precise main contrib non-free' | sudo tee -a /etc/apt/sources.list.d/cstadler.aksw.org.list \\\n && apt-get update \\\n && apt-get install linkedgeodata -y\nWORKDIR /app/nominatim\n#   Nominatim install\nENV NOMINATIM_VERSION=\"v2.5.1\"\nRUN git clone https://github.com/openstreetmap/Nominatim ./src\nRUN cd ./src \\\n && git checkout \"$NOMINATIM_VERSION\"\n#  RUN git clone --recursive https://github.com/openstreetmap/Nominatim ./src\n#  RUN cd ./src && git checkout \"$NOMINATIM_VERSION\" && git submodule update --recursive --init && \\\n#    ./autogen.sh && ./configure && make\nRUN echo \"force rebuild b6\"\n#   Nominatim create site\n#   FIXME Eventually get rid of the need for the .pgpass file, but the latest osm2pgsql tool fails to read password from the PGPASS environment variable\n#   Alternatively, create the file dynamically within the container\nCOPY target/.pgpass /root/\nRUN chmod 600 /root/.pgpass\nCOPY local.php.dist ./src/settings/\nCOPY setup-patched.php ./src/utils/\nRUN chmod +x ./src/utils/setup-patched.php\nCOPY update-patched.php ./src/utils/\nRUN chmod +x ./src/utils/update-patched.php\nCOPY target/nominatim ./src/nominatim/\nRUN chmod +x ./src/nominatim/nominatim\nCOPY target/osm2pgsql ./src/osm2pgsql/\nRUN chmod +x ./src/osm2pgsql/osm2pgsql\nCOPY target/nominatim.so ./src/module/\nCOPY configuration.txt.dist ./src/settings/\n#  RUN rm -rf /var/www/html/* && ./src/utils/setup.php --create-website /var/www/html\n#   Apache configure\n#  COPY nominatim.conf /etc/apache2/sites-enabled/000-default.conf\n#  ENV DB_HOST test\n#  RUN echo \"xxxyyyDB: ${DB_HOST} $DB_URL\"\n#   Load initial data\n#  ENV PBF_DATA http://download.geofabrik.de/europe/monaco-latest.osm.pbf\n#  RUN curl -L $PBF_DATA --create-dirs -o /app/src/data.osm.pbf\n#  RUN service postgresql start && \\\n#      psql \"$DB_URL\" -c \"CREATE ROLE nominatim;\" || true && \\\n#      psql \"$DB_URL\" -c \"CREATE ROLE www-data NOSUPERUSER NOCREATEDB NOCREATEROL;\" || true && \\\n#      psql \"$DB_URL\" -c \"CREATE DATABASE IF NOT EXISTS nominatim\" && \\\n#      sudo -u postgres psql postgres -c \"DROP DATABASE IF EXISTS nominatim\" && \\\n#      useradd -m -p password1234 nominatim && \\\n#      chown -R nominatim:nominatim ./src && \\\n#      sudo -u nominatim ./src/utils/setup.php --osm-file /app/src/data.osm.pbf --all --threads 2 && \\\n#      service postgresql stop\n#  EXPOSE 5432\n#  EXPOSE 8080\nCOPY start.sh .\nCMD ./start.sh\n","originalDockerfileUglifiedHash":"40c387bbf3016a7f4022ab985e5ed58c","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/ee4306d6224220866ce0b7e038e0fdc1c756cfa4.dockerfile"}