{"seed":476546884,"processedDockerfileHash":"bbdbb25610d0d8b3cdf8bf5bef7b20ba","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apt-get","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM debian:buster-slim\nMAINTAINER Michal Čihař <michal@cihar.com>\nENV VERSION=\"3.7\"\nLABEL version=\"$VERSION\"\n#   Add user early to get a consistent userid\nRUN useradd --shell /bin/sh --user-group weblate \\\n && mkdir -p /home/weblate/.ssh \\\n && touch /home/weblate/.ssh/authorized_keys \\\n && chown -R weblate:weblate /home/weblate \\\n && chmod 700 /home/weblate/.ssh \\\n && install -d -o weblate -g weblate -m 755 /usr/local/lib/python3.7/dist-packages/data-test \\\n && install -d -o weblate -g weblate -m 755 /app/data\n#   Configure utf-8 locales to make sure Python\n#   correctly handles unicode filenames\nENV LANG=\"C.UTF-8\" \\\n    LC_ALL=\"C.UTF-8\"\nCOPY requirements.txt patches /usr/src/weblate/\n#   Install dependencies\nRUN set -x \\\n && export DEBIAN_FRONTEND=noninteractive \\\n && apt-get update \\\n && apt-get -y upgrade \\\n && apt-get install --no-install-recommends sudo=1.8.27-1+deb10u5 uwsgi=2.0.18-1 uwsgi-plugin-python3=2.0.18-1 netcat-openbsd=1.195-2 nginx=1.14.2-2+deb10u5 supervisor=3.3.5-1 openssh-client=1:7.9p1-10+deb10u2 curl=7.64.0-4+deb10u5 gir1.2-pango-1.0=1.42.4-8~deb10u1 python3-gi=3.30.4-1 python3-gi-cairo=3.30.4-1 python3-cairo=1.16.2-1+b1 python3-pip=18.1-5 python3-lxml=4.3.2-1+deb10u4 python3-yaml=3.13-2 python3-pillow python3-setuptools=40.8.0-1 python3-wheel=0.32.3-2 python3-gdbm=3.7.3-1 python3-psycopg2=2.7.7-1 python3-rcssmin=1.0.6-1+b3 python3-rjsmin=1.0.12+dfsg1-4+b2 gettext=0.19.8.1-9 postgresql-client=11+200+deb10u5 mercurial=4.8.2-1+deb10u1 git=1:2.20.1-2+deb10u8 git-svn=1:2.20.1-2+deb10u8 subversion=1.10.4-1+deb10u3 pkg-config=0.29-6 python3-dev=3.7.3-1 libxml2-dev=2.9.4+dfsg1-7+deb10u5 libxmlsec1-dev=1.2.27-2 libleptonica-dev=1.76.0-1+deb10u2 libtesseract-dev=4.0.0-2 libsasl2-dev=2.1.27+dfsg-1+deb10u2 libldap2-dev=2.4.47+dfsg-3+deb10u7 libssl-dev=1.1.1n-0+deb10u4 cython=0.29.2-2 gcc=4:8.3.0-1 g++=4:8.3.0-1 tesseract-ocr=4.0.0-2 patch=2.7.6-3+deb10u1 -y \\\n && pip3 install Weblate==$VERSION -r /usr/src/weblate/requirements.txt \\\n && python3 -c 'from phply.phpparse import make_parser; make_parser()' \\\n && ln -s /usr/local/share/weblate/examples/ /app/ \\\n && rm -rf /root/.cache /tmp/* \\\n && apt-get -y purge python3-dev pkg-config libleptonica-dev libtesseract-dev libxml2-dev libxmlsec1-dev cython gcc g++ libsasl2-dev libldap2-dev libssl-dev \\\n && apt-get -y autoremove \\\n && apt-get clean\n#   Hub\nRUN curl -L https://github.com/github/hub/releases/download/v2.2.9/hub-linux-amd64-2.2.9.tgz | tar xzv --wildcards hub-linux*/bin/hub \\\n && cp hub-linux-amd64-2.2.9/bin/hub /usr/bin \\\n && rm -rf hub-linux-amd64-2.2.9\n#   Configuration for Weblate, nginx, uwsgi and supervisor\nCOPY etc /etc/\nRUN chmod a+r /etc/weblate/settings.py \\\n && ln -s /etc/weblate/settings.py /usr/local/lib/python3.7/dist-packages/weblate/settings.py\n#   Apply hotfixes\nRUN find /usr/src/weblate -name '*.patch' -print0 | sort -z | xargs -n1 -0 -r patch -p1 -d /usr/local/lib/python3.7/dist-packages/ -i\n#   Entrypoint\nCOPY start /app/bin/\nRUN chmod a+rx /app/bin/start\nEXPOSE 80/tcp\nENTRYPOINT [\"/app/bin/start\"]\nCMD [\"runserver\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM debian:buster-slim\nMAINTAINER Michal Čihař <michal@cihar.com>\nENV VERSION=\"3.7\"\nLABEL version=\"$VERSION\"\n#  Add user early to get a consistent userid\nRUN useradd --shell /bin/sh --user-group weblate \\\n && mkdir -p /home/weblate/.ssh \\\n && touch /home/weblate/.ssh/authorized_keys \\\n && chown -R weblate:weblate /home/weblate \\\n && chmod 700 /home/weblate/.ssh \\\n && install -d -o weblate -g weblate -m 755 /usr/local/lib/python3.7/dist-packages/data-test \\\n && install -d -o weblate -g weblate -m 755 /app/data\n#  Configure utf-8 locales to make sure Python\n#  correctly handles unicode filenames\nENV LANG=\"C.UTF-8\" \\\n    LC_ALL=\"C.UTF-8\"\nCOPY requirements.txt patches /usr/src/weblate/\n#  Install dependencies\nRUN set -x \\\n && export DEBIAN_FRONTEND=noninteractive \\\n && apt-get update \\\n && apt-get -y upgrade \\\n && apt-get install --no-install-recommends sudo uwsgi uwsgi-plugin-python3 netcat-openbsd nginx supervisor openssh-client curl gir1.2-pango-1.0 python3-gi python3-gi-cairo python3-cairo python3-pip python3-lxml python3-yaml python3-pillow python3-setuptools python3-wheel python3-gdbm python3-psycopg2 python3-rcssmin python3-rjsmin gettext postgresql-client mercurial git git-svn subversion pkg-config python3-dev libxml2-dev libxmlsec1-dev libleptonica-dev libtesseract-dev libsasl2-dev libldap2-dev libssl-dev cython gcc g++ tesseract-ocr patch -y \\\n && pip3 install Weblate==$VERSION -r /usr/src/weblate/requirements.txt \\\n && python3 -c 'from phply.phpparse import make_parser; make_parser()' \\\n && ln -s /usr/local/share/weblate/examples/ /app/ \\\n && rm -rf /root/.cache /tmp/* \\\n && apt-get -y purge python3-dev pkg-config libleptonica-dev libtesseract-dev libxml2-dev libxmlsec1-dev cython gcc g++ libsasl2-dev libldap2-dev libssl-dev \\\n && apt-get -y autoremove \\\n && apt-get clean\n#  Hub\nRUN curl -L https://github.com/github/hub/releases/download/v2.2.9/hub-linux-amd64-2.2.9.tgz | tar xzv --wildcards hub-linux*/bin/hub \\\n && cp hub-linux-amd64-2.2.9/bin/hub /usr/bin \\\n && rm -rf hub-linux-amd64-2.2.9\n#  Configuration for Weblate, nginx, uwsgi and supervisor\nCOPY etc /etc/\nRUN chmod a+r /etc/weblate/settings.py \\\n && ln -s /etc/weblate/settings.py /usr/local/lib/python3.7/dist-packages/weblate/settings.py\n#  Apply hotfixes\nRUN find /usr/src/weblate -name '*.patch' -print0 | sort -z | xargs -n1 -0 -r patch -p1 -d /usr/local/lib/python3.7/dist-packages/ -i\n#  Entrypoint\nCOPY start /app/bin/\nRUN chmod a+rx /app/bin/start\nEXPOSE 80/tcp\nENTRYPOINT [\"/app/bin/start\"]\nCMD [\"runserver\"]\n","injectedSmells":[],"originalDockerfileHash":"3640ee244edee13cc28f03e31c678744","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM debian:buster-slim\nMAINTAINER Michal Čihař <michal@cihar.com>\nENV VERSION=\"3.7\"\nLABEL version=\"$VERSION\"\n#   Add user early to get a consistent userid\nRUN useradd --shell /bin/sh --user-group weblate \\\n && mkdir -p /home/weblate/.ssh \\\n && touch /home/weblate/.ssh/authorized_keys \\\n && chown -R weblate:weblate /home/weblate \\\n && chmod 700 /home/weblate/.ssh \\\n && install -d -o weblate -g weblate -m 755 /usr/local/lib/python3.7/dist-packages/data-test \\\n && install -d -o weblate -g weblate -m 755 /app/data\n#   Configure utf-8 locales to make sure Python\n#   correctly handles unicode filenames\nENV LANG=\"C.UTF-8\" \\\n    LC_ALL=\"C.UTF-8\"\nCOPY requirements.txt patches /usr/src/weblate/\n#   Install dependencies\nRUN set -x \\\n && export DEBIAN_FRONTEND=noninteractive \\\n && apt-get update \\\n && apt-get -y upgrade \\\n && apt-get install --no-install-recommends sudo uwsgi uwsgi-plugin-python3 netcat-openbsd nginx supervisor openssh-client curl gir1.2-pango-1.0 python3-gi python3-gi-cairo python3-cairo python3-pip python3-lxml python3-yaml python3-pillow python3-setuptools python3-wheel python3-gdbm python3-psycopg2 python3-rcssmin python3-rjsmin gettext postgresql-client mercurial git git-svn subversion pkg-config python3-dev libxml2-dev libxmlsec1-dev libleptonica-dev libtesseract-dev libsasl2-dev libldap2-dev libssl-dev cython gcc g++ tesseract-ocr patch -y \\\n && pip3 install Weblate==$VERSION -r /usr/src/weblate/requirements.txt \\\n && python3 -c 'from phply.phpparse import make_parser; make_parser()' \\\n && ln -s /usr/local/share/weblate/examples/ /app/ \\\n && rm -rf /root/.cache /tmp/* \\\n && apt-get -y purge python3-dev pkg-config libleptonica-dev libtesseract-dev libxml2-dev libxmlsec1-dev cython gcc g++ libsasl2-dev libldap2-dev libssl-dev \\\n && apt-get -y autoremove \\\n && apt-get clean\n#   Hub\nRUN curl -L https://github.com/github/hub/releases/download/v2.2.9/hub-linux-amd64-2.2.9.tgz | tar xzv --wildcards hub-linux*/bin/hub \\\n && cp hub-linux-amd64-2.2.9/bin/hub /usr/bin \\\n && rm -rf hub-linux-amd64-2.2.9\n#   Configuration for Weblate, nginx, uwsgi and supervisor\nCOPY etc /etc/\nRUN chmod a+r /etc/weblate/settings.py \\\n && ln -s /etc/weblate/settings.py /usr/local/lib/python3.7/dist-packages/weblate/settings.py\n#   Apply hotfixes\nRUN find /usr/src/weblate -name '*.patch' -print0 | sort -z | xargs -n1 -0 -r patch -p1 -d /usr/local/lib/python3.7/dist-packages/ -i\n#   Entrypoint\nCOPY start /app/bin/\nRUN chmod a+rx /app/bin/start\nEXPOSE 80/tcp\nENTRYPOINT [\"/app/bin/start\"]\nCMD [\"runserver\"]\n","originalDockerfileUglifiedHash":"7a73f222bad751cce3b1b1eaa2d79ed4","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/6056d9db9c4da397e597e09ac9f2d69f0dd41d65.dockerfile"}