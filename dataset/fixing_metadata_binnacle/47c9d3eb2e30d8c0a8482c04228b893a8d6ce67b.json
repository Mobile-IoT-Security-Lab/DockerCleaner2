{"seed":1889146453,"processedDockerfileHash":"14e904c1fabf22ebfa7be34d2ce9c526","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM centos:7\nRUN yum update -y \\\n && yum install -y environment-modules git glibc-static gcc gcc-c++ boost boost-devel cmake make zlib-devel ncurses-devel java-1.8.0-openjdk java-1.8.0-openjdk-devel unzip bzip2 gcc-gfortran perl-List-MoreUtils perl-IO-Compress libcurl-devel libxml2-devel openssl-devel gd-devel cairo-devel which\nWORKDIR /tmp\nRUN curl -O https://support.illumina.com/content/dam/illumina-support/documents/downloads/software/bcl2fastq/bcl2fastq2-v2.17.1.14-Linux-x86_64.rpm \\\n && curl -O http://linuxsoft.cern.ch/cern/centos/7/cern/x86_64/Packages/parallel-20150522-1.el7.cern.noarch.rpm \\\n && yum -y --nogpgcheck localinstall *.rpm\nRUN git clone https://github.com/BenLangmead/bowtie.git \\\n && cd bowtie \\\n && git checkout tags/v1.1.2 \\\n && make \\\n && make install\nRUN git clone https://github.com/BenLangmead/bowtie2.git \\\n && cd bowtie2 \\\n && git checkout tags/v2.2.6 \\\n && make \\\n && make install\nRUN mkdir -p /software/tophat/2.1.0 \\\n && curl -O http://ccb.jhu.edu/software/tophat/downloads/tophat-2.1.0.Linux_x86_64.tar.gz \\\n && tar -xzf tophat-2.1.0.Linux_x86_64.tar.gz -C /software/tophat/2.1.0 --strip-components=1\nRUN git clone https://github.com/samtools/htslib.git \\\n && cd htslib \\\n && git checkout tags/1.2 \\\n && cd .. \\\n && git clone https://github.com/samtools/samtools.git \\\n && cd samtools \\\n && git checkout tags/1.2 \\\n && make \\\n && make install\nRUN git clone https://github.com/lh3/bwa.git \\\n && cd bwa \\\n && git checkout tags/0.7.12 \\\n && make \\\n && cp bwa /usr/local/bin\nRUN mkdir -p /software/picard/1.131 \\\n && curl -L -O https://github.com/broadinstitute/picard/releases/download/1.131/picard-tools-1.131.zip \\\n && unzip picard-tools-1.131.zip \\\n && mv picard-tools-1.131 /software/picard/1.131\nRUN mkdir -p /software/R/3.2.2 \\\n && curl -O https://cran.cnr.berkeley.edu/src/base/R-3/R-3.2.2.tar.gz \\\n && tar -xzf R-3.2.2.tar.gz \\\n && cd R-3.2.2 \\\n && ./configure --prefix=/software/R/3.2.2 --without-readline --without-x \\\n && make \\\n && touch doc/NEWS.pdf \\\n && make install\nRUN mkdir -p /software/openmpi/1.6.3 \\\n && curl -L -O https://www.open-mpi.org/software/ompi/v1.6/downloads/openmpi-1.6.3.tar.gz \\\n && tar -xzf openmpi-1.6.3.tar.gz \\\n && cd openmpi-1.6.3 \\\n && ./configure --prefix=/software/openmpi/1.6.3 \\\n && make \\\n && make install\nRUN git clone https://github.com/shenlab-sinai/ngsplot.git \\\n && cd ngsplot \\\n && git checkout tags/2.47 \\\n && cp -r bin/* /usr/local/bin\nRUN git clone https://github.com/alexdobin/STAR.git \\\n && cd STAR \\\n && git checkout tags/2.5.2b \\\n && cp bin/Linux_x86_64_static/* /usr/local/bin\nCOPY docker/resources/modulefiles/ /etc/modulefiles/\nCOPY docker/resources/rsetup.R .\nRUN source /etc/profile.d/modules.sh \\\n && module load R \\\n && Rscript rsetup.R\nCOPY docker/resources/environment.yml .\nRUN mkdir -p /software/anaconda2 \\\n && curl -L -O https://repo.continuum.io/archive/Anaconda2-2.4.1-Linux-x86_64.sh \\\n && chmod 755 Anaconda2-2.4.1-Linux-x86_64.sh \\\n && bash Anaconda2-2.4.1-Linux-x86_64.sh -p /software/anaconda2 -f -b \\\n && /software/anaconda2/bin/conda env update -f environment.yml --name root\n#   have to manually install bzip2 b/c the bioconda version of pysam depends on it\nRUN source /etc/profile.d/modules.sh \\\n && module load python/anaconda \\\n && conda install -c conda-forge -y bzip2\nRUN rm -rf *\nRUN mkdir -p /projects/p20742/tools/bin\nWORKDIR /projects/p20742/tools/bin\n#   copy all R and perl scripts into image\nCOPY bin/* ./\n#   install the stuff that the pipeline runs directly inside /projects/p20742\nRUN curl -O http://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedToBigBed \\\n && chmod 755 bedToBigBed\nRUN curl -O https://www.bioinformatics.babraham.ac.uk/projects/fastqc/fastqc_v0.11.5.zip \\\n && unzip fastqc_v0.11.5.zip \\\n && chmod 755 FastQC/fastqc\nRUN mkdir GATK_v3.6 \\\n && cd GATK_v3.6 \\\n && curl -o GenomeAnalysisTK-3.6-0-g89b7209.tar.bz2 \"https://software.broadinstitute.org/gatk/download/auth?package=GATK-archive&version=3.6-0-g89b7209\" \\\n && bunzip2 GenomeAnalysisTK-3.6-0-g89b7209.tar.bz2 \\\n && tar xvf GenomeAnalysisTK-3.6-0-g89b7209.tar \\\n && mv resources/* .\nCOPY docker/resources/SICER_V1.1.tgz .\nRUN tar xvfz SICER_V1.1.tgz \\\n && cd SICER_V1.1/SICER \\\n && find . -name '*.sh' -print | xargs sed -i 's|/home/data/SICER1.1|/projects/p20742/tools/SICER_V1.1|g'\nRUN curl -O http://www.usadellab.org/cms/uploads/supplementary/Trimmomatic/Trimmomatic-0.33.zip \\\n && unzip Trimmomatic-0.33.zip\nRUN git clone https://github.com/taoliu/MACS.git MACS-1.4.2 \\\n && cd MACS-1.4.2 \\\n && git checkout tags/v1.4.2 \\\n && python setup.py install --prefix /projects/p20742/tools/MACS-1.4.2 \\\n && ln -s /projects/p20742/tools/MACS-1.4.2/lib/python2.7 /projects/p20742/tools/MACS-1.4.2/lib/python2.6\nRUN git clone https://github.com/deweylab/RSEM.git RSEM-1.3.0 \\\n && cd RSEM-1.3.0 \\\n && git checkout tags/v1.3.0 \\\n && make \\\n && source /etc/profile.d/modules.sh \\\n && module load R \\\n && make ebseq\nRUN curl -O https://www.bioinformatics.babraham.ac.uk/projects/fastq_screen/fastq_screen_v0.11.4.tar.gz \\\n && tar -zxf fastq_screen_v0.11.4.tar.gz\nCOPY docker/resources/fastq_screen.allRefs.conf fastq_screen_v0.11.4/\n#   have to symlink perl executable in order for buildPipelineScripts.pl to run\nRUN mkdir -p /software/activeperl/5.16/bin \\\n && ln -s /usr/bin/perl /software/activeperl/5.16/bin/perl\nWORKDIR /projects/p20742/tools\nCOPY docker/resources/wrapper.sh .\nRUN chmod 755 wrapper.sh\nRUN ln -s bin/buildPipelineScripts.pl buildPipelineScripts.pl\nENTRYPOINT [\"/projects/p20742/tools/wrapper.sh\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM centos:7\nRUN yum update -y \\\n && yum install -y environment-modules git glibc-static gcc gcc-c++ boost boost-devel cmake make zlib-devel ncurses-devel java-1.8.0-openjdk java-1.8.0-openjdk-devel unzip bzip2 gcc-gfortran perl-List-MoreUtils perl-IO-Compress libcurl-devel libxml2-devel openssl-devel gd-devel cairo-devel which\nWORKDIR /tmp\nRUN curl -O https://support.illumina.com/content/dam/illumina-support/documents/downloads/software/bcl2fastq/bcl2fastq2-v2.17.1.14-Linux-x86_64.rpm \\\n && curl -O http://linuxsoft.cern.ch/cern/centos/7/cern/x86_64/Packages/parallel-20150522-1.el7.cern.noarch.rpm \\\n && yum -y --nogpgcheck localinstall *.rpm\nRUN git clone https://github.com/BenLangmead/bowtie.git \\\n && cd bowtie \\\n && git checkout tags/v1.1.2 \\\n && make \\\n && make install\nRUN git clone https://github.com/BenLangmead/bowtie2.git \\\n && cd bowtie2 \\\n && git checkout tags/v2.2.6 \\\n && make \\\n && make install\nRUN mkdir -p /software/tophat/2.1.0 \\\n && curl -O http://ccb.jhu.edu/software/tophat/downloads/tophat-2.1.0.Linux_x86_64.tar.gz \\\n && tar -xzf tophat-2.1.0.Linux_x86_64.tar.gz -C /software/tophat/2.1.0 --strip-components=1\nRUN git clone https://github.com/samtools/htslib.git \\\n && cd htslib \\\n && git checkout tags/1.2 \\\n && cd .. \\\n && git clone https://github.com/samtools/samtools.git \\\n && cd samtools \\\n && git checkout tags/1.2 \\\n && make \\\n && make install\nRUN git clone https://github.com/lh3/bwa.git \\\n && cd bwa \\\n && git checkout tags/0.7.12 \\\n && make \\\n && cp bwa /usr/local/bin\nRUN mkdir -p /software/picard/1.131 \\\n && curl -L -O https://github.com/broadinstitute/picard/releases/download/1.131/picard-tools-1.131.zip \\\n && unzip picard-tools-1.131.zip \\\n && mv picard-tools-1.131 /software/picard/1.131\nRUN mkdir -p /software/R/3.2.2 \\\n && curl -O https://cran.cnr.berkeley.edu/src/base/R-3/R-3.2.2.tar.gz \\\n && tar -xzf R-3.2.2.tar.gz \\\n && cd R-3.2.2 \\\n && ./configure --prefix=/software/R/3.2.2 --without-readline --without-x \\\n && make \\\n && touch doc/NEWS.pdf \\\n && make install\nRUN mkdir -p /software/openmpi/1.6.3 \\\n && curl -L -O https://www.open-mpi.org/software/ompi/v1.6/downloads/openmpi-1.6.3.tar.gz \\\n && tar -xzf openmpi-1.6.3.tar.gz \\\n && cd openmpi-1.6.3 \\\n && ./configure --prefix=/software/openmpi/1.6.3 \\\n && make \\\n && make install\nRUN git clone https://github.com/shenlab-sinai/ngsplot.git \\\n && cd ngsplot \\\n && git checkout tags/2.47 \\\n && cp -r bin/* /usr/local/bin\nRUN git clone https://github.com/alexdobin/STAR.git \\\n && cd STAR \\\n && git checkout tags/2.5.2b \\\n && cp bin/Linux_x86_64_static/* /usr/local/bin\nCOPY docker/resources/modulefiles/ /etc/modulefiles/\nCOPY docker/resources/rsetup.R .\nRUN source /etc/profile.d/modules.sh \\\n && module load R \\\n && Rscript rsetup.R\nCOPY docker/resources/environment.yml .\nRUN mkdir -p /software/anaconda2 \\\n && curl -L -O https://repo.continuum.io/archive/Anaconda2-2.4.1-Linux-x86_64.sh \\\n && chmod 755 Anaconda2-2.4.1-Linux-x86_64.sh \\\n && bash Anaconda2-2.4.1-Linux-x86_64.sh -p /software/anaconda2 -f -b \\\n && /software/anaconda2/bin/conda env update -f environment.yml --name root\n#  have to manually install bzip2 b/c the bioconda version of pysam depends on it\nRUN source /etc/profile.d/modules.sh \\\n && module load python/anaconda \\\n && conda install -c conda-forge -y bzip2\nRUN rm -rf *\nRUN mkdir -p /projects/p20742/tools/bin\nWORKDIR /projects/p20742/tools/bin\n#  copy all R and perl scripts into image\nCOPY bin/* ./\n#  install the stuff that the pipeline runs directly inside /projects/p20742\nRUN curl -O http://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedToBigBed \\\n && chmod 755 bedToBigBed\nRUN curl -O https://www.bioinformatics.babraham.ac.uk/projects/fastqc/fastqc_v0.11.5.zip \\\n && unzip fastqc_v0.11.5.zip \\\n && chmod 755 FastQC/fastqc\nRUN mkdir GATK_v3.6 \\\n && cd GATK_v3.6 \\\n && curl -o GenomeAnalysisTK-3.6-0-g89b7209.tar.bz2 \"https://software.broadinstitute.org/gatk/download/auth?package=GATK-archive&version=3.6-0-g89b7209\" \\\n && bunzip2 GenomeAnalysisTK-3.6-0-g89b7209.tar.bz2 \\\n && tar xvf GenomeAnalysisTK-3.6-0-g89b7209.tar \\\n && mv resources/* .\nCOPY docker/resources/SICER_V1.1.tgz .\nRUN tar xvfz SICER_V1.1.tgz \\\n && cd SICER_V1.1/SICER \\\n && find . -name '*.sh' -print | xargs sed -i 's|/home/data/SICER1.1|/projects/p20742/tools/SICER_V1.1|g'\nRUN curl -O http://www.usadellab.org/cms/uploads/supplementary/Trimmomatic/Trimmomatic-0.33.zip \\\n && unzip Trimmomatic-0.33.zip\nRUN git clone https://github.com/taoliu/MACS.git MACS-1.4.2 \\\n && cd MACS-1.4.2 \\\n && git checkout tags/v1.4.2 \\\n && python setup.py install --prefix /projects/p20742/tools/MACS-1.4.2 \\\n && ln -s /projects/p20742/tools/MACS-1.4.2/lib/python2.7 /projects/p20742/tools/MACS-1.4.2/lib/python2.6\nRUN git clone https://github.com/deweylab/RSEM.git RSEM-1.3.0 \\\n && cd RSEM-1.3.0 \\\n && git checkout tags/v1.3.0 \\\n && make \\\n && source /etc/profile.d/modules.sh \\\n && module load R \\\n && make ebseq\nRUN curl -O https://www.bioinformatics.babraham.ac.uk/projects/fastq_screen/fastq_screen_v0.11.4.tar.gz \\\n && tar -zxf fastq_screen_v0.11.4.tar.gz\nCOPY docker/resources/fastq_screen.allRefs.conf fastq_screen_v0.11.4/\n#  have to symlink perl executable in order for buildPipelineScripts.pl to run\nRUN mkdir -p /software/activeperl/5.16/bin \\\n && ln -s /usr/bin/perl /software/activeperl/5.16/bin/perl\nWORKDIR /projects/p20742/tools\nCOPY docker/resources/wrapper.sh .\nRUN chmod 755 wrapper.sh\nRUN ln -s bin/buildPipelineScripts.pl buildPipelineScripts.pl\nENTRYPOINT [\"/projects/p20742/tools/wrapper.sh\"]\n","injectedSmells":[],"originalDockerfileHash":"3d855a1b72dae7e53e4ffb76709a1655","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM centos:7\nRUN yum update -y \\\n && yum install -y environment-modules git glibc-static gcc gcc-c++ boost boost-devel cmake make zlib-devel ncurses-devel java-1.8.0-openjdk java-1.8.0-openjdk-devel unzip bzip2 gcc-gfortran perl-List-MoreUtils perl-IO-Compress libcurl-devel libxml2-devel openssl-devel gd-devel cairo-devel which\nWORKDIR /tmp\nRUN curl -O https://support.illumina.com/content/dam/illumina-support/documents/downloads/software/bcl2fastq/bcl2fastq2-v2.17.1.14-Linux-x86_64.rpm \\\n && curl -O http://linuxsoft.cern.ch/cern/centos/7/cern/x86_64/Packages/parallel-20150522-1.el7.cern.noarch.rpm \\\n && yum -y --nogpgcheck localinstall *.rpm\nRUN git clone https://github.com/BenLangmead/bowtie.git \\\n && cd bowtie \\\n && git checkout tags/v1.1.2 \\\n && make \\\n && make install\nRUN git clone https://github.com/BenLangmead/bowtie2.git \\\n && cd bowtie2 \\\n && git checkout tags/v2.2.6 \\\n && make \\\n && make install\nRUN mkdir -p /software/tophat/2.1.0 \\\n && curl -O http://ccb.jhu.edu/software/tophat/downloads/tophat-2.1.0.Linux_x86_64.tar.gz \\\n && tar -xzf tophat-2.1.0.Linux_x86_64.tar.gz -C /software/tophat/2.1.0 --strip-components=1\nRUN git clone https://github.com/samtools/htslib.git \\\n && cd htslib \\\n && git checkout tags/1.2 \\\n && cd .. \\\n && git clone https://github.com/samtools/samtools.git \\\n && cd samtools \\\n && git checkout tags/1.2 \\\n && make \\\n && make install\nRUN git clone https://github.com/lh3/bwa.git \\\n && cd bwa \\\n && git checkout tags/0.7.12 \\\n && make \\\n && cp bwa /usr/local/bin\nRUN mkdir -p /software/picard/1.131 \\\n && curl -L -O https://github.com/broadinstitute/picard/releases/download/1.131/picard-tools-1.131.zip \\\n && unzip picard-tools-1.131.zip \\\n && mv picard-tools-1.131 /software/picard/1.131\nRUN mkdir -p /software/R/3.2.2 \\\n && curl -O https://cran.cnr.berkeley.edu/src/base/R-3/R-3.2.2.tar.gz \\\n && tar -xzf R-3.2.2.tar.gz \\\n && cd R-3.2.2 \\\n && ./configure --prefix=/software/R/3.2.2 --without-readline --without-x \\\n && make \\\n && touch doc/NEWS.pdf \\\n && make install\nRUN mkdir -p /software/openmpi/1.6.3 \\\n && curl -L -O https://www.open-mpi.org/software/ompi/v1.6/downloads/openmpi-1.6.3.tar.gz \\\n && tar -xzf openmpi-1.6.3.tar.gz \\\n && cd openmpi-1.6.3 \\\n && ./configure --prefix=/software/openmpi/1.6.3 \\\n && make \\\n && make install\nRUN git clone https://github.com/shenlab-sinai/ngsplot.git \\\n && cd ngsplot \\\n && git checkout tags/2.47 \\\n && cp -r bin/* /usr/local/bin\nRUN git clone https://github.com/alexdobin/STAR.git \\\n && cd STAR \\\n && git checkout tags/2.5.2b \\\n && cp bin/Linux_x86_64_static/* /usr/local/bin\nCOPY docker/resources/modulefiles/ /etc/modulefiles/\nCOPY docker/resources/rsetup.R .\nRUN source /etc/profile.d/modules.sh \\\n && module load R \\\n && Rscript rsetup.R\nCOPY docker/resources/environment.yml .\nRUN mkdir -p /software/anaconda2 \\\n && curl -L -O https://repo.continuum.io/archive/Anaconda2-2.4.1-Linux-x86_64.sh \\\n && chmod 755 Anaconda2-2.4.1-Linux-x86_64.sh \\\n && bash Anaconda2-2.4.1-Linux-x86_64.sh -p /software/anaconda2 -f -b \\\n && /software/anaconda2/bin/conda env update -f environment.yml --name root\n#   have to manually install bzip2 b/c the bioconda version of pysam depends on it\nRUN source /etc/profile.d/modules.sh \\\n && module load python/anaconda \\\n && conda install -c conda-forge -y bzip2\nRUN rm -rf *\nRUN mkdir -p /projects/p20742/tools/bin\nWORKDIR /projects/p20742/tools/bin\n#   copy all R and perl scripts into image\nCOPY bin/* ./\n#   install the stuff that the pipeline runs directly inside /projects/p20742\nRUN curl -O http://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/bedToBigBed \\\n && chmod 755 bedToBigBed\nRUN curl -O https://www.bioinformatics.babraham.ac.uk/projects/fastqc/fastqc_v0.11.5.zip \\\n && unzip fastqc_v0.11.5.zip \\\n && chmod 755 FastQC/fastqc\nRUN mkdir GATK_v3.6 \\\n && cd GATK_v3.6 \\\n && curl -o GenomeAnalysisTK-3.6-0-g89b7209.tar.bz2 \"https://software.broadinstitute.org/gatk/download/auth?package=GATK-archive&version=3.6-0-g89b7209\" \\\n && bunzip2 GenomeAnalysisTK-3.6-0-g89b7209.tar.bz2 \\\n && tar xvf GenomeAnalysisTK-3.6-0-g89b7209.tar \\\n && mv resources/* .\nCOPY docker/resources/SICER_V1.1.tgz .\nRUN tar xvfz SICER_V1.1.tgz \\\n && cd SICER_V1.1/SICER \\\n && find . -name '*.sh' -print | xargs sed -i 's|/home/data/SICER1.1|/projects/p20742/tools/SICER_V1.1|g'\nRUN curl -O http://www.usadellab.org/cms/uploads/supplementary/Trimmomatic/Trimmomatic-0.33.zip \\\n && unzip Trimmomatic-0.33.zip\nRUN git clone https://github.com/taoliu/MACS.git MACS-1.4.2 \\\n && cd MACS-1.4.2 \\\n && git checkout tags/v1.4.2 \\\n && python setup.py install --prefix /projects/p20742/tools/MACS-1.4.2 \\\n && ln -s /projects/p20742/tools/MACS-1.4.2/lib/python2.7 /projects/p20742/tools/MACS-1.4.2/lib/python2.6\nRUN git clone https://github.com/deweylab/RSEM.git RSEM-1.3.0 \\\n && cd RSEM-1.3.0 \\\n && git checkout tags/v1.3.0 \\\n && make \\\n && source /etc/profile.d/modules.sh \\\n && module load R \\\n && make ebseq\nRUN curl -O https://www.bioinformatics.babraham.ac.uk/projects/fastq_screen/fastq_screen_v0.11.4.tar.gz \\\n && tar -zxf fastq_screen_v0.11.4.tar.gz\nCOPY docker/resources/fastq_screen.allRefs.conf fastq_screen_v0.11.4/\n#   have to symlink perl executable in order for buildPipelineScripts.pl to run\nRUN mkdir -p /software/activeperl/5.16/bin \\\n && ln -s /usr/bin/perl /software/activeperl/5.16/bin/perl\nWORKDIR /projects/p20742/tools\nCOPY docker/resources/wrapper.sh .\nRUN chmod 755 wrapper.sh\nRUN ln -s bin/buildPipelineScripts.pl buildPipelineScripts.pl\nENTRYPOINT [\"/projects/p20742/tools/wrapper.sh\"]\n","originalDockerfileUglifiedHash":"5f1af57562a60894f0be86a55edc9269","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/47c9d3eb2e30d8c0a8482c04228b893a8d6ce67b.dockerfile"}