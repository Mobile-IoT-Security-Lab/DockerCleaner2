{"seed":3508694365,"processedDockerfileHash":"98f7e183ce360f7d47d94f06fe0c24a9","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","have-a-healthcheck","have-a-user"],"processedDockerfile":"ARG os=debian\nARG version=stretch\nARG variant=-slim\nARG mirror=http://deb.debian.org/debian\nARG system_ruby=ruby2.3\nFROM ${os}:${version}${variant}\nENV DEBIAN_FRONTEND=\"noninteractive\"\nARG mirror\nARG version\nARG system_ruby\nRUN dpkg --add-architecture i386 \\\n && echo \"deb-src ${mirror} ${version} main\" > /etc/apt/sources.list.d/deb-src.list \\\n && echo 'Dpkg::Use-Pty \"0\";\\nquiet \"2\";\\nAPT::Install-Recommends \"0\";' > /etc/apt/apt.conf.d/99autopilot \\\n && echo 'Acquire::HTTP::No-Cache \"True\";' > /etc/apt/apt.conf.d/99no-cache \\\n && apt-get update \\\n && apt-get install --no-install-recommends build-essential gcc-multilib bison rdfind file lib${system_ruby}:amd64 lib${system_ruby}:i386 \\\n && apt-get build-dep ${system_ruby} \\\n && rm -rf /var/lib/apt/lists/*\nWORKDIR /all-ruby\nCOPY Rakefile /all-ruby/\nCOPY lib/ruby_version.rb /all-ruby/lib/\nCOPY patch /all-ruby/patch/\nRUN rake setup_build\n#   rake -j interpret non-numeric argument as number of CPUs plus 3.\nARG j=numcpu_plus_alpha\nCOPY versions/0.* versions/1.* versions/2.0.0* versions/2.1* versions/2.2* /all-ruby/versions/\nRUN rake -j ${j} all-0\nRUN rake -j ${j} all-1.0\nRUN rake -j ${j} all-1.1a\nRUN rake -j ${j} all-1.1b\nRUN rake -j ${j} all-1.1c\nRUN rake -j ${j} all-1.1d\nRUN rake -j ${j} all-1.2\nRUN rake -j ${j} all-1.3\nRUN rake -j ${j} all-1.4\nRUN rake -j ${j} all-1.6\nRUN rake -j ${j} all-1.8\nRUN rake -j ${j} all-1.8.5\nRUN rake -j ${j} all-1.8.6\nRUN rake -j ${j} all-1.8.7\nRUN rake -j ${j} all-1.9.0\nRUN rake -j ${j} all-1.9.1\nRUN rake -j ${j} all-1.9.2\nRUN rake -j ${j} all-1.9.3\nRUN rake -j ${j} all-2.0.0\nRUN rake -j ${j} all-2.1\nRUN rake -j ${j} all-2.2\nCOPY versions/2.3* /all-ruby/versions/\nRUN rake -j ${j} all-2.3\nCOPY versions/2.4* /all-ruby/versions/\nRUN rake -j ${j} all-2.4\nCOPY versions/2.5* /all-ruby/versions/\nRUN rake -j ${j} all-2.5\nCOPY versions/2.6* /all-ruby/versions/\nRUN rake -j ${j} all-2.6\nCOPY versions/2.7* /all-ruby/versions/\nRUN rake -j ${j} all-2.7\nCOPY lib/* /all-ruby/lib/\nCOPY all-ruby /all-ruby/\n#  RUN du -s /build-all-ruby\nRUN rm -rf Rakefile versions/ patch/\n#  RUN du -s /build-all-ruby\nRUN rm -rf DIST build/*/log build/*/ruby*/\n#  RUN du -s /build-all-ruby\nRUN rm -rf build/*/man build/*/share/man build/*/share/doc build/*/share/ri\n#  RUN du -s /build-all-ruby\nRUN rm -f build/*/lib/libruby-static.a\n#  RUN du -s /build-all-ruby\nRUN rm -f build/*/bin/gcc build/*/bin/cc\n#  RUN du -s /build-all-ruby\nRUN find /build-all-ruby -type f\n#  RUN du -s /build-all-ruby\nRUN rdfind -makehardlinks true -makeresultsfile false /build-all-ruby\n#  RUN du -s /build-all-ruby\nFROM ${os}:${version}${variant}\nARG mirror\nARG version\nARG system_ruby\n#   gcc is required for mjit of ruby 2.6\nRUN dpkg --add-architecture i386 \\\n && echo \"deb-src ${mirror} ${version} main\" > /etc/apt/sources.list.d/deb-src.list \\\n && echo 'Dpkg::Use-Pty \"0\";\\nquiet \"2\";\\nAPT::Install-Recommends \"0\";' > /etc/apt/apt.conf.d/99autopilot \\\n && echo 'Acquire::HTTP::No-Cache \"True\";' > /etc/apt/apt.conf.d/99no-cache \\\n && apt-get update \\\n && apt-get install --no-install-recommends libc6:i386 libffi6:i386 libgcc1:i386 libgdbm3:i386 libncurses5:i386 libreadline7:i386 libssl1.0.2:i386 zlib1g:i386 libffi6:amd64 libgdbm3:amd64 libncurses5:amd64 libreadline7:amd64 libssl1.0.2:amd64 zlib1g:amd64 gcc ${system_ruby} \\\n && rm -rf /var/lib/apt/lists/*\nCOPY --from=0 /build-all-ruby/ /build-all-ruby\nCOPY --from=0 /all-ruby/ /all-ruby\nWORKDIR /all-ruby\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"ARG os=debian\nARG version=stretch\nARG variant=-slim\nARG mirror=http://deb.debian.org/debian\nARG system_ruby=ruby2.3\nFROM ${os}:${version}${variant}\nENV DEBIAN_FRONTEND=\"noninteractive\"\nARG mirror\nARG version\nARG system_ruby\nRUN dpkg --add-architecture i386 \\\n && echo \"deb-src ${mirror} ${version} main\" > /etc/apt/sources.list.d/deb-src.list \\\n && echo 'Dpkg::Use-Pty \"0\";\\nquiet \"2\";\\nAPT::Install-Recommends \"0\";' > /etc/apt/apt.conf.d/99autopilot \\\n && echo 'Acquire::HTTP::No-Cache \"True\";' > /etc/apt/apt.conf.d/99no-cache \\\n && apt-get update \\\n && apt-get install build-essential gcc-multilib bison rdfind file lib${system_ruby}:amd64 lib${system_ruby}:i386 \\\n && apt-get build-dep ${system_ruby} \\\n && rm -rf /var/lib/apt/lists/*\nWORKDIR /all-ruby\nCOPY Rakefile /all-ruby/\nCOPY lib/ruby_version.rb /all-ruby/lib/\nCOPY patch /all-ruby/patch/\nRUN rake setup_build\n#  rake -j interpret non-numeric argument as number of CPUs plus 3.\nARG j=numcpu_plus_alpha\nCOPY versions/0.* versions/1.* versions/2.0.0* versions/2.1* versions/2.2* /all-ruby/versions/\nRUN rake -j ${j} all-0\nRUN rake -j ${j} all-1.0\nRUN rake -j ${j} all-1.1a\nRUN rake -j ${j} all-1.1b\nRUN rake -j ${j} all-1.1c\nRUN rake -j ${j} all-1.1d\nRUN rake -j ${j} all-1.2\nRUN rake -j ${j} all-1.3\nRUN rake -j ${j} all-1.4\nRUN rake -j ${j} all-1.6\nRUN rake -j ${j} all-1.8\nRUN rake -j ${j} all-1.8.5\nRUN rake -j ${j} all-1.8.6\nRUN rake -j ${j} all-1.8.7\nRUN rake -j ${j} all-1.9.0\nRUN rake -j ${j} all-1.9.1\nRUN rake -j ${j} all-1.9.2\nRUN rake -j ${j} all-1.9.3\nRUN rake -j ${j} all-2.0.0\nRUN rake -j ${j} all-2.1\nRUN rake -j ${j} all-2.2\nCOPY versions/2.3* /all-ruby/versions/\nRUN rake -j ${j} all-2.3\nCOPY versions/2.4* /all-ruby/versions/\nRUN rake -j ${j} all-2.4\nCOPY versions/2.5* /all-ruby/versions/\nRUN rake -j ${j} all-2.5\nCOPY versions/2.6* /all-ruby/versions/\nRUN rake -j ${j} all-2.6\nCOPY versions/2.7* /all-ruby/versions/\nRUN rake -j ${j} all-2.7\nCOPY lib/* /all-ruby/lib/\nCOPY all-ruby /all-ruby/\n# RUN du -s /build-all-ruby\nRUN rm -rf Rakefile versions/ patch/\n# RUN du -s /build-all-ruby\nRUN rm -rf DIST build/*/log build/*/ruby*/\n# RUN du -s /build-all-ruby\nRUN rm -rf build/*/man build/*/share/man build/*/share/doc build/*/share/ri\n# RUN du -s /build-all-ruby\nRUN rm -f build/*/lib/libruby-static.a\n# RUN du -s /build-all-ruby\nRUN rm -f build/*/bin/gcc build/*/bin/cc\n# RUN du -s /build-all-ruby\nRUN find /build-all-ruby -type f ( -name ruby -o -name '*.so' ) -exec sh -c 'file $1 | grep -q \"not stripped\"' - '{}' ; -print0 | xargs -0 strip\n# RUN du -s /build-all-ruby\nRUN rdfind -makehardlinks true -makeresultsfile false /build-all-ruby\n# RUN du -s /build-all-ruby\nFROM ${os}:${version}${variant}\nARG mirror\nARG version\nARG system_ruby\n#  gcc is required for mjit of ruby 2.6\nRUN dpkg --add-architecture i386 \\\n && echo \"deb-src ${mirror} ${version} main\" > /etc/apt/sources.list.d/deb-src.list \\\n && echo 'Dpkg::Use-Pty \"0\";\\nquiet \"2\";\\nAPT::Install-Recommends \"0\";' > /etc/apt/apt.conf.d/99autopilot \\\n && echo 'Acquire::HTTP::No-Cache \"True\";' > /etc/apt/apt.conf.d/99no-cache \\\n && apt-get update \\\n && apt-get install libc6:i386 libffi6:i386 libgcc1:i386 libgdbm3:i386 libncurses5:i386 libreadline7:i386 libssl1.0.2:i386 zlib1g:i386 libffi6:amd64 libgdbm3:amd64 libncurses5:amd64 libreadline7:amd64 libssl1.0.2:amd64 zlib1g:amd64 gcc ${system_ruby} \\\n && rm -rf /var/lib/apt/lists/*\nCOPY --from=0 /build-all-ruby/ /build-all-ruby\nCOPY --from=0 /all-ruby/ /all-ruby\nWORKDIR /all-ruby\n","injectedSmells":[],"originalDockerfileHash":"567fe284acc27a0159e7bbabd1226d5d","successfullyInjectedSmells":[],"originalDockerfileUglified":"ARG os=debian\nARG version=stretch\nARG variant=-slim\nARG mirror=http://deb.debian.org/debian\nARG system_ruby=ruby2.3\nFROM ${os}:${version}${variant}\nENV DEBIAN_FRONTEND=\"noninteractive\"\nARG mirror\nARG version\nARG system_ruby\nRUN dpkg --add-architecture i386 \\\n && echo \"deb-src ${mirror} ${version} main\" > /etc/apt/sources.list.d/deb-src.list \\\n && echo 'Dpkg::Use-Pty \"0\";\\nquiet \"2\";\\nAPT::Install-Recommends \"0\";' > /etc/apt/apt.conf.d/99autopilot \\\n && echo 'Acquire::HTTP::No-Cache \"True\";' > /etc/apt/apt.conf.d/99no-cache \\\n && apt-get update \\\n && apt-get install build-essential gcc-multilib bison rdfind file lib${system_ruby}:amd64 lib${system_ruby}:i386 \\\n && apt-get build-dep ${system_ruby} \\\n && rm -rf /var/lib/apt/lists/*\nWORKDIR /all-ruby\nCOPY Rakefile /all-ruby/\nCOPY lib/ruby_version.rb /all-ruby/lib/\nCOPY patch /all-ruby/patch/\nRUN rake setup_build\n#   rake -j interpret non-numeric argument as number of CPUs plus 3.\nARG j=numcpu_plus_alpha\nCOPY versions/0.* versions/1.* versions/2.0.0* versions/2.1* versions/2.2* /all-ruby/versions/\nRUN rake -j ${j} all-0\nRUN rake -j ${j} all-1.0\nRUN rake -j ${j} all-1.1a\nRUN rake -j ${j} all-1.1b\nRUN rake -j ${j} all-1.1c\nRUN rake -j ${j} all-1.1d\nRUN rake -j ${j} all-1.2\nRUN rake -j ${j} all-1.3\nRUN rake -j ${j} all-1.4\nRUN rake -j ${j} all-1.6\nRUN rake -j ${j} all-1.8\nRUN rake -j ${j} all-1.8.5\nRUN rake -j ${j} all-1.8.6\nRUN rake -j ${j} all-1.8.7\nRUN rake -j ${j} all-1.9.0\nRUN rake -j ${j} all-1.9.1\nRUN rake -j ${j} all-1.9.2\nRUN rake -j ${j} all-1.9.3\nRUN rake -j ${j} all-2.0.0\nRUN rake -j ${j} all-2.1\nRUN rake -j ${j} all-2.2\nCOPY versions/2.3* /all-ruby/versions/\nRUN rake -j ${j} all-2.3\nCOPY versions/2.4* /all-ruby/versions/\nRUN rake -j ${j} all-2.4\nCOPY versions/2.5* /all-ruby/versions/\nRUN rake -j ${j} all-2.5\nCOPY versions/2.6* /all-ruby/versions/\nRUN rake -j ${j} all-2.6\nCOPY versions/2.7* /all-ruby/versions/\nRUN rake -j ${j} all-2.7\nCOPY lib/* /all-ruby/lib/\nCOPY all-ruby /all-ruby/\n#  RUN du -s /build-all-ruby\nRUN rm -rf Rakefile versions/ patch/\n#  RUN du -s /build-all-ruby\nRUN rm -rf DIST build/*/log build/*/ruby*/\n#  RUN du -s /build-all-ruby\nRUN rm -rf build/*/man build/*/share/man build/*/share/doc build/*/share/ri\n#  RUN du -s /build-all-ruby\nRUN rm -f build/*/lib/libruby-static.a\n#  RUN du -s /build-all-ruby\nRUN rm -f build/*/bin/gcc build/*/bin/cc\n#  RUN du -s /build-all-ruby\nRUN find /build-all-ruby -type f\n#  RUN du -s /build-all-ruby\nRUN rdfind -makehardlinks true -makeresultsfile false /build-all-ruby\n#  RUN du -s /build-all-ruby\nFROM ${os}:${version}${variant}\nARG mirror\nARG version\nARG system_ruby\n#   gcc is required for mjit of ruby 2.6\nRUN dpkg --add-architecture i386 \\\n && echo \"deb-src ${mirror} ${version} main\" > /etc/apt/sources.list.d/deb-src.list \\\n && echo 'Dpkg::Use-Pty \"0\";\\nquiet \"2\";\\nAPT::Install-Recommends \"0\";' > /etc/apt/apt.conf.d/99autopilot \\\n && echo 'Acquire::HTTP::No-Cache \"True\";' > /etc/apt/apt.conf.d/99no-cache \\\n && apt-get update \\\n && apt-get install libc6:i386 libffi6:i386 libgcc1:i386 libgdbm3:i386 libncurses5:i386 libreadline7:i386 libssl1.0.2:i386 zlib1g:i386 libffi6:amd64 libgdbm3:amd64 libncurses5:amd64 libreadline7:amd64 libssl1.0.2:amd64 zlib1g:amd64 gcc ${system_ruby} \\\n && rm -rf /var/lib/apt/lists/*\nCOPY --from=0 /build-all-ruby/ /build-all-ruby\nCOPY --from=0 /all-ruby/ /all-ruby\nWORKDIR /all-ruby\n","originalDockerfileUglifiedHash":"6126d6358964caab1b26ed2ffbc5806c","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/4d6e3d1dbf115c75928117eb7cd839d80f4c7d3d.dockerfile"}