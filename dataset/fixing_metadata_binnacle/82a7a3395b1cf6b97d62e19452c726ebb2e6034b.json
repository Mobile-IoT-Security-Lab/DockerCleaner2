{"seed":134371460,"processedDockerfileHash":"d250970f8817a5093bb8ca8c6e11b694","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apt-get","have-a-healthcheck","have-a-user"],"processedDockerfile":"#\n#   Dockerfile for Magento CE\n#\nFROM ubuntu:16.04\nMAINTAINER Azure App Service Container Images <appsvc-images@microsoft.com>\n#   ========\n#   ENV vars\n#   ========\n#   apache httpd\nENV HTTPD_VERSION=\"\\\"2.4.25\\\"\"\nENV HTTPD_DOWNLOAD_URL=\"\\\"https://www.apache.org/dist/httpd/httpd-$HTTPD_VERSION.tar.gz\\\"\"\nENV HTTPD_SHA1=\"\\\"377c62dc6b25c9378221111dec87c28f8fe6ac69\\\"\"\nENV HTTPD_SOURCE=\"\\\"/usr/src/httpd\\\"\"\nENV HTTPD_HOME=\"\\\"/usr/local/httpd\\\"\"\nENV HTTPD_CONF_DIR=\"\\\"$HTTPD_HOME/conf\\\"\"\nENV HTTPD_CONF_FILE=\"\\\"$HTTPD_CONF_DIR/httpd.conf\\\"\"\nENV HTTPD_LOG_DIR=\"/var/log/httpd\"\nENV PATH=\"\\\"$HTTPD_HOME/bin\\\":$PATH\"\n#   php\n#  ## see http://devdocs.magento.com/guides/v2.1/install-gde/prereq/php-ubuntu.html#php-support\nENV PHP_VERSION=\"\\\"7.0.16\\\"\"\nENV PHP_DOWNLOAD_URL=\"\\\"https://secure.php.net/get/php-$PHP_VERSION.tar.gz/from/this/mirror\\\"\"\nENV PHP_SHA256=\"\\\"bc6709dc7612957d0533c09c9c8a9c2e7c4fd9d64e697707bb1b39670eab61d4\\\"\"\nENV PHP_SOURCE=\"\\\"/usr/src/php\\\"\"\nENV PHP_HOME=\"\\\"/usr/local/php\\\"\"\nENV PHP_CONF_DIR=\"\\\"$PHP_HOME/etc\\\"\"\nENV PHP_CONF_DIR_SCAN=\"\\\"$PHP_CONF_DIR/conf.d\\\"\"\nENV PATH=\"\\\"$PHP_HOME/bin\\\":$PATH\"\n#   mariadb\nENV MARIADB_DATA_DIR=\"/var/lib/mysql\"\nENV MARIADB_LOG_DIR=\"/var/log/mysql\"\nENV MARIADB_DATA_DIR_TEMP=\"/tmp/mariadb\"\n#   redis\nENV REDIS_VERSION=\"\\\"3.2.8\\\"\"\nENV REDIS_DOWNLOAD_URL=\"\\\"http://download.redis.io/releases/redis-$REDIS_VERSION.tar.gz\\\"\"\nENV REDIS_SHA1=\"\\\"6780d1abb66f33a97aad0edbe020403d0a15b67f\\\"\"\nENV REDIS_SOURCE=\"\\\"/usr/src/redis\\\"\"\nENV REDIS_HOME=\"\\\"/usr/local/redis\\\"\"\nENV PATH=\"\\\"$REDIS_HOME/bin\\\":$PATH\"\n#   magento ce\nENV MAGENTO_VERSION=\"\\\"2.1.5\\\"\"\nENV MAGENTO_PACKAGE=\"\\\"Magento-CE-$MAGENTO_VERSION.tar.gz\\\"\"\nENV MAGENTO_SOURCE=\"\\\"/usr/src/magento\\\"\"\nENV MAGENTO_HOME=\"\\\"/var/www/magento\\\"\"\nENV PATH=\"\\\"$MAGENTO_HOME/bin\\\":$PATH\"\n#   phpMyAdmin\nENV PHPMYADMIN_VERSION=\"\\\"4.6.6\\\"\"\nENV PHPMYADMIN_DOWNLOAD_URL=\"\\\"https://files.phpmyadmin.net/phpMyAdmin/$PHPMYADMIN_VERSION/phpMyAdmin-$PHPMYADMIN_VERSION-all-languages.tar.gz\\\"\"\nENV PHPMYADMIN_SHA256=\"\\\"54086600558613b31c4daddf4ae58fbc1c252a2b8e3e6fae12f851f78677d72e\\\"\"\nENV PHPMYADMIN_SOURCE=\"\\\"/usr/src/phpmyadmin\\\"\"\nENV PHPMYADMIN_HOME=\"\\\"/var/www/phpmyadmin\\\"\"\nENV DOCKER_BUILD_HOME=\"\\\"/dockerbuild\\\"\"\n#   ====================\n#   Download and Install\n#   1. tools\n#   2. apache httpd\n#   3. php\n#   4. mariadb\n#   5. redis\n#   6. magento ce\n#   7. phpmyadmin\n#   8. cron\n#   ====================\nWORKDIR $DOCKER_BUILD_HOME\nCOPY $MAGENTO_PACKAGE $DOCKER_BUILD_HOME/\nRUN set -ex \\\n && tools=\" g++ gcc make pkg-config wget \" \\\n && apt-get update \\\n && apt-get install --no-install-recommends $tools -y -V \\\n && rm -r /var/lib/apt/lists/* \\\n && mkdir -p $HTTPD_SOURCE \\\n && mkdir -p $HTTPD_HOME \\\n && httpdBuildtimeDeps=\" libpcre++-dev libssl-dev \" \\\n && httpdRuntimeDeps=\" libapr1 libaprutil1 libaprutil1-ldap libapr1-dev libaprutil1-dev \" \\\n && apt-get update \\\n && apt-get install --no-install-recommends $httpdBuildtimeDeps $httpdRuntimeDeps -y -V \\\n && rm -r /var/lib/apt/lists/* \\\n && cd $DOCKER_BUILD_HOME \\\n && wget -O httpd.tar.gz \"$HTTPD_DOWNLOAD_URL\" --no-check-certificate \\\n && echo \"$HTTPD_SHA1 *httpd.tar.gz\" | sha1sum -c - \\\n && tar -xf httpd.tar.gz -C $HTTPD_SOURCE --strip-components=1 \\\n && cd $HTTPD_SOURCE \\\n && ./configure --prefix=$HTTPD_HOME --with-mpm=prefork --enable-mods-shared=reallyall --enable-ssl \\\n && make -j \"$( nproc ;)\" \\\n && make install \\\n && rm -rf $HTTPD_SOURCE $HTTPD_HOME/man $HTTPD_HOME/manual \\\n && rm $DOCKER_BUILD_HOME/httpd.tar.gz \\\n && apt-get purge -y -V -o APT::AutoRemove::RecommendsImportant=false --auto-remove $httpdBuildtimeDeps \\\n && mkdir -p $PHP_SOURCE \\\n && mkdir -p $PHP_HOME \\\n && phpBuildtimeDeps=\" libbz2-dev libgmp-dev libicu-dev libjpeg-dev libpng12-dev libldap2-dev libmcrypt-dev libmhash-dev libssl-dev libxml2-dev libxslt-dev \" \\\n && phpRuntimeDeps=\" libcurl4-openssl-dev libjpeg8 libpng12-0 libmcrypt4 libxml2 libxslt1.1 \" \\\n && apt-get update \\\n && apt-get install --no-install-recommends $phpBuildtimeDeps $phpRuntimeDeps -y -V \\\n && rm -rf /var/lib/apt/lists/* \\\n && ln -s /usr/include/x86_64-linux-gnu/gmp.h /usr/include/gmp.h \\\n && ln -s /usr/lib/x86_64-linux-gnu/libldap.so /usr/lib/libldap.so \\\n && ln -s /usr/lib/x86_64-linux-gnu/liblber.so /usr/lib/liblber.so \\\n && cd $DOCKER_BUILD_HOME \\\n && wget -O php.tar.gz \"$PHP_DOWNLOAD_URL\" --no-check-certificate \\\n && echo \"$PHP_SHA256 *php.tar.gz\" | sha256sum -c - \\\n && tar -xf php.tar.gz -C $PHP_SOURCE --strip-components=1 \\\n && cd $PHP_SOURCE \\\n && ./configure --prefix=$PHP_HOME --disable-cgi --enable-bcmath --enable-intl --enable-mbstring --enable-soap --enable-zip --with-apxs2=$HTTPD_HOME/bin/apxs --with-bz2 --with-config-file-path=$PHP_CONF_DIR --with-config-file-scan-dir=$PHP_CONF_DIR_SCAN --with-curl --with-gd --with-jpeg-dir --with-png-dir --with-gmp --with-ldap --with-mcrypt --with-mhash --with-mysqli=mysqlnd --with-openssl --with-pdo-mysql=mysqlnd --with-xsl \\\n && make -j \"$( nproc ;)\" \\\n && make install \\\n && rm -rf $PHP_SOURCE \\\n && rm -rf $PHP_HOME/php/man \\\n && rm $DOCKER_BUILD_HOME/php.tar.gz \\\n && apt-get purge -y -V -o APT::AutoRemove::RecommendsImportant=false --auto-remove $phpBuildtimeDeps \\\n && apt-get update \\\n && DEBIAN_FRONTEND=noninteractive apt-get install mariadb-server -y -V --no-install-recommends \\\n && rm -r /var/lib/apt/lists/* \\\n && mkdir -p $REDIS_SOURCE \\\n && mkdir -p $REDIS_HOME \\\n && cd $DOCKER_BUILD_HOME \\\n && wget -O redis.tar.gz \"$REDIS_DOWNLOAD_URL\" --no-check-certificate \\\n && echo \"$REDIS_SHA1 *redis.tar.gz\" | sha1sum -c - \\\n && tar -xf redis.tar.gz -C $REDIS_SOURCE --strip-components=1 \\\n && cd $REDIS_SOURCE \\\n && make -j \"$( nproc ;)\" \\\n && make PREFIX=$REDIS_HOME install \\\n && rm -rf $REDIS_SOURCE \\\n && rm $DOCKER_BUILD_HOME/redis.tar.gz \\\n && mkdir -p $MAGENTO_SOURCE \\\n && cd $DOCKER_BUILD_HOME \\\n && tar -xf $MAGENTO_PACKAGE -C $MAGENTO_SOURCE \\\n && rm $DOCKER_BUILD_HOME/$MAGENTO_PACKAGE \\\n && mkdir -p $PHPMYADMIN_SOURCE \\\n && cd $DOCKER_BUILD_HOME \\\n && wget -O phpmyadmin.tar.gz \"$PHPMYADMIN_DOWNLOAD_URL\" --no-check-certificate \\\n && echo \"$PHPMYADMIN_SHA256 *phpmyadmin.tar.gz\" | sha256sum -c - \\\n && tar -xf phpmyadmin.tar.gz -C $PHPMYADMIN_SOURCE --strip-components=1 \\\n && rm $DOCKER_BUILD_HOME/phpmyadmin.tar.gz \\\n && apt-get update \\\n && apt-get install --no-install-recommends cron=3.0pl1-128ubuntu2 -y -V \\\n && rm -r /var/lib/apt/lists/* \\\n && apt-get purge -y -V -o APT::AutoRemove::RecommendsImportant=false --auto-remove $tools \\\n && apt-get autoremove -y\n#   ==============\n#   Configurations \n#   ==============\n#   httpd confs\nCOPY httpd.conf $HTTPD_CONF_DIR/\nCOPY httpd-modules.conf $HTTPD_CONF_DIR/\nCOPY httpd-php.conf $HTTPD_CONF_DIR/\nCOPY httpd-magento.conf $HTTPD_CONF_DIR/\nCOPY httpd-phpmyadmin.conf $HTTPD_CONF_DIR/\n#   php confs\nCOPY php.ini $PHP_CONF_DIR/\nCOPY php-log.ini $PHP_CONF_DIR_SCAN/\nCOPY php-opcache.ini $PHP_CONF_DIR_SCAN/\n#   phpmyadmin config\nCOPY phpmyadmin-config.inc.php $PHPMYADMIN_SOURCE/config.inc.php\nRUN set -ex \\\n && echo 'Include conf/httpd-php.conf' >> $HTTPD_CONF_FILE \\\n && test ! -d /var/lib/php/sessions \\\n && mkdir -p /var/lib/php/sessions \\\n && chown www-data:www-data /var/lib/php/sessions\n#   =====================================\n#   Azure Web App on Linux configurations\n#   =====================================\n#   /home is a shared directory among multiple web app instances\n#   /home/site/wwwroot for Magento site\n#   /home/phpmyadmin for phpMyAdmin site\n#   /home/data for native MariaDB data dir\n#   /home/LogFiles/httpd for httpd/php/magento/phpmyadmin logs\n#   /home/LogFiles/mariadb for mariadb logs\nENV AZURE_SITE_ROOT=\"\\\"/home/site/wwwroot\\\"\"\nENV PHPMYADMIN_HOME_AZURE=\"\\\"/home/phpmyadmin\\\"\"\nENV MARIADB_DATA_DIR_AZURE=\"\\\"/home/data\\\"\"\nENV HTTPD_LOG_DIR_AZURE=\"\\\"/home/LogFiles/httpd\\\"\"\nENV MARIADB_LOG_DIR_AZURE=\"\\\"/home/LogFiles/mariadb\\\"\"\n#   =====\n#   final\n#   =====\nCOPY entrypoint.sh /usr/local/bin/\nRUN set -ex \\\n && chmod +x /usr/local/bin/entrypoint.sh \\\n && test ! -d /var/www \\\n && mkdir -p /var/www \\\n && echo '<html><head><meta http-equiv=\"refresh\" content=\"15\" /><title>Installing Magento ...</title></head><body>Installing Magento ... This could be done in minutes. But it will take longer if running on Azure Web App for Linux.</body></html>' > /var/www/index.html \\\n && chown -R www-data:www-data /var/www \\\n && chmod 664 /var/www/index.html\nEXPOSE 80/tcp\nENTRYPOINT [\"entrypoint.sh\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#\n#  Dockerfile for Magento CE\n#\nFROM ubuntu:16.04\nMAINTAINER Azure App Service Container Images <appsvc-images@microsoft.com>\n#  ========\n#  ENV vars\n#  ========\n#  apache httpd\nENV HTTPD_VERSION=\"\\\"2.4.25\\\"\"\nENV HTTPD_DOWNLOAD_URL=\"\\\"https://www.apache.org/dist/httpd/httpd-$HTTPD_VERSION.tar.gz\\\"\"\nENV HTTPD_SHA1=\"\\\"377c62dc6b25c9378221111dec87c28f8fe6ac69\\\"\"\nENV HTTPD_SOURCE=\"\\\"/usr/src/httpd\\\"\"\nENV HTTPD_HOME=\"\\\"/usr/local/httpd\\\"\"\nENV HTTPD_CONF_DIR=\"\\\"$HTTPD_HOME/conf\\\"\"\nENV HTTPD_CONF_FILE=\"\\\"$HTTPD_CONF_DIR/httpd.conf\\\"\"\nENV HTTPD_LOG_DIR=\"/var/log/httpd\"\nENV PATH=\"\\\"$HTTPD_HOME/bin\\\":$PATH\"\n#  php\n# ## see http://devdocs.magento.com/guides/v2.1/install-gde/prereq/php-ubuntu.html#php-support\nENV PHP_VERSION=\"\\\"7.0.16\\\"\"\nENV PHP_DOWNLOAD_URL=\"\\\"https://secure.php.net/get/php-$PHP_VERSION.tar.gz/from/this/mirror\\\"\"\nENV PHP_SHA256=\"\\\"bc6709dc7612957d0533c09c9c8a9c2e7c4fd9d64e697707bb1b39670eab61d4\\\"\"\nENV PHP_SOURCE=\"\\\"/usr/src/php\\\"\"\nENV PHP_HOME=\"\\\"/usr/local/php\\\"\"\nENV PHP_CONF_DIR=\"\\\"$PHP_HOME/etc\\\"\"\nENV PHP_CONF_DIR_SCAN=\"\\\"$PHP_CONF_DIR/conf.d\\\"\"\nENV PATH=\"\\\"$PHP_HOME/bin\\\":$PATH\"\n#  mariadb\nENV MARIADB_DATA_DIR=\"/var/lib/mysql\"\nENV MARIADB_LOG_DIR=\"/var/log/mysql\"\nENV MARIADB_DATA_DIR_TEMP=\"/tmp/mariadb\"\n#  redis\nENV REDIS_VERSION=\"\\\"3.2.8\\\"\"\nENV REDIS_DOWNLOAD_URL=\"\\\"http://download.redis.io/releases/redis-$REDIS_VERSION.tar.gz\\\"\"\nENV REDIS_SHA1=\"\\\"6780d1abb66f33a97aad0edbe020403d0a15b67f\\\"\"\nENV REDIS_SOURCE=\"\\\"/usr/src/redis\\\"\"\nENV REDIS_HOME=\"\\\"/usr/local/redis\\\"\"\nENV PATH=\"\\\"$REDIS_HOME/bin\\\":$PATH\"\n#  magento ce\nENV MAGENTO_VERSION=\"\\\"2.1.5\\\"\"\nENV MAGENTO_PACKAGE=\"\\\"Magento-CE-$MAGENTO_VERSION.tar.gz\\\"\"\nENV MAGENTO_SOURCE=\"\\\"/usr/src/magento\\\"\"\nENV MAGENTO_HOME=\"\\\"/var/www/magento\\\"\"\nENV PATH=\"\\\"$MAGENTO_HOME/bin\\\":$PATH\"\n#  phpMyAdmin\nENV PHPMYADMIN_VERSION=\"\\\"4.6.6\\\"\"\nENV PHPMYADMIN_DOWNLOAD_URL=\"\\\"https://files.phpmyadmin.net/phpMyAdmin/$PHPMYADMIN_VERSION/phpMyAdmin-$PHPMYADMIN_VERSION-all-languages.tar.gz\\\"\"\nENV PHPMYADMIN_SHA256=\"\\\"54086600558613b31c4daddf4ae58fbc1c252a2b8e3e6fae12f851f78677d72e\\\"\"\nENV PHPMYADMIN_SOURCE=\"\\\"/usr/src/phpmyadmin\\\"\"\nENV PHPMYADMIN_HOME=\"\\\"/var/www/phpmyadmin\\\"\"\nENV DOCKER_BUILD_HOME=\"\\\"/dockerbuild\\\"\"\n#  ====================\n#  Download and Install\n#  1. tools\n#  2. apache httpd\n#  3. php\n#  4. mariadb\n#  5. redis\n#  6. magento ce\n#  7. phpmyadmin\n#  8. cron\n#  ====================\nWORKDIR $DOCKER_BUILD_HOME\nCOPY $MAGENTO_PACKAGE $DOCKER_BUILD_HOME/\nRUN set -ex \\\n && tools=\" g++ gcc make pkg-config wget \" \\\n && apt-get update \\\n && apt-get install --no-install-recommends $tools -y -V \\\n && rm -r /var/lib/apt/lists/* \\\n && mkdir -p $HTTPD_SOURCE \\\n && mkdir -p $HTTPD_HOME \\\n && httpdBuildtimeDeps=\" libpcre++-dev libssl-dev \" \\\n && httpdRuntimeDeps=\" libapr1 libaprutil1 libaprutil1-ldap libapr1-dev libaprutil1-dev \" \\\n && apt-get update \\\n && apt-get install --no-install-recommends $httpdBuildtimeDeps $httpdRuntimeDeps -y -V \\\n && rm -r /var/lib/apt/lists/* \\\n && cd $DOCKER_BUILD_HOME \\\n && wget -O httpd.tar.gz \"$HTTPD_DOWNLOAD_URL\" --no-check-certificate \\\n && echo \"$HTTPD_SHA1 *httpd.tar.gz\" | sha1sum -c - \\\n && tar -xf httpd.tar.gz -C $HTTPD_SOURCE --strip-components=1 \\\n && cd $HTTPD_SOURCE \\\n && ./configure --prefix=$HTTPD_HOME --with-mpm=prefork --enable-mods-shared=reallyall --enable-ssl \\\n && make -j \"$( nproc ;)\" \\\n && make install \\\n && rm -rf $HTTPD_SOURCE $HTTPD_HOME/man $HTTPD_HOME/manual \\\n && rm $DOCKER_BUILD_HOME/httpd.tar.gz \\\n && apt-get purge -y -V -o APT::AutoRemove::RecommendsImportant=false --auto-remove $httpdBuildtimeDeps \\\n && mkdir -p $PHP_SOURCE \\\n && mkdir -p $PHP_HOME \\\n && phpBuildtimeDeps=\" libbz2-dev libgmp-dev libicu-dev libjpeg-dev libpng12-dev libldap2-dev libmcrypt-dev libmhash-dev libssl-dev libxml2-dev libxslt-dev \" \\\n && phpRuntimeDeps=\" libcurl4-openssl-dev libjpeg8 libpng12-0 libmcrypt4 libxml2 libxslt1.1 \" \\\n && apt-get update \\\n && apt-get install --no-install-recommends $phpBuildtimeDeps $phpRuntimeDeps -y -V \\\n && rm -rf /var/lib/apt/lists/* \\\n && ln -s /usr/include/x86_64-linux-gnu/gmp.h /usr/include/gmp.h \\\n && ln -s /usr/lib/x86_64-linux-gnu/libldap.so /usr/lib/libldap.so \\\n && ln -s /usr/lib/x86_64-linux-gnu/liblber.so /usr/lib/liblber.so \\\n && cd $DOCKER_BUILD_HOME \\\n && wget -O php.tar.gz \"$PHP_DOWNLOAD_URL\" --no-check-certificate \\\n && echo \"$PHP_SHA256 *php.tar.gz\" | sha256sum -c - \\\n && tar -xf php.tar.gz -C $PHP_SOURCE --strip-components=1 \\\n && cd $PHP_SOURCE \\\n && ./configure --prefix=$PHP_HOME --disable-cgi --enable-bcmath --enable-intl --enable-mbstring --enable-soap --enable-zip --with-apxs2=$HTTPD_HOME/bin/apxs --with-bz2 --with-config-file-path=$PHP_CONF_DIR --with-config-file-scan-dir=$PHP_CONF_DIR_SCAN --with-curl --with-gd --with-jpeg-dir --with-png-dir --with-gmp --with-ldap --with-mcrypt --with-mhash --with-mysqli=mysqlnd --with-openssl --with-pdo-mysql=mysqlnd --with-xsl \\\n && make -j \"$( nproc ;)\" \\\n && make install \\\n && rm -rf $PHP_SOURCE \\\n && rm -rf $PHP_HOME/php/man \\\n && rm $DOCKER_BUILD_HOME/php.tar.gz \\\n && apt-get purge -y -V -o APT::AutoRemove::RecommendsImportant=false --auto-remove $phpBuildtimeDeps \\\n && apt-get update \\\n && DEBIAN_FRONTEND=noninteractive apt-get install mariadb-server -y -V --no-install-recommends \\\n && rm -r /var/lib/apt/lists/* \\\n && mkdir -p $REDIS_SOURCE \\\n && mkdir -p $REDIS_HOME \\\n && cd $DOCKER_BUILD_HOME \\\n && wget -O redis.tar.gz \"$REDIS_DOWNLOAD_URL\" --no-check-certificate \\\n && echo \"$REDIS_SHA1 *redis.tar.gz\" | sha1sum -c - \\\n && tar -xf redis.tar.gz -C $REDIS_SOURCE --strip-components=1 \\\n && cd $REDIS_SOURCE \\\n && make -j \"$( nproc ;)\" \\\n && make PREFIX=$REDIS_HOME install \\\n && rm -rf $REDIS_SOURCE \\\n && rm $DOCKER_BUILD_HOME/redis.tar.gz \\\n && mkdir -p $MAGENTO_SOURCE \\\n && cd $DOCKER_BUILD_HOME \\\n && tar -xf $MAGENTO_PACKAGE -C $MAGENTO_SOURCE \\\n && rm $DOCKER_BUILD_HOME/$MAGENTO_PACKAGE \\\n && mkdir -p $PHPMYADMIN_SOURCE \\\n && cd $DOCKER_BUILD_HOME \\\n && wget -O phpmyadmin.tar.gz \"$PHPMYADMIN_DOWNLOAD_URL\" --no-check-certificate \\\n && echo \"$PHPMYADMIN_SHA256 *phpmyadmin.tar.gz\" | sha256sum -c - \\\n && tar -xf phpmyadmin.tar.gz -C $PHPMYADMIN_SOURCE --strip-components=1 \\\n && rm $DOCKER_BUILD_HOME/phpmyadmin.tar.gz \\\n && apt-get update \\\n && apt-get install --no-install-recommends cron -y -V \\\n && rm -r /var/lib/apt/lists/* \\\n && apt-get purge -y -V -o APT::AutoRemove::RecommendsImportant=false --auto-remove $tools \\\n && apt-get autoremove -y\n#  ==============\n#  Configurations \n#  ==============\n#  httpd confs\nCOPY httpd.conf $HTTPD_CONF_DIR/\nCOPY httpd-modules.conf $HTTPD_CONF_DIR/\nCOPY httpd-php.conf $HTTPD_CONF_DIR/\nCOPY httpd-magento.conf $HTTPD_CONF_DIR/\nCOPY httpd-phpmyadmin.conf $HTTPD_CONF_DIR/\n#  php confs\nCOPY php.ini $PHP_CONF_DIR/\nCOPY php-log.ini $PHP_CONF_DIR_SCAN/\nCOPY php-opcache.ini $PHP_CONF_DIR_SCAN/\n#  phpmyadmin config\nCOPY phpmyadmin-config.inc.php $PHPMYADMIN_SOURCE/config.inc.php\nRUN set -ex \\\n && echo 'Include conf/httpd-php.conf' >> $HTTPD_CONF_FILE \\\n && test ! -d /var/lib/php/sessions \\\n && mkdir -p /var/lib/php/sessions \\\n && chown www-data:www-data /var/lib/php/sessions\n#  =====================================\n#  Azure Web App on Linux configurations\n#  =====================================\n#  /home is a shared directory among multiple web app instances\n#  /home/site/wwwroot for Magento site\n#  /home/phpmyadmin for phpMyAdmin site\n#  /home/data for native MariaDB data dir\n#  /home/LogFiles/httpd for httpd/php/magento/phpmyadmin logs\n#  /home/LogFiles/mariadb for mariadb logs\nENV AZURE_SITE_ROOT=\"\\\"/home/site/wwwroot\\\"\"\nENV PHPMYADMIN_HOME_AZURE=\"\\\"/home/phpmyadmin\\\"\"\nENV MARIADB_DATA_DIR_AZURE=\"\\\"/home/data\\\"\"\nENV HTTPD_LOG_DIR_AZURE=\"\\\"/home/LogFiles/httpd\\\"\"\nENV MARIADB_LOG_DIR_AZURE=\"\\\"/home/LogFiles/mariadb\\\"\"\n#  =====\n#  final\n#  =====\nCOPY entrypoint.sh /usr/local/bin/\nRUN set -ex \\\n && chmod +x /usr/local/bin/entrypoint.sh \\\n && test ! -d /var/www \\\n && mkdir -p /var/www \\\n && echo '<html><head><meta http-equiv=\"refresh\" content=\"15\" /><title>Installing Magento ...</title></head><body>Installing Magento ... This could be done in minutes. But it will take longer if running on Azure Web App for Linux.</body></html>' > /var/www/index.html \\\n && chown -R www-data:www-data /var/www \\\n && chmod 664 /var/www/index.html\nEXPOSE 80/tcp\nENTRYPOINT [\"entrypoint.sh\"]\n","injectedSmells":[],"originalDockerfileHash":"70dba70bd1472a79a33870b708025884","successfullyInjectedSmells":[],"originalDockerfileUglified":"#\n#   Dockerfile for Magento CE\n#\nFROM ubuntu:16.04\nMAINTAINER Azure App Service Container Images <appsvc-images@microsoft.com>\n#   ========\n#   ENV vars\n#   ========\n#   apache httpd\nENV HTTPD_VERSION=\"\\\"2.4.25\\\"\"\nENV HTTPD_DOWNLOAD_URL=\"\\\"https://www.apache.org/dist/httpd/httpd-$HTTPD_VERSION.tar.gz\\\"\"\nENV HTTPD_SHA1=\"\\\"377c62dc6b25c9378221111dec87c28f8fe6ac69\\\"\"\nENV HTTPD_SOURCE=\"\\\"/usr/src/httpd\\\"\"\nENV HTTPD_HOME=\"\\\"/usr/local/httpd\\\"\"\nENV HTTPD_CONF_DIR=\"\\\"$HTTPD_HOME/conf\\\"\"\nENV HTTPD_CONF_FILE=\"\\\"$HTTPD_CONF_DIR/httpd.conf\\\"\"\nENV HTTPD_LOG_DIR=\"/var/log/httpd\"\nENV PATH=\"\\\"$HTTPD_HOME/bin\\\":$PATH\"\n#   php\n#  ## see http://devdocs.magento.com/guides/v2.1/install-gde/prereq/php-ubuntu.html#php-support\nENV PHP_VERSION=\"\\\"7.0.16\\\"\"\nENV PHP_DOWNLOAD_URL=\"\\\"https://secure.php.net/get/php-$PHP_VERSION.tar.gz/from/this/mirror\\\"\"\nENV PHP_SHA256=\"\\\"bc6709dc7612957d0533c09c9c8a9c2e7c4fd9d64e697707bb1b39670eab61d4\\\"\"\nENV PHP_SOURCE=\"\\\"/usr/src/php\\\"\"\nENV PHP_HOME=\"\\\"/usr/local/php\\\"\"\nENV PHP_CONF_DIR=\"\\\"$PHP_HOME/etc\\\"\"\nENV PHP_CONF_DIR_SCAN=\"\\\"$PHP_CONF_DIR/conf.d\\\"\"\nENV PATH=\"\\\"$PHP_HOME/bin\\\":$PATH\"\n#   mariadb\nENV MARIADB_DATA_DIR=\"/var/lib/mysql\"\nENV MARIADB_LOG_DIR=\"/var/log/mysql\"\nENV MARIADB_DATA_DIR_TEMP=\"/tmp/mariadb\"\n#   redis\nENV REDIS_VERSION=\"\\\"3.2.8\\\"\"\nENV REDIS_DOWNLOAD_URL=\"\\\"http://download.redis.io/releases/redis-$REDIS_VERSION.tar.gz\\\"\"\nENV REDIS_SHA1=\"\\\"6780d1abb66f33a97aad0edbe020403d0a15b67f\\\"\"\nENV REDIS_SOURCE=\"\\\"/usr/src/redis\\\"\"\nENV REDIS_HOME=\"\\\"/usr/local/redis\\\"\"\nENV PATH=\"\\\"$REDIS_HOME/bin\\\":$PATH\"\n#   magento ce\nENV MAGENTO_VERSION=\"\\\"2.1.5\\\"\"\nENV MAGENTO_PACKAGE=\"\\\"Magento-CE-$MAGENTO_VERSION.tar.gz\\\"\"\nENV MAGENTO_SOURCE=\"\\\"/usr/src/magento\\\"\"\nENV MAGENTO_HOME=\"\\\"/var/www/magento\\\"\"\nENV PATH=\"\\\"$MAGENTO_HOME/bin\\\":$PATH\"\n#   phpMyAdmin\nENV PHPMYADMIN_VERSION=\"\\\"4.6.6\\\"\"\nENV PHPMYADMIN_DOWNLOAD_URL=\"\\\"https://files.phpmyadmin.net/phpMyAdmin/$PHPMYADMIN_VERSION/phpMyAdmin-$PHPMYADMIN_VERSION-all-languages.tar.gz\\\"\"\nENV PHPMYADMIN_SHA256=\"\\\"54086600558613b31c4daddf4ae58fbc1c252a2b8e3e6fae12f851f78677d72e\\\"\"\nENV PHPMYADMIN_SOURCE=\"\\\"/usr/src/phpmyadmin\\\"\"\nENV PHPMYADMIN_HOME=\"\\\"/var/www/phpmyadmin\\\"\"\nENV DOCKER_BUILD_HOME=\"\\\"/dockerbuild\\\"\"\n#   ====================\n#   Download and Install\n#   1. tools\n#   2. apache httpd\n#   3. php\n#   4. mariadb\n#   5. redis\n#   6. magento ce\n#   7. phpmyadmin\n#   8. cron\n#   ====================\nWORKDIR $DOCKER_BUILD_HOME\nCOPY $MAGENTO_PACKAGE $DOCKER_BUILD_HOME/\nRUN set -ex \\\n && tools=\" g++ gcc make pkg-config wget \" \\\n && apt-get update \\\n && apt-get install --no-install-recommends $tools -y -V \\\n && rm -r /var/lib/apt/lists/* \\\n && mkdir -p $HTTPD_SOURCE \\\n && mkdir -p $HTTPD_HOME \\\n && httpdBuildtimeDeps=\" libpcre++-dev libssl-dev \" \\\n && httpdRuntimeDeps=\" libapr1 libaprutil1 libaprutil1-ldap libapr1-dev libaprutil1-dev \" \\\n && apt-get update \\\n && apt-get install --no-install-recommends $httpdBuildtimeDeps $httpdRuntimeDeps -y -V \\\n && rm -r /var/lib/apt/lists/* \\\n && cd $DOCKER_BUILD_HOME \\\n && wget -O httpd.tar.gz \"$HTTPD_DOWNLOAD_URL\" --no-check-certificate \\\n && echo \"$HTTPD_SHA1 *httpd.tar.gz\" | sha1sum -c - \\\n && tar -xf httpd.tar.gz -C $HTTPD_SOURCE --strip-components=1 \\\n && cd $HTTPD_SOURCE \\\n && ./configure --prefix=$HTTPD_HOME --with-mpm=prefork --enable-mods-shared=reallyall --enable-ssl \\\n && make -j \"$( nproc ;)\" \\\n && make install \\\n && rm -rf $HTTPD_SOURCE $HTTPD_HOME/man $HTTPD_HOME/manual \\\n && rm $DOCKER_BUILD_HOME/httpd.tar.gz \\\n && apt-get purge -y -V -o APT::AutoRemove::RecommendsImportant=false --auto-remove $httpdBuildtimeDeps \\\n && mkdir -p $PHP_SOURCE \\\n && mkdir -p $PHP_HOME \\\n && phpBuildtimeDeps=\" libbz2-dev libgmp-dev libicu-dev libjpeg-dev libpng12-dev libldap2-dev libmcrypt-dev libmhash-dev libssl-dev libxml2-dev libxslt-dev \" \\\n && phpRuntimeDeps=\" libcurl4-openssl-dev libjpeg8 libpng12-0 libmcrypt4 libxml2 libxslt1.1 \" \\\n && apt-get update \\\n && apt-get install --no-install-recommends $phpBuildtimeDeps $phpRuntimeDeps -y -V \\\n && rm -rf /var/lib/apt/lists/* \\\n && ln -s /usr/include/x86_64-linux-gnu/gmp.h /usr/include/gmp.h \\\n && ln -s /usr/lib/x86_64-linux-gnu/libldap.so /usr/lib/libldap.so \\\n && ln -s /usr/lib/x86_64-linux-gnu/liblber.so /usr/lib/liblber.so \\\n && cd $DOCKER_BUILD_HOME \\\n && wget -O php.tar.gz \"$PHP_DOWNLOAD_URL\" --no-check-certificate \\\n && echo \"$PHP_SHA256 *php.tar.gz\" | sha256sum -c - \\\n && tar -xf php.tar.gz -C $PHP_SOURCE --strip-components=1 \\\n && cd $PHP_SOURCE \\\n && ./configure --prefix=$PHP_HOME --disable-cgi --enable-bcmath --enable-intl --enable-mbstring --enable-soap --enable-zip --with-apxs2=$HTTPD_HOME/bin/apxs --with-bz2 --with-config-file-path=$PHP_CONF_DIR --with-config-file-scan-dir=$PHP_CONF_DIR_SCAN --with-curl --with-gd --with-jpeg-dir --with-png-dir --with-gmp --with-ldap --with-mcrypt --with-mhash --with-mysqli=mysqlnd --with-openssl --with-pdo-mysql=mysqlnd --with-xsl \\\n && make -j \"$( nproc ;)\" \\\n && make install \\\n && rm -rf $PHP_SOURCE \\\n && rm -rf $PHP_HOME/php/man \\\n && rm $DOCKER_BUILD_HOME/php.tar.gz \\\n && apt-get purge -y -V -o APT::AutoRemove::RecommendsImportant=false --auto-remove $phpBuildtimeDeps \\\n && apt-get update \\\n && DEBIAN_FRONTEND=noninteractive apt-get install mariadb-server -y -V --no-install-recommends \\\n && rm -r /var/lib/apt/lists/* \\\n && mkdir -p $REDIS_SOURCE \\\n && mkdir -p $REDIS_HOME \\\n && cd $DOCKER_BUILD_HOME \\\n && wget -O redis.tar.gz \"$REDIS_DOWNLOAD_URL\" --no-check-certificate \\\n && echo \"$REDIS_SHA1 *redis.tar.gz\" | sha1sum -c - \\\n && tar -xf redis.tar.gz -C $REDIS_SOURCE --strip-components=1 \\\n && cd $REDIS_SOURCE \\\n && make -j \"$( nproc ;)\" \\\n && make PREFIX=$REDIS_HOME install \\\n && rm -rf $REDIS_SOURCE \\\n && rm $DOCKER_BUILD_HOME/redis.tar.gz \\\n && mkdir -p $MAGENTO_SOURCE \\\n && cd $DOCKER_BUILD_HOME \\\n && tar -xf $MAGENTO_PACKAGE -C $MAGENTO_SOURCE \\\n && rm $DOCKER_BUILD_HOME/$MAGENTO_PACKAGE \\\n && mkdir -p $PHPMYADMIN_SOURCE \\\n && cd $DOCKER_BUILD_HOME \\\n && wget -O phpmyadmin.tar.gz \"$PHPMYADMIN_DOWNLOAD_URL\" --no-check-certificate \\\n && echo \"$PHPMYADMIN_SHA256 *phpmyadmin.tar.gz\" | sha256sum -c - \\\n && tar -xf phpmyadmin.tar.gz -C $PHPMYADMIN_SOURCE --strip-components=1 \\\n && rm $DOCKER_BUILD_HOME/phpmyadmin.tar.gz \\\n && apt-get update \\\n && apt-get install --no-install-recommends cron -y -V \\\n && rm -r /var/lib/apt/lists/* \\\n && apt-get purge -y -V -o APT::AutoRemove::RecommendsImportant=false --auto-remove $tools \\\n && apt-get autoremove -y\n#   ==============\n#   Configurations \n#   ==============\n#   httpd confs\nCOPY httpd.conf $HTTPD_CONF_DIR/\nCOPY httpd-modules.conf $HTTPD_CONF_DIR/\nCOPY httpd-php.conf $HTTPD_CONF_DIR/\nCOPY httpd-magento.conf $HTTPD_CONF_DIR/\nCOPY httpd-phpmyadmin.conf $HTTPD_CONF_DIR/\n#   php confs\nCOPY php.ini $PHP_CONF_DIR/\nCOPY php-log.ini $PHP_CONF_DIR_SCAN/\nCOPY php-opcache.ini $PHP_CONF_DIR_SCAN/\n#   phpmyadmin config\nCOPY phpmyadmin-config.inc.php $PHPMYADMIN_SOURCE/config.inc.php\nRUN set -ex \\\n && echo 'Include conf/httpd-php.conf' >> $HTTPD_CONF_FILE \\\n && test ! -d /var/lib/php/sessions \\\n && mkdir -p /var/lib/php/sessions \\\n && chown www-data:www-data /var/lib/php/sessions\n#   =====================================\n#   Azure Web App on Linux configurations\n#   =====================================\n#   /home is a shared directory among multiple web app instances\n#   /home/site/wwwroot for Magento site\n#   /home/phpmyadmin for phpMyAdmin site\n#   /home/data for native MariaDB data dir\n#   /home/LogFiles/httpd for httpd/php/magento/phpmyadmin logs\n#   /home/LogFiles/mariadb for mariadb logs\nENV AZURE_SITE_ROOT=\"\\\"/home/site/wwwroot\\\"\"\nENV PHPMYADMIN_HOME_AZURE=\"\\\"/home/phpmyadmin\\\"\"\nENV MARIADB_DATA_DIR_AZURE=\"\\\"/home/data\\\"\"\nENV HTTPD_LOG_DIR_AZURE=\"\\\"/home/LogFiles/httpd\\\"\"\nENV MARIADB_LOG_DIR_AZURE=\"\\\"/home/LogFiles/mariadb\\\"\"\n#   =====\n#   final\n#   =====\nCOPY entrypoint.sh /usr/local/bin/\nRUN set -ex \\\n && chmod +x /usr/local/bin/entrypoint.sh \\\n && test ! -d /var/www \\\n && mkdir -p /var/www \\\n && echo '<html><head><meta http-equiv=\"refresh\" content=\"15\" /><title>Installing Magento ...</title></head><body>Installing Magento ... This could be done in minutes. But it will take longer if running on Azure Web App for Linux.</body></html>' > /var/www/index.html \\\n && chown -R www-data:www-data /var/www \\\n && chmod 664 /var/www/index.html\nEXPOSE 80/tcp\nENTRYPOINT [\"entrypoint.sh\"]\n","originalDockerfileUglifiedHash":"027eb03b74e0abcf61f2ebea3e4780a7","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/82a7a3395b1cf6b97d62e19452c726ebb2e6034b.dockerfile"}