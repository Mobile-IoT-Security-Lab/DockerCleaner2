{"seed":1202483144,"processedDockerfileHash":"f4ca7b2c0d1f170622e743dea7134d94","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apt-get","have-a-healthcheck"],"processedDockerfile":"#   Copyright 2017 AT&T Intellectual Property.  All other rights reserved.\n#\n#   Licensed under the Apache License, Version 2.0 (the \"License\");\n#   you may not use this file except in compliance with the License.\n#   You may obtain a copy of the License at\n#\n#       http://www.apache.org/licenses/LICENSE-2.0\n#\n#   Unless required by applicable law or agreed to in writing, software\n#   distributed under the License is distributed on an \"AS IS\" BASIS,\n#   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n#   See the License for the specific language governing permissions and\n#   limitations under the License.\nARG FROM=ubuntu:16.04\nFROM ${FROM}\nLABEL org.opencontainers.image.authors=\"airship-discuss@lists.airshipit.org, irc://#airshipit@freenode\"\nLABEL org.opencontainers.image.url=\"https://airshipit.org\"\nLABEL org.opencontainers.image.documentation=\"https://airship-shipyard.readthedocs.org\"\nLABEL org.opencontainers.image.source=\"https://git.openstack.org/openstack/airship-shipyard\"\nLABEL org.opencontainers.image.vendor=\"The Airship Authors\"\nLABEL org.opencontainers.image.licenses=\"Apache-2.0\"\nENV container=\"docker\"\nENV PORT=\"9000\"\nENV LC_ALL=\"C.UTF-8\"\nENV LANG=\"C.UTF-8\"\n#   Setting the version explicitly for PBR\nENV PBR_VERSION=\"0.1a1\"\nARG DEBIAN_FRONTEND=noninteractive\nARG ctx_base=src/bin\n#   Expose port 9000 for application\nEXPOSE $PORT\nRUN set -ex \\\n && apt-get update -qq \\\n && apt-get install --no-install-recommends ca-certificates=20230311 curl=7.88.1-7ubuntu1 netbase=6.4 python3-dev=3.11.2-1 python3-setuptools=66.1.1-1 -y \\\n && apt-get autoremove -yqq --purge \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* /usr/share/man /usr/share/doc /usr/share/doc-base\n#   Create shipyard user\nRUN useradd -ms /bin/bash shipyard \\\n && mkdir -p /home/shipyard/shipyard \\\n && mkdir -p /home/shipyard/shipyard_client\n#   Copy entrypoint.sh to /home/shipyard\nCOPY ${ctx_base}/shipyard_airflow/entrypoint.sh /home/shipyard/entrypoint.sh\n#   Change permissions and set up directories\nRUN chown -R shipyard: /home/shipyard \\\n && chmod +x /home/shipyard/entrypoint.sh\n#   Requirements and Shipyard source\nCOPY ${ctx_base}/shipyard_airflow/requirements.txt /home/shipyard/api_requirements.txt\nCOPY ${ctx_base}/shipyard_client/requirements.txt /home/shipyard/client_requirements.txt\nCOPY ${ctx_base}/shipyard_client /home/shipyard/shipyard_client/\nCOPY ${ctx_base}/shipyard_airflow /home/shipyard/shipyard/\n#   Build\nRUN set -ex \\\n && buildDeps=' gcc git libssl-dev make python3-pip ' \\\n && apt-get update -qq \\\n && apt-get install --no-install-recommends $buildDeps -y -y \\\n && python3 -m pip install -U pip \\\n && pip3 install -r /home/shipyard/client_requirements.txt --no-cache-dir \\\n && cd /home/shipyard/shipyard_client \\\n && python3 setup.py install \\\n && pip3 install -r /home/shipyard/api_requirements.txt --no-cache-dir \\\n && cd /home/shipyard/shipyard \\\n && python3 setup.py install \\\n && apt-get purge -y --auto-remove $buildDeps \\\n && apt-get autoremove -yqq --purge \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* /usr/share/man /usr/share/doc /usr/share/doc-base\n#   Entrypoint\nENTRYPOINT [\"/home/shipyard/entrypoint.sh\"]\nCMD [\"server\"]\n#   Set user to shipyard\nUSER shipyard\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  Copyright 2017 AT&T Intellectual Property.  All other rights reserved.\n#\n#  Licensed under the Apache License, Version 2.0 (the \"License\");\n#  you may not use this file except in compliance with the License.\n#  You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n#  Unless required by applicable law or agreed to in writing, software\n#  distributed under the License is distributed on an \"AS IS\" BASIS,\n#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n#  See the License for the specific language governing permissions and\n#  limitations under the License.\nARG FROM=ubuntu:16.04\nFROM ${FROM}\nLABEL org.opencontainers.image.authors=\"airship-discuss@lists.airshipit.org, irc://#airshipit@freenode\"\nLABEL org.opencontainers.image.url=\"https://airshipit.org\"\nLABEL org.opencontainers.image.documentation=\"https://airship-shipyard.readthedocs.org\"\nLABEL org.opencontainers.image.source=\"https://git.openstack.org/openstack/airship-shipyard\"\nLABEL org.opencontainers.image.vendor=\"The Airship Authors\"\nLABEL org.opencontainers.image.licenses=\"Apache-2.0\"\nENV container=\"docker\"\nENV PORT=\"9000\"\nENV LC_ALL=\"C.UTF-8\"\nENV LANG=\"C.UTF-8\"\n#  Setting the version explicitly for PBR\nENV PBR_VERSION=\"0.1a1\"\nARG DEBIAN_FRONTEND=noninteractive\nARG ctx_base=src/bin\n#  Expose port 9000 for application\nEXPOSE $PORT\nRUN set -ex \\\n && apt-get update -qq \\\n && apt-get install --no-install-recommends ca-certificates curl netbase python3-dev python3-setuptools -y \\\n && apt-get autoremove -yqq --purge \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* /usr/share/man /usr/share/doc /usr/share/doc-base\n#  Create shipyard user\nRUN useradd -ms /bin/bash shipyard \\\n && mkdir -p /home/shipyard/shipyard \\\n && mkdir -p /home/shipyard/shipyard_client\n#  Copy entrypoint.sh to /home/shipyard\nCOPY ${ctx_base}/shipyard_airflow/entrypoint.sh /home/shipyard/entrypoint.sh\n#  Change permissions and set up directories\nRUN chown -R shipyard: /home/shipyard \\\n && chmod +x /home/shipyard/entrypoint.sh\n#  Requirements and Shipyard source\nCOPY ${ctx_base}/shipyard_airflow/requirements.txt /home/shipyard/api_requirements.txt\nCOPY ${ctx_base}/shipyard_client/requirements.txt /home/shipyard/client_requirements.txt\nCOPY ${ctx_base}/shipyard_client /home/shipyard/shipyard_client/\nCOPY ${ctx_base}/shipyard_airflow /home/shipyard/shipyard/\n#  Build\nRUN set -ex \\\n && buildDeps=' gcc git libssl-dev make python3-pip ' \\\n && apt-get update -qq \\\n && apt-get install --no-install-recommends $buildDeps -y -y \\\n && python3 -m pip install -U pip \\\n && pip3 install -r /home/shipyard/client_requirements.txt --no-cache-dir \\\n && cd /home/shipyard/shipyard_client \\\n && python3 setup.py install \\\n && pip3 install -r /home/shipyard/api_requirements.txt --no-cache-dir \\\n && cd /home/shipyard/shipyard \\\n && python3 setup.py install \\\n && apt-get purge -y --auto-remove $buildDeps \\\n && apt-get autoremove -yqq --purge \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* /usr/share/man /usr/share/doc /usr/share/doc-base\n#  Entrypoint\nENTRYPOINT [\"/home/shipyard/entrypoint.sh\"]\nCMD [\"server\"]\n#  Set user to shipyard\nUSER shipyard\n","injectedSmells":[],"originalDockerfileHash":"5d519ccb0eb8e9512a8b731447ac6fc8","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   Copyright 2017 AT&T Intellectual Property.  All other rights reserved.\n#\n#   Licensed under the Apache License, Version 2.0 (the \"License\");\n#   you may not use this file except in compliance with the License.\n#   You may obtain a copy of the License at\n#\n#       http://www.apache.org/licenses/LICENSE-2.0\n#\n#   Unless required by applicable law or agreed to in writing, software\n#   distributed under the License is distributed on an \"AS IS\" BASIS,\n#   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n#   See the License for the specific language governing permissions and\n#   limitations under the License.\nARG FROM=ubuntu:16.04\nFROM ${FROM}\nLABEL org.opencontainers.image.authors=\"airship-discuss@lists.airshipit.org, irc://#airshipit@freenode\"\nLABEL org.opencontainers.image.url=\"https://airshipit.org\"\nLABEL org.opencontainers.image.documentation=\"https://airship-shipyard.readthedocs.org\"\nLABEL org.opencontainers.image.source=\"https://git.openstack.org/openstack/airship-shipyard\"\nLABEL org.opencontainers.image.vendor=\"The Airship Authors\"\nLABEL org.opencontainers.image.licenses=\"Apache-2.0\"\nENV container=\"docker\"\nENV PORT=\"9000\"\nENV LC_ALL=\"C.UTF-8\"\nENV LANG=\"C.UTF-8\"\n#   Setting the version explicitly for PBR\nENV PBR_VERSION=\"0.1a1\"\nARG DEBIAN_FRONTEND=noninteractive\nARG ctx_base=src/bin\n#   Expose port 9000 for application\nEXPOSE $PORT\nRUN set -ex \\\n && apt-get update -qq \\\n && apt-get install --no-install-recommends ca-certificates curl netbase python3-dev python3-setuptools -y \\\n && apt-get autoremove -yqq --purge \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* /usr/share/man /usr/share/doc /usr/share/doc-base\n#   Create shipyard user\nRUN useradd -ms /bin/bash shipyard \\\n && mkdir -p /home/shipyard/shipyard \\\n && mkdir -p /home/shipyard/shipyard_client\n#   Copy entrypoint.sh to /home/shipyard\nCOPY ${ctx_base}/shipyard_airflow/entrypoint.sh /home/shipyard/entrypoint.sh\n#   Change permissions and set up directories\nRUN chown -R shipyard: /home/shipyard \\\n && chmod +x /home/shipyard/entrypoint.sh\n#   Requirements and Shipyard source\nCOPY ${ctx_base}/shipyard_airflow/requirements.txt /home/shipyard/api_requirements.txt\nCOPY ${ctx_base}/shipyard_client/requirements.txt /home/shipyard/client_requirements.txt\nCOPY ${ctx_base}/shipyard_client /home/shipyard/shipyard_client/\nCOPY ${ctx_base}/shipyard_airflow /home/shipyard/shipyard/\n#   Build\nRUN set -ex \\\n && buildDeps=' gcc git libssl-dev make python3-pip ' \\\n && apt-get update -qq \\\n && apt-get install --no-install-recommends $buildDeps -y -y \\\n && python3 -m pip install -U pip \\\n && pip3 install -r /home/shipyard/client_requirements.txt --no-cache-dir \\\n && cd /home/shipyard/shipyard_client \\\n && python3 setup.py install \\\n && pip3 install -r /home/shipyard/api_requirements.txt --no-cache-dir \\\n && cd /home/shipyard/shipyard \\\n && python3 setup.py install \\\n && apt-get purge -y --auto-remove $buildDeps \\\n && apt-get autoremove -yqq --purge \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/* /usr/share/man /usr/share/doc /usr/share/doc-base\n#   Entrypoint\nENTRYPOINT [\"/home/shipyard/entrypoint.sh\"]\nCMD [\"server\"]\n#   Set user to shipyard\nUSER shipyard\n","originalDockerfileUglifiedHash":"d0dd591f83c0b599e356de2546cecc15","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/6c0ec774178260142e5f12b13c0bf718193475d0.dockerfile"}