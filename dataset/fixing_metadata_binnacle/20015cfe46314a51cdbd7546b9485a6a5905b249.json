{"seed":639332626,"processedDockerfileHash":"cd2c70a75b7ada010e462ff6e017ec94","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM centos:7 AS buildimg\nMAINTAINER Otavio Rodolfo Piske <angusyoung@gmail.com>\nARG MAESTRO_VERSION\nENV MAESTRO_VERSION=\"${MAESTRO_VERSION:-1.5.3}\"\nARG MAESTRO_BRANCH\nENV MAESTRO_BRANCH=\"${MAESTRO_BRANCH:-devel}\"\nLABEL MAESTRO_VERSION=\"${MAESTRO_VERSION}\"\nRUN yum install -y java-1.8.0-openjdk-devel which unzip zip wget\nENV JAVA_HOME=\"/etc/alternatives/jre\"\nWORKDIR /root/build\nRUN wget https://github.com/maestro-performance/maestro-java/archive/${MAESTRO_BRANCH}.zip -O maestro-java.zip \\\n && unzip maestro-java.zip \\\n && ln -s maestro-java-${MAESTRO_BRANCH} maestro-java\nRUN cd maestro-java \\\n && ./mvnw -DskipTests=true -PPackage clean package\nENV MAESTRO_APP_ROOT=\"/opt/maestro\"\nRUN mkdir -p ${MAESTRO_APP_ROOT}\nWORKDIR ${MAESTRO_APP_ROOT}\nENV MAESTRO_WORKER_TYPE=\"worker\"\nRUN mkdir -p maestro-${MAESTRO_WORKER_TYPE} \\\n && tar --strip-components=1 -xvf /root/build/maestro-java/maestro-${MAESTRO_WORKER_TYPE}/target/maestro-${MAESTRO_WORKER_TYPE}-${MAESTRO_VERSION}-bin.tar.gz -C maestro-${MAESTRO_WORKER_TYPE}\nENV MAESTRO_WORKER_TYPE=\"agent\"\nRUN mkdir -p maestro-${MAESTRO_WORKER_TYPE} \\\n && tar --strip-components=1 -xvf /root/build/maestro-java/maestro-${MAESTRO_WORKER_TYPE}/target/maestro-${MAESTRO_WORKER_TYPE}-${MAESTRO_VERSION}-bin.tar.gz -C maestro-${MAESTRO_WORKER_TYPE}\nENV MAESTRO_WORKER_TYPE=\"inspector\"\nRUN mkdir -p maestro-${MAESTRO_WORKER_TYPE} \\\n && tar --strip-components=1 -xvf /root/build/maestro-java/maestro-${MAESTRO_WORKER_TYPE}/target/maestro-${MAESTRO_WORKER_TYPE}-${MAESTRO_VERSION}-bin.tar.gz -C maestro-${MAESTRO_WORKER_TYPE}\nENV MAESTRO_WORKER_TYPE=\"exporter\"\nRUN mkdir -p maestro-${MAESTRO_WORKER_TYPE} \\\n && tar --strip-components=1 -xvf /root/build/maestro-java/maestro-${MAESTRO_WORKER_TYPE}/target/maestro-${MAESTRO_WORKER_TYPE}-${MAESTRO_VERSION}-bin.tar.gz -C maestro-${MAESTRO_WORKER_TYPE}\nENV MAESTRO_WORKER_TYPE=\"reports\"\nRUN mkdir -p maestro-${MAESTRO_WORKER_TYPE}-tool \\\n && tar --strip-components=1 -xvf /root/build/maestro-java/maestro-${MAESTRO_WORKER_TYPE}/maestro-${MAESTRO_WORKER_TYPE}-tool/target/maestro-${MAESTRO_WORKER_TYPE}-tool-${MAESTRO_VERSION}-bin.tar.gz -C maestro-${MAESTRO_WORKER_TYPE}-tool\nRUN mkdir -p maestro-cli \\\n && tar --strip-components=1 -xvf /root/build/maestro-java/maestro-cli/target/maestro-cli-${MAESTRO_VERSION}-bin.tar.gz -C maestro-cli\n#   Base image for everything\nFROM centos:7 AS maestro-base\nMAINTAINER Otavio Rodolfo Piske <angusyoung@gmail.com>\nARG MAESTRO_VERSION\nENV MAESTRO_VERSION=\"${MAESTRO_VERSION:-1.5.3}\"\nLABEL MAESTRO_VERSION=\"${MAESTRO_VERSION}\"\nENV MAESTRO_APP_ROOT=\"/opt/maestro\"\nENV JAVA_HOME=\"/etc/alternatives/jre\"\nRUN mkdir -p ${MAESTRO_APP_ROOT} \\\n && mkdir -p /maestro\nWORKDIR ${MAESTRO_APP_ROOT}\nRUN yum install -y java-1.8.0-openjdk-headless unzip which ntp rsync openssl \\\n && yum clean all\n#  # Worker ##\nFROM maestro-base AS maestro-worker\nENV MAESTRO_WORKER_TYPE=\"worker\"\nMAINTAINER Otavio Rodolfo Piske <angusyoung@gmail.com>\nLABEL MAESTRO_WORKER_TYPE=\"${MAESTRO_WORKER_TYPE}\"\nCOPY --from=buildimg ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE} maestro-${MAESTRO_WORKER_TYPE}\nCOPY ${MAESTRO_WORKER_TYPE}/log4j.properties ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE}/config/log4j.properties\nCOPY ${MAESTRO_WORKER_TYPE}/maestro-${MAESTRO_WORKER_TYPE}.properties ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE}/config/maestro-${MAESTRO_WORKER_TYPE}.properties\nRUN mkdir -p /maestro/${MAESTRO_WORKER_TYPE}/logs\nCOPY ${MAESTRO_WORKER_TYPE}/maestro-container-wrapper.sh /usr/bin/maestro-container-wrapper\nCMD [\"sh\", \"-c\", \"/usr/bin/maestro-container-wrapper\"]\n#  # Inspector ##\nFROM maestro-base AS maestro-inspector\nENV MAESTRO_WORKER_TYPE=\"inspector\"\nMAINTAINER Otavio Rodolfo Piske <angusyoung@gmail.com>\nLABEL MAESTRO_WORKER_TYPE=\"${MAESTRO_WORKER_TYPE}\"\nCOPY --from=buildimg ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE} maestro-${MAESTRO_WORKER_TYPE}\nCOPY ${MAESTRO_WORKER_TYPE}/log4j.properties ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE}/config/log4j.properties\nCOPY ${MAESTRO_WORKER_TYPE}/maestro-${MAESTRO_WORKER_TYPE}.properties ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE}/config/maestro-${MAESTRO_WORKER_TYPE}.properties\nRUN mkdir -p /maestro/${MAESTRO_WORKER_TYPE}/logs\nCOPY ${MAESTRO_WORKER_TYPE}/maestro-container-wrapper.sh /usr/bin/maestro-container-wrapper\nCMD [\"sh\", \"-c\", \"/usr/bin/maestro-container-wrapper\"]\n#  # Exporter ##\nFROM maestro-base AS maestro-exporter\nENV MAESTRO_WORKER_TYPE=\"exporter\"\nMAINTAINER Otavio Rodolfo Piske <angusyoung@gmail.com>\nLABEL MAESTRO_WORKER_TYPE=\"${MAESTRO_WORKER_TYPE}\"\nEXPOSE 9120/tcp\nCOPY --from=buildimg ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE} maestro-${MAESTRO_WORKER_TYPE}\nCOPY ${MAESTRO_WORKER_TYPE}/log4j.properties ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE}/config/log4j.properties\nCOPY ${MAESTRO_WORKER_TYPE}/maestro-exporter.properties ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE}/config/maestro-${MAESTRO_WORKER_TYPE}.properties\nRUN mkdir -p /maestro/${MAESTRO_WORKER_TYPE}/logs\nCOPY ${MAESTRO_WORKER_TYPE}/maestro-container-wrapper.sh /usr/bin/maestro-container-wrapper\nCMD [\"sh\", \"-c\", \"/usr/bin/maestro-container-wrapper\"]\n#  # Agent ##\nFROM maestro-base AS maestro-agent\nENV MAESTRO_WORKER_TYPE=\"agent\"\nMAINTAINER Otavio Rodolfo Piske <angusyoung@gmail.com>\nLABEL MAESTRO_WORKER_TYPE=\"${MAESTRO_WORKER_TYPE}\"\nCOPY --from=buildimg ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE} maestro-${MAESTRO_WORKER_TYPE}\nCOPY ${MAESTRO_WORKER_TYPE}/log4j.properties ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE}/config/log4j.properties\nCOPY ${MAESTRO_WORKER_TYPE}/maestro-${MAESTRO_WORKER_TYPE}.properties ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE}/config/maestro-${MAESTRO_WORKER_TYPE}.properties\nRUN mkdir -p /maestro/${MAESTRO_WORKER_TYPE}/logs\nCOPY ${MAESTRO_WORKER_TYPE}/maestro-container-wrapper.sh /usr/bin/maestro-container-wrapper\nCMD [\"sh\", \"-c\", \"/usr/bin/maestro-container-wrapper\"]\n#  # Reports Collector/Server ##\nFROM maestro-base AS maestro-reports\nENV MAESTRO_WORKER_TYPE=\"reports\"\nMAINTAINER Otavio Rodolfo Piske <angusyoung@gmail.com>\nLABEL MAESTRO_WORKER_TYPE=\"${MAESTRO_WORKER_TYPE}\"\nEXPOSE 6500/tcp\nCOPY --from=buildimg ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE}-tool maestro-${MAESTRO_WORKER_TYPE}-tool\nCOPY ${MAESTRO_WORKER_TYPE}/log4j.properties ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE}-tool/config/log4j.properties\nCOPY ${MAESTRO_WORKER_TYPE}/maestro-${MAESTRO_WORKER_TYPE}-tool.properties ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE}-tool/config/maestro-${MAESTRO_WORKER_TYPE}-tool.properties\nRUN mkdir -p /maestro/${MAESTRO_WORKER_TYPE}-tool\nVOLUME /maestro\nCOPY ${MAESTRO_WORKER_TYPE}/maestro-container-wrapper.sh /usr/bin/maestro-container-wrapper\nCMD [\"sh\", \"-c\", \"/usr/bin/maestro-container-wrapper\"]\n#  # Client ##\nFROM maestro-base AS maestro-client\nMAINTAINER Otavio Rodolfo Piske <angusyoung@gmail.com>\nLABEL MAESTRO_WORKER_TYPE=\"client\"\nENV GROOVY_VERSION=\"2.4.15\"\nLABEL MAESTRO_WORKER_TYPE=\"${MAESTRO_WORKER_TYPE}\"\nRUN yum install -y java-1.8.0-openjdk liberation-fonts \\\n && yum clean all\nCOPY --from=buildimg ${MAESTRO_APP_ROOT}/maestro-cli maestro-cli\nENV MAESTRO_BROKER=\"mqtt://broker:1883\"\nENV SEND_RECEIVE_URL=\"amqp://sut:5672/test.performance.queue\"\nENV MESSAGE_SIZE=\"256\"\nENV TEST_DURATION=\"90s\"\nENV RATE=\"0\"\nENV PARALLEL_COUNT=\"2\"\nCOPY client/motd.txt /etc/motd\nRUN echo \"export PATH=$PATH:/opt/maestro/maestro-cli/bin/\" >> $HOME/.bashrc\nRUN echo \"cat /etc/motd\" >> $HOME/.bashrc\nCOPY client/maestro-container-wrapper.sh /usr/bin/maestro-container-wrapper\nCOPY client/setup-artemis-inspector.sh /usr/bin/setup-artemis-inspector\nCOPY client/setup-interconnect-inspector.sh /usr/bin/setup-interconnect-inspector\nCMD [\"sh\", \"-c\", \"/usr/bin/maestro-container-wrapper\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM centos:7 AS buildimg\nMAINTAINER Otavio Rodolfo Piske <angusyoung@gmail.com>\nARG MAESTRO_VERSION\nENV MAESTRO_VERSION=\"${MAESTRO_VERSION:-1.5.3}\"\nARG MAESTRO_BRANCH\nENV MAESTRO_BRANCH=\"${MAESTRO_BRANCH:-devel}\"\nLABEL MAESTRO_VERSION=\"${MAESTRO_VERSION}\"\nRUN yum install -y java-1.8.0-openjdk-devel which unzip zip wget\nENV JAVA_HOME=\"/etc/alternatives/jre\"\nWORKDIR /root/build\nRUN wget https://github.com/maestro-performance/maestro-java/archive/${MAESTRO_BRANCH}.zip -O maestro-java.zip \\\n && unzip maestro-java.zip \\\n && ln -s maestro-java-${MAESTRO_BRANCH} maestro-java\nRUN cd maestro-java \\\n && ./mvnw -DskipTests=true -PPackage clean package\nENV MAESTRO_APP_ROOT=\"/opt/maestro\"\nRUN mkdir -p ${MAESTRO_APP_ROOT}\nWORKDIR ${MAESTRO_APP_ROOT}\nENV MAESTRO_WORKER_TYPE=\"worker\"\nRUN mkdir -p maestro-${MAESTRO_WORKER_TYPE} \\\n && tar --strip-components=1 -xvf /root/build/maestro-java/maestro-${MAESTRO_WORKER_TYPE}/target/maestro-${MAESTRO_WORKER_TYPE}-${MAESTRO_VERSION}-bin.tar.gz -C maestro-${MAESTRO_WORKER_TYPE}\nENV MAESTRO_WORKER_TYPE=\"agent\"\nRUN mkdir -p maestro-${MAESTRO_WORKER_TYPE} \\\n && tar --strip-components=1 -xvf /root/build/maestro-java/maestro-${MAESTRO_WORKER_TYPE}/target/maestro-${MAESTRO_WORKER_TYPE}-${MAESTRO_VERSION}-bin.tar.gz -C maestro-${MAESTRO_WORKER_TYPE}\nENV MAESTRO_WORKER_TYPE=\"inspector\"\nRUN mkdir -p maestro-${MAESTRO_WORKER_TYPE} \\\n && tar --strip-components=1 -xvf /root/build/maestro-java/maestro-${MAESTRO_WORKER_TYPE}/target/maestro-${MAESTRO_WORKER_TYPE}-${MAESTRO_VERSION}-bin.tar.gz -C maestro-${MAESTRO_WORKER_TYPE}\nENV MAESTRO_WORKER_TYPE=\"exporter\"\nRUN mkdir -p maestro-${MAESTRO_WORKER_TYPE} \\\n && tar --strip-components=1 -xvf /root/build/maestro-java/maestro-${MAESTRO_WORKER_TYPE}/target/maestro-${MAESTRO_WORKER_TYPE}-${MAESTRO_VERSION}-bin.tar.gz -C maestro-${MAESTRO_WORKER_TYPE}\nENV MAESTRO_WORKER_TYPE=\"reports\"\nRUN mkdir -p maestro-${MAESTRO_WORKER_TYPE}-tool \\\n && tar --strip-components=1 -xvf /root/build/maestro-java/maestro-${MAESTRO_WORKER_TYPE}/maestro-${MAESTRO_WORKER_TYPE}-tool/target/maestro-${MAESTRO_WORKER_TYPE}-tool-${MAESTRO_VERSION}-bin.tar.gz -C maestro-${MAESTRO_WORKER_TYPE}-tool\nRUN mkdir -p maestro-cli \\\n && tar --strip-components=1 -xvf /root/build/maestro-java/maestro-cli/target/maestro-cli-${MAESTRO_VERSION}-bin.tar.gz -C maestro-cli\n#  Base image for everything\nFROM centos:7 AS maestro-base\nMAINTAINER Otavio Rodolfo Piske <angusyoung@gmail.com>\nARG MAESTRO_VERSION\nENV MAESTRO_VERSION=\"${MAESTRO_VERSION:-1.5.3}\"\nLABEL MAESTRO_VERSION=\"${MAESTRO_VERSION}\"\nENV MAESTRO_APP_ROOT=\"/opt/maestro\"\nENV JAVA_HOME=\"/etc/alternatives/jre\"\nRUN mkdir -p ${MAESTRO_APP_ROOT} \\\n && mkdir -p /maestro\nWORKDIR ${MAESTRO_APP_ROOT}\nRUN yum install -y java-1.8.0-openjdk-headless unzip which ntp rsync openssl \\\n && yum clean all\n# # Worker ##\nFROM maestro-base AS maestro-worker\nENV MAESTRO_WORKER_TYPE=\"worker\"\nMAINTAINER Otavio Rodolfo Piske <angusyoung@gmail.com>\nLABEL MAESTRO_WORKER_TYPE=\"${MAESTRO_WORKER_TYPE}\"\nCOPY --from=buildimg ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE} maestro-${MAESTRO_WORKER_TYPE}\nADD ${MAESTRO_WORKER_TYPE}/log4j.properties ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE}/config/log4j.properties\nADD ${MAESTRO_WORKER_TYPE}/maestro-${MAESTRO_WORKER_TYPE}.properties ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE}/config/maestro-${MAESTRO_WORKER_TYPE}.properties\nRUN mkdir -p /maestro/${MAESTRO_WORKER_TYPE}/logs\nADD ${MAESTRO_WORKER_TYPE}/maestro-container-wrapper.sh /usr/bin/maestro-container-wrapper\nCMD [\"sh\", \"-c\", \"/usr/bin/maestro-container-wrapper\"]\n# # Inspector ##\nFROM maestro-base AS maestro-inspector\nENV MAESTRO_WORKER_TYPE=\"inspector\"\nMAINTAINER Otavio Rodolfo Piske <angusyoung@gmail.com>\nLABEL MAESTRO_WORKER_TYPE=\"${MAESTRO_WORKER_TYPE}\"\nCOPY --from=buildimg ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE} maestro-${MAESTRO_WORKER_TYPE}\nADD ${MAESTRO_WORKER_TYPE}/log4j.properties ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE}/config/log4j.properties\nADD ${MAESTRO_WORKER_TYPE}/maestro-${MAESTRO_WORKER_TYPE}.properties ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE}/config/maestro-${MAESTRO_WORKER_TYPE}.properties\nRUN mkdir -p /maestro/${MAESTRO_WORKER_TYPE}/logs\nADD ${MAESTRO_WORKER_TYPE}/maestro-container-wrapper.sh /usr/bin/maestro-container-wrapper\nCMD [\"sh\", \"-c\", \"/usr/bin/maestro-container-wrapper\"]\n# # Exporter ##\nFROM maestro-base AS maestro-exporter\nENV MAESTRO_WORKER_TYPE=\"exporter\"\nMAINTAINER Otavio Rodolfo Piske <angusyoung@gmail.com>\nLABEL MAESTRO_WORKER_TYPE=\"${MAESTRO_WORKER_TYPE}\"\nEXPOSE 9120/tcp\nCOPY --from=buildimg ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE} maestro-${MAESTRO_WORKER_TYPE}\nADD ${MAESTRO_WORKER_TYPE}/log4j.properties ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE}/config/log4j.properties\nADD ${MAESTRO_WORKER_TYPE}/maestro-exporter.properties ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE}/config/maestro-${MAESTRO_WORKER_TYPE}.properties\nRUN mkdir -p /maestro/${MAESTRO_WORKER_TYPE}/logs\nADD ${MAESTRO_WORKER_TYPE}/maestro-container-wrapper.sh /usr/bin/maestro-container-wrapper\nCMD [\"sh\", \"-c\", \"/usr/bin/maestro-container-wrapper\"]\n# # Agent ##\nFROM maestro-base AS maestro-agent\nENV MAESTRO_WORKER_TYPE=\"agent\"\nMAINTAINER Otavio Rodolfo Piske <angusyoung@gmail.com>\nLABEL MAESTRO_WORKER_TYPE=\"${MAESTRO_WORKER_TYPE}\"\nCOPY --from=buildimg ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE} maestro-${MAESTRO_WORKER_TYPE}\nADD ${MAESTRO_WORKER_TYPE}/log4j.properties ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE}/config/log4j.properties\nADD ${MAESTRO_WORKER_TYPE}/maestro-${MAESTRO_WORKER_TYPE}.properties ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE}/config/maestro-${MAESTRO_WORKER_TYPE}.properties\nRUN mkdir -p /maestro/${MAESTRO_WORKER_TYPE}/logs\nADD ${MAESTRO_WORKER_TYPE}/maestro-container-wrapper.sh /usr/bin/maestro-container-wrapper\nCMD [\"sh\", \"-c\", \"/usr/bin/maestro-container-wrapper\"]\n# # Reports Collector/Server ##\nFROM maestro-base AS maestro-reports\nENV MAESTRO_WORKER_TYPE=\"reports\"\nMAINTAINER Otavio Rodolfo Piske <angusyoung@gmail.com>\nLABEL MAESTRO_WORKER_TYPE=\"${MAESTRO_WORKER_TYPE}\"\nEXPOSE 6500/tcp\nCOPY --from=buildimg ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE}-tool maestro-${MAESTRO_WORKER_TYPE}-tool\nADD ${MAESTRO_WORKER_TYPE}/log4j.properties ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE}-tool/config/log4j.properties\nADD ${MAESTRO_WORKER_TYPE}/maestro-${MAESTRO_WORKER_TYPE}-tool.properties ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE}-tool/config/maestro-${MAESTRO_WORKER_TYPE}-tool.properties\nRUN mkdir -p /maestro/${MAESTRO_WORKER_TYPE}-tool\nVOLUME /maestro\nADD ${MAESTRO_WORKER_TYPE}/maestro-container-wrapper.sh /usr/bin/maestro-container-wrapper\nCMD [\"sh\", \"-c\", \"/usr/bin/maestro-container-wrapper\"]\n# # Client ##\nFROM maestro-base AS maestro-client\nMAINTAINER Otavio Rodolfo Piske <angusyoung@gmail.com>\nLABEL MAESTRO_WORKER_TYPE=\"client\"\nENV GROOVY_VERSION=\"2.4.15\"\nLABEL MAESTRO_WORKER_TYPE=\"${MAESTRO_WORKER_TYPE}\"\nRUN yum install -y java-1.8.0-openjdk liberation-fonts \\\n && yum clean all\nCOPY --from=buildimg ${MAESTRO_APP_ROOT}/maestro-cli maestro-cli\nENV MAESTRO_BROKER=\"mqtt://broker:1883\"\nENV SEND_RECEIVE_URL=\"amqp://sut:5672/test.performance.queue\"\nENV MESSAGE_SIZE=\"256\"\nENV TEST_DURATION=\"90s\"\nENV RATE=\"0\"\nENV PARALLEL_COUNT=\"2\"\nADD client/motd.txt /etc/motd\nRUN echo \"export PATH=$PATH:/opt/maestro/maestro-cli/bin/\" >> $HOME/.bashrc\nRUN echo \"cat /etc/motd\" >> $HOME/.bashrc\nADD client/maestro-container-wrapper.sh /usr/bin/maestro-container-wrapper\nADD client/setup-artemis-inspector.sh /usr/bin/setup-artemis-inspector\nADD client/setup-interconnect-inspector.sh /usr/bin/setup-interconnect-inspector\nCMD [\"sh\", \"-c\", \"/usr/bin/maestro-container-wrapper\"]\n","injectedSmells":[],"originalDockerfileHash":"a146b858acd05d693a2a808a261b7112","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM centos:7 AS buildimg\nMAINTAINER Otavio Rodolfo Piske <angusyoung@gmail.com>\nARG MAESTRO_VERSION\nENV MAESTRO_VERSION=\"${MAESTRO_VERSION:-1.5.3}\"\nARG MAESTRO_BRANCH\nENV MAESTRO_BRANCH=\"${MAESTRO_BRANCH:-devel}\"\nLABEL MAESTRO_VERSION=\"${MAESTRO_VERSION}\"\nRUN yum install -y java-1.8.0-openjdk-devel which unzip zip wget\nENV JAVA_HOME=\"/etc/alternatives/jre\"\nWORKDIR /root/build\nRUN wget https://github.com/maestro-performance/maestro-java/archive/${MAESTRO_BRANCH}.zip -O maestro-java.zip \\\n && unzip maestro-java.zip \\\n && ln -s maestro-java-${MAESTRO_BRANCH} maestro-java\nRUN cd maestro-java \\\n && ./mvnw -DskipTests=true -PPackage clean package\nENV MAESTRO_APP_ROOT=\"/opt/maestro\"\nRUN mkdir -p ${MAESTRO_APP_ROOT}\nWORKDIR ${MAESTRO_APP_ROOT}\nENV MAESTRO_WORKER_TYPE=\"worker\"\nRUN mkdir -p maestro-${MAESTRO_WORKER_TYPE} \\\n && tar --strip-components=1 -xvf /root/build/maestro-java/maestro-${MAESTRO_WORKER_TYPE}/target/maestro-${MAESTRO_WORKER_TYPE}-${MAESTRO_VERSION}-bin.tar.gz -C maestro-${MAESTRO_WORKER_TYPE}\nENV MAESTRO_WORKER_TYPE=\"agent\"\nRUN mkdir -p maestro-${MAESTRO_WORKER_TYPE} \\\n && tar --strip-components=1 -xvf /root/build/maestro-java/maestro-${MAESTRO_WORKER_TYPE}/target/maestro-${MAESTRO_WORKER_TYPE}-${MAESTRO_VERSION}-bin.tar.gz -C maestro-${MAESTRO_WORKER_TYPE}\nENV MAESTRO_WORKER_TYPE=\"inspector\"\nRUN mkdir -p maestro-${MAESTRO_WORKER_TYPE} \\\n && tar --strip-components=1 -xvf /root/build/maestro-java/maestro-${MAESTRO_WORKER_TYPE}/target/maestro-${MAESTRO_WORKER_TYPE}-${MAESTRO_VERSION}-bin.tar.gz -C maestro-${MAESTRO_WORKER_TYPE}\nENV MAESTRO_WORKER_TYPE=\"exporter\"\nRUN mkdir -p maestro-${MAESTRO_WORKER_TYPE} \\\n && tar --strip-components=1 -xvf /root/build/maestro-java/maestro-${MAESTRO_WORKER_TYPE}/target/maestro-${MAESTRO_WORKER_TYPE}-${MAESTRO_VERSION}-bin.tar.gz -C maestro-${MAESTRO_WORKER_TYPE}\nENV MAESTRO_WORKER_TYPE=\"reports\"\nRUN mkdir -p maestro-${MAESTRO_WORKER_TYPE}-tool \\\n && tar --strip-components=1 -xvf /root/build/maestro-java/maestro-${MAESTRO_WORKER_TYPE}/maestro-${MAESTRO_WORKER_TYPE}-tool/target/maestro-${MAESTRO_WORKER_TYPE}-tool-${MAESTRO_VERSION}-bin.tar.gz -C maestro-${MAESTRO_WORKER_TYPE}-tool\nRUN mkdir -p maestro-cli \\\n && tar --strip-components=1 -xvf /root/build/maestro-java/maestro-cli/target/maestro-cli-${MAESTRO_VERSION}-bin.tar.gz -C maestro-cli\n#   Base image for everything\nFROM centos:7 AS maestro-base\nMAINTAINER Otavio Rodolfo Piske <angusyoung@gmail.com>\nARG MAESTRO_VERSION\nENV MAESTRO_VERSION=\"${MAESTRO_VERSION:-1.5.3}\"\nLABEL MAESTRO_VERSION=\"${MAESTRO_VERSION}\"\nENV MAESTRO_APP_ROOT=\"/opt/maestro\"\nENV JAVA_HOME=\"/etc/alternatives/jre\"\nRUN mkdir -p ${MAESTRO_APP_ROOT} \\\n && mkdir -p /maestro\nWORKDIR ${MAESTRO_APP_ROOT}\nRUN yum install -y java-1.8.0-openjdk-headless unzip which ntp rsync openssl \\\n && yum clean all\n#  # Worker ##\nFROM maestro-base AS maestro-worker\nENV MAESTRO_WORKER_TYPE=\"worker\"\nMAINTAINER Otavio Rodolfo Piske <angusyoung@gmail.com>\nLABEL MAESTRO_WORKER_TYPE=\"${MAESTRO_WORKER_TYPE}\"\nCOPY --from=buildimg ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE} maestro-${MAESTRO_WORKER_TYPE}\nADD ${MAESTRO_WORKER_TYPE}/log4j.properties ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE}/config/log4j.properties\nADD ${MAESTRO_WORKER_TYPE}/maestro-${MAESTRO_WORKER_TYPE}.properties ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE}/config/maestro-${MAESTRO_WORKER_TYPE}.properties\nRUN mkdir -p /maestro/${MAESTRO_WORKER_TYPE}/logs\nADD ${MAESTRO_WORKER_TYPE}/maestro-container-wrapper.sh /usr/bin/maestro-container-wrapper\nCMD [\"sh\", \"-c\", \"/usr/bin/maestro-container-wrapper\"]\n#  # Inspector ##\nFROM maestro-base AS maestro-inspector\nENV MAESTRO_WORKER_TYPE=\"inspector\"\nMAINTAINER Otavio Rodolfo Piske <angusyoung@gmail.com>\nLABEL MAESTRO_WORKER_TYPE=\"${MAESTRO_WORKER_TYPE}\"\nCOPY --from=buildimg ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE} maestro-${MAESTRO_WORKER_TYPE}\nADD ${MAESTRO_WORKER_TYPE}/log4j.properties ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE}/config/log4j.properties\nADD ${MAESTRO_WORKER_TYPE}/maestro-${MAESTRO_WORKER_TYPE}.properties ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE}/config/maestro-${MAESTRO_WORKER_TYPE}.properties\nRUN mkdir -p /maestro/${MAESTRO_WORKER_TYPE}/logs\nADD ${MAESTRO_WORKER_TYPE}/maestro-container-wrapper.sh /usr/bin/maestro-container-wrapper\nCMD [\"sh\", \"-c\", \"/usr/bin/maestro-container-wrapper\"]\n#  # Exporter ##\nFROM maestro-base AS maestro-exporter\nENV MAESTRO_WORKER_TYPE=\"exporter\"\nMAINTAINER Otavio Rodolfo Piske <angusyoung@gmail.com>\nLABEL MAESTRO_WORKER_TYPE=\"${MAESTRO_WORKER_TYPE}\"\nEXPOSE 9120/tcp\nCOPY --from=buildimg ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE} maestro-${MAESTRO_WORKER_TYPE}\nADD ${MAESTRO_WORKER_TYPE}/log4j.properties ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE}/config/log4j.properties\nADD ${MAESTRO_WORKER_TYPE}/maestro-exporter.properties ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE}/config/maestro-${MAESTRO_WORKER_TYPE}.properties\nRUN mkdir -p /maestro/${MAESTRO_WORKER_TYPE}/logs\nADD ${MAESTRO_WORKER_TYPE}/maestro-container-wrapper.sh /usr/bin/maestro-container-wrapper\nCMD [\"sh\", \"-c\", \"/usr/bin/maestro-container-wrapper\"]\n#  # Agent ##\nFROM maestro-base AS maestro-agent\nENV MAESTRO_WORKER_TYPE=\"agent\"\nMAINTAINER Otavio Rodolfo Piske <angusyoung@gmail.com>\nLABEL MAESTRO_WORKER_TYPE=\"${MAESTRO_WORKER_TYPE}\"\nCOPY --from=buildimg ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE} maestro-${MAESTRO_WORKER_TYPE}\nADD ${MAESTRO_WORKER_TYPE}/log4j.properties ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE}/config/log4j.properties\nADD ${MAESTRO_WORKER_TYPE}/maestro-${MAESTRO_WORKER_TYPE}.properties ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE}/config/maestro-${MAESTRO_WORKER_TYPE}.properties\nRUN mkdir -p /maestro/${MAESTRO_WORKER_TYPE}/logs\nADD ${MAESTRO_WORKER_TYPE}/maestro-container-wrapper.sh /usr/bin/maestro-container-wrapper\nCMD [\"sh\", \"-c\", \"/usr/bin/maestro-container-wrapper\"]\n#  # Reports Collector/Server ##\nFROM maestro-base AS maestro-reports\nENV MAESTRO_WORKER_TYPE=\"reports\"\nMAINTAINER Otavio Rodolfo Piske <angusyoung@gmail.com>\nLABEL MAESTRO_WORKER_TYPE=\"${MAESTRO_WORKER_TYPE}\"\nEXPOSE 6500/tcp\nCOPY --from=buildimg ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE}-tool maestro-${MAESTRO_WORKER_TYPE}-tool\nADD ${MAESTRO_WORKER_TYPE}/log4j.properties ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE}-tool/config/log4j.properties\nADD ${MAESTRO_WORKER_TYPE}/maestro-${MAESTRO_WORKER_TYPE}-tool.properties ${MAESTRO_APP_ROOT}/maestro-${MAESTRO_WORKER_TYPE}-tool/config/maestro-${MAESTRO_WORKER_TYPE}-tool.properties\nRUN mkdir -p /maestro/${MAESTRO_WORKER_TYPE}-tool\nVOLUME /maestro\nADD ${MAESTRO_WORKER_TYPE}/maestro-container-wrapper.sh /usr/bin/maestro-container-wrapper\nCMD [\"sh\", \"-c\", \"/usr/bin/maestro-container-wrapper\"]\n#  # Client ##\nFROM maestro-base AS maestro-client\nMAINTAINER Otavio Rodolfo Piske <angusyoung@gmail.com>\nLABEL MAESTRO_WORKER_TYPE=\"client\"\nENV GROOVY_VERSION=\"2.4.15\"\nLABEL MAESTRO_WORKER_TYPE=\"${MAESTRO_WORKER_TYPE}\"\nRUN yum install -y java-1.8.0-openjdk liberation-fonts \\\n && yum clean all\nCOPY --from=buildimg ${MAESTRO_APP_ROOT}/maestro-cli maestro-cli\nENV MAESTRO_BROKER=\"mqtt://broker:1883\"\nENV SEND_RECEIVE_URL=\"amqp://sut:5672/test.performance.queue\"\nENV MESSAGE_SIZE=\"256\"\nENV TEST_DURATION=\"90s\"\nENV RATE=\"0\"\nENV PARALLEL_COUNT=\"2\"\nADD client/motd.txt /etc/motd\nRUN echo \"export PATH=$PATH:/opt/maestro/maestro-cli/bin/\" >> $HOME/.bashrc\nRUN echo \"cat /etc/motd\" >> $HOME/.bashrc\nADD client/maestro-container-wrapper.sh /usr/bin/maestro-container-wrapper\nADD client/setup-artemis-inspector.sh /usr/bin/setup-artemis-inspector\nADD client/setup-interconnect-inspector.sh /usr/bin/setup-interconnect-inspector\nCMD [\"sh\", \"-c\", \"/usr/bin/maestro-container-wrapper\"]\n","originalDockerfileUglifiedHash":"db3c72071f6ff124958bb897805a48f0","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/20015cfe46314a51cdbd7546b9485a6a5905b249.dockerfile"}