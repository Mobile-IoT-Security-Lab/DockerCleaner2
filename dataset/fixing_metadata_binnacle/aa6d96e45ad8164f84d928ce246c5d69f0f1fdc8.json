{"seed":1561583706,"processedDockerfileHash":"7adf84df5c0d8fadc24b10a76ca5003e","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","pin-package-manager-versions-pip","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM b.gcr.io/airflow-gcp/airflow-base:1.8.0.rc.100\n#   A few problems with compiling Java from source:\n#    1. Oracle.  Licensing prevents us from redistributing the official JDK.\n#    2. Compiling OpenJDK also requires the JDK to be installed, and it gets\n#         really hairy.\n#  RUN apt-get update && apt-get install -y --no-install-recommends \\\n#  \t\tbzip2 \\\n#  \t\tunzip \\\n#  \t\txz-utils \\\n#  \t&& rm -rf /var/lib/apt/lists/*\n#\n#  RUN echo 'deb http://httpredir.debian.org/debian jessie-backports main' > /etc/apt/sources.list.d/jessie-backports.list\n#\n#  # Default to UTF-8 file.encoding\n#  ENV LANG C.UTF-8\n#\n#  # add a simple script that can auto-detect the appropriate JAVA_HOME value\n#  # based on whether the JDK or only the JRE is installed\n#  RUN { \\\n#  \t\techo '#!/bin/sh'; \\\n#  \t\techo 'set -e'; \\\n#  \t\techo; \\\n#  \t\techo 'dirname \"$(dirname \"$(readlink -f \"$(which javac || which java)\")\")\"'; \\\n#  \t} > /usr/local/bin/docker-java-home \\\n#  \t&& chmod +x /usr/local/bin/docker-java-home\n#\n#  ENV JAVA_HOME /usr/lib/jvm/java-8-openjdk-amd64\n#\n#  ENV JAVA_VERSION 8u121\n#  ENV JAVA_DEBIAN_VERSION 8u121-b13-1~bpo8+1\n#\n#\n#  # see https://bugs.debian.org/775775\n#  # and https://github.com/docker-library/java/issues/19#issuecomment-70546872\n#  ENV CA_CERTIFICATES_JAVA_VERSION 20140324\n#\n#  RUN set -x \\\n#  \t&& apt-get update \\\n#  \t&& apt-get install -y \\\n#          openjdk-8-jre=\"$JAVA_DEBIAN_VERSION\" \\\n#          openjdk-8-jdk-headless=\"$JAVA_DEBIAN_VERSION\"\n#\n#  RUN set -x \\\n#  \t&& apt-get install -y \\\n#  \t\topenjdk-8-jdk=\"$JAVA_DEBIAN_VERSION\" \\\n#  \t\tca-certificates-java=\"$CA_CERTIFICATES_JAVA_VERSION\" \\\n#  \t&& rm -rf /var/lib/apt/lists/* \\\n#  \t&& [ \"$JAVA_HOME\" = \"$(docker-java-home)\" ]\n#\n#  # see CA_CERTIFICATES_JAVA_VERSION notes above\n#  RUN /var/lib/dpkg/info/ca-certificates-java.postinst configure\nRUN pip uninstall airflow -y\nRUN git fetch -vp \\\n && git checkout 8e7a5583610be370dd26d50df0b7b98d90dbd396 \\\n && python setup.py install\nRUN pip install flask_bcrypt==1.0.1\nRUN pip install flask_oauthlib==0.9.6\nRUN apt-get update \\\n && apt-get install --no-install-recommends bzip2 unzip xz-utils -y \\\n && rm -rf /var/lib/apt/lists/*\nRUN echo 'deb http://deb.debian.org/debian jessie-backports main' > /etc/apt/sources.list.d/jessie-backports.list\n#   Default to UTF-8 file.encoding\nENV LANG=\"C.UTF-8\"\n#   add a simple script that can auto-detect the appropriate JAVA_HOME value\n#   based on whether the JDK or only the JRE is installed\nRUN { echo '#!/bin/sh' ;echo 'set -e' ;echo ;echo 'dirname \"$(dirname \"$(readlink -f \"$(which javac || which java)\")\")\"' ; } > /usr/local/bin/docker-java-home \\\n && chmod +x /usr/local/bin/docker-java-home\nENV JAVA_HOME=\"/usr/lib/jvm/java-8-openjdk-amd64\"\nENV JAVA_VERSION=\"8u121\"\nENV JAVA_DEBIAN_VERSION=\"8u121-b13-1~bpo8+1\"\n#   see https://bugs.debian.org/775775\n#   and https://github.com/docker-library/java/issues/19#issuecomment-70546872\nENV CA_CERTIFICATES_JAVA_VERSION=\"20161107~bpo8+1\"\nRUN set -x \\\n && apt-get update \\\n && apt-get install --no-install-recommends openjdk-8-jdk=\"$JAVA_DEBIAN_VERSION\" ca-certificates-java=\"$CA_CERTIFICATES_JAVA_VERSION\" -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && [ \"$JAVA_HOME\" = \"$( docker-java-home ;)\" ]\n#   see CA_CERTIFICATES_JAVA_VERSION notes above\nRUN /var/lib/dpkg/info/ca-certificates-java.postinst configure\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM b.gcr.io/airflow-gcp/airflow-base:1.8.0.rc.100\n#  A few problems with compiling Java from source:\n#   1. Oracle.  Licensing prevents us from redistributing the official JDK.\n#   2. Compiling OpenJDK also requires the JDK to be installed, and it gets\n#        really hairy.\n# RUN apt-get update && apt-get install -y --no-install-recommends \\\n# \t\tbzip2 \\\n# \t\tunzip \\\n# \t\txz-utils \\\n# \t&& rm -rf /var/lib/apt/lists/*\n#\n# RUN echo 'deb http://httpredir.debian.org/debian jessie-backports main' > /etc/apt/sources.list.d/jessie-backports.list\n#\n# # Default to UTF-8 file.encoding\n# ENV LANG C.UTF-8\n#\n# # add a simple script that can auto-detect the appropriate JAVA_HOME value\n# # based on whether the JDK or only the JRE is installed\n# RUN { \\\n# \t\techo '#!/bin/sh'; \\\n# \t\techo 'set -e'; \\\n# \t\techo; \\\n# \t\techo 'dirname \"$(dirname \"$(readlink -f \"$(which javac || which java)\")\")\"'; \\\n# \t} > /usr/local/bin/docker-java-home \\\n# \t&& chmod +x /usr/local/bin/docker-java-home\n#\n# ENV JAVA_HOME /usr/lib/jvm/java-8-openjdk-amd64\n#\n# ENV JAVA_VERSION 8u121\n# ENV JAVA_DEBIAN_VERSION 8u121-b13-1~bpo8+1\n#\n#\n# # see https://bugs.debian.org/775775\n# # and https://github.com/docker-library/java/issues/19#issuecomment-70546872\n# ENV CA_CERTIFICATES_JAVA_VERSION 20140324\n#\n# RUN set -x \\\n# \t&& apt-get update \\\n# \t&& apt-get install -y \\\n#         openjdk-8-jre=\"$JAVA_DEBIAN_VERSION\" \\\n#         openjdk-8-jdk-headless=\"$JAVA_DEBIAN_VERSION\"\n#\n# RUN set -x \\\n# \t&& apt-get install -y \\\n# \t\topenjdk-8-jdk=\"$JAVA_DEBIAN_VERSION\" \\\n# \t\tca-certificates-java=\"$CA_CERTIFICATES_JAVA_VERSION\" \\\n# \t&& rm -rf /var/lib/apt/lists/* \\\n# \t&& [ \"$JAVA_HOME\" = \"$(docker-java-home)\" ]\n#\n# # see CA_CERTIFICATES_JAVA_VERSION notes above\n# RUN /var/lib/dpkg/info/ca-certificates-java.postinst configure\nRUN pip uninstall airflow -y\nRUN git fetch -vp \\\n && git checkout 8e7a5583610be370dd26d50df0b7b98d90dbd396 \\\n && python setup.py install\nRUN pip install flask_bcrypt\nRUN pip install flask_oauthlib\nRUN apt-get update \\\n && apt-get install --no-install-recommends bzip2 unzip xz-utils -y \\\n && rm -rf /var/lib/apt/lists/*\nRUN echo 'deb http://deb.debian.org/debian jessie-backports main' > /etc/apt/sources.list.d/jessie-backports.list\n#  Default to UTF-8 file.encoding\nENV LANG=\"C.UTF-8\"\n#  add a simple script that can auto-detect the appropriate JAVA_HOME value\n#  based on whether the JDK or only the JRE is installed\nRUN { echo '#!/bin/sh' ;echo 'set -e' ;echo ;echo 'dirname \"$(dirname \"$(readlink -f \"$(which javac || which java)\")\")\"' ; } > /usr/local/bin/docker-java-home \\\n && chmod +x /usr/local/bin/docker-java-home\nENV JAVA_HOME=\"/usr/lib/jvm/java-8-openjdk-amd64\"\nENV JAVA_VERSION=\"8u121\"\nENV JAVA_DEBIAN_VERSION=\"8u121-b13-1~bpo8+1\"\n#  see https://bugs.debian.org/775775\n#  and https://github.com/docker-library/java/issues/19#issuecomment-70546872\nENV CA_CERTIFICATES_JAVA_VERSION=\"20161107~bpo8+1\"\nRUN set -x \\\n && apt-get update \\\n && apt-get install openjdk-8-jdk=\"$JAVA_DEBIAN_VERSION\" ca-certificates-java=\"$CA_CERTIFICATES_JAVA_VERSION\" -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && [ \"$JAVA_HOME\" = \"$( docker-java-home ;)\" ]\n#  see CA_CERTIFICATES_JAVA_VERSION notes above\nRUN /var/lib/dpkg/info/ca-certificates-java.postinst configure\n","injectedSmells":[],"originalDockerfileHash":"052f939c8dae33d04c063e385d13e05a","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM b.gcr.io/airflow-gcp/airflow-base:1.8.0.rc.100\n#   A few problems with compiling Java from source:\n#    1. Oracle.  Licensing prevents us from redistributing the official JDK.\n#    2. Compiling OpenJDK also requires the JDK to be installed, and it gets\n#         really hairy.\n#  RUN apt-get update && apt-get install -y --no-install-recommends \\\n#  \t\tbzip2 \\\n#  \t\tunzip \\\n#  \t\txz-utils \\\n#  \t&& rm -rf /var/lib/apt/lists/*\n#\n#  RUN echo 'deb http://httpredir.debian.org/debian jessie-backports main' > /etc/apt/sources.list.d/jessie-backports.list\n#\n#  # Default to UTF-8 file.encoding\n#  ENV LANG C.UTF-8\n#\n#  # add a simple script that can auto-detect the appropriate JAVA_HOME value\n#  # based on whether the JDK or only the JRE is installed\n#  RUN { \\\n#  \t\techo '#!/bin/sh'; \\\n#  \t\techo 'set -e'; \\\n#  \t\techo; \\\n#  \t\techo 'dirname \"$(dirname \"$(readlink -f \"$(which javac || which java)\")\")\"'; \\\n#  \t} > /usr/local/bin/docker-java-home \\\n#  \t&& chmod +x /usr/local/bin/docker-java-home\n#\n#  ENV JAVA_HOME /usr/lib/jvm/java-8-openjdk-amd64\n#\n#  ENV JAVA_VERSION 8u121\n#  ENV JAVA_DEBIAN_VERSION 8u121-b13-1~bpo8+1\n#\n#\n#  # see https://bugs.debian.org/775775\n#  # and https://github.com/docker-library/java/issues/19#issuecomment-70546872\n#  ENV CA_CERTIFICATES_JAVA_VERSION 20140324\n#\n#  RUN set -x \\\n#  \t&& apt-get update \\\n#  \t&& apt-get install -y \\\n#          openjdk-8-jre=\"$JAVA_DEBIAN_VERSION\" \\\n#          openjdk-8-jdk-headless=\"$JAVA_DEBIAN_VERSION\"\n#\n#  RUN set -x \\\n#  \t&& apt-get install -y \\\n#  \t\topenjdk-8-jdk=\"$JAVA_DEBIAN_VERSION\" \\\n#  \t\tca-certificates-java=\"$CA_CERTIFICATES_JAVA_VERSION\" \\\n#  \t&& rm -rf /var/lib/apt/lists/* \\\n#  \t&& [ \"$JAVA_HOME\" = \"$(docker-java-home)\" ]\n#\n#  # see CA_CERTIFICATES_JAVA_VERSION notes above\n#  RUN /var/lib/dpkg/info/ca-certificates-java.postinst configure\nRUN pip uninstall airflow -y\nRUN git fetch -vp \\\n && git checkout 8e7a5583610be370dd26d50df0b7b98d90dbd396 \\\n && python setup.py install\nRUN pip install flask_bcrypt\nRUN pip install flask_oauthlib\nRUN apt-get update \\\n && apt-get install --no-install-recommends bzip2 unzip xz-utils -y \\\n && rm -rf /var/lib/apt/lists/*\nRUN echo 'deb http://deb.debian.org/debian jessie-backports main' > /etc/apt/sources.list.d/jessie-backports.list\n#   Default to UTF-8 file.encoding\nENV LANG=\"C.UTF-8\"\n#   add a simple script that can auto-detect the appropriate JAVA_HOME value\n#   based on whether the JDK or only the JRE is installed\nRUN { echo '#!/bin/sh' ;echo 'set -e' ;echo ;echo 'dirname \"$(dirname \"$(readlink -f \"$(which javac || which java)\")\")\"' ; } > /usr/local/bin/docker-java-home \\\n && chmod +x /usr/local/bin/docker-java-home\nENV JAVA_HOME=\"/usr/lib/jvm/java-8-openjdk-amd64\"\nENV JAVA_VERSION=\"8u121\"\nENV JAVA_DEBIAN_VERSION=\"8u121-b13-1~bpo8+1\"\n#   see https://bugs.debian.org/775775\n#   and https://github.com/docker-library/java/issues/19#issuecomment-70546872\nENV CA_CERTIFICATES_JAVA_VERSION=\"20161107~bpo8+1\"\nRUN set -x \\\n && apt-get update \\\n && apt-get install openjdk-8-jdk=\"$JAVA_DEBIAN_VERSION\" ca-certificates-java=\"$CA_CERTIFICATES_JAVA_VERSION\" -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && [ \"$JAVA_HOME\" = \"$( docker-java-home ;)\" ]\n#   see CA_CERTIFICATES_JAVA_VERSION notes above\nRUN /var/lib/dpkg/info/ca-certificates-java.postinst configure\n","originalDockerfileUglifiedHash":"aa7de8c1a7221c983a36c0119efbedf2","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/aa6d96e45ad8164f84d928ce246c5d69f0f1fdc8.dockerfile"}