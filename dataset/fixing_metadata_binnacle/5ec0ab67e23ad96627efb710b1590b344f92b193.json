{"seed":2906384264,"processedDockerfileHash":"fd0756f3b21008f4e158840de7d1ff35","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","have-a-healthcheck","have-a-user"],"processedDockerfile":"#  ## Capnp compiler\nFROM alpine:3.5 AS capnp\nRUN mkdir -p /src\nRUN apk update \\\n && apk add autoconf=2.69-r0 automake=1.15-r0 libtool=2.4.6-r1 linux-headers=4.4.6-r1 git=2.11.3-r2 g++=6.2.1-r1 make=4.2.1-r0\nRUN cd /src \\\n && git clone https://github.com/sandstorm-io/capnproto.git\nWORKDIR /src/capnproto/c++\nRUN ./setup-autotools.sh\nRUN autoreconf -i\nRUN ./configure\nRUN make -j6 check\nRUN make install\nRUN which capnp\n#  ## SDK\n#  FROM ocaml/opam@sha256:b42566186327141d715c212da3057942bd4cfa5503a87733d366835fa2ddf98d\nFROM ocaml/opam:alpine-3.5_ocaml-4.05.0 AS sdk\nCOPY --from=capnp /usr/local/bin/capnp /usr/local/bin/\nCOPY --from=capnp /usr/local/bin/capnpc /usr/local/bin/\nCOPY --from=capnp /usr/local/lib/libcapnpc-0.7-dev.so /usr/local/lib/\nCOPY --from=capnp /usr/local/lib/libcapnp-0.7-dev.so /usr/local/lib/\nCOPY --from=capnp /usr/local/lib/libkj-0.7-dev.so /usr/local/lib/\nCOPY --from=capnp /usr/local/include/capnp /usr/local/include/capnp\nRUN sudo mkdir -p /src\nUSER opam\nWORKDIR /src\nRUN git -C /home/opam/opam-repository fetch \\\n && git -C /home/opam/opam-repository reset ac26509c --hard \\\n && opam update\nCOPY sdk.opam /src\nRUN sudo chown opam -R /src\nRUN opam pin add sdk.local /src -n\nRUN opam depext -y alcotest sdk\nRUN opam install alcotest mtime\nRUN opam install --deps sdk\nRUN opam list\nCOPY ./sdk /src/\nRUN sudo chown opam -R /src\nRUN opam update sdk \\\n && opam install sdk -t\n#  ## dhcp-client\nFROM sdk AS dhcp-client\n#   charrua\nCOPY dhcp-client.opam /src\nRUN sudo chown opam -R /src\nRUN opam pin add dhcp-client /src -n\nRUN opam install dhcp-client --deps\nCOPY ./dhcp-client /src/dhcp-client\nRUN sudo chown opam -R /src\nRUN opam config exec -- jbuilder build --dev -p dhcp-client\nRUN sudo mkdir -p /out\nRUN sudo cp /src/_build/default/dhcp-client/main.exe /out/dhcp-client\nRUN sudo cp /src/_build/default/dhcp-client/main_eng.exe /out/dhcp-client-engine\nRUN sudo cp /src/_build/default/dhcp-client/main_net.exe /out/dhcp-client-network\nRUN sudo cp /src/_build/default/dhcp-client/main_act.exe /out/dhcp-client-actuator\n#  ## One binary\nFROM scratch\nUSER 0\nCOPY --from=dhcp-client /out/dhcp-client /\nCMD [\"/dhcp-client\", \"-vv\"]\n#  ## DHCP client engine\nFROM scratch\nUSER 0\nCOPY --from=dhcp-client /out/dhcp-client-engine /\nCMD [\"/dhcp-client-engine\", \"-vv\"]\n#  ## DHCP network proxy\nFROM scratch\nUSER 0\nCOPY --from=dhcp-client /out/dhcp-client-actuator /\nCMD [\"/dhcp-client-actuator\", \"-vv\"]\n#  ## Host actuator\nFROM scratch\nUSER 0\nCOPY --from=dhcp-client /out/dhcp-client-actuator /\nCMD [\"/dhcp-client-actuator\", \"-vv\"]\nRUN addgroup -S docker-user ; adduser -S -G docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"# ## Capnp compiler\nFROM alpine:3.5 AS capnp\nRUN mkdir -p /src\nRUN apk update \\\n && apk add autoconf automake libtool linux-headers git g++ make\nRUN cd /src \\\n && git clone https://github.com/sandstorm-io/capnproto.git\nWORKDIR /src/capnproto/c++\nRUN ./setup-autotools.sh\nRUN autoreconf -i\nRUN ./configure\nRUN make -j6 check\nRUN make install\nRUN which capnp\n# ## SDK\n# FROM ocaml/opam@sha256:b42566186327141d715c212da3057942bd4cfa5503a87733d366835fa2ddf98d\nFROM ocaml/opam:alpine-3.5_ocaml-4.05.0 AS sdk\nCOPY --from=capnp /usr/local/bin/capnp /usr/local/bin/\nCOPY --from=capnp /usr/local/bin/capnpc /usr/local/bin/\nCOPY --from=capnp /usr/local/lib/libcapnpc-0.7-dev.so /usr/local/lib/\nCOPY --from=capnp /usr/local/lib/libcapnp-0.7-dev.so /usr/local/lib/\nCOPY --from=capnp /usr/local/lib/libkj-0.7-dev.so /usr/local/lib/\nCOPY --from=capnp /usr/local/include/capnp /usr/local/include/capnp\nRUN sudo mkdir -p /src\nUSER opam\nWORKDIR /src\nRUN git -C /home/opam/opam-repository fetch \\\n && git -C /home/opam/opam-repository reset ac26509c --hard \\\n && opam update\nCOPY sdk.opam /src\nRUN sudo chown opam -R /src\nRUN opam pin add sdk.local /src -n\nRUN opam depext -y alcotest sdk\nRUN opam install alcotest mtime\nRUN opam install --deps sdk\nRUN opam list\nCOPY ./sdk /src/\nRUN sudo chown opam -R /src\nRUN opam update sdk \\\n && opam install sdk -t\n# ## dhcp-client\nFROM sdk AS dhcp-client\n#  charrua\nCOPY dhcp-client.opam /src\nRUN sudo chown opam -R /src\nRUN opam pin add dhcp-client /src -n\nRUN opam install dhcp-client --deps\nCOPY ./dhcp-client /src/dhcp-client\nRUN sudo chown opam -R /src\nRUN opam config exec -- jbuilder build --dev -p dhcp-client\nRUN sudo mkdir -p /out\nRUN sudo cp /src/_build/default/dhcp-client/main.exe /out/dhcp-client\nRUN sudo cp /src/_build/default/dhcp-client/main_eng.exe /out/dhcp-client-engine\nRUN sudo cp /src/_build/default/dhcp-client/main_net.exe /out/dhcp-client-network\nRUN sudo cp /src/_build/default/dhcp-client/main_act.exe /out/dhcp-client-actuator\n# ## One binary\nFROM scratch\nUSER 0\nCOPY --from=dhcp-client /out/dhcp-client /\nCMD [\"/dhcp-client\", \"-vv\"]\n# ## DHCP client engine\nFROM scratch\nUSER 0\nCOPY --from=dhcp-client /out/dhcp-client-engine /\nCMD [\"/dhcp-client-engine\", \"-vv\"]\n# ## DHCP network proxy\nFROM scratch\nUSER 0\nCOPY --from=dhcp-client /out/dhcp-client-actuator /\nCMD [\"/dhcp-client-actuator\", \"-vv\"]\n# ## Host actuator\nFROM scratch\nUSER 0\nCOPY --from=dhcp-client /out/dhcp-client-actuator /\nCMD [\"/dhcp-client-actuator\", \"-vv\"]\n","injectedSmells":[],"originalDockerfileHash":"17cd758209a7a0ec5c9103d5ad3be788","successfullyInjectedSmells":[],"originalDockerfileUglified":"#  ## Capnp compiler\nFROM alpine:3.5 AS capnp\nRUN mkdir -p /src\nRUN apk update \\\n && apk add autoconf automake libtool linux-headers git g++ make\nRUN cd /src \\\n && git clone https://github.com/sandstorm-io/capnproto.git\nWORKDIR /src/capnproto/c++\nRUN ./setup-autotools.sh\nRUN autoreconf -i\nRUN ./configure\nRUN make -j6 check\nRUN make install\nRUN which capnp\n#  ## SDK\n#  FROM ocaml/opam@sha256:b42566186327141d715c212da3057942bd4cfa5503a87733d366835fa2ddf98d\nFROM ocaml/opam:alpine-3.5_ocaml-4.05.0 AS sdk\nCOPY --from=capnp /usr/local/bin/capnp /usr/local/bin/\nCOPY --from=capnp /usr/local/bin/capnpc /usr/local/bin/\nCOPY --from=capnp /usr/local/lib/libcapnpc-0.7-dev.so /usr/local/lib/\nCOPY --from=capnp /usr/local/lib/libcapnp-0.7-dev.so /usr/local/lib/\nCOPY --from=capnp /usr/local/lib/libkj-0.7-dev.so /usr/local/lib/\nCOPY --from=capnp /usr/local/include/capnp /usr/local/include/capnp\nRUN sudo mkdir -p /src\nUSER opam\nWORKDIR /src\nRUN git -C /home/opam/opam-repository fetch \\\n && git -C /home/opam/opam-repository reset ac26509c --hard \\\n && opam update\nCOPY sdk.opam /src\nRUN sudo chown opam -R /src\nRUN opam pin add sdk.local /src -n\nRUN opam depext -y alcotest sdk\nRUN opam install alcotest mtime\nRUN opam install --deps sdk\nRUN opam list\nCOPY ./sdk /src/\nRUN sudo chown opam -R /src\nRUN opam update sdk \\\n && opam install sdk -t\n#  ## dhcp-client\nFROM sdk AS dhcp-client\n#   charrua\nCOPY dhcp-client.opam /src\nRUN sudo chown opam -R /src\nRUN opam pin add dhcp-client /src -n\nRUN opam install dhcp-client --deps\nCOPY ./dhcp-client /src/dhcp-client\nRUN sudo chown opam -R /src\nRUN opam config exec -- jbuilder build --dev -p dhcp-client\nRUN sudo mkdir -p /out\nRUN sudo cp /src/_build/default/dhcp-client/main.exe /out/dhcp-client\nRUN sudo cp /src/_build/default/dhcp-client/main_eng.exe /out/dhcp-client-engine\nRUN sudo cp /src/_build/default/dhcp-client/main_net.exe /out/dhcp-client-network\nRUN sudo cp /src/_build/default/dhcp-client/main_act.exe /out/dhcp-client-actuator\n#  ## One binary\nFROM scratch\nUSER 0\nCOPY --from=dhcp-client /out/dhcp-client /\nCMD [\"/dhcp-client\", \"-vv\"]\n#  ## DHCP client engine\nFROM scratch\nUSER 0\nCOPY --from=dhcp-client /out/dhcp-client-engine /\nCMD [\"/dhcp-client-engine\", \"-vv\"]\n#  ## DHCP network proxy\nFROM scratch\nUSER 0\nCOPY --from=dhcp-client /out/dhcp-client-actuator /\nCMD [\"/dhcp-client-actuator\", \"-vv\"]\n#  ## Host actuator\nFROM scratch\nUSER 0\nCOPY --from=dhcp-client /out/dhcp-client-actuator /\nCMD [\"/dhcp-client-actuator\", \"-vv\"]\n","originalDockerfileUglifiedHash":"d54ff814ecc8aa1876ac700051af563e","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/5ec0ab67e23ad96627efb710b1590b344f92b193.dockerfile"}