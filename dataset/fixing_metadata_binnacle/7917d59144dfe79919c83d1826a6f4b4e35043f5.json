{"seed":3751057370,"processedDockerfileHash":"b75bc04c3d0a64e83e350bac3cd82a76","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"#  BUILD_PUSH=hub,quay\n#  BUILD_PUSH_TAG_FROM=PHP_VERSION\nFROM bigm/base-deb-tools\n#   compile PHP 7.0 (cli and fpm)\n#   based on https://github.com/docker-library/php/blob/master/7.0/fpm/Dockerfile\n#   persistent / runtime deps\nRUN /xt/tools/_apt_install ca-certificates curl libpcre3 librecode0 libsqlite3-0 libxml2\n#   phpize deps\nRUN /xt/tools/_apt_install autoconf file g++ gcc libc-dev make pkg-config re2c ca-certificates curl libedit2\nENV PHP_INI_DIR=\"/usr/local/etc/php\"\nRUN mkdir -p $PHP_INI_DIR/conf.d\n#  prepare what will be compiled\nENV PHP_EXTRA_CONFIGURE_ARGS=\"--enable-fpm --with-fpm-user=root --with-fpm-group=root\"\nRUN /xt/tools/_apt_install $PHP_EXTRA_BUILD_DEPS bzip2 libcurl4-openssl-dev libpcre3-dev libreadline6-dev libssl-dev libxml2-dev librecode-dev libsqlite3-dev xz-utils libedit-dev\nRUN gpg --keyserver pool.sks-keyservers.net --recv-keys 6E4F6AB321FDC07F2C332E3AC2BF0BC433CFC8B3 0BD78B5F97500D450838F95DFE857D9A90D90EC1 1A4E8B7277C42E53DBA9C7B9BCAA30EA9C0D5763\n#   wkhtmltopdf - http://wkhtmltopdf.org/downloads.html\nRUN /xt/tools/_apt_install libxext6 fontconfig xfonts-base xfonts-75dpi libxrender-dev libjpeg-dev \\\n && /xt/tools/_download /tmp/wkhtmltox.deb http://download.gna.org/wkhtmltopdf/0.12/0.12.2.1/wkhtmltox-0.12.2.1_linux-trusty-amd64.deb \\\n && dpkg -i /tmp/wkhtmltox.deb\nENV PHP_VERSION=\"7.0.6\"\nCOPY compile-php.sh /tmp/compile-php.sh\nRUN /tmp/compile-php.sh \\\n && rm /tmp/compile-php.sh\n#  install very common extensions\nRUN /xt/tools/_apt_install libpng12-dev libjpeg-dev libbz2-dev libxslt1-dev libssh2-1-dev libmcrypt-dev\nCOPY tools/* /xt/tools/\nRUN /xt/tools/php_compile_extension gd --with-png-dir=/usr --with-jpeg-dir=/usr \\\n && /xt/tools/php_compile_extension zip \\\n && /xt/tools/php_compile_extension pdo_mysql \\\n && /xt/tools/php_compile_extension bz2 \\\n && /xt/tools/php_compile_extension xsl \\\n && /xt/tools/php_compile_extension xmlrpc \\\n && /xt/tools/php_compile_extension wddx \\\n && /xt/tools/php_compile_extension sockets \\\n && /xt/tools/php_compile_extension exif \\\n && /xt/tools/php_compile_extension ftp \\\n && /xt/tools/php_compile_extension gettext \\\n && /xt/tools/php_compile_extension mcrypt \\\n && /xt/tools/php_compile_extension soap \\\n && /xt/tools/php_compile_cleanup\n#  sysvsem + sysvshm\n#  sysvmsg?\n#  shmop?\n#  gmp ?\n#  mysql ?\n#  mysqli ?\nRUN yes \"\" | pecl install xdebug \\\n && echo \"zend_extension=xdebug.so\" > /usr/local/etc/ext-xdebug.ini \\\n && echo \"xdebug.remote_enable = on\" >> /usr/local/etc/ext-xdebug.ini \\\n && echo \"xdebug.remote_connect_back = on\" >> /usr/local/etc/ext-xdebug.ini \\\n && echo 'xdebug.idekey = \"PHPSTORM\"' >> /usr/local/etc/ext-xdebug.ini \\\n && echo \"xdebug.profiler_enable = 0\" >> /usr/local/etc/ext-xdebug.ini \\\n && echo \"xdebug.profiler_enable_trigger = 1\" >> /usr/local/etc/ext-xdebug.ini \\\n && echo \"xdebug.trace_enable_trigger = 1\" >> /usr/local/etc/ext-xdebug.ini\n#  TODO ssh2 not compiling under 7\n#  RUN yes \"\" | pecl install ssh2-0.12 \\\n#  \t&& echo \"extension=ssh2.so\" > /usr/local/etc/php/conf.d/ext-ssh2.ini\nRUN cd /tmp \\\n && git clone https://git.php.net/repository/pecl/networking/ssh2.git \\\n && cd /tmp/ssh2 \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && echo \"extension=ssh2.so\" > /usr/local/etc/php/conf.d/ext-ssh2.ini \\\n && rm -rf /tmp/ssh2\n#   #.install very common extensions\n#   composer\nRUN curl -sS https://getcomposer.org/installer | php \\\n && mv composer.phar /usr/local/bin/composer\n#   some pear libraries\nRUN pear install SQL_Parser-0.7.0\n#   translate-toolkit\nRUN /xt/tools/_apt_install translate-toolkit\nRUN /xt/tools/_enable_ssmtp \\\n && echo 'sendmail_path = \"/usr/sbin/ssmtp -t\"' > /usr/local/etc/php/conf.d/sendmail.ini\n#   another PDF tool\nRUN /xt/tools/_apt_install pdftk\nCOPY root/ /\nCOPY startup/* /xt/startup/\nCOPY supervisor.d/* /etc/supervisord.d/\nRUN mkdir -p /var/www/html\nWORKDIR /var/www\nENV PHP_TIMEZONE=\"Europe/London\"\nENV PHP_CONF_VERSION=\"production\"\nEXPOSE 9000/tcp\n#   .compile PHP 7.0 (cli and fpm)\nRUN /xt/tools/_apt_install libmagickwand-dev git \\\n && yes \"\" | pecl install imagick-3.4.1 \\\n && echo \"extension=imagick.so\" > /usr/local/etc/php/conf.d/ext-imagick.ini\n#  TODO we have to replace mongo driver with mongodb under 7\nRUN yes \"\" | pecl install mongodb \\\n && echo \"extension=mongodb.so\" > /usr/local/etc/php/conf.d/ext-mongo.ini\n#   TODO igbinary doesn't compile under 7 - https://github.com/igbinary/igbinary\n#   TODO memcached doesn't compile under 7 - https://github.com/php-memcached-dev/php-memcached/issues/194\n#   TODO use --enable-memcached-igbinary\n#   stable=2.2.7\n#  ENV MEMCACHED_VERSION 2.2.0\n#  RUN /xt/tools/_apt_install libmemcached-dev \\\n#  \t&& pecl install igbinary \\\n#  \t&& /xt/tools/_download /tmp/memcached.tgz https://pecl.php.net/get/memcached-${MEMCACHED_VERSION}.tgz \\\n#  \t&& cd /tmp && tar xf memcached.tgz \\\n#  \t&& cd /tmp/memcached-${MEMCACHED_VERSION} \\\n#  \t&& phpize \\\n#  \t&& ./configure --disable-memcached-sasl \\\n#  \t&& make \\\n#  \t&& make install \\\n#  \t&& echo \"extension=igbinary.so\" > /usr/local/etc/php/conf.d/ext-igbinary.ini \\\n#  \t&& echo \"extension=memcached.so\" > /usr/local/etc/php/conf.d/ext-memcached.ini\n#  RUN cd /tmp && /xt/tools/_download /tmp/apcu.tgz https://pecl.php.net/get/APCu \\\n#      && cd /tmp && tar xf apcu.tgz && cd /tmp/apcu-5.1.3 \\\n#  \t&& phpize && ./configure --enable-apcu --enable-apcu-bc && make && make install \\\n#      && rm -rf /tmp/apcu-5.1.3\nRUN yes \"\" | pecl install APCu-5.1.3 \\\n && yes \"\" | pecl install apcu_bc-beta \\\n && echo \"extension=apcu.so\" > /usr/local/etc/php/conf.d/ext-apcu.ini \\\n && echo \"extension=apc.so\" >> /usr/local/etc/php/conf.d/ext-apcu.ini\n#   we need msgpack until igbinary for PHP7 is not fixed https://github.com/igbinary/igbinary7/issues/3\nRUN yes \"\" | pecl install msgpack-beta \\\n && echo \"extension=msgpack.so\" > /usr/local/etc/php/conf.d/ext-msgpack.ini\nRUN cd /tmp \\\n && git clone https://github.com/igbinary/igbinary7.git \\\n && cd /tmp/igbinary7 \\\n && phpize \\\n && ./configure CFLAGS=\"-O2 -g\" --enable-igbinary \\\n && make \\\n && make install \\\n && rm -rf /tmp/igbinary7 \\\n && echo \"extension=igbinary.so\" > /usr/local/etc/php/conf.d/ext-igbinary.ini\nRUN /xt/tools/_apt_install libmemcached-dev \\\n && cd /tmp \\\n && git clone -b php7 https://github.com/php-memcached-dev/php-memcached \\\n && cd /tmp/php-memcached \\\n && phpize \\\n && ./configure --enable-memcached-igbinary --disable-memcached-sasl \\\n && make \\\n && make install \\\n && rm -rf /tmp/php-memcached \\\n && echo \"extension=memcached.so\" > /usr/local/etc/php/conf.d/ext-memcached.ini\nRUN echo \"session.serialize_handler=php\" > /usr/local/etc/php/conf.d/zzzzzzzz.txt\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"# BUILD_PUSH=hub,quay\n# BUILD_PUSH_TAG_FROM=PHP_VERSION\nFROM bigm/base-deb-tools\n#  compile PHP 7.0 (cli and fpm)\n#  based on https://github.com/docker-library/php/blob/master/7.0/fpm/Dockerfile\n#  persistent / runtime deps\nRUN /xt/tools/_apt_install ca-certificates curl libpcre3 librecode0 libsqlite3-0 libxml2\n#  phpize deps\nRUN /xt/tools/_apt_install autoconf file g++ gcc libc-dev make pkg-config re2c ca-certificates curl libedit2\nENV PHP_INI_DIR=\"/usr/local/etc/php\"\nRUN mkdir -p $PHP_INI_DIR/conf.d\n# prepare what will be compiled\nENV PHP_EXTRA_CONFIGURE_ARGS=\"--enable-fpm --with-fpm-user=root --with-fpm-group=root\"\nRUN /xt/tools/_apt_install $PHP_EXTRA_BUILD_DEPS bzip2 libcurl4-openssl-dev libpcre3-dev libreadline6-dev libssl-dev libxml2-dev librecode-dev libsqlite3-dev xz-utils libedit-dev\nRUN gpg --keyserver pool.sks-keyservers.net --recv-keys 6E4F6AB321FDC07F2C332E3AC2BF0BC433CFC8B3 0BD78B5F97500D450838F95DFE857D9A90D90EC1 1A4E8B7277C42E53DBA9C7B9BCAA30EA9C0D5763\n#  wkhtmltopdf - http://wkhtmltopdf.org/downloads.html\nRUN /xt/tools/_apt_install libxext6 fontconfig xfonts-base xfonts-75dpi libxrender-dev libjpeg-dev \\\n && /xt/tools/_download /tmp/wkhtmltox.deb http://download.gna.org/wkhtmltopdf/0.12/0.12.2.1/wkhtmltox-0.12.2.1_linux-trusty-amd64.deb \\\n && dpkg -i /tmp/wkhtmltox.deb\nENV PHP_VERSION=\"7.0.6\"\nCOPY compile-php.sh /tmp/compile-php.sh\nRUN /tmp/compile-php.sh \\\n && rm /tmp/compile-php.sh\n# install very common extensions\nRUN /xt/tools/_apt_install libpng12-dev libjpeg-dev libbz2-dev libxslt1-dev libssh2-1-dev libmcrypt-dev\nCOPY tools/* /xt/tools/\nRUN /xt/tools/php_compile_extension gd --with-png-dir=/usr --with-jpeg-dir=/usr \\\n && /xt/tools/php_compile_extension zip \\\n && /xt/tools/php_compile_extension pdo_mysql \\\n && /xt/tools/php_compile_extension bz2 \\\n && /xt/tools/php_compile_extension xsl \\\n && /xt/tools/php_compile_extension xmlrpc \\\n && /xt/tools/php_compile_extension wddx \\\n && /xt/tools/php_compile_extension sockets \\\n && /xt/tools/php_compile_extension exif \\\n && /xt/tools/php_compile_extension ftp \\\n && /xt/tools/php_compile_extension gettext \\\n && /xt/tools/php_compile_extension mcrypt \\\n && /xt/tools/php_compile_extension soap \\\n && /xt/tools/php_compile_cleanup\n# sysvsem + sysvshm\n# sysvmsg?\n# shmop?\n# gmp ?\n# mysql ?\n# mysqli ?\nRUN yes \"\" | pecl install xdebug \\\n && echo \"zend_extension=xdebug.so\" > /usr/local/etc/ext-xdebug.ini \\\n && echo \"xdebug.remote_enable = on\" >> /usr/local/etc/ext-xdebug.ini \\\n && echo \"xdebug.remote_connect_back = on\" >> /usr/local/etc/ext-xdebug.ini \\\n && echo 'xdebug.idekey = \"PHPSTORM\"' >> /usr/local/etc/ext-xdebug.ini \\\n && echo \"xdebug.profiler_enable = 0\" >> /usr/local/etc/ext-xdebug.ini \\\n && echo \"xdebug.profiler_enable_trigger = 1\" >> /usr/local/etc/ext-xdebug.ini \\\n && echo \"xdebug.trace_enable_trigger = 1\" >> /usr/local/etc/ext-xdebug.ini\n# TODO ssh2 not compiling under 7\n# RUN yes \"\" | pecl install ssh2-0.12 \\\n# \t&& echo \"extension=ssh2.so\" > /usr/local/etc/php/conf.d/ext-ssh2.ini\nRUN cd /tmp \\\n && git clone https://git.php.net/repository/pecl/networking/ssh2.git \\\n && cd /tmp/ssh2 \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && echo \"extension=ssh2.so\" > /usr/local/etc/php/conf.d/ext-ssh2.ini \\\n && rm -rf /tmp/ssh2\n#  #.install very common extensions\n#  composer\nRUN curl -sS https://getcomposer.org/installer | php \\\n && mv composer.phar /usr/local/bin/composer\n#  some pear libraries\nRUN pear install SQL_Parser-0.7.0\n#  translate-toolkit\nRUN /xt/tools/_apt_install translate-toolkit\nRUN /xt/tools/_enable_ssmtp \\\n && echo 'sendmail_path = \"/usr/sbin/ssmtp -t\"' > /usr/local/etc/php/conf.d/sendmail.ini\n#  another PDF tool\nRUN /xt/tools/_apt_install pdftk\nADD root/ /\nADD startup/* /xt/startup/\nADD supervisor.d/* /etc/supervisord.d/\nRUN mkdir -p /var/www/html\nWORKDIR /var/www\nENV PHP_TIMEZONE=\"Europe/London\"\nENV PHP_CONF_VERSION=\"production\"\nEXPOSE 9000/tcp\n#  .compile PHP 7.0 (cli and fpm)\nRUN /xt/tools/_apt_install libmagickwand-dev git \\\n && yes \"\" | pecl install imagick-3.4.1 \\\n && echo \"extension=imagick.so\" > /usr/local/etc/php/conf.d/ext-imagick.ini\n# TODO we have to replace mongo driver with mongodb under 7\nRUN yes \"\" | pecl install mongodb \\\n && echo \"extension=mongodb.so\" > /usr/local/etc/php/conf.d/ext-mongo.ini\n#  TODO igbinary doesn't compile under 7 - https://github.com/igbinary/igbinary\n#  TODO memcached doesn't compile under 7 - https://github.com/php-memcached-dev/php-memcached/issues/194\n#  TODO use --enable-memcached-igbinary\n#  stable=2.2.7\n# ENV MEMCACHED_VERSION 2.2.0\n# RUN /xt/tools/_apt_install libmemcached-dev \\\n# \t&& pecl install igbinary \\\n# \t&& /xt/tools/_download /tmp/memcached.tgz https://pecl.php.net/get/memcached-${MEMCACHED_VERSION}.tgz \\\n# \t&& cd /tmp && tar xf memcached.tgz \\\n# \t&& cd /tmp/memcached-${MEMCACHED_VERSION} \\\n# \t&& phpize \\\n# \t&& ./configure --disable-memcached-sasl \\\n# \t&& make \\\n# \t&& make install \\\n# \t&& echo \"extension=igbinary.so\" > /usr/local/etc/php/conf.d/ext-igbinary.ini \\\n# \t&& echo \"extension=memcached.so\" > /usr/local/etc/php/conf.d/ext-memcached.ini\n# RUN cd /tmp && /xt/tools/_download /tmp/apcu.tgz https://pecl.php.net/get/APCu \\\n#     && cd /tmp && tar xf apcu.tgz && cd /tmp/apcu-5.1.3 \\\n# \t&& phpize && ./configure --enable-apcu --enable-apcu-bc && make && make install \\\n#     && rm -rf /tmp/apcu-5.1.3\nRUN yes \"\" | pecl install APCu-5.1.3 \\\n && yes \"\" | pecl install apcu_bc-beta \\\n && echo \"extension=apcu.so\" > /usr/local/etc/php/conf.d/ext-apcu.ini \\\n && echo \"extension=apc.so\" >> /usr/local/etc/php/conf.d/ext-apcu.ini\n#  we need msgpack until igbinary for PHP7 is not fixed https://github.com/igbinary/igbinary7/issues/3\nRUN yes \"\" | pecl install msgpack-beta \\\n && echo \"extension=msgpack.so\" > /usr/local/etc/php/conf.d/ext-msgpack.ini\nRUN cd /tmp \\\n && git clone https://github.com/igbinary/igbinary7.git \\\n && cd /tmp/igbinary7 \\\n && phpize \\\n && ./configure CFLAGS=\"-O2 -g\" --enable-igbinary \\\n && make \\\n && make install \\\n && rm -rf /tmp/igbinary7 \\\n && echo \"extension=igbinary.so\" > /usr/local/etc/php/conf.d/ext-igbinary.ini\nRUN /xt/tools/_apt_install libmemcached-dev \\\n && cd /tmp \\\n && git clone -b php7 https://github.com/php-memcached-dev/php-memcached \\\n && cd /tmp/php-memcached \\\n && phpize \\\n && ./configure --enable-memcached-igbinary --disable-memcached-sasl \\\n && make \\\n && make install \\\n && rm -rf /tmp/php-memcached \\\n && echo \"extension=memcached.so\" > /usr/local/etc/php/conf.d/ext-memcached.ini\nRUN echo \"session.serialize_handler=php\" > /usr/local/etc/php/conf.d/zzzzzzzz.txt\n","injectedSmells":[],"originalDockerfileHash":"b327b34db2ee9367c783f378df9497da","successfullyInjectedSmells":[],"originalDockerfileUglified":"#  BUILD_PUSH=hub,quay\n#  BUILD_PUSH_TAG_FROM=PHP_VERSION\nFROM bigm/base-deb-tools\n#   compile PHP 7.0 (cli and fpm)\n#   based on https://github.com/docker-library/php/blob/master/7.0/fpm/Dockerfile\n#   persistent / runtime deps\nRUN /xt/tools/_apt_install ca-certificates curl libpcre3 librecode0 libsqlite3-0 libxml2\n#   phpize deps\nRUN /xt/tools/_apt_install autoconf file g++ gcc libc-dev make pkg-config re2c ca-certificates curl libedit2\nENV PHP_INI_DIR=\"/usr/local/etc/php\"\nRUN mkdir -p $PHP_INI_DIR/conf.d\n#  prepare what will be compiled\nENV PHP_EXTRA_CONFIGURE_ARGS=\"--enable-fpm --with-fpm-user=root --with-fpm-group=root\"\nRUN /xt/tools/_apt_install $PHP_EXTRA_BUILD_DEPS bzip2 libcurl4-openssl-dev libpcre3-dev libreadline6-dev libssl-dev libxml2-dev librecode-dev libsqlite3-dev xz-utils libedit-dev\nRUN gpg --keyserver pool.sks-keyservers.net --recv-keys 6E4F6AB321FDC07F2C332E3AC2BF0BC433CFC8B3 0BD78B5F97500D450838F95DFE857D9A90D90EC1 1A4E8B7277C42E53DBA9C7B9BCAA30EA9C0D5763\n#   wkhtmltopdf - http://wkhtmltopdf.org/downloads.html\nRUN /xt/tools/_apt_install libxext6 fontconfig xfonts-base xfonts-75dpi libxrender-dev libjpeg-dev \\\n && /xt/tools/_download /tmp/wkhtmltox.deb http://download.gna.org/wkhtmltopdf/0.12/0.12.2.1/wkhtmltox-0.12.2.1_linux-trusty-amd64.deb \\\n && dpkg -i /tmp/wkhtmltox.deb\nENV PHP_VERSION=\"7.0.6\"\nCOPY compile-php.sh /tmp/compile-php.sh\nRUN /tmp/compile-php.sh \\\n && rm /tmp/compile-php.sh\n#  install very common extensions\nRUN /xt/tools/_apt_install libpng12-dev libjpeg-dev libbz2-dev libxslt1-dev libssh2-1-dev libmcrypt-dev\nCOPY tools/* /xt/tools/\nRUN /xt/tools/php_compile_extension gd --with-png-dir=/usr --with-jpeg-dir=/usr \\\n && /xt/tools/php_compile_extension zip \\\n && /xt/tools/php_compile_extension pdo_mysql \\\n && /xt/tools/php_compile_extension bz2 \\\n && /xt/tools/php_compile_extension xsl \\\n && /xt/tools/php_compile_extension xmlrpc \\\n && /xt/tools/php_compile_extension wddx \\\n && /xt/tools/php_compile_extension sockets \\\n && /xt/tools/php_compile_extension exif \\\n && /xt/tools/php_compile_extension ftp \\\n && /xt/tools/php_compile_extension gettext \\\n && /xt/tools/php_compile_extension mcrypt \\\n && /xt/tools/php_compile_extension soap \\\n && /xt/tools/php_compile_cleanup\n#  sysvsem + sysvshm\n#  sysvmsg?\n#  shmop?\n#  gmp ?\n#  mysql ?\n#  mysqli ?\nRUN yes \"\" | pecl install xdebug \\\n && echo \"zend_extension=xdebug.so\" > /usr/local/etc/ext-xdebug.ini \\\n && echo \"xdebug.remote_enable = on\" >> /usr/local/etc/ext-xdebug.ini \\\n && echo \"xdebug.remote_connect_back = on\" >> /usr/local/etc/ext-xdebug.ini \\\n && echo 'xdebug.idekey = \"PHPSTORM\"' >> /usr/local/etc/ext-xdebug.ini \\\n && echo \"xdebug.profiler_enable = 0\" >> /usr/local/etc/ext-xdebug.ini \\\n && echo \"xdebug.profiler_enable_trigger = 1\" >> /usr/local/etc/ext-xdebug.ini \\\n && echo \"xdebug.trace_enable_trigger = 1\" >> /usr/local/etc/ext-xdebug.ini\n#  TODO ssh2 not compiling under 7\n#  RUN yes \"\" | pecl install ssh2-0.12 \\\n#  \t&& echo \"extension=ssh2.so\" > /usr/local/etc/php/conf.d/ext-ssh2.ini\nRUN cd /tmp \\\n && git clone https://git.php.net/repository/pecl/networking/ssh2.git \\\n && cd /tmp/ssh2 \\\n && phpize \\\n && ./configure \\\n && make \\\n && make install \\\n && echo \"extension=ssh2.so\" > /usr/local/etc/php/conf.d/ext-ssh2.ini \\\n && rm -rf /tmp/ssh2\n#   #.install very common extensions\n#   composer\nRUN curl -sS https://getcomposer.org/installer | php \\\n && mv composer.phar /usr/local/bin/composer\n#   some pear libraries\nRUN pear install SQL_Parser-0.7.0\n#   translate-toolkit\nRUN /xt/tools/_apt_install translate-toolkit\nRUN /xt/tools/_enable_ssmtp \\\n && echo 'sendmail_path = \"/usr/sbin/ssmtp -t\"' > /usr/local/etc/php/conf.d/sendmail.ini\n#   another PDF tool\nRUN /xt/tools/_apt_install pdftk\nADD root/ /\nADD startup/* /xt/startup/\nADD supervisor.d/* /etc/supervisord.d/\nRUN mkdir -p /var/www/html\nWORKDIR /var/www\nENV PHP_TIMEZONE=\"Europe/London\"\nENV PHP_CONF_VERSION=\"production\"\nEXPOSE 9000/tcp\n#   .compile PHP 7.0 (cli and fpm)\nRUN /xt/tools/_apt_install libmagickwand-dev git \\\n && yes \"\" | pecl install imagick-3.4.1 \\\n && echo \"extension=imagick.so\" > /usr/local/etc/php/conf.d/ext-imagick.ini\n#  TODO we have to replace mongo driver with mongodb under 7\nRUN yes \"\" | pecl install mongodb \\\n && echo \"extension=mongodb.so\" > /usr/local/etc/php/conf.d/ext-mongo.ini\n#   TODO igbinary doesn't compile under 7 - https://github.com/igbinary/igbinary\n#   TODO memcached doesn't compile under 7 - https://github.com/php-memcached-dev/php-memcached/issues/194\n#   TODO use --enable-memcached-igbinary\n#   stable=2.2.7\n#  ENV MEMCACHED_VERSION 2.2.0\n#  RUN /xt/tools/_apt_install libmemcached-dev \\\n#  \t&& pecl install igbinary \\\n#  \t&& /xt/tools/_download /tmp/memcached.tgz https://pecl.php.net/get/memcached-${MEMCACHED_VERSION}.tgz \\\n#  \t&& cd /tmp && tar xf memcached.tgz \\\n#  \t&& cd /tmp/memcached-${MEMCACHED_VERSION} \\\n#  \t&& phpize \\\n#  \t&& ./configure --disable-memcached-sasl \\\n#  \t&& make \\\n#  \t&& make install \\\n#  \t&& echo \"extension=igbinary.so\" > /usr/local/etc/php/conf.d/ext-igbinary.ini \\\n#  \t&& echo \"extension=memcached.so\" > /usr/local/etc/php/conf.d/ext-memcached.ini\n#  RUN cd /tmp && /xt/tools/_download /tmp/apcu.tgz https://pecl.php.net/get/APCu \\\n#      && cd /tmp && tar xf apcu.tgz && cd /tmp/apcu-5.1.3 \\\n#  \t&& phpize && ./configure --enable-apcu --enable-apcu-bc && make && make install \\\n#      && rm -rf /tmp/apcu-5.1.3\nRUN yes \"\" | pecl install APCu-5.1.3 \\\n && yes \"\" | pecl install apcu_bc-beta \\\n && echo \"extension=apcu.so\" > /usr/local/etc/php/conf.d/ext-apcu.ini \\\n && echo \"extension=apc.so\" >> /usr/local/etc/php/conf.d/ext-apcu.ini\n#   we need msgpack until igbinary for PHP7 is not fixed https://github.com/igbinary/igbinary7/issues/3\nRUN yes \"\" | pecl install msgpack-beta \\\n && echo \"extension=msgpack.so\" > /usr/local/etc/php/conf.d/ext-msgpack.ini\nRUN cd /tmp \\\n && git clone https://github.com/igbinary/igbinary7.git \\\n && cd /tmp/igbinary7 \\\n && phpize \\\n && ./configure CFLAGS=\"-O2 -g\" --enable-igbinary \\\n && make \\\n && make install \\\n && rm -rf /tmp/igbinary7 \\\n && echo \"extension=igbinary.so\" > /usr/local/etc/php/conf.d/ext-igbinary.ini\nRUN /xt/tools/_apt_install libmemcached-dev \\\n && cd /tmp \\\n && git clone -b php7 https://github.com/php-memcached-dev/php-memcached \\\n && cd /tmp/php-memcached \\\n && phpize \\\n && ./configure --enable-memcached-igbinary --disable-memcached-sasl \\\n && make \\\n && make install \\\n && rm -rf /tmp/php-memcached \\\n && echo \"extension=memcached.so\" > /usr/local/etc/php/conf.d/ext-memcached.ini\nRUN echo \"session.serialize_handler=php\" > /usr/local/etc/php/conf.d/zzzzzzzz.txt\n","originalDockerfileUglifiedHash":"eada3ca0edce3a98b24b2fa43524542d","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/7917d59144dfe79919c83d1826a6f4b4e35043f5.dockerfile"}