{"seed":2161931728,"processedDockerfileHash":"c056dce08831ec9d8797ae5a35285f19","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM php:5.4-fpm\nRUN apt-get update \\\n && apt-get install --no-install-recommends libz-dev libmemcached-dev -y\nRUN pecl install memcached-2.2.0\nRUN echo extension=memcached.so >> /usr/local/etc/php/conf.d/memcached.ini\n#   gd extension\nRUN apt-get update \\\n && apt-get install --no-install-recommends libpng-dev libfreetype6-dev libjpeg-dev libxpm-dev libxml2-dev libxslt-dev libmcrypt-dev librabbitmq-dev libssh-dev libvpx-dev -y\n#   php <5.5 only workaround for xpm\nRUN ln -s /usr/lib/x86_64-linux-gnu/libXpm.a /usr/lib/x86_64-linux-gnu/libXpm.so /usr/lib/\nRUN docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ --with-xpm-dir=/usr/include --with-vpx-dir=/usr/include/\nRUN pecl install amqp-1.9.1\nRUN docker-php-ext-enable amqp\nRUN docker-php-ext-install gd\nRUN docker-php-ext-install zip\nRUN docker-php-ext-install xsl\nRUN apt-get update \\\n && apt-get install --no-install-recommends libicu-dev -y\nRUN docker-php-ext-install intl\nRUN docker-php-ext-install mysqli\nRUN docker-php-ext-install pdo_mysql\n#   use apc instead of opcache on php <5.5\nRUN pecl install apc\nRUN docker-php-ext-enable apc\nRUN docker-php-ext-install bcmath\nRUN docker-php-ext-install calendar\nRUN docker-php-ext-install mcrypt\nRUN docker-php-ext-install sockets\nRUN pecl install redis \\\n && docker-php-ext-enable redis\n#   ldap\nRUN apt-get update \\\n && apt-get install --no-install-recommends libldap2-dev -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && docker-php-ext-configure ldap --with-libdir=lib/x86_64-linux-gnu/ \\\n && docker-php-ext-install ldap\n#   ldap  \nRUN docker-php-ext-configure pcntl --enable-pcntl \\\n && docker-php-ext-install pcntl\nRUN pecl install xdebug-2.4.0\nRUN echo \"zend_extension=`php -i | grep ^extension_dir | cut -f 3 -d ' ' `/xdebug.so\" >> /usr/local/etc/php/conf.d/xdebug.ini\nRUN docker-php-ext-install soap\nENV COMPOSER_HOME=\"/composer\"\nCOPY --from=composer:1.8.4 /usr/bin/composer /usr/local/bin/composer\nRUN apt-get update \\\n && apt-get install --no-install-recommends git vim mysql-client rsync sshpass bzip2 msmtp unzip -y\nCOPY php.ini /usr/local/etc/php/php.ini\n#   Cron\nRUN apt-get update \\\n && apt-get install --no-install-recommends cron -y \\\n && mkfifo --mode 0666 /var/log/cron.log \\\n && sed --regexp-extended --in-place 's/^session\\s+required\\s+pam_loginuid.so$/session optional pam_loginuid.so/' /etc/pam.d/cron\nCOPY start-cron /usr/sbin\nRUN chmod +x /usr/sbin/start-cron\n#   Cron\nENV PHP_DATE_TIMEZONE=\"\" \\\n    PHP_LOG_ERRORS_MAX_LEN=\"1024\" \\\n    PHP_LOG_ERRORS=\"\" \\\n    PHP_MAX_EXECUTION_TIME=\"0\" \\\n    PHP_MAX_FILE_UPLOADS=\"20\" \\\n    PHP_MAX_INPUT_VARS=\"1000\" \\\n    PHP_MEMORY_LIMIT=\"128M\" \\\n    PHP_POST_MAX_SIZE=\"8M\" \\\n    PHP_SENDMAIL_PATH=\"/usr/sbin/sendmail -t -i\" \\\n    PHP_SESSION_SAVE_HANDLER=\"files\" \\\n    PHP_SESSION_SAVE_PATH=\"\" \\\n    PHP_UPLOAD_MAX_FILESIZE=\"2M\" \\\n    PHP_XDEBUG_DEFAULT_ENABLE=\"0\" \\\n    PHP_XDEBUG_IDEKEY=\" PHP_XDEBUG_PROFILER_ENABLE=0\" \\\n    PHP_XDEBUG_REMOTE_AUTOSTART=\"0\" \\\n    PHP_XDEBUG_REMOTE_CONNECT_BACK=\"0\" \\\n    PHP_XDEBUG_REMOTE_ENABLE=\"0\" \\\n    PHP_XDEBUG_REMOTE_HOST=\"0\"\nWORKDIR /usr/src/app\n#   imagick\nRUN apt-get update \\\n && apt-get install --no-install-recommends libmagickwand-dev -y \\\n && pecl install imagick \\\n && docker-php-ext-enable imagick\n#   Install Postgre PDO\nRUN apt-get install --no-install-recommends libpq-dev -y \\\n && docker-php-ext-configure pgsql -with-pgsql=/usr/local/pgsql \\\n && docker-php-ext-install pdo_pgsql pgsql\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\n","originalDockerfile":"FROM php:5.4-fpm\nRUN apt-get update \\\n && apt-get install libz-dev libmemcached-dev -y\nRUN pecl install memcached-2.2.0\nRUN echo extension=memcached.so >> /usr/local/etc/php/conf.d/memcached.ini\n#  gd extension\nRUN apt-get update \\\n && apt-get install libpng-dev libfreetype6-dev libjpeg-dev libxpm-dev libxml2-dev libxslt-dev libmcrypt-dev librabbitmq-dev libssh-dev libvpx-dev -y\n#  php <5.5 only workaround for xpm\nRUN ln -s /usr/lib/x86_64-linux-gnu/libXpm.a /usr/lib/x86_64-linux-gnu/libXpm.so /usr/lib/\nRUN docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ --with-xpm-dir=/usr/include --with-vpx-dir=/usr/include/\nRUN pecl install amqp-1.9.1\nRUN docker-php-ext-enable amqp\nRUN docker-php-ext-install gd\nRUN docker-php-ext-install zip\nRUN docker-php-ext-install xsl\nRUN apt-get update \\\n && apt-get install libicu-dev -y\nRUN docker-php-ext-install intl\nRUN docker-php-ext-install mysqli\nRUN docker-php-ext-install pdo_mysql\n#  use apc instead of opcache on php <5.5\nRUN pecl install apc\nRUN docker-php-ext-enable apc\nRUN docker-php-ext-install bcmath\nRUN docker-php-ext-install calendar\nRUN docker-php-ext-install mcrypt\nRUN docker-php-ext-install sockets\nRUN pecl install redis \\\n && docker-php-ext-enable redis\n#  ldap\nRUN apt-get update \\\n && apt-get install libldap2-dev -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && docker-php-ext-configure ldap --with-libdir=lib/x86_64-linux-gnu/ \\\n && docker-php-ext-install ldap\n#  ldap  \nRUN docker-php-ext-configure pcntl --enable-pcntl \\\n && docker-php-ext-install pcntl\nRUN pecl install xdebug-2.4.0\nRUN echo \"zend_extension=`php -i | grep ^extension_dir | cut -f 3 -d ' ' `/xdebug.so\" >> /usr/local/etc/php/conf.d/xdebug.ini\nRUN docker-php-ext-install soap\nENV COMPOSER_HOME=\"/composer\"\nCOPY --from=composer:1.8.4 /usr/bin/composer /usr/local/bin/composer\nRUN apt-get update \\\n && apt-get install git vim mysql-client rsync sshpass bzip2 msmtp unzip -y\nADD php.ini /usr/local/etc/php/php.ini\n#  Cron\nRUN apt-get update \\\n && apt-get install cron -y \\\n && mkfifo --mode 0666 /var/log/cron.log \\\n && sed --regexp-extended --in-place 's/^session\\s+required\\s+pam_loginuid.so$/session optional pam_loginuid.so/' /etc/pam.d/cron\nCOPY start-cron /usr/sbin\nRUN chmod +x /usr/sbin/start-cron\n#  Cron\nENV PHP_DATE_TIMEZONE=\"\" \\\n    PHP_LOG_ERRORS_MAX_LEN=\"1024\" \\\n    PHP_LOG_ERRORS=\"\" \\\n    PHP_MAX_EXECUTION_TIME=\"0\" \\\n    PHP_MAX_FILE_UPLOADS=\"20\" \\\n    PHP_MAX_INPUT_VARS=\"1000\" \\\n    PHP_MEMORY_LIMIT=\"128M\" \\\n    PHP_POST_MAX_SIZE=\"8M\" \\\n    PHP_SENDMAIL_PATH=\"/usr/sbin/sendmail -t -i\" \\\n    PHP_SESSION_SAVE_HANDLER=\"files\" \\\n    PHP_SESSION_SAVE_PATH=\"\" \\\n    PHP_UPLOAD_MAX_FILESIZE=\"2M\" \\\n    PHP_XDEBUG_DEFAULT_ENABLE=\"0\" \\\n    PHP_XDEBUG_IDEKEY=\" PHP_XDEBUG_PROFILER_ENABLE=0\" \\\n    PHP_XDEBUG_REMOTE_AUTOSTART=\"0\" \\\n    PHP_XDEBUG_REMOTE_CONNECT_BACK=\"0\" \\\n    PHP_XDEBUG_REMOTE_ENABLE=\"0\" \\\n    PHP_XDEBUG_REMOTE_HOST=\"0\"\nWORKDIR /usr/src/app\n#  imagick\nRUN apt-get update \\\n && apt-get install libmagickwand-dev -y \\\n && pecl install imagick \\\n && docker-php-ext-enable imagick\n#  Install Postgre PDO\nRUN apt-get install libpq-dev -y \\\n && docker-php-ext-configure pgsql -with-pgsql=/usr/local/pgsql \\\n && docker-php-ext-install pdo_pgsql pgsql\n","injectedSmells":[],"originalDockerfileHash":"200521f2d4929ad277dd1baf80dc75d0","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM php:5.4-fpm\nRUN apt-get update \\\n && apt-get install libz-dev libmemcached-dev -y\nRUN pecl install memcached-2.2.0\nRUN echo extension=memcached.so >> /usr/local/etc/php/conf.d/memcached.ini\n#   gd extension\nRUN apt-get update \\\n && apt-get install libpng-dev libfreetype6-dev libjpeg-dev libxpm-dev libxml2-dev libxslt-dev libmcrypt-dev librabbitmq-dev libssh-dev libvpx-dev -y\n#   php <5.5 only workaround for xpm\nRUN ln -s /usr/lib/x86_64-linux-gnu/libXpm.a /usr/lib/x86_64-linux-gnu/libXpm.so /usr/lib/\nRUN docker-php-ext-configure gd --with-freetype-dir=/usr/include/ --with-jpeg-dir=/usr/include/ --with-xpm-dir=/usr/include --with-vpx-dir=/usr/include/\nRUN pecl install amqp-1.9.1\nRUN docker-php-ext-enable amqp\nRUN docker-php-ext-install gd\nRUN docker-php-ext-install zip\nRUN docker-php-ext-install xsl\nRUN apt-get update \\\n && apt-get install libicu-dev -y\nRUN docker-php-ext-install intl\nRUN docker-php-ext-install mysqli\nRUN docker-php-ext-install pdo_mysql\n#   use apc instead of opcache on php <5.5\nRUN pecl install apc\nRUN docker-php-ext-enable apc\nRUN docker-php-ext-install bcmath\nRUN docker-php-ext-install calendar\nRUN docker-php-ext-install mcrypt\nRUN docker-php-ext-install sockets\nRUN pecl install redis \\\n && docker-php-ext-enable redis\n#   ldap\nRUN apt-get update \\\n && apt-get install libldap2-dev -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && docker-php-ext-configure ldap --with-libdir=lib/x86_64-linux-gnu/ \\\n && docker-php-ext-install ldap\n#   ldap  \nRUN docker-php-ext-configure pcntl --enable-pcntl \\\n && docker-php-ext-install pcntl\nRUN pecl install xdebug-2.4.0\nRUN echo \"zend_extension=`php -i | grep ^extension_dir | cut -f 3 -d ' ' `/xdebug.so\" >> /usr/local/etc/php/conf.d/xdebug.ini\nRUN docker-php-ext-install soap\nENV COMPOSER_HOME=\"/composer\"\nCOPY --from=composer:1.8.4 /usr/bin/composer /usr/local/bin/composer\nRUN apt-get update \\\n && apt-get install git vim mysql-client rsync sshpass bzip2 msmtp unzip -y\nADD php.ini /usr/local/etc/php/php.ini\n#   Cron\nRUN apt-get update \\\n && apt-get install cron -y \\\n && mkfifo --mode 0666 /var/log/cron.log \\\n && sed --regexp-extended --in-place 's/^session\\s+required\\s+pam_loginuid.so$/session optional pam_loginuid.so/' /etc/pam.d/cron\nCOPY start-cron /usr/sbin\nRUN chmod +x /usr/sbin/start-cron\n#   Cron\nENV PHP_DATE_TIMEZONE=\"\" \\\n    PHP_LOG_ERRORS_MAX_LEN=\"1024\" \\\n    PHP_LOG_ERRORS=\"\" \\\n    PHP_MAX_EXECUTION_TIME=\"0\" \\\n    PHP_MAX_FILE_UPLOADS=\"20\" \\\n    PHP_MAX_INPUT_VARS=\"1000\" \\\n    PHP_MEMORY_LIMIT=\"128M\" \\\n    PHP_POST_MAX_SIZE=\"8M\" \\\n    PHP_SENDMAIL_PATH=\"/usr/sbin/sendmail -t -i\" \\\n    PHP_SESSION_SAVE_HANDLER=\"files\" \\\n    PHP_SESSION_SAVE_PATH=\"\" \\\n    PHP_UPLOAD_MAX_FILESIZE=\"2M\" \\\n    PHP_XDEBUG_DEFAULT_ENABLE=\"0\" \\\n    PHP_XDEBUG_IDEKEY=\" PHP_XDEBUG_PROFILER_ENABLE=0\" \\\n    PHP_XDEBUG_REMOTE_AUTOSTART=\"0\" \\\n    PHP_XDEBUG_REMOTE_CONNECT_BACK=\"0\" \\\n    PHP_XDEBUG_REMOTE_ENABLE=\"0\" \\\n    PHP_XDEBUG_REMOTE_HOST=\"0\"\nWORKDIR /usr/src/app\n#   imagick\nRUN apt-get update \\\n && apt-get install libmagickwand-dev -y \\\n && pecl install imagick \\\n && docker-php-ext-enable imagick\n#   Install Postgre PDO\nRUN apt-get install libpq-dev -y \\\n && docker-php-ext-configure pgsql -with-pgsql=/usr/local/pgsql \\\n && docker-php-ext-install pdo_pgsql pgsql\n","originalDockerfileUglifiedHash":"d6f90953163a56e489e709c3df48f436","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/55d5de8790c76c2764c5e803f9fedc5814b8181d.dockerfile"}