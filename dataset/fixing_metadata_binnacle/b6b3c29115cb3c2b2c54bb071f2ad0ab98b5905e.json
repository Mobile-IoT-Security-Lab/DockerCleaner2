{"seed":3252734741,"processedDockerfileHash":"35b4299b08f80337c37a423779caf67b","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","do-not-have-secrets","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM python:3.6-slim\nRUN apt-get update \\\n && apt-get install --no-install-recommends libcurl4-openssl-dev=7.74.0-1.3+deb11u7 net-tools=1.60+git20181103.0eebece-1 curl=7.74.0-1.3+deb11u7 wget=1.21-1+deb11u1 mlocate=0.26-5 gcc=4:10.2.1-1 make=4.3-4.1 autoconf=2.69-14 build-essential=12.9 software-properties-common=0.96.20.2-2.1 git=1:2.30.2-1+deb11u2 vim=2:8.2.2434-3+deb11u1 pandoc=2.9.2.1-1+b1 python3=3.9.2-3 python3-dev=3.9.2-3 python3-pip=20.3.4-4+deb11u1 python3-tk=3.9.2-1 python-setuptools=44.1.1-1 python-virtualenv python-pip openssl=1.1.1n-0+deb11u4 libssl-dev=1.1.1n-0+deb11u4 cmake=3.18.4-2+deb11u1 autoconf=2.69-14 libffi6 libffi-dev=3.3-6 telnet=0.17-42 netcat=1.10-46 unzip=6.0-26+deb11u1 -y\nRUN echo \"creating directories\" \\\n && mkdir -p -m 777 /opt/antinex \\\n && mkdir -p -m 777 /data \\\n && mkdir -p -m 777 /var/log/antinex/core \\\n && mkdir -p -m 777 /var/log/antinex/api \\\n && mkdir -p -m 777 /var/log/antinex/jupyter \\\n && mkdir -p -m 777 /var/log/antinex/pipeline \\\n && mkdir -p -m 777 /var/log/antinex/client \\\n && mkdir -p -m 777 /opt/shared \\\n && mkdir -p -m 777 /opt/data \\\n && chmod 777 /opt\nRUN echo \"creating log files\" \\\n && touch /var/log/antinex/api/api.log \\\n && chmod 777 /var/log/antinex/api/api.log \\\n && touch /var/log/antinex/api/worker.log \\\n && chmod 777 /var/log/antinex/api/worker.log \\\n && touch /var/log/antinex/core/ai-core.log \\\n && chmod 777 /var/log/antinex/core/ai-core.log \\\n && touch /var/log/antinex/client/client.log \\\n && chmod 777 /var/log/antinex/client/client.log \\\n && touch /var/log/antinex/jupyter/jupyter.log \\\n && chmod 777 /var/log/antinex/jupyter/jupyter.log \\\n && touch /var/log/antinex/pipeline/pipeline.log \\\n && chmod 777 /var/log/antinex/pipeline/pipeline.log \\\n && touch /var/log/antinex/client/client.log \\\n && chmod 777 /var/log/antinex/client/client.log\nRUN echo \"preparing virtualenv\" \\\n && pip install virtualenvwrapper==4.8.4 pip==23.1 --upgrade\nRUN echo \"creating virtualenv\" \\\n && virtualenv -p python3 /opt/venv \\\n && chmod 777 /opt/venv\nRUN echo \"setting up virtualenv\" \\\n && . /opt/venv/bin/activate \\\n && pip install setuptools==67.6.1 pip==23.1 --upgrade\nRUN echo \"\" >> /etc/bashrc \\\n && echo \"if [[ -e /opt/venv/bin/activate ]]; then\" >> /etc/bashrc \\\n && echo \" source /opt/venv/bin/activate\" >> /etc/bashrc \\\n && echo \"fi\" >> /etc/bashrc \\\n && echo \"\" >> /etc/bashrc \\\n && echo \"alias api='cd /opt/antinex/api'\" >> /etc/bashrc \\\n && echo \"alias core='cd /opt/antinex/core'\" >> /etc/bashrc \\\n && echo \"alias client='cd /opt/antinex/client'\" >> /etc/bashrc \\\n && echo \"alias pipe='cd /opt/antinex/pipeline'\" >> /etc/bashrc \\\n && echo \"alias ut='cd /opt/antinex/utils'\" >> /etc/bashrc \\\n && echo \"alias ad='cd /opt/antinex/antinex-datasets'\" >> /etc/bashrc \\\n && echo \"alias ds='cd /opt/antinex/datasets'\" >> /etc/bashrc \\\n && echo \"alias sp='cd /opt/spylunking'\" >> /etc/bashrc \\\n && echo \"alias vi='/usr/bin/vim'\" >> /etc/bashrc\nRUN echo \"setting up /etc/pip.conf\" \\\n && echo \"\" >> /etc/pip.conf \\\n && echo \"[list]\" >> /etc/pip.conf \\\n && echo \"format=columns\" >> /etc/pip.conf\nRUN echo \"cloning repos\" \\\n && ls -l /opt \\\n && ls -l / \\\n && git clone https://github.com/jay-johnson/train-ai-with-django-swagger-jwt /opt/antinex/api \\\n && git clone https://github.com/jay-johnson/antinex-core.git /opt/antinex/core \\\n && git clone https://github.com/jay-johnson/antinex-client.git /opt/antinex/client \\\n && git clone https://github.com/jay-johnson/network-pipeline.git /opt/antinex/pipeline \\\n && git clone https://github.com/jay-johnson/antinex-utils.git /opt/antinex/utils \\\n && git clone https://github.com/jay-johnson/antinex-datasets.git /opt/antinex/antinex-datasets \\\n && git clone https://github.com/jay-johnson/network-pipeline-datasets.git /opt/antinex/datasets \\\n && git clone https://github.com/jay-johnson/deploy-to-kubernetes.git /opt/deploy-to-kubernetes \\\n && git clone https://github.com/jay-johnson/spylunking.git /opt/spylunking \\\n && chmod 775 /opt/antinex/api /opt/antinex/core /opt/antinex/client /opt/antinex/pipeline /opt/antinex/utils /opt/antinex/antinex-datasets /opt/antinex/datasets /opt/deploy-to-kubernetes /opt/spylunking\nRUN echo \"checking repos in container\" \\\n && ls -l /opt/antinex/api \\\n && ls -l /opt/antinex/core \\\n && ls -l /opt/antinex/client \\\n && ls -l /opt/antinex/pipeline \\\n && ls -l /opt/antinex/utils \\\n && ls -l /opt/antinex/antinex-datasets \\\n && ls -l /opt/antinex/datasets \\\n && ls -l /opt/deploy-to-kubernetes \\\n && ls -l /opt/spylunking\nRUN echo \"installing python logger with splunk support\" \\\n && . /opt/venv/bin/activate \\\n && cd /opt/spylunking \\\n && pip install --upgrade -e . \\\n && cd docs \\\n && make html\nRUN echo \"installing utils\" \\\n && . /opt/venv/bin/activate \\\n && cd /opt/antinex/utils \\\n && pip install --upgrade -e . \\\n && cd docs \\\n && make html\nRUN echo \"installing pipeline\" \\\n && . /opt/venv/bin/activate \\\n && cd /opt/antinex/pipeline \\\n && pip install --upgrade -e . \\\n && cd docs \\\n && make html\nRUN echo \"installing core\" \\\n && . /opt/venv/bin/activate \\\n && cd /opt/antinex/core \\\n && pip install --upgrade -e . \\\n && cd docs \\\n && make html\nRUN echo \"installing api\" \\\n && . /opt/venv/bin/activate \\\n && cd /opt/antinex/api \\\n && pip install --upgrade -r /opt/antinex/api/requirements.txt\nRUN echo \"building docs\" \\\n && . /opt/venv/bin/activate \\\n && . /opt/antinex/api/envs/drf-dev.env \\\n && cd /opt/antinex/api/webapp \\\n && ls -l \\\n && ./build-docs.sh \\\n && echo \"collecting statics\" \\\n && ./collect-statics.sh\nRUN echo \"installing client\" \\\n && . /opt/venv/bin/activate \\\n && cd /opt/antinex/client \\\n && pip install --upgrade -e . \\\n && cd docs \\\n && make html\nRUN echo \"installing jupyter pips\" \\\n && . /opt/venv/bin/activate \\\n && pip list --format=columns \\\n && pip install requests==2.28.2 seaborn==0.12.2 RISE==5.7.1 vega3==0.13.0 jupyter==1.0.0 --upgrade\nRUN cp -r ~/.jupyter ~/.bak_jupyter || true\nRUN rm -rf ~/.jupyter || true\nRUN cp -r ~/notebooks ~/.bak_notebooks || true\nRUN rm -rf ~/notebooks || true\nRUN echo \"Installing JupyterLab\" \\\n && git clone https://github.com/jupyterlab/jupyterlab.git /opt/jupyterlab \\\n && cd /opt/jupyterlab \\\n && . /opt/venv/bin/activate \\\n && pip install -e .\nRUN echo \"Installing Vega\" \\\n && . /opt/venv/bin/activate \\\n && /opt/venv/bin/jupyter-nbextension install vega3 --py\nRUN echo \"Enabling Vega\" \\\n && . /opt/venv/bin/activate \\\n && /opt/venv/bin/jupyter-nbextension enable vega3 --py\nRUN echo \"Installing Rise\" \\\n && . /opt/venv/bin/activate \\\n && /opt/venv/bin/jupyter-nbextension install rise --py\nRUN echo \"Enabling Rise\" \\\n && . /opt/venv/bin/activate \\\n && /opt/venv/bin/jupyter-nbextension enable rise --py\nRUN ls /opt/antinex/core/ \\\n && cp /opt/antinex/core/docker/update-all.sh /opt/antinex/update-all.sh \\\n && chmod 777 /opt/antinex/core/docker/update-all.sh \\\n && chmod 777 /opt/antinex/update-all.sh \\\n && chmod 777 /opt/antinex/core/docker/jupyter/start-container.sh \\\n && chmod 777 /opt/antinex/core/run-antinex-core.sh\nRUN echo \"Downgrading numpy and setuptools for tensorflow\" \\\n && . /opt/venv/bin/activate \\\n && pip install numpy==1.14.5 --upgrade \\\n && pip install setuptools==39.1.0 --upgrade\nENV PIPELINE_PROCESSOR_SCRIPT=\"/opt/antinex/pipeline/network_pipeline/scripts/packets_redis.py\"\nENV JUPYTER_START_SCRIPT=\"/opt/antinex/core/docker/jupyter/start-container.sh\"\nENV NO_DB_WORKER_START_SCRIPT=\"/opt/antinex/core/run-antinex-core.sh\"\nENV DJANGO_WORKER_START_SCRIPT=\"/opt/antinex/api/run-worker.sh\"\nENV APP_START_SCRIPT=\"/opt/antinex/api/run-django.sh\"\nENV MIGRATION_SCRIPT=\"/opt/antinex/api/run-migrations.sh\"\nENV SHARED_LOG_CFG=\"/opt/antinex/core/antinex_core/log/debug-openshift-logging.json\"\nENV API_LOG_CFG=\"/opt/antinex/core/antinex_core/log/api-logging.json\"\nENV CLIENT_LOG_CFG=\"/opt/antinex/core/antinex_core/log/client-logging.json\"\nENV CORE_LOG_CFG=\"/opt/antinex/core/antinex_core/log/core-logging.json\"\nENV JUPYTER_LOG_CFG=\"/opt/antinex/core/antinex_core/log/jupyter-logging.json\"\nENV PIPELINE_LOG_CFG=\"/opt/antinex/core/antinex_core/log/pipeline-logging.json\"\nENV DEBUG_SHARED_LOG_CFG=\"0\"\nENV LOG_LEVEL=\"DEBUG\"\nENV LOG_FILE=\"/var/log/antinex/core/ai-core.log\"\nENV ENVIRONMENT=\"Development\"\nENV DJANGO_CONFIGURATION=\"Development\"\n# A secret has been removed here. Please do not provide secrets from the Dockerfile as these will leak into the metadata of the resulting docker image. To provide secrets the --secret flag of the docker build command can be used (https://docs.docker.com/develop/develop-images/build_enhancements/#new-docker-build-secret-information).\nENV DJANGO_DEBUG=\"yes\"\nENV DJANGO_TEMPLATE_DEBUG=\"yes\"\nENV CELERY_ENABLED=\"0\"\nENV CACHEOPS_ENABLED=\"0\"\nENV ANTINEX_WORKER_ENABLED=\"1\"\nENV ANTINEX_WORKER_ONLY=\"0\"\nENV ANTINEX_DELIVERY_MODE=\"persistent\"\nENV ANTINEX_AUTH_URL=\"redis://0.0.0.0:6379/6\"\nENV ANTINEX_EXCHANGE_NAME=\"webapp.predict.requests\"\nENV ANTINEX_EXCHANGE_TYPE=\"topic\"\nENV ANTINEX_QUEUE_NAME=\"webapp.predict.requests\"\nENV ANTINEX_WORKER_SSL_ENABLED=\"0\"\nENV SKIP_BUILD_DOCS=\"1\"\nENV SKIP_COLLECT_STATICS=\"1\"\nENV JUPYTER_CONFIG=\"/opt/antinex/core/docker/jupyter/jupyter_notebook_config.py\"\nENV NOTEBOOK_DIR=\"/opt/antinex/core/docker/notebooks\"\nENV USE_ENV=\"drf-dev\"\nENV USE_VENV=\"/opt/venv\"\nWORKDIR /opt/antinex/core\n#   set for anonymous user access in the container\nRUN find /opt/antinex/api -type d -exec chmod 777 {}\nRUN find /opt/antinex/core -type d -exec chmod 777 {}\nRUN find /opt/antinex/client -type d -exec chmod 777 {}\nRUN find /opt/antinex/pipeline -type d -exec chmod 777 {}\nRUN find /opt/antinex/utils -type d -exec chmod 777 {}\nRUN find /opt/antinex/antinex-datasets -type d -exec chmod 777 {}\nRUN find /opt/antinex/datasets -type d -exec chmod 777 {}\nRUN find /opt/deploy-to-kubernetes -type d -exec chmod 777 {}\nRUN find /opt/spylunking -type d -exec chmod 777 {}\nRUN find /opt/venv -type d -exec chmod 777 {}\nRUN find /var/log -type d -exec chmod 777 {}\nENTRYPOINT /opt/antinex/core/run-antinex-core.sh\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM python:3.6-slim\nRUN apt-get update \\\n && apt-get install libcurl4-openssl-dev net-tools curl wget mlocate gcc make autoconf build-essential software-properties-common git vim pandoc python3 python3-dev python3-pip python3-tk python-setuptools python-virtualenv python-pip openssl libssl-dev cmake autoconf libffi6 libffi-dev telnet netcat unzip -y\nRUN echo \"creating directories\" \\\n && mkdir -p -m 777 /opt/antinex \\\n && mkdir -p -m 777 /data \\\n && mkdir -p -m 777 /var/log/antinex/core \\\n && mkdir -p -m 777 /var/log/antinex/api \\\n && mkdir -p -m 777 /var/log/antinex/jupyter \\\n && mkdir -p -m 777 /var/log/antinex/pipeline \\\n && mkdir -p -m 777 /var/log/antinex/client \\\n && mkdir -p -m 777 /opt/shared \\\n && mkdir -p -m 777 /opt/data \\\n && chmod 777 /opt\nRUN echo \"creating log files\" \\\n && touch /var/log/antinex/api/api.log \\\n && chmod 777 /var/log/antinex/api/api.log \\\n && touch /var/log/antinex/api/worker.log \\\n && chmod 777 /var/log/antinex/api/worker.log \\\n && touch /var/log/antinex/core/ai-core.log \\\n && chmod 777 /var/log/antinex/core/ai-core.log \\\n && touch /var/log/antinex/client/client.log \\\n && chmod 777 /var/log/antinex/client/client.log \\\n && touch /var/log/antinex/jupyter/jupyter.log \\\n && chmod 777 /var/log/antinex/jupyter/jupyter.log \\\n && touch /var/log/antinex/pipeline/pipeline.log \\\n && chmod 777 /var/log/antinex/pipeline/pipeline.log \\\n && touch /var/log/antinex/client/client.log \\\n && chmod 777 /var/log/antinex/client/client.log\nRUN echo \"preparing virtualenv\" \\\n && pip install virtualenvwrapper pip --upgrade\nRUN echo \"creating virtualenv\" \\\n && virtualenv -p python3 /opt/venv \\\n && chmod 777 /opt/venv\nRUN echo \"setting up virtualenv\" \\\n && . /opt/venv/bin/activate \\\n && pip install setuptools pip --upgrade\nRUN echo \"\" >> /etc/bashrc \\\n && echo \"if [[ -e /opt/venv/bin/activate ]]; then\" >> /etc/bashrc \\\n && echo \" source /opt/venv/bin/activate\" >> /etc/bashrc \\\n && echo \"fi\" >> /etc/bashrc \\\n && echo \"\" >> /etc/bashrc \\\n && echo \"alias api='cd /opt/antinex/api'\" >> /etc/bashrc \\\n && echo \"alias core='cd /opt/antinex/core'\" >> /etc/bashrc \\\n && echo \"alias client='cd /opt/antinex/client'\" >> /etc/bashrc \\\n && echo \"alias pipe='cd /opt/antinex/pipeline'\" >> /etc/bashrc \\\n && echo \"alias ut='cd /opt/antinex/utils'\" >> /etc/bashrc \\\n && echo \"alias ad='cd /opt/antinex/antinex-datasets'\" >> /etc/bashrc \\\n && echo \"alias ds='cd /opt/antinex/datasets'\" >> /etc/bashrc \\\n && echo \"alias sp='cd /opt/spylunking'\" >> /etc/bashrc \\\n && echo \"alias vi='/usr/bin/vim'\" >> /etc/bashrc\nRUN echo \"setting up /etc/pip.conf\" \\\n && echo \"\" >> /etc/pip.conf \\\n && echo \"[list]\" >> /etc/pip.conf \\\n && echo \"format=columns\" >> /etc/pip.conf\nRUN echo \"cloning repos\" \\\n && ls -l /opt \\\n && ls -l / \\\n && git clone https://github.com/jay-johnson/train-ai-with-django-swagger-jwt /opt/antinex/api \\\n && git clone https://github.com/jay-johnson/antinex-core.git /opt/antinex/core \\\n && git clone https://github.com/jay-johnson/antinex-client.git /opt/antinex/client \\\n && git clone https://github.com/jay-johnson/network-pipeline.git /opt/antinex/pipeline \\\n && git clone https://github.com/jay-johnson/antinex-utils.git /opt/antinex/utils \\\n && git clone https://github.com/jay-johnson/antinex-datasets.git /opt/antinex/antinex-datasets \\\n && git clone https://github.com/jay-johnson/network-pipeline-datasets.git /opt/antinex/datasets \\\n && git clone https://github.com/jay-johnson/deploy-to-kubernetes.git /opt/deploy-to-kubernetes \\\n && git clone https://github.com/jay-johnson/spylunking.git /opt/spylunking \\\n && chmod 775 /opt/antinex/api /opt/antinex/core /opt/antinex/client /opt/antinex/pipeline /opt/antinex/utils /opt/antinex/antinex-datasets /opt/antinex/datasets /opt/deploy-to-kubernetes /opt/spylunking\nRUN echo \"checking repos in container\" \\\n && ls -l /opt/antinex/api \\\n && ls -l /opt/antinex/core \\\n && ls -l /opt/antinex/client \\\n && ls -l /opt/antinex/pipeline \\\n && ls -l /opt/antinex/utils \\\n && ls -l /opt/antinex/antinex-datasets \\\n && ls -l /opt/antinex/datasets \\\n && ls -l /opt/deploy-to-kubernetes \\\n && ls -l /opt/spylunking\nRUN echo \"installing python logger with splunk support\" \\\n && . /opt/venv/bin/activate \\\n && cd /opt/spylunking \\\n && pip install --upgrade -e . \\\n && cd docs \\\n && make html\nRUN echo \"installing utils\" \\\n && . /opt/venv/bin/activate \\\n && cd /opt/antinex/utils \\\n && pip install --upgrade -e . \\\n && cd docs \\\n && make html\nRUN echo \"installing pipeline\" \\\n && . /opt/venv/bin/activate \\\n && cd /opt/antinex/pipeline \\\n && pip install --upgrade -e . \\\n && cd docs \\\n && make html\nRUN echo \"installing core\" \\\n && . /opt/venv/bin/activate \\\n && cd /opt/antinex/core \\\n && pip install --upgrade -e . \\\n && cd docs \\\n && make html\nRUN echo \"installing api\" \\\n && . /opt/venv/bin/activate \\\n && cd /opt/antinex/api \\\n && pip install --upgrade -r /opt/antinex/api/requirements.txt\nRUN echo \"building docs\" \\\n && . /opt/venv/bin/activate \\\n && . /opt/antinex/api/envs/drf-dev.env \\\n && cd /opt/antinex/api/webapp \\\n && ls -l \\\n && ./build-docs.sh \\\n && echo \"collecting statics\" \\\n && ./collect-statics.sh\nRUN echo \"installing client\" \\\n && . /opt/venv/bin/activate \\\n && cd /opt/antinex/client \\\n && pip install --upgrade -e . \\\n && cd docs \\\n && make html\nRUN echo \"installing jupyter pips\" \\\n && . /opt/venv/bin/activate \\\n && pip list --format=columns \\\n && pip install requests seaborn RISE vega3 jupyter --upgrade\nRUN cp -r ~/.jupyter ~/.bak_jupyter || true\nRUN rm -rf ~/.jupyter || true\nRUN cp -r ~/notebooks ~/.bak_notebooks || true\nRUN rm -rf ~/notebooks || true\nRUN echo \"Installing JupyterLab\" \\\n && git clone https://github.com/jupyterlab/jupyterlab.git /opt/jupyterlab \\\n && cd /opt/jupyterlab \\\n && . /opt/venv/bin/activate \\\n && pip install -e .\nRUN echo \"Installing Vega\" \\\n && . /opt/venv/bin/activate \\\n && /opt/venv/bin/jupyter-nbextension install vega3 --py\nRUN echo \"Enabling Vega\" \\\n && . /opt/venv/bin/activate \\\n && /opt/venv/bin/jupyter-nbextension enable vega3 --py\nRUN echo \"Installing Rise\" \\\n && . /opt/venv/bin/activate \\\n && /opt/venv/bin/jupyter-nbextension install rise --py\nRUN echo \"Enabling Rise\" \\\n && . /opt/venv/bin/activate \\\n && /opt/venv/bin/jupyter-nbextension enable rise --py\nRUN ls /opt/antinex/core/ \\\n && cp /opt/antinex/core/docker/update-all.sh /opt/antinex/update-all.sh \\\n && chmod 777 /opt/antinex/core/docker/update-all.sh \\\n && chmod 777 /opt/antinex/update-all.sh \\\n && chmod 777 /opt/antinex/core/docker/jupyter/start-container.sh \\\n && chmod 777 /opt/antinex/core/run-antinex-core.sh\nRUN echo \"Downgrading numpy and setuptools for tensorflow\" \\\n && . /opt/venv/bin/activate \\\n && pip install numpy==1.14.5 --upgrade \\\n && pip install setuptools==39.1.0 --upgrade\nENV PIPELINE_PROCESSOR_SCRIPT=\"/opt/antinex/pipeline/network_pipeline/scripts/packets_redis.py\"\nENV JUPYTER_START_SCRIPT=\"/opt/antinex/core/docker/jupyter/start-container.sh\"\nENV NO_DB_WORKER_START_SCRIPT=\"/opt/antinex/core/run-antinex-core.sh\"\nENV DJANGO_WORKER_START_SCRIPT=\"/opt/antinex/api/run-worker.sh\"\nENV APP_START_SCRIPT=\"/opt/antinex/api/run-django.sh\"\nENV MIGRATION_SCRIPT=\"/opt/antinex/api/run-migrations.sh\"\nENV SHARED_LOG_CFG=\"/opt/antinex/core/antinex_core/log/debug-openshift-logging.json\"\nENV API_LOG_CFG=\"/opt/antinex/core/antinex_core/log/api-logging.json\"\nENV CLIENT_LOG_CFG=\"/opt/antinex/core/antinex_core/log/client-logging.json\"\nENV CORE_LOG_CFG=\"/opt/antinex/core/antinex_core/log/core-logging.json\"\nENV JUPYTER_LOG_CFG=\"/opt/antinex/core/antinex_core/log/jupyter-logging.json\"\nENV PIPELINE_LOG_CFG=\"/opt/antinex/core/antinex_core/log/pipeline-logging.json\"\nENV DEBUG_SHARED_LOG_CFG=\"0\"\nENV LOG_LEVEL=\"DEBUG\"\nENV LOG_FILE=\"/var/log/antinex/core/ai-core.log\"\nENV ENVIRONMENT=\"Development\"\nENV DJANGO_CONFIGURATION=\"Development\"\nENV DJANGO_SECRET_KEY=\"supersecret\"\nENV DJANGO_DEBUG=\"yes\"\nENV DJANGO_TEMPLATE_DEBUG=\"yes\"\nENV CELERY_ENABLED=\"0\"\nENV CACHEOPS_ENABLED=\"0\"\nENV ANTINEX_WORKER_ENABLED=\"1\"\nENV ANTINEX_WORKER_ONLY=\"0\"\nENV ANTINEX_DELIVERY_MODE=\"persistent\"\nENV ANTINEX_AUTH_URL=\"redis://0.0.0.0:6379/6\"\nENV ANTINEX_EXCHANGE_NAME=\"webapp.predict.requests\"\nENV ANTINEX_EXCHANGE_TYPE=\"topic\"\nENV ANTINEX_QUEUE_NAME=\"webapp.predict.requests\"\nENV ANTINEX_WORKER_SSL_ENABLED=\"0\"\nENV SKIP_BUILD_DOCS=\"1\"\nENV SKIP_COLLECT_STATICS=\"1\"\nENV JUPYTER_CONFIG=\"/opt/antinex/core/docker/jupyter/jupyter_notebook_config.py\"\nENV NOTEBOOK_DIR=\"/opt/antinex/core/docker/notebooks\"\nENV USE_ENV=\"drf-dev\"\nENV USE_VENV=\"/opt/venv\"\nWORKDIR /opt/antinex/core\n#  set for anonymous user access in the container\nRUN find /opt/antinex/api -type d -exec chmod 777 {} ;\nRUN find /opt/antinex/core -type d -exec chmod 777 {} ;\nRUN find /opt/antinex/client -type d -exec chmod 777 {} ;\nRUN find /opt/antinex/pipeline -type d -exec chmod 777 {} ;\nRUN find /opt/antinex/utils -type d -exec chmod 777 {} ;\nRUN find /opt/antinex/antinex-datasets -type d -exec chmod 777 {} ;\nRUN find /opt/antinex/datasets -type d -exec chmod 777 {} ;\nRUN find /opt/deploy-to-kubernetes -type d -exec chmod 777 {} ;\nRUN find /opt/spylunking -type d -exec chmod 777 {} ;\nRUN find /opt/venv -type d -exec chmod 777 {} ;\nRUN find /var/log -type d -exec chmod 777 {} ;\nENTRYPOINT /opt/antinex/core/run-antinex-core.sh\n","injectedSmells":[],"originalDockerfileHash":"72bea93d0581e17c8be6a521c1e0cb15","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM python:3.6-slim\nRUN apt-get update \\\n && apt-get install libcurl4-openssl-dev net-tools curl wget mlocate gcc make autoconf build-essential software-properties-common git vim pandoc python3 python3-dev python3-pip python3-tk python-setuptools python-virtualenv python-pip openssl libssl-dev cmake autoconf libffi6 libffi-dev telnet netcat unzip -y\nRUN echo \"creating directories\" \\\n && mkdir -p -m 777 /opt/antinex \\\n && mkdir -p -m 777 /data \\\n && mkdir -p -m 777 /var/log/antinex/core \\\n && mkdir -p -m 777 /var/log/antinex/api \\\n && mkdir -p -m 777 /var/log/antinex/jupyter \\\n && mkdir -p -m 777 /var/log/antinex/pipeline \\\n && mkdir -p -m 777 /var/log/antinex/client \\\n && mkdir -p -m 777 /opt/shared \\\n && mkdir -p -m 777 /opt/data \\\n && chmod 777 /opt\nRUN echo \"creating log files\" \\\n && touch /var/log/antinex/api/api.log \\\n && chmod 777 /var/log/antinex/api/api.log \\\n && touch /var/log/antinex/api/worker.log \\\n && chmod 777 /var/log/antinex/api/worker.log \\\n && touch /var/log/antinex/core/ai-core.log \\\n && chmod 777 /var/log/antinex/core/ai-core.log \\\n && touch /var/log/antinex/client/client.log \\\n && chmod 777 /var/log/antinex/client/client.log \\\n && touch /var/log/antinex/jupyter/jupyter.log \\\n && chmod 777 /var/log/antinex/jupyter/jupyter.log \\\n && touch /var/log/antinex/pipeline/pipeline.log \\\n && chmod 777 /var/log/antinex/pipeline/pipeline.log \\\n && touch /var/log/antinex/client/client.log \\\n && chmod 777 /var/log/antinex/client/client.log\nRUN echo \"preparing virtualenv\" \\\n && pip install virtualenvwrapper pip --upgrade\nRUN echo \"creating virtualenv\" \\\n && virtualenv -p python3 /opt/venv \\\n && chmod 777 /opt/venv\nRUN echo \"setting up virtualenv\" \\\n && . /opt/venv/bin/activate \\\n && pip install setuptools pip --upgrade\nRUN echo \"\" >> /etc/bashrc \\\n && echo \"if [[ -e /opt/venv/bin/activate ]]; then\" >> /etc/bashrc \\\n && echo \" source /opt/venv/bin/activate\" >> /etc/bashrc \\\n && echo \"fi\" >> /etc/bashrc \\\n && echo \"\" >> /etc/bashrc \\\n && echo \"alias api='cd /opt/antinex/api'\" >> /etc/bashrc \\\n && echo \"alias core='cd /opt/antinex/core'\" >> /etc/bashrc \\\n && echo \"alias client='cd /opt/antinex/client'\" >> /etc/bashrc \\\n && echo \"alias pipe='cd /opt/antinex/pipeline'\" >> /etc/bashrc \\\n && echo \"alias ut='cd /opt/antinex/utils'\" >> /etc/bashrc \\\n && echo \"alias ad='cd /opt/antinex/antinex-datasets'\" >> /etc/bashrc \\\n && echo \"alias ds='cd /opt/antinex/datasets'\" >> /etc/bashrc \\\n && echo \"alias sp='cd /opt/spylunking'\" >> /etc/bashrc \\\n && echo \"alias vi='/usr/bin/vim'\" >> /etc/bashrc\nRUN echo \"setting up /etc/pip.conf\" \\\n && echo \"\" >> /etc/pip.conf \\\n && echo \"[list]\" >> /etc/pip.conf \\\n && echo \"format=columns\" >> /etc/pip.conf\nRUN echo \"cloning repos\" \\\n && ls -l /opt \\\n && ls -l / \\\n && git clone https://github.com/jay-johnson/train-ai-with-django-swagger-jwt /opt/antinex/api \\\n && git clone https://github.com/jay-johnson/antinex-core.git /opt/antinex/core \\\n && git clone https://github.com/jay-johnson/antinex-client.git /opt/antinex/client \\\n && git clone https://github.com/jay-johnson/network-pipeline.git /opt/antinex/pipeline \\\n && git clone https://github.com/jay-johnson/antinex-utils.git /opt/antinex/utils \\\n && git clone https://github.com/jay-johnson/antinex-datasets.git /opt/antinex/antinex-datasets \\\n && git clone https://github.com/jay-johnson/network-pipeline-datasets.git /opt/antinex/datasets \\\n && git clone https://github.com/jay-johnson/deploy-to-kubernetes.git /opt/deploy-to-kubernetes \\\n && git clone https://github.com/jay-johnson/spylunking.git /opt/spylunking \\\n && chmod 775 /opt/antinex/api /opt/antinex/core /opt/antinex/client /opt/antinex/pipeline /opt/antinex/utils /opt/antinex/antinex-datasets /opt/antinex/datasets /opt/deploy-to-kubernetes /opt/spylunking\nRUN echo \"checking repos in container\" \\\n && ls -l /opt/antinex/api \\\n && ls -l /opt/antinex/core \\\n && ls -l /opt/antinex/client \\\n && ls -l /opt/antinex/pipeline \\\n && ls -l /opt/antinex/utils \\\n && ls -l /opt/antinex/antinex-datasets \\\n && ls -l /opt/antinex/datasets \\\n && ls -l /opt/deploy-to-kubernetes \\\n && ls -l /opt/spylunking\nRUN echo \"installing python logger with splunk support\" \\\n && . /opt/venv/bin/activate \\\n && cd /opt/spylunking \\\n && pip install --upgrade -e . \\\n && cd docs \\\n && make html\nRUN echo \"installing utils\" \\\n && . /opt/venv/bin/activate \\\n && cd /opt/antinex/utils \\\n && pip install --upgrade -e . \\\n && cd docs \\\n && make html\nRUN echo \"installing pipeline\" \\\n && . /opt/venv/bin/activate \\\n && cd /opt/antinex/pipeline \\\n && pip install --upgrade -e . \\\n && cd docs \\\n && make html\nRUN echo \"installing core\" \\\n && . /opt/venv/bin/activate \\\n && cd /opt/antinex/core \\\n && pip install --upgrade -e . \\\n && cd docs \\\n && make html\nRUN echo \"installing api\" \\\n && . /opt/venv/bin/activate \\\n && cd /opt/antinex/api \\\n && pip install --upgrade -r /opt/antinex/api/requirements.txt\nRUN echo \"building docs\" \\\n && . /opt/venv/bin/activate \\\n && . /opt/antinex/api/envs/drf-dev.env \\\n && cd /opt/antinex/api/webapp \\\n && ls -l \\\n && ./build-docs.sh \\\n && echo \"collecting statics\" \\\n && ./collect-statics.sh\nRUN echo \"installing client\" \\\n && . /opt/venv/bin/activate \\\n && cd /opt/antinex/client \\\n && pip install --upgrade -e . \\\n && cd docs \\\n && make html\nRUN echo \"installing jupyter pips\" \\\n && . /opt/venv/bin/activate \\\n && pip list --format=columns \\\n && pip install requests seaborn RISE vega3 jupyter --upgrade\nRUN cp -r ~/.jupyter ~/.bak_jupyter || true\nRUN rm -rf ~/.jupyter || true\nRUN cp -r ~/notebooks ~/.bak_notebooks || true\nRUN rm -rf ~/notebooks || true\nRUN echo \"Installing JupyterLab\" \\\n && git clone https://github.com/jupyterlab/jupyterlab.git /opt/jupyterlab \\\n && cd /opt/jupyterlab \\\n && . /opt/venv/bin/activate \\\n && pip install -e .\nRUN echo \"Installing Vega\" \\\n && . /opt/venv/bin/activate \\\n && /opt/venv/bin/jupyter-nbextension install vega3 --py\nRUN echo \"Enabling Vega\" \\\n && . /opt/venv/bin/activate \\\n && /opt/venv/bin/jupyter-nbextension enable vega3 --py\nRUN echo \"Installing Rise\" \\\n && . /opt/venv/bin/activate \\\n && /opt/venv/bin/jupyter-nbextension install rise --py\nRUN echo \"Enabling Rise\" \\\n && . /opt/venv/bin/activate \\\n && /opt/venv/bin/jupyter-nbextension enable rise --py\nRUN ls /opt/antinex/core/ \\\n && cp /opt/antinex/core/docker/update-all.sh /opt/antinex/update-all.sh \\\n && chmod 777 /opt/antinex/core/docker/update-all.sh \\\n && chmod 777 /opt/antinex/update-all.sh \\\n && chmod 777 /opt/antinex/core/docker/jupyter/start-container.sh \\\n && chmod 777 /opt/antinex/core/run-antinex-core.sh\nRUN echo \"Downgrading numpy and setuptools for tensorflow\" \\\n && . /opt/venv/bin/activate \\\n && pip install numpy==1.14.5 --upgrade \\\n && pip install setuptools==39.1.0 --upgrade\nENV PIPELINE_PROCESSOR_SCRIPT=\"/opt/antinex/pipeline/network_pipeline/scripts/packets_redis.py\"\nENV JUPYTER_START_SCRIPT=\"/opt/antinex/core/docker/jupyter/start-container.sh\"\nENV NO_DB_WORKER_START_SCRIPT=\"/opt/antinex/core/run-antinex-core.sh\"\nENV DJANGO_WORKER_START_SCRIPT=\"/opt/antinex/api/run-worker.sh\"\nENV APP_START_SCRIPT=\"/opt/antinex/api/run-django.sh\"\nENV MIGRATION_SCRIPT=\"/opt/antinex/api/run-migrations.sh\"\nENV SHARED_LOG_CFG=\"/opt/antinex/core/antinex_core/log/debug-openshift-logging.json\"\nENV API_LOG_CFG=\"/opt/antinex/core/antinex_core/log/api-logging.json\"\nENV CLIENT_LOG_CFG=\"/opt/antinex/core/antinex_core/log/client-logging.json\"\nENV CORE_LOG_CFG=\"/opt/antinex/core/antinex_core/log/core-logging.json\"\nENV JUPYTER_LOG_CFG=\"/opt/antinex/core/antinex_core/log/jupyter-logging.json\"\nENV PIPELINE_LOG_CFG=\"/opt/antinex/core/antinex_core/log/pipeline-logging.json\"\nENV DEBUG_SHARED_LOG_CFG=\"0\"\nENV LOG_LEVEL=\"DEBUG\"\nENV LOG_FILE=\"/var/log/antinex/core/ai-core.log\"\nENV ENVIRONMENT=\"Development\"\nENV DJANGO_CONFIGURATION=\"Development\"\nENV DJANGO_SECRET_KEY=\"supersecret\"\nENV DJANGO_DEBUG=\"yes\"\nENV DJANGO_TEMPLATE_DEBUG=\"yes\"\nENV CELERY_ENABLED=\"0\"\nENV CACHEOPS_ENABLED=\"0\"\nENV ANTINEX_WORKER_ENABLED=\"1\"\nENV ANTINEX_WORKER_ONLY=\"0\"\nENV ANTINEX_DELIVERY_MODE=\"persistent\"\nENV ANTINEX_AUTH_URL=\"redis://0.0.0.0:6379/6\"\nENV ANTINEX_EXCHANGE_NAME=\"webapp.predict.requests\"\nENV ANTINEX_EXCHANGE_TYPE=\"topic\"\nENV ANTINEX_QUEUE_NAME=\"webapp.predict.requests\"\nENV ANTINEX_WORKER_SSL_ENABLED=\"0\"\nENV SKIP_BUILD_DOCS=\"1\"\nENV SKIP_COLLECT_STATICS=\"1\"\nENV JUPYTER_CONFIG=\"/opt/antinex/core/docker/jupyter/jupyter_notebook_config.py\"\nENV NOTEBOOK_DIR=\"/opt/antinex/core/docker/notebooks\"\nENV USE_ENV=\"drf-dev\"\nENV USE_VENV=\"/opt/venv\"\nWORKDIR /opt/antinex/core\n#   set for anonymous user access in the container\nRUN find /opt/antinex/api -type d -exec chmod 777 {}\nRUN find /opt/antinex/core -type d -exec chmod 777 {}\nRUN find /opt/antinex/client -type d -exec chmod 777 {}\nRUN find /opt/antinex/pipeline -type d -exec chmod 777 {}\nRUN find /opt/antinex/utils -type d -exec chmod 777 {}\nRUN find /opt/antinex/antinex-datasets -type d -exec chmod 777 {}\nRUN find /opt/antinex/datasets -type d -exec chmod 777 {}\nRUN find /opt/deploy-to-kubernetes -type d -exec chmod 777 {}\nRUN find /opt/spylunking -type d -exec chmod 777 {}\nRUN find /opt/venv -type d -exec chmod 777 {}\nRUN find /var/log -type d -exec chmod 777 {}\nENTRYPOINT /opt/antinex/core/run-antinex-core.sh\n","originalDockerfileUglifiedHash":"c52eb861b8d45142a81d69a4383447f2","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/b6b3c29115cb3c2b2c54bb071f2ad0ab98b5905e.dockerfile"}