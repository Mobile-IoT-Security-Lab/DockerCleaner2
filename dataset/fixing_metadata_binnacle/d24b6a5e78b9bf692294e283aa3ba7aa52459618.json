{"seed":34294528,"processedDockerfileHash":"4b891ff5c76d1842f0d88bc306b89874","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-gem","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM debian:jessie\nMAINTAINER Dave van Stein <dvanstein@xebia.com>\n#   CONFIGURATION SETTINGS\nENV DEBIAN_FRONTEND=\"noninteractive\"\nENV PHP_UPLOAD_MAX_FILESIZE=\"10M\"\nENV PHP_POST_MAX_SIZE=\"10M\"\nENV WEBGOAT_VERSION=\"7.1\"\nENV WEBGOAT_FILE=\"webgoat-container-$WEBGOAT_VERSION-exec.jar \"\nENV WEBGOAT_URL=\"https://github.com/WebGoat/WebGoat/releases/download/$WEBGOAT_VERSION/$WEBGOAT_FILE \"\nENV WEBGOAT_FILE_SHA256=\"cc531e1e5d5b21394963f2a9bde00e83785ba1a94340bd13bde83dc24e23b77b\"\nENV WWW=\"/var/www/html\"\nENV NPM_CONFIG_LOGLEVEL=\"info\"\nENV NODE_VERSION=\"6.10.0\"\nENV NODE_FILE_SHA256=\"0f28bef128ef8ce2d9b39b9e46d2ebaeaa8a301f57726f2eba46da194471f224\"\nENV RUBY_MAJOR=\"2.3\"\nENV RUBY_VERSION=\"2.3.3\"\nENV RUBY_FILE_SHA256=\"1a4fa8c2885734ba37b97ffdb4a19b8fba0e8982606db02d936e65bac07419dc \"\nENV RUBYGEMS_VERSION=\"2.6.10\"\nENV GEM_HOME=\"/usr/local/bundle\"\nENV BUNDLE_PATH=\"$GEM_HOME\" \\\n    BUNDLE_BIN=\"$GEM_HOME/bin\" \\\n    BUNDLE_SILENCE_ROOT_WARNING=\"1\" \\\n    BUNDLE_APP_CONFIG=\"$GEM_HOME\"\nENV PATH=\"$BUNDLE_BIN:$PATH\"\nENV BUNDLER_VERSION=\"1.14.4\"\nENV RAILS_VERSION=\"4\"\nENV PIP_FILE_SHA256=\"19dae841a150c86e2a09d475b5eb0602861f2a5b7761ec268049a662dbd2bd0c \"\nENV RIPS_FILE_SHA256=\"8198e50cbdc9894583c5732ecc18c08a17f8aba60493d62e087f17eedcf13844\"\nENV WEBMAVEN_FILE_SHA256=\"3129075db3420158b79d786091a2813534b5e1080b89a21c15567746ae8d1f46 \"\n#   create intialize script for configuration items during boot\nRUN touch /initialize.sh \\\n && for key in 9554F04D7259F04124DE6B476D5A82AC7E37093B 94AE36675C464D64BAFA68DD7434390BDBE9B9C5 0034A06D9D9B0064CE8ADF6BF1747F4AD2306D93 FD3A5288F042B6850C66B31F09FE44734EB7990E 71DCFD284A79C3B38668286BC97EC7A07EDE3FC1 DD8F2338BAE7501E3DD5AC78C273792F7D83545D C4F0DFFF4E8C1A8236409D08E73BC641CC11F4C8 56730D5401028683275BD23C23EFEFE93C4CFFFE; do gpg --keyserver ha.pool.sks-keyservers.net --recv-keys \"$key\" ; done \\\n && buildDeps=' autoconf bison bzip2 g++ gcc git libbz2-dev libffi-dev libgdbm-dev libglib2.0-dev libmysqlclient-dev libncurses-dev libreadline-dev libsqlite3-dev libssl-dev libxml2-dev libxslt-dev zlib1g-dev make ruby unzip wget xz-utils ' \\\n && apt-get update \\\n && apt-get install --no-install-recommends apache2 ca-certificates default-jre-headless libapache2-mod-php5 libapache2-mod-perl2 libcgi-pm-perl libgdbm3 libyaml-0-2 mysql-server nodejs php5-mysql php5-gd procps python3 pwgen sqlite3 supervisor $buildDeps -y \\\n && echo \"ServerName localhost\" >> /etc/apache2/apache2.conf \\\n && sed -i 's/allow_url_include = Off/allow_url_include = On/g' /etc/php5/apache2/php.ini \\\n && echo 'session.save_path = \"/tmp\"' >> /etc/php5/apache2/php.ini \\\n && echo \"mysql -uadmin -p$PASS -e \\\"CREATE DATABASE dvws_db\\\"\" >> /initialize.sh \\\n && git clone https://github.com/ethicalhack3r/DVWA.git $WWW/dvwa \\\n && chmod -R 777 $WWW/dvwa/hackable/uploads $WWW/dvwa/external/phpids/0.6/lib/IDS/tmp/phpids_log.txt \\\n && sed -i \"s/public_key' ] = ''/public_key' ] = 'TaQ185RFuWM'/g\" $WWW/dvwa/config/config.inc.php \\\n && sed -i \"s/private_key' ] = ''/private_key' ] = 'TaQ185RFuWM'/g\" $WWW/dvwa/config/config.inc.php \\\n && sed -i 's/root/admin/g' $WWW/dvwa/config/config.inc.php \\\n && sed -i \"s/'default_security_level' ] = 'impossible'/'default_security_level' ] = 'low'/g\" $WWW/dvwa/config/config.inc.php \\\n && echo \"sed -i \\\"s/p@ssw0rd/$PASS/g\\\" $WWW/dvwa/config/config.inc.php\" >> /initialize.sh \\\n && git clone https://github.com/snoopysecurity/dvws.git $WWW/dvws \\\n && git clone https://github.com/interference-security/DVWS.git $WWW/dvwsock \\\n && sed -i 's/root/admin/g' $WWW/dvwsock/includes/connect-db.php \\\n && echo \"sed -i \\\"s/toor/$PASS/g\\\" $WWW/dvwsock/includes/connect-db.php\" >> /initialize.sh \\\n && git clone git://git.code.sf.net/p/mutillidae/git $WWW/mutillidae \\\n && sed -i 's/MySQLDatabaseUsername = \"root\"/MySQLDatabaseUsername = \"admin\"/g' $WWW/mutillidae/classes/MySQLHandler.php \\\n && echo \"sed -i \\\"s/MySQLDatabasePassword = \\\"\\\"/MySQLDatabasePassword = \\\"$PASS\\\"/g\\\" $WWW/mutillidae/classes/MySQLHandler.php\" >> /initialize.sh \\\n && chmod +x $WWW/mutillidae/*.php \\\n && mkdir $WWW/webgoat \\\n && wget $WEBGOAT_URL -P $WWW/webgoat/ -q --show-progress \\\n && echo \"$WEBGOAT_FILE_SHA256 $WWW/webgoat/$WEBGOAT_FILE\" | sha256sum -c - \\\n && git clone https://github.com/bkimminich/juice-shop.git $WWW/juiceshop \\\n && wget \"https://nodejs.org/dist/v$NODE_VERSION/node-v$NODE_VERSION-linux-x64.tar.xz\" -P /tmp/ \\\n && echo \"$NODE_FILE_SHA256 /tmp/node-v$NODE_VERSION-linux-x64.tar.xz\" | sha256sum -c - \\\n && tar -xJf /tmp/\"node-v$NODE_VERSION-linux-x64.tar.xz\" -C /usr/local --strip-components=1 \\\n && ln -s /usr/local/bin/node /usr/local/bin/nodejs \\\n && cd $WWW/juiceshop \\\n && npm install --production --unsafe-perm \\\n && mkdir -p /usr/local/etc \\\n && { echo 'install: --no-document' ;echo 'update: --no-document' ; } >> /usr/local/etc/gemrc \\\n && wget \"https://cache.ruby-lang.org/pub/ruby/${RUBY_MAJOR%-rc}/ruby-$RUBY_VERSION.tar.xz\" -P /tmp/ \\\n && echo \"$RUBY_FILE_SHA256 /tmp/ruby-$RUBY_VERSION.tar.xz\" | sha256sum -c - \\\n && mkdir -p /usr/src/ruby \\\n && tar -xJf /tmp/ruby-$RUBY_VERSION.tar.xz -C /usr/src/ruby --strip-components=1 \\\n && cd /usr/src/ruby \\\n && { echo '#define ENABLE_PATH_CHECK 0' ;echo ;cat file.c ; } > file.c.new \\\n && mv file.c.new file.c \\\n && autoconf \\\n && ./configure --disable-install-doc --enable-shared \\\n && make -j\"$( nproc ;)\" \\\n && make install \\\n && cd / \\\n && rm -r /usr/src/ruby \\\n && gem update --system \"$RUBYGEMS_VERSION\" \\\n && gem install bundler --version 2.4.12 \\\n && mkdir -p \"$GEM_HOME\" \"$BUNDLE_BIN\" \\\n && chmod 777 \"$GEM_HOME\" \"$BUNDLE_BIN\" \\\n && gem install rails --version 7.0.4.3 \\\n && git clone https://github.com/OWASP/railsgoat.git $WWW/railsgoat \\\n && cd $WWW/railsgoat \\\n && sed -i 's/2.2.2/2.2.3/' $WWW/railsgoat/Gemfile \\\n && bundle install \\\n && echo \"cd /var/www/html/railsgoat \\\n && rake db:setup\" >> /initialize.sh \\\n && wget https://bootstrap.pypa.io/get-pip.py -P /tmp \\\n && echo \"$PIP_FILE_SHA256 /tmp/get-pip.py\" | sha256sum -c - \\\n && python3 /tmp/get-pip.py \\\n && git clone https://github.com/davevs/django.nV.git $WWW/djangonv \\\n && cd $WWW/djangonv \\\n && pip install -r requirements.txt \\\n && sed -i 's/python/python3/g' $WWW/djangonv/reset_db.sh \\\n && sed -i 's/python/python3/g' $WWW/djangonv/runapp.sh \\\n && sed -i 's/runserver/runserver 0.0.0.0:8000/g' $WWW/djangonv/runapp.sh \\\n && echo \"cd /var/www/html/djangonv \\\n && ./reset_db.sh\" >> /initialize.sh \\\n && wget \"https://sourceforge.net/projects/rips-scanner/files/rips-0.55.zip/download?use_mirror=svwh\" -O /tmp/rips.zip \\\n && echo \"$RIPS_FILE_SHA256 /tmp/rips.zip\" | sha256sum -c - \\\n && unzip /tmp/rips.zip -d $WWW \\\n && wget https://www.mavensecurity.com/media/webmaven101.zip -P /tmp \\\n && echo \"$WEBMAVEN_FILE_SHA256 /tmp/webmaven101.zip\" | sha256sum -c - \\\n && unzip /tmp/webmaven101.zip -d /tmp/webmaven \\\n && mv /tmp/webmaven/src/cgi-bin/* /usr/lib/cgi-bin/ \\\n && mv /tmp/webmaven/src/wm /usr/lib/ \\\n && mv /tmp/webmaven/src/webmaven_html/ $WWW/webmaven/ \\\n && sed -i 's/perl/\\/usr\\/bin\\/perl/g' /usr/lib/cgi-bin/wm.cgi \\\n && sed -i \"s/src=>'\\//src=>'\\/webmaven\\//g\" /usr/lib/cgi-bin/wm.cgi \\\n && sed -i 's/SRC=\"..\\//SRC=\"\\/webmaven\\//g' /usr/lib/cgi-bin/templates/* \\\n && sed -i 's/HREF=\"..\\//HREF=\"\\/webmaven\\//g' /usr/lib/cgi-bin/templates/* \\\n && chmod +x /usr/lib/cgi-bin/wm.cgi \\\n && chmod 777 /usr/lib/wm/ \\\n && a2enmod cgi \\\n && apt-get purge -y --auto-remove $buildDeps \\\n && apt-get clean -y \\\n && apt-get autoclean -y \\\n && apt-get autoremove -y \\\n && rm -rf /var/lib/apt/lists/* /usr/share/doc/* /usr/share/man/* /tmp/* /var/tmp/*\n#   Copy startup files and config files\nCOPY conf/my.cnf /etc/mysql/conf.d/my.cnf\nCOPY startup/* /\nCOPY supervisor/* /etc/supervisor/conf.d/\n#   Set execution rights on startup scripts\nRUN chmod +x /*.sh\n#   copy landing page and redirect files\nCOPY www $WWW/\nEXPOSE 80/tcp 1080/tcp 3000/tcp 4000/tcp 8000/tcp 8080/tcp 8200/tcp\nCMD [\"/run.sh\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM debian:jessie\nMAINTAINER Dave van Stein <dvanstein@xebia.com>\n#  CONFIGURATION SETTINGS\nENV DEBIAN_FRONTEND=\"noninteractive\"\nENV PHP_UPLOAD_MAX_FILESIZE=\"10M\"\nENV PHP_POST_MAX_SIZE=\"10M\"\nENV WEBGOAT_VERSION=\"7.1\"\nENV WEBGOAT_FILE=\"webgoat-container-$WEBGOAT_VERSION-exec.jar \"\nENV WEBGOAT_URL=\"https://github.com/WebGoat/WebGoat/releases/download/$WEBGOAT_VERSION/$WEBGOAT_FILE \"\nENV WEBGOAT_FILE_SHA256=\"cc531e1e5d5b21394963f2a9bde00e83785ba1a94340bd13bde83dc24e23b77b\"\nENV WWW=\"/var/www/html\"\nENV NPM_CONFIG_LOGLEVEL=\"info\"\nENV NODE_VERSION=\"6.10.0\"\nENV NODE_FILE_SHA256=\"0f28bef128ef8ce2d9b39b9e46d2ebaeaa8a301f57726f2eba46da194471f224\"\nENV RUBY_MAJOR=\"2.3\"\nENV RUBY_VERSION=\"2.3.3\"\nENV RUBY_FILE_SHA256=\"1a4fa8c2885734ba37b97ffdb4a19b8fba0e8982606db02d936e65bac07419dc \"\nENV RUBYGEMS_VERSION=\"2.6.10\"\nENV GEM_HOME=\"/usr/local/bundle\"\nENV BUNDLE_PATH=\"$GEM_HOME\" \\\n    BUNDLE_BIN=\"$GEM_HOME/bin\" \\\n    BUNDLE_SILENCE_ROOT_WARNING=\"1\" \\\n    BUNDLE_APP_CONFIG=\"$GEM_HOME\"\nENV PATH=\"$BUNDLE_BIN:$PATH\"\nENV BUNDLER_VERSION=\"1.14.4\"\nENV RAILS_VERSION=\"4\"\nENV PIP_FILE_SHA256=\"19dae841a150c86e2a09d475b5eb0602861f2a5b7761ec268049a662dbd2bd0c \"\nENV RIPS_FILE_SHA256=\"8198e50cbdc9894583c5732ecc18c08a17f8aba60493d62e087f17eedcf13844\"\nENV WEBMAVEN_FILE_SHA256=\"3129075db3420158b79d786091a2813534b5e1080b89a21c15567746ae8d1f46 \"\n#  create intialize script for configuration items during boot\nRUN touch /initialize.sh \\\n && for key in 9554F04D7259F04124DE6B476D5A82AC7E37093B 94AE36675C464D64BAFA68DD7434390BDBE9B9C5 0034A06D9D9B0064CE8ADF6BF1747F4AD2306D93 FD3A5288F042B6850C66B31F09FE44734EB7990E 71DCFD284A79C3B38668286BC97EC7A07EDE3FC1 DD8F2338BAE7501E3DD5AC78C273792F7D83545D C4F0DFFF4E8C1A8236409D08E73BC641CC11F4C8 56730D5401028683275BD23C23EFEFE93C4CFFFE; do gpg --keyserver ha.pool.sks-keyservers.net --recv-keys \"$key\" ; done \\\n && buildDeps=' autoconf bison bzip2 g++ gcc git libbz2-dev libffi-dev libgdbm-dev libglib2.0-dev libmysqlclient-dev libncurses-dev libreadline-dev libsqlite3-dev libssl-dev libxml2-dev libxslt-dev zlib1g-dev make ruby unzip wget xz-utils ' \\\n && apt-get update \\\n && apt-get install --no-install-recommends apache2 ca-certificates default-jre-headless libapache2-mod-php5 libapache2-mod-perl2 libcgi-pm-perl libgdbm3 libyaml-0-2 mysql-server nodejs php5-mysql php5-gd procps python3 pwgen sqlite3 supervisor $buildDeps -y \\\n && echo \"ServerName localhost\" >> /etc/apache2/apache2.conf \\\n && sed -i 's/allow_url_include = Off/allow_url_include = On/g' /etc/php5/apache2/php.ini \\\n && echo 'session.save_path = \"/tmp\"' >> /etc/php5/apache2/php.ini \\\n && echo \"mysql -uadmin -p$PASS -e \\\"CREATE DATABASE dvws_db\\\"\" >> /initialize.sh \\\n && git clone https://github.com/ethicalhack3r/DVWA.git $WWW/dvwa \\\n && chmod -R 777 $WWW/dvwa/hackable/uploads $WWW/dvwa/external/phpids/0.6/lib/IDS/tmp/phpids_log.txt \\\n && sed -i \"s/public_key' ] = ''/public_key' ] = 'TaQ185RFuWM'/g\" $WWW/dvwa/config/config.inc.php \\\n && sed -i \"s/private_key' ] = ''/private_key' ] = 'TaQ185RFuWM'/g\" $WWW/dvwa/config/config.inc.php \\\n && sed -i 's/root/admin/g' $WWW/dvwa/config/config.inc.php \\\n && sed -i \"s/'default_security_level' ] = 'impossible'/'default_security_level' ] = 'low'/g\" $WWW/dvwa/config/config.inc.php \\\n && echo \"sed -i \\\"s/p@ssw0rd/$PASS/g\\\" $WWW/dvwa/config/config.inc.php\" >> /initialize.sh \\\n && git clone https://github.com/snoopysecurity/dvws.git $WWW/dvws \\\n && git clone https://github.com/interference-security/DVWS.git $WWW/dvwsock \\\n && sed -i 's/root/admin/g' $WWW/dvwsock/includes/connect-db.php \\\n && echo \"sed -i \\\"s/toor/$PASS/g\\\" $WWW/dvwsock/includes/connect-db.php\" >> /initialize.sh \\\n && git clone git://git.code.sf.net/p/mutillidae/git $WWW/mutillidae \\\n && sed -i 's/MySQLDatabaseUsername = \"root\"/MySQLDatabaseUsername = \"admin\"/g' $WWW/mutillidae/classes/MySQLHandler.php \\\n && echo \"sed -i \\\"s/MySQLDatabasePassword = \\\\\"\\\\\"/MySQLDatabasePassword = \\\\\"$PASS\\\\\"/g\\\" $WWW/mutillidae/classes/MySQLHandler.php\" >> /initialize.sh \\\n && chmod +x $WWW/mutillidae/*.php \\\n && mkdir $WWW/webgoat \\\n && wget $WEBGOAT_URL -P $WWW/webgoat/ -q --show-progress \\\n && echo \"$WEBGOAT_FILE_SHA256 $WWW/webgoat/$WEBGOAT_FILE\" | sha256sum -c - \\\n && git clone https://github.com/bkimminich/juice-shop.git $WWW/juiceshop \\\n && wget \"https://nodejs.org/dist/v$NODE_VERSION/node-v$NODE_VERSION-linux-x64.tar.xz\" -P /tmp/ \\\n && echo \"$NODE_FILE_SHA256 /tmp/node-v$NODE_VERSION-linux-x64.tar.xz\" | sha256sum -c - \\\n && tar -xJf /tmp/\"node-v$NODE_VERSION-linux-x64.tar.xz\" -C /usr/local --strip-components=1 \\\n && ln -s /usr/local/bin/node /usr/local/bin/nodejs \\\n && cd $WWW/juiceshop \\\n && npm install --production --unsafe-perm \\\n && mkdir -p /usr/local/etc \\\n && { echo 'install: --no-document' ;echo 'update: --no-document' ; } >> /usr/local/etc/gemrc \\\n && wget \"https://cache.ruby-lang.org/pub/ruby/${RUBY_MAJOR%-rc}/ruby-$RUBY_VERSION.tar.xz\" -P /tmp/ \\\n && echo \"$RUBY_FILE_SHA256 /tmp/ruby-$RUBY_VERSION.tar.xz\" | sha256sum -c - \\\n && mkdir -p /usr/src/ruby \\\n && tar -xJf /tmp/ruby-$RUBY_VERSION.tar.xz -C /usr/src/ruby --strip-components=1 \\\n && cd /usr/src/ruby \\\n && { echo '#define ENABLE_PATH_CHECK 0' ;echo ;cat file.c ; } > file.c.new \\\n && mv file.c.new file.c \\\n && autoconf \\\n && ./configure --disable-install-doc --enable-shared \\\n && make -j\"$( nproc ;)\" \\\n && make install \\\n && cd / \\\n && rm -r /usr/src/ruby \\\n && gem update --system \"$RUBYGEMS_VERSION\" \\\n && gem install bundler \\\n && mkdir -p \"$GEM_HOME\" \"$BUNDLE_BIN\" \\\n && chmod 777 \"$GEM_HOME\" \"$BUNDLE_BIN\" \\\n && gem install rails \\\n && git clone https://github.com/OWASP/railsgoat.git $WWW/railsgoat \\\n && cd $WWW/railsgoat \\\n && sed -i 's/2.2.2/2.2.3/' $WWW/railsgoat/Gemfile \\\n && bundle install \\\n && echo \"cd /var/www/html/railsgoat \\\n && rake db:setup\" >> /initialize.sh \\\n && wget https://bootstrap.pypa.io/get-pip.py -P /tmp \\\n && echo \"$PIP_FILE_SHA256 /tmp/get-pip.py\" | sha256sum -c - \\\n && python3 /tmp/get-pip.py \\\n && git clone https://github.com/davevs/django.nV.git $WWW/djangonv \\\n && cd $WWW/djangonv \\\n && pip install -r requirements.txt \\\n && sed -i 's/python/python3/g' $WWW/djangonv/reset_db.sh \\\n && sed -i 's/python/python3/g' $WWW/djangonv/runapp.sh \\\n && sed -i 's/runserver/runserver 0.0.0.0:8000/g' $WWW/djangonv/runapp.sh \\\n && echo \"cd /var/www/html/djangonv \\\n && ./reset_db.sh\" >> /initialize.sh \\\n && wget \"https://sourceforge.net/projects/rips-scanner/files/rips-0.55.zip/download?use_mirror=svwh\" -O /tmp/rips.zip \\\n && echo \"$RIPS_FILE_SHA256 /tmp/rips.zip\" | sha256sum -c - \\\n && unzip /tmp/rips.zip -d $WWW \\\n && wget https://www.mavensecurity.com/media/webmaven101.zip -P /tmp \\\n && echo \"$WEBMAVEN_FILE_SHA256 /tmp/webmaven101.zip\" | sha256sum -c - \\\n && unzip /tmp/webmaven101.zip -d /tmp/webmaven \\\n && mv /tmp/webmaven/src/cgi-bin/* /usr/lib/cgi-bin/ \\\n && mv /tmp/webmaven/src/wm /usr/lib/ \\\n && mv /tmp/webmaven/src/webmaven_html/ $WWW/webmaven/ \\\n && sed -i 's/perl/\\/usr\\/bin\\/perl/g' /usr/lib/cgi-bin/wm.cgi \\\n && sed -i \"s/src=>'\\//src=>'\\/webmaven\\//g\" /usr/lib/cgi-bin/wm.cgi \\\n && sed -i 's/SRC=\"..\\//SRC=\"\\/webmaven\\//g' /usr/lib/cgi-bin/templates/* \\\n && sed -i 's/HREF=\"..\\//HREF=\"\\/webmaven\\//g' /usr/lib/cgi-bin/templates/* \\\n && chmod +x /usr/lib/cgi-bin/wm.cgi \\\n && chmod 777 /usr/lib/wm/ \\\n && a2enmod cgi \\\n && apt-get purge -y --auto-remove $buildDeps \\\n && apt-get clean -y \\\n && apt-get autoclean -y \\\n && apt-get autoremove -y \\\n && rm -rf /var/lib/apt/lists/* /usr/share/doc/* /usr/share/man/* /tmp/* /var/tmp/*\n#  Copy startup files and config files\nCOPY conf/my.cnf /etc/mysql/conf.d/my.cnf\nCOPY startup/* /\nCOPY supervisor/* /etc/supervisor/conf.d/\n#  Set execution rights on startup scripts\nRUN chmod +x /*.sh\n#  copy landing page and redirect files\nCOPY www $WWW/\nEXPOSE 80/tcp 1080/tcp 3000/tcp 4000/tcp 8000/tcp 8080/tcp 8200/tcp\nCMD [\"/run.sh\"]\n","injectedSmells":[],"originalDockerfileHash":"82947fd09538f37036695b1e020b4b00","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM debian:jessie\nMAINTAINER Dave van Stein <dvanstein@xebia.com>\n#   CONFIGURATION SETTINGS\nENV DEBIAN_FRONTEND=\"noninteractive\"\nENV PHP_UPLOAD_MAX_FILESIZE=\"10M\"\nENV PHP_POST_MAX_SIZE=\"10M\"\nENV WEBGOAT_VERSION=\"7.1\"\nENV WEBGOAT_FILE=\"webgoat-container-$WEBGOAT_VERSION-exec.jar \"\nENV WEBGOAT_URL=\"https://github.com/WebGoat/WebGoat/releases/download/$WEBGOAT_VERSION/$WEBGOAT_FILE \"\nENV WEBGOAT_FILE_SHA256=\"cc531e1e5d5b21394963f2a9bde00e83785ba1a94340bd13bde83dc24e23b77b\"\nENV WWW=\"/var/www/html\"\nENV NPM_CONFIG_LOGLEVEL=\"info\"\nENV NODE_VERSION=\"6.10.0\"\nENV NODE_FILE_SHA256=\"0f28bef128ef8ce2d9b39b9e46d2ebaeaa8a301f57726f2eba46da194471f224\"\nENV RUBY_MAJOR=\"2.3\"\nENV RUBY_VERSION=\"2.3.3\"\nENV RUBY_FILE_SHA256=\"1a4fa8c2885734ba37b97ffdb4a19b8fba0e8982606db02d936e65bac07419dc \"\nENV RUBYGEMS_VERSION=\"2.6.10\"\nENV GEM_HOME=\"/usr/local/bundle\"\nENV BUNDLE_PATH=\"$GEM_HOME\" \\\n    BUNDLE_BIN=\"$GEM_HOME/bin\" \\\n    BUNDLE_SILENCE_ROOT_WARNING=\"1\" \\\n    BUNDLE_APP_CONFIG=\"$GEM_HOME\"\nENV PATH=\"$BUNDLE_BIN:$PATH\"\nENV BUNDLER_VERSION=\"1.14.4\"\nENV RAILS_VERSION=\"4\"\nENV PIP_FILE_SHA256=\"19dae841a150c86e2a09d475b5eb0602861f2a5b7761ec268049a662dbd2bd0c \"\nENV RIPS_FILE_SHA256=\"8198e50cbdc9894583c5732ecc18c08a17f8aba60493d62e087f17eedcf13844\"\nENV WEBMAVEN_FILE_SHA256=\"3129075db3420158b79d786091a2813534b5e1080b89a21c15567746ae8d1f46 \"\n#   create intialize script for configuration items during boot\nRUN touch /initialize.sh \\\n && for key in 9554F04D7259F04124DE6B476D5A82AC7E37093B 94AE36675C464D64BAFA68DD7434390BDBE9B9C5 0034A06D9D9B0064CE8ADF6BF1747F4AD2306D93 FD3A5288F042B6850C66B31F09FE44734EB7990E 71DCFD284A79C3B38668286BC97EC7A07EDE3FC1 DD8F2338BAE7501E3DD5AC78C273792F7D83545D C4F0DFFF4E8C1A8236409D08E73BC641CC11F4C8 56730D5401028683275BD23C23EFEFE93C4CFFFE; do gpg --keyserver ha.pool.sks-keyservers.net --recv-keys \"$key\" ; done \\\n && buildDeps=' autoconf bison bzip2 g++ gcc git libbz2-dev libffi-dev libgdbm-dev libglib2.0-dev libmysqlclient-dev libncurses-dev libreadline-dev libsqlite3-dev libssl-dev libxml2-dev libxslt-dev zlib1g-dev make ruby unzip wget xz-utils ' \\\n && apt-get update \\\n && apt-get install --no-install-recommends apache2 ca-certificates default-jre-headless libapache2-mod-php5 libapache2-mod-perl2 libcgi-pm-perl libgdbm3 libyaml-0-2 mysql-server nodejs php5-mysql php5-gd procps python3 pwgen sqlite3 supervisor $buildDeps -y \\\n && echo \"ServerName localhost\" >> /etc/apache2/apache2.conf \\\n && sed -i 's/allow_url_include = Off/allow_url_include = On/g' /etc/php5/apache2/php.ini \\\n && echo 'session.save_path = \"/tmp\"' >> /etc/php5/apache2/php.ini \\\n && echo \"mysql -uadmin -p$PASS -e \\\"CREATE DATABASE dvws_db\\\"\" >> /initialize.sh \\\n && git clone https://github.com/ethicalhack3r/DVWA.git $WWW/dvwa \\\n && chmod -R 777 $WWW/dvwa/hackable/uploads $WWW/dvwa/external/phpids/0.6/lib/IDS/tmp/phpids_log.txt \\\n && sed -i \"s/public_key' ] = ''/public_key' ] = 'TaQ185RFuWM'/g\" $WWW/dvwa/config/config.inc.php \\\n && sed -i \"s/private_key' ] = ''/private_key' ] = 'TaQ185RFuWM'/g\" $WWW/dvwa/config/config.inc.php \\\n && sed -i 's/root/admin/g' $WWW/dvwa/config/config.inc.php \\\n && sed -i \"s/'default_security_level' ] = 'impossible'/'default_security_level' ] = 'low'/g\" $WWW/dvwa/config/config.inc.php \\\n && echo \"sed -i \\\"s/p@ssw0rd/$PASS/g\\\" $WWW/dvwa/config/config.inc.php\" >> /initialize.sh \\\n && git clone https://github.com/snoopysecurity/dvws.git $WWW/dvws \\\n && git clone https://github.com/interference-security/DVWS.git $WWW/dvwsock \\\n && sed -i 's/root/admin/g' $WWW/dvwsock/includes/connect-db.php \\\n && echo \"sed -i \\\"s/toor/$PASS/g\\\" $WWW/dvwsock/includes/connect-db.php\" >> /initialize.sh \\\n && git clone git://git.code.sf.net/p/mutillidae/git $WWW/mutillidae \\\n && sed -i 's/MySQLDatabaseUsername = \"root\"/MySQLDatabaseUsername = \"admin\"/g' $WWW/mutillidae/classes/MySQLHandler.php \\\n && echo \"sed -i \\\"s/MySQLDatabasePassword = \\\"\\\"/MySQLDatabasePassword = \\\"$PASS\\\"/g\\\" $WWW/mutillidae/classes/MySQLHandler.php\" >> /initialize.sh \\\n && chmod +x $WWW/mutillidae/*.php \\\n && mkdir $WWW/webgoat \\\n && wget $WEBGOAT_URL -P $WWW/webgoat/ -q --show-progress \\\n && echo \"$WEBGOAT_FILE_SHA256 $WWW/webgoat/$WEBGOAT_FILE\" | sha256sum -c - \\\n && git clone https://github.com/bkimminich/juice-shop.git $WWW/juiceshop \\\n && wget \"https://nodejs.org/dist/v$NODE_VERSION/node-v$NODE_VERSION-linux-x64.tar.xz\" -P /tmp/ \\\n && echo \"$NODE_FILE_SHA256 /tmp/node-v$NODE_VERSION-linux-x64.tar.xz\" | sha256sum -c - \\\n && tar -xJf /tmp/\"node-v$NODE_VERSION-linux-x64.tar.xz\" -C /usr/local --strip-components=1 \\\n && ln -s /usr/local/bin/node /usr/local/bin/nodejs \\\n && cd $WWW/juiceshop \\\n && npm install --production --unsafe-perm \\\n && mkdir -p /usr/local/etc \\\n && { echo 'install: --no-document' ;echo 'update: --no-document' ; } >> /usr/local/etc/gemrc \\\n && wget \"https://cache.ruby-lang.org/pub/ruby/${RUBY_MAJOR%-rc}/ruby-$RUBY_VERSION.tar.xz\" -P /tmp/ \\\n && echo \"$RUBY_FILE_SHA256 /tmp/ruby-$RUBY_VERSION.tar.xz\" | sha256sum -c - \\\n && mkdir -p /usr/src/ruby \\\n && tar -xJf /tmp/ruby-$RUBY_VERSION.tar.xz -C /usr/src/ruby --strip-components=1 \\\n && cd /usr/src/ruby \\\n && { echo '#define ENABLE_PATH_CHECK 0' ;echo ;cat file.c ; } > file.c.new \\\n && mv file.c.new file.c \\\n && autoconf \\\n && ./configure --disable-install-doc --enable-shared \\\n && make -j\"$( nproc ;)\" \\\n && make install \\\n && cd / \\\n && rm -r /usr/src/ruby \\\n && gem update --system \"$RUBYGEMS_VERSION\" \\\n && gem install bundler \\\n && mkdir -p \"$GEM_HOME\" \"$BUNDLE_BIN\" \\\n && chmod 777 \"$GEM_HOME\" \"$BUNDLE_BIN\" \\\n && gem install rails \\\n && git clone https://github.com/OWASP/railsgoat.git $WWW/railsgoat \\\n && cd $WWW/railsgoat \\\n && sed -i 's/2.2.2/2.2.3/' $WWW/railsgoat/Gemfile \\\n && bundle install \\\n && echo \"cd /var/www/html/railsgoat \\\n && rake db:setup\" >> /initialize.sh \\\n && wget https://bootstrap.pypa.io/get-pip.py -P /tmp \\\n && echo \"$PIP_FILE_SHA256 /tmp/get-pip.py\" | sha256sum -c - \\\n && python3 /tmp/get-pip.py \\\n && git clone https://github.com/davevs/django.nV.git $WWW/djangonv \\\n && cd $WWW/djangonv \\\n && pip install -r requirements.txt \\\n && sed -i 's/python/python3/g' $WWW/djangonv/reset_db.sh \\\n && sed -i 's/python/python3/g' $WWW/djangonv/runapp.sh \\\n && sed -i 's/runserver/runserver 0.0.0.0:8000/g' $WWW/djangonv/runapp.sh \\\n && echo \"cd /var/www/html/djangonv \\\n && ./reset_db.sh\" >> /initialize.sh \\\n && wget \"https://sourceforge.net/projects/rips-scanner/files/rips-0.55.zip/download?use_mirror=svwh\" -O /tmp/rips.zip \\\n && echo \"$RIPS_FILE_SHA256 /tmp/rips.zip\" | sha256sum -c - \\\n && unzip /tmp/rips.zip -d $WWW \\\n && wget https://www.mavensecurity.com/media/webmaven101.zip -P /tmp \\\n && echo \"$WEBMAVEN_FILE_SHA256 /tmp/webmaven101.zip\" | sha256sum -c - \\\n && unzip /tmp/webmaven101.zip -d /tmp/webmaven \\\n && mv /tmp/webmaven/src/cgi-bin/* /usr/lib/cgi-bin/ \\\n && mv /tmp/webmaven/src/wm /usr/lib/ \\\n && mv /tmp/webmaven/src/webmaven_html/ $WWW/webmaven/ \\\n && sed -i 's/perl/\\/usr\\/bin\\/perl/g' /usr/lib/cgi-bin/wm.cgi \\\n && sed -i \"s/src=>'\\//src=>'\\/webmaven\\//g\" /usr/lib/cgi-bin/wm.cgi \\\n && sed -i 's/SRC=\"..\\//SRC=\"\\/webmaven\\//g' /usr/lib/cgi-bin/templates/* \\\n && sed -i 's/HREF=\"..\\//HREF=\"\\/webmaven\\//g' /usr/lib/cgi-bin/templates/* \\\n && chmod +x /usr/lib/cgi-bin/wm.cgi \\\n && chmod 777 /usr/lib/wm/ \\\n && a2enmod cgi \\\n && apt-get purge -y --auto-remove $buildDeps \\\n && apt-get clean -y \\\n && apt-get autoclean -y \\\n && apt-get autoremove -y \\\n && rm -rf /var/lib/apt/lists/* /usr/share/doc/* /usr/share/man/* /tmp/* /var/tmp/*\n#   Copy startup files and config files\nCOPY conf/my.cnf /etc/mysql/conf.d/my.cnf\nCOPY startup/* /\nCOPY supervisor/* /etc/supervisor/conf.d/\n#   Set execution rights on startup scripts\nRUN chmod +x /*.sh\n#   copy landing page and redirect files\nCOPY www $WWW/\nEXPOSE 80/tcp 1080/tcp 3000/tcp 4000/tcp 8000/tcp 8080/tcp 8200/tcp\nCMD [\"/run.sh\"]\n","originalDockerfileUglifiedHash":"bcdae5914bbe73d050eb6d7ea9880c42","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/d24b6a5e78b9bf692294e283aa3ba7aa52459618.dockerfile"}