{"seed":3454789948,"processedDockerfileHash":"d7484c299cb15c96d9c028992ff39465","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apt-get","have-a-healthcheck","have-a-user"],"processedDockerfile":"#   The Dockerfile is Licensed under GNU AFFERO GENERAL PUBLIC LICENSE Version 3\nFROM resin/rpi-raspbian\nLABEL maintainer=\"sahil@ole.org,mappuji@ole.org\"\n#   Install instructions from https://cwiki.apache.org/confluence/display/COUCHDB/Debian\nRUN groupadd -r couchdb \\\n && useradd -d /var/lib/couchdb -g couchdb couchdb\nRUN apt-get update -y \\\n && apt-get install --no-install-recommends ca-certificates=20230311 curl=7.88.1-7ubuntu1 erlang-nox=1:25.2.3+dfsg-1 libicu52 libmozjs185-1.0 libnspr4=2:4.35-1 libnspr4-0d -y \\\n && rm -rf /var/lib/apt/lists/*\nENV GOSU_VERSION=\"1.10\"\nENV TINI_VERSION=\"0.16.1\"\nRUN set -ex ; apt-get update ; apt-get install --no-install-recommends wget=1.21.3-1ubuntu1 -y ; rm -rf /var/lib/apt/lists/* ; dpkgArch=\"$( dpkg --print-architecture | awk -F- '{ print $NF }' ;)\" ; wget -O /usr/local/bin/gosu \"https://github.com/tianon/gosu/releases/download/${GOSU_VERSION}/gosu-$dpkgArch\" ; wget -O /usr/local/bin/gosu.asc \"https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-$dpkgArch.asc\" ; export GNUPGHOME=\"$( mktemp -d ;)\" ; gpg --keyserver ha.pool.sks-keyservers.net --recv-keys B42F6819007F00F88E364FD4036A9C25BF357DD4 ; gpg --batch --verify /usr/local/bin/gosu.asc /usr/local/bin/gosu ; rm -r \"$GNUPGHOME\" /usr/local/bin/gosu.asc ; chmod +x /usr/local/bin/gosu ; if ! type \"tini\" > /dev/null; then wget -O /usr/local/bin/tini \"https://github.com/krallin/tini/releases/download/v${TINI_VERSION}/tini-$dpkgArch\" ;wget -O /usr/local/bin/tini.asc \"https://github.com/krallin/tini/releases/download/v${TINI_VERSION}/tini-$dpkgArch.asc\" ;export GNUPGHOME=\"$( mktemp -d ;)\" ;gpg --keyserver ha.pool.sks-keyservers.net --recv-keys 595E85A6B1B4779EA4DAAEC70B588DFF0527A9B7 ;gpg --batch --verify /usr/local/bin/tini.asc /usr/local/bin/tini ;rm -r \"$GNUPGHOME\" /usr/local/bin/tini.asc ;chmod +x /usr/local/bin/tini ;tini --version ; fi ; apt-get purge -y --auto-remove wget\n#   https://www.apache.org/dist/couchdb/KEYS\nENV GPG_KEYS=\"15DD4F3B8AACA54740EB78C7B7B7C53943ECCEE1  1CFBFA43C19B6DF4A0CA3934669C02FFDF3CEBA3  25BBBAC113C1BFD5AA594A4C9F96B92930380381  4BFCA2B99BADC6F9F105BEC9C5E32E2D6B065BFB  5D680346FAA3E51B29DBCB681015F68F9DA248BC  7BCCEB868313DDA925DF1805ECA5BCB7BB9656B0  C3F4DFAEAD621E1C94523AEEC376457E61D50B88  D2B17F9DA23C0A10991AF2E3D9EE01E47852AEE4  E0AF0A194D55C84E4A19A801CDB0C0F904F4EE9B\"\nRUN set -xe \\\n && for key in $GPG_KEYS; do gpg --keyserver ha.pool.sks-keyservers.net --recv-keys \"$key\" ; done\nENV COUCHDB_VERSION=\"1.7.2\"\n#   download dependencies, compile and install couchdb,\n#   set correct permissions, expose couchdb to the outside and disable logging to disk\nRUN buildDeps=' gcc g++ erlang-dev libcurl4-openssl-dev libicu-dev libmozjs185-dev libnspr4-dev make ' \\\n && apt-get update \\\n && apt-get install --no-install-recommends $buildDeps -y \\\n && curl -fSL https://apache.osuosl.org/couchdb/source/$COUCHDB_VERSION/apache-couchdb-$COUCHDB_VERSION.tar.gz -o couchdb.tar.gz \\\n && curl -fSL https://www.apache.org/dist/couchdb/source/$COUCHDB_VERSION/apache-couchdb-$COUCHDB_VERSION.tar.gz.asc -o couchdb.tar.gz.asc \\\n && gpg --batch --verify couchdb.tar.gz.asc couchdb.tar.gz \\\n && mkdir -p /usr/src/couchdb \\\n && tar -xzf couchdb.tar.gz -C /usr/src/couchdb --strip-components=1 \\\n && cd /usr/src/couchdb \\\n && ./configure --with-js-lib=/usr/lib --with-js-include=/usr/include/mozjs \\\n && make \\\n && make install \\\n && apt-get purge -y --auto-remove $buildDeps \\\n && rm -rf /var/lib/apt/lists/* /usr/src/couchdb /couchdb.tar.gz* \\\n && chown -R couchdb:couchdb /usr/local/lib/couchdb /usr/local/etc/couchdb /usr/local/var/lib/couchdb /usr/local/var/log/couchdb /usr/local/var/run/couchdb \\\n && chmod -R g+rw /usr/local/lib/couchdb /usr/local/etc/couchdb /usr/local/var/lib/couchdb /usr/local/var/log/couchdb /usr/local/var/run/couchdb \\\n && mkdir -p /var/lib/couchdb \\\n && sed -e 's/^bind_address = .*$/bind_address = 0.0.0.0/' -i /usr/local/etc/couchdb/default.ini \\\n && sed -e 's!/usr/local/var/log/couchdb/couch.log$!/dev/null!' -i /usr/local/etc/couchdb/default.ini\nCOPY ./docker-entrypoint.sh /\n#   Define mountable directories.\nVOLUME [\"/usr/local/var/lib/couchdb\"]\nEXPOSE 5984/tcp\nWORKDIR /var/lib/couchdb\nENTRYPOINT [\"tini\", \"--\", \"/docker-entrypoint.sh\"]\nCMD [\"couchdb\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  The Dockerfile is Licensed under GNU AFFERO GENERAL PUBLIC LICENSE Version 3\nFROM resin/rpi-raspbian\nLABEL maintainer=\"sahil@ole.org,mappuji@ole.org\"\n#  Install instructions from https://cwiki.apache.org/confluence/display/COUCHDB/Debian\nRUN groupadd -r couchdb \\\n && useradd -d /var/lib/couchdb -g couchdb couchdb\nRUN apt-get update -y \\\n && apt-get install --no-install-recommends ca-certificates curl erlang-nox libicu52 libmozjs185-1.0 libnspr4 libnspr4-0d -y \\\n && rm -rf /var/lib/apt/lists/*\nENV GOSU_VERSION=\"1.10\"\nENV TINI_VERSION=\"0.16.1\"\nRUN set -ex ; apt-get update ; apt-get install --no-install-recommends wget -y ; rm -rf /var/lib/apt/lists/* ; dpkgArch=\"$( dpkg --print-architecture | awk -F- '{ print $NF }' ;)\" ; wget -O /usr/local/bin/gosu \"https://github.com/tianon/gosu/releases/download/${GOSU_VERSION}/gosu-$dpkgArch\" ; wget -O /usr/local/bin/gosu.asc \"https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-$dpkgArch.asc\" ; export GNUPGHOME=\"$( mktemp -d ;)\" ; gpg --keyserver ha.pool.sks-keyservers.net --recv-keys B42F6819007F00F88E364FD4036A9C25BF357DD4 ; gpg --batch --verify /usr/local/bin/gosu.asc /usr/local/bin/gosu ; rm -r \"$GNUPGHOME\" /usr/local/bin/gosu.asc ; chmod +x /usr/local/bin/gosu ; if ! type \"tini\" > /dev/null; then wget -O /usr/local/bin/tini \"https://github.com/krallin/tini/releases/download/v${TINI_VERSION}/tini-$dpkgArch\" ;wget -O /usr/local/bin/tini.asc \"https://github.com/krallin/tini/releases/download/v${TINI_VERSION}/tini-$dpkgArch.asc\" ;export GNUPGHOME=\"$( mktemp -d ;)\" ;gpg --keyserver ha.pool.sks-keyservers.net --recv-keys 595E85A6B1B4779EA4DAAEC70B588DFF0527A9B7 ;gpg --batch --verify /usr/local/bin/tini.asc /usr/local/bin/tini ;rm -r \"$GNUPGHOME\" /usr/local/bin/tini.asc ;chmod +x /usr/local/bin/tini ;tini --version ; fi ; apt-get purge -y --auto-remove wget\n#  https://www.apache.org/dist/couchdb/KEYS\nENV GPG_KEYS=\"15DD4F3B8AACA54740EB78C7B7B7C53943ECCEE1  1CFBFA43C19B6DF4A0CA3934669C02FFDF3CEBA3  25BBBAC113C1BFD5AA594A4C9F96B92930380381  4BFCA2B99BADC6F9F105BEC9C5E32E2D6B065BFB  5D680346FAA3E51B29DBCB681015F68F9DA248BC  7BCCEB868313DDA925DF1805ECA5BCB7BB9656B0  C3F4DFAEAD621E1C94523AEEC376457E61D50B88  D2B17F9DA23C0A10991AF2E3D9EE01E47852AEE4  E0AF0A194D55C84E4A19A801CDB0C0F904F4EE9B\"\nRUN set -xe \\\n && for key in $GPG_KEYS; do gpg --keyserver ha.pool.sks-keyservers.net --recv-keys \"$key\" ; done\nENV COUCHDB_VERSION=\"1.7.2\"\n#  download dependencies, compile and install couchdb,\n#  set correct permissions, expose couchdb to the outside and disable logging to disk\nRUN buildDeps=' gcc g++ erlang-dev libcurl4-openssl-dev libicu-dev libmozjs185-dev libnspr4-dev make ' \\\n && apt-get update \\\n && apt-get install --no-install-recommends $buildDeps -y \\\n && curl -fSL https://apache.osuosl.org/couchdb/source/$COUCHDB_VERSION/apache-couchdb-$COUCHDB_VERSION.tar.gz -o couchdb.tar.gz \\\n && curl -fSL https://www.apache.org/dist/couchdb/source/$COUCHDB_VERSION/apache-couchdb-$COUCHDB_VERSION.tar.gz.asc -o couchdb.tar.gz.asc \\\n && gpg --batch --verify couchdb.tar.gz.asc couchdb.tar.gz \\\n && mkdir -p /usr/src/couchdb \\\n && tar -xzf couchdb.tar.gz -C /usr/src/couchdb --strip-components=1 \\\n && cd /usr/src/couchdb \\\n && ./configure --with-js-lib=/usr/lib --with-js-include=/usr/include/mozjs \\\n && make \\\n && make install \\\n && apt-get purge -y --auto-remove $buildDeps \\\n && rm -rf /var/lib/apt/lists/* /usr/src/couchdb /couchdb.tar.gz* \\\n && chown -R couchdb:couchdb /usr/local/lib/couchdb /usr/local/etc/couchdb /usr/local/var/lib/couchdb /usr/local/var/log/couchdb /usr/local/var/run/couchdb \\\n && chmod -R g+rw /usr/local/lib/couchdb /usr/local/etc/couchdb /usr/local/var/lib/couchdb /usr/local/var/log/couchdb /usr/local/var/run/couchdb \\\n && mkdir -p /var/lib/couchdb \\\n && sed -e 's/^bind_address = .*$/bind_address = 0.0.0.0/' -i /usr/local/etc/couchdb/default.ini \\\n && sed -e 's!/usr/local/var/log/couchdb/couch.log$!/dev/null!' -i /usr/local/etc/couchdb/default.ini\nCOPY ./docker-entrypoint.sh /\n#  Define mountable directories.\nVOLUME [\"/usr/local/var/lib/couchdb\"]\nEXPOSE 5984/tcp\nWORKDIR /var/lib/couchdb\nENTRYPOINT [\"tini\", \"--\", \"/docker-entrypoint.sh\"]\nCMD [\"couchdb\"]\n","injectedSmells":[],"originalDockerfileHash":"b38c9e3c8d527a63e349ac36cdebe93c","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   The Dockerfile is Licensed under GNU AFFERO GENERAL PUBLIC LICENSE Version 3\nFROM resin/rpi-raspbian\nLABEL maintainer=\"sahil@ole.org,mappuji@ole.org\"\n#   Install instructions from https://cwiki.apache.org/confluence/display/COUCHDB/Debian\nRUN groupadd -r couchdb \\\n && useradd -d /var/lib/couchdb -g couchdb couchdb\nRUN apt-get update -y \\\n && apt-get install --no-install-recommends ca-certificates curl erlang-nox libicu52 libmozjs185-1.0 libnspr4 libnspr4-0d -y \\\n && rm -rf /var/lib/apt/lists/*\nENV GOSU_VERSION=\"1.10\"\nENV TINI_VERSION=\"0.16.1\"\nRUN set -ex ; apt-get update ; apt-get install --no-install-recommends wget -y ; rm -rf /var/lib/apt/lists/* ; dpkgArch=\"$( dpkg --print-architecture | awk -F- '{ print $NF }' ;)\" ; wget -O /usr/local/bin/gosu \"https://github.com/tianon/gosu/releases/download/${GOSU_VERSION}/gosu-$dpkgArch\" ; wget -O /usr/local/bin/gosu.asc \"https://github.com/tianon/gosu/releases/download/$GOSU_VERSION/gosu-$dpkgArch.asc\" ; export GNUPGHOME=\"$( mktemp -d ;)\" ; gpg --keyserver ha.pool.sks-keyservers.net --recv-keys B42F6819007F00F88E364FD4036A9C25BF357DD4 ; gpg --batch --verify /usr/local/bin/gosu.asc /usr/local/bin/gosu ; rm -r \"$GNUPGHOME\" /usr/local/bin/gosu.asc ; chmod +x /usr/local/bin/gosu ; if ! type \"tini\" > /dev/null; then wget -O /usr/local/bin/tini \"https://github.com/krallin/tini/releases/download/v${TINI_VERSION}/tini-$dpkgArch\" ;wget -O /usr/local/bin/tini.asc \"https://github.com/krallin/tini/releases/download/v${TINI_VERSION}/tini-$dpkgArch.asc\" ;export GNUPGHOME=\"$( mktemp -d ;)\" ;gpg --keyserver ha.pool.sks-keyservers.net --recv-keys 595E85A6B1B4779EA4DAAEC70B588DFF0527A9B7 ;gpg --batch --verify /usr/local/bin/tini.asc /usr/local/bin/tini ;rm -r \"$GNUPGHOME\" /usr/local/bin/tini.asc ;chmod +x /usr/local/bin/tini ;tini --version ; fi ; apt-get purge -y --auto-remove wget\n#   https://www.apache.org/dist/couchdb/KEYS\nENV GPG_KEYS=\"15DD4F3B8AACA54740EB78C7B7B7C53943ECCEE1  1CFBFA43C19B6DF4A0CA3934669C02FFDF3CEBA3  25BBBAC113C1BFD5AA594A4C9F96B92930380381  4BFCA2B99BADC6F9F105BEC9C5E32E2D6B065BFB  5D680346FAA3E51B29DBCB681015F68F9DA248BC  7BCCEB868313DDA925DF1805ECA5BCB7BB9656B0  C3F4DFAEAD621E1C94523AEEC376457E61D50B88  D2B17F9DA23C0A10991AF2E3D9EE01E47852AEE4  E0AF0A194D55C84E4A19A801CDB0C0F904F4EE9B\"\nRUN set -xe \\\n && for key in $GPG_KEYS; do gpg --keyserver ha.pool.sks-keyservers.net --recv-keys \"$key\" ; done\nENV COUCHDB_VERSION=\"1.7.2\"\n#   download dependencies, compile and install couchdb,\n#   set correct permissions, expose couchdb to the outside and disable logging to disk\nRUN buildDeps=' gcc g++ erlang-dev libcurl4-openssl-dev libicu-dev libmozjs185-dev libnspr4-dev make ' \\\n && apt-get update \\\n && apt-get install --no-install-recommends $buildDeps -y \\\n && curl -fSL https://apache.osuosl.org/couchdb/source/$COUCHDB_VERSION/apache-couchdb-$COUCHDB_VERSION.tar.gz -o couchdb.tar.gz \\\n && curl -fSL https://www.apache.org/dist/couchdb/source/$COUCHDB_VERSION/apache-couchdb-$COUCHDB_VERSION.tar.gz.asc -o couchdb.tar.gz.asc \\\n && gpg --batch --verify couchdb.tar.gz.asc couchdb.tar.gz \\\n && mkdir -p /usr/src/couchdb \\\n && tar -xzf couchdb.tar.gz -C /usr/src/couchdb --strip-components=1 \\\n && cd /usr/src/couchdb \\\n && ./configure --with-js-lib=/usr/lib --with-js-include=/usr/include/mozjs \\\n && make \\\n && make install \\\n && apt-get purge -y --auto-remove $buildDeps \\\n && rm -rf /var/lib/apt/lists/* /usr/src/couchdb /couchdb.tar.gz* \\\n && chown -R couchdb:couchdb /usr/local/lib/couchdb /usr/local/etc/couchdb /usr/local/var/lib/couchdb /usr/local/var/log/couchdb /usr/local/var/run/couchdb \\\n && chmod -R g+rw /usr/local/lib/couchdb /usr/local/etc/couchdb /usr/local/var/lib/couchdb /usr/local/var/log/couchdb /usr/local/var/run/couchdb \\\n && mkdir -p /var/lib/couchdb \\\n && sed -e 's/^bind_address = .*$/bind_address = 0.0.0.0/' -i /usr/local/etc/couchdb/default.ini \\\n && sed -e 's!/usr/local/var/log/couchdb/couch.log$!/dev/null!' -i /usr/local/etc/couchdb/default.ini\nCOPY ./docker-entrypoint.sh /\n#   Define mountable directories.\nVOLUME [\"/usr/local/var/lib/couchdb\"]\nEXPOSE 5984/tcp\nWORKDIR /var/lib/couchdb\nENTRYPOINT [\"tini\", \"--\", \"/docker-entrypoint.sh\"]\nCMD [\"couchdb\"]\n","originalDockerfileUglifiedHash":"c7db05eaa36a24608daf1f0d34044897","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/cd18ead742256c1e6e59e9129d93a5ca6369e182.dockerfile"}