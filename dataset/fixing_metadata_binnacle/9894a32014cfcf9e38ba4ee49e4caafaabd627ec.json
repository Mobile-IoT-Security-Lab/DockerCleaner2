{"seed":238211855,"processedDockerfileHash":"4b25c82250bb2953ae90912d3aef74c8","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","have-a-healthcheck"],"processedDockerfile":"#   Base image with Tomcat and KPM\nFROM ubuntu:16.04\nMAINTAINER Kill Bill core team <killbilling-users@googlegroups.com>\nUSER root\n#   Install Kill Bill dependencies and useful tools\nENV DEBIAN_FRONTEND=\"noninteractive\"\nRUN apt-get update \\\n && apt-get install --no-install-recommends apt-utils=1.2.35 curl=7.47.0-1ubuntu2.19 dpkg-dev=1.18.4ubuntu1.7 gcc=4:5.3.1-1ubuntu1 git=1:2.7.4-0ubuntu1.10 less=481-2.1ubuntu0.2 libapr1=1.5.2-3 libapr1-dev=1.5.2-3 libssl-dev=1.0.2g-1ubuntu4.20 make=4.1-6 mysql-client=5.7.33-0ubuntu0.16.04.1 net-tools=1.60-26ubuntu1 openjdk-8-jdk=8u292-b10-0ubuntu1~16.04.1 python-pip=8.1.1-2ubuntu0.6 sudo=1.8.16-0ubuntu1.10 telnet=0.17-40 unzip=6.0-20ubuntu1.1 vim=2:7.4.1689-3ubuntu1.5 -y \\\n && rm -rf /var/lib/apt/lists/*\nENV DEBIAN_FRONTEND=\"teletype\"\n#   Configure default JAVA_HOME path\nRUN ln -s java-8-openjdk-amd64 /usr/lib/jvm/default-java\nENV JAVA_HOME=\"/usr/lib/jvm/default-java\"\nENV JSSE_HOME=\"$JAVA_HOME/jre/\"\n#   Install latest Ansible version (deb package is too old)\nRUN python -m pip install --upgrade pip \\\n && pip install setuptools==67.6.1 --upgrade \\\n && pip install ansible==7.4.0\n#   Add tomcat user\nENV TOMCAT_OWNER=\"tomcat\"\nENV TOMCAT_GROUP=\"tomcat\"\nENV TOMCAT_HOME=\"/var/lib/tomcat\"\nRUN adduser $TOMCAT_OWNER --home $TOMCAT_HOME --disabled-password --gecos ''\n#   Add tomcat user into sudo group and reinitialize the password\nRUN usermod -aG sudo $TOMCAT_GROUP \\\n && echo \"$TOMCAT_OWNER:$TOMCAT_OWNER\" | chpasswd \\\n && echo '%sudo ALL=(ALL) NOPASSWD:ALL' >> /etc/sudoers\nUSER $TOMCAT_OWNER\nWORKDIR $TOMCAT_HOME\n#   Install roles dependencies\nRUN mkdir -p $TOMCAT_HOME/.ansible \\\n && touch $TOMCAT_HOME/.ansible_galaxy \\\n && chown tomcat $TOMCAT_HOME/.ansible \\\n && chown tomcat $TOMCAT_HOME/.ansible_galaxy\nARG KILLBILL_CLOUD_VERSION\nRUN ansible-galaxy install git+https://github.com/killbill/killbill-cloud.git,$KILLBILL_CLOUD_VERSION\nENV KILLBILL_CLOUD_ANSIBLE_ROLES=\"$TOMCAT_HOME/.ansible/roles/killbill-cloud/ansible\"\nENV ENV_HOST_IP=\"localhost\"\nENV ANSIBLE_OPTS=\"-i localhost,  -e ansible_connection=local  -e ansible_python_interpreter=/usr/bin/python  -e java_home=$JAVA_HOME  -vv\"\n#   Install KPM\nENV NEXUS_URL=\"https://oss.sonatype.org\"\nENV NEXUS_REPOSITORY=\"releases\"\nENV KPM_INSTALL_DIR=\"/opt\"\nENV KPM_VERSION=\"0.7.2\"\nRUN ansible-playbook $ANSIBLE_OPTS -e kpm_install_dir=$KPM_INSTALL_DIR -e nexus_url=$NEXUS_URL -e nexus_repository=$NEXUS_REPOSITORY -e kpm_version=$KPM_VERSION $KILLBILL_CLOUD_ANSIBLE_ROLES/kpm.yml\nENV PATH=\"\\\"/opt/kpm-${KPM_VERSION}-linux-x86_64:${PATH}\\\"\"\n#   Install Tomcat\nENV CATALINA_BASE=\"$TOMCAT_HOME\"\nENV CATALINA_HOME=\"/usr/share/tomcat\"\nENV CATALINA_PID=\"$CATALINA_BASE/tomcat.pid\"\nENV CATALINA_TMPDIR=\"/var/tmp\"\nENV TOMCAT_INSTALL_DIR=\"/opt\"\nENV TOMCAT_VERSION=\"8.5.16\"\nENV TOMCAT_NATIVE_LIBDIR=\"$CATALINA_HOME/native-jni-lib\"\nENV LD_LIBRARY_PATH=\"${LD_LIBRARY_PATH:+$LD_LIBRARY_PATH:}$TOMCAT_NATIVE_LIBDIR\"\nRUN ansible-playbook $ANSIBLE_OPTS -e tomcat_version=$TOMCAT_VERSION -e tomcat_install_dir=$TOMCAT_INSTALL_DIR -e tomcat_native_libdir=$TOMCAT_NATIVE_LIBDIR -e tomcat_owner=$TOMCAT_OWNER -e tomcat_group=$TOMCAT_GROUP -e tomcat_home=$TOMCAT_HOME -e catalina_home=$CATALINA_HOME -e catalina_base=$CATALINA_BASE -e apr_config_path=\"$( which apr-1-config ;)\" -e gnu_arch=\"$( dpkg-architecture --query DEB_BUILD_GNU_TYPE ;)\" $KILLBILL_CLOUD_ANSIBLE_ROLES/tomcat.yml\n#   Start Tomcat\nEXPOSE 8080/tcp\nCMD [\"/usr/share/tomcat/bin/catalina.sh\", \"run\"]\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  Base image with Tomcat and KPM\nFROM ubuntu:16.04\nMAINTAINER Kill Bill core team <killbilling-users@googlegroups.com>\nUSER root\n#  Install Kill Bill dependencies and useful tools\nENV DEBIAN_FRONTEND=\"noninteractive\"\nRUN apt-get update \\\n && apt-get install apt-utils curl dpkg-dev gcc git less libapr1 libapr1-dev libssl-dev make mysql-client net-tools openjdk-8-jdk python-pip sudo telnet unzip vim -y \\\n && rm -rf /var/lib/apt/lists/*\nENV DEBIAN_FRONTEND=\"teletype\"\n#  Configure default JAVA_HOME path\nRUN ln -s java-8-openjdk-amd64 /usr/lib/jvm/default-java\nENV JAVA_HOME=\"/usr/lib/jvm/default-java\"\nENV JSSE_HOME=\"$JAVA_HOME/jre/\"\n#  Install latest Ansible version (deb package is too old)\nRUN python -m pip install --upgrade pip \\\n && pip install setuptools --upgrade \\\n && pip install ansible\n#  Add tomcat user\nENV TOMCAT_OWNER=\"tomcat\"\nENV TOMCAT_GROUP=\"tomcat\"\nENV TOMCAT_HOME=\"/var/lib/tomcat\"\nRUN adduser $TOMCAT_OWNER --home $TOMCAT_HOME --disabled-password --gecos ''\n#  Add tomcat user into sudo group and reinitialize the password\nRUN usermod -aG sudo $TOMCAT_GROUP \\\n && echo \"$TOMCAT_OWNER:$TOMCAT_OWNER\" | chpasswd \\\n && echo '%sudo ALL=(ALL) NOPASSWD:ALL' >> /etc/sudoers\nUSER $TOMCAT_OWNER\nWORKDIR $TOMCAT_HOME\n#  Install roles dependencies\nRUN mkdir -p $TOMCAT_HOME/.ansible \\\n && touch $TOMCAT_HOME/.ansible_galaxy \\\n && chown tomcat $TOMCAT_HOME/.ansible \\\n && chown tomcat $TOMCAT_HOME/.ansible_galaxy\nARG KILLBILL_CLOUD_VERSION\nRUN ansible-galaxy install git+https://github.com/killbill/killbill-cloud.git,$KILLBILL_CLOUD_VERSION\nENV KILLBILL_CLOUD_ANSIBLE_ROLES=\"$TOMCAT_HOME/.ansible/roles/killbill-cloud/ansible\"\nENV ENV_HOST_IP=\"localhost\"\nENV ANSIBLE_OPTS=\"-i localhost,  -e ansible_connection=local  -e ansible_python_interpreter=/usr/bin/python  -e java_home=$JAVA_HOME  -vv\"\n#  Install KPM\nENV NEXUS_URL=\"https://oss.sonatype.org\"\nENV NEXUS_REPOSITORY=\"releases\"\nENV KPM_INSTALL_DIR=\"/opt\"\nENV KPM_VERSION=\"0.7.2\"\nRUN ansible-playbook $ANSIBLE_OPTS -e kpm_install_dir=$KPM_INSTALL_DIR -e nexus_url=$NEXUS_URL -e nexus_repository=$NEXUS_REPOSITORY -e kpm_version=$KPM_VERSION $KILLBILL_CLOUD_ANSIBLE_ROLES/kpm.yml\nENV PATH=\"\\\"/opt/kpm-${KPM_VERSION}-linux-x86_64:${PATH}\\\"\"\n#  Install Tomcat\nENV CATALINA_BASE=\"$TOMCAT_HOME\"\nENV CATALINA_HOME=\"/usr/share/tomcat\"\nENV CATALINA_PID=\"$CATALINA_BASE/tomcat.pid\"\nENV CATALINA_TMPDIR=\"/var/tmp\"\nENV TOMCAT_INSTALL_DIR=\"/opt\"\nENV TOMCAT_VERSION=\"8.5.16\"\nENV TOMCAT_NATIVE_LIBDIR=\"$CATALINA_HOME/native-jni-lib\"\nENV LD_LIBRARY_PATH=\"${LD_LIBRARY_PATH:+$LD_LIBRARY_PATH:}$TOMCAT_NATIVE_LIBDIR\"\nRUN ansible-playbook $ANSIBLE_OPTS -e tomcat_version=$TOMCAT_VERSION -e tomcat_install_dir=$TOMCAT_INSTALL_DIR -e tomcat_native_libdir=$TOMCAT_NATIVE_LIBDIR -e tomcat_owner=$TOMCAT_OWNER -e tomcat_group=$TOMCAT_GROUP -e tomcat_home=$TOMCAT_HOME -e catalina_home=$CATALINA_HOME -e catalina_base=$CATALINA_BASE -e apr_config_path=\"$( which apr-1-config ;)\" -e gnu_arch=\"$( dpkg-architecture --query DEB_BUILD_GNU_TYPE ;)\" $KILLBILL_CLOUD_ANSIBLE_ROLES/tomcat.yml\n#  Start Tomcat\nEXPOSE 8080/tcp\nCMD [\"/usr/share/tomcat/bin/catalina.sh\", \"run\"]\n","injectedSmells":[],"originalDockerfileHash":"a2619d44e7591f39880b24e30e32d30f","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   Base image with Tomcat and KPM\nFROM ubuntu:16.04\nMAINTAINER Kill Bill core team <killbilling-users@googlegroups.com>\nUSER root\n#   Install Kill Bill dependencies and useful tools\nENV DEBIAN_FRONTEND=\"noninteractive\"\nRUN apt-get update \\\n && apt-get install apt-utils curl dpkg-dev gcc git less libapr1 libapr1-dev libssl-dev make mysql-client net-tools openjdk-8-jdk python-pip sudo telnet unzip vim -y \\\n && rm -rf /var/lib/apt/lists/*\nENV DEBIAN_FRONTEND=\"teletype\"\n#   Configure default JAVA_HOME path\nRUN ln -s java-8-openjdk-amd64 /usr/lib/jvm/default-java\nENV JAVA_HOME=\"/usr/lib/jvm/default-java\"\nENV JSSE_HOME=\"$JAVA_HOME/jre/\"\n#   Install latest Ansible version (deb package is too old)\nRUN python -m pip install --upgrade pip \\\n && pip install setuptools --upgrade \\\n && pip install ansible\n#   Add tomcat user\nENV TOMCAT_OWNER=\"tomcat\"\nENV TOMCAT_GROUP=\"tomcat\"\nENV TOMCAT_HOME=\"/var/lib/tomcat\"\nRUN adduser $TOMCAT_OWNER --home $TOMCAT_HOME --disabled-password --gecos ''\n#   Add tomcat user into sudo group and reinitialize the password\nRUN usermod -aG sudo $TOMCAT_GROUP \\\n && echo \"$TOMCAT_OWNER:$TOMCAT_OWNER\" | chpasswd \\\n && echo '%sudo ALL=(ALL) NOPASSWD:ALL' >> /etc/sudoers\nUSER $TOMCAT_OWNER\nWORKDIR $TOMCAT_HOME\n#   Install roles dependencies\nRUN mkdir -p $TOMCAT_HOME/.ansible \\\n && touch $TOMCAT_HOME/.ansible_galaxy \\\n && chown tomcat $TOMCAT_HOME/.ansible \\\n && chown tomcat $TOMCAT_HOME/.ansible_galaxy\nARG KILLBILL_CLOUD_VERSION\nRUN ansible-galaxy install git+https://github.com/killbill/killbill-cloud.git,$KILLBILL_CLOUD_VERSION\nENV KILLBILL_CLOUD_ANSIBLE_ROLES=\"$TOMCAT_HOME/.ansible/roles/killbill-cloud/ansible\"\nENV ENV_HOST_IP=\"localhost\"\nENV ANSIBLE_OPTS=\"-i localhost,  -e ansible_connection=local  -e ansible_python_interpreter=/usr/bin/python  -e java_home=$JAVA_HOME  -vv\"\n#   Install KPM\nENV NEXUS_URL=\"https://oss.sonatype.org\"\nENV NEXUS_REPOSITORY=\"releases\"\nENV KPM_INSTALL_DIR=\"/opt\"\nENV KPM_VERSION=\"0.7.2\"\nRUN ansible-playbook $ANSIBLE_OPTS -e kpm_install_dir=$KPM_INSTALL_DIR -e nexus_url=$NEXUS_URL -e nexus_repository=$NEXUS_REPOSITORY -e kpm_version=$KPM_VERSION $KILLBILL_CLOUD_ANSIBLE_ROLES/kpm.yml\nENV PATH=\"\\\"/opt/kpm-${KPM_VERSION}-linux-x86_64:${PATH}\\\"\"\n#   Install Tomcat\nENV CATALINA_BASE=\"$TOMCAT_HOME\"\nENV CATALINA_HOME=\"/usr/share/tomcat\"\nENV CATALINA_PID=\"$CATALINA_BASE/tomcat.pid\"\nENV CATALINA_TMPDIR=\"/var/tmp\"\nENV TOMCAT_INSTALL_DIR=\"/opt\"\nENV TOMCAT_VERSION=\"8.5.16\"\nENV TOMCAT_NATIVE_LIBDIR=\"$CATALINA_HOME/native-jni-lib\"\nENV LD_LIBRARY_PATH=\"${LD_LIBRARY_PATH:+$LD_LIBRARY_PATH:}$TOMCAT_NATIVE_LIBDIR\"\nRUN ansible-playbook $ANSIBLE_OPTS -e tomcat_version=$TOMCAT_VERSION -e tomcat_install_dir=$TOMCAT_INSTALL_DIR -e tomcat_native_libdir=$TOMCAT_NATIVE_LIBDIR -e tomcat_owner=$TOMCAT_OWNER -e tomcat_group=$TOMCAT_GROUP -e tomcat_home=$TOMCAT_HOME -e catalina_home=$CATALINA_HOME -e catalina_base=$CATALINA_BASE -e apr_config_path=\"$( which apr-1-config ;)\" -e gnu_arch=\"$( dpkg-architecture --query DEB_BUILD_GNU_TYPE ;)\" $KILLBILL_CLOUD_ANSIBLE_ROLES/tomcat.yml\n#   Start Tomcat\nEXPOSE 8080/tcp\nCMD [\"/usr/share/tomcat/bin/catalina.sh\", \"run\"]\n","originalDockerfileUglifiedHash":"89a2e3d236e598a691b86d5d67f4e95e","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/9894a32014cfcf9e38ba4ee49e4caafaabd627ec.dockerfile"}