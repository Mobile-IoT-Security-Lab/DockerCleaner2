{"seed":2687951460,"processedDockerfileHash":"d91913faeeae58d00f49ecab3c70810d","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","pin-package-manager-versions-apt-get","use-copy-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM ubuntu:trusty\nMAINTAINER Alexandre Viau <alexandre.viau@savoirfairelinux.com>\nRUN apt-get update \\\n && apt-get install --no-install-recommends vim=2:7.4.052-1ubuntu3.1 git=1:1.9.1-1ubuntu0.10 supervisor=3.0b2-1ubuntu0.1 python-dev=2.7.5-5ubuntu3 libffi-dev=3.1~rc1+r3.0.13-12ubuntu0.2 libssl-dev=1.0.1f-1ubuntu2.27 nagios-nrpe-server=2.15-0ubuntu1 wget=1.15-1ubuntu1.14.04.5 python-virtualenv=1.11.4-1ubuntu1 python-openssl=0.13-2ubuntu6 -y\n#   libffi-devand libssl-dev are for python-cryptography\n#  ## Alignak\nRUN apt-get update \\\n && apt-get install --no-install-recommends python-pip=1.5.4-1ubuntu4 python-pycurl=7.19.3-0ubuntu3 -y\nRUN useradd alignak \\\n && pip install https://github.com/Alignak-monitoring/alignak/archive/d7f457d5ed94f08d9a6a38809106d3e0d35a1712.tar.gz\n#  # modules\n#   mod-webui\nRUN cd /tmp \\\n && wget -O mod-webui.tar.gz https://github.com/shinken-monitoring/mod-webui/archive/3215d6c775326d1fb3afb161eb279dfb44e45986.tar.gz \\\n && tar -zxvf mod-webui.tar.gz \\\n && mv /tmp/mod-webui-*/module /var/lib/alignak/modules/webui \\\n && rm -rfv /tmp/mod-webui*\n#   auth-cfg-password\nRUN cd /tmp \\\n && wget -O mod-auth-cfg-password.tar.gz https://github.com/shinken-monitoring/mod-auth-cfg-password/archive/6079d31974305b74e332424df44efecc9dfeabfc.tar.gz \\\n && tar -zxvf mod-auth-cfg-password.tar.gz \\\n && mv /tmp/mod-auth-cfg-password-*/module /var/lib/alignak/modules/auth-cfg-password \\\n && rm -rfv /tmp/mod-auth-cfg-password*\n#   mod-booster-nrpe\nRUN cd /tmp \\\n && wget -O mod-booster-nrpe.tar.gz https://github.com/shinken-monitoring/mod-booster-nrpe/archive/de7099706855e32c1962c77740be0fae446d15f5.tar.gz \\\n && tar -zxvf mod-booster-nrpe.tar.gz \\\n && mv /tmp/mod-booster-nrpe-*/module /var/lib/alignak/modules/mod-booster-nrpe \\\n && rm -rfv /tmp/mod-booster-nrpe*\n#   mod-surveil\nRUN pip install python-surveilclient==0.13.3\nRUN cd /tmp \\\n && wget -O mod-surveil-config.tar.gz https://github.com/Alignak-monitoring/mod-surveil/archive/fdc98b4fc036aa483ecb58459f11f9a87cf2254a.tar.gz \\\n && tar -zxvf mod-surveil-config.tar.gz \\\n && mv /tmp/mod-surveil-*/alignak/modules/mod_surveil /var/lib/alignak/modules/mod-surveil \\\n && rm -rfv /tmp/mod-surveil*\n#   mod-influxdb\nRUN pip install influxdb==2.8.0\nRUN cd /tmp \\\n && wget -O mod-influxdb.tar.gz https://github.com/savoirfairelinux/mod-influxdb/archive/9433b726492a09d5faeb70abfc5efdbf1728686f.tar.gz \\\n && tar -zxvf mod-influxdb.tar.gz \\\n && mv /tmp/mod-influxdb-*/module /var/lib/alignak/modules/mod-influxdb \\\n && rm -rfv /tmp/mod-influxdb*\n#   mod-ws-arbiter\nRUN cd /tmp \\\n && wget -O mod-ws-arbiter.tar.gz https://github.com/shinken-monitoring/mod-ws-arbiter/archive/ebae7950be9452ab80ec58575e9887d9b2a15d2a.tar.gz \\\n && tar -zxvf mod-ws-arbiter.tar.gz \\\n && mv /tmp/mod-ws-arbiter-*/module /var/lib/alignak/modules/ws-arbiter \\\n && rm -rfv /tmp/mod-ws-arbiter*\n#   mod-mongo-live-config\nRUN pip install pymongo==3.0.2\nRUN cd /tmp \\\n && wget -O mod-mongo-live-config.tar.gz https://github.com/savoirfairelinux/mod-mongo-live-config/archive/0.3.2.tar.gz \\\n && tar -zxvf mod-mongo-live-config.tar.gz \\\n && mv /tmp/mod-mongo-live-config-*/mod_mongo_live_config /var/lib/alignak/modules/mod_mongo_live_config \\\n && rm -rfv /tmp/mod-mongo-live-config*\n#   mod-ceilometer\nRUN apt-get update \\\n && apt-get install --no-install-recommends python-ceilometerclient=1.0.8-0ubuntu1 -y\nRUN cd /tmp \\\n && wget -O mod-ceilometer.tar.gz https://github.com/savoirfairelinux/mod-ceilometer/archive/0.2.1.tar.gz \\\n && tar -zxvf mod-ceilometer.tar.gz \\\n && mv /tmp/mod-ceilometer-*/module /var/lib/alignak/modules/mod-ceilometer \\\n && rm -rfv /tmp/mod-ceilometer*\n#  # plugins\nRUN apt-get update \\\n && apt-get install --no-install-recommends nagios-plugins=1.5-3ubuntu1 nagios-nrpe-plugin=2.15-0ubuntu1 -y\n#   run permissions for user `alignak`\nRUN chmod u+s /usr/lib/nagios/plugins/check_icmp\nRUN chmod u+s /bin/ping\nRUN chmod u+s /bin/ping6\n#   Download plugins\nENV MONITORING_TOOLS_VERSION=\"0.4.1\"\nRUN apt-get update \\\n && apt-get install --no-install-recommends subversion=1.8.8-1ubuntu3.3 -y \\\n && svn checkout https://github.com/savoirfairelinux/monitoring-tools/tags/${MONITORING_TOOLS_VERSION}/plugins/check-glance /plugins/check_glance \\\n && svn checkout https://github.com/savoirfairelinux/monitoring-tools/tags/${MONITORING_TOOLS_VERSION}/plugins/check-keystone /plugins/check_keystone \\\n && svn checkout https://github.com/savoirfairelinux/monitoring-tools/tags/${MONITORING_TOOLS_VERSION}/plugins/check-nova /plugins/check_nova \\\n && svn checkout https://github.com/savoirfairelinux/monitoring-tools/tags/${MONITORING_TOOLS_VERSION}/plugins/check-cinder /plugins/check_cinder \\\n && svn checkout https://github.com/savoirfairelinux/monitoring-tools/tags/${MONITORING_TOOLS_VERSION}/plugins/check-ceilometer /plugins/check_ceilometer \\\n && svn checkout https://github.com/savoirfairelinux/monitoring-tools/tags/${MONITORING_TOOLS_VERSION}/plugins/check-nova-host-status /plugins/check_nova_host_status \\\n && apt-get remove -y subversion\n#  # Install plugins dependencies\nRUN mkdir -p /opt/surveilplugins\nRUN virtualenv /opt/surveilplugins/env\nENV PATH=\"$PATH:/opt/surveilplugins/env/bin\"\nRUN /opt/surveilplugins/env/bin/pip install -U \"pbr>=1.3,<2.0\" shinkenplugins python-keystoneclient python-glanceclient\n#  # Install Plugins\nRUN mkdir -p /usr/lib/monitoring/plugins/sfl\nRUN cd /plugins/check_keystone \\\n && sudo /opt/surveilplugins/env/bin/python setup.py install \\\n && ln -s /opt/surveilplugins/env/bin/check_keystone /usr/lib/monitoring/plugins/sfl/\nRUN cd /plugins/check_glance \\\n && sudo /opt/surveilplugins/env/bin/python setup.py install \\\n && ln -s /opt/surveilplugins/env/bin/check_glance /usr/lib/monitoring/plugins/sfl/\nRUN cd /plugins/check_nova \\\n && sudo /opt/surveilplugins/env/bin/python setup.py install \\\n && ln -s /opt/surveilplugins/env/bin/check_nova /usr/lib/monitoring/plugins/sfl/\nRUN cd /plugins/check_cinder \\\n && sudo /opt/surveilplugins/env/bin/python setup.py install \\\n && ln -s /opt/surveilplugins/env/bin/check_cinder /usr/lib/monitoring/plugins/sfl/\nRUN cd /plugins/check_ceilometer \\\n && sudo /opt/surveilplugins/env/bin/python setup.py install \\\n && ln -s /opt/surveilplugins/env/bin/check_ceilometer /usr/lib/monitoring/plugins/sfl/\nRUN cd /plugins/check_nova_host_status \\\n && sudo /opt/surveilplugins/env/bin/python setup.py install \\\n && ln -s /opt/surveilplugins/env/bin/check_nova_host_status /usr/lib/monitoring/plugins/sfl/\n#  # Add check example plugin\nCOPY plugins/check-example /plugins/check_example\nRUN virtualenv /plugins/check_example/env\nENV PATH=\"$PATH:/plugins/check_example/env/bin\"\nRUN /plugins/check_example/env/bin/pip install -r /plugins/check_example/requirements.txt\nRUN cd /plugins/check_example \\\n && sudo /opt/surveilplugins/env/bin/python setup.py install \\\n && ln -s /opt/surveilplugins/env/bin/check_example /usr/lib/monitoring/plugins/sfl\n#  # configuration\nCOPY setup.sh /setup.sh\nRUN rm -rf /etc/alignak\nCOPY etc/alignak /etc/alignak\nRUN chown -R root:alignak /etc/alignak\n#  ## Supervisor\nCOPY etc/supervisor /etc/supervisor\n#   Alignak WEBUI\nEXPOSE 7767/tcp\n#   ws-arbiter\nEXPOSE 7760/tcp\n#   OpenStack Authentication credentials. Used for sending data to Ceilometer\nENV SURVEIL_OS_AUTH_URL=\"http://keystone:5000/v2.0\"\nENV SURVEIL_OS_USERNAME=\"admin\"\n# A secret has been removed here. Please do not provide secrets from the Dockerfile as these will leak into the metadata of the resulting docker image. To provide secrets the --secret flag of the docker build command can be used (https://docs.docker.com/develop/develop-images/build_enhancements/#new-docker-build-secret-information).\nENV SURVEIL_OS_TENANT_NAME=\"admin\"\nCMD ./setup.sh \\\n && /usr/bin/supervisord\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM ubuntu:trusty\nMAINTAINER Alexandre Viau <alexandre.viau@savoirfairelinux.com>\nRUN apt-get update \\\n && apt-get install vim git supervisor python-dev libffi-dev libssl-dev nagios-nrpe-server wget python-virtualenv python-openssl -y\n#  libffi-devand libssl-dev are for python-cryptography\n# ## Alignak\nRUN apt-get update \\\n && apt-get install python-pip python-pycurl -y\nRUN useradd alignak \\\n && pip install https://github.com/Alignak-monitoring/alignak/archive/d7f457d5ed94f08d9a6a38809106d3e0d35a1712.tar.gz\n# # modules\n#  mod-webui\nRUN cd /tmp \\\n && wget -O mod-webui.tar.gz https://github.com/shinken-monitoring/mod-webui/archive/3215d6c775326d1fb3afb161eb279dfb44e45986.tar.gz \\\n && tar -zxvf mod-webui.tar.gz \\\n && mv /tmp/mod-webui-*/module /var/lib/alignak/modules/webui \\\n && rm -rfv /tmp/mod-webui*\n#  auth-cfg-password\nRUN cd /tmp \\\n && wget -O mod-auth-cfg-password.tar.gz https://github.com/shinken-monitoring/mod-auth-cfg-password/archive/6079d31974305b74e332424df44efecc9dfeabfc.tar.gz \\\n && tar -zxvf mod-auth-cfg-password.tar.gz \\\n && mv /tmp/mod-auth-cfg-password-*/module /var/lib/alignak/modules/auth-cfg-password \\\n && rm -rfv /tmp/mod-auth-cfg-password*\n#  mod-booster-nrpe\nRUN cd /tmp \\\n && wget -O mod-booster-nrpe.tar.gz https://github.com/shinken-monitoring/mod-booster-nrpe/archive/de7099706855e32c1962c77740be0fae446d15f5.tar.gz \\\n && tar -zxvf mod-booster-nrpe.tar.gz \\\n && mv /tmp/mod-booster-nrpe-*/module /var/lib/alignak/modules/mod-booster-nrpe \\\n && rm -rfv /tmp/mod-booster-nrpe*\n#  mod-surveil\nRUN pip install python-surveilclient==0.13.3\nRUN cd /tmp \\\n && wget -O mod-surveil-config.tar.gz https://github.com/Alignak-monitoring/mod-surveil/archive/fdc98b4fc036aa483ecb58459f11f9a87cf2254a.tar.gz \\\n && tar -zxvf mod-surveil-config.tar.gz \\\n && mv /tmp/mod-surveil-*/alignak/modules/mod_surveil /var/lib/alignak/modules/mod-surveil \\\n && rm -rfv /tmp/mod-surveil*\n#  mod-influxdb\nRUN pip install influxdb==2.8.0\nRUN cd /tmp \\\n && wget -O mod-influxdb.tar.gz https://github.com/savoirfairelinux/mod-influxdb/archive/9433b726492a09d5faeb70abfc5efdbf1728686f.tar.gz \\\n && tar -zxvf mod-influxdb.tar.gz \\\n && mv /tmp/mod-influxdb-*/module /var/lib/alignak/modules/mod-influxdb \\\n && rm -rfv /tmp/mod-influxdb*\n#  mod-ws-arbiter\nRUN cd /tmp \\\n && wget -O mod-ws-arbiter.tar.gz https://github.com/shinken-monitoring/mod-ws-arbiter/archive/ebae7950be9452ab80ec58575e9887d9b2a15d2a.tar.gz \\\n && tar -zxvf mod-ws-arbiter.tar.gz \\\n && mv /tmp/mod-ws-arbiter-*/module /var/lib/alignak/modules/ws-arbiter \\\n && rm -rfv /tmp/mod-ws-arbiter*\n#  mod-mongo-live-config\nRUN pip install pymongo==3.0.2\nRUN cd /tmp \\\n && wget -O mod-mongo-live-config.tar.gz https://github.com/savoirfairelinux/mod-mongo-live-config/archive/0.3.2.tar.gz \\\n && tar -zxvf mod-mongo-live-config.tar.gz \\\n && mv /tmp/mod-mongo-live-config-*/mod_mongo_live_config /var/lib/alignak/modules/mod_mongo_live_config \\\n && rm -rfv /tmp/mod-mongo-live-config*\n#  mod-ceilometer\nRUN apt-get update \\\n && apt-get install python-ceilometerclient -y\nRUN cd /tmp \\\n && wget -O mod-ceilometer.tar.gz https://github.com/savoirfairelinux/mod-ceilometer/archive/0.2.1.tar.gz \\\n && tar -zxvf mod-ceilometer.tar.gz \\\n && mv /tmp/mod-ceilometer-*/module /var/lib/alignak/modules/mod-ceilometer \\\n && rm -rfv /tmp/mod-ceilometer*\n# # plugins\nRUN apt-get update \\\n && apt-get install nagios-plugins nagios-nrpe-plugin -y\n#  run permissions for user `alignak`\nRUN chmod u+s /usr/lib/nagios/plugins/check_icmp\nRUN chmod u+s /bin/ping\nRUN chmod u+s /bin/ping6\n#  Download plugins\nENV MONITORING_TOOLS_VERSION=\"0.4.1\"\nRUN apt-get update \\\n && apt-get install subversion -y \\\n && svn checkout https://github.com/savoirfairelinux/monitoring-tools/tags/${MONITORING_TOOLS_VERSION}/plugins/check-glance /plugins/check_glance \\\n && svn checkout https://github.com/savoirfairelinux/monitoring-tools/tags/${MONITORING_TOOLS_VERSION}/plugins/check-keystone /plugins/check_keystone \\\n && svn checkout https://github.com/savoirfairelinux/monitoring-tools/tags/${MONITORING_TOOLS_VERSION}/plugins/check-nova /plugins/check_nova \\\n && svn checkout https://github.com/savoirfairelinux/monitoring-tools/tags/${MONITORING_TOOLS_VERSION}/plugins/check-cinder /plugins/check_cinder \\\n && svn checkout https://github.com/savoirfairelinux/monitoring-tools/tags/${MONITORING_TOOLS_VERSION}/plugins/check-ceilometer /plugins/check_ceilometer \\\n && svn checkout https://github.com/savoirfairelinux/monitoring-tools/tags/${MONITORING_TOOLS_VERSION}/plugins/check-nova-host-status /plugins/check_nova_host_status \\\n && apt-get remove -y subversion\n# # Install plugins dependencies\nRUN mkdir -p /opt/surveilplugins\nRUN virtualenv /opt/surveilplugins/env\nENV PATH=\"$PATH:/opt/surveilplugins/env/bin\"\nRUN /opt/surveilplugins/env/bin/pip install -U \"pbr>=1.3,<2.0\" shinkenplugins python-keystoneclient python-glanceclient\n# # Install Plugins\nRUN mkdir -p /usr/lib/monitoring/plugins/sfl\nRUN cd /plugins/check_keystone \\\n && sudo /opt/surveilplugins/env/bin/python setup.py install \\\n && ln -s /opt/surveilplugins/env/bin/check_keystone /usr/lib/monitoring/plugins/sfl/\nRUN cd /plugins/check_glance \\\n && sudo /opt/surveilplugins/env/bin/python setup.py install \\\n && ln -s /opt/surveilplugins/env/bin/check_glance /usr/lib/monitoring/plugins/sfl/\nRUN cd /plugins/check_nova \\\n && sudo /opt/surveilplugins/env/bin/python setup.py install \\\n && ln -s /opt/surveilplugins/env/bin/check_nova /usr/lib/monitoring/plugins/sfl/\nRUN cd /plugins/check_cinder \\\n && sudo /opt/surveilplugins/env/bin/python setup.py install \\\n && ln -s /opt/surveilplugins/env/bin/check_cinder /usr/lib/monitoring/plugins/sfl/\nRUN cd /plugins/check_ceilometer \\\n && sudo /opt/surveilplugins/env/bin/python setup.py install \\\n && ln -s /opt/surveilplugins/env/bin/check_ceilometer /usr/lib/monitoring/plugins/sfl/\nRUN cd /plugins/check_nova_host_status \\\n && sudo /opt/surveilplugins/env/bin/python setup.py install \\\n && ln -s /opt/surveilplugins/env/bin/check_nova_host_status /usr/lib/monitoring/plugins/sfl/\n# # Add check example plugin\nADD plugins/check-example /plugins/check_example\nRUN virtualenv /plugins/check_example/env\nENV PATH=\"$PATH:/plugins/check_example/env/bin\"\nRUN /plugins/check_example/env/bin/pip install -r /plugins/check_example/requirements.txt\nRUN cd /plugins/check_example \\\n && sudo /opt/surveilplugins/env/bin/python setup.py install \\\n && ln -s /opt/surveilplugins/env/bin/check_example /usr/lib/monitoring/plugins/sfl\n# # configuration\nADD setup.sh /setup.sh\nRUN rm -rf /etc/alignak\nADD etc/alignak /etc/alignak\nRUN chown -R root:alignak /etc/alignak\n# ## Supervisor\nADD etc/supervisor /etc/supervisor\n#  Alignak WEBUI\nEXPOSE 7767/tcp\n#  ws-arbiter\nEXPOSE 7760/tcp\n#  OpenStack Authentication credentials. Used for sending data to Ceilometer\nENV SURVEIL_OS_AUTH_URL=\"http://keystone:5000/v2.0\"\nENV SURVEIL_OS_USERNAME=\"admin\"\nENV SURVEIL_OS_PASSWORD=\"password\"\nENV SURVEIL_OS_TENANT_NAME=\"admin\"\nCMD ./setup.sh \\\n && /usr/bin/supervisord\n","injectedSmells":[],"originalDockerfileHash":"64bce6fe0a2cee3d010c7562a036e264","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM ubuntu:trusty\nMAINTAINER Alexandre Viau <alexandre.viau@savoirfairelinux.com>\nRUN apt-get update \\\n && apt-get install vim git supervisor python-dev libffi-dev libssl-dev nagios-nrpe-server wget python-virtualenv python-openssl -y\n#   libffi-devand libssl-dev are for python-cryptography\n#  ## Alignak\nRUN apt-get update \\\n && apt-get install python-pip python-pycurl -y\nRUN useradd alignak \\\n && pip install https://github.com/Alignak-monitoring/alignak/archive/d7f457d5ed94f08d9a6a38809106d3e0d35a1712.tar.gz\n#  # modules\n#   mod-webui\nRUN cd /tmp \\\n && wget -O mod-webui.tar.gz https://github.com/shinken-monitoring/mod-webui/archive/3215d6c775326d1fb3afb161eb279dfb44e45986.tar.gz \\\n && tar -zxvf mod-webui.tar.gz \\\n && mv /tmp/mod-webui-*/module /var/lib/alignak/modules/webui \\\n && rm -rfv /tmp/mod-webui*\n#   auth-cfg-password\nRUN cd /tmp \\\n && wget -O mod-auth-cfg-password.tar.gz https://github.com/shinken-monitoring/mod-auth-cfg-password/archive/6079d31974305b74e332424df44efecc9dfeabfc.tar.gz \\\n && tar -zxvf mod-auth-cfg-password.tar.gz \\\n && mv /tmp/mod-auth-cfg-password-*/module /var/lib/alignak/modules/auth-cfg-password \\\n && rm -rfv /tmp/mod-auth-cfg-password*\n#   mod-booster-nrpe\nRUN cd /tmp \\\n && wget -O mod-booster-nrpe.tar.gz https://github.com/shinken-monitoring/mod-booster-nrpe/archive/de7099706855e32c1962c77740be0fae446d15f5.tar.gz \\\n && tar -zxvf mod-booster-nrpe.tar.gz \\\n && mv /tmp/mod-booster-nrpe-*/module /var/lib/alignak/modules/mod-booster-nrpe \\\n && rm -rfv /tmp/mod-booster-nrpe*\n#   mod-surveil\nRUN pip install python-surveilclient==0.13.3\nRUN cd /tmp \\\n && wget -O mod-surveil-config.tar.gz https://github.com/Alignak-monitoring/mod-surveil/archive/fdc98b4fc036aa483ecb58459f11f9a87cf2254a.tar.gz \\\n && tar -zxvf mod-surveil-config.tar.gz \\\n && mv /tmp/mod-surveil-*/alignak/modules/mod_surveil /var/lib/alignak/modules/mod-surveil \\\n && rm -rfv /tmp/mod-surveil*\n#   mod-influxdb\nRUN pip install influxdb==2.8.0\nRUN cd /tmp \\\n && wget -O mod-influxdb.tar.gz https://github.com/savoirfairelinux/mod-influxdb/archive/9433b726492a09d5faeb70abfc5efdbf1728686f.tar.gz \\\n && tar -zxvf mod-influxdb.tar.gz \\\n && mv /tmp/mod-influxdb-*/module /var/lib/alignak/modules/mod-influxdb \\\n && rm -rfv /tmp/mod-influxdb*\n#   mod-ws-arbiter\nRUN cd /tmp \\\n && wget -O mod-ws-arbiter.tar.gz https://github.com/shinken-monitoring/mod-ws-arbiter/archive/ebae7950be9452ab80ec58575e9887d9b2a15d2a.tar.gz \\\n && tar -zxvf mod-ws-arbiter.tar.gz \\\n && mv /tmp/mod-ws-arbiter-*/module /var/lib/alignak/modules/ws-arbiter \\\n && rm -rfv /tmp/mod-ws-arbiter*\n#   mod-mongo-live-config\nRUN pip install pymongo==3.0.2\nRUN cd /tmp \\\n && wget -O mod-mongo-live-config.tar.gz https://github.com/savoirfairelinux/mod-mongo-live-config/archive/0.3.2.tar.gz \\\n && tar -zxvf mod-mongo-live-config.tar.gz \\\n && mv /tmp/mod-mongo-live-config-*/mod_mongo_live_config /var/lib/alignak/modules/mod_mongo_live_config \\\n && rm -rfv /tmp/mod-mongo-live-config*\n#   mod-ceilometer\nRUN apt-get update \\\n && apt-get install python-ceilometerclient -y\nRUN cd /tmp \\\n && wget -O mod-ceilometer.tar.gz https://github.com/savoirfairelinux/mod-ceilometer/archive/0.2.1.tar.gz \\\n && tar -zxvf mod-ceilometer.tar.gz \\\n && mv /tmp/mod-ceilometer-*/module /var/lib/alignak/modules/mod-ceilometer \\\n && rm -rfv /tmp/mod-ceilometer*\n#  # plugins\nRUN apt-get update \\\n && apt-get install nagios-plugins nagios-nrpe-plugin -y\n#   run permissions for user `alignak`\nRUN chmod u+s /usr/lib/nagios/plugins/check_icmp\nRUN chmod u+s /bin/ping\nRUN chmod u+s /bin/ping6\n#   Download plugins\nENV MONITORING_TOOLS_VERSION=\"0.4.1\"\nRUN apt-get update \\\n && apt-get install subversion -y \\\n && svn checkout https://github.com/savoirfairelinux/monitoring-tools/tags/${MONITORING_TOOLS_VERSION}/plugins/check-glance /plugins/check_glance \\\n && svn checkout https://github.com/savoirfairelinux/monitoring-tools/tags/${MONITORING_TOOLS_VERSION}/plugins/check-keystone /plugins/check_keystone \\\n && svn checkout https://github.com/savoirfairelinux/monitoring-tools/tags/${MONITORING_TOOLS_VERSION}/plugins/check-nova /plugins/check_nova \\\n && svn checkout https://github.com/savoirfairelinux/monitoring-tools/tags/${MONITORING_TOOLS_VERSION}/plugins/check-cinder /plugins/check_cinder \\\n && svn checkout https://github.com/savoirfairelinux/monitoring-tools/tags/${MONITORING_TOOLS_VERSION}/plugins/check-ceilometer /plugins/check_ceilometer \\\n && svn checkout https://github.com/savoirfairelinux/monitoring-tools/tags/${MONITORING_TOOLS_VERSION}/plugins/check-nova-host-status /plugins/check_nova_host_status \\\n && apt-get remove -y subversion\n#  # Install plugins dependencies\nRUN mkdir -p /opt/surveilplugins\nRUN virtualenv /opt/surveilplugins/env\nENV PATH=\"$PATH:/opt/surveilplugins/env/bin\"\nRUN /opt/surveilplugins/env/bin/pip install -U \"pbr>=1.3,<2.0\" shinkenplugins python-keystoneclient python-glanceclient\n#  # Install Plugins\nRUN mkdir -p /usr/lib/monitoring/plugins/sfl\nRUN cd /plugins/check_keystone \\\n && sudo /opt/surveilplugins/env/bin/python setup.py install \\\n && ln -s /opt/surveilplugins/env/bin/check_keystone /usr/lib/monitoring/plugins/sfl/\nRUN cd /plugins/check_glance \\\n && sudo /opt/surveilplugins/env/bin/python setup.py install \\\n && ln -s /opt/surveilplugins/env/bin/check_glance /usr/lib/monitoring/plugins/sfl/\nRUN cd /plugins/check_nova \\\n && sudo /opt/surveilplugins/env/bin/python setup.py install \\\n && ln -s /opt/surveilplugins/env/bin/check_nova /usr/lib/monitoring/plugins/sfl/\nRUN cd /plugins/check_cinder \\\n && sudo /opt/surveilplugins/env/bin/python setup.py install \\\n && ln -s /opt/surveilplugins/env/bin/check_cinder /usr/lib/monitoring/plugins/sfl/\nRUN cd /plugins/check_ceilometer \\\n && sudo /opt/surveilplugins/env/bin/python setup.py install \\\n && ln -s /opt/surveilplugins/env/bin/check_ceilometer /usr/lib/monitoring/plugins/sfl/\nRUN cd /plugins/check_nova_host_status \\\n && sudo /opt/surveilplugins/env/bin/python setup.py install \\\n && ln -s /opt/surveilplugins/env/bin/check_nova_host_status /usr/lib/monitoring/plugins/sfl/\n#  # Add check example plugin\nADD plugins/check-example /plugins/check_example\nRUN virtualenv /plugins/check_example/env\nENV PATH=\"$PATH:/plugins/check_example/env/bin\"\nRUN /plugins/check_example/env/bin/pip install -r /plugins/check_example/requirements.txt\nRUN cd /plugins/check_example \\\n && sudo /opt/surveilplugins/env/bin/python setup.py install \\\n && ln -s /opt/surveilplugins/env/bin/check_example /usr/lib/monitoring/plugins/sfl\n#  # configuration\nADD setup.sh /setup.sh\nRUN rm -rf /etc/alignak\nADD etc/alignak /etc/alignak\nRUN chown -R root:alignak /etc/alignak\n#  ## Supervisor\nADD etc/supervisor /etc/supervisor\n#   Alignak WEBUI\nEXPOSE 7767/tcp\n#   ws-arbiter\nEXPOSE 7760/tcp\n#   OpenStack Authentication credentials. Used for sending data to Ceilometer\nENV SURVEIL_OS_AUTH_URL=\"http://keystone:5000/v2.0\"\nENV SURVEIL_OS_USERNAME=\"admin\"\nENV SURVEIL_OS_PASSWORD=\"password\"\nENV SURVEIL_OS_TENANT_NAME=\"admin\"\nCMD ./setup.sh \\\n && /usr/bin/supervisord\n","originalDockerfileUglifiedHash":"3531dae6bfac2a6b974cc2b9734eab7c","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/82e1249792b0a821dd203d4d412fcb470a739c1a.dockerfile"}