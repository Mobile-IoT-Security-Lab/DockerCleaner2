{"seed":550704784,"processedDockerfileHash":"8efbe2078c6d2374db64da309e82cc33","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","have-a-healthcheck"],"processedDockerfile":"#   =================================================================\n#\n#   Authors: Ricardo Garcia Silva <ricardo.garcia.silva@gmail.com>\n#\n#   Copyright (c) 2017 Ricardo Garcia Silva\n#\n#   Permission is hereby granted, free of charge, to any person\n#   obtaining a copy of this software and associated documentation\n#   files (the \"Software\"), to deal in the Software without\n#   restriction, including without limitation the rights to use,\n#   copy, modify, merge, publish, distribute, sublicense, and/or sell\n#   copies of the Software, and to permit persons to whom the\n#   Software is furnished to do so, subject to the following\n#   conditions:\n#\n#   The above copyright notice and this permission notice shall be\n#   included in all copies or substantial portions of the Software.\n#\n#   THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n#   EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES\n#   OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n#   NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n#   HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\n#   WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n#   FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\n#   OTHER DEALINGS IN THE SOFTWARE.\n#\n#   =================================================================\nFROM alpine:3.4\n#   There's bug in libxml2 v2.9.4 that prevents using an XMLParser with a schema\n#   file.\n#\n#   https://bugzilla.gnome.org/show_bug.cgi?id=766834\n#\n#   It seems to have been fixed upstream, but the fix has not been released into\n#   a new libxml2 version. As a workaround, we are sticking with the previous\n#   version, which works fine.\n#   This means that we need to use alpine's archives for version 3.1, which are\n#   the ones that contain the previous version of libxml2\n#\n#   Also, for some unkwnon reason, alpine 3.1 version of libxml2 depends on\n#   python2. We'd rather use python3 for pycsw, so we install it too.\nRUN echo 'http://dl-cdn.alpinelinux.org/alpine/v3.1/main' >> /etc/apk/repositories \\\n && apk add build-base=0.4-r1 ca-certificates=20161130-r0 postgresql-dev=9.5.13-r0 python3=3.5.2-r2 python3-dev=3.5.2-r2 libpq=9.5.13-r0 libxslt-dev=1.1.29-r1 wget=1.18-r3 'libxml2<2.9.4' 'libxml2-dev<2.9.4' --no-cache \\\n && apk add geos geos-dev --no-cache --repository http://dl-3.alpinelinux.org/alpine/edge/testing/ --allow-untrusted\nRUN adduser -D -u 1000 pycsw\nWORKDIR /tmp/pycsw\nCOPY requirements-standalone.txt requirements-pg.txt requirements-dev.txt requirements.txt ./\nRUN pip3 install --upgrade pip setuptools \\\n && pip3 install --requirement requirements.txt \\\n && pip3 install --requirement requirements-standalone.txt \\\n && pip3 install --requirement requirements-pg.txt \\\n && pip3 install gunicorn\nCOPY pycsw pycsw/\nCOPY bin bin/\nCOPY setup.py .\nCOPY MANIFEST.in .\nCOPY VERSION.txt .\nCOPY README.rst .\nRUN pip3 install .\nCOPY tests tests/\nCOPY docker docker/\nENV PYCSW_CONFIG=\"/etc/pycsw/pycsw.cfg\"\nRUN mkdir /etc/pycsw \\\n && mv docker/pycsw.cfg ${PYCSW_CONFIG} \\\n && mkdir /var/lib/pycsw \\\n && chown pycsw:pycsw /var/lib/pycsw \\\n && cp docker/entrypoint.py /usr/local/bin/entrypoint.py \\\n && chmod a+x /usr/local/bin/entrypoint.py \\\n && cp -r tests /home/pycsw \\\n && cp requirements.txt /home/pycsw \\\n && cp requirements-standalone.txt /home/pycsw \\\n && cp requirements-pg.txt /home/pycsw \\\n && cp requirements-dev.txt /home/pycsw \\\n && chown -R pycsw:pycsw /home/pycsw/* \\\n && rm -rf *\nWORKDIR /home/pycsw\nUSER pycsw\nEXPOSE 8000/tcp\nENTRYPOINT [\"python3\", \"/usr/local/bin/entrypoint.py\"]\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  =================================================================\n#\n#  Authors: Ricardo Garcia Silva <ricardo.garcia.silva@gmail.com>\n#\n#  Copyright (c) 2017 Ricardo Garcia Silva\n#\n#  Permission is hereby granted, free of charge, to any person\n#  obtaining a copy of this software and associated documentation\n#  files (the \"Software\"), to deal in the Software without\n#  restriction, including without limitation the rights to use,\n#  copy, modify, merge, publish, distribute, sublicense, and/or sell\n#  copies of the Software, and to permit persons to whom the\n#  Software is furnished to do so, subject to the following\n#  conditions:\n#\n#  The above copyright notice and this permission notice shall be\n#  included in all copies or substantial portions of the Software.\n#\n#  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n#  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES\n#  OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n#  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n#  HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\n#  WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n#  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\n#  OTHER DEALINGS IN THE SOFTWARE.\n#\n#  =================================================================\nFROM alpine:3.4\n#  There's bug in libxml2 v2.9.4 that prevents using an XMLParser with a schema\n#  file.\n#\n#  https://bugzilla.gnome.org/show_bug.cgi?id=766834\n#\n#  It seems to have been fixed upstream, but the fix has not been released into\n#  a new libxml2 version. As a workaround, we are sticking with the previous\n#  version, which works fine.\n#  This means that we need to use alpine's archives for version 3.1, which are\n#  the ones that contain the previous version of libxml2\n#\n#  Also, for some unkwnon reason, alpine 3.1 version of libxml2 depends on\n#  python2. We'd rather use python3 for pycsw, so we install it too.\nRUN echo 'http://dl-cdn.alpinelinux.org/alpine/v3.1/main' >> /etc/apk/repositories \\\n && apk add --no-cache build-base ca-certificates postgresql-dev python3 python3-dev libpq libxslt-dev 'libxml2<2.9.4' 'libxml2-dev<2.9.4' wget \\\n && apk add --no-cache --repository http://dl-3.alpinelinux.org/alpine/edge/testing/ --allow-untrusted geos geos-dev\nRUN adduser -D -u 1000 pycsw\nWORKDIR /tmp/pycsw\nCOPY requirements-standalone.txt requirements-pg.txt requirements-dev.txt requirements.txt ./\nRUN pip3 install --upgrade pip setuptools \\\n && pip3 install --requirement requirements.txt \\\n && pip3 install --requirement requirements-standalone.txt \\\n && pip3 install --requirement requirements-pg.txt \\\n && pip3 install gunicorn\nCOPY pycsw pycsw/\nCOPY bin bin/\nCOPY setup.py .\nCOPY MANIFEST.in .\nCOPY VERSION.txt .\nCOPY README.rst .\nRUN pip3 install .\nCOPY tests tests/\nCOPY docker docker/\nENV PYCSW_CONFIG=\"/etc/pycsw/pycsw.cfg\"\nRUN mkdir /etc/pycsw \\\n && mv docker/pycsw.cfg ${PYCSW_CONFIG} \\\n && mkdir /var/lib/pycsw \\\n && chown pycsw:pycsw /var/lib/pycsw \\\n && cp docker/entrypoint.py /usr/local/bin/entrypoint.py \\\n && chmod a+x /usr/local/bin/entrypoint.py \\\n && cp -r tests /home/pycsw \\\n && cp requirements.txt /home/pycsw \\\n && cp requirements-standalone.txt /home/pycsw \\\n && cp requirements-pg.txt /home/pycsw \\\n && cp requirements-dev.txt /home/pycsw \\\n && chown -R pycsw:pycsw /home/pycsw/* \\\n && rm -rf *\nWORKDIR /home/pycsw\nUSER pycsw\nEXPOSE 8000/tcp\nENTRYPOINT [\"python3\", \"/usr/local/bin/entrypoint.py\"]\n","injectedSmells":[],"originalDockerfileHash":"b48cf12fb7b6898212e7afba20d31690","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   =================================================================\n#\n#   Authors: Ricardo Garcia Silva <ricardo.garcia.silva@gmail.com>\n#\n#   Copyright (c) 2017 Ricardo Garcia Silva\n#\n#   Permission is hereby granted, free of charge, to any person\n#   obtaining a copy of this software and associated documentation\n#   files (the \"Software\"), to deal in the Software without\n#   restriction, including without limitation the rights to use,\n#   copy, modify, merge, publish, distribute, sublicense, and/or sell\n#   copies of the Software, and to permit persons to whom the\n#   Software is furnished to do so, subject to the following\n#   conditions:\n#\n#   The above copyright notice and this permission notice shall be\n#   included in all copies or substantial portions of the Software.\n#\n#   THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n#   EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES\n#   OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n#   NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\n#   HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\n#   WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n#   FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\n#   OTHER DEALINGS IN THE SOFTWARE.\n#\n#   =================================================================\nFROM alpine:3.4\n#   There's bug in libxml2 v2.9.4 that prevents using an XMLParser with a schema\n#   file.\n#\n#   https://bugzilla.gnome.org/show_bug.cgi?id=766834\n#\n#   It seems to have been fixed upstream, but the fix has not been released into\n#   a new libxml2 version. As a workaround, we are sticking with the previous\n#   version, which works fine.\n#   This means that we need to use alpine's archives for version 3.1, which are\n#   the ones that contain the previous version of libxml2\n#\n#   Also, for some unkwnon reason, alpine 3.1 version of libxml2 depends on\n#   python2. We'd rather use python3 for pycsw, so we install it too.\nRUN echo 'http://dl-cdn.alpinelinux.org/alpine/v3.1/main' >> /etc/apk/repositories \\\n && apk add --no-cache build-base ca-certificates postgresql-dev python3 python3-dev libpq libxslt-dev 'libxml2<2.9.4' 'libxml2-dev<2.9.4' wget \\\n && apk add --no-cache --repository http://dl-3.alpinelinux.org/alpine/edge/testing/ --allow-untrusted geos geos-dev\nRUN adduser -D -u 1000 pycsw\nWORKDIR /tmp/pycsw\nCOPY requirements-standalone.txt requirements-pg.txt requirements-dev.txt requirements.txt ./\nRUN pip3 install --upgrade pip setuptools \\\n && pip3 install --requirement requirements.txt \\\n && pip3 install --requirement requirements-standalone.txt \\\n && pip3 install --requirement requirements-pg.txt \\\n && pip3 install gunicorn\nCOPY pycsw pycsw/\nCOPY bin bin/\nCOPY setup.py .\nCOPY MANIFEST.in .\nCOPY VERSION.txt .\nCOPY README.rst .\nRUN pip3 install .\nCOPY tests tests/\nCOPY docker docker/\nENV PYCSW_CONFIG=\"/etc/pycsw/pycsw.cfg\"\nRUN mkdir /etc/pycsw \\\n && mv docker/pycsw.cfg ${PYCSW_CONFIG} \\\n && mkdir /var/lib/pycsw \\\n && chown pycsw:pycsw /var/lib/pycsw \\\n && cp docker/entrypoint.py /usr/local/bin/entrypoint.py \\\n && chmod a+x /usr/local/bin/entrypoint.py \\\n && cp -r tests /home/pycsw \\\n && cp requirements.txt /home/pycsw \\\n && cp requirements-standalone.txt /home/pycsw \\\n && cp requirements-pg.txt /home/pycsw \\\n && cp requirements-dev.txt /home/pycsw \\\n && chown -R pycsw:pycsw /home/pycsw/* \\\n && rm -rf *\nWORKDIR /home/pycsw\nUSER pycsw\nEXPOSE 8000/tcp\nENTRYPOINT [\"python3\", \"/usr/local/bin/entrypoint.py\"]\n","originalDockerfileUglifiedHash":"80dcd188fa425597e5142274c31cc544","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/82ce805d13833370059afe28606fd0b67e600ffe.dockerfile"}