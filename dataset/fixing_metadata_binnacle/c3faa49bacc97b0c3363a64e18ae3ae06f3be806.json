{"seed":2844800242,"processedDockerfileHash":"07342b84f77b86276cfed57d3fd3d164","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apt-get","have-a-healthcheck"],"processedDockerfile":"FROM ubuntu:16.04\nRUN echo 'building CPU DeepDetect image'\nMAINTAINER Emmanuel Benazera \"beniz@droidnik.fr\"\nLABEL description=\"DeepDetect deep learning server & API / CPU version\"\nRUN ln -sf /dev/stdout /var/log/deepdetect.log\nRUN ln -sf /dev/stderr /var/log/deepdetect.log\nRUN useradd -ms /bin/bash dd\nRUN apt-get update \\\n && apt-get install --no-install-recommends git=1:2.7.4-0ubuntu1.10 cmake=3.5.1-1ubuntu3 automake=1:1.15-4ubuntu1 build-essential=12.1ubuntu2 openjdk-8-jdk=8u292-b10-0ubuntu1~16.04.1 pkg-config=0.29.1-0ubuntu1 zip=3.0-11 g++=4:5.3.1-1ubuntu1 zlib1g-dev=1:1.2.8.dfsg-2ubuntu4.3 libgoogle-glog-dev=0.3.4-0.1 libgflags-dev=2.1.2-3 libeigen3-dev=3.3~beta1-2 libopencv-dev=2.4.9.1+dfsg-1.5ubuntu1.1 libcppnetlib-dev=0.11.2+dfsg1-2 libboost-dev=1.58.0.1ubuntu1 libboost-iostreams-dev=1.58.0.1ubuntu1 libcurlpp-dev=0.7.3-6 libcurl4-openssl-dev=7.47.0-1ubuntu2.19 protobuf-compiler=2.6.1-1.3 libopenblas-dev=0.2.18-1ubuntu1 libhdf5-dev=1.8.16+docs-4ubuntu1.1 libprotobuf-dev=2.6.1-1.3 libleveldb-dev=1.18-5 libsnappy-dev=1.1.3-2 liblmdb-dev=0.9.17-3 libutfcpp-dev=2.3.4-1 wget=1.17.1-1ubuntu1.5 autoconf=2.69-9 libtool-bin=2.4.6-0.1 python-numpy=1:1.11.0-1ubuntu1 swig=3.0.8-0ubuntu3 python-dev=2.7.12-1~16.04 python-setuptools=20.7.0-1 python-wheel=0.29.0-1 unzip=6.0-20ubuntu1.1 libgoogle-perftools-dev=2.4-0ubuntu5.16.04.1 screen=4.3.1-2ubuntu0.1 vim=2:7.4.1689-3ubuntu1.5 strace=4.11-1ubuntu3 curl=7.47.0-1ubuntu2.19 libarchive-dev=3.1.2-11ubuntu0.16.04.8 bash-completion=1:2.1-4.2ubuntu1.1 libspdlog-dev=1.6-1 ca-certificates=20210119~16.04.1 -y \\\n && wget -O /tmp/bazel.deb https://github.com/bazelbuild/bazel/releases/download/0.8.1/bazel_0.8.1-linux-x86_64.deb \\\n && dpkg -i /tmp/bazel.deb \\\n && apt-get remove -y libcurlpp0 \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*\nWORKDIR /opt\nRUN wget -O /opt/curlpp-v0.8.1.zip https://github.com/jpbarrette/curlpp/archive/v0.8.1.zip \\\n && unzip curlpp-v0.8.1.zip \\\n && cd curlpp-0.8.1 \\\n && cmake . \\\n && make install \\\n && cp /usr/local/lib/libcurlpp.* /usr/lib/ \\\n && cd /opt \\\n && rm -rf curlpp-0.8.1 curlpp-v0.8.1.zip\nRUN git clone https://github.com/beniz/deepdetect.git \\\n && cd deepdetect \\\n && mkdir build\nWORKDIR /opt/deepdetect/build\nRUN cmake .. -DUSE_TF=ON -DUSE_TF_CPU_ONLY=ON -DUSE_SIMSEARCH=ON -DUSE_TSNE=ON -DUSE_NCNN=ON \\\n && make\n#   external volume to be mapped, e.g. for models or training data\nRUN mkdir /data\nVOLUME [\"/data\"]\n#   include a few image models within the image\nRUN mkdir /opt/models\nWORKDIR /opt/models\nRUN mkdir ggnet \\\n && cd ggnet \\\n && wget http://www.deepdetect.com/models/ggnet/bvlc_googlenet.caffemodel\nRUN mkdir resnet_50 \\\n && cd resnet_50 \\\n && wget http://www.deepdetect.com/models/resnet/ResNet-50-model.caffemodel \\\n && wget http://www.deepdetect.com/models/resnet/ResNet_mean.binaryproto\nRUN mv /opt/models/resnet_50/ResNet_mean.binaryproto /opt/models/resnet_50/mean.binaryproto\nRUN cp /opt/deepdetect/datasets/imagenet/corresp_ilsvrc12.txt /opt/models/ggnet/corresp.txt\nRUN cp /opt/deepdetect/datasets/imagenet/corresp_ilsvrc12.txt /opt/models/resnet_50/corresp.txt\nRUN cp /opt/deepdetect/templates/caffe/googlenet/*prototxt /opt/models/ggnet/\nRUN cp /opt/deepdetect/templates/caffe/resnet_50/*prototxt /opt/models/resnet_50/\n#   permissions\nRUN chown -R dd:dd /opt/deepdetect\nRUN chown -R dd:dd /opt/models\nUSER dd\nWORKDIR /opt/deepdetect/build/main\nCMD ./dede -host 0.0.0.0\nEXPOSE 8080/tcp\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM ubuntu:16.04\nRUN echo 'building CPU DeepDetect image'\nMAINTAINER Emmanuel Benazera \"beniz@droidnik.fr\"\nLABEL description=\"DeepDetect deep learning server & API / CPU version\"\nRUN ln -sf /dev/stdout /var/log/deepdetect.log\nRUN ln -sf /dev/stderr /var/log/deepdetect.log\nRUN useradd -ms /bin/bash dd\nRUN apt-get update \\\n && apt-get install --no-install-recommends git cmake automake build-essential openjdk-8-jdk pkg-config zip g++ zlib1g-dev libgoogle-glog-dev libgflags-dev libeigen3-dev libopencv-dev libcppnetlib-dev libboost-dev libboost-iostreams-dev libcurlpp-dev libcurl4-openssl-dev protobuf-compiler libopenblas-dev libhdf5-dev libprotobuf-dev libleveldb-dev libsnappy-dev liblmdb-dev libutfcpp-dev wget autoconf libtool-bin python-numpy swig python-dev python-setuptools python-wheel unzip libgoogle-perftools-dev screen vim strace curl libarchive-dev bash-completion libspdlog-dev ca-certificates -y \\\n && wget -O /tmp/bazel.deb https://github.com/bazelbuild/bazel/releases/download/0.8.1/bazel_0.8.1-linux-x86_64.deb \\\n && dpkg -i /tmp/bazel.deb \\\n && apt-get remove -y libcurlpp0 \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*\nWORKDIR /opt\nRUN wget -O /opt/curlpp-v0.8.1.zip https://github.com/jpbarrette/curlpp/archive/v0.8.1.zip \\\n && unzip curlpp-v0.8.1.zip \\\n && cd curlpp-0.8.1 \\\n && cmake . \\\n && make install \\\n && cp /usr/local/lib/libcurlpp.* /usr/lib/ \\\n && cd /opt \\\n && rm -rf curlpp-0.8.1 curlpp-v0.8.1.zip\nRUN git clone https://github.com/beniz/deepdetect.git \\\n && cd deepdetect \\\n && mkdir build\nWORKDIR /opt/deepdetect/build\nRUN cmake .. -DUSE_TF=ON -DUSE_TF_CPU_ONLY=ON -DUSE_SIMSEARCH=ON -DUSE_TSNE=ON -DUSE_NCNN=ON \\\n && make\n#  external volume to be mapped, e.g. for models or training data\nRUN mkdir /data\nVOLUME [\"/data\"]\n#  include a few image models within the image\nRUN mkdir /opt/models\nWORKDIR /opt/models\nRUN mkdir ggnet \\\n && cd ggnet \\\n && wget http://www.deepdetect.com/models/ggnet/bvlc_googlenet.caffemodel\nRUN mkdir resnet_50 \\\n && cd resnet_50 \\\n && wget http://www.deepdetect.com/models/resnet/ResNet-50-model.caffemodel \\\n && wget http://www.deepdetect.com/models/resnet/ResNet_mean.binaryproto\nRUN mv /opt/models/resnet_50/ResNet_mean.binaryproto /opt/models/resnet_50/mean.binaryproto\nRUN cp /opt/deepdetect/datasets/imagenet/corresp_ilsvrc12.txt /opt/models/ggnet/corresp.txt\nRUN cp /opt/deepdetect/datasets/imagenet/corresp_ilsvrc12.txt /opt/models/resnet_50/corresp.txt\nRUN cp /opt/deepdetect/templates/caffe/googlenet/*prototxt /opt/models/ggnet/\nRUN cp /opt/deepdetect/templates/caffe/resnet_50/*prototxt /opt/models/resnet_50/\n#  permissions\nRUN chown -R dd:dd /opt/deepdetect\nRUN chown -R dd:dd /opt/models\nUSER dd\nWORKDIR /opt/deepdetect/build/main\nCMD ./dede -host 0.0.0.0\nEXPOSE 8080/tcp\n","injectedSmells":[],"originalDockerfileHash":"ff00d5c0070421f5dfc7099aa99034f2","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM ubuntu:16.04\nRUN echo 'building CPU DeepDetect image'\nMAINTAINER Emmanuel Benazera \"beniz@droidnik.fr\"\nLABEL description=\"DeepDetect deep learning server & API / CPU version\"\nRUN ln -sf /dev/stdout /var/log/deepdetect.log\nRUN ln -sf /dev/stderr /var/log/deepdetect.log\nRUN useradd -ms /bin/bash dd\nRUN apt-get update \\\n && apt-get install --no-install-recommends git cmake automake build-essential openjdk-8-jdk pkg-config zip g++ zlib1g-dev libgoogle-glog-dev libgflags-dev libeigen3-dev libopencv-dev libcppnetlib-dev libboost-dev libboost-iostreams-dev libcurlpp-dev libcurl4-openssl-dev protobuf-compiler libopenblas-dev libhdf5-dev libprotobuf-dev libleveldb-dev libsnappy-dev liblmdb-dev libutfcpp-dev wget autoconf libtool-bin python-numpy swig python-dev python-setuptools python-wheel unzip libgoogle-perftools-dev screen vim strace curl libarchive-dev bash-completion libspdlog-dev ca-certificates -y \\\n && wget -O /tmp/bazel.deb https://github.com/bazelbuild/bazel/releases/download/0.8.1/bazel_0.8.1-linux-x86_64.deb \\\n && dpkg -i /tmp/bazel.deb \\\n && apt-get remove -y libcurlpp0 \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*\nWORKDIR /opt\nRUN wget -O /opt/curlpp-v0.8.1.zip https://github.com/jpbarrette/curlpp/archive/v0.8.1.zip \\\n && unzip curlpp-v0.8.1.zip \\\n && cd curlpp-0.8.1 \\\n && cmake . \\\n && make install \\\n && cp /usr/local/lib/libcurlpp.* /usr/lib/ \\\n && cd /opt \\\n && rm -rf curlpp-0.8.1 curlpp-v0.8.1.zip\nRUN git clone https://github.com/beniz/deepdetect.git \\\n && cd deepdetect \\\n && mkdir build\nWORKDIR /opt/deepdetect/build\nRUN cmake .. -DUSE_TF=ON -DUSE_TF_CPU_ONLY=ON -DUSE_SIMSEARCH=ON -DUSE_TSNE=ON -DUSE_NCNN=ON \\\n && make\n#   external volume to be mapped, e.g. for models or training data\nRUN mkdir /data\nVOLUME [\"/data\"]\n#   include a few image models within the image\nRUN mkdir /opt/models\nWORKDIR /opt/models\nRUN mkdir ggnet \\\n && cd ggnet \\\n && wget http://www.deepdetect.com/models/ggnet/bvlc_googlenet.caffemodel\nRUN mkdir resnet_50 \\\n && cd resnet_50 \\\n && wget http://www.deepdetect.com/models/resnet/ResNet-50-model.caffemodel \\\n && wget http://www.deepdetect.com/models/resnet/ResNet_mean.binaryproto\nRUN mv /opt/models/resnet_50/ResNet_mean.binaryproto /opt/models/resnet_50/mean.binaryproto\nRUN cp /opt/deepdetect/datasets/imagenet/corresp_ilsvrc12.txt /opt/models/ggnet/corresp.txt\nRUN cp /opt/deepdetect/datasets/imagenet/corresp_ilsvrc12.txt /opt/models/resnet_50/corresp.txt\nRUN cp /opt/deepdetect/templates/caffe/googlenet/*prototxt /opt/models/ggnet/\nRUN cp /opt/deepdetect/templates/caffe/resnet_50/*prototxt /opt/models/resnet_50/\n#   permissions\nRUN chown -R dd:dd /opt/deepdetect\nRUN chown -R dd:dd /opt/models\nUSER dd\nWORKDIR /opt/deepdetect/build/main\nCMD ./dede -host 0.0.0.0\nEXPOSE 8080/tcp\n","originalDockerfileUglifiedHash":"2e14d45c45b0358d2801b92bc566426d","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/c3faa49bacc97b0c3363a64e18ae3ae06f3be806.dockerfile"}