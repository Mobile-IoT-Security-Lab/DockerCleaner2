{"seed":4082091331,"processedDockerfileHash":"fa93c0a5a2c9cda33a3d0798604ddb1c","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-pip","have-a-healthcheck","have-a-user"],"processedDockerfile":"#  mcr.microsoft.com/aiforearth/base-r:version\nFROM nvidia/cuda:9.2-runtime-ubuntu16.04\nARG DEBIAN_FRONTEND=noninteractive\nRUN mkdir /var/uwsgi\nRUN apt-get update \\\n && (apt-get update ;apt-get install --no-install-recommends python3-pip python3-dev -y ) \\\n && cd /usr/local/bin \\\n && ln -s /usr/bin/python3 python \\\n && pip3 install --upgrade pip\nRUN apt-get update --fix-missing \\\n && (apt-get update ;apt-get install --no-install-recommends wget supervisor bzip2 -y ) \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/*\nENV GDAL_VERSION=\"2.2.1\"\nRUN apt-get update \\\n && (apt-get update ;apt-get install --no-install-recommends libpq-dev ogdi-bin libogdi3.2-dev libjasper-runtime libjasper-dev libjasper1 libgeos-dev libproj-dev libpoppler-dev libsqlite3-dev libspatialite-dev python3 python3-dev python3-numpy -y )\nRUN wget http://download.osgeo.org/gdal/$GDAL_VERSION/gdal-${GDAL_VERSION}.tar.gz -O /tmp/gdal-${GDAL_VERSION}.tar.gz \\\n && tar -x -f /tmp/gdal-${GDAL_VERSION}.tar.gz -C /tmp\nRUN tar -xvf /tmp/gdal-${GDAL_VERSION}.tar.gz \\\n && cd /tmp/gdal-${GDAL_VERSION} \\\n && ./configure \\\n && make \\\n && make install \\\n && ldconfig \\\n && : \\\n && apt-get remove -y --purge build-essential wget \\\n && rm -Rf $ROOTDIR/src/*\nRUN rm /tmp/gdal-${GDAL_VERSION} -rf\nCMD gdalinfo --version \\\n && gdalinfo --formats \\\n && ogrinfo --formats\nRUN apt-get update \\\n && (apt-get update ;apt-get install --no-install-recommends apt-transport-https build-essential ed gtk2.0 libcurl4-openssl-dev libgtk2.0-dev libiodbc2-dev libnlopt-dev libssh2-1-dev libssl-dev libxml2-dev software-properties-common wget xvfb -y ) \\\n && rm -rf /var/lib/apt/lists/*\nRUN apt-key adv --keyserver keyserver.ubuntu.com --recv-keys E298A3A825C0D65DFD57CBB651716619E084DAB9\nRUN add-apt-repository 'deb [arch=amd64,i386] https://cran.rstudio.com/bin/linux/ubuntu xenial/'\nRUN apt-get update \\\n && (apt-get update ;apt-get install --no-install-recommends r-base r-base-dev r-recommended -y )\nRUN apt-get update -qq \\\n && (apt-get update ;apt-get install --no-install-recommends git-core libssl-dev libcurl4-gnutls-dev -y )\n#   Install data_processing packages\nRUN apt-get update \\\n && (apt-get update ;apt-get install --no-install-recommends libgdal-dev libproj-dev -y )\nRUN echo \"r <- getOption('repos'); r['CRAN'] <- 'http://cran.r-project.org'; options(repos = r);\" > ~/.Rprofile\n#  RUN Rscript -e 'remove.packages(c(\"curl\",\"httr\"));'\nRUN Rscript -e 'install.packages(c(\"curl\", \"httr\"));'\nRUN Rscript -e 'Sys.setenv(CURL_CA_BUNDLE=\"/utils/microsoft-r-open-3.4.3/lib64/R/lib/microsoft-r-cacert.pem\");'\nRUN Rscript -e 'install.packages(\"sp\");'\nRUN Rscript -e 'install.packages(\"rgdal\");'\nRUN Rscript -e 'install.packages(\"plumber\");'\nRUN Rscript -e 'install.packages(\"R.utils\");'\nRUN Rscript -e 'install.packages(\"future\");'\nRUN Rscript -e 'install.packages(\"devtools\");'\nRUN Rscript -e 'install.packages(\"RCurl\");'\nRUN Rscript -e 'install.packages(\"sjmisc\");'\nRUN Rscript -e 'install.packages(\"reticulate\");'\n#   Install Azure Blob SDK and application insights\nRUN pip install azure==5.0.0\nRUN pip install azure-storage-common==2.1.0\nRUN pip install azure-storage-blob==12.16.0\nRUN pip install adal==1.2.7\nRUN pip install applicationinsights==0.11.10\nCOPY ./base-r/ai4e_api_tools /ai4e_api_tools/\nCOPY ./common/sas_blob.py /ai4e_api_tools/\nCOPY ./common/aad_blob.py /ai4e_api_tools/\nENV PYTHONPATH=\"${PYTHONPATH}:/ai4e_api_tools\"\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"# mcr.microsoft.com/aiforearth/base-r:version\nFROM nvidia/cuda:9.2-runtime-ubuntu16.04\nARG DEBIAN_FRONTEND=noninteractive\nRUN mkdir /var/uwsgi\nRUN apt-get update \\\n && apt-get install python3-pip python3-dev -y \\\n && cd /usr/local/bin \\\n && ln -s /usr/bin/python3 python \\\n && pip3 install --upgrade pip\nRUN apt-get update --fix-missing \\\n && apt-get install wget supervisor bzip2 -y \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/*\nENV GDAL_VERSION=\"2.2.1\"\nRUN apt-get update \\\n && apt-get install libpq-dev ogdi-bin libogdi3.2-dev libjasper-runtime libjasper-dev libjasper1 libgeos-dev libproj-dev libpoppler-dev libsqlite3-dev libspatialite-dev python3 python3-dev python3-numpy -y\nRUN wget http://download.osgeo.org/gdal/$GDAL_VERSION/gdal-${GDAL_VERSION}.tar.gz -O /tmp/gdal-${GDAL_VERSION}.tar.gz \\\n && tar -x -f /tmp/gdal-${GDAL_VERSION}.tar.gz -C /tmp\nRUN tar -xvf /tmp/gdal-${GDAL_VERSION}.tar.gz \\\n && cd /tmp/gdal-${GDAL_VERSION} \\\n && ./configure \\\n && make \\\n && make install \\\n && ldconfig \\\n && apt-get update -y \\\n && apt-get remove -y --purge build-essential wget \\\n && rm -Rf $ROOTDIR/src/*\nRUN rm /tmp/gdal-${GDAL_VERSION} -rf\nCMD gdalinfo --version \\\n && gdalinfo --formats \\\n && ogrinfo --formats\nRUN apt-get update \\\n && apt-get install apt-transport-https build-essential ed gtk2.0 libcurl4-openssl-dev libgtk2.0-dev libiodbc2-dev libnlopt-dev libssh2-1-dev libssl-dev libxml2-dev software-properties-common wget xvfb -y \\\n && rm -rf /var/lib/apt/lists/*\nRUN apt-key adv --keyserver keyserver.ubuntu.com --recv-keys E298A3A825C0D65DFD57CBB651716619E084DAB9\nRUN add-apt-repository 'deb [arch=amd64,i386] https://cran.rstudio.com/bin/linux/ubuntu xenial/'\nRUN apt-get update \\\n && apt-get install --no-install-recommends r-base r-base-dev r-recommended -y\nRUN apt-get update -qq \\\n && apt-get install git-core libssl-dev libcurl4-gnutls-dev -y\n#  Install data_processing packages\nRUN apt-get update \\\n && apt-get install libgdal-dev libproj-dev -y\nRUN echo \"r <- getOption('repos'); r['CRAN'] <- 'http://cran.r-project.org'; options(repos = r);\" > ~/.Rprofile\n# RUN Rscript -e 'remove.packages(c(\"curl\",\"httr\"));'\nRUN Rscript -e 'install.packages(c(\"curl\", \"httr\"));'\nRUN Rscript -e 'Sys.setenv(CURL_CA_BUNDLE=\"/utils/microsoft-r-open-3.4.3/lib64/R/lib/microsoft-r-cacert.pem\");'\nRUN Rscript -e 'install.packages(\"sp\");'\nRUN Rscript -e 'install.packages(\"rgdal\");'\nRUN Rscript -e 'install.packages(\"plumber\");'\nRUN Rscript -e 'install.packages(\"R.utils\");'\nRUN Rscript -e 'install.packages(\"future\");'\nRUN Rscript -e 'install.packages(\"devtools\");'\nRUN Rscript -e 'install.packages(\"RCurl\");'\nRUN Rscript -e 'install.packages(\"sjmisc\");'\nRUN Rscript -e 'install.packages(\"reticulate\");'\n#  Install Azure Blob SDK and application insights\nRUN pip install azure\nRUN pip install azure-storage-common\nRUN pip install azure-storage-blob\nRUN pip install adal\nRUN pip install applicationinsights\nCOPY ./base-r/ai4e_api_tools /ai4e_api_tools/\nCOPY ./common/sas_blob.py /ai4e_api_tools/\nCOPY ./common/aad_blob.py /ai4e_api_tools/\nENV PYTHONPATH=\"${PYTHONPATH}:/ai4e_api_tools\"\n","injectedSmells":[],"originalDockerfileHash":"480ebce1ffef09eda31140a5f34fc543","successfullyInjectedSmells":[],"originalDockerfileUglified":"#  mcr.microsoft.com/aiforearth/base-r:version\nFROM nvidia/cuda:9.2-runtime-ubuntu16.04\nARG DEBIAN_FRONTEND=noninteractive\nRUN mkdir /var/uwsgi\nRUN apt-get update \\\n && apt-get install python3-pip python3-dev -y \\\n && cd /usr/local/bin \\\n && ln -s /usr/bin/python3 python \\\n && pip3 install --upgrade pip\nRUN apt-get update --fix-missing \\\n && apt-get install wget supervisor bzip2 -y \\\n && apt-get clean \\\n && rm -rf /var/lib/apt/lists/*\nENV GDAL_VERSION=\"2.2.1\"\nRUN apt-get update \\\n && apt-get install libpq-dev ogdi-bin libogdi3.2-dev libjasper-runtime libjasper-dev libjasper1 libgeos-dev libproj-dev libpoppler-dev libsqlite3-dev libspatialite-dev python3 python3-dev python3-numpy -y\nRUN wget http://download.osgeo.org/gdal/$GDAL_VERSION/gdal-${GDAL_VERSION}.tar.gz -O /tmp/gdal-${GDAL_VERSION}.tar.gz \\\n && tar -x -f /tmp/gdal-${GDAL_VERSION}.tar.gz -C /tmp\nRUN tar -xvf /tmp/gdal-${GDAL_VERSION}.tar.gz \\\n && cd /tmp/gdal-${GDAL_VERSION} \\\n && ./configure \\\n && make \\\n && make install \\\n && ldconfig \\\n && apt-get update -y \\\n && apt-get remove -y --purge build-essential wget \\\n && rm -Rf $ROOTDIR/src/*\nRUN rm /tmp/gdal-${GDAL_VERSION} -rf\nCMD gdalinfo --version \\\n && gdalinfo --formats \\\n && ogrinfo --formats\nRUN apt-get update \\\n && apt-get install apt-transport-https build-essential ed gtk2.0 libcurl4-openssl-dev libgtk2.0-dev libiodbc2-dev libnlopt-dev libssh2-1-dev libssl-dev libxml2-dev software-properties-common wget xvfb -y \\\n && rm -rf /var/lib/apt/lists/*\nRUN apt-key adv --keyserver keyserver.ubuntu.com --recv-keys E298A3A825C0D65DFD57CBB651716619E084DAB9\nRUN add-apt-repository 'deb [arch=amd64,i386] https://cran.rstudio.com/bin/linux/ubuntu xenial/'\nRUN apt-get update \\\n && apt-get install --no-install-recommends r-base r-base-dev r-recommended -y\nRUN apt-get update -qq \\\n && apt-get install git-core libssl-dev libcurl4-gnutls-dev -y\n#   Install data_processing packages\nRUN apt-get update \\\n && apt-get install libgdal-dev libproj-dev -y\nRUN echo \"r <- getOption('repos'); r['CRAN'] <- 'http://cran.r-project.org'; options(repos = r);\" > ~/.Rprofile\n#  RUN Rscript -e 'remove.packages(c(\"curl\",\"httr\"));'\nRUN Rscript -e 'install.packages(c(\"curl\", \"httr\"));'\nRUN Rscript -e 'Sys.setenv(CURL_CA_BUNDLE=\"/utils/microsoft-r-open-3.4.3/lib64/R/lib/microsoft-r-cacert.pem\");'\nRUN Rscript -e 'install.packages(\"sp\");'\nRUN Rscript -e 'install.packages(\"rgdal\");'\nRUN Rscript -e 'install.packages(\"plumber\");'\nRUN Rscript -e 'install.packages(\"R.utils\");'\nRUN Rscript -e 'install.packages(\"future\");'\nRUN Rscript -e 'install.packages(\"devtools\");'\nRUN Rscript -e 'install.packages(\"RCurl\");'\nRUN Rscript -e 'install.packages(\"sjmisc\");'\nRUN Rscript -e 'install.packages(\"reticulate\");'\n#   Install Azure Blob SDK and application insights\nRUN pip install azure\nRUN pip install azure-storage-common\nRUN pip install azure-storage-blob\nRUN pip install adal\nRUN pip install applicationinsights\nCOPY ./base-r/ai4e_api_tools /ai4e_api_tools/\nCOPY ./common/sas_blob.py /ai4e_api_tools/\nCOPY ./common/aad_blob.py /ai4e_api_tools/\nENV PYTHONPATH=\"${PYTHONPATH}:/ai4e_api_tools\"\n","originalDockerfileUglifiedHash":"3787c72ef7dc1d2ca8f91601a5b15518","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/ac5f95b9470ba21e1b8afdf880313c6ee4b454e4.dockerfile"}