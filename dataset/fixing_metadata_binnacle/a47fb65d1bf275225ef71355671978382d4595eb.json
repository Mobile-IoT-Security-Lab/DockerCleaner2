{"seed":1257720500,"processedDockerfileHash":"1c6da58fc0b94b3566f9f201e8b639e2","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","have-a-healthcheck"],"processedDockerfile":"FROM blacklabelops/java:openjre.8\nMAINTAINER Steffen Bleul <sbl@blacklabelops.com>\nARG BITBUCKET_VERSION=5.16.0\n#   permissions\nARG CONTAINER_UID=1000\nARG CONTAINER_GID=1000\nENV BITBUCKET_HOME=\"/var/atlassian/bitbucket\" \\\n    BITBUCKET_INSTALL=\"/opt/bitbucket\" \\\n    BITBUCKET_PROXY_NAME=\"\" \\\n    BITBUCKET_PROXY_PORT=\"\" \\\n    BITBUCKET_PROXY_SCHEME=\"\" \\\n    BITBUCKET_BACKUP_CLIENT=\"/opt/backupclient/bitbucket-backup-client\" \\\n    BITBUCKET_BACKUP_CLIENT_HOME=\"/opt/backupclient\" \\\n    BITBUCKET_BACKUP_CLIENT_VERSION=\"300300300\"\nRUN export MYSQL_DRIVER_VERSION=5.1.47 \\\n && export CONTAINER_USER=bitbucket \\\n && export CONTAINER_GROUP=bitbucket \\\n && addgroup -g $CONTAINER_GID $CONTAINER_GROUP \\\n && adduser -u $CONTAINER_UID -G $CONTAINER_GROUP -h /home/$CONTAINER_USER -s /bin/bash -S $CONTAINER_USER \\\n && apk add ca-certificates gzip curl openssh util-linux git perl wget ttf-dejavu git-daemon --update \\\n && export XMLSTARLET_VERSION=1.6.1-r1 \\\n && wget --directory-prefix=/tmp https://github.com/menski/alpine-pkg-xmlstarlet/releases/download/${XMLSTARLET_VERSION}/xmlstarlet-${XMLSTARLET_VERSION}.apk \\\n && apk add /tmp/xmlstarlet-${XMLSTARLET_VERSION}.apk --allow-untrusted \\\n && wget -O /tmp/bitbucket.tar.gz https://www.atlassian.com/software/stash/downloads/binary/atlassian-bitbucket-${BITBUCKET_VERSION}.tar.gz \\\n && tar zxf /tmp/bitbucket.tar.gz -C /tmp \\\n && mv /tmp/atlassian-bitbucket-${BITBUCKET_VERSION} /tmp/bitbucket \\\n && mkdir -p ${BITBUCKET_HOME} \\\n && mkdir -p /opt \\\n && mv /tmp/bitbucket /opt/bitbucket \\\n && rm -f ${BITBUCKET_INSTALL}/lib/mysql-connector-java*.jar \\\n && wget -O /tmp/mysql-connector-java-${MYSQL_DRIVER_VERSION}.tar.gz http://dev.mysql.com/get/Downloads/Connector-J/mysql-connector-java-${MYSQL_DRIVER_VERSION}.tar.gz \\\n && tar xzf /tmp/mysql-connector-java-${MYSQL_DRIVER_VERSION}.tar.gz -C /tmp \\\n && cp /tmp/mysql-connector-java-${MYSQL_DRIVER_VERSION}/mysql-connector-java-${MYSQL_DRIVER_VERSION}-bin.jar ${BITBUCKET_INSTALL}/lib/mysql-connector-java-${MYSQL_DRIVER_VERSION}-bin.jar \\\n && export KEYSTORE=$JAVA_HOME/jre/lib/security/cacerts \\\n && wget -P /tmp/ https://letsencrypt.org/certs/lets-encrypt-x1-cross-signed.der \\\n && wget -P /tmp/ https://letsencrypt.org/certs/lets-encrypt-x2-cross-signed.der \\\n && wget -P /tmp/ https://letsencrypt.org/certs/lets-encrypt-x3-cross-signed.der \\\n && wget -P /tmp/ https://letsencrypt.org/certs/lets-encrypt-x4-cross-signed.der \\\n && keytool -trustcacerts -keystore $KEYSTORE -storepass changeit -noprompt -importcert -alias letsencryptauthorityx1 -file /tmp/lets-encrypt-x1-cross-signed.der \\\n && keytool -trustcacerts -keystore $KEYSTORE -storepass changeit -noprompt -importcert -alias letsencryptauthorityx2 -file /tmp/lets-encrypt-x2-cross-signed.der \\\n && keytool -trustcacerts -keystore $KEYSTORE -storepass changeit -noprompt -importcert -alias letsencryptauthorityx3 -file /tmp/lets-encrypt-x3-cross-signed.der \\\n && keytool -trustcacerts -keystore $KEYSTORE -storepass changeit -noprompt -importcert -alias letsencryptauthorityx4 -file /tmp/lets-encrypt-x4-cross-signed.der \\\n && wget -O /home/${CONTAINER_USER}/SSLPoke.class https://confluence.atlassian.com/kb/files/779355358/779355357/1/1441897666313/SSLPoke.class \\\n && chown -R bitbucket:bitbucket /home/${CONTAINER_USER} \\\n && chown -R bitbucket:bitbucket ${BITBUCKET_HOME} \\\n && chown -R bitbucket:bitbucket ${BITBUCKET_INSTALL}\nRUN mkdir -p ${BITBUCKET_BACKUP_CLIENT_HOME} \\\n && wget -O /tmp/bitbucket-backup-distribution.zip https://marketplace.atlassian.com/download/plugins/com.atlassian.stash.backup.client/version/${BITBUCKET_BACKUP_CLIENT_VERSION} \\\n && unzip -d ${BITBUCKET_BACKUP_CLIENT_HOME} /tmp/bitbucket-backup-distribution.zip \\\n && mv /opt/backupclient/$( ls /opt/backupclient/ ;) /opt/backupclient/bitbucket-backup-client \\\n && chown -R bitbucket:bitbucket ${BITBUCKET_BACKUP_CLIENT_HOME}\n#   Remove obsolete packages\nRUN apk del ca-certificates gzip util-linux wget \\\n && rm -rf /var/cache/apk/* \\\n && rm -rf /tmp/* \\\n && rm -rf /var/log/*\nUSER bitbucket\nWORKDIR /var/atlassian/bitbucket\nVOLUME [\"/var/atlassian/bitbucket\"]\nEXPOSE 7990/tcp 7990/tcp\nEXPOSE 7999/tcp 7999/tcp\nEXPOSE 7992/tcp 7992/tcp\nCOPY imagescripts/docker-entrypoint.sh /home/bitbucket/\nCOPY imagescripts/ps_opt_p_enabled_for_alpine.sh /usr/bin/ps\nENTRYPOINT [\"/sbin/tini\", \"--\", \"/home/bitbucket/docker-entrypoint.sh\"]\nCMD [\"bitbucket\"]\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM blacklabelops/java:openjre.8\nMAINTAINER Steffen Bleul <sbl@blacklabelops.com>\nARG BITBUCKET_VERSION=5.16.0\n#  permissions\nARG CONTAINER_UID=1000\nARG CONTAINER_GID=1000\nENV BITBUCKET_HOME=\"/var/atlassian/bitbucket\" \\\n    BITBUCKET_INSTALL=\"/opt/bitbucket\" \\\n    BITBUCKET_PROXY_NAME=\"\" \\\n    BITBUCKET_PROXY_PORT=\"\" \\\n    BITBUCKET_PROXY_SCHEME=\"\" \\\n    BITBUCKET_BACKUP_CLIENT=\"/opt/backupclient/bitbucket-backup-client\" \\\n    BITBUCKET_BACKUP_CLIENT_HOME=\"/opt/backupclient\" \\\n    BITBUCKET_BACKUP_CLIENT_VERSION=\"300300300\"\nRUN export MYSQL_DRIVER_VERSION=5.1.47 \\\n && export CONTAINER_USER=bitbucket \\\n && export CONTAINER_GROUP=bitbucket \\\n && addgroup -g $CONTAINER_GID $CONTAINER_GROUP \\\n && adduser -u $CONTAINER_UID -G $CONTAINER_GROUP -h /home/$CONTAINER_USER -s /bin/bash -S $CONTAINER_USER \\\n && apk add --update ca-certificates gzip curl openssh util-linux git perl wget ttf-dejavu git-daemon \\\n && export XMLSTARLET_VERSION=1.6.1-r1 \\\n && wget --directory-prefix=/tmp https://github.com/menski/alpine-pkg-xmlstarlet/releases/download/${XMLSTARLET_VERSION}/xmlstarlet-${XMLSTARLET_VERSION}.apk \\\n && apk add --allow-untrusted /tmp/xmlstarlet-${XMLSTARLET_VERSION}.apk \\\n && wget -O /tmp/bitbucket.tar.gz https://www.atlassian.com/software/stash/downloads/binary/atlassian-bitbucket-${BITBUCKET_VERSION}.tar.gz \\\n && tar zxf /tmp/bitbucket.tar.gz -C /tmp \\\n && mv /tmp/atlassian-bitbucket-${BITBUCKET_VERSION} /tmp/bitbucket \\\n && mkdir -p ${BITBUCKET_HOME} \\\n && mkdir -p /opt \\\n && mv /tmp/bitbucket /opt/bitbucket \\\n && rm -f ${BITBUCKET_INSTALL}/lib/mysql-connector-java*.jar \\\n && wget -O /tmp/mysql-connector-java-${MYSQL_DRIVER_VERSION}.tar.gz http://dev.mysql.com/get/Downloads/Connector-J/mysql-connector-java-${MYSQL_DRIVER_VERSION}.tar.gz \\\n && tar xzf /tmp/mysql-connector-java-${MYSQL_DRIVER_VERSION}.tar.gz -C /tmp \\\n && cp /tmp/mysql-connector-java-${MYSQL_DRIVER_VERSION}/mysql-connector-java-${MYSQL_DRIVER_VERSION}-bin.jar ${BITBUCKET_INSTALL}/lib/mysql-connector-java-${MYSQL_DRIVER_VERSION}-bin.jar \\\n && export KEYSTORE=$JAVA_HOME/jre/lib/security/cacerts \\\n && wget -P /tmp/ https://letsencrypt.org/certs/lets-encrypt-x1-cross-signed.der \\\n && wget -P /tmp/ https://letsencrypt.org/certs/lets-encrypt-x2-cross-signed.der \\\n && wget -P /tmp/ https://letsencrypt.org/certs/lets-encrypt-x3-cross-signed.der \\\n && wget -P /tmp/ https://letsencrypt.org/certs/lets-encrypt-x4-cross-signed.der \\\n && keytool -trustcacerts -keystore $KEYSTORE -storepass changeit -noprompt -importcert -alias letsencryptauthorityx1 -file /tmp/lets-encrypt-x1-cross-signed.der \\\n && keytool -trustcacerts -keystore $KEYSTORE -storepass changeit -noprompt -importcert -alias letsencryptauthorityx2 -file /tmp/lets-encrypt-x2-cross-signed.der \\\n && keytool -trustcacerts -keystore $KEYSTORE -storepass changeit -noprompt -importcert -alias letsencryptauthorityx3 -file /tmp/lets-encrypt-x3-cross-signed.der \\\n && keytool -trustcacerts -keystore $KEYSTORE -storepass changeit -noprompt -importcert -alias letsencryptauthorityx4 -file /tmp/lets-encrypt-x4-cross-signed.der \\\n && wget -O /home/${CONTAINER_USER}/SSLPoke.class https://confluence.atlassian.com/kb/files/779355358/779355357/1/1441897666313/SSLPoke.class \\\n && chown -R bitbucket:bitbucket /home/${CONTAINER_USER} \\\n && chown -R bitbucket:bitbucket ${BITBUCKET_HOME} \\\n && chown -R bitbucket:bitbucket ${BITBUCKET_INSTALL}\nRUN mkdir -p ${BITBUCKET_BACKUP_CLIENT_HOME} \\\n && wget -O /tmp/bitbucket-backup-distribution.zip https://marketplace.atlassian.com/download/plugins/com.atlassian.stash.backup.client/version/${BITBUCKET_BACKUP_CLIENT_VERSION} \\\n && unzip -d ${BITBUCKET_BACKUP_CLIENT_HOME} /tmp/bitbucket-backup-distribution.zip \\\n && mv /opt/backupclient/$( ls /opt/backupclient/ ;) /opt/backupclient/bitbucket-backup-client \\\n && chown -R bitbucket:bitbucket ${BITBUCKET_BACKUP_CLIENT_HOME}\n#  Remove obsolete packages\nRUN apk del ca-certificates gzip util-linux wget \\\n && rm -rf /var/cache/apk/* \\\n && rm -rf /tmp/* \\\n && rm -rf /var/log/*\nUSER bitbucket\nWORKDIR /var/atlassian/bitbucket\nVOLUME [\"/var/atlassian/bitbucket\"]\nEXPOSE 7990/tcp 7990/tcp\nEXPOSE 7999/tcp 7999/tcp\nEXPOSE 7992/tcp 7992/tcp\nCOPY imagescripts/docker-entrypoint.sh /home/bitbucket/\nCOPY imagescripts/ps_opt_p_enabled_for_alpine.sh /usr/bin/ps\nENTRYPOINT [\"/sbin/tini\", \"--\", \"/home/bitbucket/docker-entrypoint.sh\"]\nCMD [\"bitbucket\"]\n","injectedSmells":[],"originalDockerfileHash":"328b619f710d891c5e17a0d34af74ab4","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM blacklabelops/java:openjre.8\nMAINTAINER Steffen Bleul <sbl@blacklabelops.com>\nARG BITBUCKET_VERSION=5.16.0\n#   permissions\nARG CONTAINER_UID=1000\nARG CONTAINER_GID=1000\nENV BITBUCKET_HOME=\"/var/atlassian/bitbucket\" \\\n    BITBUCKET_INSTALL=\"/opt/bitbucket\" \\\n    BITBUCKET_PROXY_NAME=\"\" \\\n    BITBUCKET_PROXY_PORT=\"\" \\\n    BITBUCKET_PROXY_SCHEME=\"\" \\\n    BITBUCKET_BACKUP_CLIENT=\"/opt/backupclient/bitbucket-backup-client\" \\\n    BITBUCKET_BACKUP_CLIENT_HOME=\"/opt/backupclient\" \\\n    BITBUCKET_BACKUP_CLIENT_VERSION=\"300300300\"\nRUN export MYSQL_DRIVER_VERSION=5.1.47 \\\n && export CONTAINER_USER=bitbucket \\\n && export CONTAINER_GROUP=bitbucket \\\n && addgroup -g $CONTAINER_GID $CONTAINER_GROUP \\\n && adduser -u $CONTAINER_UID -G $CONTAINER_GROUP -h /home/$CONTAINER_USER -s /bin/bash -S $CONTAINER_USER \\\n && apk add --update ca-certificates gzip curl openssh util-linux git perl wget ttf-dejavu git-daemon \\\n && export XMLSTARLET_VERSION=1.6.1-r1 \\\n && wget --directory-prefix=/tmp https://github.com/menski/alpine-pkg-xmlstarlet/releases/download/${XMLSTARLET_VERSION}/xmlstarlet-${XMLSTARLET_VERSION}.apk \\\n && apk add --allow-untrusted /tmp/xmlstarlet-${XMLSTARLET_VERSION}.apk \\\n && wget -O /tmp/bitbucket.tar.gz https://www.atlassian.com/software/stash/downloads/binary/atlassian-bitbucket-${BITBUCKET_VERSION}.tar.gz \\\n && tar zxf /tmp/bitbucket.tar.gz -C /tmp \\\n && mv /tmp/atlassian-bitbucket-${BITBUCKET_VERSION} /tmp/bitbucket \\\n && mkdir -p ${BITBUCKET_HOME} \\\n && mkdir -p /opt \\\n && mv /tmp/bitbucket /opt/bitbucket \\\n && rm -f ${BITBUCKET_INSTALL}/lib/mysql-connector-java*.jar \\\n && wget -O /tmp/mysql-connector-java-${MYSQL_DRIVER_VERSION}.tar.gz http://dev.mysql.com/get/Downloads/Connector-J/mysql-connector-java-${MYSQL_DRIVER_VERSION}.tar.gz \\\n && tar xzf /tmp/mysql-connector-java-${MYSQL_DRIVER_VERSION}.tar.gz -C /tmp \\\n && cp /tmp/mysql-connector-java-${MYSQL_DRIVER_VERSION}/mysql-connector-java-${MYSQL_DRIVER_VERSION}-bin.jar ${BITBUCKET_INSTALL}/lib/mysql-connector-java-${MYSQL_DRIVER_VERSION}-bin.jar \\\n && export KEYSTORE=$JAVA_HOME/jre/lib/security/cacerts \\\n && wget -P /tmp/ https://letsencrypt.org/certs/lets-encrypt-x1-cross-signed.der \\\n && wget -P /tmp/ https://letsencrypt.org/certs/lets-encrypt-x2-cross-signed.der \\\n && wget -P /tmp/ https://letsencrypt.org/certs/lets-encrypt-x3-cross-signed.der \\\n && wget -P /tmp/ https://letsencrypt.org/certs/lets-encrypt-x4-cross-signed.der \\\n && keytool -trustcacerts -keystore $KEYSTORE -storepass changeit -noprompt -importcert -alias letsencryptauthorityx1 -file /tmp/lets-encrypt-x1-cross-signed.der \\\n && keytool -trustcacerts -keystore $KEYSTORE -storepass changeit -noprompt -importcert -alias letsencryptauthorityx2 -file /tmp/lets-encrypt-x2-cross-signed.der \\\n && keytool -trustcacerts -keystore $KEYSTORE -storepass changeit -noprompt -importcert -alias letsencryptauthorityx3 -file /tmp/lets-encrypt-x3-cross-signed.der \\\n && keytool -trustcacerts -keystore $KEYSTORE -storepass changeit -noprompt -importcert -alias letsencryptauthorityx4 -file /tmp/lets-encrypt-x4-cross-signed.der \\\n && wget -O /home/${CONTAINER_USER}/SSLPoke.class https://confluence.atlassian.com/kb/files/779355358/779355357/1/1441897666313/SSLPoke.class \\\n && chown -R bitbucket:bitbucket /home/${CONTAINER_USER} \\\n && chown -R bitbucket:bitbucket ${BITBUCKET_HOME} \\\n && chown -R bitbucket:bitbucket ${BITBUCKET_INSTALL}\nRUN mkdir -p ${BITBUCKET_BACKUP_CLIENT_HOME} \\\n && wget -O /tmp/bitbucket-backup-distribution.zip https://marketplace.atlassian.com/download/plugins/com.atlassian.stash.backup.client/version/${BITBUCKET_BACKUP_CLIENT_VERSION} \\\n && unzip -d ${BITBUCKET_BACKUP_CLIENT_HOME} /tmp/bitbucket-backup-distribution.zip \\\n && mv /opt/backupclient/$( ls /opt/backupclient/ ;) /opt/backupclient/bitbucket-backup-client \\\n && chown -R bitbucket:bitbucket ${BITBUCKET_BACKUP_CLIENT_HOME}\n#   Remove obsolete packages\nRUN apk del ca-certificates gzip util-linux wget \\\n && rm -rf /var/cache/apk/* \\\n && rm -rf /tmp/* \\\n && rm -rf /var/log/*\nUSER bitbucket\nWORKDIR /var/atlassian/bitbucket\nVOLUME [\"/var/atlassian/bitbucket\"]\nEXPOSE 7990/tcp 7990/tcp\nEXPOSE 7999/tcp 7999/tcp\nEXPOSE 7992/tcp 7992/tcp\nCOPY imagescripts/docker-entrypoint.sh /home/bitbucket/\nCOPY imagescripts/ps_opt_p_enabled_for_alpine.sh /usr/bin/ps\nENTRYPOINT [\"/sbin/tini\", \"--\", \"/home/bitbucket/docker-entrypoint.sh\"]\nCMD [\"bitbucket\"]\n","originalDockerfileUglifiedHash":"7c48f95d9364200f7521878490417c38","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/a47fb65d1bf275225ef71355671978382d4595eb.dockerfile"}