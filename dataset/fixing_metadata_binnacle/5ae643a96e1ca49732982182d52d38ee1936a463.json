{"seed":1407140766,"processedDockerfileHash":"04ef48d3e47fcfd0ea658c49007aa8e7","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM registry.cn-hangzhou.aliyuncs.com/xiaomimace/mace-dev-lite:latest\n#   Install tools\nRUN :\nRUN (apt-get update ;apt-get install --no-install-recommends telnet=0.17+2.4-2ubuntu1 net-tools=2.10-0.1ubuntu3 inetutils-ping=2:2.4-2ubuntu1 screen=4.9.0-4 htop=3.2.2-1 -y )\nRUN pyenv global 3.6.3\nRUN pip install mirrors.aliyun.com==null sphinx==6.1.3 sphinx-autobuild==2021.3.14 sphinx_rtd_theme==1.2.0 recommonmark==0.7.1 -i http://mirrors.aliyun.com/pypi/simple/ --trusted-host\n#   Customize vim\nRUN git clone --recursive https://github.com/llhe/vimrc.git \\\n && cd vimrc \\\n && rm -rf ~/.vim \\\n && rm -rf ~/.vimrc \\\n && ln -s `pwd `/vim ~/.vim \\\n && ln -s `pwd `/vimrc ~/.vimrc\n#   Upgrade CMake\nRUN wget -q https://cmake.org/files/v3.11/cmake-3.11.3-Linux-x86_64.tar.gz -P /tmp/ \\\n && tar zxf /tmp/cmake-3.11.3-Linux-x86_64.tar.gz --strip-components=1 -C /usr/local/ \\\n && update-alternatives --install /usr/bin/cmake cmake /usr/local/bin/cmake 1 --force \\\n && rm -f /tmp/cmake-3.11.3-Linux-x86_64.tar.gz\n#   mace-dev-lite image already included NDK r19c\n#  # Download other NDK r15c\nRUN cd /opt/ \\\n && wget -q https://dl.google.com/android/repository/android-ndk-r15c-linux-x86_64.zip \\\n && unzip -q android-ndk-r15c-linux-x86_64.zip \\\n && rm -f android-ndk-r15c-linux-x86_64.zip\n#  # Download other NDK r16b\nRUN cd /opt/ \\\n && wget -q https://dl.google.com/android/repository/android-ndk-r16b-linux-x86_64.zip \\\n && unzip -q android-ndk-r16b-linux-x86_64.zip \\\n && rm -f android-ndk-r16b-linux-x86_64.zip\n#  # Download other NDK r17b\nRUN cd /opt/ \\\n && wget -q https://dl.google.com/android/repository/android-ndk-r17b-linux-x86_64.zip \\\n && unzip -q android-ndk-r17b-linux-x86_64.zip \\\n && rm -f android-ndk-r17b-linux-x86_64.zip\n#  # Download other NDK r18b\nRUN cd /opt/ \\\n && wget -q https://dl.google.com/android/repository/android-ndk-r18b-linux-x86_64.zip \\\n && unzip -q android-ndk-r18b-linux-x86_64.zip \\\n && rm -f android-ndk-r18b-linux-x86_64.zip\n#   Mirror of https://releases.linaro.org/components/toolchain/binaries/7.3-2018.05/arm-linux-gnueabihf/gcc-linaro-7.3.1-2018.05-x86_64_arm-linux-gnueabihf.tar.xz\nRUN cd /opt \\\n && wget -q https://cnbj1.fds.api.xiaomi.com/mace/third-party/gcc-linaro/gcc-linaro-7.3.1-2018.05-x86_64_arm-linux-gnueabihf.tar.xz \\\n && tar xf gcc-linaro-7.3.1-2018.05-x86_64_arm-linux-gnueabihf.tar.xz \\\n && rm -rf gcc-linaro-7.3.1-2018.05-x86_64_arm-linux-gnueabihf.tar.xz\n#   Mirror of https://releases.linaro.org/components/toolchain/binaries/7.3-2018.05/aarch64-linux-gnu/gcc-linaro-7.3.1-2018.05-x86_64_aarch64-linux-gnu.tar.xz\nRUN cd /opt \\\n && wget -q https://cnbj1.fds.api.xiaomi.com/mace/third-party/gcc-linaro/gcc-linaro-7.3.1-2018.05-x86_64_aarch64-linux-gnu.tar.xz \\\n && tar xf gcc-linaro-7.3.1-2018.05-x86_64_aarch64-linux-gnu.tar.xz \\\n && rm -rf gcc-linaro-7.3.1-2018.05-x86_64_aarch64-linux-gnu.tar.xz\n#   install protoc\nRUN cd opt/ \\\n && wget -q https://github.com/protocolbuffers/protobuf/releases/download/v3.6.1/protoc-3.6.1-linux-x86_64.zip \\\n && unzip protoc-3.6.1-linux-x86_64.zip -d protoc-3.6.1 \\\n && rm -rf protoc-3.6.1-linux-x86_64.zip\nENV CROSS_TOOLCHAIN_PARENT=\"/opt\"\nENV ANDROID_NDK_VERSION=\"r19c\"\nENV ANDROID_NDK_HOME=\"/opt/android-ndk-${ANDROID_NDK_VERSION}\"\nENV LINARO_ARM_LINUX_GNUEABIHF=\"/opt/gcc-linaro-7.3.1-2018.05-x86_64_arm-linux-gnueabihf\"\nENV LINARO_AARCH64_LINUX_GNU=\"/opt/gcc-linaro-7.3.1-2018.05-x86_64_aarch64-linux-gnu\"\nENV PATH=\"/opt/protoc-3.6.1/bin:${PATH}\"\nRUN pyenv install 2.7.12\nRUN pyenv global 2.7.12\nRUN pip install mirrors.aliyun.com==null pip==23.1 setuptools==67.6.1 -i http://mirrors.aliyun.com/pypi/simple/ --trusted-host --upgrade\nRUN pip install mirrors.aliyun.com==null numpy==1.15.4 scipy==1.2.0 Jinja2==2.10 PyYAML==3.13 sh==1.12.14 pycodestyle==2.4.0 filelock==3.0.10 PTable==0.9.2 -i http://mirrors.aliyun.com/pypi/simple/ --trusted-host\nRUN pip install mirrors.aliyun.com==null tensorflow==1.8.0 -i http://mirrors.aliyun.com/pypi/simple/ --trusted-host\n#   Install pytorch (refer to: https://pytorch.org/get-started/locally/)\nRUN pip install mirrors.aliyun.com==null future==0.17.1 Pillow==5.4.1 torch==1.1.0 torchvision==0.2.2.post3 -i http://mirrors.aliyun.com/pypi/simple/ --trusted-host\nRUN pip install mirrors.aliyun.com==null onnx==1.5.0 onnx-tf==1.2.0 -i http://mirrors.aliyun.com/pypi/simple/ --trusted-host\nRUN pip install mirrors.aliyun.com==null cpplint==1.4.4 -i http://mirrors.aliyun.com/pypi/simple/ --trusted-host\nRUN (apt-get update ;apt-get install --no-install-recommends ccache=4.7.4-1 -y )\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM registry.cn-hangzhou.aliyuncs.com/xiaomimace/mace-dev-lite:latest\n#  Install tools\nRUN apt-get update -y\nRUN apt-get install --no-install-recommends telnet net-tools inetutils-ping screen htop -y\nRUN pyenv global 3.6.3\nRUN pip install mirrors.aliyun.com sphinx sphinx-autobuild sphinx_rtd_theme recommonmark -i http://mirrors.aliyun.com/pypi/simple/ --trusted-host\n#  Customize vim\nRUN git clone --recursive https://github.com/llhe/vimrc.git \\\n && cd vimrc \\\n && rm -rf ~/.vim \\\n && rm -rf ~/.vimrc \\\n && ln -s `pwd `/vim ~/.vim \\\n && ln -s `pwd `/vimrc ~/.vimrc\n#  Upgrade CMake\nRUN wget -q https://cmake.org/files/v3.11/cmake-3.11.3-Linux-x86_64.tar.gz -P /tmp/ \\\n && tar zxf /tmp/cmake-3.11.3-Linux-x86_64.tar.gz --strip-components=1 -C /usr/local/ \\\n && update-alternatives --install /usr/bin/cmake cmake /usr/local/bin/cmake 1 --force \\\n && rm -f /tmp/cmake-3.11.3-Linux-x86_64.tar.gz\n#  mace-dev-lite image already included NDK r19c\n# # Download other NDK r15c\nRUN cd /opt/ \\\n && wget -q https://dl.google.com/android/repository/android-ndk-r15c-linux-x86_64.zip \\\n && unzip -q android-ndk-r15c-linux-x86_64.zip \\\n && rm -f android-ndk-r15c-linux-x86_64.zip\n# # Download other NDK r16b\nRUN cd /opt/ \\\n && wget -q https://dl.google.com/android/repository/android-ndk-r16b-linux-x86_64.zip \\\n && unzip -q android-ndk-r16b-linux-x86_64.zip \\\n && rm -f android-ndk-r16b-linux-x86_64.zip\n# # Download other NDK r17b\nRUN cd /opt/ \\\n && wget -q https://dl.google.com/android/repository/android-ndk-r17b-linux-x86_64.zip \\\n && unzip -q android-ndk-r17b-linux-x86_64.zip \\\n && rm -f android-ndk-r17b-linux-x86_64.zip\n# # Download other NDK r18b\nRUN cd /opt/ \\\n && wget -q https://dl.google.com/android/repository/android-ndk-r18b-linux-x86_64.zip \\\n && unzip -q android-ndk-r18b-linux-x86_64.zip \\\n && rm -f android-ndk-r18b-linux-x86_64.zip\n#  Mirror of https://releases.linaro.org/components/toolchain/binaries/7.3-2018.05/arm-linux-gnueabihf/gcc-linaro-7.3.1-2018.05-x86_64_arm-linux-gnueabihf.tar.xz\nRUN cd /opt \\\n && wget -q https://cnbj1.fds.api.xiaomi.com/mace/third-party/gcc-linaro/gcc-linaro-7.3.1-2018.05-x86_64_arm-linux-gnueabihf.tar.xz \\\n && tar xf gcc-linaro-7.3.1-2018.05-x86_64_arm-linux-gnueabihf.tar.xz \\\n && rm -rf gcc-linaro-7.3.1-2018.05-x86_64_arm-linux-gnueabihf.tar.xz\n#  Mirror of https://releases.linaro.org/components/toolchain/binaries/7.3-2018.05/aarch64-linux-gnu/gcc-linaro-7.3.1-2018.05-x86_64_aarch64-linux-gnu.tar.xz\nRUN cd /opt \\\n && wget -q https://cnbj1.fds.api.xiaomi.com/mace/third-party/gcc-linaro/gcc-linaro-7.3.1-2018.05-x86_64_aarch64-linux-gnu.tar.xz \\\n && tar xf gcc-linaro-7.3.1-2018.05-x86_64_aarch64-linux-gnu.tar.xz \\\n && rm -rf gcc-linaro-7.3.1-2018.05-x86_64_aarch64-linux-gnu.tar.xz\n#  install protoc\nRUN cd opt/ \\\n && wget -q https://github.com/protocolbuffers/protobuf/releases/download/v3.6.1/protoc-3.6.1-linux-x86_64.zip \\\n && unzip protoc-3.6.1-linux-x86_64.zip -d protoc-3.6.1 \\\n && rm -rf protoc-3.6.1-linux-x86_64.zip\nENV CROSS_TOOLCHAIN_PARENT=\"/opt\"\nENV ANDROID_NDK_VERSION=\"r19c\"\nENV ANDROID_NDK_HOME=\"/opt/android-ndk-${ANDROID_NDK_VERSION}\"\nENV LINARO_ARM_LINUX_GNUEABIHF=\"/opt/gcc-linaro-7.3.1-2018.05-x86_64_arm-linux-gnueabihf\"\nENV LINARO_AARCH64_LINUX_GNU=\"/opt/gcc-linaro-7.3.1-2018.05-x86_64_aarch64-linux-gnu\"\nENV PATH=\"/opt/protoc-3.6.1/bin:${PATH}\"\nRUN pyenv install 2.7.12\nRUN pyenv global 2.7.12\nRUN pip install mirrors.aliyun.com pip setuptools -i http://mirrors.aliyun.com/pypi/simple/ --trusted-host --upgrade\nRUN pip install mirrors.aliyun.com numpy==1.15.4 scipy==1.2.0 Jinja2==2.10 PyYAML==3.13 sh==1.12.14 pycodestyle==2.4.0 filelock==3.0.10 PTable==0.9.2 -i http://mirrors.aliyun.com/pypi/simple/ --trusted-host\nRUN pip install mirrors.aliyun.com tensorflow==1.8.0 -i http://mirrors.aliyun.com/pypi/simple/ --trusted-host\n#  Install pytorch (refer to: https://pytorch.org/get-started/locally/)\nRUN pip install mirrors.aliyun.com future==0.17.1 Pillow==5.4.1 torch==1.1.0 torchvision==0.2.2.post3 -i http://mirrors.aliyun.com/pypi/simple/ --trusted-host\nRUN pip install mirrors.aliyun.com onnx==1.5.0 onnx-tf==1.2.0 -i http://mirrors.aliyun.com/pypi/simple/ --trusted-host\nRUN pip install mirrors.aliyun.com cpplint==1.4.4 -i http://mirrors.aliyun.com/pypi/simple/ --trusted-host\nRUN apt-get install --no-install-recommends ccache -y\n","injectedSmells":[],"originalDockerfileHash":"c3a4edcab8365767d0ccd3b653df439e","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM registry.cn-hangzhou.aliyuncs.com/xiaomimace/mace-dev-lite:latest\n#   Install tools\nRUN apt-get update -y\nRUN apt-get install --no-install-recommends telnet net-tools inetutils-ping screen htop -y\nRUN pyenv global 3.6.3\nRUN pip install mirrors.aliyun.com sphinx sphinx-autobuild sphinx_rtd_theme recommonmark -i http://mirrors.aliyun.com/pypi/simple/ --trusted-host\n#   Customize vim\nRUN git clone --recursive https://github.com/llhe/vimrc.git \\\n && cd vimrc \\\n && rm -rf ~/.vim \\\n && rm -rf ~/.vimrc \\\n && ln -s `pwd `/vim ~/.vim \\\n && ln -s `pwd `/vimrc ~/.vimrc\n#   Upgrade CMake\nRUN wget -q https://cmake.org/files/v3.11/cmake-3.11.3-Linux-x86_64.tar.gz -P /tmp/ \\\n && tar zxf /tmp/cmake-3.11.3-Linux-x86_64.tar.gz --strip-components=1 -C /usr/local/ \\\n && update-alternatives --install /usr/bin/cmake cmake /usr/local/bin/cmake 1 --force \\\n && rm -f /tmp/cmake-3.11.3-Linux-x86_64.tar.gz\n#   mace-dev-lite image already included NDK r19c\n#  # Download other NDK r15c\nRUN cd /opt/ \\\n && wget -q https://dl.google.com/android/repository/android-ndk-r15c-linux-x86_64.zip \\\n && unzip -q android-ndk-r15c-linux-x86_64.zip \\\n && rm -f android-ndk-r15c-linux-x86_64.zip\n#  # Download other NDK r16b\nRUN cd /opt/ \\\n && wget -q https://dl.google.com/android/repository/android-ndk-r16b-linux-x86_64.zip \\\n && unzip -q android-ndk-r16b-linux-x86_64.zip \\\n && rm -f android-ndk-r16b-linux-x86_64.zip\n#  # Download other NDK r17b\nRUN cd /opt/ \\\n && wget -q https://dl.google.com/android/repository/android-ndk-r17b-linux-x86_64.zip \\\n && unzip -q android-ndk-r17b-linux-x86_64.zip \\\n && rm -f android-ndk-r17b-linux-x86_64.zip\n#  # Download other NDK r18b\nRUN cd /opt/ \\\n && wget -q https://dl.google.com/android/repository/android-ndk-r18b-linux-x86_64.zip \\\n && unzip -q android-ndk-r18b-linux-x86_64.zip \\\n && rm -f android-ndk-r18b-linux-x86_64.zip\n#   Mirror of https://releases.linaro.org/components/toolchain/binaries/7.3-2018.05/arm-linux-gnueabihf/gcc-linaro-7.3.1-2018.05-x86_64_arm-linux-gnueabihf.tar.xz\nRUN cd /opt \\\n && wget -q https://cnbj1.fds.api.xiaomi.com/mace/third-party/gcc-linaro/gcc-linaro-7.3.1-2018.05-x86_64_arm-linux-gnueabihf.tar.xz \\\n && tar xf gcc-linaro-7.3.1-2018.05-x86_64_arm-linux-gnueabihf.tar.xz \\\n && rm -rf gcc-linaro-7.3.1-2018.05-x86_64_arm-linux-gnueabihf.tar.xz\n#   Mirror of https://releases.linaro.org/components/toolchain/binaries/7.3-2018.05/aarch64-linux-gnu/gcc-linaro-7.3.1-2018.05-x86_64_aarch64-linux-gnu.tar.xz\nRUN cd /opt \\\n && wget -q https://cnbj1.fds.api.xiaomi.com/mace/third-party/gcc-linaro/gcc-linaro-7.3.1-2018.05-x86_64_aarch64-linux-gnu.tar.xz \\\n && tar xf gcc-linaro-7.3.1-2018.05-x86_64_aarch64-linux-gnu.tar.xz \\\n && rm -rf gcc-linaro-7.3.1-2018.05-x86_64_aarch64-linux-gnu.tar.xz\n#   install protoc\nRUN cd opt/ \\\n && wget -q https://github.com/protocolbuffers/protobuf/releases/download/v3.6.1/protoc-3.6.1-linux-x86_64.zip \\\n && unzip protoc-3.6.1-linux-x86_64.zip -d protoc-3.6.1 \\\n && rm -rf protoc-3.6.1-linux-x86_64.zip\nENV CROSS_TOOLCHAIN_PARENT=\"/opt\"\nENV ANDROID_NDK_VERSION=\"r19c\"\nENV ANDROID_NDK_HOME=\"/opt/android-ndk-${ANDROID_NDK_VERSION}\"\nENV LINARO_ARM_LINUX_GNUEABIHF=\"/opt/gcc-linaro-7.3.1-2018.05-x86_64_arm-linux-gnueabihf\"\nENV LINARO_AARCH64_LINUX_GNU=\"/opt/gcc-linaro-7.3.1-2018.05-x86_64_aarch64-linux-gnu\"\nENV PATH=\"/opt/protoc-3.6.1/bin:${PATH}\"\nRUN pyenv install 2.7.12\nRUN pyenv global 2.7.12\nRUN pip install mirrors.aliyun.com pip setuptools -i http://mirrors.aliyun.com/pypi/simple/ --trusted-host --upgrade\nRUN pip install mirrors.aliyun.com numpy==1.15.4 scipy==1.2.0 Jinja2==2.10 PyYAML==3.13 sh==1.12.14 pycodestyle==2.4.0 filelock==3.0.10 PTable==0.9.2 -i http://mirrors.aliyun.com/pypi/simple/ --trusted-host\nRUN pip install mirrors.aliyun.com tensorflow==1.8.0 -i http://mirrors.aliyun.com/pypi/simple/ --trusted-host\n#   Install pytorch (refer to: https://pytorch.org/get-started/locally/)\nRUN pip install mirrors.aliyun.com future==0.17.1 Pillow==5.4.1 torch==1.1.0 torchvision==0.2.2.post3 -i http://mirrors.aliyun.com/pypi/simple/ --trusted-host\nRUN pip install mirrors.aliyun.com onnx==1.5.0 onnx-tf==1.2.0 -i http://mirrors.aliyun.com/pypi/simple/ --trusted-host\nRUN pip install mirrors.aliyun.com cpplint==1.4.4 -i http://mirrors.aliyun.com/pypi/simple/ --trusted-host\nRUN apt-get install --no-install-recommends ccache -y\n","originalDockerfileUglifiedHash":"4868aa444cab38ab1ef162c8d4f05ee2","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/5ae643a96e1ca49732982182d52d38ee1936a463.dockerfile"}