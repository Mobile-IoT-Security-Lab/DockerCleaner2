{"seed":2137352258,"processedDockerfileHash":"2d50268b0aef9926db47cfa9b7fe0393","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM gentoo/stage3-amd64-hardened\nLABEL Description=\"Gentoo Hardened with build dependencies for shared\"\n#   Gentoo does not provide sci-mathematics/z3 with Python3 support:\n#      https://gitweb.gentoo.org/repo/gentoo.git/tree/sci-mathematics/z3/z3-4.5.0.ebuild#n6\n#      contains: PYTHON_COMPAT=( python2_7 )\n#   Override the language to force UTF-8 output\nENV LANG=\"en_US.UTF-8\"\n#   Modify portage useflags and masks\nRUN echo 'USE=\"$USE python wayland\"' >> /etc/portage/make.conf \\\n && echo '>=x11-libs/cairo-1.14.12 X' >> /etc/portage/package.use/cairo \\\n && echo '>=app-text/ghostscript-gpl-9.26 cups' >> /etc/portage/package.use/ghostscript-gpl \\\n && echo '>=sys-devel/llvm-3.5.0 clang' >> /etc/portage/package.use/clang \\\n && echo '>=media-libs/libsdl2-2.0.8 gles' >> /etc/portage/package.use/libsdl2 \\\n && echo '>=media-libs/mesa-18.1.9 gles2' >> /etc/portage/package.use/mesa \\\n && echo '>=media-plugins/alsa-plugins-1.0.29 pulseaudio' >> /etc/portage/package.use/pulseaudio \\\n && echo '>=sys-apps/util-linux-2.32-r4 static-libs' >> /etc/portage/package.use/util-linux \\\n && echo '>=sys-kernel/linux-firmware-20190514 linux-fw-redistributable no-source-code' >> /etc/portage/package.license\n#   llvm requires kernel sources in /usr/src/linux\n#   Merge llvm with MAKEOPTS=\"-j1\", but its dependency \"cmake\" faster\n#   cf. https://forums.gentoo.org/viewtopic-t-1062974-start-0.html\n#   Installing dev-libs/gobject-introspection and x11-libs/gdk-pixbuf and some other packages fails with:\n#    * ISE:_do_ptrace: ptrace(PTRACE_TRACEME, ..., 0x0000000000000000, 0x0000000000000000): Operation not permitted\n#   ERROR: can't resolve libraries to shared libraries: glib-2.0, gobject-2.0\n#   This is because Gentoo's build sandbox (sys-apps/sandbox) ptraces ldd (because it can't LDPRELOAD into it).\n#   Install it without the sandbox.\n#   cf. https://forums-web2.gentoo.org/viewtopic-t-1051762-view-next.html?sid=850e5ab46d3b0ba7b5b8ec32fa1566ba\n#   Clean-up downloaded distfiles in the end.\nRUN emerge --quiet --sync \\\n && emerge dev-util/cmake sys-kernel/gentoo-sources \\\n && MAKEOPTS='-j1' emerge sys-devel/llvm sys-devel/clang \\\n && FEATURES='-usersandbox -sandbox' emerge app-accessibility/at-spi2-core dev-libs/atk dev-libs/gobject-introspection gnome-base/librsvg media-libs/harfbuzz x11-libs/gdk-pixbuf x11-libs/gtk+:2 x11-libs/gtk+:3 x11-libs/pango \\\n && emerge dev-python/cffi dev-python/gmpy dev-python/numpy dev-python/pycrypto media-libs/libsdl2 media-sound/pulseaudio sci-mathematics/coq sys-kernel/genkernel virtual/jdk \\\n && genkernel all \\\n && rm -r /usr/portage/distfiles/ /var/tmp/portage/\n#  RUN emerge sys-libs/musl\n#   Try using crossdev for https://wiki.gentoo.org/wiki/Mingw\nRUN emerge sys-devel/crossdev\nRUN echo 'PORTDIR_OVERLAY=\"/usr/crossdev-overlay\"' >> /etc/portage/make.conf\n#   TODO: add musl and MinGW (+ wine) from crossdev\n#  RUN crossdev --target x86_64-w64-mingw64\n#  RUN crossdev --target i686-w64-mingw32\nWORKDIR /shared\nRUN ln -s shared/machines/run_shared_test.sh /run_shared_test.sh\nCOPY . /shared/\nCMD [\"/run_shared_test.sh\"]\n#   make list-nobuild:\n#      Global blacklist: latex% windows%\n#      In sub-directories:\n#         c:\n#         java/keystore:\n#         linux:\n#         python: z3_example.py\n#         python/crypto:\n#         python/dnssec:\n#         verification:\n#      With gcc -m32:\n#         Global blacklist: latex% windows%\n#         In sub-directories:\n#            c: gmp_functions gtk_alpha_window\n#            java/keystore:\n#            linux: enum_link_addrs pulseaudio_echo sdl_v4l_video\n#            python: z3_example.py\n#            python/crypto:\n#            python/dnssec:\n#            verification:\n#      Compilers:\n#         gcc -m64: ok\n#         gcc -m32: ok\n#         clang -m64: ok\n#         clang -m32: ok\n#         musl-gcc: not working\n#         x86_64-w64-mingw32-gcc: not working\n#         i686-w64-mingw32-gcc: not working\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM gentoo/stage3-amd64-hardened\nLABEL Description=\"Gentoo Hardened with build dependencies for shared\"\n#  Gentoo does not provide sci-mathematics/z3 with Python3 support:\n#     https://gitweb.gentoo.org/repo/gentoo.git/tree/sci-mathematics/z3/z3-4.5.0.ebuild#n6\n#     contains: PYTHON_COMPAT=( python2_7 )\n#  Override the language to force UTF-8 output\nENV LANG=\"en_US.UTF-8\"\n#  Modify portage useflags and masks\nRUN echo 'USE=\"$USE python wayland\"' >> /etc/portage/make.conf \\\n && echo '>=x11-libs/cairo-1.14.12 X' >> /etc/portage/package.use/cairo \\\n && echo '>=app-text/ghostscript-gpl-9.26 cups' >> /etc/portage/package.use/ghostscript-gpl \\\n && echo '>=sys-devel/llvm-3.5.0 clang' >> /etc/portage/package.use/clang \\\n && echo '>=media-libs/libsdl2-2.0.8 gles' >> /etc/portage/package.use/libsdl2 \\\n && echo '>=media-libs/mesa-18.1.9 gles2' >> /etc/portage/package.use/mesa \\\n && echo '>=media-plugins/alsa-plugins-1.0.29 pulseaudio' >> /etc/portage/package.use/pulseaudio \\\n && echo '>=sys-apps/util-linux-2.32-r4 static-libs' >> /etc/portage/package.use/util-linux \\\n && echo '>=sys-kernel/linux-firmware-20190514 linux-fw-redistributable no-source-code' >> /etc/portage/package.license\n#  llvm requires kernel sources in /usr/src/linux\n#  Merge llvm with MAKEOPTS=\"-j1\", but its dependency \"cmake\" faster\n#  cf. https://forums.gentoo.org/viewtopic-t-1062974-start-0.html\n#  Installing dev-libs/gobject-introspection and x11-libs/gdk-pixbuf and some other packages fails with:\n#   * ISE:_do_ptrace: ptrace(PTRACE_TRACEME, ..., 0x0000000000000000, 0x0000000000000000): Operation not permitted\n#  ERROR: can't resolve libraries to shared libraries: glib-2.0, gobject-2.0\n#  This is because Gentoo's build sandbox (sys-apps/sandbox) ptraces ldd (because it can't LDPRELOAD into it).\n#  Install it without the sandbox.\n#  cf. https://forums-web2.gentoo.org/viewtopic-t-1051762-view-next.html?sid=850e5ab46d3b0ba7b5b8ec32fa1566ba\n#  Clean-up downloaded distfiles in the end.\nRUN emerge --quiet --sync \\\n && emerge dev-util/cmake sys-kernel/gentoo-sources \\\n && MAKEOPTS='-j1' emerge sys-devel/llvm sys-devel/clang \\\n && FEATURES='-usersandbox -sandbox' emerge app-accessibility/at-spi2-core dev-libs/atk dev-libs/gobject-introspection gnome-base/librsvg media-libs/harfbuzz x11-libs/gdk-pixbuf x11-libs/gtk+:2 x11-libs/gtk+:3 x11-libs/pango \\\n && emerge dev-python/cffi dev-python/gmpy dev-python/numpy dev-python/pycrypto media-libs/libsdl2 media-sound/pulseaudio sci-mathematics/coq sys-kernel/genkernel virtual/jdk \\\n && genkernel all \\\n && rm -r /usr/portage/distfiles/ /var/tmp/portage/\n# RUN emerge sys-libs/musl\n#  Try using crossdev for https://wiki.gentoo.org/wiki/Mingw\nRUN emerge sys-devel/crossdev\nRUN echo 'PORTDIR_OVERLAY=\"/usr/crossdev-overlay\"' >> /etc/portage/make.conf\n#  TODO: add musl and MinGW (+ wine) from crossdev\n# RUN crossdev --target x86_64-w64-mingw64\n# RUN crossdev --target i686-w64-mingw32\nWORKDIR /shared\nRUN ln -s shared/machines/run_shared_test.sh /run_shared_test.sh\nCOPY . /shared/\nCMD [\"/run_shared_test.sh\"]\n#  make list-nobuild:\n#     Global blacklist: latex% windows%\n#     In sub-directories:\n#        c:\n#        java/keystore:\n#        linux:\n#        python: z3_example.py\n#        python/crypto:\n#        python/dnssec:\n#        verification:\n#     With gcc -m32:\n#        Global blacklist: latex% windows%\n#        In sub-directories:\n#           c: gmp_functions gtk_alpha_window\n#           java/keystore:\n#           linux: enum_link_addrs pulseaudio_echo sdl_v4l_video\n#           python: z3_example.py\n#           python/crypto:\n#           python/dnssec:\n#           verification:\n#     Compilers:\n#        gcc -m64: ok\n#        gcc -m32: ok\n#        clang -m64: ok\n#        clang -m32: ok\n#        musl-gcc: not working\n#        x86_64-w64-mingw32-gcc: not working\n#        i686-w64-mingw32-gcc: not working\n","injectedSmells":[],"originalDockerfileHash":"75e82ee14bb9d6ed042d21fd7f656842","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM gentoo/stage3-amd64-hardened\nLABEL Description=\"Gentoo Hardened with build dependencies for shared\"\n#   Gentoo does not provide sci-mathematics/z3 with Python3 support:\n#      https://gitweb.gentoo.org/repo/gentoo.git/tree/sci-mathematics/z3/z3-4.5.0.ebuild#n6\n#      contains: PYTHON_COMPAT=( python2_7 )\n#   Override the language to force UTF-8 output\nENV LANG=\"en_US.UTF-8\"\n#   Modify portage useflags and masks\nRUN echo 'USE=\"$USE python wayland\"' >> /etc/portage/make.conf \\\n && echo '>=x11-libs/cairo-1.14.12 X' >> /etc/portage/package.use/cairo \\\n && echo '>=app-text/ghostscript-gpl-9.26 cups' >> /etc/portage/package.use/ghostscript-gpl \\\n && echo '>=sys-devel/llvm-3.5.0 clang' >> /etc/portage/package.use/clang \\\n && echo '>=media-libs/libsdl2-2.0.8 gles' >> /etc/portage/package.use/libsdl2 \\\n && echo '>=media-libs/mesa-18.1.9 gles2' >> /etc/portage/package.use/mesa \\\n && echo '>=media-plugins/alsa-plugins-1.0.29 pulseaudio' >> /etc/portage/package.use/pulseaudio \\\n && echo '>=sys-apps/util-linux-2.32-r4 static-libs' >> /etc/portage/package.use/util-linux \\\n && echo '>=sys-kernel/linux-firmware-20190514 linux-fw-redistributable no-source-code' >> /etc/portage/package.license\n#   llvm requires kernel sources in /usr/src/linux\n#   Merge llvm with MAKEOPTS=\"-j1\", but its dependency \"cmake\" faster\n#   cf. https://forums.gentoo.org/viewtopic-t-1062974-start-0.html\n#   Installing dev-libs/gobject-introspection and x11-libs/gdk-pixbuf and some other packages fails with:\n#    * ISE:_do_ptrace: ptrace(PTRACE_TRACEME, ..., 0x0000000000000000, 0x0000000000000000): Operation not permitted\n#   ERROR: can't resolve libraries to shared libraries: glib-2.0, gobject-2.0\n#   This is because Gentoo's build sandbox (sys-apps/sandbox) ptraces ldd (because it can't LDPRELOAD into it).\n#   Install it without the sandbox.\n#   cf. https://forums-web2.gentoo.org/viewtopic-t-1051762-view-next.html?sid=850e5ab46d3b0ba7b5b8ec32fa1566ba\n#   Clean-up downloaded distfiles in the end.\nRUN emerge --quiet --sync \\\n && emerge dev-util/cmake sys-kernel/gentoo-sources \\\n && MAKEOPTS='-j1' emerge sys-devel/llvm sys-devel/clang \\\n && FEATURES='-usersandbox -sandbox' emerge app-accessibility/at-spi2-core dev-libs/atk dev-libs/gobject-introspection gnome-base/librsvg media-libs/harfbuzz x11-libs/gdk-pixbuf x11-libs/gtk+:2 x11-libs/gtk+:3 x11-libs/pango \\\n && emerge dev-python/cffi dev-python/gmpy dev-python/numpy dev-python/pycrypto media-libs/libsdl2 media-sound/pulseaudio sci-mathematics/coq sys-kernel/genkernel virtual/jdk \\\n && genkernel all \\\n && rm -r /usr/portage/distfiles/ /var/tmp/portage/\n#  RUN emerge sys-libs/musl\n#   Try using crossdev for https://wiki.gentoo.org/wiki/Mingw\nRUN emerge sys-devel/crossdev\nRUN echo 'PORTDIR_OVERLAY=\"/usr/crossdev-overlay\"' >> /etc/portage/make.conf\n#   TODO: add musl and MinGW (+ wine) from crossdev\n#  RUN crossdev --target x86_64-w64-mingw64\n#  RUN crossdev --target i686-w64-mingw32\nWORKDIR /shared\nRUN ln -s shared/machines/run_shared_test.sh /run_shared_test.sh\nCOPY . /shared/\nCMD [\"/run_shared_test.sh\"]\n#   make list-nobuild:\n#      Global blacklist: latex% windows%\n#      In sub-directories:\n#         c:\n#         java/keystore:\n#         linux:\n#         python: z3_example.py\n#         python/crypto:\n#         python/dnssec:\n#         verification:\n#      With gcc -m32:\n#         Global blacklist: latex% windows%\n#         In sub-directories:\n#            c: gmp_functions gtk_alpha_window\n#            java/keystore:\n#            linux: enum_link_addrs pulseaudio_echo sdl_v4l_video\n#            python: z3_example.py\n#            python/crypto:\n#            python/dnssec:\n#            verification:\n#      Compilers:\n#         gcc -m64: ok\n#         gcc -m32: ok\n#         clang -m64: ok\n#         clang -m32: ok\n#         musl-gcc: not working\n#         x86_64-w64-mingw32-gcc: not working\n#         i686-w64-mingw32-gcc: not working\n","originalDockerfileUglifiedHash":"ed50b38e09f587ceab29ccb2360a97d3","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/91dde690b260e37313177996a3a9c9232e52da9a.dockerfile"}