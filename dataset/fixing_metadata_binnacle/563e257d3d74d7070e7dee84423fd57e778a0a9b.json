{"seed":2689172998,"processedDockerfileHash":"c0adbfcbeaa55b8b50224fe81ffbfe6f","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","have-a-healthcheck","have-a-user"],"processedDockerfile":"#   Copyright 2017 The Openstack-Helm Authors.\n#\n#   Licensed under the Apache License, Version 2.0 (the \"License\");\n#   you may not use this file except in compliance with the License.\n#   You may obtain a copy of the License at\n#\n#       http://www.apache.org/licenses/LICENSE-2.0\n#\n#   Unless required by applicable law or agreed to in writing, software\n#   distributed under the License is distributed on an \"AS IS\" BASIS,\n#   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n#   See the License for the specific language governing permissions and\n#   limitations under the License.\nFROM docker.io/ubuntu:xenial\nMAINTAINER pete.birley@att.com\nARG UBUNTU_URL=http://archive.ubuntu.com/ubuntu/\nARG ALLOW_UNAUTHENTICATED=false\nARG PIP_INDEX_URL=https://pypi.python.org/simple/\nARG PIP_TRUSTED_HOST=pypi.python.org\nENV PIP_INDEX_URL=\"${PIP_INDEX_URL}\"\nENV PIP_TRUSTED_HOST=\"${PIP_TRUSTED_HOST}\"\nCOPY ./tools/images/kubeadm-aio/sources.list /etc/apt/\nRUN sed -i -e \"s|%%UBUNTU_URL%%|${UBUNTU_URL}|g\" /etc/apt/sources.list ; echo \"APT::Get::AllowUnauthenticated \\\"${ALLOW_UNAUTHENTICATED}\\\";\" > /etc/apt/apt.conf.d/allow-unathenticated\nARG GOOGLE_KUBERNETES_REPO_URL=https://storage.googleapis.com/kubernetes-release/release/${KUBE_VERSION}/bin/linux/amd64\nENV GOOGLE_KUBERNETES_REPO_URL=\"${GOOGLE_KUBERNETES_REPO_URL}\"\nARG GOOGLE_HELM_REPO_URL=https://storage.googleapis.com/kubernetes-helm\nENV GOOGLE_HELM_REPO_URL=\"${GOOGLE_HELM_REPO_URL}\"\nARG KUBE_VERSION=\"v1.13.4\"\nENV KUBE_VERSION=\"${KUBE_VERSION}\"\nARG CNI_VERSION=\"v0.6.0\"\nENV CNI_VERSION=\"${CNI_VERSION}\"\nARG CNI_REPO_URL=https://github.com/containernetworking/plugins/releases/download/$CNI_VERSION\nENV CNI_REPO_URL=\"${CNI_REPO_URL}\"\nARG HELM_VERSION=\"v2.13.1\"\nENV HELM_VERSION=\"${HELM_VERSION}\"\nARG CHARTS=\"calico,flannel,tiller,kube-dns,kubernetes-keystone-webhook\"\nENV CHARTS=\"${CHARTS}\"\nARG HTTP_PROXY=\"\"\nENV HTTP_PROXY=\"${HTTP_PROXY}\"\nENV http_proxy=\"${HTTP_PROXY}\"\nARG HTTPS_PROXY=\"\"\nENV HTTPS_PROXY=\"${HTTPS_PROXY}\"\nENV https_proxy=\"${HTTPS_PROXY}\"\nARG NO_PROXY=\"127.0.0.1,localhost,.svc.cluster.local\"\nENV NO_PROXY=\"${NO_PROXY}\"\nENV no_proxy=\"${NO_PROXY}\"\nENV container=\"docker\" \\\n    DEBIAN_FRONTEND=\"noninteractive\" \\\n    CNI_BIN_DIR=\"/opt/cni/bin\"\nRUN set -ex ; apt-get update ; apt-get upgrade -y ; apt-get install --no-install-recommends bash=4.3-14ubuntu1.4 ca-certificates=20210119~16.04.1 curl=7.47.0-1ubuntu2.19 jq=1.5+dfsg-1ubuntu0.1 python-pip=8.1.1-2ubuntu0.6 gawk=1:4.1.3+dfsg-0.1 -y ; pip install pip==18.1 --no-cache-dir --upgrade ; hash -r ; pip install setuptools==67.6.1 --no-cache-dir --upgrade ; pip install requests==2.28.2 kubernetes==26.1.0 \"ansible==2.5.5\" --no-cache-dir --upgrade ; for BINARY in kubectl kubeadm; do curl -sSL -o /usr/bin/${BINARY} ${GOOGLE_KUBERNETES_REPO_URL}/${BINARY} ;chmod +x /usr/bin/${BINARY} ; done ; mkdir -p /opt/assets/usr/bin ; curl -sSL -o /opt/assets/usr/bin/kubelet ${GOOGLE_KUBERNETES_REPO_URL}/kubelet ; chmod +x /opt/assets/usr/bin/kubelet ; mkdir -p /opt/assets${CNI_BIN_DIR} ; curl -sSL ${CNI_REPO_URL}/cni-plugins-amd64-$CNI_VERSION.tgz | tar -zxv --strip-components=1 -C /opt/assets${CNI_BIN_DIR} ; TMP_DIR=$( mktemp -d ;) ; curl -sSL ${GOOGLE_HELM_REPO_URL}/helm-${HELM_VERSION}-linux-amd64.tar.gz | tar -zxv --strip-components=1 -C ${TMP_DIR} ; mv ${TMP_DIR}/helm /usr/bin/helm ; rm -rf ${TMP_DIR} ; apt-get purge -y --auto-remove curl ; rm -rf /var/lib/apt/lists/* /tmp/* /root/.cache\nCOPY ./ /tmp/source\nRUN set -ex ; cp -rfav /tmp/source/tools/images/kubeadm-aio/assets/* / ; IFS=',' ; for CHART in $CHARTS; do mv -v /tmp/source/${CHART} /opt/charts/ ; done ; rm -rf /tmp/source\nENTRYPOINT [\"/entrypoint.sh\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  Copyright 2017 The Openstack-Helm Authors.\n#\n#  Licensed under the Apache License, Version 2.0 (the \"License\");\n#  you may not use this file except in compliance with the License.\n#  You may obtain a copy of the License at\n#\n#      http://www.apache.org/licenses/LICENSE-2.0\n#\n#  Unless required by applicable law or agreed to in writing, software\n#  distributed under the License is distributed on an \"AS IS\" BASIS,\n#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n#  See the License for the specific language governing permissions and\n#  limitations under the License.\nFROM docker.io/ubuntu:xenial\nMAINTAINER pete.birley@att.com\nARG UBUNTU_URL=http://archive.ubuntu.com/ubuntu/\nARG ALLOW_UNAUTHENTICATED=false\nARG PIP_INDEX_URL=https://pypi.python.org/simple/\nARG PIP_TRUSTED_HOST=pypi.python.org\nENV PIP_INDEX_URL=\"${PIP_INDEX_URL}\"\nENV PIP_TRUSTED_HOST=\"${PIP_TRUSTED_HOST}\"\nCOPY ./tools/images/kubeadm-aio/sources.list /etc/apt/\nRUN sed -i -e \"s|%%UBUNTU_URL%%|${UBUNTU_URL}|g\" /etc/apt/sources.list ; echo \"APT::Get::AllowUnauthenticated \\\"${ALLOW_UNAUTHENTICATED}\\\";\" > /etc/apt/apt.conf.d/allow-unathenticated\nARG GOOGLE_KUBERNETES_REPO_URL=https://storage.googleapis.com/kubernetes-release/release/${KUBE_VERSION}/bin/linux/amd64\nENV GOOGLE_KUBERNETES_REPO_URL=\"${GOOGLE_KUBERNETES_REPO_URL}\"\nARG GOOGLE_HELM_REPO_URL=https://storage.googleapis.com/kubernetes-helm\nENV GOOGLE_HELM_REPO_URL=\"${GOOGLE_HELM_REPO_URL}\"\nARG KUBE_VERSION=\"v1.13.4\"\nENV KUBE_VERSION=\"${KUBE_VERSION}\"\nARG CNI_VERSION=\"v0.6.0\"\nENV CNI_VERSION=\"${CNI_VERSION}\"\nARG CNI_REPO_URL=https://github.com/containernetworking/plugins/releases/download/$CNI_VERSION\nENV CNI_REPO_URL=\"${CNI_REPO_URL}\"\nARG HELM_VERSION=\"v2.13.1\"\nENV HELM_VERSION=\"${HELM_VERSION}\"\nARG CHARTS=\"calico,flannel,tiller,kube-dns,kubernetes-keystone-webhook\"\nENV CHARTS=\"${CHARTS}\"\nARG HTTP_PROXY=\"\"\nENV HTTP_PROXY=\"${HTTP_PROXY}\"\nENV http_proxy=\"${HTTP_PROXY}\"\nARG HTTPS_PROXY=\"\"\nENV HTTPS_PROXY=\"${HTTPS_PROXY}\"\nENV https_proxy=\"${HTTPS_PROXY}\"\nARG NO_PROXY=\"127.0.0.1,localhost,.svc.cluster.local\"\nENV NO_PROXY=\"${NO_PROXY}\"\nENV no_proxy=\"${NO_PROXY}\"\nENV container=\"docker\" \\\n    DEBIAN_FRONTEND=\"noninteractive\" \\\n    CNI_BIN_DIR=\"/opt/cni/bin\"\nRUN set -ex ; apt-get update ; apt-get upgrade -y ; apt-get install --no-install-recommends bash ca-certificates curl jq python-pip gawk -y ; pip install pip==18.1 --no-cache-dir --upgrade ; hash -r ; pip install setuptools --no-cache-dir --upgrade ; pip install requests kubernetes \"ansible==2.5.5\" --no-cache-dir --upgrade ; for BINARY in kubectl kubeadm; do curl -sSL -o /usr/bin/${BINARY} ${GOOGLE_KUBERNETES_REPO_URL}/${BINARY} ;chmod +x /usr/bin/${BINARY} ; done ; mkdir -p /opt/assets/usr/bin ; curl -sSL -o /opt/assets/usr/bin/kubelet ${GOOGLE_KUBERNETES_REPO_URL}/kubelet ; chmod +x /opt/assets/usr/bin/kubelet ; mkdir -p /opt/assets${CNI_BIN_DIR} ; curl -sSL ${CNI_REPO_URL}/cni-plugins-amd64-$CNI_VERSION.tgz | tar -zxv --strip-components=1 -C /opt/assets${CNI_BIN_DIR} ; TMP_DIR=$( mktemp -d ;) ; curl -sSL ${GOOGLE_HELM_REPO_URL}/helm-${HELM_VERSION}-linux-amd64.tar.gz | tar -zxv --strip-components=1 -C ${TMP_DIR} ; mv ${TMP_DIR}/helm /usr/bin/helm ; rm -rf ${TMP_DIR} ; apt-get purge -y --auto-remove curl ; rm -rf /var/lib/apt/lists/* /tmp/* /root/.cache\nCOPY ./ /tmp/source\nRUN set -ex ; cp -rfav /tmp/source/tools/images/kubeadm-aio/assets/* / ; IFS=',' ; for CHART in $CHARTS; do mv -v /tmp/source/${CHART} /opt/charts/ ; done ; rm -rf /tmp/source\nENTRYPOINT [\"/entrypoint.sh\"]\n","injectedSmells":[],"originalDockerfileHash":"b5b22353ec3d7ad40744aaa6a0498606","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   Copyright 2017 The Openstack-Helm Authors.\n#\n#   Licensed under the Apache License, Version 2.0 (the \"License\");\n#   you may not use this file except in compliance with the License.\n#   You may obtain a copy of the License at\n#\n#       http://www.apache.org/licenses/LICENSE-2.0\n#\n#   Unless required by applicable law or agreed to in writing, software\n#   distributed under the License is distributed on an \"AS IS\" BASIS,\n#   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n#   See the License for the specific language governing permissions and\n#   limitations under the License.\nFROM docker.io/ubuntu:xenial\nMAINTAINER pete.birley@att.com\nARG UBUNTU_URL=http://archive.ubuntu.com/ubuntu/\nARG ALLOW_UNAUTHENTICATED=false\nARG PIP_INDEX_URL=https://pypi.python.org/simple/\nARG PIP_TRUSTED_HOST=pypi.python.org\nENV PIP_INDEX_URL=\"${PIP_INDEX_URL}\"\nENV PIP_TRUSTED_HOST=\"${PIP_TRUSTED_HOST}\"\nCOPY ./tools/images/kubeadm-aio/sources.list /etc/apt/\nRUN sed -i -e \"s|%%UBUNTU_URL%%|${UBUNTU_URL}|g\" /etc/apt/sources.list ; echo \"APT::Get::AllowUnauthenticated \\\"${ALLOW_UNAUTHENTICATED}\\\";\" > /etc/apt/apt.conf.d/allow-unathenticated\nARG GOOGLE_KUBERNETES_REPO_URL=https://storage.googleapis.com/kubernetes-release/release/${KUBE_VERSION}/bin/linux/amd64\nENV GOOGLE_KUBERNETES_REPO_URL=\"${GOOGLE_KUBERNETES_REPO_URL}\"\nARG GOOGLE_HELM_REPO_URL=https://storage.googleapis.com/kubernetes-helm\nENV GOOGLE_HELM_REPO_URL=\"${GOOGLE_HELM_REPO_URL}\"\nARG KUBE_VERSION=\"v1.13.4\"\nENV KUBE_VERSION=\"${KUBE_VERSION}\"\nARG CNI_VERSION=\"v0.6.0\"\nENV CNI_VERSION=\"${CNI_VERSION}\"\nARG CNI_REPO_URL=https://github.com/containernetworking/plugins/releases/download/$CNI_VERSION\nENV CNI_REPO_URL=\"${CNI_REPO_URL}\"\nARG HELM_VERSION=\"v2.13.1\"\nENV HELM_VERSION=\"${HELM_VERSION}\"\nARG CHARTS=\"calico,flannel,tiller,kube-dns,kubernetes-keystone-webhook\"\nENV CHARTS=\"${CHARTS}\"\nARG HTTP_PROXY=\"\"\nENV HTTP_PROXY=\"${HTTP_PROXY}\"\nENV http_proxy=\"${HTTP_PROXY}\"\nARG HTTPS_PROXY=\"\"\nENV HTTPS_PROXY=\"${HTTPS_PROXY}\"\nENV https_proxy=\"${HTTPS_PROXY}\"\nARG NO_PROXY=\"127.0.0.1,localhost,.svc.cluster.local\"\nENV NO_PROXY=\"${NO_PROXY}\"\nENV no_proxy=\"${NO_PROXY}\"\nENV container=\"docker\" \\\n    DEBIAN_FRONTEND=\"noninteractive\" \\\n    CNI_BIN_DIR=\"/opt/cni/bin\"\nRUN set -ex ; apt-get update ; apt-get upgrade -y ; apt-get install --no-install-recommends bash ca-certificates curl jq python-pip gawk -y ; pip install pip==18.1 --no-cache-dir --upgrade ; hash -r ; pip install setuptools --no-cache-dir --upgrade ; pip install requests kubernetes \"ansible==2.5.5\" --no-cache-dir --upgrade ; for BINARY in kubectl kubeadm; do curl -sSL -o /usr/bin/${BINARY} ${GOOGLE_KUBERNETES_REPO_URL}/${BINARY} ;chmod +x /usr/bin/${BINARY} ; done ; mkdir -p /opt/assets/usr/bin ; curl -sSL -o /opt/assets/usr/bin/kubelet ${GOOGLE_KUBERNETES_REPO_URL}/kubelet ; chmod +x /opt/assets/usr/bin/kubelet ; mkdir -p /opt/assets${CNI_BIN_DIR} ; curl -sSL ${CNI_REPO_URL}/cni-plugins-amd64-$CNI_VERSION.tgz | tar -zxv --strip-components=1 -C /opt/assets${CNI_BIN_DIR} ; TMP_DIR=$( mktemp -d ;) ; curl -sSL ${GOOGLE_HELM_REPO_URL}/helm-${HELM_VERSION}-linux-amd64.tar.gz | tar -zxv --strip-components=1 -C ${TMP_DIR} ; mv ${TMP_DIR}/helm /usr/bin/helm ; rm -rf ${TMP_DIR} ; apt-get purge -y --auto-remove curl ; rm -rf /var/lib/apt/lists/* /tmp/* /root/.cache\nCOPY ./ /tmp/source\nRUN set -ex ; cp -rfav /tmp/source/tools/images/kubeadm-aio/assets/* / ; IFS=',' ; for CHART in $CHARTS; do mv -v /tmp/source/${CHART} /opt/charts/ ; done ; rm -rf /tmp/source\nENTRYPOINT [\"/entrypoint.sh\"]\n","originalDockerfileUglifiedHash":"63c350e4da918110362a9dbe10a619ab","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/563e257d3d74d7070e7dee84423fd57e778a0a9b.dockerfile"}