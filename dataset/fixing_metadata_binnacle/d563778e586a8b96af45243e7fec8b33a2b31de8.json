{"seed":3825898904,"processedDockerfileHash":"9659525ee41a21428cce98288c3d32c3","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM nvidia/cuda:8.0-cudnn6-devel-ubuntu16.04\nRUN :\n#   disable interactive functions\nENV DEBIAN_FRONTEND=\"noninteractive\"\n#  ################Install MiniConda and other dependencies##########\nENV CONDA_DIR=\"/opt/conda\"\nENV PATH=\"$CONDA_DIR/bin:$PATH\"\nENV OPENBLAS_NUM_THREADS=\"$(nproc)\"\nRUN mkdir -p $CONDA_DIR \\\n && echo export PATH=$CONDA_DIR/bin:'$PATH' > /etc/profile.d/conda.sh \\\n && apt-get update -y \\\n && (apt-get update ;apt-get install --no-install-recommends wget vim git g++ graphviz software-properties-common python-software-properties python3-dev libhdf5-dev libopenblas-dev liblapack-dev libblas-dev gfortran cpio libmlx4-1 libmlx5-1 librdmacm1 libibverbs1 libmthca1 libdapl2 dapl2-utils -y ) \\\n && rm -rf /var/lib/apt/lists/* \\\n && wget --quiet https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh \\\n && /bin/bash /Miniconda3-latest-Linux-x86_64.sh -f -b -p $CONDA_DIR \\\n && rm Miniconda3-latest-Linux-x86_64.sh\n#  ######################## INTEL MPI ###########################\nRUN cd /tmp \\\n && wget -q 'http://registrationcenter-download.intel.com/akdlm/irc_nas/tec/11595/l_mpi_2017.3.196.tgz' \\\n && tar zxvf l_mpi_2017.3.196.tgz \\\n && sed -i -e 's/^ACCEPT_EULA=decline/ACCEPT_EULA=accept/g' /tmp/l_mpi_2017.3.196/silent.cfg \\\n && sed -i -e 's|^#ACTIVATION_LICENSE_FILE=|ACTIVATION_LICENSE_FILE=/tmp/l_mpi_2017.3.196/USE_SERVER.lic|g' /tmp/l_mpi_2017.3.196/silent.cfg \\\n && sed -i -e 's/^ACTIVATION_TYPE=exist_lic/ACTIVATION_TYPE=license_server/g' /tmp/l_mpi_2017.3.196/silent.cfg \\\n && cd /tmp/l_mpi_2017.3.196 \\\n && ./install.sh -s silent.cfg \\\n && echo \"source /opt/intel/compilers_and_libraries_2017.4.196/linux/mpi/intel64/bin/mpivars.sh\" >> ~/.bashrc\n#  ######################NCCL###########################\nENV CPATH=\"/usr/local/cuda/include:/usr/local/include:$CPATH\"\nRUN cd /usr/local \\\n && git clone https://github.com/NVIDIA/nccl.git \\\n && cd nccl \\\n && make CUDA_HOME=/usr/local/cuda -j\"$( nproc ;)\" \\\n && make install \\\n && ldconfig\n#  ###################Python 3#########################\nARG python_version=3.5.2\nRUN conda install -y python=${python_version} \\\n && pip install pip==23.1 -U \\\n && . /opt/intel/compilers_and_libraries_2017.4.196/linux/mpi/intel64/bin/mpivars.sh \\\n && conda install Pillow scikit-learn notebook pandas matplotlib mkl nose pyyaml six h5py \\\n && pip install cupy==12.0.0 \\\n && pip install mpi4py==3.1.4 \\\n && pip install cython==0.29.34 \\\n && pip install chainer==7.8.1 \\\n && pip install chainercv==0.13.1 \\\n && pip install chainermn==1.3.1 \\\n && conda clean -yt\nENV PYTHONPATH=\"$CONDA_DIR/lib/python3.5/site-packages/:$PYTHONPATH\"\n#  #####################################################\nENV PYTHONPATH=\"/src/:$PYTHONPATH\"\n#  ################ remove Intel components #####################\nRUN rm -rf /opt/intel\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM nvidia/cuda:8.0-cudnn6-devel-ubuntu16.04\nRUN apt-get update\n#  disable interactive functions\nENV DEBIAN_FRONTEND=\"noninteractive\"\n# ################Install MiniConda and other dependencies##########\nENV CONDA_DIR=\"/opt/conda\"\nENV PATH=\"$CONDA_DIR/bin:$PATH\"\nENV OPENBLAS_NUM_THREADS=\"$(nproc)\"\nRUN mkdir -p $CONDA_DIR \\\n && echo export PATH=$CONDA_DIR/bin:'$PATH' > /etc/profile.d/conda.sh \\\n && apt-get update -y \\\n && apt-get install wget vim git g++ graphviz software-properties-common python-software-properties python3-dev libhdf5-dev libopenblas-dev liblapack-dev libblas-dev gfortran cpio libmlx4-1 libmlx5-1 librdmacm1 libibverbs1 libmthca1 libdapl2 dapl2-utils -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && wget --quiet https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh \\\n && /bin/bash /Miniconda3-latest-Linux-x86_64.sh -f -b -p $CONDA_DIR \\\n && rm Miniconda3-latest-Linux-x86_64.sh\n# ######################## INTEL MPI ###########################\nRUN cd /tmp \\\n && wget -q 'http://registrationcenter-download.intel.com/akdlm/irc_nas/tec/11595/l_mpi_2017.3.196.tgz' \\\n && tar zxvf l_mpi_2017.3.196.tgz \\\n && sed -i -e 's/^ACCEPT_EULA=decline/ACCEPT_EULA=accept/g' /tmp/l_mpi_2017.3.196/silent.cfg \\\n && sed -i -e 's|^#ACTIVATION_LICENSE_FILE=|ACTIVATION_LICENSE_FILE=/tmp/l_mpi_2017.3.196/USE_SERVER.lic|g' /tmp/l_mpi_2017.3.196/silent.cfg \\\n && sed -i -e 's/^ACTIVATION_TYPE=exist_lic/ACTIVATION_TYPE=license_server/g' /tmp/l_mpi_2017.3.196/silent.cfg \\\n && cd /tmp/l_mpi_2017.3.196 \\\n && ./install.sh -s silent.cfg \\\n && echo \"source /opt/intel/compilers_and_libraries_2017.4.196/linux/mpi/intel64/bin/mpivars.sh\" >> ~/.bashrc\n# ######################NCCL###########################\nENV CPATH=\"/usr/local/cuda/include:/usr/local/include:$CPATH\"\nRUN cd /usr/local \\\n && git clone https://github.com/NVIDIA/nccl.git \\\n && cd nccl \\\n && make CUDA_HOME=/usr/local/cuda -j\"$( nproc ;)\" \\\n && make install \\\n && ldconfig\n# ###################Python 3#########################\nARG python_version=3.5.2\nRUN conda install -y python=${python_version} \\\n && pip install pip -U \\\n && . /opt/intel/compilers_and_libraries_2017.4.196/linux/mpi/intel64/bin/mpivars.sh \\\n && conda install Pillow scikit-learn notebook pandas matplotlib mkl nose pyyaml six h5py \\\n && pip install cupy \\\n && pip install mpi4py \\\n && pip install cython \\\n && pip install chainer \\\n && pip install chainercv \\\n && pip install chainermn \\\n && conda clean -yt\nENV PYTHONPATH=\"$CONDA_DIR/lib/python3.5/site-packages/:$PYTHONPATH\"\n# #####################################################\nENV PYTHONPATH=\"/src/:$PYTHONPATH\"\n# ################ remove Intel components #####################\nRUN rm -rf /opt/intel\n","injectedSmells":[],"originalDockerfileHash":"8daed16f9dea46bf34954e56e40a9598","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM nvidia/cuda:8.0-cudnn6-devel-ubuntu16.04\nRUN apt-get update\n#   disable interactive functions\nENV DEBIAN_FRONTEND=\"noninteractive\"\n#  ################Install MiniConda and other dependencies##########\nENV CONDA_DIR=\"/opt/conda\"\nENV PATH=\"$CONDA_DIR/bin:$PATH\"\nENV OPENBLAS_NUM_THREADS=\"$(nproc)\"\nRUN mkdir -p $CONDA_DIR \\\n && echo export PATH=$CONDA_DIR/bin:'$PATH' > /etc/profile.d/conda.sh \\\n && apt-get update -y \\\n && apt-get install wget vim git g++ graphviz software-properties-common python-software-properties python3-dev libhdf5-dev libopenblas-dev liblapack-dev libblas-dev gfortran cpio libmlx4-1 libmlx5-1 librdmacm1 libibverbs1 libmthca1 libdapl2 dapl2-utils -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && wget --quiet https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh \\\n && /bin/bash /Miniconda3-latest-Linux-x86_64.sh -f -b -p $CONDA_DIR \\\n && rm Miniconda3-latest-Linux-x86_64.sh\n#  ######################## INTEL MPI ###########################\nRUN cd /tmp \\\n && wget -q 'http://registrationcenter-download.intel.com/akdlm/irc_nas/tec/11595/l_mpi_2017.3.196.tgz' \\\n && tar zxvf l_mpi_2017.3.196.tgz \\\n && sed -i -e 's/^ACCEPT_EULA=decline/ACCEPT_EULA=accept/g' /tmp/l_mpi_2017.3.196/silent.cfg \\\n && sed -i -e 's|^#ACTIVATION_LICENSE_FILE=|ACTIVATION_LICENSE_FILE=/tmp/l_mpi_2017.3.196/USE_SERVER.lic|g' /tmp/l_mpi_2017.3.196/silent.cfg \\\n && sed -i -e 's/^ACTIVATION_TYPE=exist_lic/ACTIVATION_TYPE=license_server/g' /tmp/l_mpi_2017.3.196/silent.cfg \\\n && cd /tmp/l_mpi_2017.3.196 \\\n && ./install.sh -s silent.cfg \\\n && echo \"source /opt/intel/compilers_and_libraries_2017.4.196/linux/mpi/intel64/bin/mpivars.sh\" >> ~/.bashrc\n#  ######################NCCL###########################\nENV CPATH=\"/usr/local/cuda/include:/usr/local/include:$CPATH\"\nRUN cd /usr/local \\\n && git clone https://github.com/NVIDIA/nccl.git \\\n && cd nccl \\\n && make CUDA_HOME=/usr/local/cuda -j\"$( nproc ;)\" \\\n && make install \\\n && ldconfig\n#  ###################Python 3#########################\nARG python_version=3.5.2\nRUN conda install -y python=${python_version} \\\n && pip install pip -U \\\n && . /opt/intel/compilers_and_libraries_2017.4.196/linux/mpi/intel64/bin/mpivars.sh \\\n && conda install Pillow scikit-learn notebook pandas matplotlib mkl nose pyyaml six h5py \\\n && pip install cupy \\\n && pip install mpi4py \\\n && pip install cython \\\n && pip install chainer \\\n && pip install chainercv \\\n && pip install chainermn \\\n && conda clean -yt\nENV PYTHONPATH=\"$CONDA_DIR/lib/python3.5/site-packages/:$PYTHONPATH\"\n#  #####################################################\nENV PYTHONPATH=\"/src/:$PYTHONPATH\"\n#  ################ remove Intel components #####################\nRUN rm -rf /opt/intel\n","originalDockerfileUglifiedHash":"6bff72a9d18802f85f8ebdd55fea7e0c","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/d563778e586a8b96af45243e7fec8b33a2b31de8.dockerfile"}