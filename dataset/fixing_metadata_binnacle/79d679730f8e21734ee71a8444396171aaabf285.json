{"seed":4235021735,"processedDockerfileHash":"2c2c361485262cd245793d562b92fd7f","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM nvidia/cuda:8.0-cudnn6-devel-ubuntu16.04\nENV DEBIAN_FRONTEND=\"noninteractive\"\nRUN apt-get update \\\n && apt-get install --no-install-recommends build-essential bzip2 ca-certificates cmake git libatlas-base-dev libboost-all-dev libgflags-dev libgoogle-glog-dev libhdf5-serial-dev libleveldb-dev liblmdb-dev libopencv-dev libprotobuf-dev libsnappy-dev locales netcat protobuf-compiler python3-dev python3-numpy python3-pip python3-pydot python3-scipy python3-setuptools sudo wget -y \\\n && rm -rf /var/lib/apt/lists/*\nRUN pip3 install pip==9.0.3 \\\n && pip3 install -U cython h5py ipython jupyter leveldb lmdb matplotlib networkx nose numpy pandas Pillow protobuf pydot python-dateutil python-gflags pyyaml scikit-image scipy six \\\n && rm -rf ~/.cache/pip\nENV CAFFE_ROOT=\"/opt/caffe\"\nWORKDIR $CAFFE_ROOT\nRUN git clone https://github.com/NVIDIA/nccl.git \\\n && cd nccl \\\n && make -j$( nproc ;) install \\\n && cd .. \\\n && rm -rf nccl\nENV CLONE_TAG=\"1.0\"\nRUN git clone -b ${CLONE_TAG} --depth 1 https://github.com/BVLC/caffe.git . \\\n && mkdir build \\\n && cd build \\\n && cmake -DUSE_CUDNN=1 -DUSE_NCCL=1 -Dpython_version=3 .. \\\n && make -j$( nproc ;)\nENV PYCAFFE_ROOT=\"$CAFFE_ROOT/python\"\nENV PYTHONPATH=\"$PYCAFFE_ROOT:$PYTHONPATH\"\nENV PATH=\"$CAFFE_ROOT/build/tools:$PYCAFFE_ROOT:$PATH\"\nRUN echo '$CAFFE_ROOT/build/lib' >> /etc/ld.so.conf.d/caffe.conf \\\n && ldconfig\nRUN echo \"en_US.UTF-8 UTF-8\" > /etc/locale.gen \\\n && locale-gen\n#   Install Tini\nRUN wget --quiet https://github.com/krallin/tini/releases/download/v0.10.0/tini \\\n && echo \"1361527f39190a7338a0b434bd8c88ff7233ce7b9a4876f3315c22fce7eca1b0 *tini\" | sha256sum -c - \\\n && mv tini /usr/local/bin/tini \\\n && chmod +x /usr/local/bin/tini\n#   Configure environment\nENV SHELL=\"/bin/bash\" \\\n    NB_USER=\"aurora\" \\\n    NB_UID=\"1000\" \\\n    NB_GID=\"2000\" \\\n    LC_ALL=\"en_US.UTF-8\" \\\n    LANG=\"en_US.UTF-8\" \\\n    LANGUAGE=\"en_US.UTF-8\"\n#   Create aurora user with UID=1000 and in the 'aurora' group\nRUN groupadd -g $NB_GID $NB_USER \\\n && useradd -m -s $SHELL -N -u $NB_UID -g $NB_GID $NB_USER \\\n && echo '%'$NB_USER 'ALL=(ALL:ALL) NOPASSWD:ALL' >> /etc/sudoers\nEXPOSE 8888/tcp\nWORKDIR /workspace\n#   Add local files as late as possible to avoid cache busting\nCOPY start.sh /usr/local/bin/\nCOPY start-notebook.sh /usr/local/bin/\nCOPY jupyter_notebook_config.py /etc/jupyter/\n#   Install Aurora job submit tool\nARG CACHE_DATE\nARG SUBMIT_TOOL_NAME=aurora\nRUN wget https://raw.githubusercontent.com/linkernetworks/aurora/master/install.sh -O - | bash \\\n && if [ \"$SUBMIT_TOOL_NAME\" != \"aurora\" ] ; then mv /usr/local/bin/aurora /usr/local/bin/$SUBMIT_TOOL_NAME ; fi\n#   Configure container startup\nENTRYPOINT [\"tini\", \"--\"]\nCMD [\"start-notebook.sh\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM nvidia/cuda:8.0-cudnn6-devel-ubuntu16.04\nENV DEBIAN_FRONTEND=\"noninteractive\"\nRUN apt-get update \\\n && apt-get install --no-install-recommends build-essential bzip2 ca-certificates cmake git libatlas-base-dev libboost-all-dev libgflags-dev libgoogle-glog-dev libhdf5-serial-dev libleveldb-dev liblmdb-dev libopencv-dev libprotobuf-dev libsnappy-dev locales netcat protobuf-compiler python3-dev python3-numpy python3-pip python3-pydot python3-scipy python3-setuptools sudo wget -y \\\n && rm -rf /var/lib/apt/lists/*\nRUN pip3 install pip==9.0.3 \\\n && pip3 install -U cython h5py ipython jupyter leveldb lmdb matplotlib networkx nose numpy pandas Pillow protobuf pydot python-dateutil python-gflags pyyaml scikit-image scipy six \\\n && rm -rf ~/.cache/pip\nENV CAFFE_ROOT=\"/opt/caffe\"\nWORKDIR $CAFFE_ROOT\nRUN git clone https://github.com/NVIDIA/nccl.git \\\n && cd nccl \\\n && make -j$( nproc ;) install \\\n && cd .. \\\n && rm -rf nccl\nENV CLONE_TAG=\"1.0\"\nRUN git clone -b ${CLONE_TAG} --depth 1 https://github.com/BVLC/caffe.git . \\\n && mkdir build \\\n && cd build \\\n && cmake -DUSE_CUDNN=1 -DUSE_NCCL=1 -Dpython_version=3 .. \\\n && make -j$( nproc ;)\nENV PYCAFFE_ROOT=\"$CAFFE_ROOT/python\"\nENV PYTHONPATH=\"$PYCAFFE_ROOT:$PYTHONPATH\"\nENV PATH=\"$CAFFE_ROOT/build/tools:$PYCAFFE_ROOT:$PATH\"\nRUN echo '$CAFFE_ROOT/build/lib' >> /etc/ld.so.conf.d/caffe.conf \\\n && ldconfig\nRUN echo \"en_US.UTF-8 UTF-8\" > /etc/locale.gen \\\n && locale-gen\n#  Install Tini\nRUN wget --quiet https://github.com/krallin/tini/releases/download/v0.10.0/tini \\\n && echo \"1361527f39190a7338a0b434bd8c88ff7233ce7b9a4876f3315c22fce7eca1b0 *tini\" | sha256sum -c - \\\n && mv tini /usr/local/bin/tini \\\n && chmod +x /usr/local/bin/tini\n#  Configure environment\nENV SHELL=\"/bin/bash\" \\\n    NB_USER=\"aurora\" \\\n    NB_UID=\"1000\" \\\n    NB_GID=\"2000\" \\\n    LC_ALL=\"en_US.UTF-8\" \\\n    LANG=\"en_US.UTF-8\" \\\n    LANGUAGE=\"en_US.UTF-8\"\n#  Create aurora user with UID=1000 and in the 'aurora' group\nRUN groupadd -g $NB_GID $NB_USER \\\n && useradd -m -s $SHELL -N -u $NB_UID -g $NB_GID $NB_USER \\\n && echo '%'$NB_USER 'ALL=(ALL:ALL) NOPASSWD:ALL' >> /etc/sudoers\nEXPOSE 8888/tcp\nWORKDIR /workspace\n#  Add local files as late as possible to avoid cache busting\nCOPY start.sh /usr/local/bin/\nCOPY start-notebook.sh /usr/local/bin/\nCOPY jupyter_notebook_config.py /etc/jupyter/\n#  Install Aurora job submit tool\nARG CACHE_DATE\nARG SUBMIT_TOOL_NAME=aurora\nRUN wget https://raw.githubusercontent.com/linkernetworks/aurora/master/install.sh -O - | bash \\\n && if [ \"$SUBMIT_TOOL_NAME\" != \"aurora\" ] ; then mv /usr/local/bin/aurora /usr/local/bin/$SUBMIT_TOOL_NAME ; fi\n#  Configure container startup\nENTRYPOINT [\"tini\", \"--\"]\nCMD [\"start-notebook.sh\"]\n","injectedSmells":[],"originalDockerfileHash":"9754879ee174f3de5b09f52efc6d4da7","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM nvidia/cuda:8.0-cudnn6-devel-ubuntu16.04\nENV DEBIAN_FRONTEND=\"noninteractive\"\nRUN apt-get update \\\n && apt-get install --no-install-recommends build-essential bzip2 ca-certificates cmake git libatlas-base-dev libboost-all-dev libgflags-dev libgoogle-glog-dev libhdf5-serial-dev libleveldb-dev liblmdb-dev libopencv-dev libprotobuf-dev libsnappy-dev locales netcat protobuf-compiler python3-dev python3-numpy python3-pip python3-pydot python3-scipy python3-setuptools sudo wget -y \\\n && rm -rf /var/lib/apt/lists/*\nRUN pip3 install pip==9.0.3 \\\n && pip3 install -U cython h5py ipython jupyter leveldb lmdb matplotlib networkx nose numpy pandas Pillow protobuf pydot python-dateutil python-gflags pyyaml scikit-image scipy six \\\n && rm -rf ~/.cache/pip\nENV CAFFE_ROOT=\"/opt/caffe\"\nWORKDIR $CAFFE_ROOT\nRUN git clone https://github.com/NVIDIA/nccl.git \\\n && cd nccl \\\n && make -j$( nproc ;) install \\\n && cd .. \\\n && rm -rf nccl\nENV CLONE_TAG=\"1.0\"\nRUN git clone -b ${CLONE_TAG} --depth 1 https://github.com/BVLC/caffe.git . \\\n && mkdir build \\\n && cd build \\\n && cmake -DUSE_CUDNN=1 -DUSE_NCCL=1 -Dpython_version=3 .. \\\n && make -j$( nproc ;)\nENV PYCAFFE_ROOT=\"$CAFFE_ROOT/python\"\nENV PYTHONPATH=\"$PYCAFFE_ROOT:$PYTHONPATH\"\nENV PATH=\"$CAFFE_ROOT/build/tools:$PYCAFFE_ROOT:$PATH\"\nRUN echo '$CAFFE_ROOT/build/lib' >> /etc/ld.so.conf.d/caffe.conf \\\n && ldconfig\nRUN echo \"en_US.UTF-8 UTF-8\" > /etc/locale.gen \\\n && locale-gen\n#   Install Tini\nRUN wget --quiet https://github.com/krallin/tini/releases/download/v0.10.0/tini \\\n && echo \"1361527f39190a7338a0b434bd8c88ff7233ce7b9a4876f3315c22fce7eca1b0 *tini\" | sha256sum -c - \\\n && mv tini /usr/local/bin/tini \\\n && chmod +x /usr/local/bin/tini\n#   Configure environment\nENV SHELL=\"/bin/bash\" \\\n    NB_USER=\"aurora\" \\\n    NB_UID=\"1000\" \\\n    NB_GID=\"2000\" \\\n    LC_ALL=\"en_US.UTF-8\" \\\n    LANG=\"en_US.UTF-8\" \\\n    LANGUAGE=\"en_US.UTF-8\"\n#   Create aurora user with UID=1000 and in the 'aurora' group\nRUN groupadd -g $NB_GID $NB_USER \\\n && useradd -m -s $SHELL -N -u $NB_UID -g $NB_GID $NB_USER \\\n && echo '%'$NB_USER 'ALL=(ALL:ALL) NOPASSWD:ALL' >> /etc/sudoers\nEXPOSE 8888/tcp\nWORKDIR /workspace\n#   Add local files as late as possible to avoid cache busting\nCOPY start.sh /usr/local/bin/\nCOPY start-notebook.sh /usr/local/bin/\nCOPY jupyter_notebook_config.py /etc/jupyter/\n#   Install Aurora job submit tool\nARG CACHE_DATE\nARG SUBMIT_TOOL_NAME=aurora\nRUN wget https://raw.githubusercontent.com/linkernetworks/aurora/master/install.sh -O - | bash \\\n && if [ \"$SUBMIT_TOOL_NAME\" != \"aurora\" ] ; then mv /usr/local/bin/aurora /usr/local/bin/$SUBMIT_TOOL_NAME ; fi\n#   Configure container startup\nENTRYPOINT [\"tini\", \"--\"]\nCMD [\"start-notebook.sh\"]\n","originalDockerfileUglifiedHash":"f91764a30194f931ad30b80505137a43","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/79d679730f8e21734ee71a8444396171aaabf285.dockerfile"}