{"seed":2800887202,"processedDockerfileHash":"0ab01f1997de9b186897a8671587fe4b","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-gem","use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"#   DOCKER-VERSION 1.2.0\nFROM ubuntu:14.04\nMAINTAINER Seyhun Akyurek \"seyhunak@gmail.com\"\n#   Install dependency packages\nRUN :\nRUN apt-get upgrade -y\nRUN (apt-get update ;apt-get install --no-install-recommends software-properties-common=0.92.37.8 -y )\nRUN (apt-get update ;apt-get install --no-install-recommends make=3.81-8.2ubuntu3 gcc=4:4.8.2-1ubuntu6 wget=1.15-1ubuntu1.14.04.5 openjdk-6-jre=6b41-1.13.13-0ubuntu0.14.04.1 -y )\nRUN (apt-get update ;apt-get install --no-install-recommends git=1:1.9.1-1ubuntu0.10 -y )\nRUN apt-get clean\n#   Deploy rbenv and ruby-build\nRUN git clone https://github.com/sstephenson/rbenv.git /root/.rbenv\nRUN git clone https://github.com/sstephenson/ruby-build.git /root/.rbenv/plugins/ruby-build\nENV RBENV_ROOT=\"/root/.rbenv\"\nENV PATH=\"/root/.rbenv/bin:/root/.rbenv/shims:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\"\nCOPY ./rbenv.sh /etc/profile.d/rbenv.sh\n#   Install Ruby\nRUN rbenv install 2.1.2\nRUN rbenv global 2.1.2\nRUN rbenv rehash\n#   Install Bundler\nRUN gem install bundler --version 2.4.12 --no-ri --no-rdoc\n#   Install Rails\nRUN gem install rails-4.2.0.beta1 --version unknown\n#   Install Curl and Node.js (for asset pipeline)\nRUN (apt-get update ;apt-get install --no-install-recommends curl=7.35.0-1ubuntu2.20 -qq -y )\nRUN (apt-get update ;apt-get install --no-install-recommends nodejs=0.10.25~dfsg2-2ubuntu1.2 -qq -y )\n#   Install nginx\nRUN add-apt-repository -y ppa:nginx/stable\nRUN :\nRUN (apt-get update ;apt-get install --no-install-recommends nginx=1.4.6-1ubuntu3.9 -qq -y )\nRUN echo \"daemon off;\" >> /etc/nginx/nginx.conf\nRUN chown -R www-data:www-data /var/lib/nginx\nCOPY nginx_sites.conf /etc/nginx/sites-enabled/default\n#   Publish port 80\nEXPOSE 80/tcp\n#   Start nginx when container starts\nENTRYPOINT /usr/sbin/nginx\n#   Install foreman\nRUN gem install foreman --version 0.87.2\n#   Add default foreman config\nCOPY Procfile /home/rails/Procfile\n#   Install Unicorn\nRUN gem install unicorn --version 6.1.0\n#   Add default unicorn config\nCOPY unicorn.rb /home/rails/config/unicorn.rb\n#   Install Beanstalkd\nRUN (apt-get update ;apt-get install --no-install-recommends beanstalkd=1.9-2ubuntu1 -qq -y )\n#   Install backburner\nRUN gem install backburner --version 1.6.1\n#   Add default unicorn config\nCOPY backburner.rb /home/rails/config/initializers/backburner.rb\n#   Install Solr\nRUN wget http://archive.apache.org/dist/lucene/solr/3.6.2/apache-solr-3.6.2.tgz -O /tmp/pkg.tar.gz\nRUN (cd /tmp \\\n && tar zxf pkg.tar.gz \\\n && mv apache-solr-* /opt/solr )\nRUN rm -rf /tmp/*\nCOPY run.sh /usr/local/bin/run\nRUN chmod +x /usr/local/bin/run\nEXPOSE 8983/tcp\nCMD [\"/usr/local/bin/run\"]\n#   Install Solr\nRUN gem install sunspot --version 2.6.0\nRUN gem install sunspot_solr --version 2.6.0\nRUN gem install sunspot_rails --version 2.6.0\n#   Install MySQL (for mysql, mysql2 gem)\nRUN (apt-get update ;apt-get install --no-install-recommends libmysqlclient-dev=5.5.62-0ubuntu0.14.04.1 -qq -y )\nRUN gem install mysql2 --version 0.5.5\n#   Install Redis\nRUN (apt-get update ;apt-get install --no-install-recommends python-pip=1.5.4-1ubuntu4 redis-server=2:2.8.4-2ubuntu0.2 -qq -y )\n#   Setting up Rails app\nWORKDIR /home/rails\nONBUILD ADD Gemfile /home/rails/Gemfile\nONBUILD ADD Gemfile.lock /home/rails/Gemfile.lock\nONBUILD RUN bundle install --without development test\nONBUILD ADD . /home/rails\n#   Set ENV Variables\nENV RAILS_ENV=\"production\"\nCMD bundle exec rake assets:precompile \\\n && foreman start -f Procfile\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#  DOCKER-VERSION 1.2.0\nFROM ubuntu:14.04\nMAINTAINER Seyhun Akyurek \"seyhunak@gmail.com\"\n#  Install dependency packages\nRUN apt-get update\nRUN apt-get upgrade -y\nRUN apt-get install software-properties-common -y\nRUN apt-get install make gcc wget openjdk-6-jre -y\nRUN apt-get install git -y\nRUN apt-get clean\n#  Deploy rbenv and ruby-build\nRUN git clone https://github.com/sstephenson/rbenv.git /root/.rbenv\nRUN git clone https://github.com/sstephenson/ruby-build.git /root/.rbenv/plugins/ruby-build\nENV RBENV_ROOT=\"/root/.rbenv\"\nENV PATH=\"/root/.rbenv/bin:/root/.rbenv/shims:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\"\nADD ./rbenv.sh /etc/profile.d/rbenv.sh\n#  Install Ruby\nRUN rbenv install 2.1.2\nRUN rbenv global 2.1.2\nRUN rbenv rehash\n#  Install Bundler\nRUN gem install bundler --no-ri --no-rdoc\n#  Install Rails\nRUN gem install rails-4.2.0.beta1\n#  Install Curl and Node.js (for asset pipeline)\nRUN apt-get install curl -qq -y\nRUN apt-get install nodejs -qq -y\n#  Install nginx\nRUN add-apt-repository -y ppa:nginx/stable\nRUN apt-get update\nRUN apt-get install nginx -qq -y\nRUN echo \"daemon off;\" >> /etc/nginx/nginx.conf\nRUN chown -R www-data:www-data /var/lib/nginx\nADD nginx_sites.conf /etc/nginx/sites-enabled/default\n#  Publish port 80\nEXPOSE 80/tcp\n#  Start nginx when container starts\nENTRYPOINT /usr/sbin/nginx\n#  Install foreman\nRUN gem install foreman\n#  Add default foreman config\nADD Procfile /home/rails/Procfile\n#  Install Unicorn\nRUN gem install unicorn\n#  Add default unicorn config\nADD unicorn.rb /home/rails/config/unicorn.rb\n#  Install Beanstalkd\nRUN apt-get install beanstalkd -qq -y\n#  Install backburner\nRUN gem install backburner\n#  Add default unicorn config\nADD backburner.rb /home/rails/config/initializers/backburner.rb\n#  Install Solr\nRUN wget http://archive.apache.org/dist/lucene/solr/3.6.2/apache-solr-3.6.2.tgz -O /tmp/pkg.tar.gz\nRUN (cd /tmp \\\n && tar zxf pkg.tar.gz \\\n && mv apache-solr-* /opt/solr )\nRUN rm -rf /tmp/*\nADD run.sh /usr/local/bin/run\nRUN chmod +x /usr/local/bin/run\nEXPOSE 8983/tcp\nCMD [\"/usr/local/bin/run\"]\n#  Install Solr\nRUN gem install sunspot\nRUN gem install sunspot_solr\nRUN gem install sunspot_rails\n#  Install MySQL (for mysql, mysql2 gem)\nRUN apt-get install libmysqlclient-dev -qq -y\nRUN gem install mysql2\n#  Install Redis\nRUN apt-get install python-pip redis-server -qq -y\n#  Setting up Rails app\nWORKDIR /home/rails\nONBUILD ADD Gemfile /home/rails/Gemfile\nONBUILD ADD Gemfile.lock /home/rails/Gemfile.lock\nONBUILD RUN bundle install --without development test\nONBUILD ADD . /home/rails\n#  Set ENV Variables\nENV RAILS_ENV=\"production\"\nCMD bundle exec rake assets:precompile \\\n && foreman start -f Procfile\n","injectedSmells":[],"originalDockerfileHash":"b4df7649761e725e75a78254a6f225a2","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   DOCKER-VERSION 1.2.0\nFROM ubuntu:14.04\nMAINTAINER Seyhun Akyurek \"seyhunak@gmail.com\"\n#   Install dependency packages\nRUN apt-get update\nRUN apt-get upgrade -y\nRUN apt-get install software-properties-common -y\nRUN apt-get install make gcc wget openjdk-6-jre -y\nRUN apt-get install git -y\nRUN apt-get clean\n#   Deploy rbenv and ruby-build\nRUN git clone https://github.com/sstephenson/rbenv.git /root/.rbenv\nRUN git clone https://github.com/sstephenson/ruby-build.git /root/.rbenv/plugins/ruby-build\nENV RBENV_ROOT=\"/root/.rbenv\"\nENV PATH=\"/root/.rbenv/bin:/root/.rbenv/shims:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\"\nADD ./rbenv.sh /etc/profile.d/rbenv.sh\n#   Install Ruby\nRUN rbenv install 2.1.2\nRUN rbenv global 2.1.2\nRUN rbenv rehash\n#   Install Bundler\nRUN gem install bundler --no-ri --no-rdoc\n#   Install Rails\nRUN gem install rails-4.2.0.beta1\n#   Install Curl and Node.js (for asset pipeline)\nRUN apt-get install curl -qq -y\nRUN apt-get install nodejs -qq -y\n#   Install nginx\nRUN add-apt-repository -y ppa:nginx/stable\nRUN apt-get update\nRUN apt-get install nginx -qq -y\nRUN echo \"daemon off;\" >> /etc/nginx/nginx.conf\nRUN chown -R www-data:www-data /var/lib/nginx\nADD nginx_sites.conf /etc/nginx/sites-enabled/default\n#   Publish port 80\nEXPOSE 80/tcp\n#   Start nginx when container starts\nENTRYPOINT /usr/sbin/nginx\n#   Install foreman\nRUN gem install foreman\n#   Add default foreman config\nADD Procfile /home/rails/Procfile\n#   Install Unicorn\nRUN gem install unicorn\n#   Add default unicorn config\nADD unicorn.rb /home/rails/config/unicorn.rb\n#   Install Beanstalkd\nRUN apt-get install beanstalkd -qq -y\n#   Install backburner\nRUN gem install backburner\n#   Add default unicorn config\nADD backburner.rb /home/rails/config/initializers/backburner.rb\n#   Install Solr\nRUN wget http://archive.apache.org/dist/lucene/solr/3.6.2/apache-solr-3.6.2.tgz -O /tmp/pkg.tar.gz\nRUN (cd /tmp \\\n && tar zxf pkg.tar.gz \\\n && mv apache-solr-* /opt/solr )\nRUN rm -rf /tmp/*\nADD run.sh /usr/local/bin/run\nRUN chmod +x /usr/local/bin/run\nEXPOSE 8983/tcp\nCMD [\"/usr/local/bin/run\"]\n#   Install Solr\nRUN gem install sunspot\nRUN gem install sunspot_solr\nRUN gem install sunspot_rails\n#   Install MySQL (for mysql, mysql2 gem)\nRUN apt-get install libmysqlclient-dev -qq -y\nRUN gem install mysql2\n#   Install Redis\nRUN apt-get install python-pip redis-server -qq -y\n#   Setting up Rails app\nWORKDIR /home/rails\nONBUILD ADD Gemfile /home/rails/Gemfile\nONBUILD ADD Gemfile.lock /home/rails/Gemfile.lock\nONBUILD RUN bundle install --without development test\nONBUILD ADD . /home/rails\n#   Set ENV Variables\nENV RAILS_ENV=\"production\"\nCMD bundle exec rake assets:precompile \\\n && foreman start -f Procfile\n","originalDockerfileUglifiedHash":"2ef78bce0d4a34857ec680b2c2955461","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/519c3cc032b0d5129b235032a03cc30c9959b7a6.dockerfile"}