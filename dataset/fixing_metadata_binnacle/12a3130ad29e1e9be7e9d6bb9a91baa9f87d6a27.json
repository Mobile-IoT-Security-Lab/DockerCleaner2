{"seed":2298253104,"processedDockerfileHash":"852c6b54aaa24f26ad49f34bd69e82f1","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM debian:stretch-slim\nLABEL maintainer=\"NGINX Docker Maintainers <docker-maint@nginx.com>\"\nENV NGINX_VERSION=\"1.17.0\"\nENV NJS_VERSION=\"0.3.2\"\nENV PKG_RELEASE=\"1~stretch\"\nRUN set -x \\\n && addgroup --system --gid 101 nginx \\\n && adduser --system --disabled-login --ingroup nginx --no-create-home --home /nonexistent --gecos \"nginx user\" --shell /bin/false --uid 101 nginx \\\n && apt-get update \\\n && apt-get install --no-install-recommends gnupg1 apt-transport-https ca-certificates --no-install-suggests -y \\\n && NGINX_GPGKEY=573BFD6B3D8FBC641079A6ABABF5BD827BD9BF62 ; found='' ; for server in ha.pool.sks-keyservers.net hkp://keyserver.ubuntu.com:80 hkp://p80.pool.sks-keyservers.net:80 pgp.mit.edu; do echo \"Fetching GPG key $NGINX_GPGKEY from $server\" ;apt-key adv --keyserver \"$server\" --keyserver-options timeout=10 --recv-keys \"$NGINX_GPGKEY\" \\\n && found=yes \\\n && break ; done ; test -z \"$found\" \\\n && echo \"error: failed to fetch GPG key $NGINX_GPGKEY\" >&2 \\\n && exit 1 ; apt-get remove --purge --auto-remove -y gnupg1 \\\n && rm -rf /var/lib/apt/lists/* \\\n && dpkgArch=\"$( dpkg --print-architecture ;)\" \\\n && nginxPackages=\" nginx=${NGINX_VERSION}-${PKG_RELEASE} nginx-module-xslt=${NGINX_VERSION}-${PKG_RELEASE} nginx-module-geoip=${NGINX_VERSION}-${PKG_RELEASE} nginx-module-image-filter=${NGINX_VERSION}-${PKG_RELEASE} nginx-module-njs=${NGINX_VERSION}.${NJS_VERSION}-${PKG_RELEASE} \" \\\n && case \"$dpkgArch\" in (amd64|i386) echo \"deb https://nginx.org/packages/mainline/debian/ stretch nginx\" >> /etc/apt/sources.list.d/nginx.list \\\n && apt-get update ;;(*) echo \"deb-src https://nginx.org/packages/mainline/debian/ stretch nginx\" >> /etc/apt/sources.list.d/nginx.list \\\n && tempDir=\"$( mktemp -d ;)\" \\\n && chmod 777 \"$tempDir\" \\\n && savedAptMark=\"$( apt-mark showmanual ;)\" \\\n && apt-get update \\\n && apt-get build-dep -y $nginxPackages \\\n && (cd \"$tempDir\" \\\n && DEB_BUILD_OPTIONS=\"nocheck parallel=$( nproc ;)\" apt-get source --compile $nginxPackages ) \\\n && apt-mark showmanual | xargs apt-mark auto > /dev/null \\\n && { [ -z \"$savedAptMark\" ] || apt-mark manual $savedAptMark ; } \\\n && ls -lAFh \"$tempDir\" \\\n && (cd \"$tempDir\" \\\n && dpkg-scanpackages . > Packages) \\\n && grep '^Package: ' \"$tempDir/Packages\" \\\n && echo \"deb [ trusted=yes ] file://$tempDir ./\" > /etc/apt/sources.list.d/temp.list \\\n && apt-get -o Acquire::GzipIndexes=false update ;; esac \\\n && apt-get install --no-install-recommends gettext-base $nginxPackages --no-install-suggests -y \\\n && apt-get remove --purge --auto-remove -y apt-transport-https ca-certificates \\\n && rm -rf /var/lib/apt/lists/* /etc/apt/sources.list.d/nginx.list \\\n && if [ -n \"$tempDir\" ] ; then apt-get purge -y --auto-remove \\\n && rm -rf \"$tempDir\" /etc/apt/sources.list.d/temp.list ; fi\n#   forward request and error logs to docker log collector\nRUN ln -sf /dev/stdout /var/log/nginx/access.log \\\n && ln -sf /dev/stderr /var/log/nginx/error.log\nEXPOSE 80/tcp\nSTOPSIGNAL SIGTERM\nCMD [\"nginx\", \"-g\", \"daemon\", \"off\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM debian:stretch-slim\nLABEL maintainer=\"NGINX Docker Maintainers <docker-maint@nginx.com>\"\nENV NGINX_VERSION=\"1.17.0\"\nENV NJS_VERSION=\"0.3.2\"\nENV PKG_RELEASE=\"1~stretch\"\nRUN set -x \\\n && addgroup --system --gid 101 nginx \\\n && adduser --system --disabled-login --ingroup nginx --no-create-home --home /nonexistent --gecos \"nginx user\" --shell /bin/false --uid 101 nginx \\\n && apt-get update \\\n && apt-get install --no-install-recommends gnupg1 apt-transport-https ca-certificates --no-install-suggests -y \\\n && NGINX_GPGKEY=573BFD6B3D8FBC641079A6ABABF5BD827BD9BF62 ; found='' ; for server in ha.pool.sks-keyservers.net hkp://keyserver.ubuntu.com:80 hkp://p80.pool.sks-keyservers.net:80 pgp.mit.edu; do echo \"Fetching GPG key $NGINX_GPGKEY from $server\" ;apt-key adv --keyserver \"$server\" --keyserver-options timeout=10 --recv-keys \"$NGINX_GPGKEY\" \\\n && found=yes \\\n && break ; done ; test -z \"$found\" \\\n && echo \"error: failed to fetch GPG key $NGINX_GPGKEY\" >&2 \\\n && exit 1 ; apt-get remove --purge --auto-remove -y gnupg1 \\\n && rm -rf /var/lib/apt/lists/* \\\n && dpkgArch=\"$( dpkg --print-architecture ;)\" \\\n && nginxPackages=\" nginx=${NGINX_VERSION}-${PKG_RELEASE} nginx-module-xslt=${NGINX_VERSION}-${PKG_RELEASE} nginx-module-geoip=${NGINX_VERSION}-${PKG_RELEASE} nginx-module-image-filter=${NGINX_VERSION}-${PKG_RELEASE} nginx-module-njs=${NGINX_VERSION}.${NJS_VERSION}-${PKG_RELEASE} \" \\\n && case \"$dpkgArch\" in (amd64|i386) echo \"deb https://nginx.org/packages/mainline/debian/ stretch nginx\" >> /etc/apt/sources.list.d/nginx.list \\\n && apt-get update ;;(*) echo \"deb-src https://nginx.org/packages/mainline/debian/ stretch nginx\" >> /etc/apt/sources.list.d/nginx.list \\\n && tempDir=\"$( mktemp -d ;)\" \\\n && chmod 777 \"$tempDir\" \\\n && savedAptMark=\"$( apt-mark showmanual ;)\" \\\n && apt-get update \\\n && apt-get build-dep -y $nginxPackages \\\n && (cd \"$tempDir\" \\\n && DEB_BUILD_OPTIONS=\"nocheck parallel=$( nproc ;)\" apt-get source --compile $nginxPackages ) \\\n && apt-mark showmanual | xargs apt-mark auto > /dev/null \\\n && { [ -z \"$savedAptMark\" ] || apt-mark manual $savedAptMark ; } \\\n && ls -lAFh \"$tempDir\" \\\n && (cd \"$tempDir\" \\\n && dpkg-scanpackages . > Packages) \\\n && grep '^Package: ' \"$tempDir/Packages\" \\\n && echo \"deb [ trusted=yes ] file://$tempDir ./\" > /etc/apt/sources.list.d/temp.list \\\n && apt-get -o Acquire::GzipIndexes=false update ;; esac \\\n && apt-get install --no-install-recommends gettext-base $nginxPackages --no-install-suggests -y \\\n && apt-get remove --purge --auto-remove -y apt-transport-https ca-certificates \\\n && rm -rf /var/lib/apt/lists/* /etc/apt/sources.list.d/nginx.list \\\n && if [ -n \"$tempDir\" ] ; then apt-get purge -y --auto-remove \\\n && rm -rf \"$tempDir\" /etc/apt/sources.list.d/temp.list ; fi\n#  forward request and error logs to docker log collector\nRUN ln -sf /dev/stdout /var/log/nginx/access.log \\\n && ln -sf /dev/stderr /var/log/nginx/error.log\nEXPOSE 80/tcp\nSTOPSIGNAL SIGTERM\nCMD [\"nginx\", \"-g\", \"daemon\", \"off\"]\n","injectedSmells":[],"originalDockerfileHash":"8e27a1135361c45ad682336088fc8f30","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM debian:stretch-slim\nLABEL maintainer=\"NGINX Docker Maintainers <docker-maint@nginx.com>\"\nENV NGINX_VERSION=\"1.17.0\"\nENV NJS_VERSION=\"0.3.2\"\nENV PKG_RELEASE=\"1~stretch\"\nRUN set -x \\\n && addgroup --system --gid 101 nginx \\\n && adduser --system --disabled-login --ingroup nginx --no-create-home --home /nonexistent --gecos \"nginx user\" --shell /bin/false --uid 101 nginx \\\n && apt-get update \\\n && apt-get install --no-install-recommends gnupg1 apt-transport-https ca-certificates --no-install-suggests -y \\\n && NGINX_GPGKEY=573BFD6B3D8FBC641079A6ABABF5BD827BD9BF62 ; found='' ; for server in ha.pool.sks-keyservers.net hkp://keyserver.ubuntu.com:80 hkp://p80.pool.sks-keyservers.net:80 pgp.mit.edu; do echo \"Fetching GPG key $NGINX_GPGKEY from $server\" ;apt-key adv --keyserver \"$server\" --keyserver-options timeout=10 --recv-keys \"$NGINX_GPGKEY\" \\\n && found=yes \\\n && break ; done ; test -z \"$found\" \\\n && echo \"error: failed to fetch GPG key $NGINX_GPGKEY\" >&2 \\\n && exit 1 ; apt-get remove --purge --auto-remove -y gnupg1 \\\n && rm -rf /var/lib/apt/lists/* \\\n && dpkgArch=\"$( dpkg --print-architecture ;)\" \\\n && nginxPackages=\" nginx=${NGINX_VERSION}-${PKG_RELEASE} nginx-module-xslt=${NGINX_VERSION}-${PKG_RELEASE} nginx-module-geoip=${NGINX_VERSION}-${PKG_RELEASE} nginx-module-image-filter=${NGINX_VERSION}-${PKG_RELEASE} nginx-module-njs=${NGINX_VERSION}.${NJS_VERSION}-${PKG_RELEASE} \" \\\n && case \"$dpkgArch\" in (amd64|i386) echo \"deb https://nginx.org/packages/mainline/debian/ stretch nginx\" >> /etc/apt/sources.list.d/nginx.list \\\n && apt-get update ;;(*) echo \"deb-src https://nginx.org/packages/mainline/debian/ stretch nginx\" >> /etc/apt/sources.list.d/nginx.list \\\n && tempDir=\"$( mktemp -d ;)\" \\\n && chmod 777 \"$tempDir\" \\\n && savedAptMark=\"$( apt-mark showmanual ;)\" \\\n && apt-get update \\\n && apt-get build-dep -y $nginxPackages \\\n && (cd \"$tempDir\" \\\n && DEB_BUILD_OPTIONS=\"nocheck parallel=$( nproc ;)\" apt-get source --compile $nginxPackages ) \\\n && apt-mark showmanual | xargs apt-mark auto > /dev/null \\\n && { [ -z \"$savedAptMark\" ] || apt-mark manual $savedAptMark ; } \\\n && ls -lAFh \"$tempDir\" \\\n && (cd \"$tempDir\" \\\n && dpkg-scanpackages . > Packages) \\\n && grep '^Package: ' \"$tempDir/Packages\" \\\n && echo \"deb [ trusted=yes ] file://$tempDir ./\" > /etc/apt/sources.list.d/temp.list \\\n && apt-get -o Acquire::GzipIndexes=false update ;; esac \\\n && apt-get install --no-install-recommends gettext-base $nginxPackages --no-install-suggests -y \\\n && apt-get remove --purge --auto-remove -y apt-transport-https ca-certificates \\\n && rm -rf /var/lib/apt/lists/* /etc/apt/sources.list.d/nginx.list \\\n && if [ -n \"$tempDir\" ] ; then apt-get purge -y --auto-remove \\\n && rm -rf \"$tempDir\" /etc/apt/sources.list.d/temp.list ; fi\n#   forward request and error logs to docker log collector\nRUN ln -sf /dev/stdout /var/log/nginx/access.log \\\n && ln -sf /dev/stderr /var/log/nginx/error.log\nEXPOSE 80/tcp\nSTOPSIGNAL SIGTERM\nCMD [\"nginx\", \"-g\", \"daemon\", \"off\"]\n","originalDockerfileUglifiedHash":"6160a05a1140443cc9f99858460f7423","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/12a3130ad29e1e9be7e9d6bb9a91baa9f87d6a27.dockerfile"}