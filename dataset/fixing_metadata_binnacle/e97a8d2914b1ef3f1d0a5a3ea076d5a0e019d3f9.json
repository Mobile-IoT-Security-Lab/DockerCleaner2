{"seed":622543952,"processedDockerfileHash":"b60f10ce69674d163f4f2272aa4db138","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["have-a-healthcheck","have-a-user"],"processedDockerfile":"#\n#   This is the base image for nodes of an openshift dind dev cluster.\n#\n#   The standard name for this image is openshift/dind-node\n#\nFROM openshift/dind\n#  # Install packages\nRUN dnf -y update \\\n && dnf -y install bind-utils findutils hostname iproute iputils less procps-ng tar which bridge-utils ethtool iptables-services conntrack-tools openvswitch openvswitch-ovn-* python-netaddr python2-pyroute2 python2-requests PyYAML cri-o cri-tools\n#   Remove the CRI-O CNI network configs so openshift-sdn's will be used instead\nRUN rm -f /etc/cni/net.d/*\n#   A default deny firewall (either iptables or firewalld) is\n#   installed by default on non-cloud fedora and rhel, so all\n#   network plugins need to be able to work with one enabled.\nRUN systemctl enable iptables.service\n#   Remove ratelimiting in the journal\nCOPY journald.conf /etc/systemd/journald.conf\n#   Ensure that master-to-kubelet communication will work with iptables\nCOPY iptables /etc/sysconfig/\nCOPY openshift-node.sh /usr/local/bin/\nCOPY openshift-dind-lib.sh /usr/local/bin/\nRUN systemctl enable openvswitch\nCOPY openshift-node.service /etc/systemd/system/\nRUN systemctl enable openshift-node.service\n#   Ensure the working directory for the unit file exists\nRUN mkdir -p /var/lib/origin\nCOPY openshift-enable-ssh-access.sh /usr/local/bin/\nCOPY openshift-enable-ssh-access.service /etc/systemd/system/\nRUN systemctl enable openshift-enable-ssh-access.service\n#   SDN plugin setup\nRUN mkdir -p /etc/cni/net.d\nRUN mkdir -p /opt/cni/bin\n#   Symlink from the data path intended to be mounted as a volume to\n#   make reloading easy.  Revisit if/when dind becomes useful for more\n#   than dev/test.\nRUN ln -sf /data/openshift /usr/local/bin/ \\\n && ln -sf /data/oc /usr/local/bin/ \\\n && ln -sf /data/hyperkube /usr/local/bin/ \\\n && ln -sf /data/openshift-node-config /usr/local/bin/ \\\n && ln -sf /data/openshift /usr/local/bin/openshift-deploy \\\n && ln -sf /data/openshift /usr/local/bin/openshift-docker-build \\\n && ln -sf /data/openshift /usr/local/bin/openshift-sti-build \\\n && ln -sf /data/openshift /usr/local/bin/openshift-git-clone \\\n && ln -sf /data/openshift /usr/local/bin/openshift-manage-dockerfile \\\n && ln -sf /data/openshift /usr/local/bin/openshift-extract-image-content \\\n && ln -sf /data/openshift /usr/local/bin/openshift-f5-router \\\n && ln -sf /data/openshift-sdn /opt/cni/bin/ \\\n && ln -sf /data/host-local /opt/cni/bin/ \\\n && ln -sf /data/loopback /opt/cni/bin/\nENV KUBECONFIG=\"/data/openshift.local.config/master/admin.kubeconfig\"\nCOPY openshift-sdn-node.service /etc/systemd/system/\nCOPY openshift-sdn-node.sh /usr/local/bin/\nRUN systemctl enable openshift-sdn-node.service\nCOPY ovn-kubernetes-node-setup.service /etc/systemd/system/\nCOPY ovn-kubernetes-node-setup.sh /usr/local/bin/\nRUN systemctl enable ovn-kubernetes-node-setup.service\nCOPY ovn-kubernetes-node.service /etc/systemd/system/\nCOPY ovn-kubernetes-node.sh /usr/local/bin/\nRUN systemctl enable ovn-kubernetes-node.service\nCOPY crio-node.sh /usr/local/bin/\nCOPY crio-node.service /etc/systemd/system/\nRUN systemctl enable crio-node.service\n#   Default crio storage to vfs. overlay on overlayfs is not supported in crio.\nRUN echo \"CRIO_STORAGE_OPTIONS=--storage-driver vfs\" > /etc/sysconfig/crio-storage\nRUN sed -i 's/^plugin_dir .*/plugin_dir = \"\\/opt\\/cni\\/bin\\/\"/g' /etc/crio/crio.conf\nRUN sed -i 's/^registries .*/registries = [\\n\\t\"docker.io\",\\n\\t\"registry.fedoraproject.org\",\\n\\t\"registry.access.redhat.com\",/g' /etc/crio/crio.conf\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#\n#  This is the base image for nodes of an openshift dind dev cluster.\n#\n#  The standard name for this image is openshift/dind-node\n#\nFROM openshift/dind\n# # Install packages\nRUN dnf -y update \\\n && dnf -y install bind-utils findutils hostname iproute iputils less procps-ng tar which bridge-utils ethtool iptables-services conntrack-tools openvswitch openvswitch-ovn-* python-netaddr python2-pyroute2 python2-requests PyYAML cri-o cri-tools\n#  Remove the CRI-O CNI network configs so openshift-sdn's will be used instead\nRUN rm -f /etc/cni/net.d/*\n#  A default deny firewall (either iptables or firewalld) is\n#  installed by default on non-cloud fedora and rhel, so all\n#  network plugins need to be able to work with one enabled.\nRUN systemctl enable iptables.service\n#  Remove ratelimiting in the journal\nCOPY journald.conf /etc/systemd/journald.conf\n#  Ensure that master-to-kubelet communication will work with iptables\nCOPY iptables /etc/sysconfig/\nCOPY openshift-node.sh /usr/local/bin/\nCOPY openshift-dind-lib.sh /usr/local/bin/\nRUN systemctl enable openvswitch\nCOPY openshift-node.service /etc/systemd/system/\nRUN systemctl enable openshift-node.service\n#  Ensure the working directory for the unit file exists\nRUN mkdir -p /var/lib/origin\nCOPY openshift-enable-ssh-access.sh /usr/local/bin/\nCOPY openshift-enable-ssh-access.service /etc/systemd/system/\nRUN systemctl enable openshift-enable-ssh-access.service\n#  SDN plugin setup\nRUN mkdir -p /etc/cni/net.d\nRUN mkdir -p /opt/cni/bin\n#  Symlink from the data path intended to be mounted as a volume to\n#  make reloading easy.  Revisit if/when dind becomes useful for more\n#  than dev/test.\nRUN ln -sf /data/openshift /usr/local/bin/ \\\n && ln -sf /data/oc /usr/local/bin/ \\\n && ln -sf /data/hyperkube /usr/local/bin/ \\\n && ln -sf /data/openshift-node-config /usr/local/bin/ \\\n && ln -sf /data/openshift /usr/local/bin/openshift-deploy \\\n && ln -sf /data/openshift /usr/local/bin/openshift-docker-build \\\n && ln -sf /data/openshift /usr/local/bin/openshift-sti-build \\\n && ln -sf /data/openshift /usr/local/bin/openshift-git-clone \\\n && ln -sf /data/openshift /usr/local/bin/openshift-manage-dockerfile \\\n && ln -sf /data/openshift /usr/local/bin/openshift-extract-image-content \\\n && ln -sf /data/openshift /usr/local/bin/openshift-f5-router \\\n && ln -sf /data/openshift-sdn /opt/cni/bin/ \\\n && ln -sf /data/host-local /opt/cni/bin/ \\\n && ln -sf /data/loopback /opt/cni/bin/\nENV KUBECONFIG=\"/data/openshift.local.config/master/admin.kubeconfig\"\nCOPY openshift-sdn-node.service /etc/systemd/system/\nCOPY openshift-sdn-node.sh /usr/local/bin/\nRUN systemctl enable openshift-sdn-node.service\nCOPY ovn-kubernetes-node-setup.service /etc/systemd/system/\nCOPY ovn-kubernetes-node-setup.sh /usr/local/bin/\nRUN systemctl enable ovn-kubernetes-node-setup.service\nCOPY ovn-kubernetes-node.service /etc/systemd/system/\nCOPY ovn-kubernetes-node.sh /usr/local/bin/\nRUN systemctl enable ovn-kubernetes-node.service\nCOPY crio-node.sh /usr/local/bin/\nCOPY crio-node.service /etc/systemd/system/\nRUN systemctl enable crio-node.service\n#  Default crio storage to vfs. overlay on overlayfs is not supported in crio.\nRUN echo \"CRIO_STORAGE_OPTIONS=--storage-driver vfs\" > /etc/sysconfig/crio-storage\nRUN sed -i 's/^plugin_dir .*/plugin_dir = \"\\/opt\\/cni\\/bin\\/\"/g' /etc/crio/crio.conf\nRUN sed -i 's/^registries .*/registries = [\\n\\t\"docker.io\",\\n\\t\"registry.fedoraproject.org\",\\n\\t\"registry.access.redhat.com\",/g' /etc/crio/crio.conf\n","injectedSmells":[],"originalDockerfileHash":"6898f70e75dc85c63835a839251b4450","successfullyInjectedSmells":[],"originalDockerfileUglified":"#\n#   This is the base image for nodes of an openshift dind dev cluster.\n#\n#   The standard name for this image is openshift/dind-node\n#\nFROM openshift/dind\n#  # Install packages\nRUN dnf -y update \\\n && dnf -y install bind-utils findutils hostname iproute iputils less procps-ng tar which bridge-utils ethtool iptables-services conntrack-tools openvswitch openvswitch-ovn-* python-netaddr python2-pyroute2 python2-requests PyYAML cri-o cri-tools\n#   Remove the CRI-O CNI network configs so openshift-sdn's will be used instead\nRUN rm -f /etc/cni/net.d/*\n#   A default deny firewall (either iptables or firewalld) is\n#   installed by default on non-cloud fedora and rhel, so all\n#   network plugins need to be able to work with one enabled.\nRUN systemctl enable iptables.service\n#   Remove ratelimiting in the journal\nCOPY journald.conf /etc/systemd/journald.conf\n#   Ensure that master-to-kubelet communication will work with iptables\nCOPY iptables /etc/sysconfig/\nCOPY openshift-node.sh /usr/local/bin/\nCOPY openshift-dind-lib.sh /usr/local/bin/\nRUN systemctl enable openvswitch\nCOPY openshift-node.service /etc/systemd/system/\nRUN systemctl enable openshift-node.service\n#   Ensure the working directory for the unit file exists\nRUN mkdir -p /var/lib/origin\nCOPY openshift-enable-ssh-access.sh /usr/local/bin/\nCOPY openshift-enable-ssh-access.service /etc/systemd/system/\nRUN systemctl enable openshift-enable-ssh-access.service\n#   SDN plugin setup\nRUN mkdir -p /etc/cni/net.d\nRUN mkdir -p /opt/cni/bin\n#   Symlink from the data path intended to be mounted as a volume to\n#   make reloading easy.  Revisit if/when dind becomes useful for more\n#   than dev/test.\nRUN ln -sf /data/openshift /usr/local/bin/ \\\n && ln -sf /data/oc /usr/local/bin/ \\\n && ln -sf /data/hyperkube /usr/local/bin/ \\\n && ln -sf /data/openshift-node-config /usr/local/bin/ \\\n && ln -sf /data/openshift /usr/local/bin/openshift-deploy \\\n && ln -sf /data/openshift /usr/local/bin/openshift-docker-build \\\n && ln -sf /data/openshift /usr/local/bin/openshift-sti-build \\\n && ln -sf /data/openshift /usr/local/bin/openshift-git-clone \\\n && ln -sf /data/openshift /usr/local/bin/openshift-manage-dockerfile \\\n && ln -sf /data/openshift /usr/local/bin/openshift-extract-image-content \\\n && ln -sf /data/openshift /usr/local/bin/openshift-f5-router \\\n && ln -sf /data/openshift-sdn /opt/cni/bin/ \\\n && ln -sf /data/host-local /opt/cni/bin/ \\\n && ln -sf /data/loopback /opt/cni/bin/\nENV KUBECONFIG=\"/data/openshift.local.config/master/admin.kubeconfig\"\nCOPY openshift-sdn-node.service /etc/systemd/system/\nCOPY openshift-sdn-node.sh /usr/local/bin/\nRUN systemctl enable openshift-sdn-node.service\nCOPY ovn-kubernetes-node-setup.service /etc/systemd/system/\nCOPY ovn-kubernetes-node-setup.sh /usr/local/bin/\nRUN systemctl enable ovn-kubernetes-node-setup.service\nCOPY ovn-kubernetes-node.service /etc/systemd/system/\nCOPY ovn-kubernetes-node.sh /usr/local/bin/\nRUN systemctl enable ovn-kubernetes-node.service\nCOPY crio-node.sh /usr/local/bin/\nCOPY crio-node.service /etc/systemd/system/\nRUN systemctl enable crio-node.service\n#   Default crio storage to vfs. overlay on overlayfs is not supported in crio.\nRUN echo \"CRIO_STORAGE_OPTIONS=--storage-driver vfs\" > /etc/sysconfig/crio-storage\nRUN sed -i 's/^plugin_dir .*/plugin_dir = \"\\/opt\\/cni\\/bin\\/\"/g' /etc/crio/crio.conf\nRUN sed -i 's/^registries .*/registries = [\\n\\t\"docker.io\",\\n\\t\"registry.fedoraproject.org\",\\n\\t\"registry.access.redhat.com\",/g' /etc/crio/crio.conf\n","originalDockerfileUglifiedHash":"89f14b457af0df37f0f9ab21e1d3a3b4","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/e97a8d2914b1ef3f1d0a5a3ea076d5a0e019d3f9.dockerfile"}