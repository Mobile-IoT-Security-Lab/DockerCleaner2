{"seed":1875548207,"processedDockerfileHash":"94561377ea0d0333b9026bf4794bfaec","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM ubuntu:xenial\nLABEL Description=\"SPIRE Demo: Blog\"\nLABEL vendor=\"scytale.io\"\nLABEL version=\"0.1.0\"\nRUN :\nRUN (apt-get update ;apt-get install --no-install-recommends openssl=1.0.2g-1ubuntu4.20 -y )\n#  ====================\n#   Setup user accounts\n#  --------------------\nRUN addgroup --gid 1901 spire \\\n && adduser --uid 1101 --disabled-password --shell /bin/bash --ingroup spire spire\nRUN addgroup --gid 1910 blog \\\n && adduser --uid 1111 --disabled-password --shell /bin/bash --ingroup blog blog\nWORKDIR /home/aws\nCOPY conf /cmd/spire-agent/.conf\nCOPY pconf /plugin/agent/.conf\nCOPY .artifacts/artifacts.tgz /\nCOPY sidecar_config.hcl /sidecar/\nRUN tar --directory / -xvzf /artifacts.tgz\nENV SPIRE_PLUGIN_CONFIG_DIR=\"/pconf\"\n#  ====================\n#   Setup Python and FlaskBB\n#  --------------------\nRUN (apt-get update ;apt-get install --no-install-recommends make=4.1-6 wget=1.17.1-1ubuntu1.5 build-essential=12.1ubuntu2 python=2.7.12-1~16.04 python-dev=2.7.12-1~16.04 libmysqlclient-dev=5.7.33-0ubuntu0.16.04.1 git=1:2.7.4-0ubuntu1.10 -y )\nRUN cd /home/ \\\n && wget https://bootstrap.pypa.io/get-pip.py \\\n && python get-pip.py \\\n && rm get-pip.py\nRUN cd /home/ \\\n && git clone https://github.com/sh4nks/flaskbb.git \\\n && cd flaskbb \\\n && pip install -r requirements.txt\nCOPY flaskbb_requirements.txt /home/flaskbb/\nCOPY flaskbb.cfg /home/flaskbb/\nRUN cd /home/flaskbb \\\n && pip install -r flaskbb_requirements.txt\nEXPOSE 8080/tcp\n#  ====================\n#   Setup Ghostunnel\n#  --------------------\nRUN mkdir /home/ghostunnel\nCOPY /keys/ /keys/\nCOPY ghostunnel_client.sh /home/ghostunnel/\nCOPY .artifacts/ghostunnel /home/ghostunnel/\n#  ====================\n#   Vault setup: Eventually move to its own container\n#  --------------------\n#   Create a vault user and group first so the IDs are the same\nRUN addgroup --gid 120 vault \\\n && adduser --uid 1010 --disabled-password --shell /bin/bash --ingroup vault vault\nRUN mkdir -p /vault/logs \\\n && mkdir -p /vault/\n#   TODO\n#   Expose the logs directory\nVOLUME /vault/logs\n#   Expose the file directory\nVOLUME /vault/file\n#  ================\n#   Final setup\n#  ----------------\nWORKDIR /cmd/spire-agent/\n#   CMD ./spire-agent run\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM ubuntu:xenial\nLABEL Description=\"SPIRE Demo: Blog\"\nLABEL vendor=\"scytale.io\"\nLABEL version=\"0.1.0\"\nRUN apt-get update -y\nRUN apt-get install openssl -y\n# ====================\n#  Setup user accounts\n# --------------------\nRUN addgroup --gid 1901 spire \\\n && adduser --uid 1101 --disabled-password --shell /bin/bash --ingroup spire spire\nRUN addgroup --gid 1910 blog \\\n && adduser --uid 1111 --disabled-password --shell /bin/bash --ingroup blog blog\nWORKDIR /home/aws\nCOPY conf /cmd/spire-agent/.conf\nCOPY pconf /plugin/agent/.conf\nCOPY .artifacts/artifacts.tgz /\nCOPY sidecar_config.hcl /sidecar/\nRUN tar --directory / -xvzf /artifacts.tgz\nENV SPIRE_PLUGIN_CONFIG_DIR=\"/pconf\"\n# ====================\n#  Setup Python and FlaskBB\n# --------------------\nRUN apt-get install make wget build-essential python python-dev libmysqlclient-dev git -y\nRUN cd /home/ \\\n && wget https://bootstrap.pypa.io/get-pip.py \\\n && python get-pip.py \\\n && rm get-pip.py\nRUN cd /home/ \\\n && git clone https://github.com/sh4nks/flaskbb.git \\\n && cd flaskbb \\\n && pip install -r requirements.txt\nCOPY flaskbb_requirements.txt /home/flaskbb/\nCOPY flaskbb.cfg /home/flaskbb/\nRUN cd /home/flaskbb \\\n && pip install -r flaskbb_requirements.txt\nEXPOSE 8080/tcp\n# ====================\n#  Setup Ghostunnel\n# --------------------\nRUN mkdir /home/ghostunnel\nCOPY /keys/ /keys/\nCOPY ghostunnel_client.sh /home/ghostunnel/\nCOPY .artifacts/ghostunnel /home/ghostunnel/\n# ====================\n#  Vault setup: Eventually move to its own container\n# --------------------\n#  Create a vault user and group first so the IDs are the same\nRUN addgroup --gid 120 vault \\\n && adduser --uid 1010 --disabled-password --shell /bin/bash --ingroup vault vault\nRUN mkdir -p /vault/logs \\\n && mkdir -p /vault/\n#  TODO\n#  Expose the logs directory\nVOLUME /vault/logs\n#  Expose the file directory\nVOLUME /vault/file\n# ================\n#  Final setup\n# ----------------\nWORKDIR /cmd/spire-agent/\n#  CMD ./spire-agent run\n","injectedSmells":[],"originalDockerfileHash":"20b31741eaed16f9ddbd8e2d6fca982f","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM ubuntu:xenial\nLABEL Description=\"SPIRE Demo: Blog\"\nLABEL vendor=\"scytale.io\"\nLABEL version=\"0.1.0\"\nRUN apt-get update -y\nRUN apt-get install openssl -y\n#  ====================\n#   Setup user accounts\n#  --------------------\nRUN addgroup --gid 1901 spire \\\n && adduser --uid 1101 --disabled-password --shell /bin/bash --ingroup spire spire\nRUN addgroup --gid 1910 blog \\\n && adduser --uid 1111 --disabled-password --shell /bin/bash --ingroup blog blog\nWORKDIR /home/aws\nCOPY conf /cmd/spire-agent/.conf\nCOPY pconf /plugin/agent/.conf\nCOPY .artifacts/artifacts.tgz /\nCOPY sidecar_config.hcl /sidecar/\nRUN tar --directory / -xvzf /artifacts.tgz\nENV SPIRE_PLUGIN_CONFIG_DIR=\"/pconf\"\n#  ====================\n#   Setup Python and FlaskBB\n#  --------------------\nRUN apt-get install make wget build-essential python python-dev libmysqlclient-dev git -y\nRUN cd /home/ \\\n && wget https://bootstrap.pypa.io/get-pip.py \\\n && python get-pip.py \\\n && rm get-pip.py\nRUN cd /home/ \\\n && git clone https://github.com/sh4nks/flaskbb.git \\\n && cd flaskbb \\\n && pip install -r requirements.txt\nCOPY flaskbb_requirements.txt /home/flaskbb/\nCOPY flaskbb.cfg /home/flaskbb/\nRUN cd /home/flaskbb \\\n && pip install -r flaskbb_requirements.txt\nEXPOSE 8080/tcp\n#  ====================\n#   Setup Ghostunnel\n#  --------------------\nRUN mkdir /home/ghostunnel\nCOPY /keys/ /keys/\nCOPY ghostunnel_client.sh /home/ghostunnel/\nCOPY .artifacts/ghostunnel /home/ghostunnel/\n#  ====================\n#   Vault setup: Eventually move to its own container\n#  --------------------\n#   Create a vault user and group first so the IDs are the same\nRUN addgroup --gid 120 vault \\\n && adduser --uid 1010 --disabled-password --shell /bin/bash --ingroup vault vault\nRUN mkdir -p /vault/logs \\\n && mkdir -p /vault/\n#   TODO\n#   Expose the logs directory\nVOLUME /vault/logs\n#   Expose the file directory\nVOLUME /vault/file\n#  ================\n#   Final setup\n#  ----------------\nWORKDIR /cmd/spire-agent/\n#   CMD ./spire-agent run\n","originalDockerfileUglifiedHash":"61496f2bf3622bbae43b52b4823e7a6b","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/e21214f9f6807f3369b2f42738d0f690b1f0f262.dockerfile"}