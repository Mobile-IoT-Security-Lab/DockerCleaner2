{"seed":210235927,"processedDockerfileHash":"489f5b69d04ff9358e54b4053ef964e8","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","have-a-healthcheck","have-a-user"],"processedDockerfile":"ARG FROMLIBERTY\nFROM maven:3.5.2-jdk-8-alpine AS builder\nARG ODMDOCKERDIR\nENV ODMDOCKERDIR=\"$ODMDOCKERDIR\"\nENV THIRDPARTY=\"/thirdpartylib\"\n#   Setup the variable\nENV SCRIPT=\"/script\"\nENV APPS=\"/config/apps\"\nCOPY $ODMDOCKERDIR/welcomepage /welcomepage\nRUN cd /welcomepage ; mvn -B clean install | grep -v 'Download.*'\nCOPY $ODMDOCKERDIR/common/script $SCRIPT\n#   Use production liberty if needed\nCOPY $ODMDOCKERDIR/resources/* /wlp-embeddable/\nRUN chmod a+x $SCRIPT/fixWLPForProduction.sh \\\n && sync \\\n && $SCRIPT/fixWLPForProduction.sh\n#   Copy working files\nCOPY ./teamserver/lib/* /teamserver/lib/\nCOPY ./executionserver/lib/* /executionserver/lib/\nCOPY $ODMDOCKERDIR/decisioncenter/config /config\nCOPY $ODMDOCKERDIR/decisioncenter/script $SCRIPT\nCOPY $ODMDOCKERDIR/common/script $SCRIPT\nCOPY $ODMDOCKERDIR/common/drivers /config/resources\nCOPY $ODMDOCKERDIR/common/features $SCRIPT\nCOPY $ODMDOCKERDIR/licenses /licenses\nRUN apk add zip bash ca-certificates wget --no-cache\nRUN mkdir work ; cd work \\\n && if [ -f /executionserver/lib/jrules-cdi-api.jar ] ; then zip -r decision-center-client-api.zip /teamserver/lib /executionserver/lib/javax.batch-api-ibm-1.0-patch5407.jar /executionserver/lib/jrules-cdi-api.jar /executionserver/lib/javax.inject-1.jar ; else zip -r decision-center-client-api.zip /teamserver/lib /executionserver/lib/javax.batch-api-ibm-1.0-patch5407.jar /executionserver/lib/jrules-cdi-core.jar /executionserver/lib/javax.inject-1.jar ; fi\nCOPY $ODMDOCKERDIR/common/script $SCRIPT\nRUN chmod -R a+x $SCRIPT \\\n && sync \\\n && if [ ! -f /config/resources/postgres* ] ; then $SCRIPT/installPostgres.sh ; fi\n#   Decision Center\nRUN mkdir -p $APPS\nCOPY ./teamserver/applicationservers/WLP*/teamserver*.war $APPS/\nCOPY ./teamserver/applicationservers/WLP*/decision*.war $APPS/\nRUN $SCRIPT/extractApp.sh decisioncenter.war \\\n && $SCRIPT/extractApp.sh decisionmodel.war \\\n && $SCRIPT/extractApp.sh teamserver.war \\\n && $SCRIPT/extractApp.sh decisioncenter-api.war \\\n && mkdir -p $APPS/decisioncenter.war/WEB-INF/classes/config\nRUN $SCRIPT/changeParamValue.sh com.ibm.rules.decisioncenter.setup.configuration-file ./config/decisioncenter-configuration.properties /config/decisioncenter-configuration.properties $APPS/decisioncenter.war/WEB-INF/web.xml\nRUN $SCRIPT/manageLicense.sh \\\n && $SCRIPT/loadFeatures.sh $SCRIPT \\\n && chmod -R 777 $APPS\nFROM ${FROMLIBERTY}\nARG ODMDOCKERDIR\nARG ODMVERSION\nLABEL maintainer=\"ODMDev odmdev_open_source_user@wwpdl.vnet.ibm.com, Laurent GRATEAU <laurent.grateau@fr.ibm.com>\"\nMAINTAINER ODMDev odmdev_open_source_user@wwpdl.vnet.ibm.com, Laurent GRATEAU <laurent.grateau@fr.ibm.com>\nLABEL name=\"Decision Center\"\nLABEL io.k8s.display-name=\"Decision Center\"\nLABEL description=\"Decision Center is a web application where business users author, model, and manage decisions with limited or no dependence on the IT department.\"\nLABEL summary=\"Decision Center is a web application to manage and author decisions.\"\nLABEL io.k8s.description=\"Decision Center is a web application to manage and author decisions.\"\nLABEL vendor=\"IBM\"\nLABEL version=\"${ODMVERSION}\"\nLABEL io.openshift.tags=\"odm,dba,dbamc\"\nENV APP_NAME=\"DecisionCenter\"\nENV ODMDOCKERDIR=\"$ODMDOCKERDIR\"\nENV SCRIPT=\"/script\"\nENV APPS=\"/config/apps\"\nCOPY --chown=1001:0 $ODMDOCKERDIR/decisioncenter/config /config\nCOPY --chown=1001:0 $ODMDOCKERDIR/decisioncenter/script $SCRIPT\nCOPY --chown=1001:0 $ODMDOCKERDIR/common/config /config\nCOPY --chown=1001:0 $ODMDOCKERDIR/common/security/ltpa.keys /config/resources/security/ltpa.keys\nCOPY --chown=1001:0 $ODMDOCKERDIR/common/security/keystore.jks /config/security/keystore.jks\nCOPY --chown=1001:0 $ODMDOCKERDIR/common/security/truststore.jks /config/security/truststore.jks\nCOPY --chown=1001:0 $ODMDOCKERDIR/common/drivers /config/resources\n#   Welcome page\nCOPY --chown=1001:0 --from=builder /welcomepage/target/welcomepage.war $APPS\n#   Copy Artifact\nCOPY --chown=1001:0 --from=builder $APPS $APPS\nCOPY --chown=1001:0 --from=builder /work/decision-center-client-api.zip $APPS/decisioncenter.war/assets/decision-center-client-api.zip\nCOPY --chown=1001:0 --from=builder /config/resources/postgres* /config/resources\nCOPY --chown=1001:0 --from=builder $SCRIPT $SCRIPT\nCOPY --chown=1001:0 --from=builder /wlp-embeddable/wlp /opt/ibm/wlp\n#   License\nCOPY --chown=1001:0 --from=builder /licenses /licenses\nEXPOSE 9060/tcp 9453/tcp\nCMD [\"/script/rundc.sh\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"ARG FROMLIBERTY\nFROM maven:3.5.2-jdk-8-alpine AS builder\nARG ODMDOCKERDIR\nENV ODMDOCKERDIR=\"$ODMDOCKERDIR\"\nENV THIRDPARTY=\"/thirdpartylib\"\n#  Setup the variable\nENV SCRIPT=\"/script\"\nENV APPS=\"/config/apps\"\nCOPY $ODMDOCKERDIR/welcomepage /welcomepage\nRUN cd /welcomepage ; mvn -B clean install | grep -v 'Download.*'\nCOPY $ODMDOCKERDIR/common/script $SCRIPT\n#  Use production liberty if needed\nCOPY $ODMDOCKERDIR/resources/* /wlp-embeddable/\nRUN chmod a+x $SCRIPT/fixWLPForProduction.sh \\\n && sync \\\n && $SCRIPT/fixWLPForProduction.sh\n#  Copy working files\nCOPY ./teamserver/lib/* /teamserver/lib/\nCOPY ./executionserver/lib/* /executionserver/lib/\nCOPY $ODMDOCKERDIR/decisioncenter/config /config\nCOPY $ODMDOCKERDIR/decisioncenter/script $SCRIPT\nCOPY $ODMDOCKERDIR/common/script $SCRIPT\nCOPY $ODMDOCKERDIR/common/drivers /config/resources\nCOPY $ODMDOCKERDIR/common/features $SCRIPT\nCOPY $ODMDOCKERDIR/licenses /licenses\nRUN apk add --no-cache zip bash ca-certificates wget\nRUN mkdir work ; cd work \\\n && if [ -f /executionserver/lib/jrules-cdi-api.jar ] ; then zip -r decision-center-client-api.zip /teamserver/lib /executionserver/lib/javax.batch-api-ibm-1.0-patch5407.jar /executionserver/lib/jrules-cdi-api.jar /executionserver/lib/javax.inject-1.jar ; else zip -r decision-center-client-api.zip /teamserver/lib /executionserver/lib/javax.batch-api-ibm-1.0-patch5407.jar /executionserver/lib/jrules-cdi-core.jar /executionserver/lib/javax.inject-1.jar ; fi\nCOPY $ODMDOCKERDIR/common/script $SCRIPT\nRUN chmod -R a+x $SCRIPT \\\n && sync \\\n && if [ ! -f /config/resources/postgres* ] ; then $SCRIPT/installPostgres.sh ; fi\n#  Decision Center\nRUN mkdir -p $APPS\nCOPY ./teamserver/applicationservers/WLP*/teamserver*.war $APPS/\nCOPY ./teamserver/applicationservers/WLP*/decision*.war $APPS/\nRUN $SCRIPT/extractApp.sh decisioncenter.war \\\n && $SCRIPT/extractApp.sh decisionmodel.war \\\n && $SCRIPT/extractApp.sh teamserver.war \\\n && $SCRIPT/extractApp.sh decisioncenter-api.war \\\n && mkdir -p $APPS/decisioncenter.war/WEB-INF/classes/config\nRUN $SCRIPT/changeParamValue.sh com.ibm.rules.decisioncenter.setup.configuration-file .\\/config\\/decisioncenter-configuration.properties \\/config\\/decisioncenter-configuration.properties $APPS/decisioncenter.war/WEB-INF/web.xml\nRUN $SCRIPT/manageLicense.sh \\\n && $SCRIPT/loadFeatures.sh $SCRIPT \\\n && chmod -R 777 $APPS\nFROM ${FROMLIBERTY}\nARG ODMDOCKERDIR\nARG ODMVERSION\nLABEL maintainer=\"ODMDev odmdev_open_source_user@wwpdl.vnet.ibm.com, Laurent GRATEAU <laurent.grateau@fr.ibm.com>\"\nMAINTAINER ODMDev odmdev_open_source_user@wwpdl.vnet.ibm.com, Laurent GRATEAU <laurent.grateau@fr.ibm.com>\nLABEL name=\"Decision Center\"\nLABEL io.k8s.display-name=\"Decision Center\"\nLABEL description=\"Decision Center is a web application where business users author, model, and manage decisions with limited or no dependence on the IT department.\"\nLABEL summary=\"Decision Center is a web application to manage and author decisions.\"\nLABEL io.k8s.description=\"Decision Center is a web application to manage and author decisions.\"\nLABEL vendor=\"IBM\"\nLABEL version=\"${ODMVERSION}\"\nLABEL io.openshift.tags=\"odm,dba,dbamc\"\nENV APP_NAME=\"DecisionCenter\"\nENV ODMDOCKERDIR=\"$ODMDOCKERDIR\"\nENV SCRIPT=\"/script\"\nENV APPS=\"/config/apps\"\nCOPY --chown=1001:0 $ODMDOCKERDIR/decisioncenter/config /config\nCOPY --chown=1001:0 $ODMDOCKERDIR/decisioncenter/script $SCRIPT\nCOPY --chown=1001:0 $ODMDOCKERDIR/common/config /config\nCOPY --chown=1001:0 $ODMDOCKERDIR/common/security/ltpa.keys /config/resources/security/ltpa.keys\nCOPY --chown=1001:0 $ODMDOCKERDIR/common/security/keystore.jks /config/security/keystore.jks\nCOPY --chown=1001:0 $ODMDOCKERDIR/common/security/truststore.jks /config/security/truststore.jks\nCOPY --chown=1001:0 $ODMDOCKERDIR/common/drivers /config/resources\n#  Welcome page\nCOPY --chown=1001:0 --from=builder /welcomepage/target/welcomepage.war $APPS\n#  Copy Artifact\nCOPY --chown=1001:0 --from=builder $APPS $APPS\nCOPY --chown=1001:0 --from=builder /work/decision-center-client-api.zip $APPS/decisioncenter.war/assets/decision-center-client-api.zip\nCOPY --chown=1001:0 --from=builder /config/resources/postgres* /config/resources\nCOPY --chown=1001:0 --from=builder $SCRIPT $SCRIPT\nCOPY --chown=1001:0 --from=builder /wlp-embeddable/wlp /opt/ibm/wlp\n#  License\nCOPY --chown=1001:0 --from=builder /licenses /licenses\nEXPOSE 9060/tcp 9453/tcp\nCMD [\"/script/rundc.sh\"]\n","injectedSmells":[],"originalDockerfileHash":"7843db7a18a9c78d981e49570c87f217","successfullyInjectedSmells":[],"originalDockerfileUglified":"ARG FROMLIBERTY\nFROM maven:3.5.2-jdk-8-alpine AS builder\nARG ODMDOCKERDIR\nENV ODMDOCKERDIR=\"$ODMDOCKERDIR\"\nENV THIRDPARTY=\"/thirdpartylib\"\n#   Setup the variable\nENV SCRIPT=\"/script\"\nENV APPS=\"/config/apps\"\nCOPY $ODMDOCKERDIR/welcomepage /welcomepage\nRUN cd /welcomepage ; mvn -B clean install | grep -v 'Download.*'\nCOPY $ODMDOCKERDIR/common/script $SCRIPT\n#   Use production liberty if needed\nCOPY $ODMDOCKERDIR/resources/* /wlp-embeddable/\nRUN chmod a+x $SCRIPT/fixWLPForProduction.sh \\\n && sync \\\n && $SCRIPT/fixWLPForProduction.sh\n#   Copy working files\nCOPY ./teamserver/lib/* /teamserver/lib/\nCOPY ./executionserver/lib/* /executionserver/lib/\nCOPY $ODMDOCKERDIR/decisioncenter/config /config\nCOPY $ODMDOCKERDIR/decisioncenter/script $SCRIPT\nCOPY $ODMDOCKERDIR/common/script $SCRIPT\nCOPY $ODMDOCKERDIR/common/drivers /config/resources\nCOPY $ODMDOCKERDIR/common/features $SCRIPT\nCOPY $ODMDOCKERDIR/licenses /licenses\nRUN apk add --no-cache zip bash ca-certificates wget\nRUN mkdir work ; cd work \\\n && if [ -f /executionserver/lib/jrules-cdi-api.jar ] ; then zip -r decision-center-client-api.zip /teamserver/lib /executionserver/lib/javax.batch-api-ibm-1.0-patch5407.jar /executionserver/lib/jrules-cdi-api.jar /executionserver/lib/javax.inject-1.jar ; else zip -r decision-center-client-api.zip /teamserver/lib /executionserver/lib/javax.batch-api-ibm-1.0-patch5407.jar /executionserver/lib/jrules-cdi-core.jar /executionserver/lib/javax.inject-1.jar ; fi\nCOPY $ODMDOCKERDIR/common/script $SCRIPT\nRUN chmod -R a+x $SCRIPT \\\n && sync \\\n && if [ ! -f /config/resources/postgres* ] ; then $SCRIPT/installPostgres.sh ; fi\n#   Decision Center\nRUN mkdir -p $APPS\nCOPY ./teamserver/applicationservers/WLP*/teamserver*.war $APPS/\nCOPY ./teamserver/applicationservers/WLP*/decision*.war $APPS/\nRUN $SCRIPT/extractApp.sh decisioncenter.war \\\n && $SCRIPT/extractApp.sh decisionmodel.war \\\n && $SCRIPT/extractApp.sh teamserver.war \\\n && $SCRIPT/extractApp.sh decisioncenter-api.war \\\n && mkdir -p $APPS/decisioncenter.war/WEB-INF/classes/config\nRUN $SCRIPT/changeParamValue.sh com.ibm.rules.decisioncenter.setup.configuration-file ./config/decisioncenter-configuration.properties /config/decisioncenter-configuration.properties $APPS/decisioncenter.war/WEB-INF/web.xml\nRUN $SCRIPT/manageLicense.sh \\\n && $SCRIPT/loadFeatures.sh $SCRIPT \\\n && chmod -R 777 $APPS\nFROM ${FROMLIBERTY}\nARG ODMDOCKERDIR\nARG ODMVERSION\nLABEL maintainer=\"ODMDev odmdev_open_source_user@wwpdl.vnet.ibm.com, Laurent GRATEAU <laurent.grateau@fr.ibm.com>\"\nMAINTAINER ODMDev odmdev_open_source_user@wwpdl.vnet.ibm.com, Laurent GRATEAU <laurent.grateau@fr.ibm.com>\nLABEL name=\"Decision Center\"\nLABEL io.k8s.display-name=\"Decision Center\"\nLABEL description=\"Decision Center is a web application where business users author, model, and manage decisions with limited or no dependence on the IT department.\"\nLABEL summary=\"Decision Center is a web application to manage and author decisions.\"\nLABEL io.k8s.description=\"Decision Center is a web application to manage and author decisions.\"\nLABEL vendor=\"IBM\"\nLABEL version=\"${ODMVERSION}\"\nLABEL io.openshift.tags=\"odm,dba,dbamc\"\nENV APP_NAME=\"DecisionCenter\"\nENV ODMDOCKERDIR=\"$ODMDOCKERDIR\"\nENV SCRIPT=\"/script\"\nENV APPS=\"/config/apps\"\nCOPY --chown=1001:0 $ODMDOCKERDIR/decisioncenter/config /config\nCOPY --chown=1001:0 $ODMDOCKERDIR/decisioncenter/script $SCRIPT\nCOPY --chown=1001:0 $ODMDOCKERDIR/common/config /config\nCOPY --chown=1001:0 $ODMDOCKERDIR/common/security/ltpa.keys /config/resources/security/ltpa.keys\nCOPY --chown=1001:0 $ODMDOCKERDIR/common/security/keystore.jks /config/security/keystore.jks\nCOPY --chown=1001:0 $ODMDOCKERDIR/common/security/truststore.jks /config/security/truststore.jks\nCOPY --chown=1001:0 $ODMDOCKERDIR/common/drivers /config/resources\n#   Welcome page\nCOPY --chown=1001:0 --from=builder /welcomepage/target/welcomepage.war $APPS\n#   Copy Artifact\nCOPY --chown=1001:0 --from=builder $APPS $APPS\nCOPY --chown=1001:0 --from=builder /work/decision-center-client-api.zip $APPS/decisioncenter.war/assets/decision-center-client-api.zip\nCOPY --chown=1001:0 --from=builder /config/resources/postgres* /config/resources\nCOPY --chown=1001:0 --from=builder $SCRIPT $SCRIPT\nCOPY --chown=1001:0 --from=builder /wlp-embeddable/wlp /opt/ibm/wlp\n#   License\nCOPY --chown=1001:0 --from=builder /licenses /licenses\nEXPOSE 9060/tcp 9453/tcp\nCMD [\"/script/rundc.sh\"]\n","originalDockerfileUglifiedHash":"756f7355f0213148e9b2242ccad1d6d4","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/633647b8eb97924ee0a94e18939104961f9332bc.dockerfile"}