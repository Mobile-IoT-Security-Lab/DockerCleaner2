{"seed":3576970128,"processedDockerfileHash":"8793531503043eb93a20654c7ff768ed","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apt-get","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM debian:jessie\nLABEL maintainer=\"phithon <root@leavesongs.com>\"\n#   persistent / runtime deps\nRUN apt-get update \\\n && apt-get install --no-install-recommends ca-certificates curl librecode0 libmysqlclient-dev libsqlite3-0 libxml2 -y \\\n && apt-get clean \\\n && rm -r /var/lib/apt/lists/*\n#   phpize deps\nRUN apt-get update \\\n && apt-get install --no-install-recommends autoconf file g++ gcc libc-dev make pkg-config re2c -y \\\n && apt-get clean \\\n && rm -r /var/lib/apt/lists/*\nENV PHP_INI_DIR=\"/usr/local/etc/php\"\nRUN mkdir -p $PHP_INI_DIR/conf.d\n#   compile openssl, otherwise --with-openssl won't work\nRUN OPENSSL_VERSION=\"1.0.2k\" \\\n && cd /tmp \\\n && mkdir openssl \\\n && curl -sL \"https://www.openssl.org/source/openssl-$OPENSSL_VERSION.tar.gz\" -o openssl.tar.gz \\\n && tar -xzf openssl.tar.gz -C openssl --strip-components=1 \\\n && cd /tmp/openssl \\\n && ./config -fPIC \\\n && make \\\n && make install \\\n && rm -rf /tmp/*\nENV PHP_VERSION=\"5.4.1\"\n#  #<autogenerated>##\nRUN apt-get update \\\n && apt-get install --no-install-recommends apache2 -y \\\n && rm -rf /var/lib/apt/lists/*\nENV APACHE_CONFDIR=\"/etc/apache2\"\nENV APACHE_ENVVARS=\"$APACHE_CONFDIR/envvars\"\nRUN set -ex \\\n && sed -ri 's/^export ([^=]+)=(.*)$/: ${\\1:=\\2}\\nexport \\1/' \"$APACHE_ENVVARS\" \\\n && . \"$APACHE_ENVVARS\" \\\n && for dir in \"$APACHE_LOCK_DIR\" \"$APACHE_RUN_DIR\" \"$APACHE_LOG_DIR\" /var/www/html; do rm -rvf \"$dir\" \\\n && mkdir -p \"$dir\" \\\n && chown -R \"$APACHE_RUN_USER:$APACHE_RUN_GROUP\" \"$dir\" ; done\n#   Apache + PHP requires preforking Apache for best results\nRUN a2dismod mpm_event \\\n && a2enmod mpm_prefork\n#   logs should go to stdout / stderr\nRUN set -ex \\\n && . \"$APACHE_ENVVARS\" \\\n && ln -sfT /dev/stderr \"$APACHE_LOG_DIR/error.log\" \\\n && ln -sfT /dev/stdout \"$APACHE_LOG_DIR/access.log\" \\\n && ln -sfT /dev/stdout \"$APACHE_LOG_DIR/other_vhosts_access.log\"\n#   PHP files should be handled by PHP, and should be preferred over any other file type\nRUN { echo '<FilesMatch \\.php$>' ;echo '\\tSetHandler application/x-httpd-php' ;echo '</FilesMatch>' ;echo ;echo 'DirectoryIndex disabled' ;echo 'DirectoryIndex index.php index.html' ;echo ;echo '<Directory /var/www/>' ;echo '\\tOptions -Indexes' ;echo '\\tAllowOverride All' ;echo '</Directory>' ; } | tee \"$APACHE_CONFDIR/conf-available/docker-php.conf\" \\\n && a2enconf docker-php\nENV PHP_EXTRA_BUILD_DEPS=\"apache2-dev\"\nENV PHP_EXTRA_CONFIGURE_ARGS=\"--with-apxs2\"\n#  #</autogenerated>##\nRUN set -ex \\\n && mkdir /tmp/libxml \\\n && cd /tmp/libxml \\\n && curl -#sSL http://xmlsoft.org/sources/libxml2-2.8.0.tar.gz | tar xz --strip-components=1 \\\n && ./configure \\\n && make \\\n && make install \\\n && make clean \\\n && rm -rf /tmp/libxml\n#   php 5.4.1 needs older autoconf\n#   --enable-mysqlnd is included below because it's harder to compile after the fact the extensions are (since it's a plugin for several extensions, not an extension in itself)\nRUN buildDeps=\" autoconf2.13 libcurl4-openssl-dev libreadline6-dev librecode-dev libsqlite3-dev libssl-dev xz-utils apache2-dev \" \\\n && set -x \\\n && apt-get update \\\n && apt-get install --no-install-recommends $buildDeps -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && mkdir -p /usr/src/php \\\n && curl -#SL \"http://museum.php.net/php5/php-${PHP_VERSION}.tar.gz\" | tar zx -C /usr/src/php --strip-components=1 \\\n && cd /usr/src/php \\\n && ./configure --with-config-file-path=\"$PHP_INI_DIR\" --with-config-file-scan-dir=\"$PHP_INI_DIR/conf.d\" --disable-cgi --enable-mysqlnd --enable-mbstring --with-mysql --with-curl --with-openssl=/usr/local/ssl --with-readline --with-recode --with-zlib --with-apxs2 \\\n && make -j\"$( nproc ;)\" \\\n && make install \\\n && { find /usr/local/bin /usr/local/sbin -type f -executable -exec strip --strip-all '{}' + || true ; } \\\n && apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false -o APT::AutoRemove::SuggestsImportant=false $buildDeps \\\n && make clean\nCOPY docker-php-* apache2-foreground /usr/local/bin/\nWORKDIR /var/www/html\nEXPOSE 80/tcp\nENTRYPOINT [\"docker-php-entrypoint\"]\nCMD [\"apache2-foreground\"]\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM debian:jessie\nLABEL maintainer=\"phithon <root@leavesongs.com>\"\n#  persistent / runtime deps\nRUN apt-get update \\\n && apt-get install --no-install-recommends ca-certificates curl librecode0 libmysqlclient-dev libsqlite3-0 libxml2 -y \\\n && apt-get clean \\\n && rm -r /var/lib/apt/lists/*\n#  phpize deps\nRUN apt-get update \\\n && apt-get install --no-install-recommends autoconf file g++ gcc libc-dev make pkg-config re2c -y \\\n && apt-get clean \\\n && rm -r /var/lib/apt/lists/*\nENV PHP_INI_DIR=\"/usr/local/etc/php\"\nRUN mkdir -p $PHP_INI_DIR/conf.d\n#  compile openssl, otherwise --with-openssl won't work\nRUN OPENSSL_VERSION=\"1.0.2k\" \\\n && cd /tmp \\\n && mkdir openssl \\\n && curl -sL \"https://www.openssl.org/source/openssl-$OPENSSL_VERSION.tar.gz\" -o openssl.tar.gz \\\n && tar -xzf openssl.tar.gz -C openssl --strip-components=1 \\\n && cd /tmp/openssl \\\n && ./config -fPIC \\\n && make \\\n && make install \\\n && rm -rf /tmp/*\nENV PHP_VERSION=\"5.4.1\"\n# #<autogenerated>##\nRUN apt-get update \\\n && apt-get install --no-install-recommends apache2 -y \\\n && rm -rf /var/lib/apt/lists/*\nENV APACHE_CONFDIR=\"/etc/apache2\"\nENV APACHE_ENVVARS=\"$APACHE_CONFDIR/envvars\"\nRUN set -ex \\\n && sed -ri 's/^export ([^=]+)=(.*)$/: ${\\1:=\\2}\\nexport \\1/' \"$APACHE_ENVVARS\" \\\n && . \"$APACHE_ENVVARS\" \\\n && for dir in \"$APACHE_LOCK_DIR\" \"$APACHE_RUN_DIR\" \"$APACHE_LOG_DIR\" /var/www/html; do rm -rvf \"$dir\" \\\n && mkdir -p \"$dir\" \\\n && chown -R \"$APACHE_RUN_USER:$APACHE_RUN_GROUP\" \"$dir\" ; done\n#  Apache + PHP requires preforking Apache for best results\nRUN a2dismod mpm_event \\\n && a2enmod mpm_prefork\n#  logs should go to stdout / stderr\nRUN set -ex \\\n && . \"$APACHE_ENVVARS\" \\\n && ln -sfT /dev/stderr \"$APACHE_LOG_DIR/error.log\" \\\n && ln -sfT /dev/stdout \"$APACHE_LOG_DIR/access.log\" \\\n && ln -sfT /dev/stdout \"$APACHE_LOG_DIR/other_vhosts_access.log\"\n#  PHP files should be handled by PHP, and should be preferred over any other file type\nRUN { echo '<FilesMatch \\.php$>' ;echo '\\tSetHandler application/x-httpd-php' ;echo '</FilesMatch>' ;echo ;echo 'DirectoryIndex disabled' ;echo 'DirectoryIndex index.php index.html' ;echo ;echo '<Directory /var/www/>' ;echo '\\tOptions -Indexes' ;echo '\\tAllowOverride All' ;echo '</Directory>' ; } | tee \"$APACHE_CONFDIR/conf-available/docker-php.conf\" \\\n && a2enconf docker-php\nENV PHP_EXTRA_BUILD_DEPS=\"apache2-dev\"\nENV PHP_EXTRA_CONFIGURE_ARGS=\"--with-apxs2\"\n# #</autogenerated>##\nRUN set -ex \\\n && mkdir /tmp/libxml \\\n && cd /tmp/libxml \\\n && curl -#sSL http://xmlsoft.org/sources/libxml2-2.8.0.tar.gz | tar xz --strip-components=1 \\\n && ./configure \\\n && make \\\n && make install \\\n && make clean \\\n && rm -rf /tmp/libxml\n#  php 5.4.1 needs older autoconf\n#  --enable-mysqlnd is included below because it's harder to compile after the fact the extensions are (since it's a plugin for several extensions, not an extension in itself)\nRUN buildDeps=\" autoconf2.13 libcurl4-openssl-dev libreadline6-dev librecode-dev libsqlite3-dev libssl-dev xz-utils apache2-dev \" \\\n && set -x \\\n && apt-get update \\\n && apt-get install --no-install-recommends $buildDeps -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && mkdir -p /usr/src/php \\\n && curl -#SL \"http://museum.php.net/php5/php-${PHP_VERSION}.tar.gz\" | tar zx -C /usr/src/php --strip-components=1 \\\n && cd /usr/src/php \\\n && ./configure --with-config-file-path=\"$PHP_INI_DIR\" --with-config-file-scan-dir=\"$PHP_INI_DIR/conf.d\" --disable-cgi --enable-mysqlnd --enable-mbstring --with-mysql --with-curl --with-openssl=/usr/local/ssl --with-readline --with-recode --with-zlib --with-apxs2 \\\n && make -j\"$( nproc ;)\" \\\n && make install \\\n && { find /usr/local/bin /usr/local/sbin -type f -executable -exec strip --strip-all '{}' + || true ; } \\\n && apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false -o APT::AutoRemove::SuggestsImportant=false $buildDeps \\\n && make clean\nCOPY docker-php-* apache2-foreground /usr/local/bin/\nWORKDIR /var/www/html\nEXPOSE 80/tcp\nENTRYPOINT [\"docker-php-entrypoint\"]\nCMD [\"apache2-foreground\"]\n","injectedSmells":[],"originalDockerfileHash":"ee15600c5f743ac79a9de7c6d5343b90","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM debian:jessie\nLABEL maintainer=\"phithon <root@leavesongs.com>\"\n#   persistent / runtime deps\nRUN apt-get update \\\n && apt-get install --no-install-recommends ca-certificates curl librecode0 libmysqlclient-dev libsqlite3-0 libxml2 -y \\\n && apt-get clean \\\n && rm -r /var/lib/apt/lists/*\n#   phpize deps\nRUN apt-get update \\\n && apt-get install --no-install-recommends autoconf file g++ gcc libc-dev make pkg-config re2c -y \\\n && apt-get clean \\\n && rm -r /var/lib/apt/lists/*\nENV PHP_INI_DIR=\"/usr/local/etc/php\"\nRUN mkdir -p $PHP_INI_DIR/conf.d\n#   compile openssl, otherwise --with-openssl won't work\nRUN OPENSSL_VERSION=\"1.0.2k\" \\\n && cd /tmp \\\n && mkdir openssl \\\n && curl -sL \"https://www.openssl.org/source/openssl-$OPENSSL_VERSION.tar.gz\" -o openssl.tar.gz \\\n && tar -xzf openssl.tar.gz -C openssl --strip-components=1 \\\n && cd /tmp/openssl \\\n && ./config -fPIC \\\n && make \\\n && make install \\\n && rm -rf /tmp/*\nENV PHP_VERSION=\"5.4.1\"\n#  #<autogenerated>##\nRUN apt-get update \\\n && apt-get install --no-install-recommends apache2 -y \\\n && rm -rf /var/lib/apt/lists/*\nENV APACHE_CONFDIR=\"/etc/apache2\"\nENV APACHE_ENVVARS=\"$APACHE_CONFDIR/envvars\"\nRUN set -ex \\\n && sed -ri 's/^export ([^=]+)=(.*)$/: ${\\1:=\\2}\\nexport \\1/' \"$APACHE_ENVVARS\" \\\n && . \"$APACHE_ENVVARS\" \\\n && for dir in \"$APACHE_LOCK_DIR\" \"$APACHE_RUN_DIR\" \"$APACHE_LOG_DIR\" /var/www/html; do rm -rvf \"$dir\" \\\n && mkdir -p \"$dir\" \\\n && chown -R \"$APACHE_RUN_USER:$APACHE_RUN_GROUP\" \"$dir\" ; done\n#   Apache + PHP requires preforking Apache for best results\nRUN a2dismod mpm_event \\\n && a2enmod mpm_prefork\n#   logs should go to stdout / stderr\nRUN set -ex \\\n && . \"$APACHE_ENVVARS\" \\\n && ln -sfT /dev/stderr \"$APACHE_LOG_DIR/error.log\" \\\n && ln -sfT /dev/stdout \"$APACHE_LOG_DIR/access.log\" \\\n && ln -sfT /dev/stdout \"$APACHE_LOG_DIR/other_vhosts_access.log\"\n#   PHP files should be handled by PHP, and should be preferred over any other file type\nRUN { echo '<FilesMatch \\.php$>' ;echo '\\tSetHandler application/x-httpd-php' ;echo '</FilesMatch>' ;echo ;echo 'DirectoryIndex disabled' ;echo 'DirectoryIndex index.php index.html' ;echo ;echo '<Directory /var/www/>' ;echo '\\tOptions -Indexes' ;echo '\\tAllowOverride All' ;echo '</Directory>' ; } | tee \"$APACHE_CONFDIR/conf-available/docker-php.conf\" \\\n && a2enconf docker-php\nENV PHP_EXTRA_BUILD_DEPS=\"apache2-dev\"\nENV PHP_EXTRA_CONFIGURE_ARGS=\"--with-apxs2\"\n#  #</autogenerated>##\nRUN set -ex \\\n && mkdir /tmp/libxml \\\n && cd /tmp/libxml \\\n && curl -#sSL http://xmlsoft.org/sources/libxml2-2.8.0.tar.gz | tar xz --strip-components=1 \\\n && ./configure \\\n && make \\\n && make install \\\n && make clean \\\n && rm -rf /tmp/libxml\n#   php 5.4.1 needs older autoconf\n#   --enable-mysqlnd is included below because it's harder to compile after the fact the extensions are (since it's a plugin for several extensions, not an extension in itself)\nRUN buildDeps=\" autoconf2.13 libcurl4-openssl-dev libreadline6-dev librecode-dev libsqlite3-dev libssl-dev xz-utils apache2-dev \" \\\n && set -x \\\n && apt-get update \\\n && apt-get install --no-install-recommends $buildDeps -y \\\n && rm -rf /var/lib/apt/lists/* \\\n && mkdir -p /usr/src/php \\\n && curl -#SL \"http://museum.php.net/php5/php-${PHP_VERSION}.tar.gz\" | tar zx -C /usr/src/php --strip-components=1 \\\n && cd /usr/src/php \\\n && ./configure --with-config-file-path=\"$PHP_INI_DIR\" --with-config-file-scan-dir=\"$PHP_INI_DIR/conf.d\" --disable-cgi --enable-mysqlnd --enable-mbstring --with-mysql --with-curl --with-openssl=/usr/local/ssl --with-readline --with-recode --with-zlib --with-apxs2 \\\n && make -j\"$( nproc ;)\" \\\n && make install \\\n && { find /usr/local/bin /usr/local/sbin -type f -executable -exec strip --strip-all '{}' + || true ; } \\\n && apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false -o APT::AutoRemove::SuggestsImportant=false $buildDeps \\\n && make clean\nCOPY docker-php-* apache2-foreground /usr/local/bin/\nWORKDIR /var/www/html\nEXPOSE 80/tcp\nENTRYPOINT [\"docker-php-entrypoint\"]\nCMD [\"apache2-foreground\"]\n","originalDockerfileUglifiedHash":"9aa9c60ad77b986605b914388db39be7","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/c3f579cdc30467e87295a40ae72459589bc4be5f.dockerfile"}