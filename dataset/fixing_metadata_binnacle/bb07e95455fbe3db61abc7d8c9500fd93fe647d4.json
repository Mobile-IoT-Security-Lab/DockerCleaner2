{"seed":1134288679,"processedDockerfileHash":"49e47343f6e63e50d08e649d82860310","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","pin-package-manager-versions-apt-get","pin-package-manager-versions-gem","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM ubuntu:16.04 AS base\nMAINTAINER Nicholas Long nicholas.long@nrel.gov\n#   If installing a CI build version of OpenStudio, then pass in the CI path into the build command. For example:\n#     docker build --build-arg DOWNLOAD_PREFIX=\"_CI/OpenStudio\"\nARG DOWNLOAD_PREFIX=\"\"\n#   Set the version of OpenStudio when building the container. For example `docker build --build-arg\n#   OPENSTUDIO_VERSION=2.6.0 --build-arg OPENSTUDIO_SHA=e3cb91f98a .` in the .travis.yml. Set with the ENV keyword to\n#   inherit the variables into child containers\nARG OPENSTUDIO_VERSION\nARG OPENSTUDIO_VERSION_EXT\nARG OPENSTUDIO_SHA\nARG OS_BUNDLER_VERSION=1.17.1\nENV OPENSTUDIO_VERSION=\"$OPENSTUDIO_VERSION\"\nENV OPENSTUDIO_VERSION_EXT=\"$OPENSTUDIO_VERSION_EXT\"\nENV OPENSTUDIO_SHA=\"$OPENSTUDIO_SHA\"\nENV OS_BUNDLER_VERSION=\"$OS_BUNDLER_VERSION\"\n#   Modify the OPENSTUDIO_VERSION and OPENSTUDIO_SHA for new versions\nENV RUBY_VERSION=\"2.2.4\" \\\n    RUBY_SHA=\"b6eff568b48e0fda76e5a36333175df049b204e91217aa32a65153cc0cdcb761\"\n#   Don't combine with above since ENV vars are not initialized until after the above call\nENV OPENSTUDIO_DOWNLOAD_FILENAME=\"OpenStudio-$OPENSTUDIO_VERSION$OPENSTUDIO_VERSION_EXT.$OPENSTUDIO_SHA-Linux.deb\"\n#   Install gdebi, then download and install OpenStudio, then clean up.\n#   gdebi handles the installation of OpenStudio's dependencies including Qt5,\n#   Boost, and Ruby 2.2.4.\n#   OpenStudio 2.4.3 requires libwxgtk3.0-0 -- install manually for now\n#   install locales and set to en_US.UTF-8. This is needed for running the CLI on some machines\n#   such as singularity.\nRUN apt-get update \\\n && apt-get install --no-install-recommends autoconf=2.69-9 build-essential=12.1ubuntu2 ca-certificates=20210119~16.04.1 curl=7.47.0-1ubuntu2.19 gdebi-core=0.9.5.7ubuntu1 git=1:2.7.4-0ubuntu1.10 libfreetype6=2.6.1-0.1ubuntu2.5 libjpeg8=8c-2ubuntu8 libdbus-glib-1-2=0.106-1 libfontconfig1=2.11.94-0ubuntu1.1 libglu1 libreadline-dev=6.3-8ubuntu2 libsm6=2:1.2.2-1 libssl-dev=1.0.2g-1ubuntu4.20 libtool=2.4.6-0.1 libwxgtk3.0-0v5=3.0.2+dfsg-1.3ubuntu0.1 libxi6=2:1.7.6-1 libxml2-dev=2.9.3+dfsg1-1ubuntu0.7 locales=2.23-0ubuntu11.3 sudo=1.8.16-0ubuntu1.10 zlib1g-dev=1:1.2.8.dfsg-2ubuntu4.3 -y \\\n && curl -sL https://raw.githubusercontent.com/NREL/OpenStudio-server/develop/docker/deployment/scripts/install_ruby.sh -o /usr/local/bin/install_ruby.sh \\\n && chmod +x /usr/local/bin/install_ruby.sh \\\n && /usr/local/bin/install_ruby.sh $RUBY_VERSION $RUBY_SHA \\\n && if [ -z \"${DOWNLOAD_PREFIX}\" ] ; then export OPENSTUDIO_DOWNLOAD_URL=https://openstudio-builds.s3.amazonaws.com/$OPENSTUDIO_VERSION/OpenStudio-$OPENSTUDIO_VERSION$OPENSTUDIO_VERSION_EXT.$OPENSTUDIO_SHA-Linux.deb ; else export OPENSTUDIO_DOWNLOAD_URL=https://openstudio-builds.s3.amazonaws.com/$DOWNLOAD_PREFIX/OpenStudio-$OPENSTUDIO_VERSION$OPENSTUDIO_VERSION_EXT.$OPENSTUDIO_SHA-Linux.deb ; fi \\\n && echo \"OpenStudio Package Download URL is ${OPENSTUDIO_DOWNLOAD_URL}\" \\\n && curl -SLO $OPENSTUDIO_DOWNLOAD_URL \\\n && grep -v -q \"<Code>AccessDenied</Code>\" ${OPENSTUDIO_DOWNLOAD_FILENAME} \\\n && gdebi -n $OPENSTUDIO_DOWNLOAD_FILENAME \\\n && rm -f /usr/local/bin/install_ruby.sh \\\n && rm -f $OPENSTUDIO_DOWNLOAD_FILENAME \\\n && rm -rf /var/lib/apt/lists/* \\\n && if dpkg --compare-versions \"${OPENSTUDIO_VERSION}\" \"gt\" \"2.5.1\" ; then rm -rf /usr/local/openstudio-${OPENSTUDIO_VERSION}/SketchUpPlugin ; else rm -rf /usr/SketchUpPlugin ; fi \\\n && locale-gen en_US en_US.UTF-8 \\\n && dpkg-reconfigure locales\n#  # Add RUBYLIB link for openstudio.rb. Support new location and old location.\nENV RUBYLIB=\"/usr/local/openstudio-${OPENSTUDIO_VERSION}/Ruby:/usr/Ruby\"\nENV ENERGYPLUS_EXE_PATH=\"/usr/local/openstudio-${OPENSTUDIO_VERSION}/EnergyPlus/energyplus\"\n#   The OpenStudio Gemfile contains a fixed bundler version, so you have to install and run specific to that version\nRUN gem install bundler --version 2.4.12 \\\n && mkdir /var/oscli \\\n && cp /usr/local/openstudio-${OPENSTUDIO_VERSION}/Ruby/Gemfile /var/oscli/ \\\n && cp /usr/local/openstudio-${OPENSTUDIO_VERSION}/Ruby/Gemfile.lock /var/oscli/ \\\n && cp /usr/local/openstudio-${OPENSTUDIO_VERSION}/Ruby/openstudio-gems.gemspec /var/oscli/\nWORKDIR /var/oscli\nRUN bundle _${OS_BUNDLER_VERSION}_ install --path=gems --jobs=4 --retry=3\n#   Configure the bootdir & confirm that openstudio is able to load the bundled gem set in /var/gemdata\nVOLUME /var/simdata/openstudio\nWORKDIR /var/simdata/openstudio\nRUN openstudio --verbose --bundle /var/oscli/Gemfile --bundle_path /var/oscli/gems openstudio_version\nCMD [\"/bin/bash\"]\n#   FROM ubuntu:16.04 AS cli\n#   ARG OPENSTUDIO_VERSION\n#   # copy executable and energyplus from install\n#   COPY --from=base /usr/local/openstudio-${OPENSTUDIO_VERSION}/bin/openstudio /usr/local/openstudio-${OPENSTUDIO_VERSION}/bin/\n#   COPY --from=base /usr/local/openstudio-${OPENSTUDIO_VERSION}/EnergyPlus /usr/local/openstudio-${OPENSTUDIO_VERSION}/EnergyPlus\n#   RUN apt-get update && apt-get install -y --no-install-recommends \\\n#               libdbus-glib-1-2 \\\n#               libglu1 \\\n#   \t\t  libssl-dev \\\n#   \t\t  libpng-dev \\\n#               libgdbm-dev \\\n#        && rm -rf /var/lib/apt/lists/*\n#   # link executable from /usr/local/bin\n#   RUN ln -s /usr/local/openstudio-${OPENSTUDIO_VERSION}/bin/openstudio /usr/local/bin/openstudio\n#   VOLUME /var/simdata/openstudio\n#   WORKDIR /var/simdata/openstudio\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM ubuntu:16.04 AS base\nMAINTAINER Nicholas Long nicholas.long@nrel.gov\n#  If installing a CI build version of OpenStudio, then pass in the CI path into the build command. For example:\n#    docker build --build-arg DOWNLOAD_PREFIX=\"_CI/OpenStudio\"\nARG DOWNLOAD_PREFIX=\"\"\n#  Set the version of OpenStudio when building the container. For example `docker build --build-arg\n#  OPENSTUDIO_VERSION=2.6.0 --build-arg OPENSTUDIO_SHA=e3cb91f98a .` in the .travis.yml. Set with the ENV keyword to\n#  inherit the variables into child containers\nARG OPENSTUDIO_VERSION\nARG OPENSTUDIO_VERSION_EXT\nARG OPENSTUDIO_SHA\nARG OS_BUNDLER_VERSION=1.17.1\nENV OPENSTUDIO_VERSION=\"$OPENSTUDIO_VERSION\"\nENV OPENSTUDIO_VERSION_EXT=\"$OPENSTUDIO_VERSION_EXT\"\nENV OPENSTUDIO_SHA=\"$OPENSTUDIO_SHA\"\nENV OS_BUNDLER_VERSION=\"$OS_BUNDLER_VERSION\"\n#  Modify the OPENSTUDIO_VERSION and OPENSTUDIO_SHA for new versions\nENV RUBY_VERSION=\"2.2.4\" \\\n    RUBY_SHA=\"b6eff568b48e0fda76e5a36333175df049b204e91217aa32a65153cc0cdcb761\"\n#  Don't combine with above since ENV vars are not initialized until after the above call\nENV OPENSTUDIO_DOWNLOAD_FILENAME=\"OpenStudio-$OPENSTUDIO_VERSION$OPENSTUDIO_VERSION_EXT.$OPENSTUDIO_SHA-Linux.deb\"\n#  Install gdebi, then download and install OpenStudio, then clean up.\n#  gdebi handles the installation of OpenStudio's dependencies including Qt5,\n#  Boost, and Ruby 2.2.4.\n#  OpenStudio 2.4.3 requires libwxgtk3.0-0 -- install manually for now\n#  install locales and set to en_US.UTF-8. This is needed for running the CLI on some machines\n#  such as singularity.\nRUN apt-get update \\\n && apt-get install autoconf build-essential ca-certificates curl gdebi-core git libfreetype6 libjpeg8 libdbus-glib-1-2 libfontconfig1 libglu1 libreadline-dev libsm6 libssl-dev libtool libwxgtk3.0-0v5 libxi6 libxml2-dev locales sudo zlib1g-dev -y \\\n && curl -sL https://raw.githubusercontent.com/NREL/OpenStudio-server/develop/docker/deployment/scripts/install_ruby.sh -o /usr/local/bin/install_ruby.sh \\\n && chmod +x /usr/local/bin/install_ruby.sh \\\n && /usr/local/bin/install_ruby.sh $RUBY_VERSION $RUBY_SHA \\\n && if [ -z \"${DOWNLOAD_PREFIX}\" ] ; then export OPENSTUDIO_DOWNLOAD_URL=https://openstudio-builds.s3.amazonaws.com/$OPENSTUDIO_VERSION/OpenStudio-$OPENSTUDIO_VERSION$OPENSTUDIO_VERSION_EXT.$OPENSTUDIO_SHA-Linux.deb ; else export OPENSTUDIO_DOWNLOAD_URL=https://openstudio-builds.s3.amazonaws.com/$DOWNLOAD_PREFIX/OpenStudio-$OPENSTUDIO_VERSION$OPENSTUDIO_VERSION_EXT.$OPENSTUDIO_SHA-Linux.deb ; fi \\\n && echo \"OpenStudio Package Download URL is ${OPENSTUDIO_DOWNLOAD_URL}\" \\\n && curl -SLO $OPENSTUDIO_DOWNLOAD_URL \\\n && grep -v -q \"<Code>AccessDenied</Code>\" ${OPENSTUDIO_DOWNLOAD_FILENAME} \\\n && gdebi -n $OPENSTUDIO_DOWNLOAD_FILENAME \\\n && rm -f /usr/local/bin/install_ruby.sh \\\n && rm -f $OPENSTUDIO_DOWNLOAD_FILENAME \\\n && rm -rf /var/lib/apt/lists/* \\\n && if dpkg --compare-versions \"${OPENSTUDIO_VERSION}\" \"gt\" \"2.5.1\" ; then rm -rf /usr/local/openstudio-${OPENSTUDIO_VERSION}/SketchUpPlugin ; else rm -rf /usr/SketchUpPlugin ; fi \\\n && locale-gen en_US en_US.UTF-8 \\\n && dpkg-reconfigure locales\n# # Add RUBYLIB link for openstudio.rb. Support new location and old location.\nENV RUBYLIB=\"/usr/local/openstudio-${OPENSTUDIO_VERSION}/Ruby:/usr/Ruby\"\nENV ENERGYPLUS_EXE_PATH=\"/usr/local/openstudio-${OPENSTUDIO_VERSION}/EnergyPlus/energyplus\"\n#  The OpenStudio Gemfile contains a fixed bundler version, so you have to install and run specific to that version\nRUN gem install bundler \\\n && mkdir /var/oscli \\\n && cp /usr/local/openstudio-${OPENSTUDIO_VERSION}/Ruby/Gemfile /var/oscli/ \\\n && cp /usr/local/openstudio-${OPENSTUDIO_VERSION}/Ruby/Gemfile.lock /var/oscli/ \\\n && cp /usr/local/openstudio-${OPENSTUDIO_VERSION}/Ruby/openstudio-gems.gemspec /var/oscli/\nWORKDIR /var/oscli\nRUN bundle _${OS_BUNDLER_VERSION}_ install --path=gems --jobs=4 --retry=3\n#  Configure the bootdir & confirm that openstudio is able to load the bundled gem set in /var/gemdata\nVOLUME /var/simdata/openstudio\nWORKDIR /var/simdata/openstudio\nRUN openstudio --verbose --bundle /var/oscli/Gemfile --bundle_path /var/oscli/gems openstudio_version\nCMD [\"/bin/bash\"]\n#  FROM ubuntu:16.04 AS cli\n#  ARG OPENSTUDIO_VERSION\n#  # copy executable and energyplus from install\n#  COPY --from=base /usr/local/openstudio-${OPENSTUDIO_VERSION}/bin/openstudio /usr/local/openstudio-${OPENSTUDIO_VERSION}/bin/\n#  COPY --from=base /usr/local/openstudio-${OPENSTUDIO_VERSION}/EnergyPlus /usr/local/openstudio-${OPENSTUDIO_VERSION}/EnergyPlus\n#  RUN apt-get update && apt-get install -y --no-install-recommends \\\n#              libdbus-glib-1-2 \\\n#              libglu1 \\\n#  \t\t  libssl-dev \\\n#  \t\t  libpng-dev \\\n#              libgdbm-dev \\\n#       && rm -rf /var/lib/apt/lists/*\n#  # link executable from /usr/local/bin\n#  RUN ln -s /usr/local/openstudio-${OPENSTUDIO_VERSION}/bin/openstudio /usr/local/bin/openstudio\n#  VOLUME /var/simdata/openstudio\n#  WORKDIR /var/simdata/openstudio\n","injectedSmells":[],"originalDockerfileHash":"459df38bb058d6fc2ca5dc2b439bdf27","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM ubuntu:16.04 AS base\nMAINTAINER Nicholas Long nicholas.long@nrel.gov\n#   If installing a CI build version of OpenStudio, then pass in the CI path into the build command. For example:\n#     docker build --build-arg DOWNLOAD_PREFIX=\"_CI/OpenStudio\"\nARG DOWNLOAD_PREFIX=\"\"\n#   Set the version of OpenStudio when building the container. For example `docker build --build-arg\n#   OPENSTUDIO_VERSION=2.6.0 --build-arg OPENSTUDIO_SHA=e3cb91f98a .` in the .travis.yml. Set with the ENV keyword to\n#   inherit the variables into child containers\nARG OPENSTUDIO_VERSION\nARG OPENSTUDIO_VERSION_EXT\nARG OPENSTUDIO_SHA\nARG OS_BUNDLER_VERSION=1.17.1\nENV OPENSTUDIO_VERSION=\"$OPENSTUDIO_VERSION\"\nENV OPENSTUDIO_VERSION_EXT=\"$OPENSTUDIO_VERSION_EXT\"\nENV OPENSTUDIO_SHA=\"$OPENSTUDIO_SHA\"\nENV OS_BUNDLER_VERSION=\"$OS_BUNDLER_VERSION\"\n#   Modify the OPENSTUDIO_VERSION and OPENSTUDIO_SHA for new versions\nENV RUBY_VERSION=\"2.2.4\" \\\n    RUBY_SHA=\"b6eff568b48e0fda76e5a36333175df049b204e91217aa32a65153cc0cdcb761\"\n#   Don't combine with above since ENV vars are not initialized until after the above call\nENV OPENSTUDIO_DOWNLOAD_FILENAME=\"OpenStudio-$OPENSTUDIO_VERSION$OPENSTUDIO_VERSION_EXT.$OPENSTUDIO_SHA-Linux.deb\"\n#   Install gdebi, then download and install OpenStudio, then clean up.\n#   gdebi handles the installation of OpenStudio's dependencies including Qt5,\n#   Boost, and Ruby 2.2.4.\n#   OpenStudio 2.4.3 requires libwxgtk3.0-0 -- install manually for now\n#   install locales and set to en_US.UTF-8. This is needed for running the CLI on some machines\n#   such as singularity.\nRUN apt-get update \\\n && apt-get install autoconf build-essential ca-certificates curl gdebi-core git libfreetype6 libjpeg8 libdbus-glib-1-2 libfontconfig1 libglu1 libreadline-dev libsm6 libssl-dev libtool libwxgtk3.0-0v5 libxi6 libxml2-dev locales sudo zlib1g-dev -y \\\n && curl -sL https://raw.githubusercontent.com/NREL/OpenStudio-server/develop/docker/deployment/scripts/install_ruby.sh -o /usr/local/bin/install_ruby.sh \\\n && chmod +x /usr/local/bin/install_ruby.sh \\\n && /usr/local/bin/install_ruby.sh $RUBY_VERSION $RUBY_SHA \\\n && if [ -z \"${DOWNLOAD_PREFIX}\" ] ; then export OPENSTUDIO_DOWNLOAD_URL=https://openstudio-builds.s3.amazonaws.com/$OPENSTUDIO_VERSION/OpenStudio-$OPENSTUDIO_VERSION$OPENSTUDIO_VERSION_EXT.$OPENSTUDIO_SHA-Linux.deb ; else export OPENSTUDIO_DOWNLOAD_URL=https://openstudio-builds.s3.amazonaws.com/$DOWNLOAD_PREFIX/OpenStudio-$OPENSTUDIO_VERSION$OPENSTUDIO_VERSION_EXT.$OPENSTUDIO_SHA-Linux.deb ; fi \\\n && echo \"OpenStudio Package Download URL is ${OPENSTUDIO_DOWNLOAD_URL}\" \\\n && curl -SLO $OPENSTUDIO_DOWNLOAD_URL \\\n && grep -v -q \"<Code>AccessDenied</Code>\" ${OPENSTUDIO_DOWNLOAD_FILENAME} \\\n && gdebi -n $OPENSTUDIO_DOWNLOAD_FILENAME \\\n && rm -f /usr/local/bin/install_ruby.sh \\\n && rm -f $OPENSTUDIO_DOWNLOAD_FILENAME \\\n && rm -rf /var/lib/apt/lists/* \\\n && if dpkg --compare-versions \"${OPENSTUDIO_VERSION}\" \"gt\" \"2.5.1\" ; then rm -rf /usr/local/openstudio-${OPENSTUDIO_VERSION}/SketchUpPlugin ; else rm -rf /usr/SketchUpPlugin ; fi \\\n && locale-gen en_US en_US.UTF-8 \\\n && dpkg-reconfigure locales\n#  # Add RUBYLIB link for openstudio.rb. Support new location and old location.\nENV RUBYLIB=\"/usr/local/openstudio-${OPENSTUDIO_VERSION}/Ruby:/usr/Ruby\"\nENV ENERGYPLUS_EXE_PATH=\"/usr/local/openstudio-${OPENSTUDIO_VERSION}/EnergyPlus/energyplus\"\n#   The OpenStudio Gemfile contains a fixed bundler version, so you have to install and run specific to that version\nRUN gem install bundler \\\n && mkdir /var/oscli \\\n && cp /usr/local/openstudio-${OPENSTUDIO_VERSION}/Ruby/Gemfile /var/oscli/ \\\n && cp /usr/local/openstudio-${OPENSTUDIO_VERSION}/Ruby/Gemfile.lock /var/oscli/ \\\n && cp /usr/local/openstudio-${OPENSTUDIO_VERSION}/Ruby/openstudio-gems.gemspec /var/oscli/\nWORKDIR /var/oscli\nRUN bundle _${OS_BUNDLER_VERSION}_ install --path=gems --jobs=4 --retry=3\n#   Configure the bootdir & confirm that openstudio is able to load the bundled gem set in /var/gemdata\nVOLUME /var/simdata/openstudio\nWORKDIR /var/simdata/openstudio\nRUN openstudio --verbose --bundle /var/oscli/Gemfile --bundle_path /var/oscli/gems openstudio_version\nCMD [\"/bin/bash\"]\n#   FROM ubuntu:16.04 AS cli\n#   ARG OPENSTUDIO_VERSION\n#   # copy executable and energyplus from install\n#   COPY --from=base /usr/local/openstudio-${OPENSTUDIO_VERSION}/bin/openstudio /usr/local/openstudio-${OPENSTUDIO_VERSION}/bin/\n#   COPY --from=base /usr/local/openstudio-${OPENSTUDIO_VERSION}/EnergyPlus /usr/local/openstudio-${OPENSTUDIO_VERSION}/EnergyPlus\n#   RUN apt-get update && apt-get install -y --no-install-recommends \\\n#               libdbus-glib-1-2 \\\n#               libglu1 \\\n#   \t\t  libssl-dev \\\n#   \t\t  libpng-dev \\\n#               libgdbm-dev \\\n#        && rm -rf /var/lib/apt/lists/*\n#   # link executable from /usr/local/bin\n#   RUN ln -s /usr/local/openstudio-${OPENSTUDIO_VERSION}/bin/openstudio /usr/local/bin/openstudio\n#   VOLUME /var/simdata/openstudio\n#   WORKDIR /var/simdata/openstudio\n","originalDockerfileUglifiedHash":"19fa4db36f62bcee3cf54ac396dd93c6","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/bb07e95455fbe3db61abc7d8c9500fd93fe647d4.dockerfile"}