{"seed":2153006,"processedDockerfileHash":"95918774b537e4670fb5d0e93e9b6613","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-copy-instead-of-add","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM centos:centos7\nMAINTAINER gaowenfei\nENV SRC_DIR=\"/usr/local\"\nENV PHP_VERSION=\"7.1.14\"\nENV SWOOLE_VERSION=\"4.0.3\"\nENV PHP_DIR=\"/usr/local/php/${PHP_VERSION}\"\nENV PHP_INI_DIR=\"/etc/php/${PHP_VERSION}/cli\"\nENV INIT_FILE=\"${PHP_INI_DIR}/conf.d\"\nENV HIREDIS_VERSION=\"0.13.3\"\nENV PHPREDIS_VERSION=\"3.1.6\"\nENV PHPDS_VERSION=\"1.2.4\"\nENV PHPINOTIFY_VERSION=\"2.0.0\"\n#  set ldconf\nRUN echo \"include /etc/ld.so.conf.d/*.conf\" > /etc/ld.so.conf \\\n && cd /etc/ld.so.conf.d \\\n && echo \"/usr/local/lib\" > /etc/ld.so.conf.d/libc.conf\n#   tools\nRUN yum -y install wget gcc make autoconf libxml2 libxml2-devel openssl openssl-devel curl curl-devel pcre pcre-devel libxslt libxslt-devel bzip2 bzip2-devel libedit libedit-devel glibc-headers gcc-c++ \\\n && rm -rf /var/cache/{yum,ldconfig}/* \\\n && rm -rf /etc/ld.so.cache \\\n && yum clean all\n#   php\nCOPY install/php-${PHP_VERSION}.tar.gz ${SRC_DIR}/\nRUN cd ${SRC_DIR}/php-${PHP_VERSION} \\\n && ln -s /usr/lib64/libssl.so /usr/lib \\\n && ./configure --prefix=${PHP_DIR} --with-config-file-path=${PHP_INI_DIR} --with-config-file-scan-dir=\"${PHP_INI_DIR}/conf.d\" --disable-cgi --enable-bcmath --enable-mbstring --enable-mysqlnd --enable-opcache --enable-pcntl --enable-xml --enable-zip --with-curl --with-libedit --with-openssl --with-zlib --with-curl --with-mysqli --with-pdo-mysql --with-pear --with-zlib \\\n && make clean > /dev/null \\\n && make \\\n && make install \\\n && ln -s ${PHP_DIR}/bin/php /usr/local/bin/ \\\n && ln -s ${PHP_DIR}/bin/phpize /usr/local/bin/ \\\n && ln -s ${PHP_DIR}/bin/pecl /usr/local/bin/ \\\n && ln -s ${PHP_DIR}/bin/php-config /usr/local/bin/ \\\n && mkdir -p ${PHP_INI_DIR}/conf.d \\\n && cp ${SRC_DIR}/php-${PHP_VERSION}/php.ini-production ${PHP_INI_DIR}/php.ini \\\n && echo -e \"opcache.enable=1\\nopcache.enable_cli=1\\nzend_extension=opcache.so\" > ${PHP_INI_DIR}/conf.d/10-opcache.ini \\\n && rm -f ${SRC_DIR}/php-${PHP_VERSION}.tar.gz \\\n && rm -rf ${SRC_DIR}/php-${PHP_VERSION}\n#    hiredis\nCOPY install/hiredis-${HIREDIS_VERSION}.tar.gz ${SRC_DIR}/\nRUN cd ${SRC_DIR}/hiredis-${HIREDIS_VERSION} \\\n && make clean > /dev/null \\\n && make \\\n && make install \\\n && ldconfig \\\n && rm -f ${SRC_DIR}/hiredis-${HIREDIS_VERSION}.tar.gz \\\n && rm -rf ${SRC_DIR}/hiredis-${HIREDIS_VERSION}\n#    swoole\nCOPY install/swoole-${SWOOLE_VERSION}.tar.gz ${SRC_DIR}/\nRUN cd ${SRC_DIR}/swoole-src-${SWOOLE_VERSION} \\\n && phpize \\\n && ./configure --enable-async-redis --enable-openssl --enable-mysqlnd --enable-coroutine \\\n && make clean > /dev/null \\\n && make \\\n && make install \\\n && echo \"extension=swoole.so\" > ${INIT_FILE}/swoole.ini \\\n && rm -f ${SRC_DIR}/swoole-${SWOOLE_VERSION}.tar.gz \\\n && rm -rf ${SRC_DIR}/swoole-src-${SWOOLE_VERSION}\n#    redis\nCOPY install/redis-${PHPREDIS_VERSION}.tar.gz ${SRC_DIR}/\nRUN cd ${SRC_DIR}/phpredis-${PHPREDIS_VERSION} \\\n && phpize \\\n && ./configure \\\n && make clean > /dev/null \\\n && make \\\n && make install \\\n && echo \"extension=redis.so\" > ${INIT_FILE}/redis.ini \\\n && rm -f ${SRC_DIR}/redis-${PHPREDIS_VERSION}.tar.gz \\\n && rm -rf ${SRC_DIR}/phpredis-${PHPREDIS_VERSION}\n#    ds\nCOPY install/ds-${PHPDS_VERSION}.tar.gz ${SRC_DIR}/\nRUN cd ${SRC_DIR}/extension-${PHPDS_VERSION} \\\n && phpize \\\n && ./configure \\\n && make clean > /dev/null \\\n && make \\\n && make install \\\n && echo \"extension=ds.so\" > ${INIT_FILE}/ds.ini \\\n && rm -f ${SRC_DIR}/ds-${PHPDS_VERSION}.tar.gz \\\n && rm -rf ${SRC_DIR}/extension-${PHPDS_VERSION}\n#    inotify\nCOPY install/inotify-${PHPINOTIFY_VERSION}.tar.gz ${SRC_DIR}/\nRUN cd ${SRC_DIR}/php-inotify-${PHPINOTIFY_VERSION} \\\n && phpize \\\n && ./configure \\\n && make clean > /dev/null \\\n && make \\\n && make install \\\n && echo \"extension=inotify.so\" > ${INIT_FILE}/inotify.ini \\\n && rm -f ${SRC_DIR}/inotify-${PHPINOTIFY_VERSION}.tar.gz \\\n && rm -rf ${SRC_DIR}/php-inotify-${PHPINOTIFY_VERSION}\nCOPY ./config/* ${INIT_FILE}/\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"FROM centos:centos7\nMAINTAINER gaowenfei\nENV SRC_DIR=\"/usr/local\"\nENV PHP_VERSION=\"7.1.14\"\nENV SWOOLE_VERSION=\"4.0.3\"\nENV PHP_DIR=\"/usr/local/php/${PHP_VERSION}\"\nENV PHP_INI_DIR=\"/etc/php/${PHP_VERSION}/cli\"\nENV INIT_FILE=\"${PHP_INI_DIR}/conf.d\"\nENV HIREDIS_VERSION=\"0.13.3\"\nENV PHPREDIS_VERSION=\"3.1.6\"\nENV PHPDS_VERSION=\"1.2.4\"\nENV PHPINOTIFY_VERSION=\"2.0.0\"\n# set ldconf\nRUN echo \"include /etc/ld.so.conf.d/*.conf\" > /etc/ld.so.conf \\\n && cd /etc/ld.so.conf.d \\\n && echo \"/usr/local/lib\" > /etc/ld.so.conf.d/libc.conf\n#  tools\nRUN yum -y install wget gcc make autoconf libxml2 libxml2-devel openssl openssl-devel curl curl-devel pcre pcre-devel libxslt libxslt-devel bzip2 bzip2-devel libedit libedit-devel glibc-headers gcc-c++ \\\n && rm -rf /var/cache/{yum,ldconfig}/* \\\n && rm -rf /etc/ld.so.cache \\\n && yum clean all\n#  php\nADD install/php-${PHP_VERSION}.tar.gz ${SRC_DIR}/\nRUN cd ${SRC_DIR}/php-${PHP_VERSION} \\\n && ln -s /usr/lib64/libssl.so /usr/lib \\\n && ./configure --prefix=${PHP_DIR} --with-config-file-path=${PHP_INI_DIR} --with-config-file-scan-dir=\"${PHP_INI_DIR}/conf.d\" --disable-cgi --enable-bcmath --enable-mbstring --enable-mysqlnd --enable-opcache --enable-pcntl --enable-xml --enable-zip --with-curl --with-libedit --with-openssl --with-zlib --with-curl --with-mysqli --with-pdo-mysql --with-pear --with-zlib \\\n && make clean > /dev/null \\\n && make \\\n && make install \\\n && ln -s ${PHP_DIR}/bin/php /usr/local/bin/ \\\n && ln -s ${PHP_DIR}/bin/phpize /usr/local/bin/ \\\n && ln -s ${PHP_DIR}/bin/pecl /usr/local/bin/ \\\n && ln -s ${PHP_DIR}/bin/php-config /usr/local/bin/ \\\n && mkdir -p ${PHP_INI_DIR}/conf.d \\\n && cp ${SRC_DIR}/php-${PHP_VERSION}/php.ini-production ${PHP_INI_DIR}/php.ini \\\n && echo -e \"opcache.enable=1\\nopcache.enable_cli=1\\nzend_extension=opcache.so\" > ${PHP_INI_DIR}/conf.d/10-opcache.ini \\\n && rm -f ${SRC_DIR}/php-${PHP_VERSION}.tar.gz \\\n && rm -rf ${SRC_DIR}/php-${PHP_VERSION}\n#   hiredis\nADD install/hiredis-${HIREDIS_VERSION}.tar.gz ${SRC_DIR}/\nRUN cd ${SRC_DIR}/hiredis-${HIREDIS_VERSION} \\\n && make clean > /dev/null \\\n && make \\\n && make install \\\n && ldconfig \\\n && rm -f ${SRC_DIR}/hiredis-${HIREDIS_VERSION}.tar.gz \\\n && rm -rf ${SRC_DIR}/hiredis-${HIREDIS_VERSION}\n#   swoole\nADD install/swoole-${SWOOLE_VERSION}.tar.gz ${SRC_DIR}/\nRUN cd ${SRC_DIR}/swoole-src-${SWOOLE_VERSION} \\\n && phpize \\\n && ./configure --enable-async-redis --enable-openssl --enable-mysqlnd --enable-coroutine \\\n && make clean > /dev/null \\\n && make \\\n && make install \\\n && echo \"extension=swoole.so\" > ${INIT_FILE}/swoole.ini \\\n && rm -f ${SRC_DIR}/swoole-${SWOOLE_VERSION}.tar.gz \\\n && rm -rf ${SRC_DIR}/swoole-src-${SWOOLE_VERSION}\n#   redis\nADD install/redis-${PHPREDIS_VERSION}.tar.gz ${SRC_DIR}/\nRUN cd ${SRC_DIR}/phpredis-${PHPREDIS_VERSION} \\\n && phpize \\\n && ./configure \\\n && make clean > /dev/null \\\n && make \\\n && make install \\\n && echo \"extension=redis.so\" > ${INIT_FILE}/redis.ini \\\n && rm -f ${SRC_DIR}/redis-${PHPREDIS_VERSION}.tar.gz \\\n && rm -rf ${SRC_DIR}/phpredis-${PHPREDIS_VERSION}\n#   ds\nADD install/ds-${PHPDS_VERSION}.tar.gz ${SRC_DIR}/\nRUN cd ${SRC_DIR}/extension-${PHPDS_VERSION} \\\n && phpize \\\n && ./configure \\\n && make clean > /dev/null \\\n && make \\\n && make install \\\n && echo \"extension=ds.so\" > ${INIT_FILE}/ds.ini \\\n && rm -f ${SRC_DIR}/ds-${PHPDS_VERSION}.tar.gz \\\n && rm -rf ${SRC_DIR}/extension-${PHPDS_VERSION}\n#   inotify\nADD install/inotify-${PHPINOTIFY_VERSION}.tar.gz ${SRC_DIR}/\nRUN cd ${SRC_DIR}/php-inotify-${PHPINOTIFY_VERSION} \\\n && phpize \\\n && ./configure \\\n && make clean > /dev/null \\\n && make \\\n && make install \\\n && echo \"extension=inotify.so\" > ${INIT_FILE}/inotify.ini \\\n && rm -f ${SRC_DIR}/inotify-${PHPINOTIFY_VERSION}.tar.gz \\\n && rm -rf ${SRC_DIR}/php-inotify-${PHPINOTIFY_VERSION}\nCOPY ./config/* ${INIT_FILE}/\n","injectedSmells":[],"originalDockerfileHash":"1408199e5280d9d67088902f0020da2e","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM centos:centos7\nMAINTAINER gaowenfei\nENV SRC_DIR=\"/usr/local\"\nENV PHP_VERSION=\"7.1.14\"\nENV SWOOLE_VERSION=\"4.0.3\"\nENV PHP_DIR=\"/usr/local/php/${PHP_VERSION}\"\nENV PHP_INI_DIR=\"/etc/php/${PHP_VERSION}/cli\"\nENV INIT_FILE=\"${PHP_INI_DIR}/conf.d\"\nENV HIREDIS_VERSION=\"0.13.3\"\nENV PHPREDIS_VERSION=\"3.1.6\"\nENV PHPDS_VERSION=\"1.2.4\"\nENV PHPINOTIFY_VERSION=\"2.0.0\"\n#  set ldconf\nRUN echo \"include /etc/ld.so.conf.d/*.conf\" > /etc/ld.so.conf \\\n && cd /etc/ld.so.conf.d \\\n && echo \"/usr/local/lib\" > /etc/ld.so.conf.d/libc.conf\n#   tools\nRUN yum -y install wget gcc make autoconf libxml2 libxml2-devel openssl openssl-devel curl curl-devel pcre pcre-devel libxslt libxslt-devel bzip2 bzip2-devel libedit libedit-devel glibc-headers gcc-c++ \\\n && rm -rf /var/cache/{yum,ldconfig}/* \\\n && rm -rf /etc/ld.so.cache \\\n && yum clean all\n#   php\nADD install/php-${PHP_VERSION}.tar.gz ${SRC_DIR}/\nRUN cd ${SRC_DIR}/php-${PHP_VERSION} \\\n && ln -s /usr/lib64/libssl.so /usr/lib \\\n && ./configure --prefix=${PHP_DIR} --with-config-file-path=${PHP_INI_DIR} --with-config-file-scan-dir=\"${PHP_INI_DIR}/conf.d\" --disable-cgi --enable-bcmath --enable-mbstring --enable-mysqlnd --enable-opcache --enable-pcntl --enable-xml --enable-zip --with-curl --with-libedit --with-openssl --with-zlib --with-curl --with-mysqli --with-pdo-mysql --with-pear --with-zlib \\\n && make clean > /dev/null \\\n && make \\\n && make install \\\n && ln -s ${PHP_DIR}/bin/php /usr/local/bin/ \\\n && ln -s ${PHP_DIR}/bin/phpize /usr/local/bin/ \\\n && ln -s ${PHP_DIR}/bin/pecl /usr/local/bin/ \\\n && ln -s ${PHP_DIR}/bin/php-config /usr/local/bin/ \\\n && mkdir -p ${PHP_INI_DIR}/conf.d \\\n && cp ${SRC_DIR}/php-${PHP_VERSION}/php.ini-production ${PHP_INI_DIR}/php.ini \\\n && echo -e \"opcache.enable=1\\nopcache.enable_cli=1\\nzend_extension=opcache.so\" > ${PHP_INI_DIR}/conf.d/10-opcache.ini \\\n && rm -f ${SRC_DIR}/php-${PHP_VERSION}.tar.gz \\\n && rm -rf ${SRC_DIR}/php-${PHP_VERSION}\n#    hiredis\nADD install/hiredis-${HIREDIS_VERSION}.tar.gz ${SRC_DIR}/\nRUN cd ${SRC_DIR}/hiredis-${HIREDIS_VERSION} \\\n && make clean > /dev/null \\\n && make \\\n && make install \\\n && ldconfig \\\n && rm -f ${SRC_DIR}/hiredis-${HIREDIS_VERSION}.tar.gz \\\n && rm -rf ${SRC_DIR}/hiredis-${HIREDIS_VERSION}\n#    swoole\nADD install/swoole-${SWOOLE_VERSION}.tar.gz ${SRC_DIR}/\nRUN cd ${SRC_DIR}/swoole-src-${SWOOLE_VERSION} \\\n && phpize \\\n && ./configure --enable-async-redis --enable-openssl --enable-mysqlnd --enable-coroutine \\\n && make clean > /dev/null \\\n && make \\\n && make install \\\n && echo \"extension=swoole.so\" > ${INIT_FILE}/swoole.ini \\\n && rm -f ${SRC_DIR}/swoole-${SWOOLE_VERSION}.tar.gz \\\n && rm -rf ${SRC_DIR}/swoole-src-${SWOOLE_VERSION}\n#    redis\nADD install/redis-${PHPREDIS_VERSION}.tar.gz ${SRC_DIR}/\nRUN cd ${SRC_DIR}/phpredis-${PHPREDIS_VERSION} \\\n && phpize \\\n && ./configure \\\n && make clean > /dev/null \\\n && make \\\n && make install \\\n && echo \"extension=redis.so\" > ${INIT_FILE}/redis.ini \\\n && rm -f ${SRC_DIR}/redis-${PHPREDIS_VERSION}.tar.gz \\\n && rm -rf ${SRC_DIR}/phpredis-${PHPREDIS_VERSION}\n#    ds\nADD install/ds-${PHPDS_VERSION}.tar.gz ${SRC_DIR}/\nRUN cd ${SRC_DIR}/extension-${PHPDS_VERSION} \\\n && phpize \\\n && ./configure \\\n && make clean > /dev/null \\\n && make \\\n && make install \\\n && echo \"extension=ds.so\" > ${INIT_FILE}/ds.ini \\\n && rm -f ${SRC_DIR}/ds-${PHPDS_VERSION}.tar.gz \\\n && rm -rf ${SRC_DIR}/extension-${PHPDS_VERSION}\n#    inotify\nADD install/inotify-${PHPINOTIFY_VERSION}.tar.gz ${SRC_DIR}/\nRUN cd ${SRC_DIR}/php-inotify-${PHPINOTIFY_VERSION} \\\n && phpize \\\n && ./configure \\\n && make clean > /dev/null \\\n && make \\\n && make install \\\n && echo \"extension=inotify.so\" > ${INIT_FILE}/inotify.ini \\\n && rm -f ${SRC_DIR}/inotify-${PHPINOTIFY_VERSION}.tar.gz \\\n && rm -rf ${SRC_DIR}/php-inotify-${PHPINOTIFY_VERSION}\nCOPY ./config/* ${INIT_FILE}/\n","originalDockerfileUglifiedHash":"b06144cb3cfb65f3093fcf97a9f18139","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles_bianncle/7a2a14d2506e9beb13d90b1cd8c8e814a43b652b.dockerfile"}