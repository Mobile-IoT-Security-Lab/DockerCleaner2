{"seed":2620720034,"processedDockerfileHash":"685208a432afb53ec4f287f996dc31f2","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","use-copy-instead-of-add","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","use-copy-instead-of-add","have-a-user"],"processedDockerfile":"FROM openjdk:8-jre-slim\nENV STORM_CONF_DIR=\"/conf\" \\\n    STORM_DATA_DIR=\"/data\" \\\n    STORM_LOG_DIR=\"/logs\"\n#   Add a user with an explicit UID/GID and create necessary directories\nRUN set -eux ; groupadd -r storm --gid=1000 ; useradd -r -g storm --uid=1000 storm ; mkdir -p \"$STORM_CONF_DIR\" \"$STORM_DATA_DIR\" \"$STORM_LOG_DIR\" ; chown -R storm:storm \"$STORM_CONF_DIR\" \"$STORM_DATA_DIR\" \"$STORM_LOG_DIR\"``\n#   Install required packages\nRUN :\nRUN set -eux ; : ; (apt-get update ;apt-get install --no-install-recommends bash=5.1-2+deb11u1 ca-certificates=20210119 dirmngr=2.2.27-2+deb11u2 gosu=1.12-1+b6 gnupg=2.2.27-2+deb11u2 python2.7=2.7.18-8 procps=2:3.3.17-5 wget=1.21-1+deb11u1 -y ) ; rm -rf /var/lib/apt/lists/* ; gosu nobody true\nARG GPG_KEY=5167DE337E7370373499FC1DA4A672F11B5050C8\nARG DISTRO_NAME=apache-storm-1.2.4\n#   Download Apache Storm, verify its PGP signature, untar and clean up\nRUN set -eux ; ddist() { local f=\"$1\" ;shift ;local distFile=\"$1\" ;shift ;local success= ;local distUrl= ;for distUrl in 'https://www.apache.org/dyn/closer.cgi?action=download&filename=' https://www-us.apache.org/dist/ https://www.apache.org/dist/ https://archive.apache.org/dist/; do if wget -q -O \"$f\" \"$distUrl$distFile\" \\\n && [ -s \"$f\" ] ; then success=1 ;break ; fi ; done ;[ -n \"$success\" ] ; } ; ddist \"$DISTRO_NAME.tar.gz\" \"storm/$DISTRO_NAME/$DISTRO_NAME.tar.gz\" ; ddist \"$DISTRO_NAME.tar.gz.asc\" \"storm/$DISTRO_NAME/$DISTRO_NAME.tar.gz.asc\" ; export GNUPGHOME=\"$( mktemp -d ;)\" ; gpg --keyserver keyserver.ubuntu.com --recv-key \"$GPG_KEY\" || gpg --keyserver ha.pool.sks-keyservers.net --recv-key \"$GPG_KEY\" || gpg --keyserver pgp.mit.edu --recv-keys \"$GPG_KEY\" || gpg --keyserver keyserver.pgp.com --recv-keys \"$GPG_KEY\" ; gpg --batch --verify \"$DISTRO_NAME.tar.gz.asc\" \"$DISTRO_NAME.tar.gz\" ; tar -xzf \"$DISTRO_NAME.tar.gz\" ; rm -rf \"$GNUPGHOME\" \"$DISTRO_NAME.tar.gz\" \"$DISTRO_NAME.tar.gz.asc\" ; chown -R storm:storm \"$DISTRO_NAME\"\nWORKDIR $DISTRO_NAME\nENV PATH=\"$PATH:/$DISTRO_NAME/bin\"\nCOPY docker-entrypoint.sh /\nENTRYPOINT [\"/docker-entrypoint.sh\"]\nHEALTHCHECK CMD curl --fail http://127.0.0.1:8080 || exit 1\nUSER 0\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n","originalDockerfile":"FROM openjdk:8-jre-slim\nENV STORM_CONF_DIR=\"/conf\" \\\n    STORM_DATA_DIR=\"/data\" \\\n    STORM_LOG_DIR=\"/logs\"\n#  Add a user with an explicit UID/GID and create necessary directories\nRUN set -eux ; groupadd -r storm --gid=1000 ; useradd -r -g storm --uid=1000 storm ; mkdir -p \"$STORM_CONF_DIR\" \"$STORM_DATA_DIR\" \"$STORM_LOG_DIR\" ; chown -R storm:storm \"$STORM_CONF_DIR\" \"$STORM_DATA_DIR\" \"$STORM_LOG_DIR\"``\n#  Install required packages\nRUN apt-get update\nRUN set -eux ; : ; apt-get install bash=5.1-2+deb11u1 ca-certificates=20210119 dirmngr=2.2.27-2+deb11u2 gosu=1.12-1+b6 gnupg=2.2.27-2+deb11u2 python2.7=2.7.18-8 procps=2:3.3.17-5 wget=1.21-1+deb11u1 -y ; rm -rf /var/lib/apt/lists/* ; gosu nobody true\nARG GPG_KEY=5167DE337E7370373499FC1DA4A672F11B5050C8\nARG DISTRO_NAME=apache-storm-1.2.4\n#  Download Apache Storm, verify its PGP signature, untar and clean up\nRUN set -eux ; ddist() { local f=\"$1\" ;shift ;local distFile=\"$1\" ;shift ;local success= ;local distUrl= ;for distUrl in 'https://www.apache.org/dyn/closer.cgi?action=download&filename=' https://www-us.apache.org/dist/ https://www.apache.org/dist/ https://archive.apache.org/dist/; do if wget -q -O \"$f\" \"$distUrl$distFile\" \\\n && [ -s \"$f\" ] ; then success=1 ;break ; fi ; done ;[ -n \"$success\" ] ; } ; ddist \"$DISTRO_NAME.tar.gz\" \"storm/$DISTRO_NAME/$DISTRO_NAME.tar.gz\" ; ddist \"$DISTRO_NAME.tar.gz.asc\" \"storm/$DISTRO_NAME/$DISTRO_NAME.tar.gz.asc\" ; export GNUPGHOME=\"$( mktemp -d ;)\" ; gpg --keyserver keyserver.ubuntu.com --recv-key \"$GPG_KEY\" || gpg --keyserver ha.pool.sks-keyservers.net --recv-key \"$GPG_KEY\" || gpg --keyserver pgp.mit.edu --recv-keys \"$GPG_KEY\" || gpg --keyserver keyserver.pgp.com --recv-keys \"$GPG_KEY\" ; gpg --batch --verify \"$DISTRO_NAME.tar.gz.asc\" \"$DISTRO_NAME.tar.gz\" ; tar -xzf \"$DISTRO_NAME.tar.gz\" ; rm -rf \"$GNUPGHOME\" \"$DISTRO_NAME.tar.gz\" \"$DISTRO_NAME.tar.gz.asc\" ; chown -R storm:storm \"$DISTRO_NAME\"\nWORKDIR $DISTRO_NAME\nENV PATH=\"$PATH:/$DISTRO_NAME/bin\"\nADD docker-entrypoint.sh /\nENTRYPOINT [\"/docker-entrypoint.sh\"]\nHEALTHCHECK CMD curl --fail http://127.0.0.1:8080 || exit 1\nUSER 0\n","injectedSmells":[],"originalDockerfileHash":"ca338e1a78c6c1be0ee6cd5b9c3503a2","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM openjdk:8-jre-slim\nENV STORM_CONF_DIR=\"/conf\" \\\n    STORM_DATA_DIR=\"/data\" \\\n    STORM_LOG_DIR=\"/logs\"\n#   Add a user with an explicit UID/GID and create necessary directories\nRUN set -eux ; groupadd -r storm --gid=1000 ; useradd -r -g storm --uid=1000 storm ; mkdir -p \"$STORM_CONF_DIR\" \"$STORM_DATA_DIR\" \"$STORM_LOG_DIR\" ; chown -R storm:storm \"$STORM_CONF_DIR\" \"$STORM_DATA_DIR\" \"$STORM_LOG_DIR\"``\n#   Install required packages\nRUN apt-get update\nRUN set -eux ; : ; apt-get install bash=5.1-2+deb11u1 ca-certificates=20210119 dirmngr=2.2.27-2+deb11u2 gosu=1.12-1+b6 gnupg=2.2.27-2+deb11u2 python2.7=2.7.18-8 procps=2:3.3.17-5 wget=1.21-1+deb11u1 -y ; rm -rf /var/lib/apt/lists/* ; gosu nobody true\nARG GPG_KEY=5167DE337E7370373499FC1DA4A672F11B5050C8\nARG DISTRO_NAME=apache-storm-1.2.4\n#   Download Apache Storm, verify its PGP signature, untar and clean up\nRUN set -eux ; ddist() { local f=\"$1\" ;shift ;local distFile=\"$1\" ;shift ;local success= ;local distUrl= ;for distUrl in 'https://www.apache.org/dyn/closer.cgi?action=download&filename=' https://www-us.apache.org/dist/ https://www.apache.org/dist/ https://archive.apache.org/dist/; do if wget -q -O \"$f\" \"$distUrl$distFile\" \\\n && [ -s \"$f\" ] ; then success=1 ;break ; fi ; done ;[ -n \"$success\" ] ; } ; ddist \"$DISTRO_NAME.tar.gz\" \"storm/$DISTRO_NAME/$DISTRO_NAME.tar.gz\" ; ddist \"$DISTRO_NAME.tar.gz.asc\" \"storm/$DISTRO_NAME/$DISTRO_NAME.tar.gz.asc\" ; export GNUPGHOME=\"$( mktemp -d ;)\" ; gpg --keyserver keyserver.ubuntu.com --recv-key \"$GPG_KEY\" || gpg --keyserver ha.pool.sks-keyservers.net --recv-key \"$GPG_KEY\" || gpg --keyserver pgp.mit.edu --recv-keys \"$GPG_KEY\" || gpg --keyserver keyserver.pgp.com --recv-keys \"$GPG_KEY\" ; gpg --batch --verify \"$DISTRO_NAME.tar.gz.asc\" \"$DISTRO_NAME.tar.gz\" ; tar -xzf \"$DISTRO_NAME.tar.gz\" ; rm -rf \"$GNUPGHOME\" \"$DISTRO_NAME.tar.gz\" \"$DISTRO_NAME.tar.gz.asc\" ; chown -R storm:storm \"$DISTRO_NAME\"\nWORKDIR $DISTRO_NAME\nENV PATH=\"$PATH:/$DISTRO_NAME/bin\"\nADD docker-entrypoint.sh /\nENTRYPOINT [\"/docker-entrypoint.sh\"]\nHEALTHCHECK CMD curl --fail http://127.0.0.1:8080 || exit 1\nUSER 0\n","originalDockerfileUglifiedHash":"2c57160834b9e568ed01cb0e8743a9ef","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles/storm__1.2.4__3__injected.dockerfile"}