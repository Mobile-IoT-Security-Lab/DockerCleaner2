{"seed":670033557,"processedDockerfileHash":"d76601d4dbd4a17ed532a90d22e8c78b","fixedSmells":["use-copy-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["use-copy-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"processedDockerfile":"FROM php:8.0-apache\nLABEL org.opencontainers.image.title=\"YOURLS\"\nLABEL org.opencontainers.image.description=\"Your Own URL Shortener\"\nLABEL org.opencontainers.image.url=\"https://yourls.org/\"\nLABEL org.opencontainers.image.documentation=\"https://yourls.org/\"\nLABEL org.opencontainers.image.vendor=\"YOURLS Org\"\nLABEL org.opencontainers.image.authors=\"YOURLS\"\nLABEL org.opencontainers.image.version=\"1.8.2\"\nSHELL [\"/bin/bash\", \"-o\", \"pipefail\", \"-c\"]\n#   install the PHP extensions we need\nRUN set -eux ; docker-php-ext-install -j \"$( nproc ;)\" bcmath opcache pdo_mysql mysqli\n#   set recommended PHP.ini settings\n#   see https://secure.php.net/manual/en/opcache.installation.php\nRUN { echo 'opcache.memory_consumption=128' ;echo 'opcache.interned_strings_buffer=8' ;echo 'opcache.max_accelerated_files=4000' ;echo 'opcache.revalidate_freq=2' ;echo 'opcache.fast_shutdown=1' ; } > /usr/local/etc/php/conf.d/opcache-recommended.ini\nRUN a2enmod rewrite expires\nRUN set -eux ; version=\"1.8.2\" ; sha256=\"6d818622e3ba1d5785c2dbcc088be6890f5675fd4f24a2e3111eda4523bbd7ae\" ; curl -o yourls.tar.gz -fsSL \"https://github.com/YOURLS/YOURLS/archive/${version}.tar.gz\" ; echo \"$sha256 *yourls.tar.gz\" | sha256sum -c - ; tar -xf yourls.tar.gz -C /usr/src/ ; mv \"/usr/src/YOURLS-${version}\" /usr/src/yourls ; rm yourls.tar.gz ; chown -R www-data:www-data /usr/src/yourls\nCOPY --chown=www-data:www-data config-docker.php /usr/src/yourls/user/\nCOPY docker-entrypoint.sh /usr/local/bin/\nCOPY .htaccess /usr/src/yourls/\nENTRYPOINT [\"docker-entrypoint.sh\"]\nCMD [\"apache2-foreground\"]\nUSER root\n# A secret has been removed here. Please do not provide secrets from the Dockerfile as these will leak into the metadata of the resulting docker image. To provide secrets the --secret flag of the docker build command can be used (https://docs.docker.com/develop/develop-images/build_enhancements/#new-docker-build-secret-information).\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\n","originalDockerfile":"FROM php:8.0-apache\nLABEL org.opencontainers.image.title=\"YOURLS\"\nLABEL org.opencontainers.image.description=\"Your Own URL Shortener\"\nLABEL org.opencontainers.image.url=\"https://yourls.org/\"\nLABEL org.opencontainers.image.documentation=\"https://yourls.org/\"\nLABEL org.opencontainers.image.vendor=\"YOURLS Org\"\nLABEL org.opencontainers.image.authors=\"YOURLS\"\nLABEL org.opencontainers.image.version=\"1.8.2\"\nSHELL [\"/bin/bash\", \"-o\", \"pipefail\", \"-c\"]\n#  install the PHP extensions we need\nRUN set -eux ; docker-php-ext-install -j \"$( nproc ;)\" bcmath opcache pdo_mysql mysqli\n#  set recommended PHP.ini settings\n#  see https://secure.php.net/manual/en/opcache.installation.php\nRUN { echo 'opcache.memory_consumption=128' ;echo 'opcache.interned_strings_buffer=8' ;echo 'opcache.max_accelerated_files=4000' ;echo 'opcache.revalidate_freq=2' ;echo 'opcache.fast_shutdown=1' ; } > /usr/local/etc/php/conf.d/opcache-recommended.ini\nRUN a2enmod rewrite expires\nRUN set -eux ; version=\"1.8.2\" ; sha256=\"6d818622e3ba1d5785c2dbcc088be6890f5675fd4f24a2e3111eda4523bbd7ae\" ; curl -o yourls.tar.gz -fsSL \"https://github.com/YOURLS/YOURLS/archive/${version}.tar.gz\" ; echo \"$sha256 *yourls.tar.gz\" | sha256sum -c - ; tar -xf yourls.tar.gz -C /usr/src/ ; mv \"/usr/src/YOURLS-${version}\" /usr/src/yourls ; rm yourls.tar.gz ; chown -R www-data:www-data /usr/src/yourls\nADD --chown=www-data:www-data config-docker.php /usr/src/yourls/user/\nADD docker-entrypoint.sh /usr/local/bin/\nADD .htaccess /usr/src/yourls/\nENTRYPOINT [\"docker-entrypoint.sh\"]\nCMD [\"apache2-foreground\"]\nUSER root\nENV POSTGRES_PASSWORD=\"FnezmXQmcQrs5UAIeNdHlZCXYzvTRGvX2IBwgW4J\" \\\n    AWS_SECRET_KEY=\"LrUCxwof96CxmsLiOajvJdbd1/BtFBwnYdR8USJJ\" \\\n    NPM_TOKEN=\"npm_C4UM7cb0XghJUi6dZvmKFVNcyJjNQ1uvurDV\"\n","injectedSmells":[],"originalDockerfileHash":"37a91fd1a3f41d4e0ae836b027efe695","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM php:8.0-apache\nLABEL org.opencontainers.image.title=\"YOURLS\"\nLABEL org.opencontainers.image.description=\"Your Own URL Shortener\"\nLABEL org.opencontainers.image.url=\"https://yourls.org/\"\nLABEL org.opencontainers.image.documentation=\"https://yourls.org/\"\nLABEL org.opencontainers.image.vendor=\"YOURLS Org\"\nLABEL org.opencontainers.image.authors=\"YOURLS\"\nLABEL org.opencontainers.image.version=\"1.8.2\"\nSHELL [\"/bin/bash\", \"-o\", \"pipefail\", \"-c\"]\n#   install the PHP extensions we need\nRUN set -eux ; docker-php-ext-install -j \"$( nproc ;)\" bcmath opcache pdo_mysql mysqli\n#   set recommended PHP.ini settings\n#   see https://secure.php.net/manual/en/opcache.installation.php\nRUN { echo 'opcache.memory_consumption=128' ;echo 'opcache.interned_strings_buffer=8' ;echo 'opcache.max_accelerated_files=4000' ;echo 'opcache.revalidate_freq=2' ;echo 'opcache.fast_shutdown=1' ; } > /usr/local/etc/php/conf.d/opcache-recommended.ini\nRUN a2enmod rewrite expires\nRUN set -eux ; version=\"1.8.2\" ; sha256=\"6d818622e3ba1d5785c2dbcc088be6890f5675fd4f24a2e3111eda4523bbd7ae\" ; curl -o yourls.tar.gz -fsSL \"https://github.com/YOURLS/YOURLS/archive/${version}.tar.gz\" ; echo \"$sha256 *yourls.tar.gz\" | sha256sum -c - ; tar -xf yourls.tar.gz -C /usr/src/ ; mv \"/usr/src/YOURLS-${version}\" /usr/src/yourls ; rm yourls.tar.gz ; chown -R www-data:www-data /usr/src/yourls\nADD --chown=www-data:www-data config-docker.php /usr/src/yourls/user/\nADD docker-entrypoint.sh /usr/local/bin/\nADD .htaccess /usr/src/yourls/\nENTRYPOINT [\"docker-entrypoint.sh\"]\nCMD [\"apache2-foreground\"]\nUSER root\nENV POSTGRES_PASSWORD=\"FnezmXQmcQrs5UAIeNdHlZCXYzvTRGvX2IBwgW4J\" \\\n    AWS_SECRET_KEY=\"LrUCxwof96CxmsLiOajvJdbd1/BtFBwnYdR8USJJ\" \\\n    NPM_TOKEN=\"npm_C4UM7cb0XghJUi6dZvmKFVNcyJjNQ1uvurDV\"\n","originalDockerfileUglifiedHash":"6ae437a52decdeb346897e4d342ea393","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles/yourls__1.8.2-apache__8__injected.dockerfile"}