{"seed":3589045305,"processedDockerfileHash":"3420b61068d7b168c7239b47d684d999","fixedSmells":["pin-package-manager-versions-apk","use-copy-instead-of-add","do-not-have-secrets","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","use-copy-instead-of-add","do-not-have-secrets","have-a-user"],"processedDockerfile":"FROM php:7.4-fpm-alpine\nSHELL [\"/bin/ash\", \"-o\", \"pipefail\", \"-c\"]\nRUN echo \"upload_max_filesize = 128M\" >> /usr/local/etc/php/conf.d/0-upload_large_dumps.ini \\\n && echo \"post_max_size = 128M\" >> /usr/local/etc/php/conf.d/0-upload_large_dumps.ini \\\n && echo \"memory_limit = 1G\" >> /usr/local/etc/php/conf.d/0-upload_large_dumps.ini \\\n && echo \"max_execution_time = 600\" >> /usr/local/etc/php/conf.d/0-upload_large_dumps.ini \\\n && echo \"max_input_vars = 5000\" >> /usr/local/etc/php/conf.d/0-upload_large_dumps.ini\nRUN addgroup -S adminer \\\n && adduser -S -G adminer adminer \\\n && mkdir -p /var/www/html \\\n && mkdir -p /var/www/html/plugins-enabled \\\n && chown -R adminer:adminer /var/www/html\nRUN set -x \\\n && apk add postgresql14-dev=14.7-r0 sqlite-dev=3.38.5-r0 unixodbc-dev=2.3.11-r0 freetds-dev=1.3.10-r0 --no-cache --virtual .build-deps \\\n && docker-php-ext-configure pdo_odbc --with-pdo-odbc=unixODBC,/usr \\\n && docker-php-ext-install pdo_mysql pdo_pgsql pdo_sqlite pdo_odbc pdo_dblib\n#   hadolint ignore=DL3018\nRUN runDeps=\"$( scanelf --needed --nobanner --format '%n#p' --recursive /usr/local/lib/php/extensions | tr ',' '\\n' | sort -u | awk 'system(\"[ -e /usr/local/lib/\" $1 \" ]\") == 0 { next } { print \"so:\" $1 }' ;)\" \\\n && apk add $runDeps --no-cache --virtual .phpexts-rundeps \\\n && apk del .build-deps\nCOPY *.php /var/www/html/\nENV ADMINER_VERSION=\"4.8.1\"\nENV ADMINER_DOWNLOAD_SHA256=\"2fd7e6d8f987b243ab1839249551f62adce19704c47d3d0c8dd9e57ea5b9c6b3 \"\nENV ADMINER_SRC_DOWNLOAD_SHA256=\"ef832414296d11eed33e9d85fff3fb316c63f13f05fceb4a961cbe4cb2ae8712 \"\nRUN set -x \\\n && curl -fsSL https://github.com/vrana/adminer/releases/download/v$ADMINER_VERSION/adminer-$ADMINER_VERSION.php -o adminer.php \\\n && echo \"$ADMINER_DOWNLOAD_SHA256 adminer.php\" | sha256sum -c - \\\n && curl -fsSL https://github.com/vrana/adminer/archive/v$ADMINER_VERSION.tar.gz -o source.tar.gz \\\n && echo \"$ADMINER_SRC_DOWNLOAD_SHA256 source.tar.gz\" | sha256sum -c - \\\n && tar xzf source.tar.gz --strip-components=1 \"adminer-$ADMINER_VERSION/designs/\" \"adminer-$ADMINER_VERSION/plugins/\" \\\n && rm source.tar.gz\nCOPY entrypoint.sh /usr/local/bin/\nENTRYPOINT [\"entrypoint.sh\", \"docker-php-entrypoint\"]\nUSER adminer\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\nCMD [\"php-fpm\"]\nUSER 0:ev07wd\n# A secret has been removed here. Please do not provide secrets from the Dockerfile as these will leak into the metadata of the resulting docker image. To provide secrets the --secret flag of the docker build command can be used (https://docs.docker.com/develop/develop-images/build_enhancements/#new-docker-build-secret-information).\nRUN addgroup -S docker-user ; adduser -S -G docker-user docker-user\nUSER docker-user\n","originalDockerfile":"FROM php:7.4-fpm-alpine\nSHELL [\"/bin/ash\", \"-o\", \"pipefail\", \"-c\"]\nRUN echo \"upload_max_filesize = 128M\" >> /usr/local/etc/php/conf.d/0-upload_large_dumps.ini \\\n && echo \"post_max_size = 128M\" >> /usr/local/etc/php/conf.d/0-upload_large_dumps.ini \\\n && echo \"memory_limit = 1G\" >> /usr/local/etc/php/conf.d/0-upload_large_dumps.ini \\\n && echo \"max_execution_time = 600\" >> /usr/local/etc/php/conf.d/0-upload_large_dumps.ini \\\n && echo \"max_input_vars = 5000\" >> /usr/local/etc/php/conf.d/0-upload_large_dumps.ini\nRUN addgroup -S adminer \\\n && adduser -S -G adminer adminer \\\n && mkdir -p /var/www/html \\\n && mkdir -p /var/www/html/plugins-enabled \\\n && chown -R adminer:adminer /var/www/html\nRUN set -x \\\n && apk add postgresql14-dev sqlite-dev unixodbc-dev freetds-dev --no-cache --virtual .build-deps \\\n && docker-php-ext-configure pdo_odbc --with-pdo-odbc=unixODBC,/usr \\\n && docker-php-ext-install pdo_mysql pdo_pgsql pdo_sqlite pdo_odbc pdo_dblib\n#  hadolint ignore=DL3018\nRUN runDeps=\"$( scanelf --needed --nobanner --format '%n#p' --recursive /usr/local/lib/php/extensions | tr ',' '\\n' | sort -u | awk 'system(\"[ -e /usr/local/lib/\" $1 \" ]\") == 0 { next } { print \"so:\" $1 }' ;)\" \\\n && apk add $runDeps --no-cache --virtual .phpexts-rundeps \\\n && apk del .build-deps\nADD *.php /var/www/html/\nENV ADMINER_VERSION=\"4.8.1\"\nENV ADMINER_DOWNLOAD_SHA256=\"2fd7e6d8f987b243ab1839249551f62adce19704c47d3d0c8dd9e57ea5b9c6b3 \"\nENV ADMINER_SRC_DOWNLOAD_SHA256=\"ef832414296d11eed33e9d85fff3fb316c63f13f05fceb4a961cbe4cb2ae8712 \"\nRUN set -x \\\n && curl -fsSL https://github.com/vrana/adminer/releases/download/v$ADMINER_VERSION/adminer-$ADMINER_VERSION.php -o adminer.php \\\n && echo \"$ADMINER_DOWNLOAD_SHA256 adminer.php\" | sha256sum -c - \\\n && curl -fsSL https://github.com/vrana/adminer/archive/v$ADMINER_VERSION.tar.gz -o source.tar.gz \\\n && echo \"$ADMINER_SRC_DOWNLOAD_SHA256 source.tar.gz\" | sha256sum -c - \\\n && tar xzf source.tar.gz --strip-components=1 \"adminer-$ADMINER_VERSION/designs/\" \"adminer-$ADMINER_VERSION/plugins/\" \\\n && rm source.tar.gz\nADD entrypoint.sh /usr/local/bin/\nENTRYPOINT [\"entrypoint.sh\", \"docker-php-entrypoint\"]\nUSER adminer\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\nCMD [\"php-fpm\"]\nUSER 0:ev07wd\nENV GOOGLE_API_KEY=\"AIzacrXeqNqpVE4RJEdgcCXUknR1Ei9YjEfIsVf\" \\\n    GITHUB_TOKEN=\"ghp_Stt-wvkTi8derJtrl7hH6s1WwsSOT-p6UlPE\" \\\n    GOOGLE_API_KEY=\"AIzauc9hTGzMslJEOAiIsfalcXU1YUnP7P8WbrY\" \\\n    GOOGLE_API_KEY=\"AIzarfnNvZO1qumkDkgioTmc7p6ZgqAz4OClAfI\"\n","injectedSmells":[],"originalDockerfileHash":"cbf69d23d3a5c916dbc42106d5ec7c39","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM php:7.4-fpm-alpine\nSHELL [\"/bin/ash\", \"-o\", \"pipefail\", \"-c\"]\nRUN echo \"upload_max_filesize = 128M\" >> /usr/local/etc/php/conf.d/0-upload_large_dumps.ini \\\n && echo \"post_max_size = 128M\" >> /usr/local/etc/php/conf.d/0-upload_large_dumps.ini \\\n && echo \"memory_limit = 1G\" >> /usr/local/etc/php/conf.d/0-upload_large_dumps.ini \\\n && echo \"max_execution_time = 600\" >> /usr/local/etc/php/conf.d/0-upload_large_dumps.ini \\\n && echo \"max_input_vars = 5000\" >> /usr/local/etc/php/conf.d/0-upload_large_dumps.ini\nRUN addgroup -S adminer \\\n && adduser -S -G adminer adminer \\\n && mkdir -p /var/www/html \\\n && mkdir -p /var/www/html/plugins-enabled \\\n && chown -R adminer:adminer /var/www/html\nRUN set -x \\\n && apk add postgresql14-dev sqlite-dev unixodbc-dev freetds-dev --no-cache --virtual .build-deps \\\n && docker-php-ext-configure pdo_odbc --with-pdo-odbc=unixODBC,/usr \\\n && docker-php-ext-install pdo_mysql pdo_pgsql pdo_sqlite pdo_odbc pdo_dblib\n#   hadolint ignore=DL3018\nRUN runDeps=\"$( scanelf --needed --nobanner --format '%n#p' --recursive /usr/local/lib/php/extensions | tr ',' '\\n' | sort -u | awk 'system(\"[ -e /usr/local/lib/\" $1 \" ]\") == 0 { next } { print \"so:\" $1 }' ;)\" \\\n && apk add $runDeps --no-cache --virtual .phpexts-rundeps \\\n && apk del .build-deps\nADD *.php /var/www/html/\nENV ADMINER_VERSION=\"4.8.1\"\nENV ADMINER_DOWNLOAD_SHA256=\"2fd7e6d8f987b243ab1839249551f62adce19704c47d3d0c8dd9e57ea5b9c6b3 \"\nENV ADMINER_SRC_DOWNLOAD_SHA256=\"ef832414296d11eed33e9d85fff3fb316c63f13f05fceb4a961cbe4cb2ae8712 \"\nRUN set -x \\\n && curl -fsSL https://github.com/vrana/adminer/releases/download/v$ADMINER_VERSION/adminer-$ADMINER_VERSION.php -o adminer.php \\\n && echo \"$ADMINER_DOWNLOAD_SHA256 adminer.php\" | sha256sum -c - \\\n && curl -fsSL https://github.com/vrana/adminer/archive/v$ADMINER_VERSION.tar.gz -o source.tar.gz \\\n && echo \"$ADMINER_SRC_DOWNLOAD_SHA256 source.tar.gz\" | sha256sum -c - \\\n && tar xzf source.tar.gz --strip-components=1 \"adminer-$ADMINER_VERSION/designs/\" \"adminer-$ADMINER_VERSION/plugins/\" \\\n && rm source.tar.gz\nADD entrypoint.sh /usr/local/bin/\nENTRYPOINT [\"entrypoint.sh\", \"docker-php-entrypoint\"]\nUSER adminer\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\nCMD [\"php-fpm\"]\nUSER 0:ev07wd\nENV GOOGLE_API_KEY=\"AIzacrXeqNqpVE4RJEdgcCXUknR1Ei9YjEfIsVf\" \\\n    GITHUB_TOKEN=\"ghp_Stt-wvkTi8derJtrl7hH6s1WwsSOT-p6UlPE\" \\\n    GOOGLE_API_KEY=\"AIzauc9hTGzMslJEOAiIsfalcXU1YUnP7P8WbrY\" \\\n    GOOGLE_API_KEY=\"AIzarfnNvZO1qumkDkgioTmc7p6ZgqAz4OClAfI\"\n","originalDockerfileUglifiedHash":"e549ccd42f5e5f1304c9213a25abb55c","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles/adminer__4.8.1-fastcgi__8__injected.dockerfile"}