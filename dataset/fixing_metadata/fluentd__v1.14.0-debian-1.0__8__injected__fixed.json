{"seed":3219574202,"processedDockerfileHash":"64819fee5f985162d4f5b76101e5a3a8","fixedSmells":["use-no-install-recommends","pin-package-manager-versions-apt-get","pin-package-manager-versions-gem","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets"],"successfullyFixedSmells":["use-no-install-recommends","pin-package-manager-versions-apt-get","pin-package-manager-versions-gem","use-copy-instead-of-add","do-not-have-secrets"],"processedDockerfile":"#   AUTOMATICALLY GENERATED\n#   DO NOT EDIT THIS FILE DIRECTLY, USE /Dockerfile.template.erb\nFROM ruby:2.7-slim-bullseye\nLABEL maintainer=\"\\\"Fluentd developers <fluentd@googlegroups.com>\\\"\"\nLABEL Description=\"Fluentd docker image\" \\\n      Vendor=\"Fluent Organization\" \\\n      Version=\"1.14.6\"\nSHELL [\"/bin/bash\", \"-o\", \"pipefail\", \"-c\"]\nENV TINI_VERSION=\"0.18.0\"\n#   Do not split this into multiple RUN!\n#   Docker creates a layer for every RUN-Statement\n#   therefore an 'apt-get purge' has no effect\nRUN which wget &> /dev/null || apt-get install --no-install-recommends wget ; wget --no-verbose --directory-prefix /tmp/ https://github.com/jemalloc/jemalloc/releases/download/4.5.0/jemalloc-4.5.0.tar.bz2\nRUN apt-get update \\\n && apt-get install --no-install-recommends ca-certificates=20210119 -y \\\n && buildDeps=\" make gcc g++ libc6-dev wget bzip2 gnupg dirmngr \" \\\n && apt-get install --no-install-recommends make=4.3-4.1 gcc=4:10.2.1-1 g++=4:10.2.1-1 libc6-dev=2.31-13+deb11u5 wget=1.21-1+deb11u1 bzip2=1.0.8-4 gnupg=2.2.27-2+deb11u2 dirmngr=2.2.27-2+deb11u2 -y \\\n && echo 'gem: --no-document' >> /etc/gemrc \\\n && gem install oj --version 3.14.3 \\\n && gem install json --version 2.6.3 \\\n && gem install async-http --version 0.60.1 \\\n && gem install ext_monitor --version 0.1.2 \\\n && gem install fluentd --version 1.16.0 \\\n && dpkgArch=\"$( dpkg --print-architecture | awk -F- '{ print $NF }' ;)\" \\\n && wget -nv -O /usr/local/bin/tini \"https://github.com/krallin/tini/releases/download/v$TINI_VERSION/tini-$dpkgArch\" \\\n && wget -nv -O /usr/local/bin/tini.asc \"https://github.com/krallin/tini/releases/download/v$TINI_VERSION/tini-$dpkgArch.asc\" \\\n && export GNUPGHOME=\"$( mktemp -d ;)\" \\\n && gpg --batch --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys 6380DC428747F6C393FEACA59A84159D7001A4E5 \\\n && gpg --batch --verify /usr/local/bin/tini.asc /usr/local/bin/tini \\\n && rm -r /usr/local/bin/tini.asc \\\n && chmod +x /usr/local/bin/tini \\\n && tini -h \\\n && : \\\n && cd /tmp \\\n && tar -xjf jemalloc-4.5.0.tar.bz2 \\\n && cd jemalloc-4.5.0/ \\\n && ./configure \\\n && make \\\n && mv lib/libjemalloc.so.2 /usr/lib \\\n && apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false $buildDeps \\\n && rm -rf /var/lib/apt/lists/* \\\n && rm -rf /tmp/* /var/tmp/* /usr/lib/ruby/gems/*/cache/*.gem /usr/lib/ruby/gems/2.*/gems/fluentd-*/test\nRUN groupadd -r fluent \\\n && useradd -r -g fluent fluent \\\n && mkdir -p /fluentd/log \\\n && mkdir -p /fluentd/etc /fluentd/plugins \\\n && chown -R fluent /fluentd \\\n && chgrp -R fluent /fluentd\nCOPY fluent.conf /fluentd/etc/\nCOPY entrypoint.sh /bin/\nENV FLUENTD_CONF=\"fluent.conf\"\nENV LD_PRELOAD=\"/usr/lib/libjemalloc.so.2\"\nEXPOSE 24224/tcp 5140/tcp\nUSER fluent\nENTRYPOINT [\"tini\", \"--\", \"/bin/entrypoint.sh\"]\nHEALTHCHECK CMD curl --fail http://127.0.0.1:24224 || exit 1\nCMD [\"fluentd\"]\n# A secret has been removed here. Please do not provide secrets from the Dockerfile as these will leak into the metadata of the resulting docker image. To provide secrets the --secret flag of the docker build command can be used (https://docs.docker.com/develop/develop-images/build_enhancements/#new-docker-build-secret-information).\n","originalDockerfile":"#  AUTOMATICALLY GENERATED\n#  DO NOT EDIT THIS FILE DIRECTLY, USE /Dockerfile.template.erb\nFROM ruby:2.7-slim-bullseye\nLABEL maintainer=\"\\\"Fluentd developers <fluentd@googlegroups.com>\\\"\"\nLABEL Description=\"Fluentd docker image\" \\\n      Vendor=\"Fluent Organization\" \\\n      Version=\"1.14.6\"\nSHELL [\"/bin/bash\", \"-o\", \"pipefail\", \"-c\"]\nENV TINI_VERSION=\"0.18.0\"\n#  Do not split this into multiple RUN!\n#  Docker creates a layer for every RUN-Statement\n#  therefore an 'apt-get purge' has no effect\nADD https://github.com/jemalloc/jemalloc/releases/download/4.5.0/jemalloc-4.5.0.tar.bz2 /tmp/jemalloc-4.5.0.tar.bz2\nRUN apt-get update \\\n && apt-get install ca-certificates -y \\\n && buildDeps=\" make gcc g++ libc6-dev wget bzip2 gnupg dirmngr \" \\\n && apt-get install make gcc g++ libc6-dev wget bzip2 gnupg dirmngr -y \\\n && echo 'gem: --no-document' >> /etc/gemrc \\\n && gem install oj \\\n && gem install json \\\n && gem install async-http \\\n && gem install ext_monitor \\\n && gem install fluentd \\\n && dpkgArch=\"$( dpkg --print-architecture | awk -F- '{ print $NF }' ;)\" \\\n && wget -nv -O /usr/local/bin/tini \"https://github.com/krallin/tini/releases/download/v$TINI_VERSION/tini-$dpkgArch\" \\\n && wget -nv -O /usr/local/bin/tini.asc \"https://github.com/krallin/tini/releases/download/v$TINI_VERSION/tini-$dpkgArch.asc\" \\\n && export GNUPGHOME=\"$( mktemp -d ;)\" \\\n && gpg --batch --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys 6380DC428747F6C393FEACA59A84159D7001A4E5 \\\n && gpg --batch --verify /usr/local/bin/tini.asc /usr/local/bin/tini \\\n && rm -r /usr/local/bin/tini.asc \\\n && chmod +x /usr/local/bin/tini \\\n && tini -h \\\n && : \\\n && cd /tmp \\\n && tar -xjf jemalloc-4.5.0.tar.bz2 \\\n && cd jemalloc-4.5.0/ \\\n && ./configure \\\n && make \\\n && mv lib/libjemalloc.so.2 /usr/lib \\\n && apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false $buildDeps \\\n && rm -rf /var/lib/apt/lists/* \\\n && rm -rf /tmp/* /var/tmp/* /usr/lib/ruby/gems/*/cache/*.gem /usr/lib/ruby/gems/2.*/gems/fluentd-*/test\nRUN groupadd -r fluent \\\n && useradd -r -g fluent fluent \\\n && mkdir -p /fluentd/log \\\n && mkdir -p /fluentd/etc /fluentd/plugins \\\n && chown -R fluent /fluentd \\\n && chgrp -R fluent /fluentd\nADD fluent.conf /fluentd/etc/\nADD entrypoint.sh /bin/\nENV FLUENTD_CONF=\"fluent.conf\"\nENV LD_PRELOAD=\"/usr/lib/libjemalloc.so.2\"\nEXPOSE 24224/tcp 5140/tcp\nUSER fluent\nENTRYPOINT [\"tini\", \"--\", \"/bin/entrypoint.sh\"]\nHEALTHCHECK CMD curl --fail http://127.0.0.1:24224 || exit 1\nCMD [\"fluentd\"]\nENV GOOGLE_API_KEY=\"AIzanc8vIyjV4QqrTfi0FUbYnXW14iAQxvwAR1Z\" \\\n    GOOGLE_API_KEY=\"AIzau076nLIKA6KHb0FxJ6tQvxWs96fas2GJ3v6\" \\\n    CONSUMER_SECRET=\"dFg6gyrFvCiCqP6207lCT1-4/XuL0HQcNszKK96xpZC7vEBwuwC9\" \\\n    POSTGRES_PASSWORD=\"ZYBGBkyDHeZgNRsjXTb2O1NIzbjb5EpyVvXYQbLH\" \\\n    NPM_TOKEN=\"npm_crGCeq9YZctC0bJ-t5B1Iuge2dvPkLQ7nwHp\"\n","injectedSmells":[],"originalDockerfileHash":"ca4b218cf603f85445c1448bbfe6cdba","successfullyInjectedSmells":[],"originalDockerfileUglified":"#   AUTOMATICALLY GENERATED\n#   DO NOT EDIT THIS FILE DIRECTLY, USE /Dockerfile.template.erb\nFROM ruby:2.7-slim-bullseye\nLABEL maintainer=\"\\\"Fluentd developers <fluentd@googlegroups.com>\\\"\"\nLABEL Description=\"Fluentd docker image\" \\\n      Vendor=\"Fluent Organization\" \\\n      Version=\"1.14.6\"\nSHELL [\"/bin/bash\", \"-o\", \"pipefail\", \"-c\"]\nENV TINI_VERSION=\"0.18.0\"\n#   Do not split this into multiple RUN!\n#   Docker creates a layer for every RUN-Statement\n#   therefore an 'apt-get purge' has no effect\nADD https://github.com/jemalloc/jemalloc/releases/download/4.5.0/jemalloc-4.5.0.tar.bz2 /tmp/jemalloc-4.5.0.tar.bz2\nRUN apt-get update \\\n && apt-get install ca-certificates -y \\\n && buildDeps=\" make gcc g++ libc6-dev wget bzip2 gnupg dirmngr \" \\\n && apt-get install make gcc g++ libc6-dev wget bzip2 gnupg dirmngr -y \\\n && echo 'gem: --no-document' >> /etc/gemrc \\\n && gem install oj \\\n && gem install json \\\n && gem install async-http \\\n && gem install ext_monitor \\\n && gem install fluentd \\\n && dpkgArch=\"$( dpkg --print-architecture | awk -F- '{ print $NF }' ;)\" \\\n && wget -nv -O /usr/local/bin/tini \"https://github.com/krallin/tini/releases/download/v$TINI_VERSION/tini-$dpkgArch\" \\\n && wget -nv -O /usr/local/bin/tini.asc \"https://github.com/krallin/tini/releases/download/v$TINI_VERSION/tini-$dpkgArch.asc\" \\\n && export GNUPGHOME=\"$( mktemp -d ;)\" \\\n && gpg --batch --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys 6380DC428747F6C393FEACA59A84159D7001A4E5 \\\n && gpg --batch --verify /usr/local/bin/tini.asc /usr/local/bin/tini \\\n && rm -r /usr/local/bin/tini.asc \\\n && chmod +x /usr/local/bin/tini \\\n && tini -h \\\n && : \\\n && cd /tmp \\\n && tar -xjf jemalloc-4.5.0.tar.bz2 \\\n && cd jemalloc-4.5.0/ \\\n && ./configure \\\n && make \\\n && mv lib/libjemalloc.so.2 /usr/lib \\\n && apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false $buildDeps \\\n && rm -rf /var/lib/apt/lists/* \\\n && rm -rf /tmp/* /var/tmp/* /usr/lib/ruby/gems/*/cache/*.gem /usr/lib/ruby/gems/2.*/gems/fluentd-*/test\nRUN groupadd -r fluent \\\n && useradd -r -g fluent fluent \\\n && mkdir -p /fluentd/log \\\n && mkdir -p /fluentd/etc /fluentd/plugins \\\n && chown -R fluent /fluentd \\\n && chgrp -R fluent /fluentd\nADD fluent.conf /fluentd/etc/\nADD entrypoint.sh /bin/\nENV FLUENTD_CONF=\"fluent.conf\"\nENV LD_PRELOAD=\"/usr/lib/libjemalloc.so.2\"\nEXPOSE 24224/tcp 5140/tcp\nUSER fluent\nENTRYPOINT [\"tini\", \"--\", \"/bin/entrypoint.sh\"]\nHEALTHCHECK CMD curl --fail http://127.0.0.1:24224 || exit 1\nCMD [\"fluentd\"]\nENV GOOGLE_API_KEY=\"AIzanc8vIyjV4QqrTfi0FUbYnXW14iAQxvwAR1Z\" \\\n    GOOGLE_API_KEY=\"AIzau076nLIKA6KHb0FxJ6tQvxWs96fas2GJ3v6\" \\\n    CONSUMER_SECRET=\"dFg6gyrFvCiCqP6207lCT1-4/XuL0HQcNszKK96xpZC7vEBwuwC9\" \\\n    POSTGRES_PASSWORD=\"ZYBGBkyDHeZgNRsjXTb2O1NIzbjb5EpyVvXYQbLH\" \\\n    NPM_TOKEN=\"npm_crGCeq9YZctC0bJ-t5B1Iuge2dvPkLQ7nwHp\"\n","originalDockerfileUglifiedHash":"ddb8b5292b6064072c003aafc6fb04b2","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles/fluentd__v1.14.0-debian-1.0__8__injected.dockerfile"}