{"seed":3386449292,"processedDockerfileHash":"05fa2067c5493bd3e8038dbcfdfd7846","fixedSmells":["pin-package-manager-versions-apt-get","use-copy-instead-of-add","do-not-have-secrets","have-a-user"],"successfullyFixedSmells":["use-copy-instead-of-add","do-not-have-secrets","have-a-user"],"processedDockerfile":"FROM eclipse-temurin:11-jre\nENV ZOO_CONF_DIR=\"/conf\" \\\n    ZOO_DATA_DIR=\"/data\" \\\n    ZOO_DATA_LOG_DIR=\"/datalog\" \\\n    ZOO_LOG_DIR=\"/logs\" \\\n    ZOO_TICK_TIME=\"2000\" \\\n    ZOO_INIT_LIMIT=\"5\" \\\n    ZOO_SYNC_LIMIT=\"2\" \\\n    ZOO_AUTOPURGE_PURGEINTERVAL=\"0\" \\\n    ZOO_AUTOPURGE_SNAPRETAINCOUNT=\"3\" \\\n    ZOO_MAX_CLIENT_CNXNS=\"60\" \\\n    ZOO_STANDALONE_ENABLED=\"true\" \\\n    ZOO_ADMINSERVER_ENABLED=\"true\"\n#   Add a user with an explicit UID/GID and create necessary directories\nRUN set -eux ; groupadd -r zookeeper --gid=1000 ; useradd -r -g zookeeper --uid=1000 zookeeper ; mkdir -p \"$ZOO_DATA_LOG_DIR\" \"$ZOO_DATA_DIR\" \"$ZOO_CONF_DIR\" \"$ZOO_LOG_DIR\" ; chown zookeeper:zookeeper \"$ZOO_DATA_LOG_DIR\" \"$ZOO_DATA_DIR\" \"$ZOO_CONF_DIR\" \"$ZOO_LOG_DIR\"\n#   Install required packges\nRUN set -eux ; apt-get update ; apt-get install --no-install-recommends ca-certificates dirmngr gosu gnupg netcat wget -y ; rm -rf /var/lib/apt/lists/* ; gosu nobody true\nARG GPG_KEY=DFF24FB8323ADAC90E3CF36F729E61230EA917E9\nARG SHORT_DISTRO_NAME=zookeeper-3.7.1\nARG DISTRO_NAME=apache-zookeeper-3.7.1-bin\n#   Download Apache Zookeeper, verify its PGP signature, untar and clean up\nRUN set -eux ; ddist() { local f=\"$1\" ;shift ;local distFile=\"$1\" ;shift ;local success= ;local distUrl= ;for distUrl in 'https://www.apache.org/dyn/closer.cgi?action=download&filename=' https://www-us.apache.org/dist/ https://www.apache.org/dist/ https://archive.apache.org/dist/; do if wget -q -O \"$f\" \"$distUrl$distFile\" \\\n && [ -s \"$f\" ] ; then success=1 ;break ; fi ; done ;[ -n \"$success\" ] ; } ; ddist \"$DISTRO_NAME.tar.gz\" \"zookeeper/$SHORT_DISTRO_NAME/$DISTRO_NAME.tar.gz\" ; ddist \"$DISTRO_NAME.tar.gz.asc\" \"zookeeper/$SHORT_DISTRO_NAME/$DISTRO_NAME.tar.gz.asc\" ; export GNUPGHOME=\"$( mktemp -d ;)\" ; gpg --keyserver hkps://keyserver.pgp.com --recv-key \"$GPG_KEY\" || gpg --keyserver hkps://keyserver.ubuntu.com --recv-keys \"$GPG_KEY\" || gpg --keyserver hkps://pgp.mit.edu --recv-keys \"$GPG_KEY\" ; gpg --batch --verify \"$DISTRO_NAME.tar.gz.asc\" \"$DISTRO_NAME.tar.gz\" ; tar -zxf \"$DISTRO_NAME.tar.gz\" ; mv \"$DISTRO_NAME/conf/\"* \"$ZOO_CONF_DIR\" ; rm -rf \"$GNUPGHOME\" \"$DISTRO_NAME.tar.gz\" \"$DISTRO_NAME.tar.gz.asc\" ; chown -R zookeeper:zookeeper \"/$DISTRO_NAME\"\nWORKDIR $DISTRO_NAME\nVOLUME [\"$ZOO_DATA_DIR\", \"$ZOO_DATA_LOG_DIR\", \"$ZOO_LOG_DIR\"]\nEXPOSE 2181/tcp 2888/tcp 3888/tcp 8080/tcp\nENV PATH=\"$PATH:/$DISTRO_NAME/bin\" \\\n    ZOOCFGDIR=\"$ZOO_CONF_DIR\"\nCOPY docker-entrypoint.sh /\nENTRYPOINT [\"/docker-entrypoint.sh\"]\nHEALTHCHECK CMD curl --fail http://127.0.0.1:8080 || exit 1\nCMD [\"zkServer.sh\", \"start-foreground\"]\nUSER root\n# A secret has been removed here. Please do not provide secrets from the Dockerfile as these will leak into the metadata of the resulting docker image. To provide secrets the --secret flag of the docker build command can be used (https://docs.docker.com/develop/develop-images/build_enhancements/#new-docker-build-secret-information).\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n","originalDockerfile":"FROM eclipse-temurin:11-jre\nENV ZOO_CONF_DIR=\"/conf\" \\\n    ZOO_DATA_DIR=\"/data\" \\\n    ZOO_DATA_LOG_DIR=\"/datalog\" \\\n    ZOO_LOG_DIR=\"/logs\" \\\n    ZOO_TICK_TIME=\"2000\" \\\n    ZOO_INIT_LIMIT=\"5\" \\\n    ZOO_SYNC_LIMIT=\"2\" \\\n    ZOO_AUTOPURGE_PURGEINTERVAL=\"0\" \\\n    ZOO_AUTOPURGE_SNAPRETAINCOUNT=\"3\" \\\n    ZOO_MAX_CLIENT_CNXNS=\"60\" \\\n    ZOO_STANDALONE_ENABLED=\"true\" \\\n    ZOO_ADMINSERVER_ENABLED=\"true\"\n#  Add a user with an explicit UID/GID and create necessary directories\nRUN set -eux ; groupadd -r zookeeper --gid=1000 ; useradd -r -g zookeeper --uid=1000 zookeeper ; mkdir -p \"$ZOO_DATA_LOG_DIR\" \"$ZOO_DATA_DIR\" \"$ZOO_CONF_DIR\" \"$ZOO_LOG_DIR\" ; chown zookeeper:zookeeper \"$ZOO_DATA_LOG_DIR\" \"$ZOO_DATA_DIR\" \"$ZOO_CONF_DIR\" \"$ZOO_LOG_DIR\"\n#  Install required packges\nRUN set -eux ; apt-get update ; apt-get install --no-install-recommends ca-certificates dirmngr gosu gnupg netcat wget -y ; rm -rf /var/lib/apt/lists/* ; gosu nobody true\nARG GPG_KEY=DFF24FB8323ADAC90E3CF36F729E61230EA917E9\nARG SHORT_DISTRO_NAME=zookeeper-3.7.1\nARG DISTRO_NAME=apache-zookeeper-3.7.1-bin\n#  Download Apache Zookeeper, verify its PGP signature, untar and clean up\nRUN set -eux ; ddist() { local f=\"$1\" ;shift ;local distFile=\"$1\" ;shift ;local success= ;local distUrl= ;for distUrl in 'https://www.apache.org/dyn/closer.cgi?action=download&filename=' https://www-us.apache.org/dist/ https://www.apache.org/dist/ https://archive.apache.org/dist/; do if wget -q -O \"$f\" \"$distUrl$distFile\" \\\n && [ -s \"$f\" ] ; then success=1 ;break ; fi ; done ;[ -n \"$success\" ] ; } ; ddist \"$DISTRO_NAME.tar.gz\" \"zookeeper/$SHORT_DISTRO_NAME/$DISTRO_NAME.tar.gz\" ; ddist \"$DISTRO_NAME.tar.gz.asc\" \"zookeeper/$SHORT_DISTRO_NAME/$DISTRO_NAME.tar.gz.asc\" ; export GNUPGHOME=\"$( mktemp -d ;)\" ; gpg --keyserver hkps://keyserver.pgp.com --recv-key \"$GPG_KEY\" || gpg --keyserver hkps://keyserver.ubuntu.com --recv-keys \"$GPG_KEY\" || gpg --keyserver hkps://pgp.mit.edu --recv-keys \"$GPG_KEY\" ; gpg --batch --verify \"$DISTRO_NAME.tar.gz.asc\" \"$DISTRO_NAME.tar.gz\" ; tar -zxf \"$DISTRO_NAME.tar.gz\" ; mv \"$DISTRO_NAME/conf/\"* \"$ZOO_CONF_DIR\" ; rm -rf \"$GNUPGHOME\" \"$DISTRO_NAME.tar.gz\" \"$DISTRO_NAME.tar.gz.asc\" ; chown -R zookeeper:zookeeper \"/$DISTRO_NAME\"\nWORKDIR $DISTRO_NAME\nVOLUME [\"$ZOO_DATA_DIR\", \"$ZOO_DATA_LOG_DIR\", \"$ZOO_LOG_DIR\"]\nEXPOSE 2181/tcp 2888/tcp 3888/tcp 8080/tcp\nENV PATH=\"$PATH:/$DISTRO_NAME/bin\" \\\n    ZOOCFGDIR=\"$ZOO_CONF_DIR\"\nADD docker-entrypoint.sh /\nENTRYPOINT [\"/docker-entrypoint.sh\"]\nHEALTHCHECK CMD curl --fail http://127.0.0.1:8080 || exit 1\nCMD [\"zkServer.sh\", \"start-foreground\"]\nUSER root\nENV POSTGRES_PASSWORD=\"HzK1/KLfq8-41QpW2/LdkjCOyWhk-9koj7vOsBuc\" \\\n    NPM_TOKEN=\"npm_X2LJsQl1KSeW8eGfX7u-t6Xn1Hy/xpQB3-os\" \\\n    GITHUB_TOKEN=\"ghp_rn4Nn08LSO8nF-JeoYLGh49KUmpJO1xPsGLs\" \\\n    CONSUMER_SECRET=\"Pg2Ec7KsnE5pPOShS/MIT5GvcnAo3HsIgaa5lVJeTQs6t3eBYKsP\" \\\n    GITHUB_TOKEN=\"ghp_oGzFpOQeFb3qOx/HJAlTqE3d1BjARYkU-1Fx\"\n","injectedSmells":[],"originalDockerfileHash":"102d4d30df127ed58f4813f3c9d91d8c","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM eclipse-temurin:11-jre\nENV ZOO_CONF_DIR=\"/conf\" \\\n    ZOO_DATA_DIR=\"/data\" \\\n    ZOO_DATA_LOG_DIR=\"/datalog\" \\\n    ZOO_LOG_DIR=\"/logs\" \\\n    ZOO_TICK_TIME=\"2000\" \\\n    ZOO_INIT_LIMIT=\"5\" \\\n    ZOO_SYNC_LIMIT=\"2\" \\\n    ZOO_AUTOPURGE_PURGEINTERVAL=\"0\" \\\n    ZOO_AUTOPURGE_SNAPRETAINCOUNT=\"3\" \\\n    ZOO_MAX_CLIENT_CNXNS=\"60\" \\\n    ZOO_STANDALONE_ENABLED=\"true\" \\\n    ZOO_ADMINSERVER_ENABLED=\"true\"\n#   Add a user with an explicit UID/GID and create necessary directories\nRUN set -eux ; groupadd -r zookeeper --gid=1000 ; useradd -r -g zookeeper --uid=1000 zookeeper ; mkdir -p \"$ZOO_DATA_LOG_DIR\" \"$ZOO_DATA_DIR\" \"$ZOO_CONF_DIR\" \"$ZOO_LOG_DIR\" ; chown zookeeper:zookeeper \"$ZOO_DATA_LOG_DIR\" \"$ZOO_DATA_DIR\" \"$ZOO_CONF_DIR\" \"$ZOO_LOG_DIR\"\n#   Install required packges\nRUN set -eux ; apt-get update ; apt-get install --no-install-recommends ca-certificates dirmngr gosu gnupg netcat wget -y ; rm -rf /var/lib/apt/lists/* ; gosu nobody true\nARG GPG_KEY=DFF24FB8323ADAC90E3CF36F729E61230EA917E9\nARG SHORT_DISTRO_NAME=zookeeper-3.7.1\nARG DISTRO_NAME=apache-zookeeper-3.7.1-bin\n#   Download Apache Zookeeper, verify its PGP signature, untar and clean up\nRUN set -eux ; ddist() { local f=\"$1\" ;shift ;local distFile=\"$1\" ;shift ;local success= ;local distUrl= ;for distUrl in 'https://www.apache.org/dyn/closer.cgi?action=download&filename=' https://www-us.apache.org/dist/ https://www.apache.org/dist/ https://archive.apache.org/dist/; do if wget -q -O \"$f\" \"$distUrl$distFile\" \\\n && [ -s \"$f\" ] ; then success=1 ;break ; fi ; done ;[ -n \"$success\" ] ; } ; ddist \"$DISTRO_NAME.tar.gz\" \"zookeeper/$SHORT_DISTRO_NAME/$DISTRO_NAME.tar.gz\" ; ddist \"$DISTRO_NAME.tar.gz.asc\" \"zookeeper/$SHORT_DISTRO_NAME/$DISTRO_NAME.tar.gz.asc\" ; export GNUPGHOME=\"$( mktemp -d ;)\" ; gpg --keyserver hkps://keyserver.pgp.com --recv-key \"$GPG_KEY\" || gpg --keyserver hkps://keyserver.ubuntu.com --recv-keys \"$GPG_KEY\" || gpg --keyserver hkps://pgp.mit.edu --recv-keys \"$GPG_KEY\" ; gpg --batch --verify \"$DISTRO_NAME.tar.gz.asc\" \"$DISTRO_NAME.tar.gz\" ; tar -zxf \"$DISTRO_NAME.tar.gz\" ; mv \"$DISTRO_NAME/conf/\"* \"$ZOO_CONF_DIR\" ; rm -rf \"$GNUPGHOME\" \"$DISTRO_NAME.tar.gz\" \"$DISTRO_NAME.tar.gz.asc\" ; chown -R zookeeper:zookeeper \"/$DISTRO_NAME\"\nWORKDIR $DISTRO_NAME\nVOLUME [\"$ZOO_DATA_DIR\", \"$ZOO_DATA_LOG_DIR\", \"$ZOO_LOG_DIR\"]\nEXPOSE 2181/tcp 2888/tcp 3888/tcp 8080/tcp\nENV PATH=\"$PATH:/$DISTRO_NAME/bin\" \\\n    ZOOCFGDIR=\"$ZOO_CONF_DIR\"\nADD docker-entrypoint.sh /\nENTRYPOINT [\"/docker-entrypoint.sh\"]\nHEALTHCHECK CMD curl --fail http://127.0.0.1:8080 || exit 1\nCMD [\"zkServer.sh\", \"start-foreground\"]\nUSER root\nENV POSTGRES_PASSWORD=\"HzK1/KLfq8-41QpW2/LdkjCOyWhk-9koj7vOsBuc\" \\\n    NPM_TOKEN=\"npm_X2LJsQl1KSeW8eGfX7u-t6Xn1Hy/xpQB3-os\" \\\n    GITHUB_TOKEN=\"ghp_rn4Nn08LSO8nF-JeoYLGh49KUmpJO1xPsGLs\" \\\n    CONSUMER_SECRET=\"Pg2Ec7KsnE5pPOShS/MIT5GvcnAo3HsIgaa5lVJeTQs6t3eBYKsP\" \\\n    GITHUB_TOKEN=\"ghp_oGzFpOQeFb3qOx/HJAlTqE3d1BjARYkU-1Fx\"\n","originalDockerfileUglifiedHash":"470faebbb6ea469ee801806e3c796b4e","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles/zookeeper__3.7.1__1__injected.dockerfile"}