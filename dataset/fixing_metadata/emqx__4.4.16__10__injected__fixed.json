{"seed":570330463,"processedDockerfileHash":"37d176ccda8a4466ad58a9853f6993a1","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","use-copy-instead-of-add","do-not-have-secrets","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","use-copy-instead-of-add","do-not-have-secrets","have-a-user"],"processedDockerfile":"FROM debian:11-slim\nSHELL [\"/bin/bash\", \"-o\", \"pipefail\", \"-c\"]\nRUN :\nRUN set -eu ; : ; (apt-get update ;apt-get install --no-install-recommends curl=7.74.0-1.3+deb11u7 unzip=6.0-26+deb11u1 ca-certificates=20210119 -y ) ; rm -rf /var/lib/apt/lists/*\nRUN set -eu ; groupadd -r -g 1000 emqx ; useradd -r -m -u 1000 -g emqx emqx\nENV EMQX_VERSION=\"4.4.16\"\nENV OTP=\"otp24.3.4.2-1\"\nRUN set -eu ; arch=$( dpkg --print-architecture ;) ; if [ ${arch} = \"amd64\" ] ; then sha256=\"901b76ea2bee68729b75280740ca31b1af5b358d331422d1653dc342ee830324\" ; fi ; if [ ${arch} = \"arm64\" ] ; then sha256=\"1224f53d0ee98390c286f3bbd9af2f294c2fa4ccb79342343d803fa234165c6e\" ; fi ; ID=\"$( sed -n '/^ID=/p' /etc/os-release | sed -r 's/ID=(.*)/\\1/g' | sed 's/\\\"//g' ;)\" ; VERSION_ID=\"$( sed -n '/^VERSION_ID=/p' /etc/os-release | sed -r 's/VERSION_ID=(.*)/\\1/g' | sed 's/\\\"//g' ;)\" ; pkg=\"emqx-${EMQX_VERSION}-${OTP}-${ID}${VERSION_ID}-${arch}.zip\" ; curl -f -O -L https://www.emqx.com/en/downloads/broker/${EMQX_VERSION}/${pkg} ; echo \"$sha256 *$pkg\" | sha256sum -c || exit 1 ; unzip -q -d /opt $pkg ; chgrp -Rf emqx /opt/emqx ; chmod -Rf g+w /opt/emqx ; chown -Rf emqx /opt/emqx ; ln -s /opt/emqx/bin/* /usr/local/bin/ ; rm -rf $pkg\nWORKDIR /opt/emqx\nUSER emqx\nVOLUME [\"/opt/emqx/log\", \"/opt/emqx/data\"]\n#   emqx will occupy these port:\n#   - 1883 port for MQTT\n#   - 8081 for mgmt API\n#   - 8083 for WebSocket/HTTP\n#   - 8084 for WSS/HTTPS\n#   - 8883 port for MQTT(SSL)\n#   - 11883 port for internal MQTT/TCP\n#   - 18083 for dashboard\n#   - 4369 epmd (Erlang-distrbution port mapper daemon) listener (deprecated)\n#   - 4370 default Erlang distrbution port\n#   - 5369 for gen_rpc port mapping\n#   - 6369 6370 for distributed node\nEXPOSE 1883/tcp 8081/tcp 8083/tcp 8084/tcp 8883/tcp 11883/tcp 18083/tcp 4369/tcp 4370/tcp 5369/tcp 6369/tcp 6370/tcp\nCOPY docker-entrypoint.sh /usr/bin/\nENTRYPOINT [\"/usr/bin/docker-entrypoint.sh\"]\nHEALTHCHECK CMD curl --fail http://127.0.0.1:8081 || exit 1\nCMD [\"emqx\", \"foreground\"]\nUSER 0\n# A secret has been removed here. Please do not provide secrets from the Dockerfile as these will leak into the metadata of the resulting docker image. To provide secrets the --secret flag of the docker build command can be used (https://docs.docker.com/develop/develop-images/build_enhancements/#new-docker-build-secret-information).\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n","originalDockerfile":"FROM debian:11-slim\nSHELL [\"/bin/bash\", \"-o\", \"pipefail\", \"-c\"]\nRUN apt-get update\nRUN set -eu ; : ; apt-get install curl=7.74.0-1.3+deb11u7 unzip=6.0-26+deb11u1 ca-certificates=20210119 -y ; rm -rf /var/lib/apt/lists/*\nRUN set -eu ; groupadd -r -g 1000 emqx ; useradd -r -m -u 1000 -g emqx emqx\nENV EMQX_VERSION=\"4.4.16\"\nENV OTP=\"otp24.3.4.2-1\"\nRUN set -eu ; arch=$( dpkg --print-architecture ;) ; if [ ${arch} = \"amd64\" ] ; then sha256=\"901b76ea2bee68729b75280740ca31b1af5b358d331422d1653dc342ee830324\" ; fi ; if [ ${arch} = \"arm64\" ] ; then sha256=\"1224f53d0ee98390c286f3bbd9af2f294c2fa4ccb79342343d803fa234165c6e\" ; fi ; ID=\"$( sed -n '/^ID=/p' /etc/os-release | sed -r 's/ID=(.*)/\\1/g' | sed 's/\\\"//g' ;)\" ; VERSION_ID=\"$( sed -n '/^VERSION_ID=/p' /etc/os-release | sed -r 's/VERSION_ID=(.*)/\\1/g' | sed 's/\\\"//g' ;)\" ; pkg=\"emqx-${EMQX_VERSION}-${OTP}-${ID}${VERSION_ID}-${arch}.zip\" ; curl -f -O -L https://www.emqx.com/en/downloads/broker/${EMQX_VERSION}/${pkg} ; echo \"$sha256 *$pkg\" | sha256sum -c || exit 1 ; unzip -q -d /opt $pkg ; chgrp -Rf emqx /opt/emqx ; chmod -Rf g+w /opt/emqx ; chown -Rf emqx /opt/emqx ; ln -s /opt/emqx/bin/* /usr/local/bin/ ; rm -rf $pkg\nWORKDIR /opt/emqx\nUSER emqx\nVOLUME [\"/opt/emqx/log\", \"/opt/emqx/data\"]\n#  emqx will occupy these port:\n#  - 1883 port for MQTT\n#  - 8081 for mgmt API\n#  - 8083 for WebSocket/HTTP\n#  - 8084 for WSS/HTTPS\n#  - 8883 port for MQTT(SSL)\n#  - 11883 port for internal MQTT/TCP\n#  - 18083 for dashboard\n#  - 4369 epmd (Erlang-distrbution port mapper daemon) listener (deprecated)\n#  - 4370 default Erlang distrbution port\n#  - 5369 for gen_rpc port mapping\n#  - 6369 6370 for distributed node\nEXPOSE 1883/tcp 8081/tcp 8083/tcp 8084/tcp 8883/tcp 11883/tcp 18083/tcp 4369/tcp 4370/tcp 5369/tcp 6369/tcp 6370/tcp\nADD docker-entrypoint.sh /usr/bin/\nENTRYPOINT [\"/usr/bin/docker-entrypoint.sh\"]\nHEALTHCHECK CMD curl --fail http://127.0.0.1:8081 || exit 1\nCMD [\"emqx\", \"foreground\"]\nUSER 0\nENV GOOGLE_API_KEY=\"AIza9PsfEKY6EQ5itrbtk2xC719gi3JVCMHnZ8o\" \\\n    GOOGLE_API_KEY=\"AIzax5qkQxWrDds6UP8gngNwju5voQ5VznSVZXL\" \\\n    SLACK_TOKEN=\"xoxb-043251255464-tyfdxhVtK2sSObFl0Y/YUw0I\"\n","injectedSmells":[],"originalDockerfileHash":"d52bed59debde495d90f153e21fe8d5f","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM debian:11-slim\nSHELL [\"/bin/bash\", \"-o\", \"pipefail\", \"-c\"]\nRUN apt-get update\nRUN set -eu ; : ; apt-get install curl=7.74.0-1.3+deb11u7 unzip=6.0-26+deb11u1 ca-certificates=20210119 -y ; rm -rf /var/lib/apt/lists/*\nRUN set -eu ; groupadd -r -g 1000 emqx ; useradd -r -m -u 1000 -g emqx emqx\nENV EMQX_VERSION=\"4.4.16\"\nENV OTP=\"otp24.3.4.2-1\"\nRUN set -eu ; arch=$( dpkg --print-architecture ;) ; if [ ${arch} = \"amd64\" ] ; then sha256=\"901b76ea2bee68729b75280740ca31b1af5b358d331422d1653dc342ee830324\" ; fi ; if [ ${arch} = \"arm64\" ] ; then sha256=\"1224f53d0ee98390c286f3bbd9af2f294c2fa4ccb79342343d803fa234165c6e\" ; fi ; ID=\"$( sed -n '/^ID=/p' /etc/os-release | sed -r 's/ID=(.*)/\\1/g' | sed 's/\\\"//g' ;)\" ; VERSION_ID=\"$( sed -n '/^VERSION_ID=/p' /etc/os-release | sed -r 's/VERSION_ID=(.*)/\\1/g' | sed 's/\\\"//g' ;)\" ; pkg=\"emqx-${EMQX_VERSION}-${OTP}-${ID}${VERSION_ID}-${arch}.zip\" ; curl -f -O -L https://www.emqx.com/en/downloads/broker/${EMQX_VERSION}/${pkg} ; echo \"$sha256 *$pkg\" | sha256sum -c || exit 1 ; unzip -q -d /opt $pkg ; chgrp -Rf emqx /opt/emqx ; chmod -Rf g+w /opt/emqx ; chown -Rf emqx /opt/emqx ; ln -s /opt/emqx/bin/* /usr/local/bin/ ; rm -rf $pkg\nWORKDIR /opt/emqx\nUSER emqx\nVOLUME [\"/opt/emqx/log\", \"/opt/emqx/data\"]\n#   emqx will occupy these port:\n#   - 1883 port for MQTT\n#   - 8081 for mgmt API\n#   - 8083 for WebSocket/HTTP\n#   - 8084 for WSS/HTTPS\n#   - 8883 port for MQTT(SSL)\n#   - 11883 port for internal MQTT/TCP\n#   - 18083 for dashboard\n#   - 4369 epmd (Erlang-distrbution port mapper daemon) listener (deprecated)\n#   - 4370 default Erlang distrbution port\n#   - 5369 for gen_rpc port mapping\n#   - 6369 6370 for distributed node\nEXPOSE 1883/tcp 8081/tcp 8083/tcp 8084/tcp 8883/tcp 11883/tcp 18083/tcp 4369/tcp 4370/tcp 5369/tcp 6369/tcp 6370/tcp\nADD docker-entrypoint.sh /usr/bin/\nENTRYPOINT [\"/usr/bin/docker-entrypoint.sh\"]\nHEALTHCHECK CMD curl --fail http://127.0.0.1:8081 || exit 1\nCMD [\"emqx\", \"foreground\"]\nUSER 0\nENV GOOGLE_API_KEY=\"AIza9PsfEKY6EQ5itrbtk2xC719gi3JVCMHnZ8o\" \\\n    GOOGLE_API_KEY=\"AIzax5qkQxWrDds6UP8gngNwju5voQ5VznSVZXL\" \\\n    SLACK_TOKEN=\"xoxb-043251255464-tyfdxhVtK2sSObFl0Y/YUw0I\"\n","originalDockerfileUglifiedHash":"930aa4a1f015c3e9fd1f2f1417436de2","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles/emqx__4.4.16__10__injected.dockerfile"}