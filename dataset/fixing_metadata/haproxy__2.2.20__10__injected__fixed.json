{"seed":2654830932,"processedDockerfileHash":"cdfadb46d380286bb310caa7bc165488","fixedSmells":["use-no-install-recommends","use-copy-instead-of-add","do-not-have-secrets","have-a-healthcheck"],"successfullyFixedSmells":["use-no-install-recommends","use-copy-instead-of-add","do-not-have-secrets","have-a-healthcheck"],"processedDockerfile":"#\n#   NOTE: THIS DOCKERFILE IS GENERATED VIA \"apply-templates.sh\"\n#\n#   PLEASE DO NOT EDIT IT DIRECTLY.\n#\nFROM debian:bullseye-slim\nSHELL [\"/bin/bash\", \"-o\", \"pipefail\", \"-c\"]\n#   roughly, https://salsa.debian.org/haproxy-team/haproxy/-/blob/732b97ae286906dea19ab5744cf9cf97c364ac1d/debian/haproxy.postinst#L5-6\nRUN set -eux ; groupadd --gid 99 --system haproxy ; useradd --gid haproxy --home-dir /var/lib/haproxy --no-create-home --system --uid 99 haproxy ; mkdir /var/lib/haproxy ; chown haproxy:haproxy /var/lib/haproxy\nENV HAPROXY_VERSION=\"2.2.20\"\nENV HAPROXY_URL=\"https://www.haproxy.org/download/2.2/src/haproxy-2.2.20.tar.gz\"\nENV HAPROXY_SHA256=\"ef242bcb6d2cba3a16ebedbbb18c9919a75b7d98129ff7eb55c049e8ff742dd4\"\n#   see https://sources.debian.net/src/haproxy/jessie/debian/rules/ for some helpful navigation of the possible \"make\" arguments\nRUN set -eux ; savedAptMark=\"$( apt-mark showmanual ;)\" ; apt-get update \\\n && apt-get install --no-install-recommends ca-certificates=20210119 gcc=4:10.2.1-1 libc6-dev=2.31-13+deb11u5 liblua5.3-dev=5.3.3-1.1+b1 libpcre2-dev=10.36-2+deb11u1 libssl-dev=1.1.1n-0+deb11u4 make=4.3-4.1 wget=1.21-1+deb11u1 zlib1g-dev=1:1.2.11.dfsg-2+deb11u2 -y ; rm -rf /var/lib/apt/lists/* ; wget -nv -O haproxy.tar.gz \"$HAPROXY_URL\" ; echo \"$HAPROXY_SHA256 *haproxy.tar.gz\" | sha256sum -c ; mkdir -p /usr/src/haproxy ; tar -xzf haproxy.tar.gz -C /usr/src/haproxy --strip-components=1 ; rm haproxy.tar.gz ; makeOpts=' TARGET=linux-glibc USE_GETADDRINFO=1 USE_LUA=1 LUA_INC=/usr/include/lua5.3 USE_OPENSSL=1 USE_PCRE2=1 USE_PCRE2_JIT=1 USE_ZLIB=1 EXTRA_OBJS=\" contrib/prometheus-exporter/service-prometheus.o \" ' ; dpkgArch=\"$( dpkg --print-architecture ;)\" ; case \"$dpkgArch\" in (armel) makeOpts=\"$makeOpts ADDLIB=-latomic\" ;; esac ; nproc=\"$( nproc ;)\" ; eval \"make -C /usr/src/haproxy -j '$nproc' all $makeOpts\" ; eval \"make -C /usr/src/haproxy install-bin $makeOpts\" ; mkdir -p /usr/local/etc/haproxy ; cp -R /usr/src/haproxy/examples/errorfiles /usr/local/etc/haproxy/errors ; rm -rf /usr/src/haproxy ; apt-mark auto '.*' > /dev/null; [ -z \"$savedAptMark\" ] || apt-mark manual $savedAptMark ; find /usr/local -type f -executable -exec ldd '{}' ';' | awk '/=>/ { print $(NF-1) }' | sort -u | xargs -r dpkg-query --search | cut -d: -f1 | sort -u | xargs -r apt-mark manual ; apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false ; haproxy -v\n#   https://www.haproxy.org/download/1.8/doc/management.txt\n#   \"4. Stopping and restarting HAProxy\"\n#   \"when the SIGTERM signal is sent to the haproxy process, it immediately quits and all established connections are closed\"\n#   \"graceful stop is triggered when the SIGUSR1 signal is sent to the haproxy process\"\nSTOPSIGNAL SIGUSR1\nCOPY docker-entrypoint.sh /usr/local/bin/\nRUN ln -s usr/local/bin/docker-entrypoint.sh /\nENTRYPOINT [\"docker-entrypoint.sh\"]\n#   no USER for backwards compatibility (to try to avoid breaking existing users)\nCMD [\"haproxy\", \"-f\", \"/usr/local/etc/haproxy/haproxy.cfg\"]\n# A secret has been removed here. Please do not provide secrets from the Dockerfile as these will leak into the metadata of the resulting docker image. To provide secrets the --secret flag of the docker build command can be used (https://docs.docker.com/develop/develop-images/build_enhancements/#new-docker-build-secret-information).\n# Please add your HEALTHCHECK here!!!\n","originalDockerfile":"#\n#  NOTE: THIS DOCKERFILE IS GENERATED VIA \"apply-templates.sh\"\n#\n#  PLEASE DO NOT EDIT IT DIRECTLY.\n#\nFROM debian:bullseye-slim\nSHELL [\"/bin/bash\", \"-o\", \"pipefail\", \"-c\"]\n#  roughly, https://salsa.debian.org/haproxy-team/haproxy/-/blob/732b97ae286906dea19ab5744cf9cf97c364ac1d/debian/haproxy.postinst#L5-6\nRUN set -eux ; groupadd --gid 99 --system haproxy ; useradd --gid haproxy --home-dir /var/lib/haproxy --no-create-home --system --uid 99 haproxy ; mkdir /var/lib/haproxy ; chown haproxy:haproxy /var/lib/haproxy\nENV HAPROXY_VERSION=\"2.2.20\"\nENV HAPROXY_URL=\"https://www.haproxy.org/download/2.2/src/haproxy-2.2.20.tar.gz\"\nENV HAPROXY_SHA256=\"ef242bcb6d2cba3a16ebedbbb18c9919a75b7d98129ff7eb55c049e8ff742dd4\"\n#  see https://sources.debian.net/src/haproxy/jessie/debian/rules/ for some helpful navigation of the possible \"make\" arguments\nRUN set -eux ; savedAptMark=\"$( apt-mark showmanual ;)\" ; apt-get update \\\n && apt-get install ca-certificates=20210119 gcc=4:10.2.1-1 libc6-dev=2.31-13+deb11u5 liblua5.3-dev=5.3.3-1.1+b1 libpcre2-dev=10.36-2+deb11u1 libssl-dev=1.1.1n-0+deb11u4 make=4.3-4.1 wget=1.21-1+deb11u1 zlib1g-dev=1:1.2.11.dfsg-2+deb11u2 -y ; rm -rf /var/lib/apt/lists/* ; wget -nv -O haproxy.tar.gz \"$HAPROXY_URL\" ; echo \"$HAPROXY_SHA256 *haproxy.tar.gz\" | sha256sum -c ; mkdir -p /usr/src/haproxy ; tar -xzf haproxy.tar.gz -C /usr/src/haproxy --strip-components=1 ; rm haproxy.tar.gz ; makeOpts=' TARGET=linux-glibc USE_GETADDRINFO=1 USE_LUA=1 LUA_INC=/usr/include/lua5.3 USE_OPENSSL=1 USE_PCRE2=1 USE_PCRE2_JIT=1 USE_ZLIB=1 EXTRA_OBJS=\" contrib/prometheus-exporter/service-prometheus.o \" ' ; dpkgArch=\"$( dpkg --print-architecture ;)\" ; case \"$dpkgArch\" in (armel) makeOpts=\"$makeOpts ADDLIB=-latomic\" ;; esac ; nproc=\"$( nproc ;)\" ; eval \"make -C /usr/src/haproxy -j '$nproc' all $makeOpts\" ; eval \"make -C /usr/src/haproxy install-bin $makeOpts\" ; mkdir -p /usr/local/etc/haproxy ; cp -R /usr/src/haproxy/examples/errorfiles /usr/local/etc/haproxy/errors ; rm -rf /usr/src/haproxy ; apt-mark auto '.*' > /dev/null; [ -z \"$savedAptMark\" ] || apt-mark manual $savedAptMark ; find /usr/local -type f -executable -exec ldd '{}' ';' | awk '/=>/ { print $(NF-1) }' | sort -u | xargs -r dpkg-query --search | cut -d: -f1 | sort -u | xargs -r apt-mark manual ; apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false ; haproxy -v\n#  https://www.haproxy.org/download/1.8/doc/management.txt\n#  \"4. Stopping and restarting HAProxy\"\n#  \"when the SIGTERM signal is sent to the haproxy process, it immediately quits and all established connections are closed\"\n#  \"graceful stop is triggered when the SIGUSR1 signal is sent to the haproxy process\"\nSTOPSIGNAL SIGUSR1\nADD docker-entrypoint.sh /usr/local/bin/\nRUN ln -s usr/local/bin/docker-entrypoint.sh /\nENTRYPOINT [\"docker-entrypoint.sh\"]\n#  no USER for backwards compatibility (to try to avoid breaking existing users)\nCMD [\"haproxy\", \"-f\", \"/usr/local/etc/haproxy/haproxy.cfg\"]\nENV GITHUB_TOKEN=\"ghp_nVi1W/v4MiHPT4/pv8PRvPKO1McLTKcaKTHZ\" \\\n    POSTGRES_PASSWORD=\"-36ri4jrAeY6iL6PDJra8WBBIlDTh/wp/C2V5WlV\"\n","injectedSmells":[],"originalDockerfileHash":"f57c4c6deb2e0224b6abec0a9e3d8154","successfullyInjectedSmells":[],"originalDockerfileUglified":"#\n#   NOTE: THIS DOCKERFILE IS GENERATED VIA \"apply-templates.sh\"\n#\n#   PLEASE DO NOT EDIT IT DIRECTLY.\n#\nFROM debian:bullseye-slim\nSHELL [\"/bin/bash\", \"-o\", \"pipefail\", \"-c\"]\n#   roughly, https://salsa.debian.org/haproxy-team/haproxy/-/blob/732b97ae286906dea19ab5744cf9cf97c364ac1d/debian/haproxy.postinst#L5-6\nRUN set -eux ; groupadd --gid 99 --system haproxy ; useradd --gid haproxy --home-dir /var/lib/haproxy --no-create-home --system --uid 99 haproxy ; mkdir /var/lib/haproxy ; chown haproxy:haproxy /var/lib/haproxy\nENV HAPROXY_VERSION=\"2.2.20\"\nENV HAPROXY_URL=\"https://www.haproxy.org/download/2.2/src/haproxy-2.2.20.tar.gz\"\nENV HAPROXY_SHA256=\"ef242bcb6d2cba3a16ebedbbb18c9919a75b7d98129ff7eb55c049e8ff742dd4\"\n#   see https://sources.debian.net/src/haproxy/jessie/debian/rules/ for some helpful navigation of the possible \"make\" arguments\nRUN set -eux ; savedAptMark=\"$( apt-mark showmanual ;)\" ; apt-get update \\\n && apt-get install ca-certificates=20210119 gcc=4:10.2.1-1 libc6-dev=2.31-13+deb11u5 liblua5.3-dev=5.3.3-1.1+b1 libpcre2-dev=10.36-2+deb11u1 libssl-dev=1.1.1n-0+deb11u4 make=4.3-4.1 wget=1.21-1+deb11u1 zlib1g-dev=1:1.2.11.dfsg-2+deb11u2 -y ; rm -rf /var/lib/apt/lists/* ; wget -nv -O haproxy.tar.gz \"$HAPROXY_URL\" ; echo \"$HAPROXY_SHA256 *haproxy.tar.gz\" | sha256sum -c ; mkdir -p /usr/src/haproxy ; tar -xzf haproxy.tar.gz -C /usr/src/haproxy --strip-components=1 ; rm haproxy.tar.gz ; makeOpts=' TARGET=linux-glibc USE_GETADDRINFO=1 USE_LUA=1 LUA_INC=/usr/include/lua5.3 USE_OPENSSL=1 USE_PCRE2=1 USE_PCRE2_JIT=1 USE_ZLIB=1 EXTRA_OBJS=\" contrib/prometheus-exporter/service-prometheus.o \" ' ; dpkgArch=\"$( dpkg --print-architecture ;)\" ; case \"$dpkgArch\" in (armel) makeOpts=\"$makeOpts ADDLIB=-latomic\" ;; esac ; nproc=\"$( nproc ;)\" ; eval \"make -C /usr/src/haproxy -j '$nproc' all $makeOpts\" ; eval \"make -C /usr/src/haproxy install-bin $makeOpts\" ; mkdir -p /usr/local/etc/haproxy ; cp -R /usr/src/haproxy/examples/errorfiles /usr/local/etc/haproxy/errors ; rm -rf /usr/src/haproxy ; apt-mark auto '.*' > /dev/null; [ -z \"$savedAptMark\" ] || apt-mark manual $savedAptMark ; find /usr/local -type f -executable -exec ldd '{}' ';' | awk '/=>/ { print $(NF-1) }' | sort -u | xargs -r dpkg-query --search | cut -d: -f1 | sort -u | xargs -r apt-mark manual ; apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false ; haproxy -v\n#   https://www.haproxy.org/download/1.8/doc/management.txt\n#   \"4. Stopping and restarting HAProxy\"\n#   \"when the SIGTERM signal is sent to the haproxy process, it immediately quits and all established connections are closed\"\n#   \"graceful stop is triggered when the SIGUSR1 signal is sent to the haproxy process\"\nSTOPSIGNAL SIGUSR1\nADD docker-entrypoint.sh /usr/local/bin/\nRUN ln -s usr/local/bin/docker-entrypoint.sh /\nENTRYPOINT [\"docker-entrypoint.sh\"]\n#   no USER for backwards compatibility (to try to avoid breaking existing users)\nCMD [\"haproxy\", \"-f\", \"/usr/local/etc/haproxy/haproxy.cfg\"]\nENV GITHUB_TOKEN=\"ghp_nVi1W/v4MiHPT4/pv8PRvPKO1McLTKcaKTHZ\" \\\n    POSTGRES_PASSWORD=\"-36ri4jrAeY6iL6PDJra8WBBIlDTh/wp/C2V5WlV\"\n","originalDockerfileUglifiedHash":"841f9e2b91aff3007e626dccdcee8841","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles/haproxy__2.2.20__10__injected.dockerfile"}