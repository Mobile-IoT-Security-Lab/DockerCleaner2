{"seed":1306453510,"processedDockerfileHash":"ad0907fe5c852759e7394e7debb24040","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","do-not-have-secrets","have-a-user"],"successfullyFixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","do-not-have-secrets","have-a-user"],"processedDockerfile":"FROM debian:bullseye-slim\nENV VARNISH_SIZE=\"100M\"\nSHELL [\"/bin/bash\", \"-o\", \"pipefail\", \"-c\"]\nRUN :\nRUN set -e ; BASE_PKGS=\"curl dpkg-dev debhelper devscripts equivs git pkg-config apt-utils fakeroot\" ; export DEBIAN_FRONTEND=noninteractive ; export DEBCONF_NONINTERACTIVE_SEEN=true ; tmpdir=\"$( mktemp -d ;)\" ; cd \"$tmpdir\" ; : ; (apt-get update ;apt-get install --no-install-recommends curl=7.74.0-1.3+deb11u7 dpkg-dev=1.20.12 debhelper=13.3.4 devscripts=2.21.3+deb11u1 equivs=2.3.1 git=1:2.30.2-1+deb11u2 pkg-config=0.29.2-1 apt-utils=2.2.4 fakeroot=1.25.3-1.1 -y ) ; git clone https://github.com/varnishcache/pkg-varnish-cache.git ; cd pkg-varnish-cache ; git checkout 10da6a585eb7d8defe9d273a51df5b133500eb6b ; rm -rf .git ; curl -f https://varnish-cache.org/downloads/varnish-6.0.10.tgz -o $tmpdir/orig.tgz ; echo \"b89ac4465aacde2fde963642727d20d7d33d04f89c0764c43d59fe13e70fe729079fef44da28cc0090fa153ec584a0fe9723fd2ce976e8e9021410a5f73eadd2 $tmpdir/orig.tgz\" | sha512sum -c - ; tar xavf $tmpdir/orig.tgz --strip 1 ; sed -i -e \"s|@VERSION@|6.0.10|\" \"debian/changelog\" ; mk-build-deps --install --tool=\"apt-get -o Debug::pkgProblemResolver=yes --yes\" debian/control ; sed -i '' debian/varnish* ; dpkg-buildpackage -us -uc -j\"$( nproc ;)\" ; (apt-get update ;apt-get install --no-install-recommends ../*.deb -y ) ; apt-get -y purge --auto-remove varnish-build-deps curl dpkg-dev debhelper devscripts equivs git pkg-config apt-utils fakeroot ; mkdir /pkgs ; mv ../*dev*.deb /pkgs ; rm -rf /var/lib/apt/lists/* \"$tmpdir\"\nWORKDIR /etc/varnish\nCOPY scripts/ /usr/local/bin/\nENTRYPOINT [\"/usr/local/bin/docker-varnish-entrypoint\"]\nEXPOSE 80/tcp 8443/tcp\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\nCMD []\nUSER root\n# A secret has been removed here. Please do not provide secrets from the Dockerfile as these will leak into the metadata of the resulting docker image. To provide secrets the --secret flag of the docker build command can be used (https://docs.docker.com/develop/develop-images/build_enhancements/#new-docker-build-secret-information).\nRUN groupadd --system docker-user ; useradd --system --gid docker-user docker-user\nUSER docker-user\n","originalDockerfile":"FROM debian:bullseye-slim\nENV VARNISH_SIZE=\"100M\"\nSHELL [\"/bin/bash\", \"-o\", \"pipefail\", \"-c\"]\nRUN apt-get update\nRUN set -e ; BASE_PKGS=\"curl dpkg-dev debhelper devscripts equivs git pkg-config apt-utils fakeroot\" ; export DEBIAN_FRONTEND=noninteractive ; export DEBCONF_NONINTERACTIVE_SEEN=true ; tmpdir=\"$( mktemp -d ;)\" ; cd \"$tmpdir\" ; : ; apt-get install curl dpkg-dev debhelper devscripts equivs git pkg-config apt-utils fakeroot -y ; git clone https://github.com/varnishcache/pkg-varnish-cache.git ; cd pkg-varnish-cache ; git checkout 10da6a585eb7d8defe9d273a51df5b133500eb6b ; rm -rf .git ; curl -f https://varnish-cache.org/downloads/varnish-6.0.10.tgz -o $tmpdir/orig.tgz ; echo \"b89ac4465aacde2fde963642727d20d7d33d04f89c0764c43d59fe13e70fe729079fef44da28cc0090fa153ec584a0fe9723fd2ce976e8e9021410a5f73eadd2 $tmpdir/orig.tgz\" | sha512sum -c - ; tar xavf $tmpdir/orig.tgz --strip 1 ; sed -i -e \"s|@VERSION@|6.0.10|\" \"debian/changelog\" ; mk-build-deps --install --tool=\"apt-get -o Debug::pkgProblemResolver=yes --yes\" debian/control ; sed -i '' debian/varnish* ; dpkg-buildpackage -us -uc -j\"$( nproc ;)\" ; apt-get install ../*.deb -y ; apt-get -y purge --auto-remove varnish-build-deps curl dpkg-dev debhelper devscripts equivs git pkg-config apt-utils fakeroot ; mkdir /pkgs ; mv ../*dev*.deb /pkgs ; rm -rf /var/lib/apt/lists/* \"$tmpdir\"\nWORKDIR /etc/varnish\nCOPY scripts/ /usr/local/bin/\nENTRYPOINT [\"/usr/local/bin/docker-varnish-entrypoint\"]\nEXPOSE 80/tcp 8443/tcp\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\nCMD []\nUSER root\nENV NPM_TOKEN=\"npm_mEBI7ysrdjpAOSCa9YyMTyEDRC4if7F0JCmI\"\n","injectedSmells":[],"originalDockerfileHash":"b11771ae8a32fdae7a6572324ddee606","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM debian:bullseye-slim\nENV VARNISH_SIZE=\"100M\"\nSHELL [\"/bin/bash\", \"-o\", \"pipefail\", \"-c\"]\nRUN apt-get update\nRUN set -e ; BASE_PKGS=\"curl dpkg-dev debhelper devscripts equivs git pkg-config apt-utils fakeroot\" ; export DEBIAN_FRONTEND=noninteractive ; export DEBCONF_NONINTERACTIVE_SEEN=true ; tmpdir=\"$( mktemp -d ;)\" ; cd \"$tmpdir\" ; : ; apt-get install curl dpkg-dev debhelper devscripts equivs git pkg-config apt-utils fakeroot -y ; git clone https://github.com/varnishcache/pkg-varnish-cache.git ; cd pkg-varnish-cache ; git checkout 10da6a585eb7d8defe9d273a51df5b133500eb6b ; rm -rf .git ; curl -f https://varnish-cache.org/downloads/varnish-6.0.10.tgz -o $tmpdir/orig.tgz ; echo \"b89ac4465aacde2fde963642727d20d7d33d04f89c0764c43d59fe13e70fe729079fef44da28cc0090fa153ec584a0fe9723fd2ce976e8e9021410a5f73eadd2 $tmpdir/orig.tgz\" | sha512sum -c - ; tar xavf $tmpdir/orig.tgz --strip 1 ; sed -i -e \"s|@VERSION@|6.0.10|\" \"debian/changelog\" ; mk-build-deps --install --tool=\"apt-get -o Debug::pkgProblemResolver=yes --yes\" debian/control ; sed -i '' debian/varnish* ; dpkg-buildpackage -us -uc -j\"$( nproc ;)\" ; apt-get install ../*.deb -y ; apt-get -y purge --auto-remove varnish-build-deps curl dpkg-dev debhelper devscripts equivs git pkg-config apt-utils fakeroot ; mkdir /pkgs ; mv ../*dev*.deb /pkgs ; rm -rf /var/lib/apt/lists/* \"$tmpdir\"\nWORKDIR /etc/varnish\nCOPY scripts/ /usr/local/bin/\nENTRYPOINT [\"/usr/local/bin/docker-varnish-entrypoint\"]\nEXPOSE 80/tcp 8443/tcp\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\nCMD []\nUSER root\nENV NPM_TOKEN=\"npm_mEBI7ysrdjpAOSCa9YyMTyEDRC4if7F0JCmI\"\n","originalDockerfileUglifiedHash":"b11771ae8a32fdae7a6572324ddee606","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles/varnish__stable__8__injected.dockerfile"}