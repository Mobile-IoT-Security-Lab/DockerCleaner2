{"seed":1623808123,"processedDockerfileHash":"292266edf8a5a8390e7baceb5d6b92f2","fixedSmells":["use-no-install-recommends","pin-package-manager-versions-apt-get","do-not-have-secrets"],"successfullyFixedSmells":["use-no-install-recommends","pin-package-manager-versions-apt-get","do-not-have-secrets"],"processedDockerfile":"FROM php:7.4-fpm\nSHELL [\"/bin/bash\", \"-o\", \"pipefail\", \"-c\"]\n#   System dependencies\nRUN set -eux ; apt-get update ; apt-get install --no-install-recommends git=1:2.30.2-1+deb11u2 librsvg2-bin=2.50.3+dfsg-1 imagemagick=8:6.9.11.60+dfsg-1.3+deb11u1 python3=3.9.2-3 -y ; rm -rf /var/lib/apt/lists/*\n#   Install the PHP extensions we need\nRUN set -eux ; savedAptMark=\"$( apt-mark showmanual ;)\" ; apt-get update ; apt-get install --no-install-recommends libicu-dev=67.1-7 libonig-dev=6.9.6-1.1 -y ; docker-php-ext-install -j \"$( nproc ;)\" intl mbstring mysqli opcache ; pecl install APCu-5.1.21 ; docker-php-ext-enable apcu ; rm -r /tmp/pear ; apt-mark auto '.*' > /dev/null; apt-mark manual $savedAptMark ; ldd \"$( php -r 'echo ini_get(\"extension_dir\");' ;)\"/*.so | awk '/=>/ { print $3 }' | sort -u | xargs -r dpkg-query -S | cut -d: -f1 | sort -u | xargs -rt apt-mark manual ; apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false ; rm -rf /var/lib/apt/lists/*\n#   set recommended PHP.ini settings\n#   see https://secure.php.net/manual/en/opcache.installation.php\nRUN { echo 'opcache.memory_consumption=128' ;echo 'opcache.interned_strings_buffer=8' ;echo 'opcache.max_accelerated_files=4000' ;echo 'opcache.revalidate_freq=60' ; } > /usr/local/etc/php/conf.d/opcache-recommended.ini\n#   SQLite Directory Setup\nRUN set -eux ; mkdir -p /var/www/data ; chown -R www-data:www-data /var/www/data\n#   Version\nENV MEDIAWIKI_MAJOR_VERSION=\"1.37\"\nENV MEDIAWIKI_VERSION=\"1.37.1\"\n#   MediaWiki setup\nRUN set -eux ; fetchDeps=\" gnupg dirmngr \" ; apt-get update ; apt-get install --no-install-recommends gnupg=2.2.27-2+deb11u2 dirmngr=2.2.27-2+deb11u2 -y ; curl -fSL \"https://releases.wikimedia.org/mediawiki/${MEDIAWIKI_MAJOR_VERSION}/mediawiki-${MEDIAWIKI_VERSION}.tar.gz\" -o mediawiki.tar.gz ; curl -fSL \"https://releases.wikimedia.org/mediawiki/${MEDIAWIKI_MAJOR_VERSION}/mediawiki-${MEDIAWIKI_VERSION}.tar.gz.sig\" -o mediawiki.tar.gz.sig ; export GNUPGHOME=\"$( mktemp -d ;)\" ; gpg --batch --keyserver keyserver.ubuntu.com --recv-keys D7D6767D135A514BEB86E9BA75682B08E8A3FEC4 441276E9CCD15F44F6D97D18C119E1A64D70938E F7F780D82EBFB8A56556E7EE82403E59F9F8CD79 1D98867E82982C8FE0ABC25F9B69B3109D3BB7B0 ; gpg --batch --verify mediawiki.tar.gz.sig mediawiki.tar.gz ; tar -x --strip-components=1 -f mediawiki.tar.gz ; gpgconf --kill all ; rm -r \"$GNUPGHOME\" mediawiki.tar.gz.sig mediawiki.tar.gz ; chown -R www-data:www-data extensions skins cache images ; apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false $fetchDeps ; rm -rf /var/lib/apt/lists/*\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\nCMD [\"php-fpm\"]\n# A secret has been removed here. Please do not provide secrets from the Dockerfile as these will leak into the metadata of the resulting docker image. To provide secrets the --secret flag of the docker build command can be used (https://docs.docker.com/develop/develop-images/build_enhancements/#new-docker-build-secret-information).\n","originalDockerfile":"FROM php:7.4-fpm\nSHELL [\"/bin/bash\", \"-o\", \"pipefail\", \"-c\"]\n#  System dependencies\nRUN set -eux ; apt-get update ; apt-get install git librsvg2-bin imagemagick python3 -y ; rm -rf /var/lib/apt/lists/*\n#  Install the PHP extensions we need\nRUN set -eux ; savedAptMark=\"$( apt-mark showmanual ;)\" ; apt-get update ; apt-get install libicu-dev libonig-dev -y ; docker-php-ext-install -j \"$( nproc ;)\" intl mbstring mysqli opcache ; pecl install APCu-5.1.21 ; docker-php-ext-enable apcu ; rm -r /tmp/pear ; apt-mark auto '.*' > /dev/null; apt-mark manual $savedAptMark ; ldd \"$( php -r 'echo ini_get(\"extension_dir\");' ;)\"/*.so | awk '/=>/ { print $3 }' | sort -u | xargs -r dpkg-query -S | cut -d: -f1 | sort -u | xargs -rt apt-mark manual ; apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false ; rm -rf /var/lib/apt/lists/*\n#  set recommended PHP.ini settings\n#  see https://secure.php.net/manual/en/opcache.installation.php\nRUN { echo 'opcache.memory_consumption=128' ;echo 'opcache.interned_strings_buffer=8' ;echo 'opcache.max_accelerated_files=4000' ;echo 'opcache.revalidate_freq=60' ; } > /usr/local/etc/php/conf.d/opcache-recommended.ini\n#  SQLite Directory Setup\nRUN set -eux ; mkdir -p /var/www/data ; chown -R www-data:www-data /var/www/data\n#  Version\nENV MEDIAWIKI_MAJOR_VERSION=\"1.37\"\nENV MEDIAWIKI_VERSION=\"1.37.1\"\n#  MediaWiki setup\nRUN set -eux ; fetchDeps=\" gnupg dirmngr \" ; apt-get update ; apt-get install gnupg dirmngr -y ; curl -fSL \"https://releases.wikimedia.org/mediawiki/${MEDIAWIKI_MAJOR_VERSION}/mediawiki-${MEDIAWIKI_VERSION}.tar.gz\" -o mediawiki.tar.gz ; curl -fSL \"https://releases.wikimedia.org/mediawiki/${MEDIAWIKI_MAJOR_VERSION}/mediawiki-${MEDIAWIKI_VERSION}.tar.gz.sig\" -o mediawiki.tar.gz.sig ; export GNUPGHOME=\"$( mktemp -d ;)\" ; gpg --batch --keyserver keyserver.ubuntu.com --recv-keys D7D6767D135A514BEB86E9BA75682B08E8A3FEC4 441276E9CCD15F44F6D97D18C119E1A64D70938E F7F780D82EBFB8A56556E7EE82403E59F9F8CD79 1D98867E82982C8FE0ABC25F9B69B3109D3BB7B0 ; gpg --batch --verify mediawiki.tar.gz.sig mediawiki.tar.gz ; tar -x --strip-components=1 -f mediawiki.tar.gz ; gpgconf --kill all ; rm -r \"$GNUPGHOME\" mediawiki.tar.gz.sig mediawiki.tar.gz ; chown -R www-data:www-data extensions skins cache images ; apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false $fetchDeps ; rm -rf /var/lib/apt/lists/*\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\nCMD [\"php-fpm\"]\nENV GOOGLE_API_KEY=\"AIzaio7ocsKleLd8dFEcQHuoG8fosXSrLFmzfun\" \\\n    GOOGLE_API_KEY=\"AIzaoak1xFGqLnkxxUwdr7dW2lQ6LDgPi85GTWm\" \\\n    AWS_ACCESS_KEY=\"ASIASBL8YILS3CJI4DDV\" \\\n    AWS_ACCESS_KEY=\"ASIAG055QGRJD62MXBOS\" \\\n    SLACK_TOKEN=\"xapp-554636552145-Wa85KmHgjKLsQnNg2oj1NKWe\"\n","injectedSmells":[],"originalDockerfileHash":"8159fb3c1c7f64259974846c60c9587b","successfullyInjectedSmells":[],"originalDockerfileUglified":"FROM php:7.4-fpm\nSHELL [\"/bin/bash\", \"-o\", \"pipefail\", \"-c\"]\n#   System dependencies\nRUN set -eux ; apt-get update ; apt-get install git librsvg2-bin imagemagick python3 -y ; rm -rf /var/lib/apt/lists/*\n#   Install the PHP extensions we need\nRUN set -eux ; savedAptMark=\"$( apt-mark showmanual ;)\" ; apt-get update ; apt-get install libicu-dev libonig-dev -y ; docker-php-ext-install -j \"$( nproc ;)\" intl mbstring mysqli opcache ; pecl install APCu-5.1.21 ; docker-php-ext-enable apcu ; rm -r /tmp/pear ; apt-mark auto '.*' > /dev/null; apt-mark manual $savedAptMark ; ldd \"$( php -r 'echo ini_get(\"extension_dir\");' ;)\"/*.so | awk '/=>/ { print $3 }' | sort -u | xargs -r dpkg-query -S | cut -d: -f1 | sort -u | xargs -rt apt-mark manual ; apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false ; rm -rf /var/lib/apt/lists/*\n#   set recommended PHP.ini settings\n#   see https://secure.php.net/manual/en/opcache.installation.php\nRUN { echo 'opcache.memory_consumption=128' ;echo 'opcache.interned_strings_buffer=8' ;echo 'opcache.max_accelerated_files=4000' ;echo 'opcache.revalidate_freq=60' ; } > /usr/local/etc/php/conf.d/opcache-recommended.ini\n#   SQLite Directory Setup\nRUN set -eux ; mkdir -p /var/www/data ; chown -R www-data:www-data /var/www/data\n#   Version\nENV MEDIAWIKI_MAJOR_VERSION=\"1.37\"\nENV MEDIAWIKI_VERSION=\"1.37.1\"\n#   MediaWiki setup\nRUN set -eux ; fetchDeps=\" gnupg dirmngr \" ; apt-get update ; apt-get install gnupg dirmngr -y ; curl -fSL \"https://releases.wikimedia.org/mediawiki/${MEDIAWIKI_MAJOR_VERSION}/mediawiki-${MEDIAWIKI_VERSION}.tar.gz\" -o mediawiki.tar.gz ; curl -fSL \"https://releases.wikimedia.org/mediawiki/${MEDIAWIKI_MAJOR_VERSION}/mediawiki-${MEDIAWIKI_VERSION}.tar.gz.sig\" -o mediawiki.tar.gz.sig ; export GNUPGHOME=\"$( mktemp -d ;)\" ; gpg --batch --keyserver keyserver.ubuntu.com --recv-keys D7D6767D135A514BEB86E9BA75682B08E8A3FEC4 441276E9CCD15F44F6D97D18C119E1A64D70938E F7F780D82EBFB8A56556E7EE82403E59F9F8CD79 1D98867E82982C8FE0ABC25F9B69B3109D3BB7B0 ; gpg --batch --verify mediawiki.tar.gz.sig mediawiki.tar.gz ; tar -x --strip-components=1 -f mediawiki.tar.gz ; gpgconf --kill all ; rm -r \"$GNUPGHOME\" mediawiki.tar.gz.sig mediawiki.tar.gz ; chown -R www-data:www-data extensions skins cache images ; apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false $fetchDeps ; rm -rf /var/lib/apt/lists/*\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\nCMD [\"php-fpm\"]\nENV GOOGLE_API_KEY=\"AIzaio7ocsKleLd8dFEcQHuoG8fosXSrLFmzfun\" \\\n    GOOGLE_API_KEY=\"AIzaoak1xFGqLnkxxUwdr7dW2lQ6LDgPi85GTWm\" \\\n    AWS_ACCESS_KEY=\"ASIASBL8YILS3CJI4DDV\" \\\n    AWS_ACCESS_KEY=\"ASIAG055QGRJD62MXBOS\" \\\n    SLACK_TOKEN=\"xapp-554636552145-Wa85KmHgjKLsQnNg2oj1NKWe\"\n","originalDockerfileUglifiedHash":"8f7df75b4208c470c22262e9f43a84bf","fileName":"/ICSME-replicationpackage/dataset/smelly_dockerfiles/mediawiki__1.37.1-fpm__9__injected.dockerfile"}