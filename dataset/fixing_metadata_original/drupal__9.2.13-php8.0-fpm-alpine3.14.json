{"seed":1195120284,"processedDockerfileHash":"d6d56b4035e3c658970c87d46bc4de17","fixedSmells":["use-no-install-recommends","do-not-use-apt-get-update-alone","pin-package-manager-versions-apt-get","pin-package-manager-versions-pip","pin-package-manager-versions-npm","pin-package-manager-versions-gem","pin-package-manager-versions-apk","use-copy-instead-of-add","use-wget-instead-of-add","do-not-have-secrets","have-a-healthcheck","have-a-user"],"successfullyFixedSmells":["pin-package-manager-versions-apk","have-a-healthcheck","have-a-user"],"processedDockerfile":"#\n#  NOTE: THIS DOCKERFILE IS GENERATED VIA \"apply-templates.sh\"\n#\n#  PLEASE DO NOT EDIT IT DIRECTLY.\n#\n#  from https://www.drupal.org/docs/system-requirements/php-requirements\nFROM php:8.0-fpm-alpine3.14\n#  install the PHP extensions we need\nRUN set -eux ; apk add coreutils=8.32-r2 freetype-dev=2.10.4-r3 libjpeg-turbo-dev=2.1.0-r0 libpng-dev=1.6.37-r1 libwebp-dev=1.2.0-r2 libzip-dev=1.7.3-r2 postgresql-dev=13.10-r0 --no-cache --virtual .build-deps ; docker-php-ext-configure gd --with-freetype --with-jpeg=/usr/include --with-webp ; docker-php-ext-install -j \"$( nproc ;)\" gd opcache pdo_mysql pdo_pgsql zip ; runDeps=\"$( scanelf --needed --nobanner --format '%n#p' --recursive /usr/local | tr ',' '\\n' | sort -u | awk 'system(\"[ -e /usr/local/lib/\" $1 \" ]\") == 0 { next } { print \"so:\" $1 }' ;)\" ; apk add $runDeps --no-network --virtual .drupal-phpexts-rundeps ; apk del --no-network .build-deps\n#  set recommended PHP.ini settings\n#  see https://secure.php.net/manual/en/opcache.installation.php\nRUN { echo 'opcache.memory_consumption=128' ;echo 'opcache.interned_strings_buffer=8' ;echo 'opcache.max_accelerated_files=4000' ;echo 'opcache.revalidate_freq=60' ;echo 'opcache.fast_shutdown=1' ; } > /usr/local/etc/php/conf.d/opcache-recommended.ini\nCOPY --from=composer:2 /usr/bin/composer /usr/local/bin/\n#  https://www.drupal.org/node/3060/release\nENV DRUPAL_VERSION=\"9.2.13\"\nWORKDIR /opt/drupal\nRUN set -eux ; export COMPOSER_HOME=\"$( mktemp -d ;)\" ; composer create-project --no-interaction \"drupal/recommended-project:$DRUPAL_VERSION\" ./ ; chown -R www-data:www-data web/sites web/modules web/themes ; rmdir /var/www/html ; ln -sf /opt/drupal/web /var/www/html ; rm -rf \"$COMPOSER_HOME\"\nENV PATH=\"${PATH}:/opt/drupal/vendor/bin\"\n#  vim:set ft=dockerfile:\nRUN addgroup -S docker-user ; adduser -S -G docker-user docker-user\nUSER docker-user\nHEALTHCHECK CMD curl --fail http://127.0.0.1:80 || exit 1\n","originalDockerfile":"#\n# NOTE: THIS DOCKERFILE IS GENERATED VIA \"apply-templates.sh\"\n#\n# PLEASE DO NOT EDIT IT DIRECTLY.\n#\n\n# from https://www.drupal.org/docs/system-requirements/php-requirements\nFROM php:8.0-fpm-alpine3.14\n\n# install the PHP extensions we need\nRUN set -eux; \\\n\t\\\n\tapk add --no-cache --virtual .build-deps \\\n\t\tcoreutils \\\n\t\tfreetype-dev \\\n\t\tlibjpeg-turbo-dev \\\n\t\tlibpng-dev \\\n\t\tlibwebp-dev \\\n\t\tlibzip-dev \\\n# postgresql-dev is needed for https://bugs.alpinelinux.org/issues/3642\n\t\tpostgresql-dev \\\n\t; \\\n\t\\\n\tdocker-php-ext-configure gd \\\n\t\t--with-freetype \\\n\t\t--with-jpeg=/usr/include \\\n\t\t--with-webp \\\n\t; \\\n\t\\\n\tdocker-php-ext-install -j \"$(nproc)\" \\\n\t\tgd \\\n\t\topcache \\\n\t\tpdo_mysql \\\n\t\tpdo_pgsql \\\n\t\tzip \\\n\t; \\\n\t\\\n\trunDeps=\"$( \\\n\t\tscanelf --needed --nobanner --format '%n#p' --recursive /usr/local \\\n\t\t\t| tr ',' '\\n' \\\n\t\t\t| sort -u \\\n\t\t\t| awk 'system(\"[ -e /usr/local/lib/\" $1 \" ]\") == 0 { next } { print \"so:\" $1 }' \\\n\t)\"; \\\n\tapk add --no-network --virtual .drupal-phpexts-rundeps $runDeps; \\\n\tapk del --no-network .build-deps\n\n# set recommended PHP.ini settings\n# see https://secure.php.net/manual/en/opcache.installation.php\nRUN { \\\n\t\techo 'opcache.memory_consumption=128'; \\\n\t\techo 'opcache.interned_strings_buffer=8'; \\\n\t\techo 'opcache.max_accelerated_files=4000'; \\\n\t\techo 'opcache.revalidate_freq=60'; \\\n\t\techo 'opcache.fast_shutdown=1'; \\\n\t} > /usr/local/etc/php/conf.d/opcache-recommended.ini\n\nCOPY --from=composer:2 /usr/bin/composer /usr/local/bin/\n\n# https://www.drupal.org/node/3060/release\nENV DRUPAL_VERSION 9.2.13\n\nWORKDIR /opt/drupal\nRUN set -eux; \\\n\texport COMPOSER_HOME=\"$(mktemp -d)\"; \\\n\tcomposer create-project --no-interaction \"drupal/recommended-project:$DRUPAL_VERSION\" ./; \\\n\tchown -R www-data:www-data web/sites web/modules web/themes; \\\n\trmdir /var/www/html; \\\n\tln -sf /opt/drupal/web /var/www/html; \\\n\t# delete composer cache\n\trm -rf \"$COMPOSER_HOME\"\n\nENV PATH=${PATH}:/opt/drupal/vendor/bin\n\n# vim:set ft=dockerfile:\n","injectedSmells":[],"originalDockerfileHash":"c9881c41c89f15350d1703c2473c169c","successfullyInjectedSmells":[],"originalDockerfileUglified":"#\n#  NOTE: THIS DOCKERFILE IS GENERATED VIA \"apply-templates.sh\"\n#\n#  PLEASE DO NOT EDIT IT DIRECTLY.\n#\n#  from https://www.drupal.org/docs/system-requirements/php-requirements\nFROM php:8.0-fpm-alpine3.14\n#  install the PHP extensions we need\nRUN set -eux ; apk add --no-cache --virtual .build-deps coreutils freetype-dev libjpeg-turbo-dev libpng-dev libwebp-dev libzip-dev postgresql-dev ; docker-php-ext-configure gd --with-freetype --with-jpeg=/usr/include --with-webp ; docker-php-ext-install -j \"$( nproc ;)\" gd opcache pdo_mysql pdo_pgsql zip ; runDeps=\"$( scanelf --needed --nobanner --format '%n#p' --recursive /usr/local | tr ',' '\\n' | sort -u | awk 'system(\"[ -e /usr/local/lib/\" $1 \" ]\") == 0 { next } { print \"so:\" $1 }' ;)\" ; apk add --no-network --virtual .drupal-phpexts-rundeps $runDeps ; apk del --no-network .build-deps\n#  set recommended PHP.ini settings\n#  see https://secure.php.net/manual/en/opcache.installation.php\nRUN { echo 'opcache.memory_consumption=128' ;echo 'opcache.interned_strings_buffer=8' ;echo 'opcache.max_accelerated_files=4000' ;echo 'opcache.revalidate_freq=60' ;echo 'opcache.fast_shutdown=1' ; } > /usr/local/etc/php/conf.d/opcache-recommended.ini\nCOPY --from=composer:2 /usr/bin/composer /usr/local/bin/\n#  https://www.drupal.org/node/3060/release\nENV DRUPAL_VERSION=\"9.2.13\"\nWORKDIR /opt/drupal\nRUN set -eux ; export COMPOSER_HOME=\"$( mktemp -d ;)\" ; composer create-project --no-interaction \"drupal/recommended-project:$DRUPAL_VERSION\" ./ ; chown -R www-data:www-data web/sites web/modules web/themes ; rmdir /var/www/html ; ln -sf /opt/drupal/web /var/www/html ; rm -rf \"$COMPOSER_HOME\"\nENV PATH=\"${PATH}:/opt/drupal/vendor/bin\"\n#  vim:set ft=dockerfile:\n","originalDockerfileUglifiedHash":"fc2105fcb5eb08fed27ad87d06fab1ea","fileName":"/ICSME-replicationpackage/dataset/original_dockerfiles/drupal__9.2.13-php8.0-fpm-alpine3.14.dockerfile"}